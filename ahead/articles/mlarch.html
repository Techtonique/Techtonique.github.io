<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Beyond GARCH ‚Ä¢ ahead</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Beyond GARCH">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ahead</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.19.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ahead-loess-forecasting.html">Prediction intervals for Loess forecasting (simulation-based)</a>
    </li>
    <li>
      <a href="../articles/ahead-neutralize.html">Risk-neutralize simulations</a>
    </li>
    <li>
      <a href="../articles/ahead-plotting-functions.html">Plotting functions</a>
    </li>
    <li>
      <a href="../articles/ahead-ridge2-conformal.html">Conformal Prediction using Ridge2</a>
    </li>
    <li>
      <a href="../articles/ahead-ridge2-prediction-intervals.html">Prediction intervals for multivariate time series (simulation-based)</a>
    </li>
    <li>
      <a href="../articles/ahead-univariate-season.html">Univariate forecasting with `ridge2f` in `ahead`</a>
    </li>
    <li>
      <a href="../articles/ahead-vignette.html">Introduction to R package `ahead`</a>
    </li>
    <li>
      <a href="../articles/caretfitpredict.html">Fit and forecast using caret+dynrmf</a>
    </li>
    <li>
      <a href="../articles/comb_OLS.html">comb OLS Electricity</a>
    </li>
    <li>
      <a href="../articles/comb_OLS2.html">comb OLS AirPassengers</a>
    </li>
    <li>
      <a href="../articles/conformal-ml.html">Conformalized Forecasting using Machine Leaning models</a>
    </li>
    <li>
      <a href="../articles/fitforecastbench.html">Fit and forecast for benchmarking purposes</a>
    </li>
    <li>
      <a href="../articles/generic-conformal.html">Generic forecasting and conformal prediction</a>
    </li>
    <li>
      <a href="../articles/glmthetaf-attention-conformal.html">Generalized Linear Model Theta Forecast with attention - conformal uncertainty</a>
    </li>
    <li>
      <a href="../articles/glmthetaf-attention.html">Generalized Linear Model Theta Forecast with attention</a>
    </li>
    <li>
      <a href="../articles/glmthetaf-ridge-attention.html">Ridge Theta Forecast with attention - conformal uncertainty</a>
    </li>
    <li>
      <a href="../articles/glmthetaf.html">Generalized Linear Model Theta Forecast</a>
    </li>
    <li>
      <a href="../articles/mlarch.html">Beyond GARCH</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Beyond GARCH</h1>
            
      

      <div class="hidden name"><code>mlarch.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Probabilistic stock forecasting often relies on parametric models
like ARIMA for the mean and GARCH for volatility. The
<code>mlarchf</code> function in the <code>ahead</code> package offers a
flexible hybrid alternative to ARMA-GARCH by combining machine learning
approaches with ARCH effects.</p>
<p>The model decomposes the time series into two components:</p>
<ol style="list-style-type: decimal">
<li>Mean component:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><msub><mi>Œº</mi><mi>t</mi></msub><mo>+</mo><msub><mi>œÉ</mi><mi>t</mi></msub><msub><mi>Œµ</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">y_t = \mu_t + \sigma_t \varepsilon_t</annotation></semantics></math>
</li>
<li>Volatility component:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>œÉ</mi><mi>t</mi><mn>2</mn></msubsup><mo>=</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Œµ</mi><mrow><mi>t</mi><mo>‚àí</mo><mn>1</mn></mrow><mn>2</mn></msubsup><mo>,</mo><msubsup><mi>Œµ</mi><mrow><mi>t</mi><mo>‚àí</mo><mn>2</mn></mrow><mn>2</mn></msubsup><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma_t^2 = f(\varepsilon_{t-1}^2, \varepsilon_{t-2}^2, ...)</annotation></semantics></math>
</li>
</ol>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œº</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\mu_t</annotation></semantics></math>
is the conditional mean (modeled using <strong>any forecasting
method</strong>)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÉ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\sigma_t</annotation></semantics></math>
is the conditional volatility (modeled using <strong>machine
learning</strong>)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œµ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\varepsilon_t</annotation></semantics></math>
are standardized residuals</li>
</ul>
<p>The <strong>key innovation</strong> is using machine learning methods
and conformal prediction to model the volatility component, allowing for
more flexible and potentially more accurate volatility forecasts than
traditional GARCH models. The function supports various machine learning
methods through parameters <code>fit_func</code> and
<code>predict_func</code> as in other <code>ahead</code> models, and
through the <code>caret</code> package.</p>
<p>The forecasting process involves:</p>
<ul>
<li>Fitting a mean model (default: <code>auto.arima</code>)</li>
<li>Modeling the squared residuals using machine learning. For this to
work, the residuals from the mean model need to be centered, so
that</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùîº</mi><mrow><mo stretchy="true" form="prefix">[</mo><msubsup><mi>œµ</mi><mi>t</mi><mn>2</mn></msubsup><mo stretchy="false" form="prefix">|</mo><msub><mi>F</mi><mrow><mi>t</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathbb{E}[\epsilon_t^2|F_{t-1}]
</annotation></semantics></math></p>
<p>(basically a supervised regression of squared residuals on their
lags) is a good approximation of the latent conditional volatility</p>
<ul>
<li>Conformalizing the standardized residuals for prediction
intervals</li>
</ul>
<p>This new approach combines the interpretability of traditional time
series models with the flexibility of machine learning, while
maintaining proper uncertainty quantification through conformal
prediction.</p>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<p>Let‚Äôs start with a simple example using the Google stock price data
from the <code>fpp2</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">fpp2</span><span class="fu">::</span><span class="va"><a href="https://pkg.robjhyndman.com/fpp2-package/reference/goog.html" class="external-link">goog200</a></span></span>
<span></span>
<span><span class="co"># Default model for volatility (Ridge regression for volatility)</span></span>
<span><span class="op">(</span><span class="va">obj_ridge</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/mlarchf.html">mlarchf</a></span><span class="op">(</span><span class="va">y</span>, h<span class="op">=</span><span class="fl">20L</span>, B<span class="op">=</span><span class="fl">500L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Point Forecast    Lo 95    Hi 95</span></span>
<span><span class="co">## 201       533.2700 520.7125 543.3058</span></span>
<span><span class="co">## 202       533.6319 521.2189 543.0401</span></span>
<span><span class="co">## 203       532.6796 521.5025 543.0341</span></span>
<span><span class="co">## 204       535.4829 521.9276 545.8766</span></span>
<span><span class="co">## 205       536.1225 526.0746 545.8690</span></span>
<span><span class="co">## 206       536.3693 524.7950 546.4976</span></span>
<span><span class="co">## 207       536.7633 521.5747 547.6252</span></span>
<span><span class="co">## 208       537.8977 526.5788 547.6662</span></span>
<span><span class="co">## 209       538.6541 528.0581 549.0655</span></span>
<span><span class="co">## 210       538.5826 524.3332 548.6398</span></span>
<span><span class="co">## 211       539.8161 523.2090 550.2788</span></span>
<span><span class="co">## 212       540.5613 526.9394 551.0448</span></span>
<span><span class="co">## 213       540.9971 528.4168 550.9190</span></span>
<span><span class="co">## 214       541.6375 529.5304 552.9026</span></span>
<span><span class="co">## 215       542.6626 529.0126 552.2940</span></span>
<span><span class="co">## 216       543.8149 532.4300 553.5500</span></span>
<span><span class="co">## 217       544.4363 533.8023 555.1394</span></span>
<span><span class="co">## 218       545.2461 535.2998 553.7284</span></span>
<span><span class="co">## 219       545.5233 524.7739 555.6506</span></span>
<span><span class="co">## 220       545.7712 531.2459 556.2677</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="different-machine-learning-methods">Different Machine Learning Methods<a class="anchor" aria-label="anchor" href="#different-machine-learning-methods"></a>
</h2>
<p>The package supports various machine learning methods for volatility
modeling. Here are some examples:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Random Forest</span></span>
<span><span class="op">(</span><span class="va">obj_rf</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/mlarchf.html">mlarchf</a></span><span class="op">(</span><span class="va">y</span>, fit_func <span class="op">=</span> <span class="fu">randomForest</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a></span>, </span>
<span>                     predict_func <span class="op">=</span> <span class="va">predict</span>, h<span class="op">=</span><span class="fl">20L</span>, B<span class="op">=</span><span class="fl">500L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Point Forecast    Lo 95    Hi 95</span></span>
<span><span class="co">## 201       532.6061 528.9707 536.9722</span></span>
<span><span class="co">## 202       533.1003 528.7551 539.1816</span></span>
<span><span class="co">## 203       532.2246 531.2974 539.2195</span></span>
<span><span class="co">## 204       534.7124 528.4335 541.8784</span></span>
<span><span class="co">## 205       535.7345 533.5332 541.9456</span></span>
<span><span class="co">## 206       535.8594 531.3660 542.7578</span></span>
<span><span class="co">## 207       536.6638 532.5376 543.9806</span></span>
<span><span class="co">## 208       537.3235 533.6996 543.0118</span></span>
<span><span class="co">## 209       538.1361 532.6401 546.1345</span></span>
<span><span class="co">## 210       538.6090 534.8959 544.3756</span></span>
<span><span class="co">## 211       539.5475 536.6442 545.9770</span></span>
<span><span class="co">## 212       540.3242 536.4448 547.3574</span></span>
<span><span class="co">## 213       540.4916 539.7190 545.4608</span></span>
<span><span class="co">## 214       541.6104 538.1965 549.4460</span></span>
<span><span class="co">## 215       542.3460 539.9363 548.2192</span></span>
<span><span class="co">## 216       543.0583 539.4250 549.2510</span></span>
<span><span class="co">## 217       543.8291 540.4532 551.2063</span></span>
<span><span class="co">## 218       544.7318 544.0193 549.4296</span></span>
<span><span class="co">## 219       545.4385 543.4554 551.7683</span></span>
<span><span class="co">## 220       545.6369 541.7410 552.4946</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Support Vector Machine</span></span>
<span><span class="op">(</span><span class="va">obj_svm</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/mlarchf.html">mlarchf</a></span><span class="op">(</span><span class="va">y</span>, fit_func <span class="op">=</span> <span class="fu">e1071</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/e1071/man/svm.html" class="external-link">svm</a></span>, </span>
<span>                     predict_func <span class="op">=</span> <span class="va">predict</span>, h<span class="op">=</span><span class="fl">20L</span>, B<span class="op">=</span><span class="fl">500L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Point Forecast    Lo 95    Hi 95</span></span>
<span><span class="co">## 201       532.7555 521.0435 543.9154</span></span>
<span><span class="co">## 202       533.3039 522.8313 544.0475</span></span>
<span><span class="co">## 203       531.7961 526.7143 544.6855</span></span>
<span><span class="co">## 204       535.4202 523.8127 547.7359</span></span>
<span><span class="co">## 205       536.2453 529.1980 546.9022</span></span>
<span><span class="co">## 206       536.0528 525.3264 548.0969</span></span>
<span><span class="co">## 207       536.8070 528.3163 548.2657</span></span>
<span><span class="co">## 208       537.8018 529.2403 549.4555</span></span>
<span><span class="co">## 209       538.4411 529.1502 550.9336</span></span>
<span><span class="co">## 210       538.5585 529.7350 548.8733</span></span>
<span><span class="co">## 211       539.6687 529.9950 552.0458</span></span>
<span><span class="co">## 212       540.7532 531.5196 552.6502</span></span>
<span><span class="co">## 213       540.7381 534.7887 551.0466</span></span>
<span><span class="co">## 214       541.5121 530.3333 555.5088</span></span>
<span><span class="co">## 215       542.7027 531.9594 553.9451</span></span>
<span><span class="co">## 216       543.6152 535.4353 553.9793</span></span>
<span><span class="co">## 217       544.5081 535.6020 557.3502</span></span>
<span><span class="co">## 218       544.9934 536.4035 554.6856</span></span>
<span><span class="co">## 219       545.9369 536.7190 557.2555</span></span>
<span><span class="co">## 220       545.6838 535.4850 558.2409</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Elastic Net</span></span>
<span><span class="op">(</span><span class="va">obj_glmnet</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/mlarchf.html">mlarchf</a></span><span class="op">(</span><span class="va">y</span>, fit_func <span class="op">=</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="va"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span>, </span>
<span>                     predict_func <span class="op">=</span> <span class="va">predict</span>, h<span class="op">=</span><span class="fl">20L</span>, B<span class="op">=</span><span class="fl">500L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Point Forecast    Lo 95    Hi 95</span></span>
<span><span class="co">## 201       533.2700 520.7125 543.3058</span></span>
<span><span class="co">## 202       533.6319 521.2189 543.0401</span></span>
<span><span class="co">## 203       532.6796 521.5025 543.0341</span></span>
<span><span class="co">## 204       535.4829 521.9276 545.8766</span></span>
<span><span class="co">## 205       536.1225 526.0746 545.8690</span></span>
<span><span class="co">## 206       536.3693 524.7950 546.4976</span></span>
<span><span class="co">## 207       536.7633 521.5747 547.6252</span></span>
<span><span class="co">## 208       537.8977 526.5788 547.6662</span></span>
<span><span class="co">## 209       538.6541 528.0581 549.0655</span></span>
<span><span class="co">## 210       538.5826 524.3332 548.6398</span></span>
<span><span class="co">## 211       539.8161 523.2090 550.2788</span></span>
<span><span class="co">## 212       540.5613 526.9394 551.0448</span></span>
<span><span class="co">## 213       540.9971 528.4168 550.9190</span></span>
<span><span class="co">## 214       541.6375 529.5304 552.9026</span></span>
<span><span class="co">## 215       542.6626 529.0126 552.2940</span></span>
<span><span class="co">## 216       543.8149 532.4300 553.5500</span></span>
<span><span class="co">## 217       544.4363 533.8023 555.1394</span></span>
<span><span class="co">## 218       545.2461 535.2998 553.7284</span></span>
<span><span class="co">## 219       545.5233 524.7739 555.6506</span></span>
<span><span class="co">## 220       545.7712 531.2459 556.2677</span></span></code></pre>
<p>Let‚Äôs visualize the forecasts:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj_ridge</span>, main<span class="op">=</span><span class="st">"Ridge Regression"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj_rf</span>, main<span class="op">=</span><span class="st">"Random Forest"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mlarch_files/figure-html/plot_ridge_rf-1.png" width="691.2"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj_svm</span>, main<span class="op">=</span><span class="st">"Support Vector Machine"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj_glmnet</span>, main<span class="op">=</span><span class="st">"Elastic Net"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mlarch_files/figure-html/plot_svm_glmnet-1.png" width="691.2"></p>
</div>
<div class="section level2">
<h2 id="using-caret-models">Using caret Models<a class="anchor" aria-label="anchor" href="#using-caret-models"></a>
</h2>
<p>The package also supports models from the <code>caret</code> package,
which provides access to hundreds of machine learning methods. Here‚Äôs
how to use them:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/window.html" class="external-link">window</a></span><span class="op">(</span><span class="fu">fpp2</span><span class="fu">::</span><span class="va"><a href="https://pkg.robjhyndman.com/fpp2-package/reference/goog.html" class="external-link">goog200</a></span>, start<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Random Forest via caret</span></span>
<span><span class="op">(</span><span class="va">obj_rf</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/mlarchf.html">mlarchf</a></span><span class="op">(</span><span class="va">y</span>, ml_method<span class="op">=</span><span class="st">"ranger"</span>, h<span class="op">=</span><span class="fl">20L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Point Forecast    Lo 95    Hi 95</span></span>
<span><span class="co">## 201       531.3001 530.3815 535.0797</span></span>
<span><span class="co">## 202       532.7425 531.4783 541.3865</span></span>
<span><span class="co">## 203       532.9632 531.4783 536.2046</span></span>
<span><span class="co">## 204       531.9734 531.4783 537.7526</span></span>
<span><span class="co">## 205       531.3398 530.1817 534.6033</span></span>
<span><span class="co">## 206       533.4750 526.7619 545.8506</span></span>
<span><span class="co">## 207       533.3075 531.4783 546.5052</span></span>
<span><span class="co">## 208       557.9558 473.4424 612.6599</span></span>
<span><span class="co">## 209       532.2299 531.4783 533.9453</span></span>
<span><span class="co">## 210       554.4276 479.0571 606.9448</span></span>
<span><span class="co">## 211       532.4029 531.4783 539.9838</span></span>
<span><span class="co">## 212       559.4561 480.2828 608.4878</span></span>
<span><span class="co">## 213       533.0359 531.4783 547.6419</span></span>
<span><span class="co">## 214       558.4976 481.3574 609.7551</span></span>
<span><span class="co">## 215       532.5064 531.4783 535.8566</span></span>
<span><span class="co">## 216       563.6338 502.8062 610.7042</span></span>
<span><span class="co">## 217       533.1864 531.4783 540.9575</span></span>
<span><span class="co">## 218       562.3934 483.6479 611.5176</span></span>
<span><span class="co">## 219       533.6487 531.4783 540.1434</span></span>
<span><span class="co">## 220       563.8270 484.8392 612.4601</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Gradient Boosting via caret</span></span>
<span><span class="op">(</span><span class="va">obj_glmboost</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/mlarchf.html">mlarchf</a></span><span class="op">(</span><span class="va">y</span>, ml_method<span class="op">=</span><span class="st">"glmboost"</span>, h<span class="op">=</span><span class="fl">20L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Point Forecast    Lo 95    Hi 95</span></span>
<span><span class="co">## 201       533.5141 521.8769 544.3329</span></span>
<span><span class="co">## 202       535.6672 527.0432 548.6365</span></span>
<span><span class="co">## 203       535.6145 526.9136 545.9855</span></span>
<span><span class="co">## 204       534.7122 525.8945 548.2630</span></span>
<span><span class="co">## 205       533.9869 522.6654 545.4798</span></span>
<span><span class="co">## 206       535.2817 525.9101 548.9111</span></span>
<span><span class="co">## 207       535.7594 526.4885 553.7258</span></span>
<span><span class="co">## 208       535.6123 526.4075 546.7675</span></span>
<span><span class="co">## 209       534.8989 526.2783 546.5748</span></span>
<span><span class="co">## 210       534.5971 524.3509 546.0680</span></span>
<span><span class="co">## 211       535.3411 527.3587 548.5156</span></span>
<span><span class="co">## 212       536.4773 526.2785 567.8710</span></span>
<span><span class="co">## 213       536.1518 526.7067 562.0948</span></span>
<span><span class="co">## 214       536.1880 525.1091 561.4326</span></span>
<span><span class="co">## 215       535.6512 526.9736 545.8258</span></span>
<span><span class="co">## 216       536.8984 527.6312 551.0697</span></span>
<span><span class="co">## 217       536.7244 529.2853 549.1911</span></span>
<span><span class="co">## 218       535.8668 525.9260 549.9064</span></span>
<span><span class="co">## 219       536.9397 525.9946 549.7607</span></span>
<span><span class="co">## 220       536.1102 526.3472 548.8727</span></span></code></pre>
<p>Visualizing the forecasts:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj_rf</span>, main<span class="op">=</span><span class="st">"Random Forest (caret)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj_glmboost</span>, main<span class="op">=</span><span class="st">"Gradient Boosting (caret)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mlarch_files/figure-html/plot_caret-1.png" width="691.2"></p>
<p>Looking at the simulation paths:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">obj_rf</span><span class="op">$</span><span class="va">sims</span>, type<span class="op">=</span><span class="st">'l'</span>, main<span class="op">=</span><span class="st">"RF Simulation Paths"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">obj_glmboost</span><span class="op">$</span><span class="va">sims</span>, type<span class="op">=</span><span class="st">'l'</span>, main<span class="op">=</span><span class="st">"GBM Simulation Paths"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mlarch_files/figure-html/plot_sims-1.png" width="691.2"></p>
</div>
<div class="section level2">
<h2 id="customizing-mean-and-residual-models">Customizing Mean and Residual Models<a class="anchor" aria-label="anchor" href="#customizing-mean-and-residual-models"></a>
</h2>
<p>You can also customize both the mean forecasting model and the model
for forecasting standardized residuals:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using RW + Theta method for mean and residuals along with SVM for volatility</span></span>
<span><span class="op">(</span><span class="va">obj_svm</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/mlarchf.html">mlarchf</a></span><span class="op">(</span><span class="va">y</span>, fit_func <span class="op">=</span> <span class="fu">e1071</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/e1071/man/svm.html" class="external-link">svm</a></span>, </span>
<span>                     predict_func <span class="op">=</span> <span class="va">predict</span>, h<span class="op">=</span><span class="fl">20L</span>, </span>
<span>                     mean_model<span class="op">=</span><span class="fu">forecast</span><span class="fu">::</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/reference/naive.html" class="external-link">rwf</a></span>,</span>
<span>                     model_residuals<span class="op">=</span><span class="fu">forecast</span><span class="fu">::</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/reference/thetaf.html" class="external-link">thetaf</a></span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Point Forecast    Lo 95    Hi 95</span></span>
<span><span class="co">## 201       531.8340 523.8251 545.4631</span></span>
<span><span class="co">## 202       534.3448 531.4783 550.0879</span></span>
<span><span class="co">## 203       534.4511 531.4783 547.2808</span></span>
<span><span class="co">## 204       532.9561 528.7915 549.6344</span></span>
<span><span class="co">## 205       531.7278 525.0309 542.8341</span></span>
<span><span class="co">## 206       533.2221 526.4892 551.1808</span></span>
<span><span class="co">## 207       534.8013 531.4783 563.1908</span></span>
<span><span class="co">## 208       534.3781 530.8451 550.2954</span></span>
<span><span class="co">## 209       532.9981 531.4783 543.0524</span></span>
<span><span class="co">## 210       533.1507 525.8080 548.1471</span></span>
<span><span class="co">## 211       533.7038 531.2925 551.1242</span></span>
<span><span class="co">## 212       534.9387 531.4783 584.5719</span></span>
<span><span class="co">## 213       534.7751 530.3424 569.5082</span></span>
<span><span class="co">## 214       534.8647 526.9307 568.2049</span></span>
<span><span class="co">## 215       533.6290 531.4783 545.8408</span></span>
<span><span class="co">## 216       534.7670 530.9297 553.8656</span></span>
<span><span class="co">## 217       535.1972 531.4783 552.0696</span></span>
<span><span class="co">## 218       533.8084 531.4783 553.2320</span></span>
<span><span class="co">## 219       535.4485 528.0107 553.6618</span></span>
<span><span class="co">## 220       533.9270 531.4783 551.3710</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using Theta + Theta method for mean and residuals along with GLMNET for volatility</span></span>
<span><span class="op">(</span><span class="va">obj_glmnet</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/mlarchf.html">mlarchf</a></span><span class="op">(</span><span class="va">y</span>, fit_func <span class="op">=</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="va"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span>, </span>
<span>                     predict_func <span class="op">=</span> <span class="va">predict</span>, h<span class="op">=</span><span class="fl">20L</span>, </span>
<span>                     mean_model<span class="op">=</span><span class="fu">forecast</span><span class="fu">::</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/reference/thetaf.html" class="external-link">thetaf</a></span>,</span>
<span>                     model_residuals<span class="op">=</span><span class="fu">forecast</span><span class="fu">::</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/reference/thetaf.html" class="external-link">thetaf</a></span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Point Forecast    Lo 95    Hi 95</span></span>
<span><span class="co">## 201       533.5786 522.8381 545.1027</span></span>
<span><span class="co">## 202       536.2002 527.4412 548.9331</span></span>
<span><span class="co">## 203       536.9145 528.4714 547.2302</span></span>
<span><span class="co">## 204       536.5011 528.0747 550.3803</span></span>
<span><span class="co">## 205       536.1956 525.8778 548.1924</span></span>
<span><span class="co">## 206       537.9965 528.7658 551.4630</span></span>
<span><span class="co">## 207       539.0771 529.5552 558.9502</span></span>
<span><span class="co">## 208       539.3756 529.9211 551.4379</span></span>
<span><span class="co">## 209       539.0507 530.2561 551.0285</span></span>
<span><span class="co">## 210       539.2978 529.9360 551.1353</span></span>
<span><span class="co">## 211       540.6301 532.7654 555.0398</span></span>
<span><span class="co">## 212       542.1460 531.6163 575.0902</span></span>
<span><span class="co">## 213       542.4751 532.4203 568.5553</span></span>
<span><span class="co">## 214       542.9017 531.9548 568.3273</span></span>
<span><span class="co">## 215       542.7930 534.6058 553.7479</span></span>
<span><span class="co">## 216       544.6499 535.7524 558.5393</span></span>
<span><span class="co">## 217       544.9135 537.2196 557.7038</span></span>
<span><span class="co">## 218       544.5988 535.1256 559.1490</span></span>
<span><span class="co">## 219       546.1549 535.2129 560.3674</span></span>
<span><span class="co">## 220       545.7312 536.6801 558.3306</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj_svm</span>, main<span class="op">=</span><span class="st">"SVM with RW + Theta"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mlarch_files/figure-html/plot_custom-1.png" width="691.2"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj_glmnet</span>, main<span class="op">=</span><span class="st">"Elastic Net with Theta + Theta"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mlarch_files/figure-html/plot_custom-2.png" width="691.2"></p>
<p>When using non-ARIMA models for the mean forecast, it‚Äôs important to
check if the residuals of the mean forecasting model are centered and
stationary:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Diagnostic tests for residuals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">obj_svm</span><span class="op">$</span><span class="va">resids_t_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  One Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  resids</span></span>
<span><span class="co">## t = 1.0148, df = 99, p-value = 0.3127</span></span>
<span><span class="co">## alternative hypothesis: true mean is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -0.7180739  2.2214961</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean of x </span></span>
<span><span class="co">## 0.7517111</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">obj_svm</span><span class="op">$</span><span class="va">resids_kpss_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  KPSS Test for Level Stationarity</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  resids</span></span>
<span><span class="co">## KPSS Level = -5.6618e-230, Truncation lag parameter = 4, p-value = 0.1</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">obj_glmnet</span><span class="op">$</span><span class="va">resids_t_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  One Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  resids</span></span>
<span><span class="co">## t = 1.0992, df = 100, p-value = 0.2743</span></span>
<span><span class="co">## alternative hypothesis: true mean is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -0.6460748  2.2513707</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean of x </span></span>
<span><span class="co">## 0.8026479</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">obj_glmnet</span><span class="op">$</span><span class="va">resids_kpss_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  KPSS Test for Level Stationarity</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  resids</span></span>
<span><span class="co">## KPSS Level = 0.26089, Truncation lag parameter = 4, p-value = 0.1</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by T. Moudiki.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
