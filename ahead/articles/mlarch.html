<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Beyond GARCH • ahead</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Beyond GARCH">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ahead</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.20.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ahead-loess-forecasting.html">Prediction intervals for Loess forecasting (simulation-based)</a>
    </li>
    <li>
      <a href="../articles/ahead-neutralize.html">Risk-neutralize simulations</a>
    </li>
    <li>
      <a href="../articles/ahead-plotting-functions.html">Plotting functions</a>
    </li>
    <li>
      <a href="../articles/ahead-ridge2-conformal.html">Conformal Prediction using Ridge2</a>
    </li>
    <li>
      <a href="../articles/ahead-ridge2-prediction-intervals.html">Prediction intervals for multivariate time series (simulation-based)</a>
    </li>
    <li>
      <a href="../articles/ahead-univariate-season.html">Univariate forecasting with `ridge2f` in `ahead`</a>
    </li>
    <li>
      <a href="../articles/ahead-vignette.html">Introduction to R package `ahead`</a>
    </li>
    <li>
      <a href="../articles/caretfitpredict.html">Fit and forecast using caret+dynrmf</a>
    </li>
    <li>
      <a href="../articles/comb_OLS.html">comb OLS Electricity</a>
    </li>
    <li>
      <a href="../articles/comb_OLS2.html">comb OLS AirPassengers</a>
    </li>
    <li>
      <a href="../articles/conformal-ml-stacking.html">Conformalized Forecasting using Machine Leaning models -- with stacked generalization</a>
    </li>
    <li>
      <a href="../articles/conformal-ml.html">Conformalized Forecasting using Machine Leaning models</a>
    </li>
    <li>
      <a href="../articles/conformal-ml2.html">Conformalized Forecasting using Machine Leaning models</a>
    </li>
    <li>
      <a href="../articles/fitforecastbench.html">Fit and forecast for benchmarking purposes</a>
    </li>
    <li>
      <a href="../articles/generic-conformal.html">Generic forecasting and conformal prediction</a>
    </li>
    <li>
      <a href="../articles/glmthetaf-attention-conformal.html">Generalized Linear Model Theta Forecast with attention - conformal uncertainty</a>
    </li>
    <li>
      <a href="../articles/glmthetaf-attention.html">Generalized Linear Model Theta Forecast with attention</a>
    </li>
    <li>
      <a href="../articles/glmthetaf-ridge-attention.html">Ridge Theta Forecast with attention - conformal uncertainty</a>
    </li>
    <li>
      <a href="../articles/glmthetaf.html">Generalized Linear Model Theta Forecast</a>
    </li>
    <li>
      <a href="../articles/mlarch.html">Beyond GARCH</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Beyond GARCH</h1>
            
      

      <div class="hidden name"><code>mlarch.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Probabilistic stock forecasting often relies on parametric models
like ARIMA for the mean and GARCH for volatility. The
<code>mlarchf</code> function in the <code>ahead</code> package offers a
flexible hybrid alternative to ARMA-GARCH by combining machine learning
approaches with ARCH effects.</p>
<p>The model decomposes the time series into two components:</p>
<ol style="list-style-type: decimal">
<li>Mean component:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><msub><mi>μ</mi><mi>t</mi></msub><mo>+</mo><msub><mi>σ</mi><mi>t</mi></msub><msub><mi>ε</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">y_t = \mu_t + \sigma_t \varepsilon_t</annotation></semantics></math>
</li>
<li>Volatility component:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mi>t</mi><mn>2</mn></msubsup><mo>=</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mn>2</mn></msubsup><mo>,</mo><msubsup><mi>ε</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow><mn>2</mn></msubsup><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma_t^2 = f(\varepsilon_{t-1}^2, \varepsilon_{t-2}^2, ...)</annotation></semantics></math>
</li>
</ol>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\mu_t</annotation></semantics></math>
is the conditional mean (modeled using <strong>any forecasting
method</strong>)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\sigma_t</annotation></semantics></math>
is the conditional volatility (modeled using <strong>machine
learning</strong>)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ε</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\varepsilon_t</annotation></semantics></math>
are standardized residuals</li>
</ul>
<p>The <strong>key innovation</strong> is using machine learning methods
and conformal prediction to model the volatility component, allowing for
more flexible and potentially more accurate volatility forecasts than
traditional GARCH models. The function supports various machine learning
methods through parameters <code>fit_func</code> and
<code>predict_func</code> as in other <code>ahead</code> models, and
through the <code>caret</code> package.</p>
<p>The forecasting process involves:</p>
<ul>
<li>Fitting a mean model (default: <code>auto.arima</code>)</li>
<li>Modeling the squared residuals using machine learning. For this to
work, the residuals from the mean model need to be centered, so
that</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝔼</mi><mrow><mo stretchy="true" form="prefix">[</mo><msubsup><mi>ϵ</mi><mi>t</mi><mn>2</mn></msubsup><mo stretchy="false" form="prefix">|</mo><msub><mi>F</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
\mathbb{E}[\epsilon_t^2|F_{t-1}]
</annotation></semantics></math></p>
<p>(basically a supervised regression of squared residuals on their
lags) is a good approximation of the latent conditional volatility</p>
<ul>
<li>Conformalizing the standardized residuals for prediction
intervals</li>
</ul>
<p>This new approach combines the interpretability of traditional time
series models with the flexibility of machine learning, while
maintaining proper uncertainty quantification through conformal
prediction.</p>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<p>Let’s start with a simple example using the Google stock price data
from the <code>fpp2</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">fpp2</span><span class="fu">::</span><span class="va"><a href="https://pkg.robjhyndman.com/fpp2-package/reference/goog.html" class="external-link">goog200</a></span></span>
<span></span>
<span><span class="co"># Default model for volatility (Ridge regression for volatility)</span></span>
<span><span class="op">(</span><span class="va">obj_ridge</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/mlarchf.html">mlarchf</a></span><span class="op">(</span><span class="va">y</span>, h<span class="op">=</span><span class="fl">20L</span>, B<span class="op">=</span><span class="fl">500L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Point Forecast    Lo 95    Hi 95</span></span>
<span><span class="co">## 201       534.2541 512.7005 552.3607</span></span>
<span><span class="co">## 202       534.6423 502.2771 557.7232</span></span>
<span><span class="co">## 203       531.6017 511.4929 553.6944</span></span>
<span><span class="co">## 204       536.8212 506.3934 562.6331</span></span>
<span><span class="co">## 205       537.1214 515.9948 556.2671</span></span>
<span><span class="co">## 206       537.2112 513.0587 558.7980</span></span>
<span><span class="co">## 207       537.8388 503.1394 558.0224</span></span>
<span><span class="co">## 208       539.0939 516.2791 559.2532</span></span>
<span><span class="co">## 209       539.7927 518.1542 561.0321</span></span>
<span><span class="co">## 210       538.6715 511.1846 562.7483</span></span>
<span><span class="co">## 211       540.9258 501.6186 565.0454</span></span>
<span><span class="co">## 212       541.2588 517.6220 564.5185</span></span>
<span><span class="co">## 213       541.4309 508.8563 563.8305</span></span>
<span><span class="co">## 214       542.2194 514.9613 564.8986</span></span>
<span><span class="co">## 215       543.3127 516.1817 564.1709</span></span>
<span><span class="co">## 216       544.5975 524.2303 562.8741</span></span>
<span><span class="co">## 217       545.2311 522.7227 569.1356</span></span>
<span><span class="co">## 218       546.4706 526.8154 564.1152</span></span>
<span><span class="co">## 219       547.0501 513.2194 571.0685</span></span>
<span><span class="co">## 220       546.4400 519.9851 569.2394</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="different-machine-learning-methods">Different Machine Learning Methods<a class="anchor" aria-label="anchor" href="#different-machine-learning-methods"></a>
</h2>
<p>The package supports various machine learning methods for volatility
modeling. Here are some examples:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Random Forest</span></span>
<span><span class="op">(</span><span class="va">obj_rf</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/mlarchf.html">mlarchf</a></span><span class="op">(</span><span class="va">y</span>, fit_func <span class="op">=</span> <span class="fu">randomForest</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a></span>, </span>
<span>                     predict_func <span class="op">=</span> <span class="va">predict</span>, h<span class="op">=</span><span class="fl">20L</span>, B<span class="op">=</span><span class="fl">500L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Point Forecast    Lo 95    Hi 95</span></span>
<span><span class="co">## 201       534.0159 520.9542 543.1924</span></span>
<span><span class="co">## 202       537.2902 490.3225 587.6412</span></span>
<span><span class="co">## 203       531.6931 526.9703 540.6487</span></span>
<span><span class="co">## 204       542.5556 502.2263 590.5716</span></span>
<span><span class="co">## 205       535.8584 527.4970 542.2554</span></span>
<span><span class="co">## 206       539.3621 498.8091 579.2929</span></span>
<span><span class="co">## 207       537.4664 522.6626 548.8695</span></span>
<span><span class="co">## 208       542.0397 508.8091 575.6179</span></span>
<span><span class="co">## 209       539.0960 532.4078 548.1384</span></span>
<span><span class="co">## 210       539.6872 485.6650 580.9918</span></span>
<span><span class="co">## 211       539.9266 523.4049 547.2282</span></span>
<span><span class="co">## 212       543.0664 507.7779 578.5372</span></span>
<span><span class="co">## 213       540.8806 530.2707 546.8225</span></span>
<span><span class="co">## 214       543.9351 479.6184 587.3773</span></span>
<span><span class="co">## 215       542.3772 533.9899 549.5630</span></span>
<span><span class="co">## 216       547.3840 517.4481 581.2031</span></span>
<span><span class="co">## 217       544.2022 530.3728 553.5204</span></span>
<span><span class="co">## 218       550.0734 512.6420 586.6612</span></span>
<span><span class="co">## 219       545.5816 532.6964 553.7377</span></span>
<span><span class="co">## 220       546.9096 510.5368 570.9965</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Support Vector Machine</span></span>
<span><span class="op">(</span><span class="va">obj_svm</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/mlarchf.html">mlarchf</a></span><span class="op">(</span><span class="va">y</span>, fit_func <span class="op">=</span> <span class="fu">e1071</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/e1071/man/svm.html" class="external-link">svm</a></span>, </span>
<span>                     predict_func <span class="op">=</span> <span class="va">predict</span>, h<span class="op">=</span><span class="fl">20L</span>, B<span class="op">=</span><span class="fl">500L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Point Forecast    Lo 95    Hi 95</span></span>
<span><span class="co">## 201       533.1339 523.3062 541.6084</span></span>
<span><span class="co">## 202       534.1918 510.2528 553.2471</span></span>
<span><span class="co">## 203       532.5771 521.6773 545.4500</span></span>
<span><span class="co">## 204       536.6727 508.9950 561.2681</span></span>
<span><span class="co">## 205       536.4719 520.1975 552.7401</span></span>
<span><span class="co">## 206       536.9900 516.5820 555.7390</span></span>
<span><span class="co">## 207       537.5020 511.5053 554.4331</span></span>
<span><span class="co">## 208       538.7870 519.8940 555.9879</span></span>
<span><span class="co">## 209       539.3159 520.2680 555.5655</span></span>
<span><span class="co">## 210       538.5694 517.2322 557.7531</span></span>
<span><span class="co">## 211       540.6991 510.2075 560.7600</span></span>
<span><span class="co">## 212       540.9974 522.4648 560.0051</span></span>
<span><span class="co">## 213       541.3215 514.9596 560.0394</span></span>
<span><span class="co">## 214       542.1177 520.7079 560.3652</span></span>
<span><span class="co">## 215       542.5232 520.7394 561.3015</span></span>
<span><span class="co">## 216       544.2347 528.5013 558.9817</span></span>
<span><span class="co">## 217       544.8473 524.9007 564.6974</span></span>
<span><span class="co">## 218       545.9705 530.3819 562.0458</span></span>
<span><span class="co">## 219       546.6228 519.6270 565.9742</span></span>
<span><span class="co">## 220       546.2731 523.5324 565.2891</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Elastic Net</span></span>
<span><span class="op">(</span><span class="va">obj_glmnet</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/mlarchf.html">mlarchf</a></span><span class="op">(</span><span class="va">y</span>, fit_func <span class="op">=</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="va"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span>, </span>
<span>                     predict_func <span class="op">=</span> <span class="va">predict</span>, h<span class="op">=</span><span class="fl">20L</span>, B<span class="op">=</span><span class="fl">500L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Point Forecast    Lo 95    Hi 95</span></span>
<span><span class="co">## 201       534.6730 508.7761 556.4285</span></span>
<span><span class="co">## 202       534.4628 505.3801 555.2027</span></span>
<span><span class="co">## 203       531.5346 510.7405 554.3804</span></span>
<span><span class="co">## 204       536.7864 506.7732 562.2466</span></span>
<span><span class="co">## 205       537.1356 515.8700 556.4073</span></span>
<span><span class="co">## 206       537.2099 513.0769 558.7794</span></span>
<span><span class="co">## 207       537.8421 503.0666 558.0698</span></span>
<span><span class="co">## 208       539.0961 516.2570 559.2768</span></span>
<span><span class="co">## 209       539.7957 518.1246 561.0673</span></span>
<span><span class="co">## 210       538.6718 511.1481 562.7808</span></span>
<span><span class="co">## 211       540.9283 501.5659 565.0819</span></span>
<span><span class="co">## 212       541.2608 517.5914 564.5526</span></span>
<span><span class="co">## 213       541.4322 508.8123 563.8629</span></span>
<span><span class="co">## 214       542.2208 514.9249 564.9314</span></span>
<span><span class="co">## 215       543.3147 516.1459 564.2017</span></span>
<span><span class="co">## 216       544.6002 524.2048 562.9022</span></span>
<span><span class="co">## 217       545.2338 522.6941 569.1714</span></span>
<span><span class="co">## 218       546.4740 526.7915 564.1431</span></span>
<span><span class="co">## 219       547.0533 513.1757 571.1051</span></span>
<span><span class="co">## 220       546.4414 519.9498 569.2724</span></span></code></pre>
<p>Let’s visualize the forecasts:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj_ridge</span>, main<span class="op">=</span><span class="st">"Ridge Regression"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj_rf</span>, main<span class="op">=</span><span class="st">"Random Forest"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mlarch_files/figure-html/plot_ridge_rf-1.png" width="691.2"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj_svm</span>, main<span class="op">=</span><span class="st">"Support Vector Machine"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj_glmnet</span>, main<span class="op">=</span><span class="st">"Elastic Net"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mlarch_files/figure-html/plot_svm_glmnet-1.png" width="691.2"></p>
</div>
<div class="section level2">
<h2 id="using-caret-models">Using caret Models<a class="anchor" aria-label="anchor" href="#using-caret-models"></a>
</h2>
<p>The package also supports models from the <code>caret</code> package,
which provides access to hundreds of machine learning methods. Here’s
how to use them:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/window.html" class="external-link">window</a></span><span class="op">(</span><span class="fu">fpp2</span><span class="fu">::</span><span class="va"><a href="https://pkg.robjhyndman.com/fpp2-package/reference/goog.html" class="external-link">goog200</a></span>, start<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Random Forest via caret</span></span>
<span><span class="op">(</span><span class="va">obj_rf</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/mlarchf.html">mlarchf</a></span><span class="op">(</span><span class="va">y</span>, ml_method<span class="op">=</span><span class="st">"ranger"</span>, h<span class="op">=</span><span class="fl">20L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Point Forecast    Lo 95    Hi 95</span></span>
<span><span class="co">## 201       532.9162 521.2100 545.0998</span></span>
<span><span class="co">## 202       542.0707 513.7720 606.8034</span></span>
<span><span class="co">## 203       536.6156 525.8142 559.7745</span></span>
<span><span class="co">## 204       537.8822 521.1372 580.7287</span></span>
<span><span class="co">## 205       537.1546 509.4761 565.7132</span></span>
<span><span class="co">## 206       537.8189 517.3974 572.0399</span></span>
<span><span class="co">## 207       535.0668 525.2457 564.1666</span></span>
<span><span class="co">## 208       539.2166 516.1806 579.3233</span></span>
<span><span class="co">## 209       536.6969 524.8034 561.7561</span></span>
<span><span class="co">## 210       536.2132 520.7161 570.8188</span></span>
<span><span class="co">## 211       536.2587 525.6450 561.5486</span></span>
<span><span class="co">## 212       538.5170 520.3597 577.5364</span></span>
<span><span class="co">## 213       536.3716 526.6066 574.9143</span></span>
<span><span class="co">## 214       539.2696 512.3047 593.9620</span></span>
<span><span class="co">## 215       536.0739 526.4491 570.0661</span></span>
<span><span class="co">## 216       538.3305 521.9893 574.8221</span></span>
<span><span class="co">## 217       542.6543 520.9201 601.0671</span></span>
<span><span class="co">## 218       540.3616 516.5601 567.7309</span></span>
<span><span class="co">## 219       538.6467 524.4831 587.5485</span></span>
<span><span class="co">## 220       537.7820 525.1554 565.3565</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Gradient Boosting via caret</span></span>
<span><span class="op">(</span><span class="va">obj_glmboost</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/mlarchf.html">mlarchf</a></span><span class="op">(</span><span class="va">y</span>, ml_method<span class="op">=</span><span class="st">"glmboost"</span>, h<span class="op">=</span><span class="fl">20L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Point Forecast    Lo 95    Hi 95</span></span>
<span><span class="co">## 201       534.2694 518.8609 558.4107</span></span>
<span><span class="co">## 202       541.2883 514.8659 583.6918</span></span>
<span><span class="co">## 203       539.6626 523.8154 559.4926</span></span>
<span><span class="co">## 204       539.1105 519.7944 584.2025</span></span>
<span><span class="co">## 205       535.8913 516.3941 560.6932</span></span>
<span><span class="co">## 206       539.4092 516.3546 589.0730</span></span>
<span><span class="co">## 207       540.7346 519.2800 594.9133</span></span>
<span><span class="co">## 208       540.6068 517.8368 585.0502</span></span>
<span><span class="co">## 209       540.0550 521.5931 565.6433</span></span>
<span><span class="co">## 210       538.6147 517.7842 569.1785</span></span>
<span><span class="co">## 211       539.5135 523.7022 584.3756</span></span>
<span><span class="co">## 212       542.4832 521.8640 613.1290</span></span>
<span><span class="co">## 213       540.5787 519.1449 601.2747</span></span>
<span><span class="co">## 214       540.8575 510.3267 603.5387</span></span>
<span><span class="co">## 215       539.7381 525.0678 591.3527</span></span>
<span><span class="co">## 216       544.0127 514.9348 588.6763</span></span>
<span><span class="co">## 217       541.3015 525.6672 594.0188</span></span>
<span><span class="co">## 218       539.8837 520.8755 586.3994</span></span>
<span><span class="co">## 219       544.7746 520.9124 586.5594</span></span>
<span><span class="co">## 220       541.1185 522.0672 588.7918</span></span></code></pre>
<p>Visualizing the forecasts:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj_rf</span>, main<span class="op">=</span><span class="st">"Random Forest (caret)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj_glmboost</span>, main<span class="op">=</span><span class="st">"Gradient Boosting (caret)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mlarch_files/figure-html/plot_caret-1.png" width="691.2"></p>
<p>Looking at the simulation paths:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">obj_rf</span><span class="op">$</span><span class="va">sims</span>, type<span class="op">=</span><span class="st">'l'</span>, main<span class="op">=</span><span class="st">"RF Simulation Paths"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">obj_glmboost</span><span class="op">$</span><span class="va">sims</span>, type<span class="op">=</span><span class="st">'l'</span>, main<span class="op">=</span><span class="st">"GBM Simulation Paths"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mlarch_files/figure-html/plot_sims-1.png" width="691.2"></p>
</div>
<div class="section level2">
<h2 id="customizing-mean-and-residual-models">Customizing Mean and Residual Models<a class="anchor" aria-label="anchor" href="#customizing-mean-and-residual-models"></a>
</h2>
<p>You can also customize both the mean forecasting model and the model
for forecasting standardized residuals:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using RW + Theta method for mean and residuals along with SVM for volatility</span></span>
<span><span class="op">(</span><span class="va">obj_svm</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/mlarchf.html">mlarchf</a></span><span class="op">(</span><span class="va">y</span>, fit_func <span class="op">=</span> <span class="fu">e1071</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/e1071/man/svm.html" class="external-link">svm</a></span>, </span>
<span>                     predict_func <span class="op">=</span> <span class="va">predict</span>, h<span class="op">=</span><span class="fl">20L</span>, </span>
<span>                     mean_model<span class="op">=</span><span class="fu">forecast</span><span class="fu">::</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/reference/naive.html" class="external-link">rwf</a></span>,</span>
<span>                     model_residuals<span class="op">=</span><span class="fu">forecast</span><span class="fu">::</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/reference/thetaf.html" class="external-link">thetaf</a></span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Point Forecast    Lo 95    Hi 95</span></span>
<span><span class="co">## 201       534.2761 518.8773 558.5154</span></span>
<span><span class="co">## 202       542.6780 512.5850 591.2690</span></span>
<span><span class="co">## 203       539.3825 524.1203 559.0725</span></span>
<span><span class="co">## 204       540.7554 517.3005 595.8953</span></span>
<span><span class="co">## 205       535.8410 516.5428 560.4248</span></span>
<span><span class="co">## 206       540.8266 513.6361 599.7767</span></span>
<span><span class="co">## 207       540.9625 519.0747 595.3212</span></span>
<span><span class="co">## 208       541.9211 515.9533 592.4186</span></span>
<span><span class="co">## 209       540.4952 521.1336 567.1889</span></span>
<span><span class="co">## 210       539.4892 516.2908 573.8738</span></span>
<span><span class="co">## 211       540.0182 523.2295 587.9505</span></span>
<span><span class="co">## 212       543.6659 520.8964 621.9065</span></span>
<span><span class="co">## 213       541.2562 518.1388 606.5975</span></span>
<span><span class="co">## 214       541.7677 508.1439 610.7653</span></span>
<span><span class="co">## 215       540.4008 524.5452 596.4184</span></span>
<span><span class="co">## 216       545.2035 513.4671 593.9008</span></span>
<span><span class="co">## 217       542.0959 525.1215 599.6508</span></span>
<span><span class="co">## 218       540.6441 520.0346 591.9502</span></span>
<span><span class="co">## 219       545.9244 520.0419 591.3528</span></span>
<span><span class="co">## 220       541.9762 521.2350 594.5949</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using Theta + Theta method for mean and residuals along with GLMNET for volatility</span></span>
<span><span class="op">(</span><span class="va">obj_glmnet</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/mlarchf.html">mlarchf</a></span><span class="op">(</span><span class="va">y</span>, fit_func <span class="op">=</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="va"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html" class="external-link">cv.glmnet</a></span>, </span>
<span>                     predict_func <span class="op">=</span> <span class="va">predict</span>, h<span class="op">=</span><span class="fl">20L</span>, </span>
<span>                     mean_model<span class="op">=</span><span class="fu">forecast</span><span class="fu">::</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/reference/thetaf.html" class="external-link">thetaf</a></span>,</span>
<span>                     model_residuals<span class="op">=</span><span class="fu">forecast</span><span class="fu">::</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/reference/thetaf.html" class="external-link">thetaf</a></span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Point Forecast    Lo 95    Hi 95</span></span>
<span><span class="co">## 201       535.8135 514.1987 571.9909</span></span>
<span><span class="co">## 202       538.5835 521.6369 565.5215</span></span>
<span><span class="co">## 203       541.3194 524.8385 563.3388</span></span>
<span><span class="co">## 204       539.5938 524.8692 578.2095</span></span>
<span><span class="co">## 205       537.8688 521.4224 561.3728</span></span>
<span><span class="co">## 206       540.9987 524.2488 578.8469</span></span>
<span><span class="co">## 207       543.3177 526.9597 589.3057</span></span>
<span><span class="co">## 208       543.3685 524.5164 583.1396</span></span>
<span><span class="co">## 209       543.1559 525.8245 567.4223</span></span>
<span><span class="co">## 210       542.4533 527.2598 570.6816</span></span>
<span><span class="co">## 211       544.0698 530.7752 584.4625</span></span>
<span><span class="co">## 212       546.8171 528.3885 605.0747</span></span>
<span><span class="co">## 213       546.1443 529.2912 599.9006</span></span>
<span><span class="co">## 214       546.5470 522.5503 601.7464</span></span>
<span><span class="co">## 215       546.1457 534.3143 593.9578</span></span>
<span><span class="co">## 216       550.3745 533.2594 590.1594</span></span>
<span><span class="co">## 217       548.5356 535.3032 595.9426</span></span>
<span><span class="co">## 218       547.7789 530.5011 589.1992</span></span>
<span><span class="co">## 219       552.5480 530.9739 591.8940</span></span>
<span><span class="co">## 220       549.5759 534.1405 592.6026</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj_svm</span>, main<span class="op">=</span><span class="st">"SVM with RW + Theta"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mlarch_files/figure-html/plot_custom-1.png" width="691.2"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj_glmnet</span>, main<span class="op">=</span><span class="st">"Elastic Net with Theta + Theta"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mlarch_files/figure-html/plot_custom-2.png" width="691.2"></p>
<p>When using non-ARIMA models for the mean forecast, it’s important to
check if the residuals of the mean forecasting model are centered and
stationary:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Diagnostic tests for residuals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">obj_svm</span><span class="op">$</span><span class="va">resids_t_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  One Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  resids</span></span>
<span><span class="co">## t = 1.0148, df = 99, p-value = 0.3127</span></span>
<span><span class="co">## alternative hypothesis: true mean is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -0.7180739  2.2214961</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean of x </span></span>
<span><span class="co">## 0.7517111</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">obj_svm</span><span class="op">$</span><span class="va">resids_kpss_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  KPSS Test for Level Stationarity</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  resids</span></span>
<span><span class="co">## KPSS Level = 0.25272, Truncation lag parameter = 4, p-value = 0.1</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">obj_glmnet</span><span class="op">$</span><span class="va">resids_t_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  One Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  resids</span></span>
<span><span class="co">## t = 1.0992, df = 100, p-value = 0.2743</span></span>
<span><span class="co">## alternative hypothesis: true mean is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -0.6460748  2.2513707</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean of x </span></span>
<span><span class="co">## 0.8026479</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">obj_glmnet</span><span class="op">$</span><span class="va">resids_kpss_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  KPSS Test for Level Stationarity</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  resids</span></span>
<span><span class="co">## KPSS Level = 0.26089, Truncation lag parameter = 4, p-value = 0.1</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by T. Moudiki.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
