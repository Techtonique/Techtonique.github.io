<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prediction intervals for multivariate time series (simulation-based) • ahead</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Prediction intervals for multivariate time series (simulation-based)">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ahead</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.26.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ahead-loess-forecasting.html">Prediction intervals for Loess forecasting (simulation-based)</a>
    </li>
    <li>
      <a href="../articles/ahead-neutralize.html">Risk-neutralize simulations</a>
    </li>
    <li>
      <a href="../articles/ahead-plotting-functions.html">Plotting functions</a>
    </li>
    <li>
      <a href="../articles/ahead-ridge2-conformal.html">Conformal Prediction using Ridge2</a>
    </li>
    <li>
      <a href="../articles/ahead-ridge2-prediction-intervals.html">Prediction intervals for multivariate time series (simulation-based)</a>
    </li>
    <li>
      <a href="../articles/ahead-univariate-season.html">Univariate forecasting with `ridge2f` in `ahead`</a>
    </li>
    <li>
      <a href="../articles/ahead-vignette.html">Introduction to R package `ahead`</a>
    </li>
    <li>
      <a href="../articles/anymodelplusgarch.html">Any model + GARCH(1, 1)</a>
    </li>
    <li>
      <a href="../articles/caretfitpredict.html">Fit and forecast using caret+dynrmf</a>
    </li>
    <li>
      <a href="../articles/comb_OLS.html">comb OLS Electricity</a>
    </li>
    <li>
      <a href="../articles/comb_OLS2.html">comb OLS AirPassengers</a>
    </li>
    <li>
      <a href="../articles/conformal-ml-stacking.html">Conformalized Forecasting using Machine Leaning models -- with stacked generalization</a>
    </li>
    <li>
      <a href="../articles/conformal-ml-stacking2.html">Conformalized Forecasting using Machine Leaning models -- with stacked generalization</a>
    </li>
    <li>
      <a href="../articles/conformal-ml.html">Conformalized Forecasting using Machine Leaning models</a>
    </li>
    <li>
      <a href="../articles/conformal-ml2.html">Conformalized Forecasting using Machine Leaning models 2</a>
    </li>
    <li>
      <a href="../articles/fitforecastbench.html">Fit and forecast for benchmarking purposes</a>
    </li>
    <li>
      <a href="../articles/generic-conformal.html">Generic forecasting and conformal prediction</a>
    </li>
    <li>
      <a href="../articles/glmthetaf-attention-conformal.html">Generalized Linear Model Theta Forecast with attention - conformal uncertainty</a>
    </li>
    <li>
      <a href="../articles/glmthetaf-attention.html">Generalized Linear Model Theta Forecast with attention</a>
    </li>
    <li>
      <a href="../articles/glmthetaf-ridge-attention.html">Ridge Theta Forecast with attention - conformal uncertainty</a>
    </li>
    <li>
      <a href="../articles/glmthetaf.html">Generalized Linear Model Theta Forecast</a>
    </li>
    <li>
      <a href="../articles/mlarch.html">Beyond GARCH</a>
    </li>
    <li>
      <a href="../articles/mlarch2.html">Beyond GARCH 2</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Prediction intervals for multivariate time
series (simulation-based)</h1>
            
      

      <div class="hidden name"><code>ahead-ridge2-prediction-intervals.Rmd</code></div>

    </div>

    
    
<p><code>ahead</code> is a package for <strong>univariate</strong> and
<strong>multivariate time series forecasting</strong>, with uncertainty
quantification (R and <a href="https://techtonique.github.io/ahead_python/" class="external-link">Python</a>).</p>
<p>The model used in this demo is the one presented in <a href="https://www.mdpi.com/2227-9091/6/1/22" class="external-link">this paper</a>, and has
actually been significantly improved since 2018, as you’ll see here.</p>
<p>Currently for this model (as of 2023-08-28), for <strong>uncertainty
quantification</strong>, I have:</p>
<ul>
<li>Gaussian distribution</li>
<li>Independent <strong>bootstrap</strong> simulation</li>
<li>Multivariate circular <strong>block bootstrap</strong>
simulation</li>
<li>Multivariate moving block bootstrap simulation</li>
<li>Copula simulation</li>
<li>
<strong>More options to come</strong> in the future.</li>
</ul>
<p>Please remember that <em>in real life</em>, this model’s
hyperparameters will have to be tuned.</p>
<p><strong>Contents:</strong></p>
<ul>
<li>0 - Install <code>ahead</code>
</li>
<li>1 - Prediction intervals based on <strong>Gaussian</strong>
distribution (meh, but quick)</li>
<li>2 - Prediction intervals based on <strong>independent
bootstrap</strong>
</li>
<li>3 - Prediction intervals based on <strong>block
bootstrap</strong>
</li>
<li>4 - Prediction intervals based on moving block bootstrap</li>
<li>5 - Prediction intervals based on R-Vine copula simulation</li>
</ul>
<div class="section level2">
<h2 id="install-ahead">0 - Install <code>ahead</code><a class="anchor" aria-label="anchor" href="#install-ahead"></a>
</h2>
<p>Here’s how to install the R version of the package:</p>
<ul>
<li>
<p><strong>1st method</strong>: from <a href="https://r-packages.techtonique.net" class="external-link">R-universe</a></p>
<p>In R console:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    techtonique <span class="op">=</span> <span class="st">'https://r-packages.techtonique.net'</span>,</span>
<span>    CRAN <span class="op">=</span> <span class="st">'https://cloud.r-project.org'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ahead"</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p><strong>2nd method</strong>: from <a href="https://github.com/Techtonique/ahead" class="external-link">Github</a></p>
<p>In R console:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"Techtonique/ahead"</span><span class="op">)</span></span></code></pre></div>
<p>Or</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"Techtonique/ahead"</span><span class="op">)</span></span></code></pre></div>
</li>
</ul>
<p>And here are the packages that will be used in this vignette:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ahead</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://otexts.com/fpp/" class="external-link">fpp</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="prediction-intervals-based-on-gaussian-distribution-meh-but-quick">1 - Prediction intervals based on Gaussian distribution (meh, but
quick)<a class="anchor" aria-label="anchor" href="#prediction-intervals-based-on-gaussian-distribution-meh-but-quick"></a>
</h2>
<div class="section level3">
<h3 id="with-default-parameters">1 - 1 With default parameters<a class="anchor" aria-label="anchor" href="#with-default-parameters"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fl">10L</span> <span class="co"># forecasting horizon</span></span>
<span></span>
<span><span class="op">(</span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.76393  8.947782</span></span>
<span><span class="co">#&gt; Jun 2005 14.61841  8.862613</span></span>
<span><span class="co">#&gt; Jul 2005 14.56234  8.841193</span></span>
<span><span class="co">#&gt; Aug 2005 14.49305  8.809091</span></span>
<span><span class="co">#&gt; Sep 2005 14.43100  8.781208</span></span>
<span><span class="co">#&gt; Oct 2005 14.37179  8.754418</span></span>
<span><span class="co">#&gt; Nov 2005 14.31606  8.729243</span></span>
<span><span class="co">#&gt; Dec 2005 14.26346  8.705474</span></span>
<span><span class="co">#&gt; Jan 2006 14.21385  8.683054</span></span>
<span><span class="co">#&gt; Feb 2006 14.16704  8.661902</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 11.96618  7.011446</span></span>
<span><span class="co">#&gt; Jun 2005 11.82066  6.926276</span></span>
<span><span class="co">#&gt; Jul 2005 11.76459  6.904857</span></span>
<span><span class="co">#&gt; Aug 2005 11.69530  6.872755</span></span>
<span><span class="co">#&gt; Sep 2005 11.63325  6.844872</span></span>
<span><span class="co">#&gt; Oct 2005 11.57404  6.818082</span></span>
<span><span class="co">#&gt; Nov 2005 11.51831  6.792907</span></span>
<span><span class="co">#&gt; Dec 2005 11.46571  6.769138</span></span>
<span><span class="co">#&gt; Jan 2006 11.41610  6.746718</span></span>
<span><span class="co">#&gt; Feb 2006 11.36929  6.725566</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.56168  10.88412</span></span>
<span><span class="co">#&gt; Jun 2005 17.41616  10.79895</span></span>
<span><span class="co">#&gt; Jul 2005 17.36009  10.77753</span></span>
<span><span class="co">#&gt; Aug 2005 17.29080  10.74543</span></span>
<span><span class="co">#&gt; Sep 2005 17.22875  10.71754</span></span>
<span><span class="co">#&gt; Oct 2005 17.16954  10.69075</span></span>
<span><span class="co">#&gt; Nov 2005 17.11381  10.66558</span></span>
<span><span class="co">#&gt; Dec 2005 17.06121  10.64181</span></span>
<span><span class="co">#&gt; Jan 2006 17.01160  10.61939</span></span>
<span><span class="co">#&gt; Feb 2006 16.96479  10.59824</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 13.983454  8.113042</span></span>
<span><span class="co">#&gt; Feb 2002 14.310140  8.680078</span></span>
<span><span class="co">#&gt; Mar 2002 14.204085  8.367422</span></span>
<span><span class="co">#&gt; Apr 2002 13.983454  8.113042</span></span>
<span><span class="co">#&gt; May 2002 14.310140  8.680078</span></span>
<span><span class="co">#&gt; Jun 2002 13.136549  7.573500</span></span>
<span><span class="co">#&gt; Jul 2002 12.139564  7.269130</span></span>
<span><span class="co">#&gt; Aug 2002 12.630260  7.516240</span></span>
<span><span class="co">#&gt; Sep 2002 14.247551  8.406368</span></span>
<span><span class="co">#&gt; Oct 2002 15.085483  8.610639</span></span>
<span><span class="co">#&gt; Nov 2002 15.834616  9.129753</span></span>
<span><span class="co">#&gt; Dec 2002 16.037153  9.175375</span></span>
<span><span class="co">#&gt; Jan 2003 16.609951  9.409639</span></span>
<span><span class="co">#&gt; Feb 2003 16.579674  9.347087</span></span>
<span><span class="co">#&gt; Mar 2003 16.452555  9.136445</span></span>
<span><span class="co">#&gt; Apr 2003 15.691303  8.874788</span></span>
<span><span class="co">#&gt; May 2003 14.054876  8.529575</span></span>
<span><span class="co">#&gt; Jun 2003 13.434843  8.229103</span></span>
<span><span class="co">#&gt; Jul 2003 12.715293  7.977976</span></span>
<span><span class="co">#&gt; Aug 2003 12.998432  8.104914</span></span>
<span><span class="co">#&gt; Sep 2003 12.590713  7.879126</span></span>
<span><span class="co">#&gt; Oct 2003 10.931512  7.005044</span></span>
<span><span class="co">#&gt; Nov 2003 10.416928  6.781919</span></span>
<span><span class="co">#&gt; Dec 2003 13.045036  8.079712</span></span>
<span><span class="co">#&gt; Jan 2004 13.471769  8.342884</span></span>
<span><span class="co">#&gt; Feb 2004  8.822228  6.015318</span></span>
<span><span class="co">#&gt; Mar 2004  9.707979  6.398258</span></span>
<span><span class="co">#&gt; Apr 2004  9.811491  6.420448</span></span>
<span><span class="co">#&gt; May 2004 11.936553  7.582567</span></span>
<span><span class="co">#&gt; Jun 2004 13.921151  8.555557</span></span>
<span><span class="co">#&gt; Jul 2004 14.494976  8.746341</span></span>
<span><span class="co">#&gt; Aug 2004 14.079472  8.618854</span></span>
<span><span class="co">#&gt; Sep 2004 13.046936  8.135087</span></span>
<span><span class="co">#&gt; Oct 2004 12.726572  7.953926</span></span>
<span><span class="co">#&gt; Nov 2004 12.426974  7.834539</span></span>
<span><span class="co">#&gt; Dec 2004 13.211185  7.811190</span></span>
<span><span class="co">#&gt; Jan 2005 15.485788  9.264229</span></span>
<span><span class="co">#&gt; Feb 2005 16.598686  9.685778</span></span>
<span><span class="co">#&gt; Mar 2005 16.037908  9.448414</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;               Quotes   TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.40368643  1.33052782</span></span>
<span><span class="co">#&gt; Feb 2002 -1.08056990 -1.14582835</span></span>
<span><span class="co">#&gt; Mar 2002 -1.23343504 -1.15469695</span></span>
<span><span class="co">#&gt; Apr 2002  1.40368643  1.33052782</span></span>
<span><span class="co">#&gt; May 2002 -2.58725990 -2.26486335</span></span>
<span><span class="co">#&gt; Jun 2002 -3.07477874 -1.76651025</span></span>
<span><span class="co">#&gt; Jul 2002 -1.31677412 -1.06553020</span></span>
<span><span class="co">#&gt; Aug 2002  0.65681006  0.07019039</span></span>
<span><span class="co">#&gt; Sep 2002  0.33076863 -0.40143292</span></span>
<span><span class="co">#&gt; Oct 2002  0.51993723  0.22434076</span></span>
<span><span class="co">#&gt; Nov 2002  0.10053432 -0.17249791</span></span>
<span><span class="co">#&gt; Dec 2002  0.95770684  0.35761548</span></span>
<span><span class="co">#&gt; Jan 2003  0.26825909 -0.01668861</span></span>
<span><span class="co">#&gt; Feb 2003 -0.12839403 -0.42852687</span></span>
<span><span class="co">#&gt; Mar 2003 -1.17137522 -0.76232506</span></span>
<span><span class="co">#&gt; Apr 2003  0.19770654  0.96971721</span></span>
<span><span class="co">#&gt; May 2003  1.62259434  1.31981494</span></span>
<span><span class="co">#&gt; Jun 2003 -0.14704277  0.17362676</span></span>
<span><span class="co">#&gt; Jul 2003 -0.07045343 -0.05730098</span></span>
<span><span class="co">#&gt; Aug 2003 -1.17072203 -0.66882907</span></span>
<span><span class="co">#&gt; Sep 2003 -2.89887258 -1.53863637</span></span>
<span><span class="co">#&gt; Oct 2003 -0.62736155 -0.06504866</span></span>
<span><span class="co">#&gt; Nov 2003  0.96560231  0.19518092</span></span>
<span><span class="co">#&gt; Dec 2003 -0.09354593 -0.06951135</span></span>
<span><span class="co">#&gt; Jan 2004  0.15915097  1.22257588</span></span>
<span><span class="co">#&gt; Feb 2004  0.29875209  0.25719228</span></span>
<span><span class="co">#&gt; Mar 2004 -1.31329880 -0.69076345</span></span>
<span><span class="co">#&gt; Apr 2004  2.48926902  1.54309187</span></span>
<span><span class="co">#&gt; May 2004  1.91175656  0.91165371</span></span>
<span><span class="co">#&gt; Jun 2004  2.04130891  1.23352769</span></span>
<span><span class="co">#&gt; Jul 2004 -0.29759583 -0.05351566</span></span>
<span><span class="co">#&gt; Aug 2004 -1.22025180 -0.56162404</span></span>
<span><span class="co">#&gt; Sep 2004 -0.95856611 -0.54609232</span></span>
<span><span class="co">#&gt; Oct 2004  0.20717781  0.29095534</span></span>
<span><span class="co">#&gt; Nov 2004 -0.70462371 -1.15899926</span></span>
<span><span class="co">#&gt; Dec 2004  2.26007518  1.40841386</span></span>
<span><span class="co">#&gt; Jan 2005  2.95319223  1.69957104</span></span>
<span><span class="co">#&gt; Feb 2005  0.89317411  0.77051186</span></span>
<span><span class="co">#&gt; Mar 2005 -1.54622760 -0.71981400</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $coefficients</span></span>
<span><span class="co">#&gt;        Quotes   TV.advert</span></span>
<span><span class="co">#&gt; x1  0.4358443  0.18606264</span></span>
<span><span class="co">#&gt; x2  0.1361999  0.08192973</span></span>
<span><span class="co">#&gt; h1  0.2311472 -0.09036149</span></span>
<span><span class="co">#&gt; h2 -1.2318730 -0.60953989</span></span>
<span><span class="co">#&gt; h3 -0.1129694 -0.08956715</span></span>
<span><span class="co">#&gt; h4  0.4033300  0.15098381</span></span>
<span><span class="co">#&gt; h5 -0.4866789 -0.25350343</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 1.924173</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 3.601775e-17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt;  2.601976  1.246370 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert       </span></span>
<span><span class="co">#&gt;  Min.   :-3.0748   Min.   :-2.26486  </span></span>
<span><span class="co">#&gt;  1st Qu.:-1.1256   1st Qu.:-0.67980  </span></span>
<span><span class="co">#&gt;  Median : 0.1005   Median :-0.05352  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.00000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.9254   3rd Qu.: 0.84108  </span></span>
<span><span class="co">#&gt;  Max.   : 2.9532   Max.   : 1.69957</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># stationarity is overrated?:)</span></span>
<span><span class="co">#&gt;     Quotes  TV.advert </span></span>
<span><span class="co">#&gt; 0.06458106 0.32251812</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.7471878 0.3924569</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res1</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/gaussian-default-1.png" width="691.2"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res1</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/gaussian-default-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-external-regressors">1 - 2 With external regressors<a class="anchor" aria-label="anchor" href="#with-external-regressors"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">time</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, xreg <span class="op">=</span> <span class="va">xreg</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.45580  9.403836</span></span>
<span><span class="co">#&gt; Jun 2005 15.50296  9.542891</span></span>
<span><span class="co">#&gt; Jul 2005 15.24251  9.457418</span></span>
<span><span class="co">#&gt; Aug 2005 15.02165  9.351020</span></span>
<span><span class="co">#&gt; Sep 2005 14.95493  9.307973</span></span>
<span><span class="co">#&gt; Oct 2005 15.02539  9.335216</span></span>
<span><span class="co">#&gt; Nov 2005 15.17341  9.408039</span></span>
<span><span class="co">#&gt; Dec 2005 15.34645  9.499447</span></span>
<span><span class="co">#&gt; Jan 2006 15.51500  9.592048</span></span>
<span><span class="co">#&gt; Feb 2006 15.66959  9.678782</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 12.76518  7.579582</span></span>
<span><span class="co">#&gt; Jun 2005 12.81234  7.718637</span></span>
<span><span class="co">#&gt; Jul 2005 12.55189  7.633164</span></span>
<span><span class="co">#&gt; Aug 2005 12.33103  7.526766</span></span>
<span><span class="co">#&gt; Sep 2005 12.26431  7.483719</span></span>
<span><span class="co">#&gt; Oct 2005 12.33477  7.510962</span></span>
<span><span class="co">#&gt; Nov 2005 12.48279  7.583785</span></span>
<span><span class="co">#&gt; Dec 2005 12.65583  7.675193</span></span>
<span><span class="co">#&gt; Jan 2006 12.82438  7.767794</span></span>
<span><span class="co">#&gt; Feb 2006 12.97897  7.854528</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 18.14642  11.22809</span></span>
<span><span class="co">#&gt; Jun 2005 18.19359  11.36714</span></span>
<span><span class="co">#&gt; Jul 2005 17.93313  11.28167</span></span>
<span><span class="co">#&gt; Aug 2005 17.71227  11.17527</span></span>
<span><span class="co">#&gt; Sep 2005 17.64555  11.13223</span></span>
<span><span class="co">#&gt; Oct 2005 17.71601  11.15947</span></span>
<span><span class="co">#&gt; Nov 2005 17.86403  11.23229</span></span>
<span><span class="co">#&gt; Dec 2005 18.03707  11.32370</span></span>
<span><span class="co">#&gt; Jan 2006 18.20562  11.41630</span></span>
<span><span class="co">#&gt; Feb 2006 18.36021  11.50304</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 13.711787  7.843252</span></span>
<span><span class="co">#&gt; Feb 2002 13.324117  7.475004</span></span>
<span><span class="co">#&gt; Mar 2002 13.587753  7.830287</span></span>
<span><span class="co">#&gt; Apr 2002 13.832811  8.012027</span></span>
<span><span class="co">#&gt; May 2002 13.381182  7.616504</span></span>
<span><span class="co">#&gt; Jun 2002 13.338987  7.806670</span></span>
<span><span class="co">#&gt; Jul 2002 11.662651  6.949718</span></span>
<span><span class="co">#&gt; Aug 2002 12.242217  7.294680</span></span>
<span><span class="co">#&gt; Sep 2002 13.824793  8.160078</span></span>
<span><span class="co">#&gt; Oct 2002 15.337968  8.830015</span></span>
<span><span class="co">#&gt; Nov 2002 15.503580  8.854393</span></span>
<span><span class="co">#&gt; Dec 2002 15.857927  9.038591</span></span>
<span><span class="co">#&gt; Jan 2003 16.387678  9.257229</span></span>
<span><span class="co">#&gt; Feb 2003 16.553813  9.383619</span></span>
<span><span class="co">#&gt; Mar 2003 17.134719  9.686509</span></span>
<span><span class="co">#&gt; Apr 2003 16.219028  9.369500</span></span>
<span><span class="co">#&gt; May 2003 13.511112  8.099575</span></span>
<span><span class="co">#&gt; Jun 2003 13.110407  7.959201</span></span>
<span><span class="co">#&gt; Jul 2003 12.371223  7.809538</span></span>
<span><span class="co">#&gt; Aug 2003 12.408829  7.815604</span></span>
<span><span class="co">#&gt; Sep 2003 11.999511  7.587126</span></span>
<span><span class="co">#&gt; Oct 2003 10.497685  6.763430</span></span>
<span><span class="co">#&gt; Nov 2003 10.376898  6.789662</span></span>
<span><span class="co">#&gt; Dec 2003 12.532319  7.774555</span></span>
<span><span class="co">#&gt; Jan 2004 13.107961  8.200936</span></span>
<span><span class="co">#&gt; Feb 2004 10.080319  6.945952</span></span>
<span><span class="co">#&gt; Mar 2004  9.958216  6.551072</span></span>
<span><span class="co">#&gt; Apr 2004 10.035496  6.494692</span></span>
<span><span class="co">#&gt; May 2004 12.156667  7.796691</span></span>
<span><span class="co">#&gt; Jun 2004 13.952379  8.670150</span></span>
<span><span class="co">#&gt; Jul 2004 14.579737  8.953919</span></span>
<span><span class="co">#&gt; Aug 2004 14.252833  8.842487</span></span>
<span><span class="co">#&gt; Sep 2004 13.422310  8.378485</span></span>
<span><span class="co">#&gt; Oct 2004 13.306547  8.253072</span></span>
<span><span class="co">#&gt; Nov 2004 13.152395  8.301396</span></span>
<span><span class="co">#&gt; Dec 2004 15.307750  8.977439</span></span>
<span><span class="co">#&gt; Jan 2005 15.793871  9.607153</span></span>
<span><span class="co">#&gt; Feb 2005 16.894043  9.965880</span></span>
<span><span class="co">#&gt; Mar 2005 16.493711  9.857297</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;               Quotes    TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.67535261  1.600318363</span></span>
<span><span class="co">#&gt; Feb 2002 -0.09454667  0.059245589</span></span>
<span><span class="co">#&gt; Mar 2002 -0.61710349 -0.617562341</span></span>
<span><span class="co">#&gt; Apr 2002  1.55432930  1.431543276</span></span>
<span><span class="co">#&gt; May 2002 -1.65830176 -1.201288646</span></span>
<span><span class="co">#&gt; Jun 2002 -3.27721670 -1.999680352</span></span>
<span><span class="co">#&gt; Jul 2002 -0.83986146 -0.746117612</span></span>
<span><span class="co">#&gt; Aug 2002  1.04485279  0.291750330</span></span>
<span><span class="co">#&gt; Sep 2002  0.75352722 -0.155143365</span></span>
<span><span class="co">#&gt; Oct 2002  0.26745241  0.004965096</span></span>
<span><span class="co">#&gt; Nov 2002  0.43157027  0.102861987</span></span>
<span><span class="co">#&gt; Dec 2002  1.13693270  0.494399368</span></span>
<span><span class="co">#&gt; Jan 2003  0.49053241  0.135721074</span></span>
<span><span class="co">#&gt; Feb 2003 -0.10253286 -0.465058629</span></span>
<span><span class="co">#&gt; Mar 2003 -1.85353900 -1.312388835</span></span>
<span><span class="co">#&gt; Apr 2003 -0.33001834  0.475005003</span></span>
<span><span class="co">#&gt; May 2003  2.16635830  1.749815332</span></span>
<span><span class="co">#&gt; Jun 2003  0.17739319  0.443529161</span></span>
<span><span class="co">#&gt; Jul 2003  0.27361734  0.111136601</span></span>
<span><span class="co">#&gt; Aug 2003 -0.58111949 -0.379519019</span></span>
<span><span class="co">#&gt; Sep 2003 -2.30767070 -1.246635836</span></span>
<span><span class="co">#&gt; Oct 2003 -0.19353452  0.176564889</span></span>
<span><span class="co">#&gt; Nov 2003  1.00563207  0.187437814</span></span>
<span><span class="co">#&gt; Dec 2003  0.41917089  0.235645632</span></span>
<span><span class="co">#&gt; Jan 2004  0.52295932  1.364524163</span></span>
<span><span class="co">#&gt; Feb 2004 -0.95933919 -0.673442252</span></span>
<span><span class="co">#&gt; Mar 2004 -1.56353647 -0.843576594</span></span>
<span><span class="co">#&gt; Apr 2004  2.26526358  1.468847972</span></span>
<span><span class="co">#&gt; May 2004  1.69164304  0.697529740</span></span>
<span><span class="co">#&gt; Jun 2004  2.01008148  1.118934668</span></span>
<span><span class="co">#&gt; Jul 2004 -0.38235687 -0.261094013</span></span>
<span><span class="co">#&gt; Aug 2004 -1.39361339 -0.785256869</span></span>
<span><span class="co">#&gt; Sep 2004 -1.33394033 -0.789489620</span></span>
<span><span class="co">#&gt; Oct 2004 -0.37279705 -0.008190995</span></span>
<span><span class="co">#&gt; Nov 2004 -1.43004502 -1.625855697</span></span>
<span><span class="co">#&gt; Dec 2004  0.16351013  0.242165460</span></span>
<span><span class="co">#&gt; Jan 2005  2.64510868  1.356646561</span></span>
<span><span class="co">#&gt; Feb 2005  0.59781674  0.490409659</span></span>
<span><span class="co">#&gt; Mar 2005 -2.00203118 -1.128697062</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $coefficients</span></span>
<span><span class="co">#&gt;        Quotes  TV.advert</span></span>
<span><span class="co">#&gt; x1  1.5520048  0.6627858</span></span>
<span><span class="co">#&gt; x2 -1.6051784 -0.5784973</span></span>
<span><span class="co">#&gt; x3 -1.7090968 -0.5873351</span></span>
<span><span class="co">#&gt; h1  1.7017413  0.7132521</span></span>
<span><span class="co">#&gt; h2 -1.1790106 -0.5946307</span></span>
<span><span class="co">#&gt; h3 -0.7179868 -0.3862358</span></span>
<span><span class="co">#&gt; h4  0.6670119  0.1636983</span></span>
<span><span class="co">#&gt; h5 -0.3598980 -0.1534834</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 1.243869</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 6.628923e-18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;       Quotes    TV.advert       xreg_1 </span></span>
<span><span class="co">#&gt; 2.556419e+00 1.175162e+00 2.765868e-05 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert      </span></span>
<span><span class="co">#&gt;  Min.   :-3.2772   Min.   :-1.9997  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.8996   1st Qu.:-0.7098  </span></span>
<span><span class="co">#&gt;  Median : 0.1635   Median : 0.1029  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.0000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.8796   3rd Qu.: 0.4827  </span></span>
<span><span class="co">#&gt;  Max.   : 2.6451   Max.   : 1.7498</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.1553145 0.4247378</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9498845 0.5141136</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res2</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/gaussian-xreg-1.png" width="691.2"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res2</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/gaussian-xreg-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-external-regressors-and-k-means-clustering">1 - 3 With external regressors and K-Means clustering<a class="anchor" aria-label="anchor" href="#with-external-regressors-and-k-means-clustering"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">centers</span> <span class="op">&lt;-</span> <span class="fl">2L</span></span>
<span><span class="op">(</span><span class="va">res3</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, xreg <span class="op">=</span> <span class="va">xreg</span>, centers <span class="op">=</span> <span class="va">centers</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.32230 10.130363</span></span>
<span><span class="co">#&gt; Jun 2005 14.97262  9.336947</span></span>
<span><span class="co">#&gt; Jul 2005 14.50386  9.125008</span></span>
<span><span class="co">#&gt; Aug 2005 14.32621  9.061559</span></span>
<span><span class="co">#&gt; Sep 2005 14.22842  9.028518</span></span>
<span><span class="co">#&gt; Oct 2005 14.22621  9.046227</span></span>
<span><span class="co">#&gt; Nov 2005 14.26427  9.085161</span></span>
<span><span class="co">#&gt; Dec 2005 14.32406  9.136210</span></span>
<span><span class="co">#&gt; Jan 2006 14.39162  9.191622</span></span>
<span><span class="co">#&gt; Feb 2006 14.46160  9.248390</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.77116  8.404425</span></span>
<span><span class="co">#&gt; Jun 2005 12.42148  7.611009</span></span>
<span><span class="co">#&gt; Jul 2005 11.95272  7.399070</span></span>
<span><span class="co">#&gt; Aug 2005 11.77507  7.335620</span></span>
<span><span class="co">#&gt; Sep 2005 11.67728  7.302580</span></span>
<span><span class="co">#&gt; Oct 2005 11.67508  7.320288</span></span>
<span><span class="co">#&gt; Nov 2005 11.71313  7.359223</span></span>
<span><span class="co">#&gt; Dec 2005 11.77292  7.410272</span></span>
<span><span class="co">#&gt; Jan 2006 11.84048  7.465683</span></span>
<span><span class="co">#&gt; Feb 2006 11.91046  7.522451</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 18.87344  11.85630</span></span>
<span><span class="co">#&gt; Jun 2005 17.52376  11.06289</span></span>
<span><span class="co">#&gt; Jul 2005 17.05500  10.85095</span></span>
<span><span class="co">#&gt; Aug 2005 16.87735  10.78750</span></span>
<span><span class="co">#&gt; Sep 2005 16.77955  10.75446</span></span>
<span><span class="co">#&gt; Oct 2005 16.77735  10.77216</span></span>
<span><span class="co">#&gt; Nov 2005 16.81541  10.81110</span></span>
<span><span class="co">#&gt; Dec 2005 16.87520  10.86215</span></span>
<span><span class="co">#&gt; Jan 2006 16.94275  10.91756</span></span>
<span><span class="co">#&gt; Feb 2006 17.01274  10.97433</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 14.13745  8.221510</span></span>
<span><span class="co">#&gt; Feb 2002 12.96072  7.428876</span></span>
<span><span class="co">#&gt; Mar 2002 14.24210  8.365273</span></span>
<span><span class="co">#&gt; Apr 2002 14.10917  8.240689</span></span>
<span><span class="co">#&gt; May 2002 13.10385  7.576098</span></span>
<span><span class="co">#&gt; Jun 2002 12.85752  7.487839</span></span>
<span><span class="co">#&gt; Jul 2002 10.99640  6.477627</span></span>
<span><span class="co">#&gt; Aug 2002 11.68936  6.906576</span></span>
<span><span class="co">#&gt; Sep 2002 14.24311  8.442819</span></span>
<span><span class="co">#&gt; Oct 2002 15.11602  8.697927</span></span>
<span><span class="co">#&gt; Nov 2002 15.36602  8.771311</span></span>
<span><span class="co">#&gt; Dec 2002 15.81962  8.978734</span></span>
<span><span class="co">#&gt; Jan 2003 16.70731  9.329729</span></span>
<span><span class="co">#&gt; Feb 2003 16.86211  9.434764</span></span>
<span><span class="co">#&gt; Mar 2003 17.15027  9.618099</span></span>
<span><span class="co">#&gt; Apr 2003 16.11209  9.267083</span></span>
<span><span class="co">#&gt; May 2003 13.68703  8.152303</span></span>
<span><span class="co">#&gt; Jun 2003 13.27600  8.009960</span></span>
<span><span class="co">#&gt; Jul 2003 12.48263  7.867811</span></span>
<span><span class="co">#&gt; Aug 2003 12.12160  7.611787</span></span>
<span><span class="co">#&gt; Sep 2003 11.84829  7.397798</span></span>
<span><span class="co">#&gt; Oct 2003 10.57706  6.670099</span></span>
<span><span class="co">#&gt; Nov 2003 10.10601  6.481728</span></span>
<span><span class="co">#&gt; Dec 2003 12.27065  7.533845</span></span>
<span><span class="co">#&gt; Jan 2004 12.78740  7.996468</span></span>
<span><span class="co">#&gt; Feb 2004 10.16008  6.985412</span></span>
<span><span class="co">#&gt; Mar 2004 10.68037  6.951665</span></span>
<span><span class="co">#&gt; Apr 2004 11.39454  7.393299</span></span>
<span><span class="co">#&gt; May 2004 11.76171  7.533014</span></span>
<span><span class="co">#&gt; Jun 2004 14.72078  9.186313</span></span>
<span><span class="co">#&gt; Jul 2004 14.67146  8.963637</span></span>
<span><span class="co">#&gt; Aug 2004 14.87019  9.270515</span></span>
<span><span class="co">#&gt; Sep 2004 12.89441  8.132710</span></span>
<span><span class="co">#&gt; Oct 2004 12.66447  7.932732</span></span>
<span><span class="co">#&gt; Nov 2004 12.61418  8.047571</span></span>
<span><span class="co">#&gt; Dec 2004 15.06624  9.010981</span></span>
<span><span class="co">#&gt; Jan 2005 15.81507  9.700709</span></span>
<span><span class="co">#&gt; Feb 2005 16.88152  9.920224</span></span>
<span><span class="co">#&gt; Mar 2005 16.37843  9.807854</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;               Quotes   TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.24969289  1.22205996</span></span>
<span><span class="co">#&gt; Feb 2002  0.26885280  0.10537425</span></span>
<span><span class="co">#&gt; Mar 2002 -1.27144871 -1.15254827</span></span>
<span><span class="co">#&gt; Apr 2002  1.27797385  1.20288136</span></span>
<span><span class="co">#&gt; May 2002 -1.38096578 -1.16088326</span></span>
<span><span class="co">#&gt; Jun 2002 -2.79575299 -1.68084898</span></span>
<span><span class="co">#&gt; Jul 2002 -0.17360895 -0.27402696</span></span>
<span><span class="co">#&gt; Aug 2002  1.59770503  0.67985439</span></span>
<span><span class="co">#&gt; Sep 2002  0.33520729 -0.43788428</span></span>
<span><span class="co">#&gt; Oct 2002  0.48939779  0.13705250</span></span>
<span><span class="co">#&gt; Nov 2002  0.56912818  0.18594378</span></span>
<span><span class="co">#&gt; Dec 2002  1.17523937  0.55425563</span></span>
<span><span class="co">#&gt; Jan 2003  0.17089673  0.06322060</span></span>
<span><span class="co">#&gt; Feb 2003 -0.41082535 -0.51620445</span></span>
<span><span class="co">#&gt; Mar 2003 -1.86908938 -1.24397877</span></span>
<span><span class="co">#&gt; Apr 2003 -0.22307977  0.57742184</span></span>
<span><span class="co">#&gt; May 2003  1.99043807  1.69708709</span></span>
<span><span class="co">#&gt; Jun 2003  0.01180193  0.39277043</span></span>
<span><span class="co">#&gt; Jul 2003  0.16221379  0.05286418</span></span>
<span><span class="co">#&gt; Aug 2003 -0.29389157 -0.17570225</span></span>
<span><span class="co">#&gt; Sep 2003 -2.15645148 -1.05730773</span></span>
<span><span class="co">#&gt; Oct 2003 -0.27291405  0.26989565</span></span>
<span><span class="co">#&gt; Nov 2003  1.27652294  0.49537161</span></span>
<span><span class="co">#&gt; Dec 2003  0.68083925  0.47635585</span></span>
<span><span class="co">#&gt; Jan 2004  0.84352463  1.56899240</span></span>
<span><span class="co">#&gt; Feb 2004 -1.03909866 -0.71290176</span></span>
<span><span class="co">#&gt; Mar 2004 -2.28568521 -1.24416952</span></span>
<span><span class="co">#&gt; Apr 2004  0.90622268  0.57024150</span></span>
<span><span class="co">#&gt; May 2004  2.08659600  0.96120683</span></span>
<span><span class="co">#&gt; Jun 2004  1.24167683  0.60277201</span></span>
<span><span class="co">#&gt; Jul 2004 -0.47408066 -0.27081190</span></span>
<span><span class="co">#&gt; Aug 2004 -2.01097473 -1.21328460</span></span>
<span><span class="co">#&gt; Sep 2004 -0.80604087 -0.54371464</span></span>
<span><span class="co">#&gt; Oct 2004  0.26928009  0.31214938</span></span>
<span><span class="co">#&gt; Nov 2004 -0.89182765 -1.37203092</span></span>
<span><span class="co">#&gt; Dec 2004  0.40502425  0.20862299</span></span>
<span><span class="co">#&gt; Jan 2005  2.62390929  1.26309148</span></span>
<span><span class="co">#&gt; Feb 2005  0.61033897  0.53606615</span></span>
<span><span class="co">#&gt; Mar 2005 -1.88674685 -1.07925360</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $coefficients</span></span>
<span><span class="co">#&gt;        Quotes  TV.advert</span></span>
<span><span class="co">#&gt; x1  3.5038103  1.7692404</span></span>
<span><span class="co">#&gt; x2 -2.2171659 -0.8976767</span></span>
<span><span class="co">#&gt; x3 -1.0183157 -0.2944741</span></span>
<span><span class="co">#&gt; x4  2.8350732  1.6288475</span></span>
<span><span class="co">#&gt; h1  1.2893893  0.4831338</span></span>
<span><span class="co">#&gt; h2 -1.1600409 -0.4967895</span></span>
<span><span class="co">#&gt; h3  1.0524258  0.7861681</span></span>
<span><span class="co">#&gt; h4  0.9634193  0.4636718</span></span>
<span><span class="co">#&gt; h5 -0.3004731 -0.1633606</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 0.9839062</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 1.289992e-17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;       Quotes    TV.advert       xreg_1 xreg_cluster </span></span>
<span><span class="co">#&gt; 2.581749e+00 1.181670e+00 4.725259e-05 1.721592e-01 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res3</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert      </span></span>
<span><span class="co">#&gt;  Min.   :-2.7958   Min.   :-1.6808  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.8489   1st Qu.:-0.6283  </span></span>
<span><span class="co">#&gt;  Median : 0.1709   Median : 0.1371  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.0000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.8749   3rd Qu.: 0.5622  </span></span>
<span><span class="co">#&gt;  Max.   : 2.6239   Max.   : 1.6971</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res3</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.2414578 0.6241519</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res3</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.6746224 0.2274255</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res3</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/gaussian-xreg-kmeans-1.png" width="691.2"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res3</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/gaussian-xreg-kmeans-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-k-means-clustering">1 - 4 With K-Means clustering<a class="anchor" aria-label="anchor" href="#with-k-means-clustering"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">centers</span> <span class="op">&lt;-</span> <span class="fl">2L</span></span>
<span><span class="op">(</span><span class="va">res10</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, centers <span class="op">=</span> <span class="va">centers</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.12856  8.433588</span></span>
<span><span class="co">#&gt; Jun 2005 14.46516  8.695170</span></span>
<span><span class="co">#&gt; Jul 2005 14.39360  8.657141</span></span>
<span><span class="co">#&gt; Aug 2005 14.36573  8.651456</span></span>
<span><span class="co">#&gt; Sep 2005 14.32898  8.638145</span></span>
<span><span class="co">#&gt; Oct 2005 14.29643  8.627017</span></span>
<span><span class="co">#&gt; Nov 2005 14.26576  8.616386</span></span>
<span><span class="co">#&gt; Dec 2005 14.23725  8.606531</span></span>
<span><span class="co">#&gt; Jan 2006 14.21069  8.597342</span></span>
<span><span class="co">#&gt; Feb 2006 14.18594  8.588784</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 11.19379  6.396918</span></span>
<span><span class="co">#&gt; Jun 2005 11.53039  6.658499</span></span>
<span><span class="co">#&gt; Jul 2005 11.45883  6.620471</span></span>
<span><span class="co">#&gt; Aug 2005 11.43097  6.614785</span></span>
<span><span class="co">#&gt; Sep 2005 11.39421  6.601474</span></span>
<span><span class="co">#&gt; Oct 2005 11.36167  6.590346</span></span>
<span><span class="co">#&gt; Nov 2005 11.33100  6.579715</span></span>
<span><span class="co">#&gt; Dec 2005 11.30249  6.569860</span></span>
<span><span class="co">#&gt; Jan 2006 11.27592  6.560671</span></span>
<span><span class="co">#&gt; Feb 2006 11.25118  6.552113</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.06332  10.47026</span></span>
<span><span class="co">#&gt; Jun 2005 17.39993  10.73184</span></span>
<span><span class="co">#&gt; Jul 2005 17.32837  10.69381</span></span>
<span><span class="co">#&gt; Aug 2005 17.30050  10.68813</span></span>
<span><span class="co">#&gt; Sep 2005 17.26375  10.67482</span></span>
<span><span class="co">#&gt; Oct 2005 17.23120  10.66369</span></span>
<span><span class="co">#&gt; Nov 2005 17.20053  10.65306</span></span>
<span><span class="co">#&gt; Dec 2005 17.17202  10.64320</span></span>
<span><span class="co">#&gt; Jan 2006 17.14546  10.63401</span></span>
<span><span class="co">#&gt; Feb 2006 17.12071  10.62545</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 14.080025  8.217172</span></span>
<span><span class="co">#&gt; Feb 2002 14.097935  8.504100</span></span>
<span><span class="co">#&gt; Mar 2002 14.037980  8.254621</span></span>
<span><span class="co">#&gt; Apr 2002 14.080025  8.217172</span></span>
<span><span class="co">#&gt; May 2002 14.097935  8.504100</span></span>
<span><span class="co">#&gt; Jun 2002 13.400229  7.842877</span></span>
<span><span class="co">#&gt; Jul 2002 11.963099  7.227708</span></span>
<span><span class="co">#&gt; Aug 2002 12.483082  7.479137</span></span>
<span><span class="co">#&gt; Sep 2002 14.051200  8.267892</span></span>
<span><span class="co">#&gt; Oct 2002 15.653409  9.046206</span></span>
<span><span class="co">#&gt; Nov 2002 15.895374  9.120444</span></span>
<span><span class="co">#&gt; Dec 2002 16.246375  9.254438</span></span>
<span><span class="co">#&gt; Jan 2003 16.880238  9.544966</span></span>
<span><span class="co">#&gt; Feb 2003 17.003473  9.571713</span></span>
<span><span class="co">#&gt; Mar 2003 17.231948  9.639966</span></span>
<span><span class="co">#&gt; Apr 2003 16.195870  9.248908</span></span>
<span><span class="co">#&gt; May 2003 14.058413  8.543376</span></span>
<span><span class="co">#&gt; Jun 2003 13.651791  8.393671</span></span>
<span><span class="co">#&gt; Jul 2003 12.716624  8.056579</span></span>
<span><span class="co">#&gt; Aug 2003 12.646146  7.882686</span></span>
<span><span class="co">#&gt; Sep 2003 12.337320  7.628455</span></span>
<span><span class="co">#&gt; Oct 2003 10.858041  6.918282</span></span>
<span><span class="co">#&gt; Nov 2003 10.947373  7.048306</span></span>
<span><span class="co">#&gt; Dec 2003 12.300163  7.539882</span></span>
<span><span class="co">#&gt; Jan 2004 12.920135  8.002056</span></span>
<span><span class="co">#&gt; Feb 2004 10.524137  7.198956</span></span>
<span><span class="co">#&gt; Mar 2004 10.198641  6.670517</span></span>
<span><span class="co">#&gt; Apr 2004  9.921236  6.478631</span></span>
<span><span class="co">#&gt; May 2004 12.093310  7.711550</span></span>
<span><span class="co">#&gt; Jun 2004 13.435713  8.168927</span></span>
<span><span class="co">#&gt; Jul 2004 14.330379  8.636496</span></span>
<span><span class="co">#&gt; Aug 2004 13.676214  8.257946</span></span>
<span><span class="co">#&gt; Sep 2004 12.711040  7.946941</span></span>
<span><span class="co">#&gt; Oct 2004 12.438696  7.709987</span></span>
<span><span class="co">#&gt; Nov 2004 12.493577  7.932898</span></span>
<span><span class="co">#&gt; Dec 2004 13.094054  7.775530</span></span>
<span><span class="co">#&gt; Jan 2005 14.800106  8.733646</span></span>
<span><span class="co">#&gt; Feb 2005 16.091897  9.445771</span></span>
<span><span class="co">#&gt; Mar 2005 15.560027  9.180879</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;                Quotes   TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.307114839  1.22639837</span></span>
<span><span class="co">#&gt; Feb 2002 -0.868364597 -0.96984988</span></span>
<span><span class="co">#&gt; Mar 2002 -1.067329559 -1.04189553</span></span>
<span><span class="co">#&gt; Apr 2002  1.307114839  1.22639837</span></span>
<span><span class="co">#&gt; May 2002 -2.375054597 -2.08888488</span></span>
<span><span class="co">#&gt; Jun 2002 -3.338459123 -2.03588722</span></span>
<span><span class="co">#&gt; Jul 2002 -1.140308873 -1.02410785</span></span>
<span><span class="co">#&gt; Aug 2002  0.803987736  0.10729330</span></span>
<span><span class="co">#&gt; Sep 2002  0.527119680 -0.26295692</span></span>
<span><span class="co">#&gt; Oct 2002 -0.047988643 -0.21122600</span></span>
<span><span class="co">#&gt; Nov 2002  0.039776086 -0.16318896</span></span>
<span><span class="co">#&gt; Dec 2002  0.748484692  0.27855217</span></span>
<span><span class="co">#&gt; Jan 2003 -0.002027973 -0.15201590</span></span>
<span><span class="co">#&gt; Feb 2003 -0.552192724 -0.65315272</span></span>
<span><span class="co">#&gt; Mar 2003 -1.950768084 -1.26584601</span></span>
<span><span class="co">#&gt; Apr 2003 -0.306860047  0.59559733</span></span>
<span><span class="co">#&gt; May 2003  1.619056967  1.30601353</span></span>
<span><span class="co">#&gt; Jun 2003 -0.363991107  0.00905855</span></span>
<span><span class="co">#&gt; Jul 2003 -0.071784477 -0.13590381</span></span>
<span><span class="co">#&gt; Aug 2003 -0.818435582 -0.44660102</span></span>
<span><span class="co">#&gt; Sep 2003 -2.645480110 -1.28796505</span></span>
<span><span class="co">#&gt; Oct 2003 -0.553891055  0.02171253</span></span>
<span><span class="co">#&gt; Nov 2003  0.435156765 -0.07120594</span></span>
<span><span class="co">#&gt; Dec 2003  0.651326753  0.47031930</span></span>
<span><span class="co">#&gt; Jan 2004  0.710784799  1.56340435</span></span>
<span><span class="co">#&gt; Feb 2004 -1.403156976 -0.92644608</span></span>
<span><span class="co">#&gt; Mar 2004 -1.803961042 -0.96302233</span></span>
<span><span class="co">#&gt; Apr 2004  2.379523900  1.48490908</span></span>
<span><span class="co">#&gt; May 2004  1.755000239  0.78267104</span></span>
<span><span class="co">#&gt; Jun 2004  2.526746719  1.62015783</span></span>
<span><span class="co">#&gt; Jul 2004 -0.132999437  0.05632932</span></span>
<span><span class="co">#&gt; Aug 2004 -0.816993774 -0.20071589</span></span>
<span><span class="co">#&gt; Sep 2004 -0.622669658 -0.35794574</span></span>
<span><span class="co">#&gt; Oct 2004  0.495054063  0.53489384</span></span>
<span><span class="co">#&gt; Nov 2004 -0.771226686 -1.25735840</span></span>
<span><span class="co">#&gt; Dec 2004  2.377205824  1.44407360</span></span>
<span><span class="co">#&gt; Jan 2005  3.638874496  2.23015367</span></span>
<span><span class="co">#&gt; Feb 2005  1.399962612  1.01051877</span></span>
<span><span class="co">#&gt; Mar 2005 -1.068346882 -0.45227882</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $coefficients</span></span>
<span><span class="co">#&gt;        Quotes     TV.advert</span></span>
<span><span class="co">#&gt; x1  1.6276146  0.6152714888</span></span>
<span><span class="co">#&gt; x2 -1.2880171 -0.2495614167</span></span>
<span><span class="co">#&gt; x3 -1.6663532 -0.4509788127</span></span>
<span><span class="co">#&gt; h1  0.7101810  0.1575770515</span></span>
<span><span class="co">#&gt; h2 -1.4627463 -0.5512547155</span></span>
<span><span class="co">#&gt; h3 -0.5666489 -0.3103583247</span></span>
<span><span class="co">#&gt; h4  0.7419316  0.2264184186</span></span>
<span><span class="co">#&gt; h5 -0.2035989 -0.0006715917</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 1.557655</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 2.232715e-17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;       Quotes    TV.advert xreg_cluster </span></span>
<span><span class="co">#&gt;    3.0295614    1.4590629    0.1843407 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res10</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes           TV.advert      </span></span>
<span><span class="co">#&gt;  Min.   :-3.33846   Min.   :-2.0889  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.84340   1st Qu.:-0.7898  </span></span>
<span><span class="co">#&gt;  Median :-0.07178   Median :-0.1359  </span></span>
<span><span class="co">#&gt;  Mean   : 0.00000   Mean   : 0.0000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.77624   3rd Qu.: 0.6891  </span></span>
<span><span class="co">#&gt;  Max.   : 3.63887   Max.   : 2.2302</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res10</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.0461306 0.2610091</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res10</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9864921 0.5720541</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res10</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/gaussian-kmeans-1.png" width="691.2"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res10</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/gaussian-kmeans-2.png" width="691.2"></p>
</div>
</div>
<div class="section level2">
<h2 id="prediction-intervals-based-on-independent-bootstrap">2 - Prediction intervals based on independent bootstrap<a class="anchor" aria-label="anchor" href="#prediction-intervals-based-on-independent-bootstrap"></a>
</h2>
<div class="section level3">
<h3 id="with-default-parameters-1">2 - 1 With default parameters<a class="anchor" aria-label="anchor" href="#with-default-parameters-1"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">10L</span> <span class="co"># number of bootstrap replications -- increase this</span></span>
<span><span class="op">(</span><span class="va">res4</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                        type_pi <span class="op">=</span> <span class="st">"bootstrap"</span>, B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.95424  8.917110</span></span>
<span><span class="co">#&gt; Jun 2005 14.49974  8.636097</span></span>
<span><span class="co">#&gt; Jul 2005 14.89943  9.021361</span></span>
<span><span class="co">#&gt; Aug 2005 13.81663  8.379904</span></span>
<span><span class="co">#&gt; Sep 2005 13.21467  7.907439</span></span>
<span><span class="co">#&gt; Oct 2005 12.43278  7.492033</span></span>
<span><span class="co">#&gt; Nov 2005 13.26207  8.025966</span></span>
<span><span class="co">#&gt; Dec 2005 13.83344  8.416299</span></span>
<span><span class="co">#&gt; Jan 2006 14.05378  8.520859</span></span>
<span><span class="co">#&gt; Feb 2006 14.27316  8.593758</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 12.084705  7.338993</span></span>
<span><span class="co">#&gt; Jun 2005 12.334471  6.899060</span></span>
<span><span class="co">#&gt; Jul 2005 10.169184  6.394872</span></span>
<span><span class="co">#&gt; Aug 2005 11.009906  6.891660</span></span>
<span><span class="co">#&gt; Sep 2005 10.892449  5.821847</span></span>
<span><span class="co">#&gt; Oct 2005  9.512025  5.810005</span></span>
<span><span class="co">#&gt; Nov 2005 11.136196  7.072952</span></span>
<span><span class="co">#&gt; Dec 2005  9.352377  6.033064</span></span>
<span><span class="co">#&gt; Jan 2006 10.779190  6.889282</span></span>
<span><span class="co">#&gt; Feb 2006 10.410663  6.496912</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.25320 10.490874</span></span>
<span><span class="co">#&gt; Jun 2005 15.53240  9.620957</span></span>
<span><span class="co">#&gt; Jul 2005 17.01236 10.447844</span></span>
<span><span class="co">#&gt; Aug 2005 16.25077 10.429662</span></span>
<span><span class="co">#&gt; Sep 2005 15.17868  9.484860</span></span>
<span><span class="co">#&gt; Oct 2005 13.87775  8.808728</span></span>
<span><span class="co">#&gt; Nov 2005 15.02885  9.384877</span></span>
<span><span class="co">#&gt; Dec 2005 16.01964  9.714979</span></span>
<span><span class="co">#&gt; Jan 2006 16.78336 10.055364</span></span>
<span><span class="co">#&gt; Feb 2006 17.73885 10.720315</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.09470  8.546350</span></span>
<span><span class="co">#&gt; Jun 2005 15.26574  8.957984</span></span>
<span><span class="co">#&gt; Jul 2005 17.14212 10.521963</span></span>
<span><span class="co">#&gt; Aug 2005 14.47419  8.777585</span></span>
<span><span class="co">#&gt; Sep 2005 13.80475  7.662264</span></span>
<span><span class="co">#&gt; Oct 2005 13.29210  7.242733</span></span>
<span><span class="co">#&gt; Nov 2005 12.93090  7.530277</span></span>
<span><span class="co">#&gt; Dec 2005 14.38592  8.007453</span></span>
<span><span class="co">#&gt; Jan 2006 13.75002  8.075816</span></span>
<span><span class="co">#&gt; Feb 2006 13.91423  7.624468</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.693479  8.890481</span></span>
<span><span class="co">#&gt; Jun 2005 12.071239  6.621006</span></span>
<span><span class="co">#&gt; Jul 2005 16.321333  9.408312</span></span>
<span><span class="co">#&gt; Aug 2005 16.301909 10.599011</span></span>
<span><span class="co">#&gt; Sep 2005 10.751088  6.451488</span></span>
<span><span class="co">#&gt; Oct 2005 12.825250  8.975899</span></span>
<span><span class="co">#&gt; Nov 2005 10.917488  7.055409</span></span>
<span><span class="co">#&gt; Dec 2005  8.509706  5.597015</span></span>
<span><span class="co">#&gt; Jan 2006 12.748927  8.157222</span></span>
<span><span class="co">#&gt; Feb 2006 15.261147  9.472318</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.25320 10.490874</span></span>
<span><span class="co">#&gt; Jun 2005 15.51548  9.305770</span></span>
<span><span class="co">#&gt; Jul 2005 15.51882  9.127883</span></span>
<span><span class="co">#&gt; Aug 2005 13.05521  7.008770</span></span>
<span><span class="co">#&gt; Sep 2005 11.37936  5.649254</span></span>
<span><span class="co">#&gt; Oct 2005 13.04494  7.183429</span></span>
<span><span class="co">#&gt; Nov 2005 14.34255  7.673654</span></span>
<span><span class="co">#&gt; Dec 2005 15.68812  9.097144</span></span>
<span><span class="co">#&gt; Jan 2006 15.08182  8.093210</span></span>
<span><span class="co">#&gt; Feb 2006 15.28630  8.804900</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 11.68915  7.181272</span></span>
<span><span class="co">#&gt; Jun 2005 15.16186  9.360902</span></span>
<span><span class="co">#&gt; Jul 2005 16.50681 10.087084</span></span>
<span><span class="co">#&gt; Aug 2005 13.47757  8.178792</span></span>
<span><span class="co">#&gt; Sep 2005 14.49698  8.965963</span></span>
<span><span class="co">#&gt; Oct 2005 12.82710  7.912189</span></span>
<span><span class="co">#&gt; Nov 2005 12.26039  7.194058</span></span>
<span><span class="co">#&gt; Dec 2005 16.11588  9.746326</span></span>
<span><span class="co">#&gt; Jan 2006 17.15008 10.279865</span></span>
<span><span class="co">#&gt; Feb 2006 16.07570  9.332013</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.67039  8.878271</span></span>
<span><span class="co">#&gt; Jun 2005 15.53732  9.650251</span></span>
<span><span class="co">#&gt; Jul 2005 10.79614  6.687064</span></span>
<span><span class="co">#&gt; Aug 2005 12.45865  7.752375</span></span>
<span><span class="co">#&gt; Sep 2005 15.36642  9.557945</span></span>
<span><span class="co">#&gt; Oct 2005 12.55254  7.850653</span></span>
<span><span class="co">#&gt; Nov 2005 15.04672  9.338306</span></span>
<span><span class="co">#&gt; Dec 2005 13.15837  8.368249</span></span>
<span><span class="co">#&gt; Jan 2006 14.75788  9.282082</span></span>
<span><span class="co">#&gt; Feb 2006 10.12754  6.388148</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.09470  8.546350</span></span>
<span><span class="co">#&gt; Jun 2005 14.32990  7.856803</span></span>
<span><span class="co">#&gt; Jul 2005 16.26642  9.830921</span></span>
<span><span class="co">#&gt; Aug 2005 16.07463  9.846349</span></span>
<span><span class="co">#&gt; Sep 2005 13.61470  8.234302</span></span>
<span><span class="co">#&gt; Oct 2005 13.38812  8.232918</span></span>
<span><span class="co">#&gt; Nov 2005 13.58878  8.044008</span></span>
<span><span class="co">#&gt; Dec 2005 15.48621  9.136085</span></span>
<span><span class="co">#&gt; Jan 2006 15.52022  9.209342</span></span>
<span><span class="co">#&gt; Feb 2006 17.23132 10.632457</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.25320 10.490874</span></span>
<span><span class="co">#&gt; Jun 2005 15.14628  8.991276</span></span>
<span><span class="co">#&gt; Jul 2005 15.61068 10.192546</span></span>
<span><span class="co">#&gt; Aug 2005 10.58930  6.857661</span></span>
<span><span class="co">#&gt; Sep 2005 13.47287  8.511551</span></span>
<span><span class="co">#&gt; Oct 2005 10.19723  5.739297</span></span>
<span><span class="co">#&gt; Nov 2005 11.88952  7.133378</span></span>
<span><span class="co">#&gt; Dec 2005 12.25491  7.535011</span></span>
<span><span class="co">#&gt; Jan 2006 10.44075  6.714824</span></span>
<span><span class="co">#&gt; Feb 2006 13.16995  8.647643</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.447159  7.882252</span></span>
<span><span class="co">#&gt; Jun 2005 13.241160  7.983379</span></span>
<span><span class="co">#&gt; Jul 2005 16.565430 10.160963</span></span>
<span><span class="co">#&gt; Aug 2005 14.500822  8.968994</span></span>
<span><span class="co">#&gt; Sep 2005 13.156521  8.392164</span></span>
<span><span class="co">#&gt; Oct 2005  9.313095  6.053557</span></span>
<span><span class="co">#&gt; Nov 2005 12.581349  8.323640</span></span>
<span><span class="co">#&gt; Dec 2005 14.074785  8.890812</span></span>
<span><span class="co">#&gt; Jan 2006 11.944916  7.490191</span></span>
<span><span class="co">#&gt; Feb 2006 11.385856  6.871544</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.616890  9.121409</span></span>
<span><span class="co">#&gt; Jun 2005 13.634215  9.520057</span></span>
<span><span class="co">#&gt; Jul 2005  9.987166  6.310043</span></span>
<span><span class="co">#&gt; Aug 2005 13.703893  8.339510</span></span>
<span><span class="co">#&gt; Sep 2005 11.571965  6.416334</span></span>
<span><span class="co">#&gt; Oct 2005 14.019898  7.954921</span></span>
<span><span class="co">#&gt; Nov 2005 14.095724  8.568528</span></span>
<span><span class="co">#&gt; Dec 2005 13.091223  8.177888</span></span>
<span><span class="co">#&gt; Jan 2006 14.042929  8.960467</span></span>
<span><span class="co">#&gt; Feb 2006 12.393313  7.418268</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.72954  9.142963</span></span>
<span><span class="co">#&gt; Jun 2005 15.09424  8.113548</span></span>
<span><span class="co">#&gt; Jul 2005 14.27943  7.886835</span></span>
<span><span class="co">#&gt; Aug 2005 13.53009  7.469997</span></span>
<span><span class="co">#&gt; Sep 2005 14.53202  9.233122</span></span>
<span><span class="co">#&gt; Oct 2005 12.86756  7.774732</span></span>
<span><span class="co">#&gt; Nov 2005 14.96732  9.398397</span></span>
<span><span class="co">#&gt; Dec 2005 15.56929  9.607004</span></span>
<span><span class="co">#&gt; Jan 2006 15.10023  8.945575</span></span>
<span><span class="co">#&gt; Feb 2006 17.88620 10.745822</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 13.983454  8.113042</span></span>
<span><span class="co">#&gt; Feb 2002 14.310140  8.680078</span></span>
<span><span class="co">#&gt; Mar 2002 14.204085  8.367422</span></span>
<span><span class="co">#&gt; Apr 2002 13.983454  8.113042</span></span>
<span><span class="co">#&gt; May 2002 14.310140  8.680078</span></span>
<span><span class="co">#&gt; Jun 2002 13.136549  7.573500</span></span>
<span><span class="co">#&gt; Jul 2002 12.139564  7.269130</span></span>
<span><span class="co">#&gt; Aug 2002 12.630260  7.516240</span></span>
<span><span class="co">#&gt; Sep 2002 14.247551  8.406368</span></span>
<span><span class="co">#&gt; Oct 2002 15.085483  8.610639</span></span>
<span><span class="co">#&gt; Nov 2002 15.834616  9.129753</span></span>
<span><span class="co">#&gt; Dec 2002 16.037153  9.175375</span></span>
<span><span class="co">#&gt; Jan 2003 16.609951  9.409639</span></span>
<span><span class="co">#&gt; Feb 2003 16.579674  9.347087</span></span>
<span><span class="co">#&gt; Mar 2003 16.452555  9.136445</span></span>
<span><span class="co">#&gt; Apr 2003 15.691303  8.874788</span></span>
<span><span class="co">#&gt; May 2003 14.054876  8.529575</span></span>
<span><span class="co">#&gt; Jun 2003 13.434843  8.229103</span></span>
<span><span class="co">#&gt; Jul 2003 12.715293  7.977976</span></span>
<span><span class="co">#&gt; Aug 2003 12.998432  8.104914</span></span>
<span><span class="co">#&gt; Sep 2003 12.590713  7.879126</span></span>
<span><span class="co">#&gt; Oct 2003 10.931512  7.005044</span></span>
<span><span class="co">#&gt; Nov 2003 10.416928  6.781919</span></span>
<span><span class="co">#&gt; Dec 2003 13.045036  8.079712</span></span>
<span><span class="co">#&gt; Jan 2004 13.471769  8.342884</span></span>
<span><span class="co">#&gt; Feb 2004  8.822228  6.015318</span></span>
<span><span class="co">#&gt; Mar 2004  9.707979  6.398258</span></span>
<span><span class="co">#&gt; Apr 2004  9.811491  6.420448</span></span>
<span><span class="co">#&gt; May 2004 11.936553  7.582567</span></span>
<span><span class="co">#&gt; Jun 2004 13.921151  8.555557</span></span>
<span><span class="co">#&gt; Jul 2004 14.494976  8.746341</span></span>
<span><span class="co">#&gt; Aug 2004 14.079472  8.618854</span></span>
<span><span class="co">#&gt; Sep 2004 13.046936  8.135087</span></span>
<span><span class="co">#&gt; Oct 2004 12.726572  7.953926</span></span>
<span><span class="co">#&gt; Nov 2004 12.426974  7.834539</span></span>
<span><span class="co">#&gt; Dec 2004 13.211185  7.811190</span></span>
<span><span class="co">#&gt; Jan 2005 15.485788  9.264229</span></span>
<span><span class="co">#&gt; Feb 2005 16.598686  9.685778</span></span>
<span><span class="co">#&gt; Mar 2005 16.037908  9.448414</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;               Quotes   TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.40368643  1.33052782</span></span>
<span><span class="co">#&gt; Feb 2002 -1.08056990 -1.14582835</span></span>
<span><span class="co">#&gt; Mar 2002 -1.23343504 -1.15469695</span></span>
<span><span class="co">#&gt; Apr 2002  1.40368643  1.33052782</span></span>
<span><span class="co">#&gt; May 2002 -2.58725990 -2.26486335</span></span>
<span><span class="co">#&gt; Jun 2002 -3.07477874 -1.76651025</span></span>
<span><span class="co">#&gt; Jul 2002 -1.31677412 -1.06553020</span></span>
<span><span class="co">#&gt; Aug 2002  0.65681006  0.07019039</span></span>
<span><span class="co">#&gt; Sep 2002  0.33076863 -0.40143292</span></span>
<span><span class="co">#&gt; Oct 2002  0.51993723  0.22434076</span></span>
<span><span class="co">#&gt; Nov 2002  0.10053432 -0.17249791</span></span>
<span><span class="co">#&gt; Dec 2002  0.95770684  0.35761548</span></span>
<span><span class="co">#&gt; Jan 2003  0.26825909 -0.01668861</span></span>
<span><span class="co">#&gt; Feb 2003 -0.12839403 -0.42852687</span></span>
<span><span class="co">#&gt; Mar 2003 -1.17137522 -0.76232506</span></span>
<span><span class="co">#&gt; Apr 2003  0.19770654  0.96971721</span></span>
<span><span class="co">#&gt; May 2003  1.62259434  1.31981494</span></span>
<span><span class="co">#&gt; Jun 2003 -0.14704277  0.17362676</span></span>
<span><span class="co">#&gt; Jul 2003 -0.07045343 -0.05730098</span></span>
<span><span class="co">#&gt; Aug 2003 -1.17072203 -0.66882907</span></span>
<span><span class="co">#&gt; Sep 2003 -2.89887258 -1.53863637</span></span>
<span><span class="co">#&gt; Oct 2003 -0.62736155 -0.06504866</span></span>
<span><span class="co">#&gt; Nov 2003  0.96560231  0.19518092</span></span>
<span><span class="co">#&gt; Dec 2003 -0.09354593 -0.06951135</span></span>
<span><span class="co">#&gt; Jan 2004  0.15915097  1.22257588</span></span>
<span><span class="co">#&gt; Feb 2004  0.29875209  0.25719228</span></span>
<span><span class="co">#&gt; Mar 2004 -1.31329880 -0.69076345</span></span>
<span><span class="co">#&gt; Apr 2004  2.48926902  1.54309187</span></span>
<span><span class="co">#&gt; May 2004  1.91175656  0.91165371</span></span>
<span><span class="co">#&gt; Jun 2004  2.04130891  1.23352769</span></span>
<span><span class="co">#&gt; Jul 2004 -0.29759583 -0.05351566</span></span>
<span><span class="co">#&gt; Aug 2004 -1.22025180 -0.56162404</span></span>
<span><span class="co">#&gt; Sep 2004 -0.95856611 -0.54609232</span></span>
<span><span class="co">#&gt; Oct 2004  0.20717781  0.29095534</span></span>
<span><span class="co">#&gt; Nov 2004 -0.70462371 -1.15899926</span></span>
<span><span class="co">#&gt; Dec 2004  2.26007518  1.40841386</span></span>
<span><span class="co">#&gt; Jan 2005  2.95319223  1.69957104</span></span>
<span><span class="co">#&gt; Feb 2005  0.89317411  0.77051186</span></span>
<span><span class="co">#&gt; Mar 2005 -1.54622760 -0.71981400</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 1.924173</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 3.601775e-17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt;  2.601976  1.246370 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res4</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert       </span></span>
<span><span class="co">#&gt;  Min.   :-3.0748   Min.   :-2.26486  </span></span>
<span><span class="co">#&gt;  1st Qu.:-1.1256   1st Qu.:-0.67980  </span></span>
<span><span class="co">#&gt;  Median : 0.1005   Median :-0.05352  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.00000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.9254   3rd Qu.: 0.84108  </span></span>
<span><span class="co">#&gt;  Max.   : 2.9532   Max.   : 1.69957</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res4</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Quotes  TV.advert </span></span>
<span><span class="co">#&gt; 0.06458106 0.32251812</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res4</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.7471878 0.3924569</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res4</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/bootstrap-default-1.png" width="691.2"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res4</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/bootstrap-default-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-external-regressors-1">2 - 2 With external regressors<a class="anchor" aria-label="anchor" href="#with-external-regressors-1"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res5</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, xreg <span class="op">=</span> <span class="va">xreg</span>, </span>
<span>                        type_pi <span class="op">=</span> <span class="st">"bootstrap"</span>, B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.83543  9.489772</span></span>
<span><span class="co">#&gt; Jun 2005 15.85604  9.556819</span></span>
<span><span class="co">#&gt; Jul 2005 16.47363 10.091468</span></span>
<span><span class="co">#&gt; Aug 2005 15.49717  9.499224</span></span>
<span><span class="co">#&gt; Sep 2005 14.92088  9.093326</span></span>
<span><span class="co">#&gt; Oct 2005 14.80031  9.044508</span></span>
<span><span class="co">#&gt; Nov 2005 16.07283  9.721118</span></span>
<span><span class="co">#&gt; Dec 2005 16.55953 10.012005</span></span>
<span><span class="co">#&gt; Jan 2006 16.38269  9.838773</span></span>
<span><span class="co">#&gt; Feb 2006 17.24196 10.332083</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 12.72699  7.686207</span></span>
<span><span class="co">#&gt; Jun 2005 14.27121  8.487002</span></span>
<span><span class="co">#&gt; Jul 2005 11.92056  7.522689</span></span>
<span><span class="co">#&gt; Aug 2005 12.63396  8.135428</span></span>
<span><span class="co">#&gt; Sep 2005 13.39517  8.189226</span></span>
<span><span class="co">#&gt; Oct 2005 10.62521  6.861347</span></span>
<span><span class="co">#&gt; Nov 2005 14.30810  8.911368</span></span>
<span><span class="co">#&gt; Dec 2005 11.71644  7.398021</span></span>
<span><span class="co">#&gt; Jan 2006 13.99457  8.665999</span></span>
<span><span class="co">#&gt; Feb 2006 11.97363  7.533064</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.72106  10.87268</span></span>
<span><span class="co">#&gt; Jun 2005 17.22584  10.42581</span></span>
<span><span class="co">#&gt; Jul 2005 19.31335  11.94216</span></span>
<span><span class="co">#&gt; Aug 2005 17.91034  11.35180</span></span>
<span><span class="co">#&gt; Sep 2005 17.67846  10.95107</span></span>
<span><span class="co">#&gt; Oct 2005 17.38254  10.35569</span></span>
<span><span class="co">#&gt; Nov 2005 17.67314  10.58502</span></span>
<span><span class="co">#&gt; Dec 2005 19.49927  11.56067</span></span>
<span><span class="co">#&gt; Jan 2006 19.08364  11.30186</span></span>
<span><span class="co">#&gt; Feb 2006 20.55522  12.37432</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.20933  9.248692</span></span>
<span><span class="co">#&gt; Jun 2005 17.27866 10.181992</span></span>
<span><span class="co">#&gt; Jul 2005 19.31439 11.954437</span></span>
<span><span class="co">#&gt; Aug 2005 15.71288  9.435132</span></span>
<span><span class="co">#&gt; Sep 2005 14.78888  8.245459</span></span>
<span><span class="co">#&gt; Oct 2005 17.46036  9.863086</span></span>
<span><span class="co">#&gt; Nov 2005 17.49723 10.226270</span></span>
<span><span class="co">#&gt; Dec 2005 18.65309 10.458171</span></span>
<span><span class="co">#&gt; Jan 2006 18.40507 10.598431</span></span>
<span><span class="co">#&gt; Feb 2006 17.45471  9.403776</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.72942  9.514972</span></span>
<span><span class="co">#&gt; Jun 2005 14.09346  8.458399</span></span>
<span><span class="co">#&gt; Jul 2005 18.25350 10.789118</span></span>
<span><span class="co">#&gt; Aug 2005 17.97007 11.672310</span></span>
<span><span class="co">#&gt; Sep 2005 13.23870  8.172901</span></span>
<span><span class="co">#&gt; Oct 2005 15.38918 10.437795</span></span>
<span><span class="co">#&gt; Nov 2005 14.13069  9.070793</span></span>
<span><span class="co">#&gt; Dec 2005 10.83028  6.903871</span></span>
<span><span class="co">#&gt; Jan 2006 14.01583  8.671829</span></span>
<span><span class="co">#&gt; Feb 2006 17.93777 10.714967</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.72106 10.872683</span></span>
<span><span class="co">#&gt; Jun 2005 14.88347  8.941699</span></span>
<span><span class="co">#&gt; Jul 2005 16.30249  9.738921</span></span>
<span><span class="co">#&gt; Aug 2005 14.81684  8.780448</span></span>
<span><span class="co">#&gt; Sep 2005 14.68504  8.613253</span></span>
<span><span class="co">#&gt; Oct 2005 15.71413  9.260283</span></span>
<span><span class="co">#&gt; Nov 2005 17.72422 10.022207</span></span>
<span><span class="co">#&gt; Dec 2005 19.66011 11.586327</span></span>
<span><span class="co">#&gt; Jan 2006 17.02992  9.157579</span></span>
<span><span class="co">#&gt; Feb 2006 20.63057 12.127529</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 12.17858  7.404155</span></span>
<span><span class="co">#&gt; Jun 2005 16.69438  9.967782</span></span>
<span><span class="co">#&gt; Jul 2005 18.79987 11.439357</span></span>
<span><span class="co">#&gt; Aug 2005 15.02971  9.083331</span></span>
<span><span class="co">#&gt; Sep 2005 14.87959  8.973301</span></span>
<span><span class="co">#&gt; Oct 2005 14.62332  8.894779</span></span>
<span><span class="co">#&gt; Nov 2005 15.10973  8.957506</span></span>
<span><span class="co">#&gt; Dec 2005 18.94525 11.472298</span></span>
<span><span class="co">#&gt; Jan 2006 19.23483 11.408549</span></span>
<span><span class="co">#&gt; Feb 2006 18.62945 10.815449</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.87497  9.639481</span></span>
<span><span class="co">#&gt; Jun 2005 16.27445 10.112087</span></span>
<span><span class="co">#&gt; Jul 2005 11.86508  7.401519</span></span>
<span><span class="co">#&gt; Aug 2005 14.58401  8.866675</span></span>
<span><span class="co">#&gt; Sep 2005 15.71663  9.728297</span></span>
<span><span class="co">#&gt; Oct 2005 13.97101  8.768716</span></span>
<span><span class="co">#&gt; Nov 2005 16.67898 10.212294</span></span>
<span><span class="co">#&gt; Dec 2005 15.91397 10.063626</span></span>
<span><span class="co">#&gt; Jan 2006 15.12939  9.691796</span></span>
<span><span class="co">#&gt; Feb 2006 11.21637  7.185258</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.20933  9.248692</span></span>
<span><span class="co">#&gt; Jun 2005 17.04391  9.825523</span></span>
<span><span class="co">#&gt; Jul 2005 19.30979 11.899881</span></span>
<span><span class="co">#&gt; Aug 2005 16.84484 10.247832</span></span>
<span><span class="co">#&gt; Sep 2005 14.78831  9.037350</span></span>
<span><span class="co">#&gt; Oct 2005 14.18791  8.715208</span></span>
<span><span class="co">#&gt; Nov 2005 15.20932  8.897974</span></span>
<span><span class="co">#&gt; Dec 2005 18.19603 10.650764</span></span>
<span><span class="co">#&gt; Jan 2006 18.56289 10.934366</span></span>
<span><span class="co">#&gt; Feb 2006 20.29570 12.445974</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.72106 10.872683</span></span>
<span><span class="co">#&gt; Jun 2005 16.11642  9.726278</span></span>
<span><span class="co">#&gt; Jul 2005 15.68071 10.246019</span></span>
<span><span class="co">#&gt; Aug 2005 12.06781  7.948164</span></span>
<span><span class="co">#&gt; Sep 2005 14.92835  9.304370</span></span>
<span><span class="co">#&gt; Oct 2005 13.30382  8.105049</span></span>
<span><span class="co">#&gt; Nov 2005 14.91919  8.993319</span></span>
<span><span class="co">#&gt; Dec 2005 15.52932  9.381070</span></span>
<span><span class="co">#&gt; Jan 2006 13.98840  8.664306</span></span>
<span><span class="co">#&gt; Feb 2006 17.44368 11.101247</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.61594  8.657718</span></span>
<span><span class="co">#&gt; Jun 2005 15.46367  9.272312</span></span>
<span><span class="co">#&gt; Jul 2005 16.19348  9.995896</span></span>
<span><span class="co">#&gt; Aug 2005 15.58329  9.977242</span></span>
<span><span class="co">#&gt; Sep 2005 14.00118  9.245992</span></span>
<span><span class="co">#&gt; Oct 2005  9.84755  6.500272</span></span>
<span><span class="co">#&gt; Nov 2005 15.00607  9.664711</span></span>
<span><span class="co">#&gt; Dec 2005 16.81473 10.389499</span></span>
<span><span class="co">#&gt; Jan 2006 14.59121  9.035259</span></span>
<span><span class="co">#&gt; Feb 2006 14.58196  8.731063</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.63319  9.847365</span></span>
<span><span class="co">#&gt; Jun 2005 15.00880 10.496599</span></span>
<span><span class="co">#&gt; Jul 2005 12.11165  7.940050</span></span>
<span><span class="co">#&gt; Aug 2005 14.65761  8.898576</span></span>
<span><span class="co">#&gt; Sep 2005 13.93412  8.306272</span></span>
<span><span class="co">#&gt; Oct 2005 17.11447 10.072885</span></span>
<span><span class="co">#&gt; Nov 2005 17.23442 10.579489</span></span>
<span><span class="co">#&gt; Dec 2005 14.76880  9.100092</span></span>
<span><span class="co">#&gt; Jan 2006 16.11455 10.015358</span></span>
<span><span class="co">#&gt; Feb 2006 15.53897  9.273544</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.46143  9.591273</span></span>
<span><span class="co">#&gt; Jun 2005 15.70312  8.585523</span></span>
<span><span class="co">#&gt; Jul 2005 16.90533  9.509479</span></span>
<span><span class="co">#&gt; Aug 2005 17.70462 10.082533</span></span>
<span><span class="co">#&gt; Sep 2005 18.24802 11.306063</span></span>
<span><span class="co">#&gt; Oct 2005 16.39132  9.827007</span></span>
<span><span class="co">#&gt; Nov 2005 17.21848 10.586622</span></span>
<span><span class="co">#&gt; Dec 2005 16.28371 10.114332</span></span>
<span><span class="co">#&gt; Jan 2006 16.75483 10.210257</span></span>
<span><span class="co">#&gt; Feb 2006 18.69041 11.522023</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 13.711787  7.843252</span></span>
<span><span class="co">#&gt; Feb 2002 13.324117  7.475004</span></span>
<span><span class="co">#&gt; Mar 2002 13.587753  7.830287</span></span>
<span><span class="co">#&gt; Apr 2002 13.832811  8.012027</span></span>
<span><span class="co">#&gt; May 2002 13.381182  7.616504</span></span>
<span><span class="co">#&gt; Jun 2002 13.338987  7.806670</span></span>
<span><span class="co">#&gt; Jul 2002 11.662651  6.949718</span></span>
<span><span class="co">#&gt; Aug 2002 12.242217  7.294680</span></span>
<span><span class="co">#&gt; Sep 2002 13.824793  8.160078</span></span>
<span><span class="co">#&gt; Oct 2002 15.337968  8.830015</span></span>
<span><span class="co">#&gt; Nov 2002 15.503580  8.854393</span></span>
<span><span class="co">#&gt; Dec 2002 15.857927  9.038591</span></span>
<span><span class="co">#&gt; Jan 2003 16.387678  9.257229</span></span>
<span><span class="co">#&gt; Feb 2003 16.553813  9.383619</span></span>
<span><span class="co">#&gt; Mar 2003 17.134719  9.686509</span></span>
<span><span class="co">#&gt; Apr 2003 16.219028  9.369500</span></span>
<span><span class="co">#&gt; May 2003 13.511112  8.099575</span></span>
<span><span class="co">#&gt; Jun 2003 13.110407  7.959201</span></span>
<span><span class="co">#&gt; Jul 2003 12.371223  7.809538</span></span>
<span><span class="co">#&gt; Aug 2003 12.408829  7.815604</span></span>
<span><span class="co">#&gt; Sep 2003 11.999511  7.587126</span></span>
<span><span class="co">#&gt; Oct 2003 10.497685  6.763430</span></span>
<span><span class="co">#&gt; Nov 2003 10.376898  6.789662</span></span>
<span><span class="co">#&gt; Dec 2003 12.532319  7.774555</span></span>
<span><span class="co">#&gt; Jan 2004 13.107961  8.200936</span></span>
<span><span class="co">#&gt; Feb 2004 10.080319  6.945952</span></span>
<span><span class="co">#&gt; Mar 2004  9.958216  6.551072</span></span>
<span><span class="co">#&gt; Apr 2004 10.035496  6.494692</span></span>
<span><span class="co">#&gt; May 2004 12.156667  7.796691</span></span>
<span><span class="co">#&gt; Jun 2004 13.952379  8.670150</span></span>
<span><span class="co">#&gt; Jul 2004 14.579737  8.953919</span></span>
<span><span class="co">#&gt; Aug 2004 14.252833  8.842487</span></span>
<span><span class="co">#&gt; Sep 2004 13.422310  8.378485</span></span>
<span><span class="co">#&gt; Oct 2004 13.306547  8.253072</span></span>
<span><span class="co">#&gt; Nov 2004 13.152395  8.301396</span></span>
<span><span class="co">#&gt; Dec 2004 15.307750  8.977439</span></span>
<span><span class="co">#&gt; Jan 2005 15.793871  9.607153</span></span>
<span><span class="co">#&gt; Feb 2005 16.894043  9.965880</span></span>
<span><span class="co">#&gt; Mar 2005 16.493711  9.857297</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;               Quotes    TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.67535261  1.600318363</span></span>
<span><span class="co">#&gt; Feb 2002 -0.09454667  0.059245589</span></span>
<span><span class="co">#&gt; Mar 2002 -0.61710349 -0.617562341</span></span>
<span><span class="co">#&gt; Apr 2002  1.55432930  1.431543276</span></span>
<span><span class="co">#&gt; May 2002 -1.65830176 -1.201288646</span></span>
<span><span class="co">#&gt; Jun 2002 -3.27721670 -1.999680352</span></span>
<span><span class="co">#&gt; Jul 2002 -0.83986146 -0.746117612</span></span>
<span><span class="co">#&gt; Aug 2002  1.04485279  0.291750330</span></span>
<span><span class="co">#&gt; Sep 2002  0.75352722 -0.155143365</span></span>
<span><span class="co">#&gt; Oct 2002  0.26745241  0.004965096</span></span>
<span><span class="co">#&gt; Nov 2002  0.43157027  0.102861987</span></span>
<span><span class="co">#&gt; Dec 2002  1.13693270  0.494399368</span></span>
<span><span class="co">#&gt; Jan 2003  0.49053241  0.135721074</span></span>
<span><span class="co">#&gt; Feb 2003 -0.10253286 -0.465058629</span></span>
<span><span class="co">#&gt; Mar 2003 -1.85353900 -1.312388835</span></span>
<span><span class="co">#&gt; Apr 2003 -0.33001834  0.475005003</span></span>
<span><span class="co">#&gt; May 2003  2.16635830  1.749815332</span></span>
<span><span class="co">#&gt; Jun 2003  0.17739319  0.443529161</span></span>
<span><span class="co">#&gt; Jul 2003  0.27361734  0.111136601</span></span>
<span><span class="co">#&gt; Aug 2003 -0.58111949 -0.379519019</span></span>
<span><span class="co">#&gt; Sep 2003 -2.30767070 -1.246635836</span></span>
<span><span class="co">#&gt; Oct 2003 -0.19353452  0.176564889</span></span>
<span><span class="co">#&gt; Nov 2003  1.00563207  0.187437814</span></span>
<span><span class="co">#&gt; Dec 2003  0.41917089  0.235645632</span></span>
<span><span class="co">#&gt; Jan 2004  0.52295932  1.364524163</span></span>
<span><span class="co">#&gt; Feb 2004 -0.95933919 -0.673442252</span></span>
<span><span class="co">#&gt; Mar 2004 -1.56353647 -0.843576594</span></span>
<span><span class="co">#&gt; Apr 2004  2.26526358  1.468847972</span></span>
<span><span class="co">#&gt; May 2004  1.69164304  0.697529740</span></span>
<span><span class="co">#&gt; Jun 2004  2.01008148  1.118934668</span></span>
<span><span class="co">#&gt; Jul 2004 -0.38235687 -0.261094013</span></span>
<span><span class="co">#&gt; Aug 2004 -1.39361339 -0.785256869</span></span>
<span><span class="co">#&gt; Sep 2004 -1.33394033 -0.789489620</span></span>
<span><span class="co">#&gt; Oct 2004 -0.37279705 -0.008190995</span></span>
<span><span class="co">#&gt; Nov 2004 -1.43004502 -1.625855697</span></span>
<span><span class="co">#&gt; Dec 2004  0.16351013  0.242165460</span></span>
<span><span class="co">#&gt; Jan 2005  2.64510868  1.356646561</span></span>
<span><span class="co">#&gt; Feb 2005  0.59781674  0.490409659</span></span>
<span><span class="co">#&gt; Mar 2005 -2.00203118 -1.128697062</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 1.243869</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 6.628923e-18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;       Quotes    TV.advert       xreg_1 </span></span>
<span><span class="co">#&gt; 2.556419e+00 1.175162e+00 2.765868e-05 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res5</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert      </span></span>
<span><span class="co">#&gt;  Min.   :-3.2772   Min.   :-1.9997  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.8996   1st Qu.:-0.7098  </span></span>
<span><span class="co">#&gt;  Median : 0.1635   Median : 0.1029  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.0000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.8796   3rd Qu.: 0.4827  </span></span>
<span><span class="co">#&gt;  Max.   : 2.6451   Max.   : 1.7498</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res5</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.1553145 0.4247378</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res5</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9498845 0.5141136</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res5</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/bootstrap-xreg-1.png" width="691.2"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res5</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/bootstrap-xreg-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-external-regressors-and-k-means-clustering-1">2 - 3 With external regressors and K-Means clustering<a class="anchor" aria-label="anchor" href="#with-external-regressors-and-k-means-clustering-1"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res6</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, xreg <span class="op">=</span> <span class="va">xreg</span>, </span>
<span>                        centers <span class="op">=</span> <span class="va">centers</span>, </span>
<span>                        type_pi <span class="op">=</span> <span class="st">"bootstrap"</span>, B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res6</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res6</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res6</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res6</span>, <span class="st">"Quotes"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res6</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="with-k-means-clustering-1">2 - 4 With K-Means clustering<a class="anchor" aria-label="anchor" href="#with-k-means-clustering-1"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">centers</span> <span class="op">&lt;-</span> <span class="fl">2L</span></span>
<span><span class="op">(</span><span class="va">res11</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                         centers <span class="op">=</span> <span class="va">centers</span>, </span>
<span>                         type_pi <span class="op">=</span> <span class="st">"bootstrap"</span>, B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.32708  8.399206</span></span>
<span><span class="co">#&gt; Jun 2005 14.31612  8.503191</span></span>
<span><span class="co">#&gt; Jul 2005 14.76350  8.965468</span></span>
<span><span class="co">#&gt; Aug 2005 13.86081  8.446357</span></span>
<span><span class="co">#&gt; Sep 2005 13.03618  7.838714</span></span>
<span><span class="co">#&gt; Oct 2005 12.39534  7.544977</span></span>
<span><span class="co">#&gt; Nov 2005 13.37076  8.187567</span></span>
<span><span class="co">#&gt; Dec 2005 13.91698  8.549895</span></span>
<span><span class="co">#&gt; Jan 2006 14.06238  8.591149</span></span>
<span><span class="co">#&gt; Feb 2006 14.09085  8.540280</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 11.284682  6.625351</span></span>
<span><span class="co">#&gt; Jun 2005 12.166253  6.765894</span></span>
<span><span class="co">#&gt; Jul 2005 10.886798  6.766538</span></span>
<span><span class="co">#&gt; Aug 2005 11.887723  6.930345</span></span>
<span><span class="co">#&gt; Sep 2005 11.162420  6.079473</span></span>
<span><span class="co">#&gt; Oct 2005  9.427798  5.931275</span></span>
<span><span class="co">#&gt; Nov 2005 11.576282  6.818416</span></span>
<span><span class="co">#&gt; Dec 2005  9.463838  6.073640</span></span>
<span><span class="co">#&gt; Jan 2006 10.407246  6.714311</span></span>
<span><span class="co">#&gt; Feb 2006 10.297418  6.392250</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.50808  9.918497</span></span>
<span><span class="co">#&gt; Jun 2005 15.71590  9.861556</span></span>
<span><span class="co">#&gt; Jul 2005 17.06352 10.159994</span></span>
<span><span class="co">#&gt; Aug 2005 16.37813 10.584888</span></span>
<span><span class="co">#&gt; Sep 2005 15.04687  9.462215</span></span>
<span><span class="co">#&gt; Oct 2005 13.73787  8.915743</span></span>
<span><span class="co">#&gt; Nov 2005 15.15790  9.558653</span></span>
<span><span class="co">#&gt; Dec 2005 16.48891  9.993566</span></span>
<span><span class="co">#&gt; Jan 2006 16.89223 10.277552</span></span>
<span><span class="co">#&gt; Feb 2006 17.08241 10.344928</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.65568  8.170631</span></span>
<span><span class="co">#&gt; Jun 2005 15.35745  9.038056</span></span>
<span><span class="co">#&gt; Jul 2005 16.40577  9.926680</span></span>
<span><span class="co">#&gt; Aug 2005 14.63606  8.833730</span></span>
<span><span class="co">#&gt; Sep 2005 13.34227  7.152325</span></span>
<span><span class="co">#&gt; Oct 2005 13.75174  7.515607</span></span>
<span><span class="co">#&gt; Nov 2005 14.09555  8.444960</span></span>
<span><span class="co">#&gt; Dec 2005 14.71117  8.363856</span></span>
<span><span class="co">#&gt; Jan 2006 14.31605  8.617396</span></span>
<span><span class="co">#&gt; Feb 2006 13.47488  7.424363</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.056773  8.297685</span></span>
<span><span class="co">#&gt; Jun 2005 11.829527  6.477062</span></span>
<span><span class="co">#&gt; Jul 2005 17.173612 10.162761</span></span>
<span><span class="co">#&gt; Aug 2005 16.473867 10.841108</span></span>
<span><span class="co">#&gt; Sep 2005 11.290624  6.833885</span></span>
<span><span class="co">#&gt; Oct 2005 13.037923  9.079531</span></span>
<span><span class="co">#&gt; Nov 2005 12.427143  8.024259</span></span>
<span><span class="co">#&gt; Dec 2005  8.774729  5.685244</span></span>
<span><span class="co">#&gt; Jan 2006 12.582546  7.914658</span></span>
<span><span class="co">#&gt; Feb 2006 16.586368 10.285817</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.50808  9.918497</span></span>
<span><span class="co">#&gt; Jun 2005 13.78653  8.161275</span></span>
<span><span class="co">#&gt; Jul 2005 14.06746  8.296698</span></span>
<span><span class="co">#&gt; Aug 2005 12.29965  6.672348</span></span>
<span><span class="co">#&gt; Sep 2005 11.59809  6.059709</span></span>
<span><span class="co">#&gt; Oct 2005 12.30659  6.993926</span></span>
<span><span class="co">#&gt; Nov 2005 14.51474  8.133464</span></span>
<span><span class="co">#&gt; Dec 2005 16.59440  9.852058</span></span>
<span><span class="co">#&gt; Jan 2006 14.65757  7.847667</span></span>
<span><span class="co">#&gt; Feb 2006 15.61485  9.180133</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 10.79010  6.397701</span></span>
<span><span class="co">#&gt; Jun 2005 14.78861  9.073833</span></span>
<span><span class="co">#&gt; Jul 2005 16.35578  9.964976</span></span>
<span><span class="co">#&gt; Aug 2005 12.99090  7.986807</span></span>
<span><span class="co">#&gt; Sep 2005 11.60194  7.113592</span></span>
<span><span class="co">#&gt; Oct 2005 12.12803  7.537839</span></span>
<span><span class="co">#&gt; Nov 2005 11.56836  6.728296</span></span>
<span><span class="co">#&gt; Dec 2005 14.97311  8.980773</span></span>
<span><span class="co">#&gt; Jan 2006 17.28836 10.537553</span></span>
<span><span class="co">#&gt; Feb 2006 14.80743  8.633680</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.779884  8.903908</span></span>
<span><span class="co">#&gt; Jun 2005 15.819962  9.800163</span></span>
<span><span class="co">#&gt; Jul 2005 10.845764  6.657057</span></span>
<span><span class="co">#&gt; Aug 2005 12.737884  7.929339</span></span>
<span><span class="co">#&gt; Sep 2005 15.122692  9.359640</span></span>
<span><span class="co">#&gt; Oct 2005 13.036504  8.234931</span></span>
<span><span class="co">#&gt; Nov 2005 15.250946  9.640472</span></span>
<span><span class="co">#&gt; Dec 2005 12.854671  8.330116</span></span>
<span><span class="co">#&gt; Jan 2006 14.781117  9.381996</span></span>
<span><span class="co">#&gt; Feb 2006  9.849188  6.175823</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.65568  8.170631</span></span>
<span><span class="co">#&gt; Jun 2005 14.42312  7.939831</span></span>
<span><span class="co">#&gt; Jul 2005 16.68429 10.150465</span></span>
<span><span class="co">#&gt; Aug 2005 16.04838  9.702354</span></span>
<span><span class="co">#&gt; Sep 2005 14.26185  8.607542</span></span>
<span><span class="co">#&gt; Oct 2005 13.69009  8.351585</span></span>
<span><span class="co">#&gt; Nov 2005 13.23220  7.824597</span></span>
<span><span class="co">#&gt; Dec 2005 14.86856  8.800651</span></span>
<span><span class="co">#&gt; Jan 2006 15.52775  9.310415</span></span>
<span><span class="co">#&gt; Feb 2006 16.59688 10.335559</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.508081  9.918497</span></span>
<span><span class="co">#&gt; Jun 2005 15.117906  8.951818</span></span>
<span><span class="co">#&gt; Jul 2005 14.702122  9.588448</span></span>
<span><span class="co">#&gt; Aug 2005 11.768131  7.851198</span></span>
<span><span class="co">#&gt; Sep 2005 13.869773  9.007677</span></span>
<span><span class="co">#&gt; Oct 2005 10.155538  5.927834</span></span>
<span><span class="co">#&gt; Nov 2005 11.603580  7.128828</span></span>
<span><span class="co">#&gt; Dec 2005 11.837435  7.411448</span></span>
<span><span class="co">#&gt; Jan 2006  9.775707  6.385273</span></span>
<span><span class="co">#&gt; Feb 2006 12.553801  8.268530</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 12.988249  7.409480</span></span>
<span><span class="co">#&gt; Jun 2005 13.326084  7.949730</span></span>
<span><span class="co">#&gt; Jul 2005 16.320144  9.854044</span></span>
<span><span class="co">#&gt; Aug 2005 14.394542  8.752315</span></span>
<span><span class="co">#&gt; Sep 2005 13.363707  8.613227</span></span>
<span><span class="co">#&gt; Oct 2005  9.216518  5.943130</span></span>
<span><span class="co">#&gt; Nov 2005 12.168812  7.976424</span></span>
<span><span class="co">#&gt; Dec 2005 15.749406  9.980675</span></span>
<span><span class="co">#&gt; Jan 2006 13.101375  8.271496</span></span>
<span><span class="co">#&gt; Feb 2006 11.841320  7.137724</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.76457  8.442647</span></span>
<span><span class="co">#&gt; Jun 2005 14.11468  9.879380</span></span>
<span><span class="co">#&gt; Jul 2005 11.02814  7.143639</span></span>
<span><span class="co">#&gt; Aug 2005 13.35221  8.075374</span></span>
<span><span class="co">#&gt; Sep 2005 11.12520  6.147549</span></span>
<span><span class="co">#&gt; Oct 2005 13.63890  7.871999</span></span>
<span><span class="co">#&gt; Nov 2005 14.00883  8.697537</span></span>
<span><span class="co">#&gt; Dec 2005 12.68076  8.096819</span></span>
<span><span class="co">#&gt; Jan 2006 13.79625  8.865090</span></span>
<span><span class="co">#&gt; Feb 2006 12.36041  7.613528</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.56371  8.362382</span></span>
<span><span class="co">#&gt; Jun 2005 14.59737  7.760759</span></span>
<span><span class="co">#&gt; Jul 2005 14.05192  7.909907</span></span>
<span><span class="co">#&gt; Aug 2005 13.90647  7.819000</span></span>
<span><span class="co">#&gt; Sep 2005 14.78570  9.491995</span></span>
<span><span class="co">#&gt; Oct 2005 12.99151  7.993385</span></span>
<span><span class="co">#&gt; Nov 2005 14.83743  9.276832</span></span>
<span><span class="co">#&gt; Dec 2005 16.12556  9.997309</span></span>
<span><span class="co">#&gt; Jan 2006 14.79707  8.779948</span></span>
<span><span class="co">#&gt; Feb 2006 17.22337 10.347648</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 14.080025  8.217172</span></span>
<span><span class="co">#&gt; Feb 2002 14.097935  8.504100</span></span>
<span><span class="co">#&gt; Mar 2002 14.037980  8.254621</span></span>
<span><span class="co">#&gt; Apr 2002 14.080025  8.217172</span></span>
<span><span class="co">#&gt; May 2002 14.097935  8.504100</span></span>
<span><span class="co">#&gt; Jun 2002 13.400229  7.842877</span></span>
<span><span class="co">#&gt; Jul 2002 11.963099  7.227708</span></span>
<span><span class="co">#&gt; Aug 2002 12.483082  7.479137</span></span>
<span><span class="co">#&gt; Sep 2002 14.051200  8.267892</span></span>
<span><span class="co">#&gt; Oct 2002 15.653409  9.046206</span></span>
<span><span class="co">#&gt; Nov 2002 15.895374  9.120444</span></span>
<span><span class="co">#&gt; Dec 2002 16.246375  9.254438</span></span>
<span><span class="co">#&gt; Jan 2003 16.880238  9.544966</span></span>
<span><span class="co">#&gt; Feb 2003 17.003473  9.571713</span></span>
<span><span class="co">#&gt; Mar 2003 17.231948  9.639966</span></span>
<span><span class="co">#&gt; Apr 2003 16.195870  9.248908</span></span>
<span><span class="co">#&gt; May 2003 14.058413  8.543376</span></span>
<span><span class="co">#&gt; Jun 2003 13.651791  8.393671</span></span>
<span><span class="co">#&gt; Jul 2003 12.716624  8.056579</span></span>
<span><span class="co">#&gt; Aug 2003 12.646146  7.882686</span></span>
<span><span class="co">#&gt; Sep 2003 12.337320  7.628455</span></span>
<span><span class="co">#&gt; Oct 2003 10.858041  6.918282</span></span>
<span><span class="co">#&gt; Nov 2003 10.947373  7.048306</span></span>
<span><span class="co">#&gt; Dec 2003 12.300163  7.539882</span></span>
<span><span class="co">#&gt; Jan 2004 12.920135  8.002056</span></span>
<span><span class="co">#&gt; Feb 2004 10.524137  7.198956</span></span>
<span><span class="co">#&gt; Mar 2004 10.198641  6.670517</span></span>
<span><span class="co">#&gt; Apr 2004  9.921236  6.478631</span></span>
<span><span class="co">#&gt; May 2004 12.093310  7.711550</span></span>
<span><span class="co">#&gt; Jun 2004 13.435713  8.168927</span></span>
<span><span class="co">#&gt; Jul 2004 14.330379  8.636496</span></span>
<span><span class="co">#&gt; Aug 2004 13.676214  8.257946</span></span>
<span><span class="co">#&gt; Sep 2004 12.711040  7.946941</span></span>
<span><span class="co">#&gt; Oct 2004 12.438696  7.709987</span></span>
<span><span class="co">#&gt; Nov 2004 12.493577  7.932898</span></span>
<span><span class="co">#&gt; Dec 2004 13.094054  7.775530</span></span>
<span><span class="co">#&gt; Jan 2005 14.800106  8.733646</span></span>
<span><span class="co">#&gt; Feb 2005 16.091897  9.445771</span></span>
<span><span class="co">#&gt; Mar 2005 15.560027  9.180879</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;                Quotes   TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.307114839  1.22639837</span></span>
<span><span class="co">#&gt; Feb 2002 -0.868364597 -0.96984988</span></span>
<span><span class="co">#&gt; Mar 2002 -1.067329559 -1.04189553</span></span>
<span><span class="co">#&gt; Apr 2002  1.307114839  1.22639837</span></span>
<span><span class="co">#&gt; May 2002 -2.375054597 -2.08888488</span></span>
<span><span class="co">#&gt; Jun 2002 -3.338459123 -2.03588722</span></span>
<span><span class="co">#&gt; Jul 2002 -1.140308873 -1.02410785</span></span>
<span><span class="co">#&gt; Aug 2002  0.803987736  0.10729330</span></span>
<span><span class="co">#&gt; Sep 2002  0.527119680 -0.26295692</span></span>
<span><span class="co">#&gt; Oct 2002 -0.047988643 -0.21122600</span></span>
<span><span class="co">#&gt; Nov 2002  0.039776086 -0.16318896</span></span>
<span><span class="co">#&gt; Dec 2002  0.748484692  0.27855217</span></span>
<span><span class="co">#&gt; Jan 2003 -0.002027973 -0.15201590</span></span>
<span><span class="co">#&gt; Feb 2003 -0.552192724 -0.65315272</span></span>
<span><span class="co">#&gt; Mar 2003 -1.950768084 -1.26584601</span></span>
<span><span class="co">#&gt; Apr 2003 -0.306860047  0.59559733</span></span>
<span><span class="co">#&gt; May 2003  1.619056967  1.30601353</span></span>
<span><span class="co">#&gt; Jun 2003 -0.363991107  0.00905855</span></span>
<span><span class="co">#&gt; Jul 2003 -0.071784477 -0.13590381</span></span>
<span><span class="co">#&gt; Aug 2003 -0.818435582 -0.44660102</span></span>
<span><span class="co">#&gt; Sep 2003 -2.645480110 -1.28796505</span></span>
<span><span class="co">#&gt; Oct 2003 -0.553891055  0.02171253</span></span>
<span><span class="co">#&gt; Nov 2003  0.435156765 -0.07120594</span></span>
<span><span class="co">#&gt; Dec 2003  0.651326753  0.47031930</span></span>
<span><span class="co">#&gt; Jan 2004  0.710784799  1.56340435</span></span>
<span><span class="co">#&gt; Feb 2004 -1.403156976 -0.92644608</span></span>
<span><span class="co">#&gt; Mar 2004 -1.803961042 -0.96302233</span></span>
<span><span class="co">#&gt; Apr 2004  2.379523900  1.48490908</span></span>
<span><span class="co">#&gt; May 2004  1.755000239  0.78267104</span></span>
<span><span class="co">#&gt; Jun 2004  2.526746719  1.62015783</span></span>
<span><span class="co">#&gt; Jul 2004 -0.132999437  0.05632932</span></span>
<span><span class="co">#&gt; Aug 2004 -0.816993774 -0.20071589</span></span>
<span><span class="co">#&gt; Sep 2004 -0.622669658 -0.35794574</span></span>
<span><span class="co">#&gt; Oct 2004  0.495054063  0.53489384</span></span>
<span><span class="co">#&gt; Nov 2004 -0.771226686 -1.25735840</span></span>
<span><span class="co">#&gt; Dec 2004  2.377205824  1.44407360</span></span>
<span><span class="co">#&gt; Jan 2005  3.638874496  2.23015367</span></span>
<span><span class="co">#&gt; Feb 2005  1.399962612  1.01051877</span></span>
<span><span class="co">#&gt; Mar 2005 -1.068346882 -0.45227882</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 1.557655</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 2.232715e-17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;       Quotes    TV.advert xreg_cluster </span></span>
<span><span class="co">#&gt;    3.0295614    1.4590629    0.1843407 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res11</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes           TV.advert      </span></span>
<span><span class="co">#&gt;  Min.   :-3.33846   Min.   :-2.0889  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.84340   1st Qu.:-0.7898  </span></span>
<span><span class="co">#&gt;  Median :-0.07178   Median :-0.1359  </span></span>
<span><span class="co">#&gt;  Mean   : 0.00000   Mean   : 0.0000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.77624   3rd Qu.: 0.6891  </span></span>
<span><span class="co">#&gt;  Max.   : 3.63887   Max.   : 2.2302</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res11</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.0461306 0.2610091</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res11</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9864921 0.5720541</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res11</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/bootstrap-kmeans-1.png" width="691.2"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res11</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/bootstrap-kmeans-2.png" width="691.2"></p>
</div>
</div>
<div class="section level2">
<h2 id="prediction-intervals-based-on-block-bootstrap">3 - Prediction intervals based on block bootstrap<a class="anchor" aria-label="anchor" href="#prediction-intervals-based-on-block-bootstrap"></a>
</h2>
<div class="section level3">
<h3 id="with-default-parameters-2">3 - 1 With default parameters<a class="anchor" aria-label="anchor" href="#with-default-parameters-2"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">block_length</span> <span class="op">&lt;-</span> <span class="fl">5L</span></span>
<span><span class="op">(</span><span class="va">res7</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                        type_pi <span class="op">=</span> <span class="st">"blockbootstrap"</span>, </span>
<span>                        block_length <span class="op">=</span> <span class="va">block_length</span>,</span>
<span>                        B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.13318  9.457489</span></span>
<span><span class="co">#&gt; Jun 2005 13.06337  8.059138</span></span>
<span><span class="co">#&gt; Jul 2005 12.29234  7.795193</span></span>
<span><span class="co">#&gt; Aug 2005 12.73193  7.997832</span></span>
<span><span class="co">#&gt; Sep 2005 12.95504  7.942264</span></span>
<span><span class="co">#&gt; Oct 2005 13.33709  8.048628</span></span>
<span><span class="co">#&gt; Nov 2005 14.27552  8.641482</span></span>
<span><span class="co">#&gt; Dec 2005 13.62071  8.193504</span></span>
<span><span class="co">#&gt; Jan 2006 13.64814  8.365103</span></span>
<span><span class="co">#&gt; Feb 2006 13.39110  8.073276</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.640946  8.306569</span></span>
<span><span class="co">#&gt; Jun 2005 10.252219  6.779478</span></span>
<span><span class="co">#&gt; Jul 2005  9.527768  6.292099</span></span>
<span><span class="co">#&gt; Aug 2005 10.764155  6.980176</span></span>
<span><span class="co">#&gt; Sep 2005 10.343459  6.313223</span></span>
<span><span class="co">#&gt; Oct 2005 10.244834  6.218023</span></span>
<span><span class="co">#&gt; Nov 2005 12.441824  8.122031</span></span>
<span><span class="co">#&gt; Dec 2005  9.709844  5.664417</span></span>
<span><span class="co">#&gt; Jan 2006  8.779085  5.462274</span></span>
<span><span class="co">#&gt; Feb 2006  8.997235  5.866455</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.66178 10.256485</span></span>
<span><span class="co">#&gt; Jun 2005 15.70532  9.203036</span></span>
<span><span class="co">#&gt; Jul 2005 15.91362 10.524887</span></span>
<span><span class="co">#&gt; Aug 2005 15.81746  9.412302</span></span>
<span><span class="co">#&gt; Sep 2005 17.83907 10.571785</span></span>
<span><span class="co">#&gt; Oct 2005 17.24635 10.231500</span></span>
<span><span class="co">#&gt; Nov 2005 15.92240  9.537640</span></span>
<span><span class="co">#&gt; Dec 2005 17.98942 10.281448</span></span>
<span><span class="co">#&gt; Jan 2006 19.43840 11.082768</span></span>
<span><span class="co">#&gt; Feb 2006 19.10688 11.037584</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.961639  9.917500</span></span>
<span><span class="co">#&gt; Jun 2005 12.743466  8.424202</span></span>
<span><span class="co">#&gt; Jul 2005 10.975130  7.368483</span></span>
<span><span class="co">#&gt; Aug 2005 10.575207  6.859284</span></span>
<span><span class="co">#&gt; Sep 2005 10.219173  6.588731</span></span>
<span><span class="co">#&gt; Oct 2005 10.184934  6.103088</span></span>
<span><span class="co">#&gt; Nov 2005 13.689388  8.851325</span></span>
<span><span class="co">#&gt; Dec 2005  9.389090  5.325269</span></span>
<span><span class="co">#&gt; Jan 2006  8.593317  5.164489</span></span>
<span><span class="co">#&gt; Feb 2006  9.911279  5.838859</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.923084 10.170358</span></span>
<span><span class="co">#&gt; Jun 2005 10.252219  6.779478</span></span>
<span><span class="co">#&gt; Jul 2005  9.527768  6.292099</span></span>
<span><span class="co">#&gt; Aug 2005 13.169226  8.421625</span></span>
<span><span class="co">#&gt; Sep 2005 14.211894  8.687393</span></span>
<span><span class="co">#&gt; Oct 2005 14.800152  8.720328</span></span>
<span><span class="co">#&gt; Nov 2005 15.592098  8.705125</span></span>
<span><span class="co">#&gt; Dec 2005 16.399773  9.292347</span></span>
<span><span class="co">#&gt; Jan 2006 16.353486  9.145230</span></span>
<span><span class="co">#&gt; Feb 2006 17.237784  9.606621</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.923084 10.170358</span></span>
<span><span class="co">#&gt; Jun 2005 10.252219  6.779478</span></span>
<span><span class="co">#&gt; Jul 2005  9.527768  6.292099</span></span>
<span><span class="co">#&gt; Aug 2005 13.169226  8.421625</span></span>
<span><span class="co">#&gt; Sep 2005 14.211894  8.687393</span></span>
<span><span class="co">#&gt; Oct 2005 12.826568  7.584607</span></span>
<span><span class="co">#&gt; Nov 2005 14.675960  8.544418</span></span>
<span><span class="co">#&gt; Dec 2005 15.571327  8.625669</span></span>
<span><span class="co">#&gt; Jan 2006 16.417689  9.255064</span></span>
<span><span class="co">#&gt; Feb 2006 16.383271  9.126644</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.59321  8.278953</span></span>
<span><span class="co">#&gt; Jun 2005 11.20004  7.117434</span></span>
<span><span class="co">#&gt; Jul 2005 11.46427  7.551714</span></span>
<span><span class="co">#&gt; Aug 2005 12.22603  7.424259</span></span>
<span><span class="co">#&gt; Sep 2005 13.55649  8.331353</span></span>
<span><span class="co">#&gt; Oct 2005 12.81698  7.949924</span></span>
<span><span class="co">#&gt; Nov 2005 13.54421  8.564323</span></span>
<span><span class="co">#&gt; Dec 2005 12.06123  6.832594</span></span>
<span><span class="co">#&gt; Jan 2006 15.68414  9.311793</span></span>
<span><span class="co">#&gt; Feb 2006 18.64480 11.054873</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.80524 10.181310</span></span>
<span><span class="co">#&gt; Jun 2005 14.94485  9.028306</span></span>
<span><span class="co">#&gt; Jul 2005 13.57398  8.380690</span></span>
<span><span class="co">#&gt; Aug 2005 12.66011  7.870669</span></span>
<span><span class="co">#&gt; Sep 2005 13.41813  8.498107</span></span>
<span><span class="co">#&gt; Oct 2005 12.95384  7.940495</span></span>
<span><span class="co">#&gt; Nov 2005 13.59121  8.033005</span></span>
<span><span class="co">#&gt; Dec 2005 13.35516  8.005734</span></span>
<span><span class="co">#&gt; Jan 2006 14.59959  9.748521</span></span>
<span><span class="co">#&gt; Feb 2006 12.42439  8.281098</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.729535  9.142963</span></span>
<span><span class="co">#&gt; Jun 2005 15.705318  9.203036</span></span>
<span><span class="co">#&gt; Jul 2005 15.913618 10.524887</span></span>
<span><span class="co">#&gt; Aug 2005 11.576221  7.396579</span></span>
<span><span class="co">#&gt; Sep 2005 10.771554  6.936910</span></span>
<span><span class="co">#&gt; Oct 2005 12.588134  7.571416</span></span>
<span><span class="co">#&gt; Nov 2005 13.803821  8.428673</span></span>
<span><span class="co">#&gt; Dec 2005 14.228496  9.854274</span></span>
<span><span class="co">#&gt; Jan 2006  9.606171  6.487977</span></span>
<span><span class="co">#&gt; Feb 2006  8.887510  5.961508</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.729535  9.142963</span></span>
<span><span class="co">#&gt; Jun 2005 15.705318  9.203036</span></span>
<span><span class="co">#&gt; Jul 2005 15.913618 10.524887</span></span>
<span><span class="co">#&gt; Aug 2005 11.576221  7.396579</span></span>
<span><span class="co">#&gt; Sep 2005 10.771554  6.936910</span></span>
<span><span class="co">#&gt; Oct 2005 10.451156  6.613910</span></span>
<span><span class="co">#&gt; Nov 2005 12.121776  8.478145</span></span>
<span><span class="co">#&gt; Dec 2005 10.814666  7.561439</span></span>
<span><span class="co">#&gt; Jan 2006  9.418952  6.567691</span></span>
<span><span class="co">#&gt; Feb 2006  9.375176  6.226668</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.69348  8.890481</span></span>
<span><span class="co">#&gt; Jun 2005 13.48778  8.217040</span></span>
<span><span class="co">#&gt; Jul 2005 11.16029  7.102348</span></span>
<span><span class="co">#&gt; Aug 2005 11.41497  7.526636</span></span>
<span><span class="co">#&gt; Sep 2005 12.18701  7.403738</span></span>
<span><span class="co">#&gt; Oct 2005 16.57467 10.085307</span></span>
<span><span class="co">#&gt; Nov 2005 15.88382  9.736893</span></span>
<span><span class="co">#&gt; Dec 2005 12.94425  8.027855</span></span>
<span><span class="co">#&gt; Jan 2006 14.79569  9.634984</span></span>
<span><span class="co">#&gt; Feb 2006 10.75217  6.322139</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.80537  8.401690</span></span>
<span><span class="co">#&gt; Jun 2005 14.39382  8.981247</span></span>
<span><span class="co">#&gt; Jul 2005 12.72469  7.125754</span></span>
<span><span class="co">#&gt; Aug 2005 16.09680  9.479206</span></span>
<span><span class="co">#&gt; Sep 2005 18.89212 11.118867</span></span>
<span><span class="co">#&gt; Oct 2005 17.44136 10.273943</span></span>
<span><span class="co">#&gt; Nov 2005 15.93361  8.588339</span></span>
<span><span class="co">#&gt; Dec 2005 18.45093 10.405466</span></span>
<span><span class="co">#&gt; Jan 2006 20.31538 11.470130</span></span>
<span><span class="co">#&gt; Feb 2006 19.24104 10.978036</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.16762 10.278310</span></span>
<span><span class="co">#&gt; Jun 2005 11.94868  6.858120</span></span>
<span><span class="co">#&gt; Jul 2005 12.14228  6.788973</span></span>
<span><span class="co">#&gt; Aug 2005 14.85531  9.181855</span></span>
<span><span class="co">#&gt; Sep 2005 11.31063  6.233237</span></span>
<span><span class="co">#&gt; Oct 2005 12.73315  7.643266</span></span>
<span><span class="co">#&gt; Nov 2005 13.91935  8.484571</span></span>
<span><span class="co">#&gt; Dec 2005 12.99215  8.004390</span></span>
<span><span class="co">#&gt; Jan 2006 10.69701  6.865152</span></span>
<span><span class="co">#&gt; Feb 2006 11.05357  7.336318</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 13.983454  8.113042</span></span>
<span><span class="co">#&gt; Feb 2002 14.310140  8.680078</span></span>
<span><span class="co">#&gt; Mar 2002 14.204085  8.367422</span></span>
<span><span class="co">#&gt; Apr 2002 13.983454  8.113042</span></span>
<span><span class="co">#&gt; May 2002 14.310140  8.680078</span></span>
<span><span class="co">#&gt; Jun 2002 13.136549  7.573500</span></span>
<span><span class="co">#&gt; Jul 2002 12.139564  7.269130</span></span>
<span><span class="co">#&gt; Aug 2002 12.630260  7.516240</span></span>
<span><span class="co">#&gt; Sep 2002 14.247551  8.406368</span></span>
<span><span class="co">#&gt; Oct 2002 15.085483  8.610639</span></span>
<span><span class="co">#&gt; Nov 2002 15.834616  9.129753</span></span>
<span><span class="co">#&gt; Dec 2002 16.037153  9.175375</span></span>
<span><span class="co">#&gt; Jan 2003 16.609951  9.409639</span></span>
<span><span class="co">#&gt; Feb 2003 16.579674  9.347087</span></span>
<span><span class="co">#&gt; Mar 2003 16.452555  9.136445</span></span>
<span><span class="co">#&gt; Apr 2003 15.691303  8.874788</span></span>
<span><span class="co">#&gt; May 2003 14.054876  8.529575</span></span>
<span><span class="co">#&gt; Jun 2003 13.434843  8.229103</span></span>
<span><span class="co">#&gt; Jul 2003 12.715293  7.977976</span></span>
<span><span class="co">#&gt; Aug 2003 12.998432  8.104914</span></span>
<span><span class="co">#&gt; Sep 2003 12.590713  7.879126</span></span>
<span><span class="co">#&gt; Oct 2003 10.931512  7.005044</span></span>
<span><span class="co">#&gt; Nov 2003 10.416928  6.781919</span></span>
<span><span class="co">#&gt; Dec 2003 13.045036  8.079712</span></span>
<span><span class="co">#&gt; Jan 2004 13.471769  8.342884</span></span>
<span><span class="co">#&gt; Feb 2004  8.822228  6.015318</span></span>
<span><span class="co">#&gt; Mar 2004  9.707979  6.398258</span></span>
<span><span class="co">#&gt; Apr 2004  9.811491  6.420448</span></span>
<span><span class="co">#&gt; May 2004 11.936553  7.582567</span></span>
<span><span class="co">#&gt; Jun 2004 13.921151  8.555557</span></span>
<span><span class="co">#&gt; Jul 2004 14.494976  8.746341</span></span>
<span><span class="co">#&gt; Aug 2004 14.079472  8.618854</span></span>
<span><span class="co">#&gt; Sep 2004 13.046936  8.135087</span></span>
<span><span class="co">#&gt; Oct 2004 12.726572  7.953926</span></span>
<span><span class="co">#&gt; Nov 2004 12.426974  7.834539</span></span>
<span><span class="co">#&gt; Dec 2004 13.211185  7.811190</span></span>
<span><span class="co">#&gt; Jan 2005 15.485788  9.264229</span></span>
<span><span class="co">#&gt; Feb 2005 16.598686  9.685778</span></span>
<span><span class="co">#&gt; Mar 2005 16.037908  9.448414</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;               Quotes   TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.40368643  1.33052782</span></span>
<span><span class="co">#&gt; Feb 2002 -1.08056990 -1.14582835</span></span>
<span><span class="co">#&gt; Mar 2002 -1.23343504 -1.15469695</span></span>
<span><span class="co">#&gt; Apr 2002  1.40368643  1.33052782</span></span>
<span><span class="co">#&gt; May 2002 -2.58725990 -2.26486335</span></span>
<span><span class="co">#&gt; Jun 2002 -3.07477874 -1.76651025</span></span>
<span><span class="co">#&gt; Jul 2002 -1.31677412 -1.06553020</span></span>
<span><span class="co">#&gt; Aug 2002  0.65681006  0.07019039</span></span>
<span><span class="co">#&gt; Sep 2002  0.33076863 -0.40143292</span></span>
<span><span class="co">#&gt; Oct 2002  0.51993723  0.22434076</span></span>
<span><span class="co">#&gt; Nov 2002  0.10053432 -0.17249791</span></span>
<span><span class="co">#&gt; Dec 2002  0.95770684  0.35761548</span></span>
<span><span class="co">#&gt; Jan 2003  0.26825909 -0.01668861</span></span>
<span><span class="co">#&gt; Feb 2003 -0.12839403 -0.42852687</span></span>
<span><span class="co">#&gt; Mar 2003 -1.17137522 -0.76232506</span></span>
<span><span class="co">#&gt; Apr 2003  0.19770654  0.96971721</span></span>
<span><span class="co">#&gt; May 2003  1.62259434  1.31981494</span></span>
<span><span class="co">#&gt; Jun 2003 -0.14704277  0.17362676</span></span>
<span><span class="co">#&gt; Jul 2003 -0.07045343 -0.05730098</span></span>
<span><span class="co">#&gt; Aug 2003 -1.17072203 -0.66882907</span></span>
<span><span class="co">#&gt; Sep 2003 -2.89887258 -1.53863637</span></span>
<span><span class="co">#&gt; Oct 2003 -0.62736155 -0.06504866</span></span>
<span><span class="co">#&gt; Nov 2003  0.96560231  0.19518092</span></span>
<span><span class="co">#&gt; Dec 2003 -0.09354593 -0.06951135</span></span>
<span><span class="co">#&gt; Jan 2004  0.15915097  1.22257588</span></span>
<span><span class="co">#&gt; Feb 2004  0.29875209  0.25719228</span></span>
<span><span class="co">#&gt; Mar 2004 -1.31329880 -0.69076345</span></span>
<span><span class="co">#&gt; Apr 2004  2.48926902  1.54309187</span></span>
<span><span class="co">#&gt; May 2004  1.91175656  0.91165371</span></span>
<span><span class="co">#&gt; Jun 2004  2.04130891  1.23352769</span></span>
<span><span class="co">#&gt; Jul 2004 -0.29759583 -0.05351566</span></span>
<span><span class="co">#&gt; Aug 2004 -1.22025180 -0.56162404</span></span>
<span><span class="co">#&gt; Sep 2004 -0.95856611 -0.54609232</span></span>
<span><span class="co">#&gt; Oct 2004  0.20717781  0.29095534</span></span>
<span><span class="co">#&gt; Nov 2004 -0.70462371 -1.15899926</span></span>
<span><span class="co">#&gt; Dec 2004  2.26007518  1.40841386</span></span>
<span><span class="co">#&gt; Jan 2005  2.95319223  1.69957104</span></span>
<span><span class="co">#&gt; Feb 2005  0.89317411  0.77051186</span></span>
<span><span class="co">#&gt; Mar 2005 -1.54622760 -0.71981400</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 1.924173</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 3.601775e-17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt;  2.601976  1.246370 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res7</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert       </span></span>
<span><span class="co">#&gt;  Min.   :-3.0748   Min.   :-2.26486  </span></span>
<span><span class="co">#&gt;  1st Qu.:-1.1256   1st Qu.:-0.67980  </span></span>
<span><span class="co">#&gt;  Median : 0.1005   Median :-0.05352  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.00000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.9254   3rd Qu.: 0.84108  </span></span>
<span><span class="co">#&gt;  Max.   : 2.9532   Max.   : 1.69957</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res7</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Quotes  TV.advert </span></span>
<span><span class="co">#&gt; 0.06458106 0.32251812</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res7</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.7471878 0.3924569</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res7</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-default-1.png" width="691.2"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res7</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-default-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-external-regressors-2">3 - 2 With external regressors<a class="anchor" aria-label="anchor" href="#with-external-regressors-2"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res8</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, xreg <span class="op">=</span> <span class="va">xreg</span>, </span>
<span>                        type_pi <span class="op">=</span> <span class="st">"blockbootstrap"</span>, </span>
<span>                        block_length <span class="op">=</span> <span class="va">block_length</span>,</span>
<span>                        B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.93292  9.927867</span></span>
<span><span class="co">#&gt; Jun 2005 14.62582  9.159010</span></span>
<span><span class="co">#&gt; Jul 2005 13.75974  8.768195</span></span>
<span><span class="co">#&gt; Aug 2005 14.37756  9.002538</span></span>
<span><span class="co">#&gt; Sep 2005 14.82859  9.086496</span></span>
<span><span class="co">#&gt; Oct 2005 15.50606  9.312723</span></span>
<span><span class="co">#&gt; Nov 2005 16.56312  9.907583</span></span>
<span><span class="co">#&gt; Dec 2005 16.46826  9.883022</span></span>
<span><span class="co">#&gt; Jan 2006 16.63819 10.087099</span></span>
<span><span class="co">#&gt; Feb 2006 17.05429 10.250023</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.29124  8.706589</span></span>
<span><span class="co">#&gt; Jun 2005 11.34974  7.525175</span></span>
<span><span class="co">#&gt; Jul 2005 10.98139  7.100955</span></span>
<span><span class="co">#&gt; Aug 2005 11.91583  7.837910</span></span>
<span><span class="co">#&gt; Sep 2005 12.13687  7.691967</span></span>
<span><span class="co">#&gt; Oct 2005 12.46851  7.484113</span></span>
<span><span class="co">#&gt; Nov 2005 14.81651  8.811267</span></span>
<span><span class="co">#&gt; Dec 2005 13.63208  7.894731</span></span>
<span><span class="co">#&gt; Jan 2006 12.49490  7.621327</span></span>
<span><span class="co">#&gt; Feb 2006 12.76658  8.094808</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.39057  10.95110</span></span>
<span><span class="co">#&gt; Jun 2005 17.55234  10.44702</span></span>
<span><span class="co">#&gt; Jul 2005 17.42791  11.45397</span></span>
<span><span class="co">#&gt; Aug 2005 16.72187  10.33188</span></span>
<span><span class="co">#&gt; Sep 2005 18.98099  11.22142</span></span>
<span><span class="co">#&gt; Oct 2005 18.50937  10.97776</span></span>
<span><span class="co">#&gt; Nov 2005 18.37324  10.94087</span></span>
<span><span class="co">#&gt; Dec 2005 19.72103  11.60998</span></span>
<span><span class="co">#&gt; Jan 2006 21.10967  12.08978</span></span>
<span><span class="co">#&gt; Feb 2006 21.21273  11.98270</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.12578  9.878841</span></span>
<span><span class="co">#&gt; Jun 2005 15.41501 10.378988</span></span>
<span><span class="co">#&gt; Jul 2005 12.54950  8.710196</span></span>
<span><span class="co">#&gt; Aug 2005 11.73579  7.789848</span></span>
<span><span class="co">#&gt; Sep 2005 12.11073  7.680743</span></span>
<span><span class="co">#&gt; Oct 2005 13.33255  7.974199</span></span>
<span><span class="co">#&gt; Nov 2005 17.34201 10.874971</span></span>
<span><span class="co">#&gt; Dec 2005 13.79355  8.378351</span></span>
<span><span class="co">#&gt; Jan 2006 12.38883  7.467185</span></span>
<span><span class="co">#&gt; Feb 2006 14.73481  8.531035</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.97876 10.768360</span></span>
<span><span class="co">#&gt; Jun 2005 11.34974  7.525175</span></span>
<span><span class="co">#&gt; Jul 2005 10.98139  7.100955</span></span>
<span><span class="co">#&gt; Aug 2005 15.44516  9.621484</span></span>
<span><span class="co">#&gt; Sep 2005 16.72932 10.088001</span></span>
<span><span class="co">#&gt; Oct 2005 17.51265 10.291912</span></span>
<span><span class="co">#&gt; Nov 2005 18.38565 10.321924</span></span>
<span><span class="co">#&gt; Dec 2005 19.81424 11.270619</span></span>
<span><span class="co">#&gt; Jan 2006 20.19970 11.421108</span></span>
<span><span class="co">#&gt; Feb 2006 21.35149 12.002285</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.97876 10.768360</span></span>
<span><span class="co">#&gt; Jun 2005 11.34974  7.525175</span></span>
<span><span class="co">#&gt; Jul 2005 10.98139  7.100955</span></span>
<span><span class="co">#&gt; Aug 2005 15.44516  9.621484</span></span>
<span><span class="co">#&gt; Sep 2005 16.72932 10.088001</span></span>
<span><span class="co">#&gt; Oct 2005 15.62793  9.254044</span></span>
<span><span class="co">#&gt; Nov 2005 17.82430 10.383988</span></span>
<span><span class="co">#&gt; Dec 2005 18.86784 10.533007</span></span>
<span><span class="co">#&gt; Jan 2006 20.29563 11.474313</span></span>
<span><span class="co">#&gt; Feb 2006 20.70262 11.633848</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.87468  9.024316</span></span>
<span><span class="co">#&gt; Jun 2005 13.12866  8.202981</span></span>
<span><span class="co">#&gt; Jul 2005 14.10769  8.998497</span></span>
<span><span class="co">#&gt; Aug 2005 15.00476  9.017367</span></span>
<span><span class="co">#&gt; Sep 2005 16.41816  9.940874</span></span>
<span><span class="co">#&gt; Oct 2005 14.91342  9.130982</span></span>
<span><span class="co">#&gt; Nov 2005 15.22212  9.548900</span></span>
<span><span class="co">#&gt; Dec 2005 13.58520  7.754325</span></span>
<span><span class="co">#&gt; Jan 2006 17.39954 10.286250</span></span>
<span><span class="co">#&gt; Feb 2006 20.27961 11.897792</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.46588 10.522770</span></span>
<span><span class="co">#&gt; Jun 2005 16.00567  9.593406</span></span>
<span><span class="co">#&gt; Jul 2005 14.80009  9.068744</span></span>
<span><span class="co">#&gt; Aug 2005 13.96074  8.614358</span></span>
<span><span class="co">#&gt; Sep 2005 14.60824  9.186582</span></span>
<span><span class="co">#&gt; Oct 2005 15.14617  9.290168</span></span>
<span><span class="co">#&gt; Nov 2005 15.48430  9.114929</span></span>
<span><span class="co">#&gt; Dec 2005 15.11850  8.843028</span></span>
<span><span class="co">#&gt; Jan 2006 16.78499 10.650305</span></span>
<span><span class="co">#&gt; Feb 2006 17.26246 11.243429</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.46143  9.591273</span></span>
<span><span class="co">#&gt; Jun 2005 17.55234 10.447025</span></span>
<span><span class="co">#&gt; Jul 2005 17.42791 11.453975</span></span>
<span><span class="co">#&gt; Aug 2005 12.53595  8.003457</span></span>
<span><span class="co">#&gt; Sep 2005 12.22690  7.730630</span></span>
<span><span class="co">#&gt; Oct 2005 15.07683  8.841656</span></span>
<span><span class="co">#&gt; Nov 2005 17.30371 10.303588</span></span>
<span><span class="co">#&gt; Dec 2005 17.73890 11.695926</span></span>
<span><span class="co">#&gt; Jan 2006 12.86025  8.227742</span></span>
<span><span class="co">#&gt; Feb 2006 12.63914  7.968162</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.46143  9.591273</span></span>
<span><span class="co">#&gt; Jun 2005 17.55234 10.447025</span></span>
<span><span class="co">#&gt; Jul 2005 17.42791 11.453975</span></span>
<span><span class="co">#&gt; Aug 2005 12.53595  8.003457</span></span>
<span><span class="co">#&gt; Sep 2005 12.22690  7.730630</span></span>
<span><span class="co">#&gt; Oct 2005 12.21766  7.341830</span></span>
<span><span class="co">#&gt; Nov 2005 15.04576  9.633535</span></span>
<span><span class="co">#&gt; Dec 2005 16.51964 10.856920</span></span>
<span><span class="co">#&gt; Jan 2006 13.96170  9.379486</span></span>
<span><span class="co">#&gt; Feb 2006 13.20556  8.565970</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.72942  9.514972</span></span>
<span><span class="co">#&gt; Jun 2005 15.17064  9.280168</span></span>
<span><span class="co">#&gt; Jul 2005 13.04263  8.213002</span></span>
<span><span class="co">#&gt; Aug 2005 13.96530  8.942326</span></span>
<span><span class="co">#&gt; Sep 2005 14.94964  8.987836</span></span>
<span><span class="co">#&gt; Oct 2005 18.69609 11.083351</span></span>
<span><span class="co">#&gt; Nov 2005 18.33051 10.960007</span></span>
<span><span class="co">#&gt; Dec 2005 15.39545  9.235400</span></span>
<span><span class="co">#&gt; Jan 2006 18.16634 11.572344</span></span>
<span><span class="co">#&gt; Feb 2006 15.14727  9.561710</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.12186  8.614346</span></span>
<span><span class="co">#&gt; Jun 2005 14.71754  9.221823</span></span>
<span><span class="co">#&gt; Jul 2005 13.10834  7.471507</span></span>
<span><span class="co">#&gt; Aug 2005 16.84335  9.976562</span></span>
<span><span class="co">#&gt; Sep 2005 19.63471 11.550480</span></span>
<span><span class="co">#&gt; Oct 2005 17.86625 10.614059</span></span>
<span><span class="co">#&gt; Nov 2005 15.94289  8.723108</span></span>
<span><span class="co">#&gt; Dec 2005 19.39999 11.313965</span></span>
<span><span class="co">#&gt; Jan 2006 21.34601 12.240000</span></span>
<span><span class="co">#&gt; Feb 2006 20.73479 11.915256</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.13115 11.004154</span></span>
<span><span class="co">#&gt; Jun 2005 14.01651  8.968336</span></span>
<span><span class="co">#&gt; Jul 2005 13.17051  8.110142</span></span>
<span><span class="co">#&gt; Aug 2005 16.30345 10.435035</span></span>
<span><span class="co">#&gt; Sep 2005 12.65203  7.881186</span></span>
<span><span class="co">#&gt; Oct 2005 14.67111  9.305029</span></span>
<span><span class="co">#&gt; Nov 2005 14.74995  9.210878</span></span>
<span><span class="co">#&gt; Dec 2005 14.44934  8.948683</span></span>
<span><span class="co">#&gt; Jan 2006 12.97897  8.152258</span></span>
<span><span class="co">#&gt; Feb 2006 14.48511  9.180738</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 13.711787  7.843252</span></span>
<span><span class="co">#&gt; Feb 2002 13.324117  7.475004</span></span>
<span><span class="co">#&gt; Mar 2002 13.587753  7.830287</span></span>
<span><span class="co">#&gt; Apr 2002 13.832811  8.012027</span></span>
<span><span class="co">#&gt; May 2002 13.381182  7.616504</span></span>
<span><span class="co">#&gt; Jun 2002 13.338987  7.806670</span></span>
<span><span class="co">#&gt; Jul 2002 11.662651  6.949718</span></span>
<span><span class="co">#&gt; Aug 2002 12.242217  7.294680</span></span>
<span><span class="co">#&gt; Sep 2002 13.824793  8.160078</span></span>
<span><span class="co">#&gt; Oct 2002 15.337968  8.830015</span></span>
<span><span class="co">#&gt; Nov 2002 15.503580  8.854393</span></span>
<span><span class="co">#&gt; Dec 2002 15.857927  9.038591</span></span>
<span><span class="co">#&gt; Jan 2003 16.387678  9.257229</span></span>
<span><span class="co">#&gt; Feb 2003 16.553813  9.383619</span></span>
<span><span class="co">#&gt; Mar 2003 17.134719  9.686509</span></span>
<span><span class="co">#&gt; Apr 2003 16.219028  9.369500</span></span>
<span><span class="co">#&gt; May 2003 13.511112  8.099575</span></span>
<span><span class="co">#&gt; Jun 2003 13.110407  7.959201</span></span>
<span><span class="co">#&gt; Jul 2003 12.371223  7.809538</span></span>
<span><span class="co">#&gt; Aug 2003 12.408829  7.815604</span></span>
<span><span class="co">#&gt; Sep 2003 11.999511  7.587126</span></span>
<span><span class="co">#&gt; Oct 2003 10.497685  6.763430</span></span>
<span><span class="co">#&gt; Nov 2003 10.376898  6.789662</span></span>
<span><span class="co">#&gt; Dec 2003 12.532319  7.774555</span></span>
<span><span class="co">#&gt; Jan 2004 13.107961  8.200936</span></span>
<span><span class="co">#&gt; Feb 2004 10.080319  6.945952</span></span>
<span><span class="co">#&gt; Mar 2004  9.958216  6.551072</span></span>
<span><span class="co">#&gt; Apr 2004 10.035496  6.494692</span></span>
<span><span class="co">#&gt; May 2004 12.156667  7.796691</span></span>
<span><span class="co">#&gt; Jun 2004 13.952379  8.670150</span></span>
<span><span class="co">#&gt; Jul 2004 14.579737  8.953919</span></span>
<span><span class="co">#&gt; Aug 2004 14.252833  8.842487</span></span>
<span><span class="co">#&gt; Sep 2004 13.422310  8.378485</span></span>
<span><span class="co">#&gt; Oct 2004 13.306547  8.253072</span></span>
<span><span class="co">#&gt; Nov 2004 13.152395  8.301396</span></span>
<span><span class="co">#&gt; Dec 2004 15.307750  8.977439</span></span>
<span><span class="co">#&gt; Jan 2005 15.793871  9.607153</span></span>
<span><span class="co">#&gt; Feb 2005 16.894043  9.965880</span></span>
<span><span class="co">#&gt; Mar 2005 16.493711  9.857297</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;               Quotes    TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.67535261  1.600318363</span></span>
<span><span class="co">#&gt; Feb 2002 -0.09454667  0.059245589</span></span>
<span><span class="co">#&gt; Mar 2002 -0.61710349 -0.617562341</span></span>
<span><span class="co">#&gt; Apr 2002  1.55432930  1.431543276</span></span>
<span><span class="co">#&gt; May 2002 -1.65830176 -1.201288646</span></span>
<span><span class="co">#&gt; Jun 2002 -3.27721670 -1.999680352</span></span>
<span><span class="co">#&gt; Jul 2002 -0.83986146 -0.746117612</span></span>
<span><span class="co">#&gt; Aug 2002  1.04485279  0.291750330</span></span>
<span><span class="co">#&gt; Sep 2002  0.75352722 -0.155143365</span></span>
<span><span class="co">#&gt; Oct 2002  0.26745241  0.004965096</span></span>
<span><span class="co">#&gt; Nov 2002  0.43157027  0.102861987</span></span>
<span><span class="co">#&gt; Dec 2002  1.13693270  0.494399368</span></span>
<span><span class="co">#&gt; Jan 2003  0.49053241  0.135721074</span></span>
<span><span class="co">#&gt; Feb 2003 -0.10253286 -0.465058629</span></span>
<span><span class="co">#&gt; Mar 2003 -1.85353900 -1.312388835</span></span>
<span><span class="co">#&gt; Apr 2003 -0.33001834  0.475005003</span></span>
<span><span class="co">#&gt; May 2003  2.16635830  1.749815332</span></span>
<span><span class="co">#&gt; Jun 2003  0.17739319  0.443529161</span></span>
<span><span class="co">#&gt; Jul 2003  0.27361734  0.111136601</span></span>
<span><span class="co">#&gt; Aug 2003 -0.58111949 -0.379519019</span></span>
<span><span class="co">#&gt; Sep 2003 -2.30767070 -1.246635836</span></span>
<span><span class="co">#&gt; Oct 2003 -0.19353452  0.176564889</span></span>
<span><span class="co">#&gt; Nov 2003  1.00563207  0.187437814</span></span>
<span><span class="co">#&gt; Dec 2003  0.41917089  0.235645632</span></span>
<span><span class="co">#&gt; Jan 2004  0.52295932  1.364524163</span></span>
<span><span class="co">#&gt; Feb 2004 -0.95933919 -0.673442252</span></span>
<span><span class="co">#&gt; Mar 2004 -1.56353647 -0.843576594</span></span>
<span><span class="co">#&gt; Apr 2004  2.26526358  1.468847972</span></span>
<span><span class="co">#&gt; May 2004  1.69164304  0.697529740</span></span>
<span><span class="co">#&gt; Jun 2004  2.01008148  1.118934668</span></span>
<span><span class="co">#&gt; Jul 2004 -0.38235687 -0.261094013</span></span>
<span><span class="co">#&gt; Aug 2004 -1.39361339 -0.785256869</span></span>
<span><span class="co">#&gt; Sep 2004 -1.33394033 -0.789489620</span></span>
<span><span class="co">#&gt; Oct 2004 -0.37279705 -0.008190995</span></span>
<span><span class="co">#&gt; Nov 2004 -1.43004502 -1.625855697</span></span>
<span><span class="co">#&gt; Dec 2004  0.16351013  0.242165460</span></span>
<span><span class="co">#&gt; Jan 2005  2.64510868  1.356646561</span></span>
<span><span class="co">#&gt; Feb 2005  0.59781674  0.490409659</span></span>
<span><span class="co">#&gt; Mar 2005 -2.00203118 -1.128697062</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 1.243869</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 6.628923e-18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;       Quotes    TV.advert       xreg_1 </span></span>
<span><span class="co">#&gt; 2.556419e+00 1.175162e+00 2.765868e-05 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res8</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert      </span></span>
<span><span class="co">#&gt;  Min.   :-3.2772   Min.   :-1.9997  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.8996   1st Qu.:-0.7098  </span></span>
<span><span class="co">#&gt;  Median : 0.1635   Median : 0.1029  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.0000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.8796   3rd Qu.: 0.4827  </span></span>
<span><span class="co">#&gt;  Max.   : 2.6451   Max.   : 1.7498</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res8</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.1553145 0.4247378</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res8</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9498845 0.5141136</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res8</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-xreg-1.png" width="691.2"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res8</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-xreg-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-external-regressors-and-k-means-clustering-2">3 - 3 With external regressors and K-Means clustering<a class="anchor" aria-label="anchor" href="#with-external-regressors-and-k-means-clustering-2"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res9</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                        xreg <span class="op">=</span> <span class="va">xreg</span>, centers <span class="op">=</span> <span class="va">centers</span>, </span>
<span>                        type_pi <span class="op">=</span> <span class="st">"blockbootstrap"</span>, </span>
<span>                        block_length <span class="op">=</span> <span class="va">block_length</span>,</span>
<span>                        B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.87936 10.716806</span></span>
<span><span class="co">#&gt; Jun 2005 14.73579  9.338066</span></span>
<span><span class="co">#&gt; Jul 2005 13.05395  8.493161</span></span>
<span><span class="co">#&gt; Aug 2005 13.87795  8.965622</span></span>
<span><span class="co">#&gt; Sep 2005 13.78457  8.741938</span></span>
<span><span class="co">#&gt; Oct 2005 14.82008  9.267813</span></span>
<span><span class="co">#&gt; Nov 2005 14.76693  9.160693</span></span>
<span><span class="co">#&gt; Dec 2005 14.53729  9.061837</span></span>
<span><span class="co">#&gt; Jan 2006 15.88133 10.090839</span></span>
<span><span class="co">#&gt; Feb 2006 16.14784 10.198217</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.63149  9.669451</span></span>
<span><span class="co">#&gt; Jun 2005 12.22373  7.930571</span></span>
<span><span class="co">#&gt; Jul 2005 11.00816  6.789641</span></span>
<span><span class="co">#&gt; Aug 2005 11.18584  7.449065</span></span>
<span><span class="co">#&gt; Sep 2005 11.47642  7.683375</span></span>
<span><span class="co">#&gt; Oct 2005 11.16090  6.893401</span></span>
<span><span class="co">#&gt; Nov 2005 12.60737  8.094105</span></span>
<span><span class="co">#&gt; Dec 2005 12.26927  7.148968</span></span>
<span><span class="co">#&gt; Jan 2006 11.32992  7.623142</span></span>
<span><span class="co">#&gt; Feb 2006 10.69357  7.434046</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.59882  11.69936</span></span>
<span><span class="co">#&gt; Jun 2005 17.47376  10.67522</span></span>
<span><span class="co">#&gt; Jul 2005 16.22413  10.86079</span></span>
<span><span class="co">#&gt; Aug 2005 16.65679  10.07919</span></span>
<span><span class="co">#&gt; Sep 2005 18.54883  11.20657</span></span>
<span><span class="co">#&gt; Oct 2005 18.41692  11.11626</span></span>
<span><span class="co">#&gt; Nov 2005 16.48506  10.11562</span></span>
<span><span class="co">#&gt; Dec 2005 19.73482  11.73426</span></span>
<span><span class="co">#&gt; Jan 2006 22.22714  13.11096</span></span>
<span><span class="co">#&gt; Feb 2006 21.89140  12.85078</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.09922 10.707785</span></span>
<span><span class="co">#&gt; Jun 2005 14.83771 10.072133</span></span>
<span><span class="co">#&gt; Jul 2005 12.10024  8.511284</span></span>
<span><span class="co">#&gt; Aug 2005 10.91159  7.408977</span></span>
<span><span class="co">#&gt; Sep 2005 11.62116  7.670350</span></span>
<span><span class="co">#&gt; Oct 2005 10.94771  6.713638</span></span>
<span><span class="co">#&gt; Nov 2005 15.46007 10.010173</span></span>
<span><span class="co">#&gt; Dec 2005 12.66267  7.934806</span></span>
<span><span class="co">#&gt; Jan 2006 12.00359  7.650353</span></span>
<span><span class="co">#&gt; Feb 2006 14.40162  8.997656</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.16582 11.699355</span></span>
<span><span class="co">#&gt; Jun 2005 12.87540  8.503753</span></span>
<span><span class="co">#&gt; Jul 2005 11.00816  7.415423</span></span>
<span><span class="co">#&gt; Aug 2005 14.89092  9.750715</span></span>
<span><span class="co">#&gt; Sep 2005 14.19125  8.803452</span></span>
<span><span class="co">#&gt; Oct 2005 18.09600 11.125951</span></span>
<span><span class="co">#&gt; Nov 2005 15.99992  9.041329</span></span>
<span><span class="co">#&gt; Dec 2005 19.85641 11.851253</span></span>
<span><span class="co">#&gt; Jan 2006 20.30366 12.059624</span></span>
<span><span class="co">#&gt; Feb 2006 21.32896 12.605057</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.16582 11.699355</span></span>
<span><span class="co">#&gt; Jun 2005 12.87540  8.503753</span></span>
<span><span class="co">#&gt; Jul 2005 11.00816  7.415423</span></span>
<span><span class="co">#&gt; Aug 2005 14.89092  9.750715</span></span>
<span><span class="co">#&gt; Sep 2005 14.19125  8.803452</span></span>
<span><span class="co">#&gt; Oct 2005 16.32469 10.172069</span></span>
<span><span class="co">#&gt; Nov 2005 16.62591 10.146235</span></span>
<span><span class="co">#&gt; Dec 2005 15.19149  8.687645</span></span>
<span><span class="co">#&gt; Jan 2006 19.67946 11.841613</span></span>
<span><span class="co">#&gt; Feb 2006 19.86264 11.860771</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.02841  9.954661</span></span>
<span><span class="co">#&gt; Jun 2005 12.03454  7.764163</span></span>
<span><span class="co">#&gt; Jul 2005 13.87055  9.336074</span></span>
<span><span class="co">#&gt; Aug 2005 13.64359  8.690733</span></span>
<span><span class="co">#&gt; Sep 2005 14.50606  9.268209</span></span>
<span><span class="co">#&gt; Oct 2005 11.89524  7.512583</span></span>
<span><span class="co">#&gt; Nov 2005 13.82398  8.832379</span></span>
<span><span class="co">#&gt; Dec 2005 12.15505  6.920821</span></span>
<span><span class="co">#&gt; Jan 2006 17.10039 10.281997</span></span>
<span><span class="co">#&gt; Feb 2006 19.83002 11.925664</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.56397 10.733135</span></span>
<span><span class="co">#&gt; Jun 2005 16.11508  9.885879</span></span>
<span><span class="co">#&gt; Jul 2005 14.25189  8.997077</span></span>
<span><span class="co">#&gt; Aug 2005 12.13049  7.587143</span></span>
<span><span class="co">#&gt; Sep 2005 13.87523  8.815728</span></span>
<span><span class="co">#&gt; Oct 2005 13.25336  8.348240</span></span>
<span><span class="co">#&gt; Nov 2005 14.15313  8.696261</span></span>
<span><span class="co">#&gt; Dec 2005 13.68773  8.484098</span></span>
<span><span class="co">#&gt; Jan 2006 15.70622 10.618389</span></span>
<span><span class="co">#&gt; Feb 2006 14.34849  9.993382</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.59882 10.625734</span></span>
<span><span class="co">#&gt; Jun 2005 17.47376 10.675222</span></span>
<span><span class="co">#&gt; Jul 2005 16.22413 10.860792</span></span>
<span><span class="co">#&gt; Aug 2005 12.81774  8.463017</span></span>
<span><span class="co">#&gt; Sep 2005 11.47642  7.728240</span></span>
<span><span class="co">#&gt; Oct 2005 15.41590  9.797025</span></span>
<span><span class="co">#&gt; Nov 2005 14.57397  9.322402</span></span>
<span><span class="co">#&gt; Dec 2005 13.83251  9.826653</span></span>
<span><span class="co">#&gt; Jan 2006 11.26820  7.839979</span></span>
<span><span class="co">#&gt; Feb 2006 10.66211  7.421512</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.59882 10.625734</span></span>
<span><span class="co">#&gt; Jun 2005 17.47376 10.675222</span></span>
<span><span class="co">#&gt; Jul 2005 16.22413 10.860792</span></span>
<span><span class="co">#&gt; Aug 2005 12.81774  8.463017</span></span>
<span><span class="co">#&gt; Sep 2005 11.47642  7.728240</span></span>
<span><span class="co">#&gt; Oct 2005 12.27029  8.057674</span></span>
<span><span class="co">#&gt; Nov 2005 13.48851  9.456218</span></span>
<span><span class="co">#&gt; Dec 2005 13.08401  9.292402</span></span>
<span><span class="co">#&gt; Jan 2006 11.54249  8.354087</span></span>
<span><span class="co">#&gt; Feb 2006 10.80193  7.477222</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.48451 10.183227</span></span>
<span><span class="co">#&gt; Jun 2005 14.09576  8.662416</span></span>
<span><span class="co">#&gt; Jul 2005 12.05757  7.761583</span></span>
<span><span class="co">#&gt; Aug 2005 13.99415  9.405121</span></span>
<span><span class="co">#&gt; Sep 2005 13.79910  8.789455</span></span>
<span><span class="co">#&gt; Oct 2005 16.57631 10.142214</span></span>
<span><span class="co">#&gt; Nov 2005 15.23740  9.508107</span></span>
<span><span class="co">#&gt; Dec 2005 12.75226  8.133230</span></span>
<span><span class="co">#&gt; Jan 2006 16.87193 11.230912</span></span>
<span><span class="co">#&gt; Feb 2006 14.25391  9.297444</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.51626  9.586648</span></span>
<span><span class="co">#&gt; Jun 2005 14.05324  8.877252</span></span>
<span><span class="co">#&gt; Jul 2005 11.97113  6.710325</span></span>
<span><span class="co">#&gt; Aug 2005 16.91500 10.088024</span></span>
<span><span class="co">#&gt; Sep 2005 19.72254 11.769317</span></span>
<span><span class="co">#&gt; Oct 2005 18.51009 11.082880</span></span>
<span><span class="co">#&gt; Nov 2005 15.95483  8.665660</span></span>
<span><span class="co">#&gt; Dec 2005 19.31602 11.331270</span></span>
<span><span class="co">#&gt; Jan 2006 22.78557 13.416193</span></span>
<span><span class="co">#&gt; Feb 2006 22.05469 12.922119</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.57199 11.352423</span></span>
<span><span class="co">#&gt; Jun 2005 15.52323  9.760870</span></span>
<span><span class="co">#&gt; Jul 2005 11.82352  7.062840</span></span>
<span><span class="co">#&gt; Aug 2005 15.76738 10.048757</span></span>
<span><span class="co">#&gt; Sep 2005 12.98629  8.042940</span></span>
<span><span class="co">#&gt; Oct 2005 14.91120  9.725854</span></span>
<span><span class="co">#&gt; Nov 2005 12.35156  7.928169</span></span>
<span><span class="co">#&gt; Dec 2005 12.83473  8.156193</span></span>
<span><span class="co">#&gt; Jan 2006 11.55180  7.615242</span></span>
<span><span class="co">#&gt; Feb 2006 13.93402  9.481343</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 14.13745  8.221510</span></span>
<span><span class="co">#&gt; Feb 2002 12.96072  7.428876</span></span>
<span><span class="co">#&gt; Mar 2002 14.24210  8.365273</span></span>
<span><span class="co">#&gt; Apr 2002 14.10917  8.240689</span></span>
<span><span class="co">#&gt; May 2002 13.10385  7.576098</span></span>
<span><span class="co">#&gt; Jun 2002 12.85752  7.487839</span></span>
<span><span class="co">#&gt; Jul 2002 10.99640  6.477627</span></span>
<span><span class="co">#&gt; Aug 2002 11.68936  6.906576</span></span>
<span><span class="co">#&gt; Sep 2002 14.24311  8.442819</span></span>
<span><span class="co">#&gt; Oct 2002 15.11602  8.697927</span></span>
<span><span class="co">#&gt; Nov 2002 15.36602  8.771311</span></span>
<span><span class="co">#&gt; Dec 2002 15.81962  8.978734</span></span>
<span><span class="co">#&gt; Jan 2003 16.70731  9.329729</span></span>
<span><span class="co">#&gt; Feb 2003 16.86211  9.434764</span></span>
<span><span class="co">#&gt; Mar 2003 17.15027  9.618099</span></span>
<span><span class="co">#&gt; Apr 2003 16.11209  9.267083</span></span>
<span><span class="co">#&gt; May 2003 13.68703  8.152303</span></span>
<span><span class="co">#&gt; Jun 2003 13.27600  8.009960</span></span>
<span><span class="co">#&gt; Jul 2003 12.48263  7.867811</span></span>
<span><span class="co">#&gt; Aug 2003 12.12160  7.611787</span></span>
<span><span class="co">#&gt; Sep 2003 11.84829  7.397798</span></span>
<span><span class="co">#&gt; Oct 2003 10.57706  6.670099</span></span>
<span><span class="co">#&gt; Nov 2003 10.10601  6.481728</span></span>
<span><span class="co">#&gt; Dec 2003 12.27065  7.533845</span></span>
<span><span class="co">#&gt; Jan 2004 12.78740  7.996468</span></span>
<span><span class="co">#&gt; Feb 2004 10.16008  6.985412</span></span>
<span><span class="co">#&gt; Mar 2004 10.68037  6.951665</span></span>
<span><span class="co">#&gt; Apr 2004 11.39454  7.393299</span></span>
<span><span class="co">#&gt; May 2004 11.76171  7.533014</span></span>
<span><span class="co">#&gt; Jun 2004 14.72078  9.186313</span></span>
<span><span class="co">#&gt; Jul 2004 14.67146  8.963637</span></span>
<span><span class="co">#&gt; Aug 2004 14.87019  9.270515</span></span>
<span><span class="co">#&gt; Sep 2004 12.89441  8.132710</span></span>
<span><span class="co">#&gt; Oct 2004 12.66447  7.932732</span></span>
<span><span class="co">#&gt; Nov 2004 12.61418  8.047571</span></span>
<span><span class="co">#&gt; Dec 2004 15.06624  9.010981</span></span>
<span><span class="co">#&gt; Jan 2005 15.81507  9.700709</span></span>
<span><span class="co">#&gt; Feb 2005 16.88152  9.920224</span></span>
<span><span class="co">#&gt; Mar 2005 16.37843  9.807854</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;               Quotes   TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.24969289  1.22205996</span></span>
<span><span class="co">#&gt; Feb 2002  0.26885280  0.10537425</span></span>
<span><span class="co">#&gt; Mar 2002 -1.27144871 -1.15254827</span></span>
<span><span class="co">#&gt; Apr 2002  1.27797385  1.20288136</span></span>
<span><span class="co">#&gt; May 2002 -1.38096578 -1.16088326</span></span>
<span><span class="co">#&gt; Jun 2002 -2.79575299 -1.68084898</span></span>
<span><span class="co">#&gt; Jul 2002 -0.17360895 -0.27402696</span></span>
<span><span class="co">#&gt; Aug 2002  1.59770503  0.67985439</span></span>
<span><span class="co">#&gt; Sep 2002  0.33520729 -0.43788428</span></span>
<span><span class="co">#&gt; Oct 2002  0.48939779  0.13705250</span></span>
<span><span class="co">#&gt; Nov 2002  0.56912818  0.18594378</span></span>
<span><span class="co">#&gt; Dec 2002  1.17523937  0.55425563</span></span>
<span><span class="co">#&gt; Jan 2003  0.17089673  0.06322060</span></span>
<span><span class="co">#&gt; Feb 2003 -0.41082535 -0.51620445</span></span>
<span><span class="co">#&gt; Mar 2003 -1.86908938 -1.24397877</span></span>
<span><span class="co">#&gt; Apr 2003 -0.22307977  0.57742184</span></span>
<span><span class="co">#&gt; May 2003  1.99043807  1.69708709</span></span>
<span><span class="co">#&gt; Jun 2003  0.01180193  0.39277043</span></span>
<span><span class="co">#&gt; Jul 2003  0.16221379  0.05286418</span></span>
<span><span class="co">#&gt; Aug 2003 -0.29389157 -0.17570225</span></span>
<span><span class="co">#&gt; Sep 2003 -2.15645148 -1.05730773</span></span>
<span><span class="co">#&gt; Oct 2003 -0.27291405  0.26989565</span></span>
<span><span class="co">#&gt; Nov 2003  1.27652294  0.49537161</span></span>
<span><span class="co">#&gt; Dec 2003  0.68083925  0.47635585</span></span>
<span><span class="co">#&gt; Jan 2004  0.84352463  1.56899240</span></span>
<span><span class="co">#&gt; Feb 2004 -1.03909866 -0.71290176</span></span>
<span><span class="co">#&gt; Mar 2004 -2.28568521 -1.24416952</span></span>
<span><span class="co">#&gt; Apr 2004  0.90622268  0.57024150</span></span>
<span><span class="co">#&gt; May 2004  2.08659600  0.96120683</span></span>
<span><span class="co">#&gt; Jun 2004  1.24167683  0.60277201</span></span>
<span><span class="co">#&gt; Jul 2004 -0.47408066 -0.27081190</span></span>
<span><span class="co">#&gt; Aug 2004 -2.01097473 -1.21328460</span></span>
<span><span class="co">#&gt; Sep 2004 -0.80604087 -0.54371464</span></span>
<span><span class="co">#&gt; Oct 2004  0.26928009  0.31214938</span></span>
<span><span class="co">#&gt; Nov 2004 -0.89182765 -1.37203092</span></span>
<span><span class="co">#&gt; Dec 2004  0.40502425  0.20862299</span></span>
<span><span class="co">#&gt; Jan 2005  2.62390929  1.26309148</span></span>
<span><span class="co">#&gt; Feb 2005  0.61033897  0.53606615</span></span>
<span><span class="co">#&gt; Mar 2005 -1.88674685 -1.07925360</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 0.9839062</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 1.289992e-17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;       Quotes    TV.advert       xreg_1 xreg_cluster </span></span>
<span><span class="co">#&gt; 2.581749e+00 1.181670e+00 4.725259e-05 1.721592e-01 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res9</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert      </span></span>
<span><span class="co">#&gt;  Min.   :-2.7958   Min.   :-1.6808  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.8489   1st Qu.:-0.6283  </span></span>
<span><span class="co">#&gt;  Median : 0.1709   Median : 0.1371  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.0000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.8749   3rd Qu.: 0.5622  </span></span>
<span><span class="co">#&gt;  Max.   : 2.6239   Max.   : 1.6971</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res9</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.2414578 0.6241519</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res9</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.6746224 0.2274255</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res9</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-xreg-clustering-1.png" width="691.2"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res9</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-xreg-clustering-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-k-means-clustering-2">3 - 4 With K-Means clustering<a class="anchor" aria-label="anchor" href="#with-k-means-clustering-2"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res12</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                         centers <span class="op">=</span> <span class="va">centers</span>, </span>
<span>                         type_pi <span class="op">=</span> <span class="st">"blockbootstrap"</span>, </span>
<span>                         block_length <span class="op">=</span> <span class="va">block_length</span>,</span>
<span>                         B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.55916  8.982198</span></span>
<span><span class="co">#&gt; Jun 2005 13.30080  8.205313</span></span>
<span><span class="co">#&gt; Jul 2005 12.45360  7.911496</span></span>
<span><span class="co">#&gt; Aug 2005 12.70337  7.980666</span></span>
<span><span class="co">#&gt; Sep 2005 12.95177  7.946961</span></span>
<span><span class="co">#&gt; Oct 2005 13.05999  7.869920</span></span>
<span><span class="co">#&gt; Nov 2005 13.67829  8.252088</span></span>
<span><span class="co">#&gt; Dec 2005 13.59933  8.208368</span></span>
<span><span class="co">#&gt; Jan 2006 13.43847  8.245434</span></span>
<span><span class="co">#&gt; Feb 2006 13.56230  8.220233</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.354169  8.006935</span></span>
<span><span class="co">#&gt; Jun 2005 10.227152  6.666565</span></span>
<span><span class="co">#&gt; Jul 2005  9.523353  6.249106</span></span>
<span><span class="co">#&gt; Aug 2005 10.650913  6.794771</span></span>
<span><span class="co">#&gt; Sep 2005  9.964139  6.367774</span></span>
<span><span class="co">#&gt; Oct 2005  9.573694  5.937758</span></span>
<span><span class="co">#&gt; Nov 2005 11.060611  7.477264</span></span>
<span><span class="co">#&gt; Dec 2005 10.757477  6.180966</span></span>
<span><span class="co">#&gt; Jan 2006  8.911216  5.458253</span></span>
<span><span class="co">#&gt; Feb 2006  8.724155  5.638263</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.38089 10.040977</span></span>
<span><span class="co">#&gt; Jun 2005 16.01992  9.488437</span></span>
<span><span class="co">#&gt; Jul 2005 16.11374 10.729587</span></span>
<span><span class="co">#&gt; Aug 2005 16.19780  9.683763</span></span>
<span><span class="co">#&gt; Sep 2005 17.92553 10.635567</span></span>
<span><span class="co">#&gt; Oct 2005 16.93634 10.184399</span></span>
<span><span class="co">#&gt; Nov 2005 16.00641  9.695078</span></span>
<span><span class="co">#&gt; Dec 2005 17.84675 10.468521</span></span>
<span><span class="co">#&gt; Jan 2006 19.26203 11.060313</span></span>
<span><span class="co">#&gt; Feb 2006 18.97434 11.017205</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.821697  9.029186</span></span>
<span><span class="co">#&gt; Jun 2005 14.056909  9.327980</span></span>
<span><span class="co">#&gt; Jul 2005 11.672300  7.838662</span></span>
<span><span class="co">#&gt; Aug 2005 11.002723  7.127978</span></span>
<span><span class="co">#&gt; Sep 2005 10.440500  6.637999</span></span>
<span><span class="co">#&gt; Oct 2005 10.139578  5.926888</span></span>
<span><span class="co">#&gt; Nov 2005 12.742903  8.063003</span></span>
<span><span class="co">#&gt; Dec 2005 10.493118  5.960465</span></span>
<span><span class="co">#&gt; Jan 2006  8.838411  5.218807</span></span>
<span><span class="co">#&gt; Feb 2006  9.715651  5.613216</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.839342  9.996993</span></span>
<span><span class="co">#&gt; Jun 2005 10.227152  6.666565</span></span>
<span><span class="co">#&gt; Jul 2005  9.523353  6.249106</span></span>
<span><span class="co">#&gt; Aug 2005 13.325425  8.510116</span></span>
<span><span class="co">#&gt; Sep 2005 14.617139  8.974613</span></span>
<span><span class="co">#&gt; Oct 2005 14.497146  8.323407</span></span>
<span><span class="co">#&gt; Nov 2005 15.226588  8.461809</span></span>
<span><span class="co">#&gt; Dec 2005 15.719868  8.832498</span></span>
<span><span class="co">#&gt; Jan 2006 16.167231  9.053348</span></span>
<span><span class="co">#&gt; Feb 2006 17.175184  9.590618</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.839342  9.996993</span></span>
<span><span class="co">#&gt; Jun 2005 10.227152  6.666565</span></span>
<span><span class="co">#&gt; Jul 2005  9.523353  6.249106</span></span>
<span><span class="co">#&gt; Aug 2005 13.325425  8.510116</span></span>
<span><span class="co">#&gt; Sep 2005 14.617139  8.974613</span></span>
<span><span class="co">#&gt; Oct 2005 12.552850  7.192006</span></span>
<span><span class="co">#&gt; Nov 2005 14.544833  8.279996</span></span>
<span><span class="co">#&gt; Dec 2005 15.512434  8.568870</span></span>
<span><span class="co">#&gt; Jan 2006 15.973465  8.918242</span></span>
<span><span class="co">#&gt; Feb 2006 16.412204  9.137981</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.31012  7.986987</span></span>
<span><span class="co">#&gt; Jun 2005 11.12105  7.048400</span></span>
<span><span class="co">#&gt; Jul 2005 11.58477  7.633757</span></span>
<span><span class="co">#&gt; Aug 2005 12.41415  7.559196</span></span>
<span><span class="co">#&gt; Sep 2005 13.78233  8.484448</span></span>
<span><span class="co">#&gt; Oct 2005 12.86086  8.021984</span></span>
<span><span class="co">#&gt; Nov 2005 13.50132  8.614131</span></span>
<span><span class="co">#&gt; Dec 2005 12.06493  6.940466</span></span>
<span><span class="co">#&gt; Jan 2006 15.68333  9.375074</span></span>
<span><span class="co">#&gt; Feb 2006 18.43338 10.965635</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.65530 10.053746</span></span>
<span><span class="co">#&gt; Jun 2005 14.78234  8.897450</span></span>
<span><span class="co">#&gt; Jul 2005 13.40617  8.244089</span></span>
<span><span class="co">#&gt; Aug 2005 12.64682  7.856044</span></span>
<span><span class="co">#&gt; Sep 2005 13.40930  8.516663</span></span>
<span><span class="co">#&gt; Oct 2005 12.83241  8.007058</span></span>
<span><span class="co">#&gt; Nov 2005 12.67232  7.538984</span></span>
<span><span class="co">#&gt; Dec 2005 11.66805  6.979031</span></span>
<span><span class="co">#&gt; Jan 2006 12.68873  8.534415</span></span>
<span><span class="co">#&gt; Feb 2006 13.22977  8.992992</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.563714  8.362382</span></span>
<span><span class="co">#&gt; Jun 2005 16.019922  9.488437</span></span>
<span><span class="co">#&gt; Jul 2005 16.113742 10.729587</span></span>
<span><span class="co">#&gt; Aug 2005 10.650913  6.794771</span></span>
<span><span class="co">#&gt; Sep 2005  9.964139  6.447577</span></span>
<span><span class="co">#&gt; Oct 2005 11.795330  7.169839</span></span>
<span><span class="co">#&gt; Nov 2005 13.387732  8.256380</span></span>
<span><span class="co">#&gt; Dec 2005 13.945968  9.772171</span></span>
<span><span class="co">#&gt; Jan 2006  9.161987  6.283013</span></span>
<span><span class="co">#&gt; Feb 2006  8.436301  5.724535</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.563714  8.362382</span></span>
<span><span class="co">#&gt; Jun 2005 16.019922  9.488437</span></span>
<span><span class="co">#&gt; Jul 2005 16.113742 10.729587</span></span>
<span><span class="co">#&gt; Aug 2005 10.650913  6.794771</span></span>
<span><span class="co">#&gt; Sep 2005  9.964139  6.447577</span></span>
<span><span class="co">#&gt; Oct 2005  9.409405  5.975199</span></span>
<span><span class="co">#&gt; Nov 2005 10.592695  7.459345</span></span>
<span><span class="co">#&gt; Dec 2005 12.211741  8.362547</span></span>
<span><span class="co">#&gt; Jan 2006 10.861962  7.515780</span></span>
<span><span class="co">#&gt; Feb 2006 10.248027  6.741041</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.05677  8.297685</span></span>
<span><span class="co">#&gt; Jun 2005 13.38615  8.119346</span></span>
<span><span class="co">#&gt; Jul 2005 11.10916  7.106661</span></span>
<span><span class="co">#&gt; Aug 2005 11.50855  7.619346</span></span>
<span><span class="co">#&gt; Sep 2005 12.32402  7.523734</span></span>
<span><span class="co">#&gt; Oct 2005 16.68027 10.199735</span></span>
<span><span class="co">#&gt; Nov 2005 16.23282 10.008901</span></span>
<span><span class="co">#&gt; Dec 2005 13.34659  8.330605</span></span>
<span><span class="co">#&gt; Jan 2006 14.36083  9.292665</span></span>
<span><span class="co">#&gt; Feb 2006 11.80148  7.074772</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.50589  8.075643</span></span>
<span><span class="co">#&gt; Jun 2005 14.35185  8.923129</span></span>
<span><span class="co">#&gt; Jul 2005 12.98301  7.330501</span></span>
<span><span class="co">#&gt; Aug 2005 16.56059  9.820074</span></span>
<span><span class="co">#&gt; Sep 2005 18.88604 11.117779</span></span>
<span><span class="co">#&gt; Oct 2005 17.01069 10.131579</span></span>
<span><span class="co">#&gt; Nov 2005 14.81419  7.987934</span></span>
<span><span class="co">#&gt; Dec 2005 18.46423 10.670687</span></span>
<span><span class="co">#&gt; Jan 2006 20.16051 11.549576</span></span>
<span><span class="co">#&gt; Feb 2006 19.13139 11.032177</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.43567  9.659987</span></span>
<span><span class="co">#&gt; Jun 2005 12.81559  7.426820</span></span>
<span><span class="co">#&gt; Jul 2005 12.50642  7.003901</span></span>
<span><span class="co">#&gt; Aug 2005 14.94819  9.214246</span></span>
<span><span class="co">#&gt; Sep 2005 11.51298  6.344605</span></span>
<span><span class="co">#&gt; Oct 2005 12.82138  7.751508</span></span>
<span><span class="co">#&gt; Nov 2005 13.06747  7.850398</span></span>
<span><span class="co">#&gt; Dec 2005 12.56634  7.666340</span></span>
<span><span class="co">#&gt; Jan 2006 10.48819  6.713424</span></span>
<span><span class="co">#&gt; Feb 2006 11.03958  7.329363</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 14.080025  8.217172</span></span>
<span><span class="co">#&gt; Feb 2002 14.097935  8.504100</span></span>
<span><span class="co">#&gt; Mar 2002 14.037980  8.254621</span></span>
<span><span class="co">#&gt; Apr 2002 14.080025  8.217172</span></span>
<span><span class="co">#&gt; May 2002 14.097935  8.504100</span></span>
<span><span class="co">#&gt; Jun 2002 13.400229  7.842877</span></span>
<span><span class="co">#&gt; Jul 2002 11.963099  7.227708</span></span>
<span><span class="co">#&gt; Aug 2002 12.483082  7.479137</span></span>
<span><span class="co">#&gt; Sep 2002 14.051200  8.267892</span></span>
<span><span class="co">#&gt; Oct 2002 15.653409  9.046206</span></span>
<span><span class="co">#&gt; Nov 2002 15.895374  9.120444</span></span>
<span><span class="co">#&gt; Dec 2002 16.246375  9.254438</span></span>
<span><span class="co">#&gt; Jan 2003 16.880238  9.544966</span></span>
<span><span class="co">#&gt; Feb 2003 17.003473  9.571713</span></span>
<span><span class="co">#&gt; Mar 2003 17.231948  9.639966</span></span>
<span><span class="co">#&gt; Apr 2003 16.195870  9.248908</span></span>
<span><span class="co">#&gt; May 2003 14.058413  8.543376</span></span>
<span><span class="co">#&gt; Jun 2003 13.651791  8.393671</span></span>
<span><span class="co">#&gt; Jul 2003 12.716624  8.056579</span></span>
<span><span class="co">#&gt; Aug 2003 12.646146  7.882686</span></span>
<span><span class="co">#&gt; Sep 2003 12.337320  7.628455</span></span>
<span><span class="co">#&gt; Oct 2003 10.858041  6.918282</span></span>
<span><span class="co">#&gt; Nov 2003 10.947373  7.048306</span></span>
<span><span class="co">#&gt; Dec 2003 12.300163  7.539882</span></span>
<span><span class="co">#&gt; Jan 2004 12.920135  8.002056</span></span>
<span><span class="co">#&gt; Feb 2004 10.524137  7.198956</span></span>
<span><span class="co">#&gt; Mar 2004 10.198641  6.670517</span></span>
<span><span class="co">#&gt; Apr 2004  9.921236  6.478631</span></span>
<span><span class="co">#&gt; May 2004 12.093310  7.711550</span></span>
<span><span class="co">#&gt; Jun 2004 13.435713  8.168927</span></span>
<span><span class="co">#&gt; Jul 2004 14.330379  8.636496</span></span>
<span><span class="co">#&gt; Aug 2004 13.676214  8.257946</span></span>
<span><span class="co">#&gt; Sep 2004 12.711040  7.946941</span></span>
<span><span class="co">#&gt; Oct 2004 12.438696  7.709987</span></span>
<span><span class="co">#&gt; Nov 2004 12.493577  7.932898</span></span>
<span><span class="co">#&gt; Dec 2004 13.094054  7.775530</span></span>
<span><span class="co">#&gt; Jan 2005 14.800106  8.733646</span></span>
<span><span class="co">#&gt; Feb 2005 16.091897  9.445771</span></span>
<span><span class="co">#&gt; Mar 2005 15.560027  9.180879</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;                Quotes   TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.307114839  1.22639837</span></span>
<span><span class="co">#&gt; Feb 2002 -0.868364597 -0.96984988</span></span>
<span><span class="co">#&gt; Mar 2002 -1.067329559 -1.04189553</span></span>
<span><span class="co">#&gt; Apr 2002  1.307114839  1.22639837</span></span>
<span><span class="co">#&gt; May 2002 -2.375054597 -2.08888488</span></span>
<span><span class="co">#&gt; Jun 2002 -3.338459123 -2.03588722</span></span>
<span><span class="co">#&gt; Jul 2002 -1.140308873 -1.02410785</span></span>
<span><span class="co">#&gt; Aug 2002  0.803987736  0.10729330</span></span>
<span><span class="co">#&gt; Sep 2002  0.527119680 -0.26295692</span></span>
<span><span class="co">#&gt; Oct 2002 -0.047988643 -0.21122600</span></span>
<span><span class="co">#&gt; Nov 2002  0.039776086 -0.16318896</span></span>
<span><span class="co">#&gt; Dec 2002  0.748484692  0.27855217</span></span>
<span><span class="co">#&gt; Jan 2003 -0.002027973 -0.15201590</span></span>
<span><span class="co">#&gt; Feb 2003 -0.552192724 -0.65315272</span></span>
<span><span class="co">#&gt; Mar 2003 -1.950768084 -1.26584601</span></span>
<span><span class="co">#&gt; Apr 2003 -0.306860047  0.59559733</span></span>
<span><span class="co">#&gt; May 2003  1.619056967  1.30601353</span></span>
<span><span class="co">#&gt; Jun 2003 -0.363991107  0.00905855</span></span>
<span><span class="co">#&gt; Jul 2003 -0.071784477 -0.13590381</span></span>
<span><span class="co">#&gt; Aug 2003 -0.818435582 -0.44660102</span></span>
<span><span class="co">#&gt; Sep 2003 -2.645480110 -1.28796505</span></span>
<span><span class="co">#&gt; Oct 2003 -0.553891055  0.02171253</span></span>
<span><span class="co">#&gt; Nov 2003  0.435156765 -0.07120594</span></span>
<span><span class="co">#&gt; Dec 2003  0.651326753  0.47031930</span></span>
<span><span class="co">#&gt; Jan 2004  0.710784799  1.56340435</span></span>
<span><span class="co">#&gt; Feb 2004 -1.403156976 -0.92644608</span></span>
<span><span class="co">#&gt; Mar 2004 -1.803961042 -0.96302233</span></span>
<span><span class="co">#&gt; Apr 2004  2.379523900  1.48490908</span></span>
<span><span class="co">#&gt; May 2004  1.755000239  0.78267104</span></span>
<span><span class="co">#&gt; Jun 2004  2.526746719  1.62015783</span></span>
<span><span class="co">#&gt; Jul 2004 -0.132999437  0.05632932</span></span>
<span><span class="co">#&gt; Aug 2004 -0.816993774 -0.20071589</span></span>
<span><span class="co">#&gt; Sep 2004 -0.622669658 -0.35794574</span></span>
<span><span class="co">#&gt; Oct 2004  0.495054063  0.53489384</span></span>
<span><span class="co">#&gt; Nov 2004 -0.771226686 -1.25735840</span></span>
<span><span class="co">#&gt; Dec 2004  2.377205824  1.44407360</span></span>
<span><span class="co">#&gt; Jan 2005  3.638874496  2.23015367</span></span>
<span><span class="co">#&gt; Feb 2005  1.399962612  1.01051877</span></span>
<span><span class="co">#&gt; Mar 2005 -1.068346882 -0.45227882</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 1.557655</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 2.232715e-17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;       Quotes    TV.advert xreg_cluster </span></span>
<span><span class="co">#&gt;    3.0295614    1.4590629    0.1843407 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res12</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes           TV.advert      </span></span>
<span><span class="co">#&gt;  Min.   :-3.33846   Min.   :-2.0889  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.84340   1st Qu.:-0.7898  </span></span>
<span><span class="co">#&gt;  Median :-0.07178   Median :-0.1359  </span></span>
<span><span class="co">#&gt;  Mean   : 0.00000   Mean   : 0.0000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.77624   3rd Qu.: 0.6891  </span></span>
<span><span class="co">#&gt;  Max.   : 3.63887   Max.   : 2.2302</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res12</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.0461306 0.2610091</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res12</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9864921 0.5720541</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res12</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-kmeans-1.png" width="691.2"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res12</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-kmeans-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="using-the-median-instead-of-the-mean-in-bootstrap-aggregation">3 - 5 Using the median instead of the mean in bootstrap
aggregation<a class="anchor" aria-label="anchor" href="#using-the-median-instead-of-the-mean-in-bootstrap-aggregation"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res13</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                         centers <span class="op">=</span> <span class="va">centers</span>, </span>
<span>                         type_pi <span class="op">=</span> <span class="st">"blockbootstrap"</span>, </span>
<span>                         type_aggregation <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>                         block_length <span class="op">=</span> <span class="va">block_length</span>,</span>
<span>                         B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.56371  8.695784</span></span>
<span><span class="co">#&gt; Jun 2005 13.72153  8.508398</span></span>
<span><span class="co">#&gt; Jul 2005 12.08936  7.482129</span></span>
<span><span class="co">#&gt; Aug 2005 12.53049  7.737695</span></span>
<span><span class="co">#&gt; Sep 2005 12.86666  8.004091</span></span>
<span><span class="co">#&gt; Oct 2005 12.82690  7.879283</span></span>
<span><span class="co">#&gt; Nov 2005 13.44453  8.159692</span></span>
<span><span class="co">#&gt; Dec 2005 12.95646  8.346576</span></span>
<span><span class="co">#&gt; Jan 2006 13.52478  8.726329</span></span>
<span><span class="co">#&gt; Feb 2006 12.51562  8.161178</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.354169  8.006935</span></span>
<span><span class="co">#&gt; Jun 2005 10.227152  6.666565</span></span>
<span><span class="co">#&gt; Jul 2005  9.523353  6.249106</span></span>
<span><span class="co">#&gt; Aug 2005 10.650913  6.794771</span></span>
<span><span class="co">#&gt; Sep 2005  9.964139  6.367774</span></span>
<span><span class="co">#&gt; Oct 2005  9.573694  5.937758</span></span>
<span><span class="co">#&gt; Nov 2005 11.060611  7.477264</span></span>
<span><span class="co">#&gt; Dec 2005 10.757477  6.180966</span></span>
<span><span class="co">#&gt; Jan 2006  8.911216  5.458253</span></span>
<span><span class="co">#&gt; Feb 2006  8.724155  5.638263</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.38089 10.040977</span></span>
<span><span class="co">#&gt; Jun 2005 16.01992  9.488437</span></span>
<span><span class="co">#&gt; Jul 2005 16.11374 10.729587</span></span>
<span><span class="co">#&gt; Aug 2005 16.19780  9.683763</span></span>
<span><span class="co">#&gt; Sep 2005 17.92553 10.635567</span></span>
<span><span class="co">#&gt; Oct 2005 16.93634 10.184399</span></span>
<span><span class="co">#&gt; Nov 2005 16.00641  9.695078</span></span>
<span><span class="co">#&gt; Dec 2005 17.84675 10.468521</span></span>
<span><span class="co">#&gt; Jan 2006 19.26203 11.060313</span></span>
<span><span class="co">#&gt; Feb 2006 18.97434 11.017205</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.821697  9.029186</span></span>
<span><span class="co">#&gt; Jun 2005 14.056909  9.327980</span></span>
<span><span class="co">#&gt; Jul 2005 11.672300  7.838662</span></span>
<span><span class="co">#&gt; Aug 2005 11.002723  7.127978</span></span>
<span><span class="co">#&gt; Sep 2005 10.440500  6.637999</span></span>
<span><span class="co">#&gt; Oct 2005 10.139578  5.926888</span></span>
<span><span class="co">#&gt; Nov 2005 12.742903  8.063003</span></span>
<span><span class="co">#&gt; Dec 2005 10.493118  5.960465</span></span>
<span><span class="co">#&gt; Jan 2006  8.838411  5.218807</span></span>
<span><span class="co">#&gt; Feb 2006  9.715651  5.613216</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.839342  9.996993</span></span>
<span><span class="co">#&gt; Jun 2005 10.227152  6.666565</span></span>
<span><span class="co">#&gt; Jul 2005  9.523353  6.249106</span></span>
<span><span class="co">#&gt; Aug 2005 13.325425  8.510116</span></span>
<span><span class="co">#&gt; Sep 2005 14.617139  8.974613</span></span>
<span><span class="co">#&gt; Oct 2005 14.497146  8.323407</span></span>
<span><span class="co">#&gt; Nov 2005 15.226588  8.461809</span></span>
<span><span class="co">#&gt; Dec 2005 15.719868  8.832498</span></span>
<span><span class="co">#&gt; Jan 2006 16.167231  9.053348</span></span>
<span><span class="co">#&gt; Feb 2006 17.175184  9.590618</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.839342  9.996993</span></span>
<span><span class="co">#&gt; Jun 2005 10.227152  6.666565</span></span>
<span><span class="co">#&gt; Jul 2005  9.523353  6.249106</span></span>
<span><span class="co">#&gt; Aug 2005 13.325425  8.510116</span></span>
<span><span class="co">#&gt; Sep 2005 14.617139  8.974613</span></span>
<span><span class="co">#&gt; Oct 2005 12.552850  7.192006</span></span>
<span><span class="co">#&gt; Nov 2005 14.544833  8.279996</span></span>
<span><span class="co">#&gt; Dec 2005 15.512434  8.568870</span></span>
<span><span class="co">#&gt; Jan 2006 15.973465  8.918242</span></span>
<span><span class="co">#&gt; Feb 2006 16.412204  9.137981</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.31012  7.986987</span></span>
<span><span class="co">#&gt; Jun 2005 11.12105  7.048400</span></span>
<span><span class="co">#&gt; Jul 2005 11.58477  7.633757</span></span>
<span><span class="co">#&gt; Aug 2005 12.41415  7.559196</span></span>
<span><span class="co">#&gt; Sep 2005 13.78233  8.484448</span></span>
<span><span class="co">#&gt; Oct 2005 12.86086  8.021984</span></span>
<span><span class="co">#&gt; Nov 2005 13.50132  8.614131</span></span>
<span><span class="co">#&gt; Dec 2005 12.06493  6.940466</span></span>
<span><span class="co">#&gt; Jan 2006 15.68333  9.375074</span></span>
<span><span class="co">#&gt; Feb 2006 18.43338 10.965635</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.65530 10.053746</span></span>
<span><span class="co">#&gt; Jun 2005 14.78234  8.897450</span></span>
<span><span class="co">#&gt; Jul 2005 13.40617  8.244089</span></span>
<span><span class="co">#&gt; Aug 2005 12.64682  7.856044</span></span>
<span><span class="co">#&gt; Sep 2005 13.40930  8.516663</span></span>
<span><span class="co">#&gt; Oct 2005 12.83241  8.007058</span></span>
<span><span class="co">#&gt; Nov 2005 12.67232  7.538984</span></span>
<span><span class="co">#&gt; Dec 2005 11.66805  6.979031</span></span>
<span><span class="co">#&gt; Jan 2006 12.68873  8.534415</span></span>
<span><span class="co">#&gt; Feb 2006 13.22977  8.992992</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.563714  8.362382</span></span>
<span><span class="co">#&gt; Jun 2005 16.019922  9.488437</span></span>
<span><span class="co">#&gt; Jul 2005 16.113742 10.729587</span></span>
<span><span class="co">#&gt; Aug 2005 10.650913  6.794771</span></span>
<span><span class="co">#&gt; Sep 2005  9.964139  6.447577</span></span>
<span><span class="co">#&gt; Oct 2005 11.795330  7.169839</span></span>
<span><span class="co">#&gt; Nov 2005 13.387732  8.256380</span></span>
<span><span class="co">#&gt; Dec 2005 13.945968  9.772171</span></span>
<span><span class="co">#&gt; Jan 2006  9.161987  6.283013</span></span>
<span><span class="co">#&gt; Feb 2006  8.436301  5.724535</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.563714  8.362382</span></span>
<span><span class="co">#&gt; Jun 2005 16.019922  9.488437</span></span>
<span><span class="co">#&gt; Jul 2005 16.113742 10.729587</span></span>
<span><span class="co">#&gt; Aug 2005 10.650913  6.794771</span></span>
<span><span class="co">#&gt; Sep 2005  9.964139  6.447577</span></span>
<span><span class="co">#&gt; Oct 2005  9.409405  5.975199</span></span>
<span><span class="co">#&gt; Nov 2005 10.592695  7.459345</span></span>
<span><span class="co">#&gt; Dec 2005 12.211741  8.362547</span></span>
<span><span class="co">#&gt; Jan 2006 10.861962  7.515780</span></span>
<span><span class="co">#&gt; Feb 2006 10.248027  6.741041</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.05677  8.297685</span></span>
<span><span class="co">#&gt; Jun 2005 13.38615  8.119346</span></span>
<span><span class="co">#&gt; Jul 2005 11.10916  7.106661</span></span>
<span><span class="co">#&gt; Aug 2005 11.50855  7.619346</span></span>
<span><span class="co">#&gt; Sep 2005 12.32402  7.523734</span></span>
<span><span class="co">#&gt; Oct 2005 16.68027 10.199735</span></span>
<span><span class="co">#&gt; Nov 2005 16.23282 10.008901</span></span>
<span><span class="co">#&gt; Dec 2005 13.34659  8.330605</span></span>
<span><span class="co">#&gt; Jan 2006 14.36083  9.292665</span></span>
<span><span class="co">#&gt; Feb 2006 11.80148  7.074772</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.50589  8.075643</span></span>
<span><span class="co">#&gt; Jun 2005 14.35185  8.923129</span></span>
<span><span class="co">#&gt; Jul 2005 12.98301  7.330501</span></span>
<span><span class="co">#&gt; Aug 2005 16.56059  9.820074</span></span>
<span><span class="co">#&gt; Sep 2005 18.88604 11.117779</span></span>
<span><span class="co">#&gt; Oct 2005 17.01069 10.131579</span></span>
<span><span class="co">#&gt; Nov 2005 14.81419  7.987934</span></span>
<span><span class="co">#&gt; Dec 2005 18.46423 10.670687</span></span>
<span><span class="co">#&gt; Jan 2006 20.16051 11.549576</span></span>
<span><span class="co">#&gt; Feb 2006 19.13139 11.032177</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.43567  9.659987</span></span>
<span><span class="co">#&gt; Jun 2005 12.81559  7.426820</span></span>
<span><span class="co">#&gt; Jul 2005 12.50642  7.003901</span></span>
<span><span class="co">#&gt; Aug 2005 14.94819  9.214246</span></span>
<span><span class="co">#&gt; Sep 2005 11.51298  6.344605</span></span>
<span><span class="co">#&gt; Oct 2005 12.82138  7.751508</span></span>
<span><span class="co">#&gt; Nov 2005 13.06747  7.850398</span></span>
<span><span class="co">#&gt; Dec 2005 12.56634  7.666340</span></span>
<span><span class="co">#&gt; Jan 2006 10.48819  6.713424</span></span>
<span><span class="co">#&gt; Feb 2006 11.03958  7.329363</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 14.080025  8.217172</span></span>
<span><span class="co">#&gt; Feb 2002 14.097935  8.504100</span></span>
<span><span class="co">#&gt; Mar 2002 14.037980  8.254621</span></span>
<span><span class="co">#&gt; Apr 2002 14.080025  8.217172</span></span>
<span><span class="co">#&gt; May 2002 14.097935  8.504100</span></span>
<span><span class="co">#&gt; Jun 2002 13.400229  7.842877</span></span>
<span><span class="co">#&gt; Jul 2002 11.963099  7.227708</span></span>
<span><span class="co">#&gt; Aug 2002 12.483082  7.479137</span></span>
<span><span class="co">#&gt; Sep 2002 14.051200  8.267892</span></span>
<span><span class="co">#&gt; Oct 2002 15.653409  9.046206</span></span>
<span><span class="co">#&gt; Nov 2002 15.895374  9.120444</span></span>
<span><span class="co">#&gt; Dec 2002 16.246375  9.254438</span></span>
<span><span class="co">#&gt; Jan 2003 16.880238  9.544966</span></span>
<span><span class="co">#&gt; Feb 2003 17.003473  9.571713</span></span>
<span><span class="co">#&gt; Mar 2003 17.231948  9.639966</span></span>
<span><span class="co">#&gt; Apr 2003 16.195870  9.248908</span></span>
<span><span class="co">#&gt; May 2003 14.058413  8.543376</span></span>
<span><span class="co">#&gt; Jun 2003 13.651791  8.393671</span></span>
<span><span class="co">#&gt; Jul 2003 12.716624  8.056579</span></span>
<span><span class="co">#&gt; Aug 2003 12.646146  7.882686</span></span>
<span><span class="co">#&gt; Sep 2003 12.337320  7.628455</span></span>
<span><span class="co">#&gt; Oct 2003 10.858041  6.918282</span></span>
<span><span class="co">#&gt; Nov 2003 10.947373  7.048306</span></span>
<span><span class="co">#&gt; Dec 2003 12.300163  7.539882</span></span>
<span><span class="co">#&gt; Jan 2004 12.920135  8.002056</span></span>
<span><span class="co">#&gt; Feb 2004 10.524137  7.198956</span></span>
<span><span class="co">#&gt; Mar 2004 10.198641  6.670517</span></span>
<span><span class="co">#&gt; Apr 2004  9.921236  6.478631</span></span>
<span><span class="co">#&gt; May 2004 12.093310  7.711550</span></span>
<span><span class="co">#&gt; Jun 2004 13.435713  8.168927</span></span>
<span><span class="co">#&gt; Jul 2004 14.330379  8.636496</span></span>
<span><span class="co">#&gt; Aug 2004 13.676214  8.257946</span></span>
<span><span class="co">#&gt; Sep 2004 12.711040  7.946941</span></span>
<span><span class="co">#&gt; Oct 2004 12.438696  7.709987</span></span>
<span><span class="co">#&gt; Nov 2004 12.493577  7.932898</span></span>
<span><span class="co">#&gt; Dec 2004 13.094054  7.775530</span></span>
<span><span class="co">#&gt; Jan 2005 14.800106  8.733646</span></span>
<span><span class="co">#&gt; Feb 2005 16.091897  9.445771</span></span>
<span><span class="co">#&gt; Mar 2005 15.560027  9.180879</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;                Quotes   TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.307114839  1.22639837</span></span>
<span><span class="co">#&gt; Feb 2002 -0.868364597 -0.96984988</span></span>
<span><span class="co">#&gt; Mar 2002 -1.067329559 -1.04189553</span></span>
<span><span class="co">#&gt; Apr 2002  1.307114839  1.22639837</span></span>
<span><span class="co">#&gt; May 2002 -2.375054597 -2.08888488</span></span>
<span><span class="co">#&gt; Jun 2002 -3.338459123 -2.03588722</span></span>
<span><span class="co">#&gt; Jul 2002 -1.140308873 -1.02410785</span></span>
<span><span class="co">#&gt; Aug 2002  0.803987736  0.10729330</span></span>
<span><span class="co">#&gt; Sep 2002  0.527119680 -0.26295692</span></span>
<span><span class="co">#&gt; Oct 2002 -0.047988643 -0.21122600</span></span>
<span><span class="co">#&gt; Nov 2002  0.039776086 -0.16318896</span></span>
<span><span class="co">#&gt; Dec 2002  0.748484692  0.27855217</span></span>
<span><span class="co">#&gt; Jan 2003 -0.002027973 -0.15201590</span></span>
<span><span class="co">#&gt; Feb 2003 -0.552192724 -0.65315272</span></span>
<span><span class="co">#&gt; Mar 2003 -1.950768084 -1.26584601</span></span>
<span><span class="co">#&gt; Apr 2003 -0.306860047  0.59559733</span></span>
<span><span class="co">#&gt; May 2003  1.619056967  1.30601353</span></span>
<span><span class="co">#&gt; Jun 2003 -0.363991107  0.00905855</span></span>
<span><span class="co">#&gt; Jul 2003 -0.071784477 -0.13590381</span></span>
<span><span class="co">#&gt; Aug 2003 -0.818435582 -0.44660102</span></span>
<span><span class="co">#&gt; Sep 2003 -2.645480110 -1.28796505</span></span>
<span><span class="co">#&gt; Oct 2003 -0.553891055  0.02171253</span></span>
<span><span class="co">#&gt; Nov 2003  0.435156765 -0.07120594</span></span>
<span><span class="co">#&gt; Dec 2003  0.651326753  0.47031930</span></span>
<span><span class="co">#&gt; Jan 2004  0.710784799  1.56340435</span></span>
<span><span class="co">#&gt; Feb 2004 -1.403156976 -0.92644608</span></span>
<span><span class="co">#&gt; Mar 2004 -1.803961042 -0.96302233</span></span>
<span><span class="co">#&gt; Apr 2004  2.379523900  1.48490908</span></span>
<span><span class="co">#&gt; May 2004  1.755000239  0.78267104</span></span>
<span><span class="co">#&gt; Jun 2004  2.526746719  1.62015783</span></span>
<span><span class="co">#&gt; Jul 2004 -0.132999437  0.05632932</span></span>
<span><span class="co">#&gt; Aug 2004 -0.816993774 -0.20071589</span></span>
<span><span class="co">#&gt; Sep 2004 -0.622669658 -0.35794574</span></span>
<span><span class="co">#&gt; Oct 2004  0.495054063  0.53489384</span></span>
<span><span class="co">#&gt; Nov 2004 -0.771226686 -1.25735840</span></span>
<span><span class="co">#&gt; Dec 2004  2.377205824  1.44407360</span></span>
<span><span class="co">#&gt; Jan 2005  3.638874496  2.23015367</span></span>
<span><span class="co">#&gt; Feb 2005  1.399962612  1.01051877</span></span>
<span><span class="co">#&gt; Mar 2005 -1.068346882 -0.45227882</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 1.557655</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 2.232715e-17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;       Quotes    TV.advert xreg_cluster </span></span>
<span><span class="co">#&gt;    3.0295614    1.4590629    0.1843407 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res13</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9864921 0.5720541</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res13</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes           TV.advert      </span></span>
<span><span class="co">#&gt;  Min.   :-3.33846   Min.   :-2.0889  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.84340   1st Qu.:-0.7898  </span></span>
<span><span class="co">#&gt;  Median :-0.07178   Median :-0.1359  </span></span>
<span><span class="co">#&gt;  Mean   : 0.00000   Mean   : 0.0000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.77624   3rd Qu.: 0.6891  </span></span>
<span><span class="co">#&gt;  Max.   : 3.63887   Max.   : 2.2302</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res13</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.0461306 0.2610091</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res13</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-median-kmeans-1.png" width="691.2"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res13</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-median-kmeans-2.png" width="691.2"></p>
</div>
</div>
<div class="section level2">
<h2 id="prediction-intervals-based-on-moving-block-bootstrap">4 - Prediction intervals based on moving block bootstrap<a class="anchor" aria-label="anchor" href="#prediction-intervals-based-on-moving-block-bootstrap"></a>
</h2>
<div class="section level3">
<h3 id="with-default-parameters-3">4 - 1 With default parameters<a class="anchor" aria-label="anchor" href="#with-default-parameters-3"></a>
</h3>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">block_length</span> <span class="op">&lt;-</span> <span class="fl">5L</span></span>
<span><span class="op">(</span><span class="va">res16</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                        type_pi <span class="op">=</span> <span class="st">"movingblockbootstrap"</span>, </span>
<span>                        block_length <span class="op">=</span> <span class="va">block_length</span>,</span>
<span>                        B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.95424  8.917110</span></span>
<span><span class="co">#&gt; Jun 2005 15.06970  8.993896</span></span>
<span><span class="co">#&gt; Jul 2005 14.90589  8.905918</span></span>
<span><span class="co">#&gt; Aug 2005 14.25561  8.465204</span></span>
<span><span class="co">#&gt; Sep 2005 14.36862  8.515677</span></span>
<span><span class="co">#&gt; Oct 2005 13.81543  8.178355</span></span>
<span><span class="co">#&gt; Nov 2005 13.10715  7.889358</span></span>
<span><span class="co">#&gt; Dec 2005 13.34434  8.031641</span></span>
<span><span class="co">#&gt; Jan 2006 13.95208  8.361007</span></span>
<span><span class="co">#&gt; Feb 2006 14.31399  8.419853</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 12.084705  7.338993</span></span>
<span><span class="co">#&gt; Jun 2005 12.163965  7.321763</span></span>
<span><span class="co">#&gt; Jul 2005 10.414064  6.835108</span></span>
<span><span class="co">#&gt; Aug 2005  9.643880  6.345469</span></span>
<span><span class="co">#&gt; Sep 2005 10.732927  6.987392</span></span>
<span><span class="co">#&gt; Oct 2005  9.575235  6.024506</span></span>
<span><span class="co">#&gt; Nov 2005  7.941691  5.525525</span></span>
<span><span class="co">#&gt; Dec 2005  7.724104  5.197418</span></span>
<span><span class="co">#&gt; Jan 2006 11.224315  6.593768</span></span>
<span><span class="co">#&gt; Feb 2006 11.875286  6.734046</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.25320 10.490874</span></span>
<span><span class="co">#&gt; Jun 2005 17.12849 10.070346</span></span>
<span><span class="co">#&gt; Jul 2005 18.57187 10.842775</span></span>
<span><span class="co">#&gt; Aug 2005 17.07368  9.921982</span></span>
<span><span class="co">#&gt; Sep 2005 16.90692  9.425962</span></span>
<span><span class="co">#&gt; Oct 2005 17.73942 10.288472</span></span>
<span><span class="co">#&gt; Nov 2005 16.99782  9.979098</span></span>
<span><span class="co">#&gt; Dec 2005 17.85605 10.725460</span></span>
<span><span class="co">#&gt; Jan 2006 17.06614 10.187037</span></span>
<span><span class="co">#&gt; Feb 2006 17.62241 10.423499</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.09470  8.546350</span></span>
<span><span class="co">#&gt; Jun 2005 16.08327  9.235840</span></span>
<span><span class="co">#&gt; Jul 2005 16.13305  9.130626</span></span>
<span><span class="co">#&gt; Aug 2005 17.07368  9.608318</span></span>
<span><span class="co">#&gt; Sep 2005 16.90692  9.425962</span></span>
<span><span class="co">#&gt; Oct 2005 16.29015  9.308269</span></span>
<span><span class="co">#&gt; Nov 2005 14.94118  8.768067</span></span>
<span><span class="co">#&gt; Dec 2005 14.39134  8.577792</span></span>
<span><span class="co">#&gt; Jan 2006 15.21351  9.345297</span></span>
<span><span class="co">#&gt; Feb 2006 13.52463  7.488525</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.693479  8.890481</span></span>
<span><span class="co">#&gt; Jun 2005 13.487777  8.217040</span></span>
<span><span class="co">#&gt; Jul 2005 11.160285  7.102348</span></span>
<span><span class="co">#&gt; Aug 2005 11.414974  7.526636</span></span>
<span><span class="co">#&gt; Sep 2005 12.187011  7.403738</span></span>
<span><span class="co">#&gt; Oct 2005 11.034216  6.120872</span></span>
<span><span class="co">#&gt; Nov 2005  9.636303  5.642301</span></span>
<span><span class="co">#&gt; Dec 2005 10.564867  6.117515</span></span>
<span><span class="co">#&gt; Jan 2006 13.134670  7.546796</span></span>
<span><span class="co">#&gt; Feb 2006 14.491503  7.991768</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.25320 10.490874</span></span>
<span><span class="co">#&gt; Jun 2005 17.12849  9.960231</span></span>
<span><span class="co">#&gt; Jul 2005 18.57187 10.842775</span></span>
<span><span class="co">#&gt; Aug 2005 16.97110  9.921982</span></span>
<span><span class="co">#&gt; Sep 2005 15.20504  9.035494</span></span>
<span><span class="co">#&gt; Oct 2005 15.73824  9.498906</span></span>
<span><span class="co">#&gt; Nov 2005 13.76043  8.355235</span></span>
<span><span class="co">#&gt; Dec 2005 16.74295 10.268957</span></span>
<span><span class="co">#&gt; Jan 2006 16.61087  9.724574</span></span>
<span><span class="co">#&gt; Feb 2006 18.27261 10.750198</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 11.68915  7.181272</span></span>
<span><span class="co">#&gt; Jun 2005 11.80378  7.061844</span></span>
<span><span class="co">#&gt; Jul 2005 14.01943  8.221683</span></span>
<span><span class="co">#&gt; Aug 2005 15.18397  8.487453</span></span>
<span><span class="co">#&gt; Sep 2005 16.17743  9.204073</span></span>
<span><span class="co">#&gt; Oct 2005 18.16018 10.517700</span></span>
<span><span class="co">#&gt; Nov 2005 16.79192  9.782343</span></span>
<span><span class="co">#&gt; Dec 2005 15.12627  8.975603</span></span>
<span><span class="co">#&gt; Jan 2006 14.44565  8.670010</span></span>
<span><span class="co">#&gt; Feb 2006 15.08582  9.298202</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.670387  8.878271</span></span>
<span><span class="co">#&gt; Jun 2005 14.803293 10.102315</span></span>
<span><span class="co">#&gt; Jul 2005 10.197419  6.757522</span></span>
<span><span class="co">#&gt; Aug 2005  9.463849  6.259460</span></span>
<span><span class="co">#&gt; Sep 2005 13.119058  8.395221</span></span>
<span><span class="co">#&gt; Oct 2005  9.197635  5.996528</span></span>
<span><span class="co">#&gt; Nov 2005  9.544667  5.887399</span></span>
<span><span class="co">#&gt; Dec 2005 12.563623  7.490782</span></span>
<span><span class="co">#&gt; Jan 2006 14.192807  8.026854</span></span>
<span><span class="co">#&gt; Feb 2006 15.382826  8.904826</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.09470  8.546350</span></span>
<span><span class="co">#&gt; Jun 2005 16.08327  9.235840</span></span>
<span><span class="co">#&gt; Jul 2005 16.13305  9.130626</span></span>
<span><span class="co">#&gt; Aug 2005 17.07368  9.608318</span></span>
<span><span class="co">#&gt; Sep 2005 16.90692  9.425962</span></span>
<span><span class="co">#&gt; Oct 2005 15.35431  8.207088</span></span>
<span><span class="co">#&gt; Nov 2005 17.05760 10.036221</span></span>
<span><span class="co">#&gt; Dec 2005 13.85604  7.383623</span></span>
<span><span class="co">#&gt; Jan 2006 11.39597  6.368848</span></span>
<span><span class="co">#&gt; Feb 2006 11.64467  6.515003</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.25320 10.490874</span></span>
<span><span class="co">#&gt; Jun 2005 17.12849  9.960231</span></span>
<span><span class="co">#&gt; Jul 2005 18.57187 10.842775</span></span>
<span><span class="co">#&gt; Aug 2005 16.97110  9.921982</span></span>
<span><span class="co">#&gt; Sep 2005 15.20504  9.035494</span></span>
<span><span class="co">#&gt; Oct 2005 15.36903  9.184413</span></span>
<span><span class="co">#&gt; Nov 2005 14.17257  8.528787</span></span>
<span><span class="co">#&gt; Dec 2005 11.79673  7.389492</span></span>
<span><span class="co">#&gt; Jan 2006 12.04580  7.852352</span></span>
<span><span class="co">#&gt; Feb 2006 12.66964  7.658352</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.44716  7.882252</span></span>
<span><span class="co">#&gt; Jun 2005 15.06869  8.722399</span></span>
<span><span class="co">#&gt; Jul 2005 15.79874  8.695518</span></span>
<span><span class="co">#&gt; Aug 2005 16.56357  9.279584</span></span>
<span><span class="co">#&gt; Sep 2005 16.48552  9.132644</span></span>
<span><span class="co">#&gt; Oct 2005 15.21677  8.568928</span></span>
<span><span class="co">#&gt; Nov 2005 12.74914  7.478873</span></span>
<span><span class="co">#&gt; Dec 2005 13.32305  8.324360</span></span>
<span><span class="co">#&gt; Jan 2006 14.10877  8.385544</span></span>
<span><span class="co">#&gt; Feb 2006 14.77661  8.903792</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.616890  9.121409</span></span>
<span><span class="co">#&gt; Jun 2005 13.404611  8.240180</span></span>
<span><span class="co">#&gt; Jul 2005 12.559525  7.810416</span></span>
<span><span class="co">#&gt; Aug 2005 10.263987  6.641726</span></span>
<span><span class="co">#&gt; Sep 2005 10.721712  7.161274</span></span>
<span><span class="co">#&gt; Oct 2005 10.875855  8.163611</span></span>
<span><span class="co">#&gt; Nov 2005  7.476311  5.491622</span></span>
<span><span class="co">#&gt; Dec 2005  6.899366  4.930294</span></span>
<span><span class="co">#&gt; Jan 2006 11.174478  7.368494</span></span>
<span><span class="co">#&gt; Feb 2006 13.067008  8.079515</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.72954  9.142963</span></span>
<span><span class="co">#&gt; Jun 2005 15.70532  9.203036</span></span>
<span><span class="co">#&gt; Jul 2005 15.91362 10.524887</span></span>
<span><span class="co">#&gt; Aug 2005 11.57622  7.396579</span></span>
<span><span class="co">#&gt; Sep 2005 10.77155  6.936910</span></span>
<span><span class="co">#&gt; Oct 2005 10.91791  6.217236</span></span>
<span><span class="co">#&gt; Nov 2005 14.94133  8.922739</span></span>
<span><span class="co">#&gt; Dec 2005 18.17921 10.857993</span></span>
<span><span class="co">#&gt; Jan 2006 17.19832 10.321301</span></span>
<span><span class="co">#&gt; Feb 2006 14.22454  8.608352</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 13.983454  8.113042</span></span>
<span><span class="co">#&gt; Feb 2002 14.310140  8.680078</span></span>
<span><span class="co">#&gt; Mar 2002 14.204085  8.367422</span></span>
<span><span class="co">#&gt; Apr 2002 13.983454  8.113042</span></span>
<span><span class="co">#&gt; May 2002 14.310140  8.680078</span></span>
<span><span class="co">#&gt; Jun 2002 13.136549  7.573500</span></span>
<span><span class="co">#&gt; Jul 2002 12.139564  7.269130</span></span>
<span><span class="co">#&gt; Aug 2002 12.630260  7.516240</span></span>
<span><span class="co">#&gt; Sep 2002 14.247551  8.406368</span></span>
<span><span class="co">#&gt; Oct 2002 15.085483  8.610639</span></span>
<span><span class="co">#&gt; Nov 2002 15.834616  9.129753</span></span>
<span><span class="co">#&gt; Dec 2002 16.037153  9.175375</span></span>
<span><span class="co">#&gt; Jan 2003 16.609951  9.409639</span></span>
<span><span class="co">#&gt; Feb 2003 16.579674  9.347087</span></span>
<span><span class="co">#&gt; Mar 2003 16.452555  9.136445</span></span>
<span><span class="co">#&gt; Apr 2003 15.691303  8.874788</span></span>
<span><span class="co">#&gt; May 2003 14.054876  8.529575</span></span>
<span><span class="co">#&gt; Jun 2003 13.434843  8.229103</span></span>
<span><span class="co">#&gt; Jul 2003 12.715293  7.977976</span></span>
<span><span class="co">#&gt; Aug 2003 12.998432  8.104914</span></span>
<span><span class="co">#&gt; Sep 2003 12.590713  7.879126</span></span>
<span><span class="co">#&gt; Oct 2003 10.931512  7.005044</span></span>
<span><span class="co">#&gt; Nov 2003 10.416928  6.781919</span></span>
<span><span class="co">#&gt; Dec 2003 13.045036  8.079712</span></span>
<span><span class="co">#&gt; Jan 2004 13.471769  8.342884</span></span>
<span><span class="co">#&gt; Feb 2004  8.822228  6.015318</span></span>
<span><span class="co">#&gt; Mar 2004  9.707979  6.398258</span></span>
<span><span class="co">#&gt; Apr 2004  9.811491  6.420448</span></span>
<span><span class="co">#&gt; May 2004 11.936553  7.582567</span></span>
<span><span class="co">#&gt; Jun 2004 13.921151  8.555557</span></span>
<span><span class="co">#&gt; Jul 2004 14.494976  8.746341</span></span>
<span><span class="co">#&gt; Aug 2004 14.079472  8.618854</span></span>
<span><span class="co">#&gt; Sep 2004 13.046936  8.135087</span></span>
<span><span class="co">#&gt; Oct 2004 12.726572  7.953926</span></span>
<span><span class="co">#&gt; Nov 2004 12.426974  7.834539</span></span>
<span><span class="co">#&gt; Dec 2004 13.211185  7.811190</span></span>
<span><span class="co">#&gt; Jan 2005 15.485788  9.264229</span></span>
<span><span class="co">#&gt; Feb 2005 16.598686  9.685778</span></span>
<span><span class="co">#&gt; Mar 2005 16.037908  9.448414</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;               Quotes   TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.40368643  1.33052782</span></span>
<span><span class="co">#&gt; Feb 2002 -1.08056990 -1.14582835</span></span>
<span><span class="co">#&gt; Mar 2002 -1.23343504 -1.15469695</span></span>
<span><span class="co">#&gt; Apr 2002  1.40368643  1.33052782</span></span>
<span><span class="co">#&gt; May 2002 -2.58725990 -2.26486335</span></span>
<span><span class="co">#&gt; Jun 2002 -3.07477874 -1.76651025</span></span>
<span><span class="co">#&gt; Jul 2002 -1.31677412 -1.06553020</span></span>
<span><span class="co">#&gt; Aug 2002  0.65681006  0.07019039</span></span>
<span><span class="co">#&gt; Sep 2002  0.33076863 -0.40143292</span></span>
<span><span class="co">#&gt; Oct 2002  0.51993723  0.22434076</span></span>
<span><span class="co">#&gt; Nov 2002  0.10053432 -0.17249791</span></span>
<span><span class="co">#&gt; Dec 2002  0.95770684  0.35761548</span></span>
<span><span class="co">#&gt; Jan 2003  0.26825909 -0.01668861</span></span>
<span><span class="co">#&gt; Feb 2003 -0.12839403 -0.42852687</span></span>
<span><span class="co">#&gt; Mar 2003 -1.17137522 -0.76232506</span></span>
<span><span class="co">#&gt; Apr 2003  0.19770654  0.96971721</span></span>
<span><span class="co">#&gt; May 2003  1.62259434  1.31981494</span></span>
<span><span class="co">#&gt; Jun 2003 -0.14704277  0.17362676</span></span>
<span><span class="co">#&gt; Jul 2003 -0.07045343 -0.05730098</span></span>
<span><span class="co">#&gt; Aug 2003 -1.17072203 -0.66882907</span></span>
<span><span class="co">#&gt; Sep 2003 -2.89887258 -1.53863637</span></span>
<span><span class="co">#&gt; Oct 2003 -0.62736155 -0.06504866</span></span>
<span><span class="co">#&gt; Nov 2003  0.96560231  0.19518092</span></span>
<span><span class="co">#&gt; Dec 2003 -0.09354593 -0.06951135</span></span>
<span><span class="co">#&gt; Jan 2004  0.15915097  1.22257588</span></span>
<span><span class="co">#&gt; Feb 2004  0.29875209  0.25719228</span></span>
<span><span class="co">#&gt; Mar 2004 -1.31329880 -0.69076345</span></span>
<span><span class="co">#&gt; Apr 2004  2.48926902  1.54309187</span></span>
<span><span class="co">#&gt; May 2004  1.91175656  0.91165371</span></span>
<span><span class="co">#&gt; Jun 2004  2.04130891  1.23352769</span></span>
<span><span class="co">#&gt; Jul 2004 -0.29759583 -0.05351566</span></span>
<span><span class="co">#&gt; Aug 2004 -1.22025180 -0.56162404</span></span>
<span><span class="co">#&gt; Sep 2004 -0.95856611 -0.54609232</span></span>
<span><span class="co">#&gt; Oct 2004  0.20717781  0.29095534</span></span>
<span><span class="co">#&gt; Nov 2004 -0.70462371 -1.15899926</span></span>
<span><span class="co">#&gt; Dec 2004  2.26007518  1.40841386</span></span>
<span><span class="co">#&gt; Jan 2005  2.95319223  1.69957104</span></span>
<span><span class="co">#&gt; Feb 2005  0.89317411  0.77051186</span></span>
<span><span class="co">#&gt; Mar 2005 -1.54622760 -0.71981400</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 1.924173</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 3.601775e-17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt;  2.601976  1.246370 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res16</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert       </span></span>
<span><span class="co">#&gt;  Min.   :-3.0748   Min.   :-2.26486  </span></span>
<span><span class="co">#&gt;  1st Qu.:-1.1256   1st Qu.:-0.67980  </span></span>
<span><span class="co">#&gt;  Median : 0.1005   Median :-0.05352  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.00000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.9254   3rd Qu.: 0.84108  </span></span>
<span><span class="co">#&gt;  Max.   : 2.9532   Max.   : 1.69957</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res16</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Quotes  TV.advert </span></span>
<span><span class="co">#&gt; 0.06458106 0.32251812</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res16</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.7471878 0.3924569</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res16</span>, <span class="st">"Quotes"</span>, type <span class="op">=</span> <span class="st">"sims"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/movingblockbootstrap-default-1.png" width="691.2"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res16</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/movingblockbootstrap-default-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-external-regressors-3">4 - 2 With external regressors<a class="anchor" aria-label="anchor" href="#with-external-regressors-3"></a>
</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res8</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, xreg <span class="op">=</span> <span class="va">xreg</span>, </span>
<span>                        type_pi <span class="op">=</span> <span class="st">"movingblockbootstrap"</span>, </span>
<span>                        block_length <span class="op">=</span> <span class="va">block_length</span>,</span>
<span>                        B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.83543  9.489772</span></span>
<span><span class="co">#&gt; Jun 2005 16.55420  9.952436</span></span>
<span><span class="co">#&gt; Jul 2005 16.60903  9.978960</span></span>
<span><span class="co">#&gt; Aug 2005 16.14855  9.585632</span></span>
<span><span class="co">#&gt; Sep 2005 16.75980  9.901060</span></span>
<span><span class="co">#&gt; Oct 2005 16.52638  9.757841</span></span>
<span><span class="co">#&gt; Nov 2005 16.20550  9.633730</span></span>
<span><span class="co">#&gt; Dec 2005 16.59988  9.841196</span></span>
<span><span class="co">#&gt; Jan 2006 17.43929 10.277301</span></span>
<span><span class="co">#&gt; Feb 2006 17.90968 10.399618</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 12.72699  7.686207</span></span>
<span><span class="co">#&gt; Jun 2005 14.05032  8.359338</span></span>
<span><span class="co">#&gt; Jul 2005 11.63180  7.645953</span></span>
<span><span class="co">#&gt; Aug 2005 11.21991  7.230665</span></span>
<span><span class="co">#&gt; Sep 2005 12.55685  7.961274</span></span>
<span><span class="co">#&gt; Oct 2005 12.04592  7.122343</span></span>
<span><span class="co">#&gt; Nov 2005 11.07888  7.381414</span></span>
<span><span class="co">#&gt; Dec 2005 11.22579  7.240579</span></span>
<span><span class="co">#&gt; Jan 2006 15.05035  8.985558</span></span>
<span><span class="co">#&gt; Feb 2006 15.08776  8.617056</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.72106  10.87268</span></span>
<span><span class="co">#&gt; Jun 2005 17.92847  10.86512</span></span>
<span><span class="co">#&gt; Jul 2005 19.29555  11.43451</span></span>
<span><span class="co">#&gt; Aug 2005 19.48949  11.08961</span></span>
<span><span class="co">#&gt; Sep 2005 20.02551  11.28706</span></span>
<span><span class="co">#&gt; Oct 2005 21.38539  12.11528</span></span>
<span><span class="co">#&gt; Nov 2005 20.92989  12.36284</span></span>
<span><span class="co">#&gt; Dec 2005 20.30573  11.79615</span></span>
<span><span class="co">#&gt; Jan 2006 19.68644  11.36362</span></span>
<span><span class="co">#&gt; Feb 2006 20.36054  11.67601</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.20933  9.248692</span></span>
<span><span class="co">#&gt; Jun 2005 17.92847 10.448051</span></span>
<span><span class="co">#&gt; Jul 2005 18.16175 10.522865</span></span>
<span><span class="co">#&gt; Aug 2005 19.21817 11.070449</span></span>
<span><span class="co">#&gt; Sep 2005 19.24082 10.967224</span></span>
<span><span class="co">#&gt; Oct 2005 18.82074 10.778483</span></span>
<span><span class="co">#&gt; Nov 2005 17.56392 10.189387</span></span>
<span><span class="co">#&gt; Dec 2005 16.79434  9.908283</span></span>
<span><span class="co">#&gt; Jan 2006 17.02486 10.433824</span></span>
<span><span class="co">#&gt; Feb 2006 14.88077  8.367710</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.72942  9.514972</span></span>
<span><span class="co">#&gt; Jun 2005 15.17064  9.280168</span></span>
<span><span class="co">#&gt; Jul 2005 13.04263  8.213002</span></span>
<span><span class="co">#&gt; Aug 2005 13.96530  8.942326</span></span>
<span><span class="co">#&gt; Sep 2005 14.94964  8.987836</span></span>
<span><span class="co">#&gt; Oct 2005 14.39268  8.525416</span></span>
<span><span class="co">#&gt; Nov 2005 13.11037  7.798914</span></span>
<span><span class="co">#&gt; Dec 2005 15.13573  8.754940</span></span>
<span><span class="co">#&gt; Jan 2006 18.51636 10.608660</span></span>
<span><span class="co">#&gt; Feb 2006 19.86284 10.967012</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.72106 10.872683</span></span>
<span><span class="co">#&gt; Jun 2005 17.53445 10.312671</span></span>
<span><span class="co">#&gt; Jul 2005 19.29555 11.367458</span></span>
<span><span class="co">#&gt; Aug 2005 17.52208 10.193230</span></span>
<span><span class="co">#&gt; Sep 2005 16.40079  9.716833</span></span>
<span><span class="co">#&gt; Oct 2005 15.94805  9.521983</span></span>
<span><span class="co">#&gt; Nov 2005 15.06181  9.227088</span></span>
<span><span class="co">#&gt; Dec 2005 17.96759 11.093207</span></span>
<span><span class="co">#&gt; Jan 2006 17.94621 10.616732</span></span>
<span><span class="co">#&gt; Feb 2006 19.80624 11.705974</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 12.17858  7.404155</span></span>
<span><span class="co">#&gt; Jun 2005 13.84444  8.102730</span></span>
<span><span class="co">#&gt; Jul 2005 17.25717  9.926768</span></span>
<span><span class="co">#&gt; Aug 2005 18.75814 10.433791</span></span>
<span><span class="co">#&gt; Sep 2005 20.06183 11.304300</span></span>
<span><span class="co">#&gt; Oct 2005 21.99834 12.464595</span></span>
<span><span class="co">#&gt; Nov 2005 20.27751 11.305189</span></span>
<span><span class="co">#&gt; Dec 2005 19.22525 10.855547</span></span>
<span><span class="co">#&gt; Jan 2006 18.46526 10.570034</span></span>
<span><span class="co">#&gt; Feb 2006 18.73089 11.109911</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.87497  9.639481</span></span>
<span><span class="co">#&gt; Jun 2005 16.19959 10.986202</span></span>
<span><span class="co">#&gt; Jul 2005 11.22221  7.481325</span></span>
<span><span class="co">#&gt; Aug 2005 10.91819  7.069941</span></span>
<span><span class="co">#&gt; Sep 2005 15.48265  9.636346</span></span>
<span><span class="co">#&gt; Oct 2005 11.87311  7.446051</span></span>
<span><span class="co">#&gt; Nov 2005 13.44818  7.958237</span></span>
<span><span class="co">#&gt; Dec 2005 17.25606  9.922121</span></span>
<span><span class="co">#&gt; Jan 2006 19.16939 10.706057</span></span>
<span><span class="co">#&gt; Feb 2006 20.50504 11.572811</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.20933  9.248692</span></span>
<span><span class="co">#&gt; Jun 2005 17.92847 10.448051</span></span>
<span><span class="co">#&gt; Jul 2005 18.16175 10.522865</span></span>
<span><span class="co">#&gt; Aug 2005 19.21817 11.070449</span></span>
<span><span class="co">#&gt; Sep 2005 19.24082 10.967224</span></span>
<span><span class="co">#&gt; Oct 2005 18.58599 10.422015</span></span>
<span><span class="co">#&gt; Nov 2005 21.11929 12.669903</span></span>
<span><span class="co">#&gt; Dec 2005 16.43824  9.331846</span></span>
<span><span class="co">#&gt; Jan 2006 15.15428  8.828476</span></span>
<span><span class="co">#&gt; Feb 2006 16.46135  9.510545</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.72106 10.872683</span></span>
<span><span class="co">#&gt; Jun 2005 17.53445 10.312671</span></span>
<span><span class="co">#&gt; Jul 2005 19.29555 11.367458</span></span>
<span><span class="co">#&gt; Aug 2005 17.52208 10.193230</span></span>
<span><span class="co">#&gt; Sep 2005 16.40079  9.716833</span></span>
<span><span class="co">#&gt; Oct 2005 17.18101 10.306562</span></span>
<span><span class="co">#&gt; Nov 2005 16.25646  9.773591</span></span>
<span><span class="co">#&gt; Dec 2005 14.25513  8.842654</span></span>
<span><span class="co">#&gt; Jan 2006 15.02018  9.526620</span></span>
<span><span class="co">#&gt; Feb 2006 15.80073  9.475915</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.61594  8.657718</span></span>
<span><span class="co">#&gt; Jun 2005 17.08964  9.943581</span></span>
<span><span class="co">#&gt; Jul 2005 18.24222 10.200904</span></span>
<span><span class="co">#&gt; Aug 2005 19.56826 11.095179</span></span>
<span><span class="co">#&gt; Sep 2005 19.90040 11.227659</span></span>
<span><span class="co">#&gt; Oct 2005 19.27412 10.912062</span></span>
<span><span class="co">#&gt; Nov 2005 17.24203  9.961629</span></span>
<span><span class="co">#&gt; Dec 2005 17.96073 10.902199</span></span>
<span><span class="co">#&gt; Jan 2006 17.84079 10.348311</span></span>
<span><span class="co">#&gt; Feb 2006 18.82829 11.083172</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.63319  9.847365</span></span>
<span><span class="co">#&gt; Jun 2005 14.75946  9.243212</span></span>
<span><span class="co">#&gt; Jul 2005 13.98353  8.732984</span></span>
<span><span class="co">#&gt; Aug 2005 12.25917  7.784271</span></span>
<span><span class="co">#&gt; Sep 2005 13.69333  8.755714</span></span>
<span><span class="co">#&gt; Oct 2005 14.54859 10.172875</span></span>
<span><span class="co">#&gt; Nov 2005 10.48910  7.260205</span></span>
<span><span class="co">#&gt; Dec 2005 10.34631  6.800926</span></span>
<span><span class="co">#&gt; Jan 2006 15.41898  9.579770</span></span>
<span><span class="co">#&gt; Feb 2006 17.21899 10.313983</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.46143  9.591273</span></span>
<span><span class="co">#&gt; Jun 2005 17.55234 10.447025</span></span>
<span><span class="co">#&gt; Jul 2005 17.42791 11.453975</span></span>
<span><span class="co">#&gt; Aug 2005 12.53595  8.003457</span></span>
<span><span class="co">#&gt; Sep 2005 12.22690  7.730630</span></span>
<span><span class="co">#&gt; Oct 2005 12.64115  7.028363</span></span>
<span><span class="co">#&gt; Nov 2005 17.48638 10.193159</span></span>
<span><span class="co">#&gt; Dec 2005 20.61942 12.000236</span></span>
<span><span class="co">#&gt; Jan 2006 19.83655 11.554531</span></span>
<span><span class="co">#&gt; Feb 2006 17.00171  9.889151</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 13.711787  7.843252</span></span>
<span><span class="co">#&gt; Feb 2002 13.324117  7.475004</span></span>
<span><span class="co">#&gt; Mar 2002 13.587753  7.830287</span></span>
<span><span class="co">#&gt; Apr 2002 13.832811  8.012027</span></span>
<span><span class="co">#&gt; May 2002 13.381182  7.616504</span></span>
<span><span class="co">#&gt; Jun 2002 13.338987  7.806670</span></span>
<span><span class="co">#&gt; Jul 2002 11.662651  6.949718</span></span>
<span><span class="co">#&gt; Aug 2002 12.242217  7.294680</span></span>
<span><span class="co">#&gt; Sep 2002 13.824793  8.160078</span></span>
<span><span class="co">#&gt; Oct 2002 15.337968  8.830015</span></span>
<span><span class="co">#&gt; Nov 2002 15.503580  8.854393</span></span>
<span><span class="co">#&gt; Dec 2002 15.857927  9.038591</span></span>
<span><span class="co">#&gt; Jan 2003 16.387678  9.257229</span></span>
<span><span class="co">#&gt; Feb 2003 16.553813  9.383619</span></span>
<span><span class="co">#&gt; Mar 2003 17.134719  9.686509</span></span>
<span><span class="co">#&gt; Apr 2003 16.219028  9.369500</span></span>
<span><span class="co">#&gt; May 2003 13.511112  8.099575</span></span>
<span><span class="co">#&gt; Jun 2003 13.110407  7.959201</span></span>
<span><span class="co">#&gt; Jul 2003 12.371223  7.809538</span></span>
<span><span class="co">#&gt; Aug 2003 12.408829  7.815604</span></span>
<span><span class="co">#&gt; Sep 2003 11.999511  7.587126</span></span>
<span><span class="co">#&gt; Oct 2003 10.497685  6.763430</span></span>
<span><span class="co">#&gt; Nov 2003 10.376898  6.789662</span></span>
<span><span class="co">#&gt; Dec 2003 12.532319  7.774555</span></span>
<span><span class="co">#&gt; Jan 2004 13.107961  8.200936</span></span>
<span><span class="co">#&gt; Feb 2004 10.080319  6.945952</span></span>
<span><span class="co">#&gt; Mar 2004  9.958216  6.551072</span></span>
<span><span class="co">#&gt; Apr 2004 10.035496  6.494692</span></span>
<span><span class="co">#&gt; May 2004 12.156667  7.796691</span></span>
<span><span class="co">#&gt; Jun 2004 13.952379  8.670150</span></span>
<span><span class="co">#&gt; Jul 2004 14.579737  8.953919</span></span>
<span><span class="co">#&gt; Aug 2004 14.252833  8.842487</span></span>
<span><span class="co">#&gt; Sep 2004 13.422310  8.378485</span></span>
<span><span class="co">#&gt; Oct 2004 13.306547  8.253072</span></span>
<span><span class="co">#&gt; Nov 2004 13.152395  8.301396</span></span>
<span><span class="co">#&gt; Dec 2004 15.307750  8.977439</span></span>
<span><span class="co">#&gt; Jan 2005 15.793871  9.607153</span></span>
<span><span class="co">#&gt; Feb 2005 16.894043  9.965880</span></span>
<span><span class="co">#&gt; Mar 2005 16.493711  9.857297</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;               Quotes    TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.67535261  1.600318363</span></span>
<span><span class="co">#&gt; Feb 2002 -0.09454667  0.059245589</span></span>
<span><span class="co">#&gt; Mar 2002 -0.61710349 -0.617562341</span></span>
<span><span class="co">#&gt; Apr 2002  1.55432930  1.431543276</span></span>
<span><span class="co">#&gt; May 2002 -1.65830176 -1.201288646</span></span>
<span><span class="co">#&gt; Jun 2002 -3.27721670 -1.999680352</span></span>
<span><span class="co">#&gt; Jul 2002 -0.83986146 -0.746117612</span></span>
<span><span class="co">#&gt; Aug 2002  1.04485279  0.291750330</span></span>
<span><span class="co">#&gt; Sep 2002  0.75352722 -0.155143365</span></span>
<span><span class="co">#&gt; Oct 2002  0.26745241  0.004965096</span></span>
<span><span class="co">#&gt; Nov 2002  0.43157027  0.102861987</span></span>
<span><span class="co">#&gt; Dec 2002  1.13693270  0.494399368</span></span>
<span><span class="co">#&gt; Jan 2003  0.49053241  0.135721074</span></span>
<span><span class="co">#&gt; Feb 2003 -0.10253286 -0.465058629</span></span>
<span><span class="co">#&gt; Mar 2003 -1.85353900 -1.312388835</span></span>
<span><span class="co">#&gt; Apr 2003 -0.33001834  0.475005003</span></span>
<span><span class="co">#&gt; May 2003  2.16635830  1.749815332</span></span>
<span><span class="co">#&gt; Jun 2003  0.17739319  0.443529161</span></span>
<span><span class="co">#&gt; Jul 2003  0.27361734  0.111136601</span></span>
<span><span class="co">#&gt; Aug 2003 -0.58111949 -0.379519019</span></span>
<span><span class="co">#&gt; Sep 2003 -2.30767070 -1.246635836</span></span>
<span><span class="co">#&gt; Oct 2003 -0.19353452  0.176564889</span></span>
<span><span class="co">#&gt; Nov 2003  1.00563207  0.187437814</span></span>
<span><span class="co">#&gt; Dec 2003  0.41917089  0.235645632</span></span>
<span><span class="co">#&gt; Jan 2004  0.52295932  1.364524163</span></span>
<span><span class="co">#&gt; Feb 2004 -0.95933919 -0.673442252</span></span>
<span><span class="co">#&gt; Mar 2004 -1.56353647 -0.843576594</span></span>
<span><span class="co">#&gt; Apr 2004  2.26526358  1.468847972</span></span>
<span><span class="co">#&gt; May 2004  1.69164304  0.697529740</span></span>
<span><span class="co">#&gt; Jun 2004  2.01008148  1.118934668</span></span>
<span><span class="co">#&gt; Jul 2004 -0.38235687 -0.261094013</span></span>
<span><span class="co">#&gt; Aug 2004 -1.39361339 -0.785256869</span></span>
<span><span class="co">#&gt; Sep 2004 -1.33394033 -0.789489620</span></span>
<span><span class="co">#&gt; Oct 2004 -0.37279705 -0.008190995</span></span>
<span><span class="co">#&gt; Nov 2004 -1.43004502 -1.625855697</span></span>
<span><span class="co">#&gt; Dec 2004  0.16351013  0.242165460</span></span>
<span><span class="co">#&gt; Jan 2005  2.64510868  1.356646561</span></span>
<span><span class="co">#&gt; Feb 2005  0.59781674  0.490409659</span></span>
<span><span class="co">#&gt; Mar 2005 -2.00203118 -1.128697062</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 1.243869</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 6.628923e-18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;       Quotes    TV.advert       xreg_1 </span></span>
<span><span class="co">#&gt; 2.556419e+00 1.175162e+00 2.765868e-05 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res8</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert      </span></span>
<span><span class="co">#&gt;  Min.   :-3.2772   Min.   :-1.9997  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.8996   1st Qu.:-0.7098  </span></span>
<span><span class="co">#&gt;  Median : 0.1635   Median : 0.1029  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.0000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.8796   3rd Qu.: 0.4827  </span></span>
<span><span class="co">#&gt;  Max.   : 2.6451   Max.   : 1.7498</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res8</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.1553145 0.4247378</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res8</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9498845 0.5141136</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res8</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/movingblockbootstrap-xreg-1.png" width="691.2"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res8</span>, <span class="st">"TV.advert"</span>, type <span class="op">=</span> <span class="st">"dist"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/movingblockbootstrap-xreg-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-external-regressors-and-k-means-clustering-3">4 - 3 With external regressors and K-Means clustering<a class="anchor" aria-label="anchor" href="#with-external-regressors-and-k-means-clustering-3"></a>
</h3>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res15</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                        xreg <span class="op">=</span> <span class="va">xreg</span>, centers <span class="op">=</span> <span class="va">centers</span>, </span>
<span>                        type_pi <span class="op">=</span> <span class="st">"movingblockbootstrap"</span>, </span>
<span>                        block_length <span class="op">=</span> <span class="va">block_length</span>,</span>
<span>                        B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.48678 10.103083</span></span>
<span><span class="co">#&gt; Jun 2005 16.26065  9.972372</span></span>
<span><span class="co">#&gt; Jul 2005 16.08808  9.904010</span></span>
<span><span class="co">#&gt; Aug 2005 15.88583  9.790917</span></span>
<span><span class="co">#&gt; Sep 2005 16.32629 10.119449</span></span>
<span><span class="co">#&gt; Oct 2005 15.10819  9.295127</span></span>
<span><span class="co">#&gt; Nov 2005 15.00750  9.363712</span></span>
<span><span class="co">#&gt; Dec 2005 15.23145  9.544211</span></span>
<span><span class="co">#&gt; Jan 2006 15.29956  9.516065</span></span>
<span><span class="co">#&gt; Feb 2006 15.60752  9.572980</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.116526  8.729181</span></span>
<span><span class="co">#&gt; Jun 2005 13.297374  8.277526</span></span>
<span><span class="co">#&gt; Jul 2005 11.741455  7.786858</span></span>
<span><span class="co">#&gt; Aug 2005 11.040961  7.452157</span></span>
<span><span class="co">#&gt; Sep 2005 11.984304  7.967013</span></span>
<span><span class="co">#&gt; Oct 2005  9.979963  6.494841</span></span>
<span><span class="co">#&gt; Nov 2005 10.272114  7.186638</span></span>
<span><span class="co">#&gt; Dec 2005 10.293749  7.148882</span></span>
<span><span class="co">#&gt; Jan 2006 13.625853  8.367827</span></span>
<span><span class="co">#&gt; Feb 2006 12.971447  7.530730</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.51550  10.70060</span></span>
<span><span class="co">#&gt; Jun 2005 18.47426  11.11222</span></span>
<span><span class="co">#&gt; Jul 2005 19.39134  11.77089</span></span>
<span><span class="co">#&gt; Aug 2005 19.63085  11.67941</span></span>
<span><span class="co">#&gt; Sep 2005 19.92996  11.80783</span></span>
<span><span class="co">#&gt; Oct 2005 20.21576  12.01300</span></span>
<span><span class="co">#&gt; Nov 2005 19.25711  11.55263</span></span>
<span><span class="co">#&gt; Dec 2005 18.72400  11.32669</span></span>
<span><span class="co">#&gt; Jan 2006 17.53859  10.67868</span></span>
<span><span class="co">#&gt; Feb 2006 19.38392  11.76750</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.65750  9.692479</span></span>
<span><span class="co">#&gt; Jun 2005 18.47426 11.112220</span></span>
<span><span class="co">#&gt; Jul 2005 18.65818 11.140052</span></span>
<span><span class="co">#&gt; Aug 2005 19.51995 11.603363</span></span>
<span><span class="co">#&gt; Sep 2005 18.98175 11.243348</span></span>
<span><span class="co">#&gt; Oct 2005 18.13053 10.849317</span></span>
<span><span class="co">#&gt; Nov 2005 16.65695 10.234015</span></span>
<span><span class="co">#&gt; Dec 2005 13.87377  8.492570</span></span>
<span><span class="co">#&gt; Jan 2006 15.06899  9.493521</span></span>
<span><span class="co">#&gt; Feb 2006 12.67545  7.171518</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.48451 10.183227</span></span>
<span><span class="co">#&gt; Jun 2005 14.09576  8.662416</span></span>
<span><span class="co">#&gt; Jul 2005 12.05757  7.761583</span></span>
<span><span class="co">#&gt; Aug 2005 13.99415  9.405121</span></span>
<span><span class="co">#&gt; Sep 2005 13.79910  8.789455</span></span>
<span><span class="co">#&gt; Oct 2005 12.57144  7.718240</span></span>
<span><span class="co">#&gt; Nov 2005 12.27323  7.711577</span></span>
<span><span class="co">#&gt; Dec 2005 14.61622  9.065287</span></span>
<span><span class="co">#&gt; Jan 2006 16.72708 10.179068</span></span>
<span><span class="co">#&gt; Feb 2006 15.33237  8.768017</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.22852 10.700604</span></span>
<span><span class="co">#&gt; Jun 2005 17.29592 10.306295</span></span>
<span><span class="co">#&gt; Jul 2005 19.39134 11.770892</span></span>
<span><span class="co">#&gt; Aug 2005 18.02149 10.888838</span></span>
<span><span class="co">#&gt; Sep 2005 16.09387  9.906842</span></span>
<span><span class="co">#&gt; Oct 2005 13.02240  7.975984</span></span>
<span><span class="co">#&gt; Nov 2005 14.13111  9.057568</span></span>
<span><span class="co">#&gt; Dec 2005 16.62346 10.706757</span></span>
<span><span class="co">#&gt; Jan 2006 15.95043  9.811446</span></span>
<span><span class="co">#&gt; Feb 2006 18.60512 11.573087</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.52654  8.449514</span></span>
<span><span class="co">#&gt; Jun 2005 14.29064  8.828657</span></span>
<span><span class="co">#&gt; Jul 2005 16.27560  9.853861</span></span>
<span><span class="co">#&gt; Aug 2005 14.85577  8.404023</span></span>
<span><span class="co">#&gt; Sep 2005 19.46207 11.640312</span></span>
<span><span class="co">#&gt; Oct 2005 20.38106 12.110112</span></span>
<span><span class="co">#&gt; Nov 2005 19.49181 11.598420</span></span>
<span><span class="co">#&gt; Dec 2005 17.95372 10.867385</span></span>
<span><span class="co">#&gt; Jan 2006 15.33889  9.201712</span></span>
<span><span class="co">#&gt; Feb 2006 15.87004  9.887262</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.003136 10.606719</span></span>
<span><span class="co">#&gt; Jun 2005 15.229005 10.383217</span></span>
<span><span class="co">#&gt; Jul 2005 11.649679  7.873915</span></span>
<span><span class="co">#&gt; Aug 2005 10.892566  7.433005</span></span>
<span><span class="co">#&gt; Sep 2005 14.574598  9.601741</span></span>
<span><span class="co">#&gt; Oct 2005  9.227599  6.139661</span></span>
<span><span class="co">#&gt; Nov 2005 13.376564  8.457635</span></span>
<span><span class="co">#&gt; Dec 2005 15.725095  9.617078</span></span>
<span><span class="co">#&gt; Jan 2006 14.608569  8.368832</span></span>
<span><span class="co">#&gt; Feb 2006 19.610023 11.823942</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.65750  9.692479</span></span>
<span><span class="co">#&gt; Jun 2005 18.47426 11.112220</span></span>
<span><span class="co">#&gt; Jul 2005 18.65818 11.140052</span></span>
<span><span class="co">#&gt; Aug 2005 19.51995 11.603363</span></span>
<span><span class="co">#&gt; Sep 2005 18.98175 11.243348</span></span>
<span><span class="co">#&gt; Oct 2005 17.33317  9.967580</span></span>
<span><span class="co">#&gt; Nov 2005 18.44871 11.394917</span></span>
<span><span class="co">#&gt; Dec 2005 16.27551  9.765212</span></span>
<span><span class="co">#&gt; Jan 2006 13.50517  8.367534</span></span>
<span><span class="co">#&gt; Feb 2006 15.56447  9.630792</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.22852 10.700604</span></span>
<span><span class="co">#&gt; Jun 2005 17.29592 10.306295</span></span>
<span><span class="co">#&gt; Jul 2005 19.39134 11.770892</span></span>
<span><span class="co">#&gt; Aug 2005 18.02149 10.888838</span></span>
<span><span class="co">#&gt; Sep 2005 16.09387  9.906842</span></span>
<span><span class="co">#&gt; Oct 2005 14.22371  8.741750</span></span>
<span><span class="co">#&gt; Nov 2005 14.11773  8.769698</span></span>
<span><span class="co">#&gt; Dec 2005 12.31632  8.002094</span></span>
<span><span class="co">#&gt; Jan 2006 14.28275  9.656282</span></span>
<span><span class="co">#&gt; Feb 2006 14.13026  9.063832</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.14869  9.856336</span></span>
<span><span class="co">#&gt; Jun 2005 16.91139 10.171391</span></span>
<span><span class="co">#&gt; Jul 2005 15.63668  8.785238</span></span>
<span><span class="co">#&gt; Aug 2005 19.66305 11.701485</span></span>
<span><span class="co">#&gt; Sep 2005 20.06579 11.856458</span></span>
<span><span class="co">#&gt; Oct 2005 19.64639 11.678509</span></span>
<span><span class="co">#&gt; Nov 2005 16.42998  9.952515</span></span>
<span><span class="co">#&gt; Dec 2005 16.27624 10.564513</span></span>
<span><span class="co">#&gt; Jan 2006 15.69799  9.873595</span></span>
<span><span class="co">#&gt; Feb 2006 15.64734  9.975459</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.334099 10.523133</span></span>
<span><span class="co">#&gt; Jun 2005 13.065585  8.165784</span></span>
<span><span class="co">#&gt; Jul 2005 12.938114  8.082823</span></span>
<span><span class="co">#&gt; Aug 2005 11.552103  7.518122</span></span>
<span><span class="co">#&gt; Sep 2005 13.733693  9.277900</span></span>
<span><span class="co">#&gt; Oct 2005 13.298073  9.840495</span></span>
<span><span class="co">#&gt; Nov 2005  9.691144  7.034236</span></span>
<span><span class="co">#&gt; Dec 2005  9.706551  6.901175</span></span>
<span><span class="co">#&gt; Jan 2006 14.041552  9.384927</span></span>
<span><span class="co">#&gt; Feb 2006 13.990990  8.780147</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.59882 10.625734</span></span>
<span><span class="co">#&gt; Jun 2005 17.47376 10.675222</span></span>
<span><span class="co">#&gt; Jul 2005 16.22413 10.860792</span></span>
<span><span class="co">#&gt; Aug 2005 12.81774  8.463017</span></span>
<span><span class="co">#&gt; Sep 2005 11.47642  7.728240</span></span>
<span><span class="co">#&gt; Oct 2005 13.24755  7.929622</span></span>
<span><span class="co">#&gt; Nov 2005 15.45772  9.426534</span></span>
<span><span class="co">#&gt; Dec 2005 18.94763 11.460034</span></span>
<span><span class="co">#&gt; Jan 2006 17.77419 10.823732</span></span>
<span><span class="co">#&gt; Feb 2006 14.64913  9.055747</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 14.13745  8.221510</span></span>
<span><span class="co">#&gt; Feb 2002 12.96072  7.428876</span></span>
<span><span class="co">#&gt; Mar 2002 14.24210  8.365273</span></span>
<span><span class="co">#&gt; Apr 2002 14.10917  8.240689</span></span>
<span><span class="co">#&gt; May 2002 13.10385  7.576098</span></span>
<span><span class="co">#&gt; Jun 2002 12.85752  7.487839</span></span>
<span><span class="co">#&gt; Jul 2002 10.99640  6.477627</span></span>
<span><span class="co">#&gt; Aug 2002 11.68936  6.906576</span></span>
<span><span class="co">#&gt; Sep 2002 14.24311  8.442819</span></span>
<span><span class="co">#&gt; Oct 2002 15.11602  8.697927</span></span>
<span><span class="co">#&gt; Nov 2002 15.36602  8.771311</span></span>
<span><span class="co">#&gt; Dec 2002 15.81962  8.978734</span></span>
<span><span class="co">#&gt; Jan 2003 16.70731  9.329729</span></span>
<span><span class="co">#&gt; Feb 2003 16.86211  9.434764</span></span>
<span><span class="co">#&gt; Mar 2003 17.15027  9.618099</span></span>
<span><span class="co">#&gt; Apr 2003 16.11209  9.267083</span></span>
<span><span class="co">#&gt; May 2003 13.68703  8.152303</span></span>
<span><span class="co">#&gt; Jun 2003 13.27600  8.009960</span></span>
<span><span class="co">#&gt; Jul 2003 12.48263  7.867811</span></span>
<span><span class="co">#&gt; Aug 2003 12.12160  7.611787</span></span>
<span><span class="co">#&gt; Sep 2003 11.84829  7.397798</span></span>
<span><span class="co">#&gt; Oct 2003 10.57706  6.670099</span></span>
<span><span class="co">#&gt; Nov 2003 10.10601  6.481728</span></span>
<span><span class="co">#&gt; Dec 2003 12.27065  7.533845</span></span>
<span><span class="co">#&gt; Jan 2004 12.78740  7.996468</span></span>
<span><span class="co">#&gt; Feb 2004 10.16008  6.985412</span></span>
<span><span class="co">#&gt; Mar 2004 10.68037  6.951665</span></span>
<span><span class="co">#&gt; Apr 2004 11.39454  7.393299</span></span>
<span><span class="co">#&gt; May 2004 11.76171  7.533014</span></span>
<span><span class="co">#&gt; Jun 2004 14.72078  9.186313</span></span>
<span><span class="co">#&gt; Jul 2004 14.67146  8.963637</span></span>
<span><span class="co">#&gt; Aug 2004 14.87019  9.270515</span></span>
<span><span class="co">#&gt; Sep 2004 12.89441  8.132710</span></span>
<span><span class="co">#&gt; Oct 2004 12.66447  7.932732</span></span>
<span><span class="co">#&gt; Nov 2004 12.61418  8.047571</span></span>
<span><span class="co">#&gt; Dec 2004 15.06624  9.010981</span></span>
<span><span class="co">#&gt; Jan 2005 15.81507  9.700709</span></span>
<span><span class="co">#&gt; Feb 2005 16.88152  9.920224</span></span>
<span><span class="co">#&gt; Mar 2005 16.37843  9.807854</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;               Quotes   TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.24969289  1.22205996</span></span>
<span><span class="co">#&gt; Feb 2002  0.26885280  0.10537425</span></span>
<span><span class="co">#&gt; Mar 2002 -1.27144871 -1.15254827</span></span>
<span><span class="co">#&gt; Apr 2002  1.27797385  1.20288136</span></span>
<span><span class="co">#&gt; May 2002 -1.38096578 -1.16088326</span></span>
<span><span class="co">#&gt; Jun 2002 -2.79575299 -1.68084898</span></span>
<span><span class="co">#&gt; Jul 2002 -0.17360895 -0.27402696</span></span>
<span><span class="co">#&gt; Aug 2002  1.59770503  0.67985439</span></span>
<span><span class="co">#&gt; Sep 2002  0.33520729 -0.43788428</span></span>
<span><span class="co">#&gt; Oct 2002  0.48939779  0.13705250</span></span>
<span><span class="co">#&gt; Nov 2002  0.56912818  0.18594378</span></span>
<span><span class="co">#&gt; Dec 2002  1.17523937  0.55425563</span></span>
<span><span class="co">#&gt; Jan 2003  0.17089673  0.06322060</span></span>
<span><span class="co">#&gt; Feb 2003 -0.41082535 -0.51620445</span></span>
<span><span class="co">#&gt; Mar 2003 -1.86908938 -1.24397877</span></span>
<span><span class="co">#&gt; Apr 2003 -0.22307977  0.57742184</span></span>
<span><span class="co">#&gt; May 2003  1.99043807  1.69708709</span></span>
<span><span class="co">#&gt; Jun 2003  0.01180193  0.39277043</span></span>
<span><span class="co">#&gt; Jul 2003  0.16221379  0.05286418</span></span>
<span><span class="co">#&gt; Aug 2003 -0.29389157 -0.17570225</span></span>
<span><span class="co">#&gt; Sep 2003 -2.15645148 -1.05730773</span></span>
<span><span class="co">#&gt; Oct 2003 -0.27291405  0.26989565</span></span>
<span><span class="co">#&gt; Nov 2003  1.27652294  0.49537161</span></span>
<span><span class="co">#&gt; Dec 2003  0.68083925  0.47635585</span></span>
<span><span class="co">#&gt; Jan 2004  0.84352463  1.56899240</span></span>
<span><span class="co">#&gt; Feb 2004 -1.03909866 -0.71290176</span></span>
<span><span class="co">#&gt; Mar 2004 -2.28568521 -1.24416952</span></span>
<span><span class="co">#&gt; Apr 2004  0.90622268  0.57024150</span></span>
<span><span class="co">#&gt; May 2004  2.08659600  0.96120683</span></span>
<span><span class="co">#&gt; Jun 2004  1.24167683  0.60277201</span></span>
<span><span class="co">#&gt; Jul 2004 -0.47408066 -0.27081190</span></span>
<span><span class="co">#&gt; Aug 2004 -2.01097473 -1.21328460</span></span>
<span><span class="co">#&gt; Sep 2004 -0.80604087 -0.54371464</span></span>
<span><span class="co">#&gt; Oct 2004  0.26928009  0.31214938</span></span>
<span><span class="co">#&gt; Nov 2004 -0.89182765 -1.37203092</span></span>
<span><span class="co">#&gt; Dec 2004  0.40502425  0.20862299</span></span>
<span><span class="co">#&gt; Jan 2005  2.62390929  1.26309148</span></span>
<span><span class="co">#&gt; Feb 2005  0.61033897  0.53606615</span></span>
<span><span class="co">#&gt; Mar 2005 -1.88674685 -1.07925360</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 0.9839062</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 1.289992e-17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;       Quotes    TV.advert       xreg_1 xreg_cluster </span></span>
<span><span class="co">#&gt; 2.581749e+00 1.181670e+00 4.725259e-05 1.721592e-01 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res15</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert      </span></span>
<span><span class="co">#&gt;  Min.   :-2.7958   Min.   :-1.6808  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.8489   1st Qu.:-0.6283  </span></span>
<span><span class="co">#&gt;  Median : 0.1709   Median : 0.1371  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.0000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.8749   3rd Qu.: 0.5622  </span></span>
<span><span class="co">#&gt;  Max.   : 2.6239   Max.   : 1.6971</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res15</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.2414578 0.6241519</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res15</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.6746224 0.2274255</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res15</span>, <span class="st">"Quotes"</span>, type <span class="op">=</span> <span class="st">"dist"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/movingblockbootstrap-xreg-clustering-1.png" width="691.2"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res15</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/movingblockbootstrap-xreg-clustering-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-k-means-clustering-3">4 - 4 With K-Means clustering<a class="anchor" aria-label="anchor" href="#with-k-means-clustering-3"></a>
</h3>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res12</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                         centers <span class="op">=</span> <span class="va">centers</span>, </span>
<span>                         type_pi <span class="op">=</span> <span class="st">"movingblockbootstrap"</span>, </span>
<span>                         block_length <span class="op">=</span> <span class="va">block_length</span>,</span>
<span>                         B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.32708  8.399206</span></span>
<span><span class="co">#&gt; Jun 2005 14.87133  8.835588</span></span>
<span><span class="co">#&gt; Jul 2005 14.68166  8.740138</span></span>
<span><span class="co">#&gt; Aug 2005 13.89106  8.209283</span></span>
<span><span class="co">#&gt; Sep 2005 14.15864  8.375325</span></span>
<span><span class="co">#&gt; Oct 2005 13.78481  8.124327</span></span>
<span><span class="co">#&gt; Nov 2005 13.08920  7.867595</span></span>
<span><span class="co">#&gt; Dec 2005 13.07153  7.849232</span></span>
<span><span class="co">#&gt; Jan 2006 13.70425  8.228468</span></span>
<span><span class="co">#&gt; Feb 2006 14.17098  8.371821</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 11.284682  6.625351</span></span>
<span><span class="co">#&gt; Jun 2005 11.618933  6.809767</span></span>
<span><span class="co">#&gt; Jul 2005 10.112785  6.640527</span></span>
<span><span class="co">#&gt; Aug 2005  9.371833  6.184479</span></span>
<span><span class="co">#&gt; Sep 2005 10.141396  6.618021</span></span>
<span><span class="co">#&gt; Oct 2005  9.561156  5.903869</span></span>
<span><span class="co">#&gt; Nov 2005  8.348534  5.414705</span></span>
<span><span class="co">#&gt; Dec 2005  7.958991  5.346780</span></span>
<span><span class="co">#&gt; Jan 2006 11.419964  6.787018</span></span>
<span><span class="co">#&gt; Feb 2006 12.396450  7.175092</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.50808  9.918497</span></span>
<span><span class="co">#&gt; Jun 2005 16.94469 10.244451</span></span>
<span><span class="co">#&gt; Jul 2005 18.16364 10.679442</span></span>
<span><span class="co">#&gt; Aug 2005 16.86994  9.488674</span></span>
<span><span class="co">#&gt; Sep 2005 16.76515  9.354212</span></span>
<span><span class="co">#&gt; Oct 2005 18.08387 10.495293</span></span>
<span><span class="co">#&gt; Nov 2005 17.70500 10.411962</span></span>
<span><span class="co">#&gt; Dec 2005 17.46861 10.530246</span></span>
<span><span class="co">#&gt; Jan 2006 16.89073 10.156283</span></span>
<span><span class="co">#&gt; Feb 2006 16.58249  9.913766</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.65568  8.170631</span></span>
<span><span class="co">#&gt; Jun 2005 15.44246  8.770501</span></span>
<span><span class="co">#&gt; Jul 2005 15.82090  8.925479</span></span>
<span><span class="co">#&gt; Aug 2005 16.86994  9.488674</span></span>
<span><span class="co">#&gt; Sep 2005 16.76515  9.354212</span></span>
<span><span class="co">#&gt; Oct 2005 16.76416  9.591219</span></span>
<span><span class="co">#&gt; Nov 2005 15.22016  8.853618</span></span>
<span><span class="co">#&gt; Dec 2005 14.60952  8.677937</span></span>
<span><span class="co">#&gt; Jan 2006 15.30061  9.416820</span></span>
<span><span class="co">#&gt; Feb 2006 13.52361  7.533837</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.056773  8.297685</span></span>
<span><span class="co">#&gt; Jun 2005 13.386146  8.119346</span></span>
<span><span class="co">#&gt; Jul 2005 11.109161  7.106661</span></span>
<span><span class="co">#&gt; Aug 2005 11.508545  7.619346</span></span>
<span><span class="co">#&gt; Sep 2005 12.324017  7.523734</span></span>
<span><span class="co">#&gt; Oct 2005 10.666345  5.880696</span></span>
<span><span class="co">#&gt; Nov 2005  9.177871  5.337395</span></span>
<span><span class="co">#&gt; Dec 2005 10.081605  5.793727</span></span>
<span><span class="co">#&gt; Jan 2006 12.682040  7.244926</span></span>
<span><span class="co">#&gt; Feb 2006 14.093067  7.728363</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.50808  9.918497</span></span>
<span><span class="co">#&gt; Jun 2005 16.94469  9.870393</span></span>
<span><span class="co">#&gt; Jul 2005 18.16364 10.506721</span></span>
<span><span class="co">#&gt; Aug 2005 16.38002  9.464296</span></span>
<span><span class="co">#&gt; Sep 2005 14.87550  8.742633</span></span>
<span><span class="co">#&gt; Oct 2005 13.43396  7.960560</span></span>
<span><span class="co">#&gt; Nov 2005 12.07161  7.425533</span></span>
<span><span class="co">#&gt; Dec 2005 15.04452  9.375929</span></span>
<span><span class="co">#&gt; Jan 2006 15.63635  9.389344</span></span>
<span><span class="co">#&gt; Feb 2006 17.01959 10.112834</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 10.79010  6.397701</span></span>
<span><span class="co">#&gt; Jun 2005 11.12156  6.429567</span></span>
<span><span class="co">#&gt; Jul 2005 13.44021  7.692609</span></span>
<span><span class="co">#&gt; Aug 2005 14.67239  8.065305</span></span>
<span><span class="co">#&gt; Sep 2005 15.64021  8.843371</span></span>
<span><span class="co">#&gt; Oct 2005 18.46701 10.757766</span></span>
<span><span class="co">#&gt; Nov 2005 16.25330  9.390495</span></span>
<span><span class="co">#&gt; Dec 2005 14.83137  8.735919</span></span>
<span><span class="co">#&gt; Jan 2006 14.16042  8.511056</span></span>
<span><span class="co">#&gt; Feb 2006 14.81706  9.228087</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.779884  8.903908</span></span>
<span><span class="co">#&gt; Jun 2005 15.130784 10.353048</span></span>
<span><span class="co">#&gt; Jul 2005  9.823514  6.505197</span></span>
<span><span class="co">#&gt; Aug 2005  9.116520  6.043308</span></span>
<span><span class="co">#&gt; Sep 2005 12.967380  8.314924</span></span>
<span><span class="co">#&gt; Oct 2005  9.262766  5.989567</span></span>
<span><span class="co">#&gt; Nov 2005  9.445788  5.680997</span></span>
<span><span class="co">#&gt; Dec 2005 11.852784  6.866066</span></span>
<span><span class="co">#&gt; Jan 2006 13.307223  7.313228</span></span>
<span><span class="co">#&gt; Feb 2006 14.954699  8.636863</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.65568  8.170631</span></span>
<span><span class="co">#&gt; Jun 2005 15.44246  8.770501</span></span>
<span><span class="co">#&gt; Jul 2005 15.82090  8.925479</span></span>
<span><span class="co">#&gt; Aug 2005 16.86994  9.488674</span></span>
<span><span class="co">#&gt; Sep 2005 16.76515  9.354212</span></span>
<span><span class="co">#&gt; Oct 2005 15.82983  8.492995</span></span>
<span><span class="co">#&gt; Nov 2005 18.12646 10.708517</span></span>
<span><span class="co">#&gt; Dec 2005 13.47189  7.021538</span></span>
<span><span class="co">#&gt; Jan 2006 11.84928  6.654077</span></span>
<span><span class="co">#&gt; Feb 2006 12.45684  7.070941</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.50808  9.918497</span></span>
<span><span class="co">#&gt; Jun 2005 16.94469  9.870393</span></span>
<span><span class="co">#&gt; Jul 2005 18.16364 10.506721</span></span>
<span><span class="co">#&gt; Aug 2005 16.38002  9.464296</span></span>
<span><span class="co">#&gt; Sep 2005 14.87550  8.742633</span></span>
<span><span class="co">#&gt; Oct 2005 14.76533  8.751102</span></span>
<span><span class="co">#&gt; Nov 2005 13.94432  8.426355</span></span>
<span><span class="co">#&gt; Dec 2005 11.53101  7.345869</span></span>
<span><span class="co">#&gt; Jan 2006 11.73108  7.747303</span></span>
<span><span class="co">#&gt; Feb 2006 12.37892  7.570202</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 12.98825  7.409480</span></span>
<span><span class="co">#&gt; Jun 2005 14.94851  8.503624</span></span>
<span><span class="co">#&gt; Jul 2005 15.85036  8.725431</span></span>
<span><span class="co">#&gt; Aug 2005 16.21102  8.993418</span></span>
<span><span class="co">#&gt; Sep 2005 16.65744  9.224845</span></span>
<span><span class="co">#&gt; Oct 2005 16.06604  9.021712</span></span>
<span><span class="co">#&gt; Nov 2005 13.90404  8.183257</span></span>
<span><span class="co">#&gt; Dec 2005 13.77742  8.592941</span></span>
<span><span class="co">#&gt; Jan 2006 13.79097  8.185974</span></span>
<span><span class="co">#&gt; Feb 2006 15.07691  9.144566</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.764566  8.442647</span></span>
<span><span class="co">#&gt; Jun 2005 13.332113  8.180072</span></span>
<span><span class="co">#&gt; Jul 2005 12.510554  7.777492</span></span>
<span><span class="co">#&gt; Aug 2005 10.251245  6.670737</span></span>
<span><span class="co">#&gt; Sep 2005 10.751945  7.205105</span></span>
<span><span class="co">#&gt; Oct 2005 12.003719  8.813966</span></span>
<span><span class="co">#&gt; Nov 2005  8.107758  5.940774</span></span>
<span><span class="co">#&gt; Dec 2005  7.342749  5.217021</span></span>
<span><span class="co">#&gt; Jan 2006 11.329640  7.450984</span></span>
<span><span class="co">#&gt; Feb 2006 13.109429  8.037051</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.563714  8.362382</span></span>
<span><span class="co">#&gt; Jun 2005 16.019922  9.488437</span></span>
<span><span class="co">#&gt; Jul 2005 16.113742 10.729587</span></span>
<span><span class="co">#&gt; Aug 2005 10.650913  6.794771</span></span>
<span><span class="co">#&gt; Sep 2005  9.964139  6.447577</span></span>
<span><span class="co">#&gt; Oct 2005 10.588947  5.983687</span></span>
<span><span class="co">#&gt; Nov 2005 14.640692  8.729005</span></span>
<span><span class="co">#&gt; Dec 2005 18.172384 10.865370</span></span>
<span><span class="co">#&gt; Jan 2006 17.254904 10.370966</span></span>
<span><span class="co">#&gt; Feb 2006 14.279724  8.655468</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 14.080025  8.217172</span></span>
<span><span class="co">#&gt; Feb 2002 14.097935  8.504100</span></span>
<span><span class="co">#&gt; Mar 2002 14.037980  8.254621</span></span>
<span><span class="co">#&gt; Apr 2002 14.080025  8.217172</span></span>
<span><span class="co">#&gt; May 2002 14.097935  8.504100</span></span>
<span><span class="co">#&gt; Jun 2002 13.400229  7.842877</span></span>
<span><span class="co">#&gt; Jul 2002 11.963099  7.227708</span></span>
<span><span class="co">#&gt; Aug 2002 12.483082  7.479137</span></span>
<span><span class="co">#&gt; Sep 2002 14.051200  8.267892</span></span>
<span><span class="co">#&gt; Oct 2002 15.653409  9.046206</span></span>
<span><span class="co">#&gt; Nov 2002 15.895374  9.120444</span></span>
<span><span class="co">#&gt; Dec 2002 16.246375  9.254438</span></span>
<span><span class="co">#&gt; Jan 2003 16.880238  9.544966</span></span>
<span><span class="co">#&gt; Feb 2003 17.003473  9.571713</span></span>
<span><span class="co">#&gt; Mar 2003 17.231948  9.639966</span></span>
<span><span class="co">#&gt; Apr 2003 16.195870  9.248908</span></span>
<span><span class="co">#&gt; May 2003 14.058413  8.543376</span></span>
<span><span class="co">#&gt; Jun 2003 13.651791  8.393671</span></span>
<span><span class="co">#&gt; Jul 2003 12.716624  8.056579</span></span>
<span><span class="co">#&gt; Aug 2003 12.646146  7.882686</span></span>
<span><span class="co">#&gt; Sep 2003 12.337320  7.628455</span></span>
<span><span class="co">#&gt; Oct 2003 10.858041  6.918282</span></span>
<span><span class="co">#&gt; Nov 2003 10.947373  7.048306</span></span>
<span><span class="co">#&gt; Dec 2003 12.300163  7.539882</span></span>
<span><span class="co">#&gt; Jan 2004 12.920135  8.002056</span></span>
<span><span class="co">#&gt; Feb 2004 10.524137  7.198956</span></span>
<span><span class="co">#&gt; Mar 2004 10.198641  6.670517</span></span>
<span><span class="co">#&gt; Apr 2004  9.921236  6.478631</span></span>
<span><span class="co">#&gt; May 2004 12.093310  7.711550</span></span>
<span><span class="co">#&gt; Jun 2004 13.435713  8.168927</span></span>
<span><span class="co">#&gt; Jul 2004 14.330379  8.636496</span></span>
<span><span class="co">#&gt; Aug 2004 13.676214  8.257946</span></span>
<span><span class="co">#&gt; Sep 2004 12.711040  7.946941</span></span>
<span><span class="co">#&gt; Oct 2004 12.438696  7.709987</span></span>
<span><span class="co">#&gt; Nov 2004 12.493577  7.932898</span></span>
<span><span class="co">#&gt; Dec 2004 13.094054  7.775530</span></span>
<span><span class="co">#&gt; Jan 2005 14.800106  8.733646</span></span>
<span><span class="co">#&gt; Feb 2005 16.091897  9.445771</span></span>
<span><span class="co">#&gt; Mar 2005 15.560027  9.180879</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;                Quotes   TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.307114839  1.22639837</span></span>
<span><span class="co">#&gt; Feb 2002 -0.868364597 -0.96984988</span></span>
<span><span class="co">#&gt; Mar 2002 -1.067329559 -1.04189553</span></span>
<span><span class="co">#&gt; Apr 2002  1.307114839  1.22639837</span></span>
<span><span class="co">#&gt; May 2002 -2.375054597 -2.08888488</span></span>
<span><span class="co">#&gt; Jun 2002 -3.338459123 -2.03588722</span></span>
<span><span class="co">#&gt; Jul 2002 -1.140308873 -1.02410785</span></span>
<span><span class="co">#&gt; Aug 2002  0.803987736  0.10729330</span></span>
<span><span class="co">#&gt; Sep 2002  0.527119680 -0.26295692</span></span>
<span><span class="co">#&gt; Oct 2002 -0.047988643 -0.21122600</span></span>
<span><span class="co">#&gt; Nov 2002  0.039776086 -0.16318896</span></span>
<span><span class="co">#&gt; Dec 2002  0.748484692  0.27855217</span></span>
<span><span class="co">#&gt; Jan 2003 -0.002027973 -0.15201590</span></span>
<span><span class="co">#&gt; Feb 2003 -0.552192724 -0.65315272</span></span>
<span><span class="co">#&gt; Mar 2003 -1.950768084 -1.26584601</span></span>
<span><span class="co">#&gt; Apr 2003 -0.306860047  0.59559733</span></span>
<span><span class="co">#&gt; May 2003  1.619056967  1.30601353</span></span>
<span><span class="co">#&gt; Jun 2003 -0.363991107  0.00905855</span></span>
<span><span class="co">#&gt; Jul 2003 -0.071784477 -0.13590381</span></span>
<span><span class="co">#&gt; Aug 2003 -0.818435582 -0.44660102</span></span>
<span><span class="co">#&gt; Sep 2003 -2.645480110 -1.28796505</span></span>
<span><span class="co">#&gt; Oct 2003 -0.553891055  0.02171253</span></span>
<span><span class="co">#&gt; Nov 2003  0.435156765 -0.07120594</span></span>
<span><span class="co">#&gt; Dec 2003  0.651326753  0.47031930</span></span>
<span><span class="co">#&gt; Jan 2004  0.710784799  1.56340435</span></span>
<span><span class="co">#&gt; Feb 2004 -1.403156976 -0.92644608</span></span>
<span><span class="co">#&gt; Mar 2004 -1.803961042 -0.96302233</span></span>
<span><span class="co">#&gt; Apr 2004  2.379523900  1.48490908</span></span>
<span><span class="co">#&gt; May 2004  1.755000239  0.78267104</span></span>
<span><span class="co">#&gt; Jun 2004  2.526746719  1.62015783</span></span>
<span><span class="co">#&gt; Jul 2004 -0.132999437  0.05632932</span></span>
<span><span class="co">#&gt; Aug 2004 -0.816993774 -0.20071589</span></span>
<span><span class="co">#&gt; Sep 2004 -0.622669658 -0.35794574</span></span>
<span><span class="co">#&gt; Oct 2004  0.495054063  0.53489384</span></span>
<span><span class="co">#&gt; Nov 2004 -0.771226686 -1.25735840</span></span>
<span><span class="co">#&gt; Dec 2004  2.377205824  1.44407360</span></span>
<span><span class="co">#&gt; Jan 2005  3.638874496  2.23015367</span></span>
<span><span class="co">#&gt; Feb 2005  1.399962612  1.01051877</span></span>
<span><span class="co">#&gt; Mar 2005 -1.068346882 -0.45227882</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 1.557655</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 2.232715e-17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;       Quotes    TV.advert xreg_cluster </span></span>
<span><span class="co">#&gt;    3.0295614    1.4590629    0.1843407 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res12</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes           TV.advert      </span></span>
<span><span class="co">#&gt;  Min.   :-3.33846   Min.   :-2.0889  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.84340   1st Qu.:-0.7898  </span></span>
<span><span class="co">#&gt;  Median :-0.07178   Median :-0.1359  </span></span>
<span><span class="co">#&gt;  Mean   : 0.00000   Mean   : 0.0000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.77624   3rd Qu.: 0.6891  </span></span>
<span><span class="co">#&gt;  Max.   : 3.63887   Max.   : 2.2302</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res12</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.0461306 0.2610091</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res12</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9864921 0.5720541</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res12</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/movingblockbootstrap-kmeans-1.png" width="691.2"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res12</span>, <span class="st">"TV.advert"</span>, type <span class="op">=</span> <span class="st">"sims"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/movingblockbootstrap-kmeans-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="using-the-median-instead-of-the-mean-in-bootstrap-aggregation-1">4 - 5 Using the median instead of the mean in bootstrap
aggregation<a class="anchor" aria-label="anchor" href="#using-the-median-instead-of-the-mean-in-bootstrap-aggregation-1"></a>
</h3>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res14</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                         centers <span class="op">=</span> <span class="va">centers</span>, </span>
<span>                         type_pi <span class="op">=</span> <span class="st">"movingblockbootstrap"</span>, </span>
<span>                         type_aggregation <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>                         block_length <span class="op">=</span> <span class="va">block_length</span>,</span>
<span>                         B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.60970  8.330033</span></span>
<span><span class="co">#&gt; Jun 2005 15.28662  8.770501</span></span>
<span><span class="co">#&gt; Jul 2005 15.82090  8.825455</span></span>
<span><span class="co">#&gt; Aug 2005 15.44171  8.529361</span></span>
<span><span class="co">#&gt; Sep 2005 14.87550  8.742633</span></span>
<span><span class="co">#&gt; Oct 2005 14.09964  8.622048</span></span>
<span><span class="co">#&gt; Nov 2005 13.92418  8.304806</span></span>
<span><span class="co">#&gt; Dec 2005 13.62465  7.969405</span></span>
<span><span class="co">#&gt; Jan 2006 13.54910  7.966639</span></span>
<span><span class="co">#&gt; Feb 2006 14.18640  8.336957</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 11.284682  6.625351</span></span>
<span><span class="co">#&gt; Jun 2005 11.618933  6.809767</span></span>
<span><span class="co">#&gt; Jul 2005 10.112785  6.640527</span></span>
<span><span class="co">#&gt; Aug 2005  9.371833  6.184479</span></span>
<span><span class="co">#&gt; Sep 2005 10.141396  6.618021</span></span>
<span><span class="co">#&gt; Oct 2005  9.561156  5.903869</span></span>
<span><span class="co">#&gt; Nov 2005  8.348534  5.414705</span></span>
<span><span class="co">#&gt; Dec 2005  7.958991  5.346780</span></span>
<span><span class="co">#&gt; Jan 2006 11.419964  6.787018</span></span>
<span><span class="co">#&gt; Feb 2006 12.396450  7.175092</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.50808  9.918497</span></span>
<span><span class="co">#&gt; Jun 2005 16.94469 10.244451</span></span>
<span><span class="co">#&gt; Jul 2005 18.16364 10.679442</span></span>
<span><span class="co">#&gt; Aug 2005 16.86994  9.488674</span></span>
<span><span class="co">#&gt; Sep 2005 16.76515  9.354212</span></span>
<span><span class="co">#&gt; Oct 2005 18.08387 10.495293</span></span>
<span><span class="co">#&gt; Nov 2005 17.70500 10.411962</span></span>
<span><span class="co">#&gt; Dec 2005 17.46861 10.530246</span></span>
<span><span class="co">#&gt; Jan 2006 16.89073 10.156283</span></span>
<span><span class="co">#&gt; Feb 2006 16.58249  9.913766</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.65568  8.170631</span></span>
<span><span class="co">#&gt; Jun 2005 15.44246  8.770501</span></span>
<span><span class="co">#&gt; Jul 2005 15.82090  8.925479</span></span>
<span><span class="co">#&gt; Aug 2005 16.86994  9.488674</span></span>
<span><span class="co">#&gt; Sep 2005 16.76515  9.354212</span></span>
<span><span class="co">#&gt; Oct 2005 16.76416  9.591219</span></span>
<span><span class="co">#&gt; Nov 2005 15.22016  8.853618</span></span>
<span><span class="co">#&gt; Dec 2005 14.60952  8.677937</span></span>
<span><span class="co">#&gt; Jan 2006 15.30061  9.416820</span></span>
<span><span class="co">#&gt; Feb 2006 13.52361  7.533837</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.056773  8.297685</span></span>
<span><span class="co">#&gt; Jun 2005 13.386146  8.119346</span></span>
<span><span class="co">#&gt; Jul 2005 11.109161  7.106661</span></span>
<span><span class="co">#&gt; Aug 2005 11.508545  7.619346</span></span>
<span><span class="co">#&gt; Sep 2005 12.324017  7.523734</span></span>
<span><span class="co">#&gt; Oct 2005 10.666345  5.880696</span></span>
<span><span class="co">#&gt; Nov 2005  9.177871  5.337395</span></span>
<span><span class="co">#&gt; Dec 2005 10.081605  5.793727</span></span>
<span><span class="co">#&gt; Jan 2006 12.682040  7.244926</span></span>
<span><span class="co">#&gt; Feb 2006 14.093067  7.728363</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.50808  9.918497</span></span>
<span><span class="co">#&gt; Jun 2005 16.94469  9.870393</span></span>
<span><span class="co">#&gt; Jul 2005 18.16364 10.506721</span></span>
<span><span class="co">#&gt; Aug 2005 16.38002  9.464296</span></span>
<span><span class="co">#&gt; Sep 2005 14.87550  8.742633</span></span>
<span><span class="co">#&gt; Oct 2005 13.43396  7.960560</span></span>
<span><span class="co">#&gt; Nov 2005 12.07161  7.425533</span></span>
<span><span class="co">#&gt; Dec 2005 15.04452  9.375929</span></span>
<span><span class="co">#&gt; Jan 2006 15.63635  9.389344</span></span>
<span><span class="co">#&gt; Feb 2006 17.01959 10.112834</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 10.79010  6.397701</span></span>
<span><span class="co">#&gt; Jun 2005 11.12156  6.429567</span></span>
<span><span class="co">#&gt; Jul 2005 13.44021  7.692609</span></span>
<span><span class="co">#&gt; Aug 2005 14.67239  8.065305</span></span>
<span><span class="co">#&gt; Sep 2005 15.64021  8.843371</span></span>
<span><span class="co">#&gt; Oct 2005 18.46701 10.757766</span></span>
<span><span class="co">#&gt; Nov 2005 16.25330  9.390495</span></span>
<span><span class="co">#&gt; Dec 2005 14.83137  8.735919</span></span>
<span><span class="co">#&gt; Jan 2006 14.16042  8.511056</span></span>
<span><span class="co">#&gt; Feb 2006 14.81706  9.228087</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.779884  8.903908</span></span>
<span><span class="co">#&gt; Jun 2005 15.130784 10.353048</span></span>
<span><span class="co">#&gt; Jul 2005  9.823514  6.505197</span></span>
<span><span class="co">#&gt; Aug 2005  9.116520  6.043308</span></span>
<span><span class="co">#&gt; Sep 2005 12.967380  8.314924</span></span>
<span><span class="co">#&gt; Oct 2005  9.262766  5.989567</span></span>
<span><span class="co">#&gt; Nov 2005  9.445788  5.680997</span></span>
<span><span class="co">#&gt; Dec 2005 11.852784  6.866066</span></span>
<span><span class="co">#&gt; Jan 2006 13.307223  7.313228</span></span>
<span><span class="co">#&gt; Feb 2006 14.954699  8.636863</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.65568  8.170631</span></span>
<span><span class="co">#&gt; Jun 2005 15.44246  8.770501</span></span>
<span><span class="co">#&gt; Jul 2005 15.82090  8.925479</span></span>
<span><span class="co">#&gt; Aug 2005 16.86994  9.488674</span></span>
<span><span class="co">#&gt; Sep 2005 16.76515  9.354212</span></span>
<span><span class="co">#&gt; Oct 2005 15.82983  8.492995</span></span>
<span><span class="co">#&gt; Nov 2005 18.12646 10.708517</span></span>
<span><span class="co">#&gt; Dec 2005 13.47189  7.021538</span></span>
<span><span class="co">#&gt; Jan 2006 11.84928  6.654077</span></span>
<span><span class="co">#&gt; Feb 2006 12.45684  7.070941</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.50808  9.918497</span></span>
<span><span class="co">#&gt; Jun 2005 16.94469  9.870393</span></span>
<span><span class="co">#&gt; Jul 2005 18.16364 10.506721</span></span>
<span><span class="co">#&gt; Aug 2005 16.38002  9.464296</span></span>
<span><span class="co">#&gt; Sep 2005 14.87550  8.742633</span></span>
<span><span class="co">#&gt; Oct 2005 14.76533  8.751102</span></span>
<span><span class="co">#&gt; Nov 2005 13.94432  8.426355</span></span>
<span><span class="co">#&gt; Dec 2005 11.53101  7.345869</span></span>
<span><span class="co">#&gt; Jan 2006 11.73108  7.747303</span></span>
<span><span class="co">#&gt; Feb 2006 12.37892  7.570202</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 12.98825  7.409480</span></span>
<span><span class="co">#&gt; Jun 2005 14.94851  8.503624</span></span>
<span><span class="co">#&gt; Jul 2005 15.85036  8.725431</span></span>
<span><span class="co">#&gt; Aug 2005 16.21102  8.993418</span></span>
<span><span class="co">#&gt; Sep 2005 16.65744  9.224845</span></span>
<span><span class="co">#&gt; Oct 2005 16.06604  9.021712</span></span>
<span><span class="co">#&gt; Nov 2005 13.90404  8.183257</span></span>
<span><span class="co">#&gt; Dec 2005 13.77742  8.592941</span></span>
<span><span class="co">#&gt; Jan 2006 13.79097  8.185974</span></span>
<span><span class="co">#&gt; Feb 2006 15.07691  9.144566</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.764566  8.442647</span></span>
<span><span class="co">#&gt; Jun 2005 13.332113  8.180072</span></span>
<span><span class="co">#&gt; Jul 2005 12.510554  7.777492</span></span>
<span><span class="co">#&gt; Aug 2005 10.251245  6.670737</span></span>
<span><span class="co">#&gt; Sep 2005 10.751945  7.205105</span></span>
<span><span class="co">#&gt; Oct 2005 12.003719  8.813966</span></span>
<span><span class="co">#&gt; Nov 2005  8.107758  5.940774</span></span>
<span><span class="co">#&gt; Dec 2005  7.342749  5.217021</span></span>
<span><span class="co">#&gt; Jan 2006 11.329640  7.450984</span></span>
<span><span class="co">#&gt; Feb 2006 13.109429  8.037051</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.563714  8.362382</span></span>
<span><span class="co">#&gt; Jun 2005 16.019922  9.488437</span></span>
<span><span class="co">#&gt; Jul 2005 16.113742 10.729587</span></span>
<span><span class="co">#&gt; Aug 2005 10.650913  6.794771</span></span>
<span><span class="co">#&gt; Sep 2005  9.964139  6.447577</span></span>
<span><span class="co">#&gt; Oct 2005 10.588947  5.983687</span></span>
<span><span class="co">#&gt; Nov 2005 14.640692  8.729005</span></span>
<span><span class="co">#&gt; Dec 2005 18.172384 10.865370</span></span>
<span><span class="co">#&gt; Jan 2006 17.254904 10.370966</span></span>
<span><span class="co">#&gt; Feb 2006 14.279724  8.655468</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 14.080025  8.217172</span></span>
<span><span class="co">#&gt; Feb 2002 14.097935  8.504100</span></span>
<span><span class="co">#&gt; Mar 2002 14.037980  8.254621</span></span>
<span><span class="co">#&gt; Apr 2002 14.080025  8.217172</span></span>
<span><span class="co">#&gt; May 2002 14.097935  8.504100</span></span>
<span><span class="co">#&gt; Jun 2002 13.400229  7.842877</span></span>
<span><span class="co">#&gt; Jul 2002 11.963099  7.227708</span></span>
<span><span class="co">#&gt; Aug 2002 12.483082  7.479137</span></span>
<span><span class="co">#&gt; Sep 2002 14.051200  8.267892</span></span>
<span><span class="co">#&gt; Oct 2002 15.653409  9.046206</span></span>
<span><span class="co">#&gt; Nov 2002 15.895374  9.120444</span></span>
<span><span class="co">#&gt; Dec 2002 16.246375  9.254438</span></span>
<span><span class="co">#&gt; Jan 2003 16.880238  9.544966</span></span>
<span><span class="co">#&gt; Feb 2003 17.003473  9.571713</span></span>
<span><span class="co">#&gt; Mar 2003 17.231948  9.639966</span></span>
<span><span class="co">#&gt; Apr 2003 16.195870  9.248908</span></span>
<span><span class="co">#&gt; May 2003 14.058413  8.543376</span></span>
<span><span class="co">#&gt; Jun 2003 13.651791  8.393671</span></span>
<span><span class="co">#&gt; Jul 2003 12.716624  8.056579</span></span>
<span><span class="co">#&gt; Aug 2003 12.646146  7.882686</span></span>
<span><span class="co">#&gt; Sep 2003 12.337320  7.628455</span></span>
<span><span class="co">#&gt; Oct 2003 10.858041  6.918282</span></span>
<span><span class="co">#&gt; Nov 2003 10.947373  7.048306</span></span>
<span><span class="co">#&gt; Dec 2003 12.300163  7.539882</span></span>
<span><span class="co">#&gt; Jan 2004 12.920135  8.002056</span></span>
<span><span class="co">#&gt; Feb 2004 10.524137  7.198956</span></span>
<span><span class="co">#&gt; Mar 2004 10.198641  6.670517</span></span>
<span><span class="co">#&gt; Apr 2004  9.921236  6.478631</span></span>
<span><span class="co">#&gt; May 2004 12.093310  7.711550</span></span>
<span><span class="co">#&gt; Jun 2004 13.435713  8.168927</span></span>
<span><span class="co">#&gt; Jul 2004 14.330379  8.636496</span></span>
<span><span class="co">#&gt; Aug 2004 13.676214  8.257946</span></span>
<span><span class="co">#&gt; Sep 2004 12.711040  7.946941</span></span>
<span><span class="co">#&gt; Oct 2004 12.438696  7.709987</span></span>
<span><span class="co">#&gt; Nov 2004 12.493577  7.932898</span></span>
<span><span class="co">#&gt; Dec 2004 13.094054  7.775530</span></span>
<span><span class="co">#&gt; Jan 2005 14.800106  8.733646</span></span>
<span><span class="co">#&gt; Feb 2005 16.091897  9.445771</span></span>
<span><span class="co">#&gt; Mar 2005 15.560027  9.180879</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;                Quotes   TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.307114839  1.22639837</span></span>
<span><span class="co">#&gt; Feb 2002 -0.868364597 -0.96984988</span></span>
<span><span class="co">#&gt; Mar 2002 -1.067329559 -1.04189553</span></span>
<span><span class="co">#&gt; Apr 2002  1.307114839  1.22639837</span></span>
<span><span class="co">#&gt; May 2002 -2.375054597 -2.08888488</span></span>
<span><span class="co">#&gt; Jun 2002 -3.338459123 -2.03588722</span></span>
<span><span class="co">#&gt; Jul 2002 -1.140308873 -1.02410785</span></span>
<span><span class="co">#&gt; Aug 2002  0.803987736  0.10729330</span></span>
<span><span class="co">#&gt; Sep 2002  0.527119680 -0.26295692</span></span>
<span><span class="co">#&gt; Oct 2002 -0.047988643 -0.21122600</span></span>
<span><span class="co">#&gt; Nov 2002  0.039776086 -0.16318896</span></span>
<span><span class="co">#&gt; Dec 2002  0.748484692  0.27855217</span></span>
<span><span class="co">#&gt; Jan 2003 -0.002027973 -0.15201590</span></span>
<span><span class="co">#&gt; Feb 2003 -0.552192724 -0.65315272</span></span>
<span><span class="co">#&gt; Mar 2003 -1.950768084 -1.26584601</span></span>
<span><span class="co">#&gt; Apr 2003 -0.306860047  0.59559733</span></span>
<span><span class="co">#&gt; May 2003  1.619056967  1.30601353</span></span>
<span><span class="co">#&gt; Jun 2003 -0.363991107  0.00905855</span></span>
<span><span class="co">#&gt; Jul 2003 -0.071784477 -0.13590381</span></span>
<span><span class="co">#&gt; Aug 2003 -0.818435582 -0.44660102</span></span>
<span><span class="co">#&gt; Sep 2003 -2.645480110 -1.28796505</span></span>
<span><span class="co">#&gt; Oct 2003 -0.553891055  0.02171253</span></span>
<span><span class="co">#&gt; Nov 2003  0.435156765 -0.07120594</span></span>
<span><span class="co">#&gt; Dec 2003  0.651326753  0.47031930</span></span>
<span><span class="co">#&gt; Jan 2004  0.710784799  1.56340435</span></span>
<span><span class="co">#&gt; Feb 2004 -1.403156976 -0.92644608</span></span>
<span><span class="co">#&gt; Mar 2004 -1.803961042 -0.96302233</span></span>
<span><span class="co">#&gt; Apr 2004  2.379523900  1.48490908</span></span>
<span><span class="co">#&gt; May 2004  1.755000239  0.78267104</span></span>
<span><span class="co">#&gt; Jun 2004  2.526746719  1.62015783</span></span>
<span><span class="co">#&gt; Jul 2004 -0.132999437  0.05632932</span></span>
<span><span class="co">#&gt; Aug 2004 -0.816993774 -0.20071589</span></span>
<span><span class="co">#&gt; Sep 2004 -0.622669658 -0.35794574</span></span>
<span><span class="co">#&gt; Oct 2004  0.495054063  0.53489384</span></span>
<span><span class="co">#&gt; Nov 2004 -0.771226686 -1.25735840</span></span>
<span><span class="co">#&gt; Dec 2004  2.377205824  1.44407360</span></span>
<span><span class="co">#&gt; Jan 2005  3.638874496  2.23015367</span></span>
<span><span class="co">#&gt; Feb 2005  1.399962612  1.01051877</span></span>
<span><span class="co">#&gt; Mar 2005 -1.068346882 -0.45227882</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 1.557655</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 2.232715e-17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;       Quotes    TV.advert xreg_cluster </span></span>
<span><span class="co">#&gt;    3.0295614    1.4590629    0.1843407 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res14</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9864921 0.5720541</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res14</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes           TV.advert      </span></span>
<span><span class="co">#&gt;  Min.   :-3.33846   Min.   :-2.0889  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.84340   1st Qu.:-0.7898  </span></span>
<span><span class="co">#&gt;  Median :-0.07178   Median :-0.1359  </span></span>
<span><span class="co">#&gt;  Mean   : 0.00000   Mean   : 0.0000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.77624   3rd Qu.: 0.6891  </span></span>
<span><span class="co">#&gt;  Max.   : 3.63887   Max.   : 2.2302</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res14</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.0461306 0.2610091</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res14</span>, <span class="st">"Quotes"</span>, type <span class="op">=</span> <span class="st">"dist"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/movingblockbootstrap-median-kmeans-1.png" width="691.2"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res14</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/movingblockbootstrap-median-kmeans-2.png" width="691.2"></p>
</div>
</div>
<div class="section level2">
<h2 id="prediction-intervals-based-on-r-vine-copula-simulation">5 - Prediction intervals based on R-Vine copula simulation<a class="anchor" aria-label="anchor" href="#prediction-intervals-based-on-r-vine-copula-simulation"></a>
</h2>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                         type_pi <span class="op">=</span> <span class="st">"rvinecopula"</span>, </span>
<span>                         B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.31002  9.226379</span></span>
<span><span class="co">#&gt; Jun 2005 14.79886  8.907883</span></span>
<span><span class="co">#&gt; Jul 2005 14.69090  8.827267</span></span>
<span><span class="co">#&gt; Aug 2005 13.84373  8.454779</span></span>
<span><span class="co">#&gt; Sep 2005 14.24753  8.815409</span></span>
<span><span class="co">#&gt; Oct 2005 14.34184  8.562135</span></span>
<span><span class="co">#&gt; Nov 2005 14.27625  8.705987</span></span>
<span><span class="co">#&gt; Dec 2005 13.68829  8.423866</span></span>
<span><span class="co">#&gt; Jan 2006 13.43270  8.073619</span></span>
<span><span class="co">#&gt; Feb 2006 14.13381  8.591550</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.36799  8.113840</span></span>
<span><span class="co">#&gt; Jun 2005 11.38913  7.103785</span></span>
<span><span class="co">#&gt; Jul 2005 13.71769  8.065010</span></span>
<span><span class="co">#&gt; Aug 2005 11.21805  6.285053</span></span>
<span><span class="co">#&gt; Sep 2005 12.75942  7.497283</span></span>
<span><span class="co">#&gt; Oct 2005 12.01240  6.759396</span></span>
<span><span class="co">#&gt; Nov 2005 12.00517  7.184455</span></span>
<span><span class="co">#&gt; Dec 2005 11.98408  6.689318</span></span>
<span><span class="co">#&gt; Jan 2006 11.33370  6.726070</span></span>
<span><span class="co">#&gt; Feb 2006 11.49345  7.273658</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.41644 10.773176</span></span>
<span><span class="co">#&gt; Jun 2005 17.02214 10.527019</span></span>
<span><span class="co">#&gt; Jul 2005 15.93492  9.663288</span></span>
<span><span class="co">#&gt; Aug 2005 17.10199 10.801843</span></span>
<span><span class="co">#&gt; Sep 2005 15.73552  9.983540</span></span>
<span><span class="co">#&gt; Oct 2005 16.10716  9.894525</span></span>
<span><span class="co">#&gt; Nov 2005 15.71202  9.710339</span></span>
<span><span class="co">#&gt; Dec 2005 15.41633  9.427269</span></span>
<span><span class="co">#&gt; Jan 2006 15.27358  9.197813</span></span>
<span><span class="co">#&gt; Feb 2006 15.84641  9.555500</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.30454  7.922151</span></span>
<span><span class="co">#&gt; Jun 2005 15.39684  9.474422</span></span>
<span><span class="co">#&gt; Jul 2005 13.61132  8.018403</span></span>
<span><span class="co">#&gt; Aug 2005 14.79509  8.853827</span></span>
<span><span class="co">#&gt; Sep 2005 14.86888  9.087402</span></span>
<span><span class="co">#&gt; Oct 2005 16.02594  9.976760</span></span>
<span><span class="co">#&gt; Nov 2005 15.18795  9.697184</span></span>
<span><span class="co">#&gt; Dec 2005 14.10462  8.661040</span></span>
<span><span class="co">#&gt; Jan 2006 15.50597  9.328438</span></span>
<span><span class="co">#&gt; Feb 2006 13.85247  7.707187</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.16700  8.873611</span></span>
<span><span class="co">#&gt; Jun 2005 14.13293  7.794348</span></span>
<span><span class="co">#&gt; Jul 2005 15.02135  8.761327</span></span>
<span><span class="co">#&gt; Aug 2005 12.10252  7.190436</span></span>
<span><span class="co">#&gt; Sep 2005 12.61971  7.407260</span></span>
<span><span class="co">#&gt; Oct 2005 14.26606  8.819319</span></span>
<span><span class="co">#&gt; Nov 2005 14.69218  8.938429</span></span>
<span><span class="co">#&gt; Dec 2005 14.34228  8.756040</span></span>
<span><span class="co">#&gt; Jan 2006 10.96740  6.436479</span></span>
<span><span class="co">#&gt; Feb 2006 14.43336  8.809632</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.11036  8.774100</span></span>
<span><span class="co">#&gt; Jun 2005 10.59254  6.903299</span></span>
<span><span class="co">#&gt; Jul 2005 14.97116  9.042900</span></span>
<span><span class="co">#&gt; Aug 2005 15.09260  9.808833</span></span>
<span><span class="co">#&gt; Sep 2005 14.19820  8.952254</span></span>
<span><span class="co">#&gt; Oct 2005 15.35600  9.529417</span></span>
<span><span class="co">#&gt; Nov 2005 14.31119  8.667339</span></span>
<span><span class="co">#&gt; Dec 2005 12.18599  7.624836</span></span>
<span><span class="co">#&gt; Jan 2006 14.07058  8.522981</span></span>
<span><span class="co">#&gt; Feb 2006 15.09665  9.428995</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.62871  9.125950</span></span>
<span><span class="co">#&gt; Jun 2005 16.38452 10.189155</span></span>
<span><span class="co">#&gt; Jul 2005 16.14851  9.798552</span></span>
<span><span class="co">#&gt; Aug 2005 13.84074  8.374269</span></span>
<span><span class="co">#&gt; Sep 2005 15.34916  9.348647</span></span>
<span><span class="co">#&gt; Oct 2005 15.78587  9.336611</span></span>
<span><span class="co">#&gt; Nov 2005 14.22790  8.189069</span></span>
<span><span class="co">#&gt; Dec 2005 11.92546  6.417716</span></span>
<span><span class="co">#&gt; Jan 2006 12.99929  8.274889</span></span>
<span><span class="co">#&gt; Feb 2006 11.36920  7.172730</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.57734  9.316228</span></span>
<span><span class="co">#&gt; Jun 2005 15.48842  9.271059</span></span>
<span><span class="co">#&gt; Jul 2005 15.19923  9.197380</span></span>
<span><span class="co">#&gt; Aug 2005 14.81119  9.556891</span></span>
<span><span class="co">#&gt; Sep 2005 13.24064  8.785248</span></span>
<span><span class="co">#&gt; Oct 2005 12.35213  6.925970</span></span>
<span><span class="co">#&gt; Nov 2005 11.99369  7.081032</span></span>
<span><span class="co">#&gt; Dec 2005 14.31366  8.795979</span></span>
<span><span class="co">#&gt; Jan 2006 14.47314  8.747883</span></span>
<span><span class="co">#&gt; Feb 2006 15.89136  9.490070</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.97411  9.106063</span></span>
<span><span class="co">#&gt; Jun 2005 17.20726 10.625109</span></span>
<span><span class="co">#&gt; Jul 2005 14.50950  8.691795</span></span>
<span><span class="co">#&gt; Aug 2005 14.11632  8.408133</span></span>
<span><span class="co">#&gt; Sep 2005 13.98775  8.495862</span></span>
<span><span class="co">#&gt; Oct 2005 11.91377  6.711036</span></span>
<span><span class="co">#&gt; Nov 2005 12.04474  7.540691</span></span>
<span><span class="co">#&gt; Dec 2005 12.51957  7.633600</span></span>
<span><span class="co">#&gt; Jan 2006 13.84837  7.779032</span></span>
<span><span class="co">#&gt; Feb 2006 15.11033  9.023259</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.97313  8.935483</span></span>
<span><span class="co">#&gt; Jun 2005 14.82365  8.982032</span></span>
<span><span class="co">#&gt; Jul 2005 14.32267  8.273417</span></span>
<span><span class="co">#&gt; Aug 2005 12.57208  7.749678</span></span>
<span><span class="co">#&gt; Sep 2005 15.51601  9.664412</span></span>
<span><span class="co">#&gt; Oct 2005 13.70746  7.888991</span></span>
<span><span class="co">#&gt; Nov 2005 15.22292  9.168991</span></span>
<span><span class="co">#&gt; Dec 2005 13.76598  8.928246</span></span>
<span><span class="co">#&gt; Jan 2006 13.11415  7.870575</span></span>
<span><span class="co">#&gt; Feb 2006 13.70643  8.547298</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.58655  9.243993</span></span>
<span><span class="co">#&gt; Jun 2005 14.86911  8.758953</span></span>
<span><span class="co">#&gt; Jul 2005 14.08406  8.225544</span></span>
<span><span class="co">#&gt; Aug 2005 12.46013  7.493386</span></span>
<span><span class="co">#&gt; Sep 2005 15.79925 10.076191</span></span>
<span><span class="co">#&gt; Oct 2005 16.13074  9.611269</span></span>
<span><span class="co">#&gt; Nov 2005 14.88994  9.307531</span></span>
<span><span class="co">#&gt; Dec 2005 14.72159  9.411932</span></span>
<span><span class="co">#&gt; Jan 2006 12.59542  7.844081</span></span>
<span><span class="co">#&gt; Feb 2006 15.69158  9.574496</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.93061  9.955696</span></span>
<span><span class="co">#&gt; Jun 2005 14.72513  8.466719</span></span>
<span><span class="co">#&gt; Jul 2005 14.73991  9.195801</span></span>
<span><span class="co">#&gt; Aug 2005 17.68536 11.090136</span></span>
<span><span class="co">#&gt; Sep 2005 13.24996  7.807364</span></span>
<span><span class="co">#&gt; Oct 2005 13.71088  8.620053</span></span>
<span><span class="co">#&gt; Nov 2005 14.33793  8.755450</span></span>
<span><span class="co">#&gt; Dec 2005 15.61802  9.431722</span></span>
<span><span class="co">#&gt; Jan 2006 13.81751  8.208286</span></span>
<span><span class="co">#&gt; Feb 2006 14.26531  8.540535</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.84780 11.010509</span></span>
<span><span class="co">#&gt; Jun 2005 14.36824  8.613730</span></span>
<span><span class="co">#&gt; Jul 2005 14.30128  9.067548</span></span>
<span><span class="co">#&gt; Aug 2005 10.96127  6.022200</span></span>
<span><span class="co">#&gt; Sep 2005 13.64573  8.529455</span></span>
<span><span class="co">#&gt; Oct 2005 14.16951  8.201922</span></span>
<span><span class="co">#&gt; Nov 2005 15.85402  9.714159</span></span>
<span><span class="co">#&gt; Dec 2005 13.38572  8.577552</span></span>
<span><span class="co">#&gt; Jan 2006 12.93521  7.723549</span></span>
<span><span class="co">#&gt; Feb 2006 11.92145  7.621296</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $fitted</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 13.983454  8.113042</span></span>
<span><span class="co">#&gt; Feb 2002 14.310140  8.680078</span></span>
<span><span class="co">#&gt; Mar 2002 14.204085  8.367422</span></span>
<span><span class="co">#&gt; Apr 2002 13.983454  8.113042</span></span>
<span><span class="co">#&gt; May 2002 14.310140  8.680078</span></span>
<span><span class="co">#&gt; Jun 2002 13.136549  7.573500</span></span>
<span><span class="co">#&gt; Jul 2002 12.139564  7.269130</span></span>
<span><span class="co">#&gt; Aug 2002 12.630260  7.516240</span></span>
<span><span class="co">#&gt; Sep 2002 14.247551  8.406368</span></span>
<span><span class="co">#&gt; Oct 2002 15.085483  8.610639</span></span>
<span><span class="co">#&gt; Nov 2002 15.834616  9.129753</span></span>
<span><span class="co">#&gt; Dec 2002 16.037153  9.175375</span></span>
<span><span class="co">#&gt; Jan 2003 16.609951  9.409639</span></span>
<span><span class="co">#&gt; Feb 2003 16.579674  9.347087</span></span>
<span><span class="co">#&gt; Mar 2003 16.452555  9.136445</span></span>
<span><span class="co">#&gt; Apr 2003 15.691303  8.874788</span></span>
<span><span class="co">#&gt; May 2003 14.054876  8.529575</span></span>
<span><span class="co">#&gt; Jun 2003 13.434843  8.229103</span></span>
<span><span class="co">#&gt; Jul 2003 12.715293  7.977976</span></span>
<span><span class="co">#&gt; Aug 2003 12.998432  8.104914</span></span>
<span><span class="co">#&gt; Sep 2003 12.590713  7.879126</span></span>
<span><span class="co">#&gt; Oct 2003 10.931512  7.005044</span></span>
<span><span class="co">#&gt; Nov 2003 10.416928  6.781919</span></span>
<span><span class="co">#&gt; Dec 2003 13.045036  8.079712</span></span>
<span><span class="co">#&gt; Jan 2004 13.471769  8.342884</span></span>
<span><span class="co">#&gt; Feb 2004  8.822228  6.015318</span></span>
<span><span class="co">#&gt; Mar 2004  9.707979  6.398258</span></span>
<span><span class="co">#&gt; Apr 2004  9.811491  6.420448</span></span>
<span><span class="co">#&gt; May 2004 11.936553  7.582567</span></span>
<span><span class="co">#&gt; Jun 2004 13.921151  8.555557</span></span>
<span><span class="co">#&gt; Jul 2004 14.494976  8.746341</span></span>
<span><span class="co">#&gt; Aug 2004 14.079472  8.618854</span></span>
<span><span class="co">#&gt; Sep 2004 13.046936  8.135087</span></span>
<span><span class="co">#&gt; Oct 2004 12.726572  7.953926</span></span>
<span><span class="co">#&gt; Nov 2004 12.426974  7.834539</span></span>
<span><span class="co">#&gt; Dec 2004 13.211185  7.811190</span></span>
<span><span class="co">#&gt; Jan 2005 15.485788  9.264229</span></span>
<span><span class="co">#&gt; Feb 2005 16.598686  9.685778</span></span>
<span><span class="co">#&gt; Mar 2005 16.037908  9.448414</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;               Quotes   TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002  1.40368643  1.33052782</span></span>
<span><span class="co">#&gt; Feb 2002 -1.08056990 -1.14582835</span></span>
<span><span class="co">#&gt; Mar 2002 -1.23343504 -1.15469695</span></span>
<span><span class="co">#&gt; Apr 2002  1.40368643  1.33052782</span></span>
<span><span class="co">#&gt; May 2002 -2.58725990 -2.26486335</span></span>
<span><span class="co">#&gt; Jun 2002 -3.07477874 -1.76651025</span></span>
<span><span class="co">#&gt; Jul 2002 -1.31677412 -1.06553020</span></span>
<span><span class="co">#&gt; Aug 2002  0.65681006  0.07019039</span></span>
<span><span class="co">#&gt; Sep 2002  0.33076863 -0.40143292</span></span>
<span><span class="co">#&gt; Oct 2002  0.51993723  0.22434076</span></span>
<span><span class="co">#&gt; Nov 2002  0.10053432 -0.17249791</span></span>
<span><span class="co">#&gt; Dec 2002  0.95770684  0.35761548</span></span>
<span><span class="co">#&gt; Jan 2003  0.26825909 -0.01668861</span></span>
<span><span class="co">#&gt; Feb 2003 -0.12839403 -0.42852687</span></span>
<span><span class="co">#&gt; Mar 2003 -1.17137522 -0.76232506</span></span>
<span><span class="co">#&gt; Apr 2003  0.19770654  0.96971721</span></span>
<span><span class="co">#&gt; May 2003  1.62259434  1.31981494</span></span>
<span><span class="co">#&gt; Jun 2003 -0.14704277  0.17362676</span></span>
<span><span class="co">#&gt; Jul 2003 -0.07045343 -0.05730098</span></span>
<span><span class="co">#&gt; Aug 2003 -1.17072203 -0.66882907</span></span>
<span><span class="co">#&gt; Sep 2003 -2.89887258 -1.53863637</span></span>
<span><span class="co">#&gt; Oct 2003 -0.62736155 -0.06504866</span></span>
<span><span class="co">#&gt; Nov 2003  0.96560231  0.19518092</span></span>
<span><span class="co">#&gt; Dec 2003 -0.09354593 -0.06951135</span></span>
<span><span class="co">#&gt; Jan 2004  0.15915097  1.22257588</span></span>
<span><span class="co">#&gt; Feb 2004  0.29875209  0.25719228</span></span>
<span><span class="co">#&gt; Mar 2004 -1.31329880 -0.69076345</span></span>
<span><span class="co">#&gt; Apr 2004  2.48926902  1.54309187</span></span>
<span><span class="co">#&gt; May 2004  1.91175656  0.91165371</span></span>
<span><span class="co">#&gt; Jun 2004  2.04130891  1.23352769</span></span>
<span><span class="co">#&gt; Jul 2004 -0.29759583 -0.05351566</span></span>
<span><span class="co">#&gt; Aug 2004 -1.22025180 -0.56162404</span></span>
<span><span class="co">#&gt; Sep 2004 -0.95856611 -0.54609232</span></span>
<span><span class="co">#&gt; Oct 2004  0.20717781  0.29095534</span></span>
<span><span class="co">#&gt; Nov 2004 -0.70462371 -1.15899926</span></span>
<span><span class="co">#&gt; Dec 2004  2.26007518  1.40841386</span></span>
<span><span class="co">#&gt; Jan 2005  2.95319223  1.69957104</span></span>
<span><span class="co">#&gt; Feb 2005  0.89317411  0.77051186</span></span>
<span><span class="co">#&gt; Mar 2005 -1.54622760 -0.71981400</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $copula</span></span>
<span><span class="co">#&gt; $copula$params</span></span>
<span><span class="co">#&gt; $copula$params$Quotes</span></span>
<span><span class="co">#&gt;        mean             sd      </span></span>
<span><span class="co">#&gt;   -4.099785e-16    1.409030e+00 </span></span>
<span><span class="co">#&gt;  ( 2.256254e-01) ( 1.595412e-01)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $copula$params$TV.advert</span></span>
<span><span class="co">#&gt;        mean             sd      </span></span>
<span><span class="co">#&gt;   -2.733218e-16    9.751965e-01 </span></span>
<span><span class="co">#&gt;  ( 1.561564e-01) ( 1.104193e-01)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $copula$distro</span></span>
<span><span class="co">#&gt; [1] "normal"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $copula$RVM_U</span></span>
<span><span class="co">#&gt; C-vine copula with the following pair-copulas:</span></span>
<span><span class="co">#&gt; Tree 1:</span></span>
<span><span class="co">#&gt; 1,2  Gumbel (par = 4.19, tau = 0.76) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; 1 &lt;-&gt; Quotes,   2 &lt;-&gt; TV.advert,   1 &lt;-&gt; Quotes,</span></span>
<span><span class="co">#&gt; 2 &lt;-&gt; TV.advert</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $margins</span></span>
<span><span class="co">#&gt; [1] "gaussian"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv</span></span>
<span><span class="co">#&gt; [1] 1.924173</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weighted_loocv</span></span>
<span><span class="co">#&gt; [1] 3.601775e-17</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $loocv_per_series</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt;  2.601976  1.246370 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj</span>, <span class="st">"Quotes"</span>, type <span class="op">=</span> <span class="st">"dist"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/RVineCopula-1.png" width="691.2"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">obj</span>, <span class="st">"TV.advert"</span>, type <span class="op">=</span> <span class="st">"sims"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/RVineCopula-2.png" width="691.2"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by T. Moudiki.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
