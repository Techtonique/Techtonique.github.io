<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prediction intervals for multivariate time series (simulation-based) • ahead</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/darkly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Prediction intervals for multivariate time series (simulation-based)">
<meta property="og:description" content="ahead">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ahead</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ahead-loess-forecasting.html">Prediction intervals for Loess forecasting (simulation-based)</a>
    </li>
    <li>
      <a href="../articles/ahead-ridge2-prediction-intervals.html">Prediction intervals for multivariate time series (simulation-based)</a>
    </li>
    <li>
      <a href="../articles/ahead-vignette.html">Introduction to R package `ahead`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../../"></a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Techtonique/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Prediction intervals for multivariate time
series (simulation-based)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Techtonique/ahead/vignettes/ahead-ridge2-prediction-intervals.Rmd" class="external-link"><code>vignettes/ahead-ridge2-prediction-intervals.Rmd</code></a></small>
      <div class="hidden name"><code>ahead-ridge2-prediction-intervals.Rmd</code></div>

    </div>

    
    
<p><code>ahead</code> is a package for <strong>univariate</strong> and
<strong>multivariate time series forecasting</strong>, with uncertainty
quantification (R and <a href="https://techtonique.github.io/ahead_python/">Python</a>).</p>
<p>The model used is in this demo is the one presented in <a href="https://www.mdpi.com/2227-9091/6/1/22" class="external-link">this paper</a>, and has
actually been significantly improved since 2018, as you’ll see here.</p>
<p>Currently for this model (as of 2023-08-12), for <strong>uncertainty
quantification</strong>, options are a Gaussian distribution for the
residuals or bootstrap aggregation:</p>
<ul>
<li>Gaussian</li>
<li>Independent <strong>bootstrap</strong>
</li>
<li>Multivariate circular <strong>block bootstrap</strong>
</li>
<li>
<strong>More options to come</strong> in the future.</li>
</ul>
<p>Please remember that <em>in real life</em>, this model’s
hyperparameters will have to be tuned.</p>
<p><strong>Contents:</strong></p>
<ul>
<li>0 - Install <code>ahead</code>
</li>
<li>1 - Prediction intervals based on <strong>Gaussian</strong>
distribution (meh, but quick)</li>
<li>2 - Prediction intervals based on <strong>independent
bootstrap</strong>
</li>
<li>3 - Prediction intervals based on <strong>block
bootstrap</strong>
</li>
</ul>
<div class="section level2">
<h2 id="install-ahead">0 - Install <code>ahead</code><a class="anchor" aria-label="anchor" href="#install-ahead"></a>
</h2>
<p>Here’s how to install the R version of the package:</p>
<ul>
<li>
<p><strong>1st method</strong>: from <a href="https://techtonique.r-universe.dev" class="external-link">R-universe</a></p>
<p>In R console:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>repos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    techtonique <span class="op">=</span> <span class="st">'https://techtonique.r-universe.dev'</span>,</span>
<span>    CRAN <span class="op">=</span> <span class="st">'https://cloud.r-project.org'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ahead"</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p><strong>2nd method</strong>: from <a href="https://github.com/Techtonique/ahead" class="external-link">Github</a></p>
<p>In R console:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"Techtonique/ahead"</span><span class="op">)</span></span></code></pre></div>
<p>Or</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"Techtonique/ahead"</span><span class="op">)</span></span></code></pre></div>
</li>
</ul>
<p>And here are the packages that will be used in this vignette:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ahead</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://otexts.com/fpp/" class="external-link">fpp</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="prediction-intervals-based-on-gaussian-distribution-meh-but-quick">1 - Prediction intervals based on Gaussian distribution (meh, but
quick)<a class="anchor" aria-label="anchor" href="#prediction-intervals-based-on-gaussian-distribution-meh-but-quick"></a>
</h2>
<div class="section level3">
<h3 id="with-default-parameters">1 - 1 With default parameters<a class="anchor" aria-label="anchor" href="#with-default-parameters"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fl">10L</span> <span class="co"># forecasting horizon</span></span>
<span></span>
<span><span class="op">(</span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.76393  8.947782</span></span>
<span><span class="co">#&gt; Jun 2005 14.61841  8.862613</span></span>
<span><span class="co">#&gt; Jul 2005 14.56234  8.841193</span></span>
<span><span class="co">#&gt; Aug 2005 14.49305  8.809091</span></span>
<span><span class="co">#&gt; Sep 2005 14.43100  8.781208</span></span>
<span><span class="co">#&gt; Oct 2005 14.37179  8.754418</span></span>
<span><span class="co">#&gt; Nov 2005 14.31606  8.729243</span></span>
<span><span class="co">#&gt; Dec 2005 14.26346  8.705474</span></span>
<span><span class="co">#&gt; Jan 2006 14.21385  8.683054</span></span>
<span><span class="co">#&gt; Feb 2006 14.16704  8.661902</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 11.96618  7.011446</span></span>
<span><span class="co">#&gt; Jun 2005 11.82066  6.926276</span></span>
<span><span class="co">#&gt; Jul 2005 11.76459  6.904857</span></span>
<span><span class="co">#&gt; Aug 2005 11.69530  6.872755</span></span>
<span><span class="co">#&gt; Sep 2005 11.63325  6.844872</span></span>
<span><span class="co">#&gt; Oct 2005 11.57404  6.818082</span></span>
<span><span class="co">#&gt; Nov 2005 11.51831  6.792907</span></span>
<span><span class="co">#&gt; Dec 2005 11.46571  6.769138</span></span>
<span><span class="co">#&gt; Jan 2006 11.41610  6.746718</span></span>
<span><span class="co">#&gt; Feb 2006 11.36929  6.725566</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.56168  10.88412</span></span>
<span><span class="co">#&gt; Jun 2005 17.41616  10.79895</span></span>
<span><span class="co">#&gt; Jul 2005 17.36009  10.77753</span></span>
<span><span class="co">#&gt; Aug 2005 17.29080  10.74543</span></span>
<span><span class="co">#&gt; Sep 2005 17.22875  10.71754</span></span>
<span><span class="co">#&gt; Oct 2005 17.16954  10.69075</span></span>
<span><span class="co">#&gt; Nov 2005 17.11381  10.66558</span></span>
<span><span class="co">#&gt; Dec 2005 17.06121  10.64181</span></span>
<span><span class="co">#&gt; Jan 2006 17.01160  10.61939</span></span>
<span><span class="co">#&gt; Feb 2006 16.96479  10.59824</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;            Quotes   TV.advert</span></span>
<span><span class="co">#&gt;  [1,]  1.40368643  1.33052782</span></span>
<span><span class="co">#&gt;  [2,] -1.08056990 -1.14582835</span></span>
<span><span class="co">#&gt;  [3,] -1.23343504 -1.15469695</span></span>
<span><span class="co">#&gt;  [4,]  1.40368643  1.33052782</span></span>
<span><span class="co">#&gt;  [5,] -2.58725990 -2.26486335</span></span>
<span><span class="co">#&gt;  [6,] -3.07477874 -1.76651025</span></span>
<span><span class="co">#&gt;  [7,] -1.31677412 -1.06553020</span></span>
<span><span class="co">#&gt;  [8,]  0.65681006  0.07019039</span></span>
<span><span class="co">#&gt;  [9,]  0.33076863 -0.40143292</span></span>
<span><span class="co">#&gt; [10,]  0.51993723  0.22434076</span></span>
<span><span class="co">#&gt; [11,]  0.10053432 -0.17249791</span></span>
<span><span class="co">#&gt; [12,]  0.95770684  0.35761548</span></span>
<span><span class="co">#&gt; [13,]  0.26825909 -0.01668861</span></span>
<span><span class="co">#&gt; [14,] -0.12839403 -0.42852687</span></span>
<span><span class="co">#&gt; [15,] -1.17137522 -0.76232506</span></span>
<span><span class="co">#&gt; [16,]  0.19770654  0.96971721</span></span>
<span><span class="co">#&gt; [17,]  1.62259434  1.31981494</span></span>
<span><span class="co">#&gt; [18,] -0.14704277  0.17362676</span></span>
<span><span class="co">#&gt; [19,] -0.07045343 -0.05730098</span></span>
<span><span class="co">#&gt; [20,] -1.17072203 -0.66882907</span></span>
<span><span class="co">#&gt; [21,] -2.89887258 -1.53863637</span></span>
<span><span class="co">#&gt; [22,] -0.62736155 -0.06504866</span></span>
<span><span class="co">#&gt; [23,]  0.96560231  0.19518092</span></span>
<span><span class="co">#&gt; [24,] -0.09354593 -0.06951135</span></span>
<span><span class="co">#&gt; [25,]  0.15915097  1.22257588</span></span>
<span><span class="co">#&gt; [26,]  0.29875209  0.25719228</span></span>
<span><span class="co">#&gt; [27,] -1.31329880 -0.69076345</span></span>
<span><span class="co">#&gt; [28,]  2.48926902  1.54309187</span></span>
<span><span class="co">#&gt; [29,]  1.91175656  0.91165371</span></span>
<span><span class="co">#&gt; [30,]  2.04130891  1.23352769</span></span>
<span><span class="co">#&gt; [31,] -0.29759583 -0.05351566</span></span>
<span><span class="co">#&gt; [32,] -1.22025180 -0.56162404</span></span>
<span><span class="co">#&gt; [33,] -0.95856611 -0.54609232</span></span>
<span><span class="co">#&gt; [34,]  0.20717781  0.29095534</span></span>
<span><span class="co">#&gt; [35,] -0.70462371 -1.15899926</span></span>
<span><span class="co">#&gt; [36,]  2.26007518  1.40841386</span></span>
<span><span class="co">#&gt; [37,]  2.95319223  1.69957104</span></span>
<span><span class="co">#&gt; [38,]  0.89317411  0.77051186</span></span>
<span><span class="co">#&gt; [39,] -1.54622760 -0.71981400</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $coefficients</span></span>
<span><span class="co">#&gt;        Quotes   TV.advert</span></span>
<span><span class="co">#&gt; x1  0.4358443  0.18606264</span></span>
<span><span class="co">#&gt; x2  0.1361999  0.08192973</span></span>
<span><span class="co">#&gt; h1  0.2311472 -0.09036149</span></span>
<span><span class="co">#&gt; h2 -1.2318730 -0.60953989</span></span>
<span><span class="co">#&gt; h3 -0.1129694 -0.08956715</span></span>
<span><span class="co">#&gt; h4  0.4033300  0.15098381</span></span>
<span><span class="co">#&gt; h5 -0.4866789 -0.25350343</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert       </span></span>
<span><span class="co">#&gt;  Min.   :-3.0748   Min.   :-2.26486  </span></span>
<span><span class="co">#&gt;  1st Qu.:-1.1256   1st Qu.:-0.67980  </span></span>
<span><span class="co">#&gt;  Median : 0.1005   Median :-0.05352  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.00000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.9254   3rd Qu.: 0.84108  </span></span>
<span><span class="co">#&gt;  Max.   : 2.9532   Max.   : 1.69957</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># stationarity is overrated?:)</span></span>
<span><span class="co">#&gt;     Quotes  TV.advert </span></span>
<span><span class="co">#&gt; 0.06458106 0.32251812</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res1</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.7471878 0.3924569</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res1</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/gaussian-default-1.png" width="691.2"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res1</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/gaussian-default-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-external-regressors">1 - 2 With external regressors<a class="anchor" aria-label="anchor" href="#with-external-regressors"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">time</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, xreg <span class="op">=</span> <span class="va">xreg</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.45580  9.403836</span></span>
<span><span class="co">#&gt; Jun 2005 15.50296  9.542891</span></span>
<span><span class="co">#&gt; Jul 2005 15.24251  9.457418</span></span>
<span><span class="co">#&gt; Aug 2005 15.02165  9.351020</span></span>
<span><span class="co">#&gt; Sep 2005 14.95493  9.307973</span></span>
<span><span class="co">#&gt; Oct 2005 15.02539  9.335216</span></span>
<span><span class="co">#&gt; Nov 2005 15.17341  9.408039</span></span>
<span><span class="co">#&gt; Dec 2005 15.34645  9.499447</span></span>
<span><span class="co">#&gt; Jan 2006 15.51500  9.592048</span></span>
<span><span class="co">#&gt; Feb 2006 15.66959  9.678782</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 12.76518  7.579582</span></span>
<span><span class="co">#&gt; Jun 2005 12.81234  7.718637</span></span>
<span><span class="co">#&gt; Jul 2005 12.55189  7.633164</span></span>
<span><span class="co">#&gt; Aug 2005 12.33103  7.526766</span></span>
<span><span class="co">#&gt; Sep 2005 12.26431  7.483719</span></span>
<span><span class="co">#&gt; Oct 2005 12.33477  7.510962</span></span>
<span><span class="co">#&gt; Nov 2005 12.48279  7.583785</span></span>
<span><span class="co">#&gt; Dec 2005 12.65583  7.675193</span></span>
<span><span class="co">#&gt; Jan 2006 12.82438  7.767794</span></span>
<span><span class="co">#&gt; Feb 2006 12.97897  7.854528</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 18.14642  11.22809</span></span>
<span><span class="co">#&gt; Jun 2005 18.19359  11.36714</span></span>
<span><span class="co">#&gt; Jul 2005 17.93313  11.28167</span></span>
<span><span class="co">#&gt; Aug 2005 17.71227  11.17527</span></span>
<span><span class="co">#&gt; Sep 2005 17.64555  11.13223</span></span>
<span><span class="co">#&gt; Oct 2005 17.71601  11.15947</span></span>
<span><span class="co">#&gt; Nov 2005 17.86403  11.23229</span></span>
<span><span class="co">#&gt; Dec 2005 18.03707  11.32370</span></span>
<span><span class="co">#&gt; Jan 2006 18.20562  11.41630</span></span>
<span><span class="co">#&gt; Feb 2006 18.36021  11.50304</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;            Quotes    TV.advert</span></span>
<span><span class="co">#&gt;  [1,]  1.67535261  1.600318363</span></span>
<span><span class="co">#&gt;  [2,] -0.09454667  0.059245589</span></span>
<span><span class="co">#&gt;  [3,] -0.61710349 -0.617562341</span></span>
<span><span class="co">#&gt;  [4,]  1.55432930  1.431543276</span></span>
<span><span class="co">#&gt;  [5,] -1.65830176 -1.201288646</span></span>
<span><span class="co">#&gt;  [6,] -3.27721670 -1.999680352</span></span>
<span><span class="co">#&gt;  [7,] -0.83986146 -0.746117612</span></span>
<span><span class="co">#&gt;  [8,]  1.04485279  0.291750330</span></span>
<span><span class="co">#&gt;  [9,]  0.75352722 -0.155143365</span></span>
<span><span class="co">#&gt; [10,]  0.26745241  0.004965096</span></span>
<span><span class="co">#&gt; [11,]  0.43157027  0.102861987</span></span>
<span><span class="co">#&gt; [12,]  1.13693270  0.494399368</span></span>
<span><span class="co">#&gt; [13,]  0.49053241  0.135721074</span></span>
<span><span class="co">#&gt; [14,] -0.10253286 -0.465058629</span></span>
<span><span class="co">#&gt; [15,] -1.85353900 -1.312388835</span></span>
<span><span class="co">#&gt; [16,] -0.33001834  0.475005003</span></span>
<span><span class="co">#&gt; [17,]  2.16635830  1.749815332</span></span>
<span><span class="co">#&gt; [18,]  0.17739319  0.443529161</span></span>
<span><span class="co">#&gt; [19,]  0.27361734  0.111136601</span></span>
<span><span class="co">#&gt; [20,] -0.58111949 -0.379519019</span></span>
<span><span class="co">#&gt; [21,] -2.30767070 -1.246635836</span></span>
<span><span class="co">#&gt; [22,] -0.19353452  0.176564889</span></span>
<span><span class="co">#&gt; [23,]  1.00563207  0.187437814</span></span>
<span><span class="co">#&gt; [24,]  0.41917089  0.235645632</span></span>
<span><span class="co">#&gt; [25,]  0.52295932  1.364524163</span></span>
<span><span class="co">#&gt; [26,] -0.95933919 -0.673442252</span></span>
<span><span class="co">#&gt; [27,] -1.56353647 -0.843576594</span></span>
<span><span class="co">#&gt; [28,]  2.26526358  1.468847972</span></span>
<span><span class="co">#&gt; [29,]  1.69164304  0.697529740</span></span>
<span><span class="co">#&gt; [30,]  2.01008148  1.118934668</span></span>
<span><span class="co">#&gt; [31,] -0.38235687 -0.261094013</span></span>
<span><span class="co">#&gt; [32,] -1.39361339 -0.785256869</span></span>
<span><span class="co">#&gt; [33,] -1.33394033 -0.789489620</span></span>
<span><span class="co">#&gt; [34,] -0.37279705 -0.008190995</span></span>
<span><span class="co">#&gt; [35,] -1.43004502 -1.625855697</span></span>
<span><span class="co">#&gt; [36,]  0.16351013  0.242165460</span></span>
<span><span class="co">#&gt; [37,]  2.64510868  1.356646561</span></span>
<span><span class="co">#&gt; [38,]  0.59781674  0.490409659</span></span>
<span><span class="co">#&gt; [39,] -2.00203118 -1.128697062</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $coefficients</span></span>
<span><span class="co">#&gt;        Quotes  TV.advert</span></span>
<span><span class="co">#&gt; x1  1.5520048  0.6627858</span></span>
<span><span class="co">#&gt; x2 -1.6051784 -0.5784973</span></span>
<span><span class="co">#&gt; x3 -1.7090968 -0.5873351</span></span>
<span><span class="co">#&gt; h1  1.7017413  0.7132521</span></span>
<span><span class="co">#&gt; h2 -1.1790106 -0.5946307</span></span>
<span><span class="co">#&gt; h3 -0.7179868 -0.3862358</span></span>
<span><span class="co">#&gt; h4  0.6670119  0.1636983</span></span>
<span><span class="co">#&gt; h5 -0.3598980 -0.1534834</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert      </span></span>
<span><span class="co">#&gt;  Min.   :-3.2772   Min.   :-1.9997  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.8996   1st Qu.:-0.7098  </span></span>
<span><span class="co">#&gt;  Median : 0.1635   Median : 0.1029  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.0000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.8796   3rd Qu.: 0.4827  </span></span>
<span><span class="co">#&gt;  Max.   : 2.6451   Max.   : 1.7498</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.1553145 0.4247378</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9498845 0.5141136</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res2</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/gaussian-xreg-1.png" width="691.2"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res2</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/gaussian-xreg-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-external-regressors-and-k-means-clustering">1 - 3 With external regressors and K-Means clustering<a class="anchor" aria-label="anchor" href="#with-external-regressors-and-k-means-clustering"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">centers</span> <span class="op">&lt;-</span> <span class="fl">2L</span></span>
<span><span class="op">(</span><span class="va">res3</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, xreg <span class="op">=</span> <span class="va">xreg</span>, centers <span class="op">=</span> <span class="va">centers</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.85208 10.372047</span></span>
<span><span class="co">#&gt; Jun 2005 15.06174  9.371331</span></span>
<span><span class="co">#&gt; Jul 2005 14.71415  9.244101</span></span>
<span><span class="co">#&gt; Aug 2005 14.17693  8.942588</span></span>
<span><span class="co">#&gt; Sep 2005 14.15692  8.919681</span></span>
<span><span class="co">#&gt; Oct 2005 14.18453  8.928931</span></span>
<span><span class="co">#&gt; Nov 2005 14.41917  9.073567</span></span>
<span><span class="co">#&gt; Dec 2005 14.58104  9.188771</span></span>
<span><span class="co">#&gt; Jan 2006 14.75620  9.318539</span></span>
<span><span class="co">#&gt; Feb 2006 14.85389  9.404282</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.35980  8.635699</span></span>
<span><span class="co">#&gt; Jun 2005 12.56946  7.634984</span></span>
<span><span class="co">#&gt; Jul 2005 12.22187  7.507753</span></span>
<span><span class="co">#&gt; Aug 2005 11.68465  7.206241</span></span>
<span><span class="co">#&gt; Sep 2005 11.66464  7.183334</span></span>
<span><span class="co">#&gt; Oct 2005 11.69224  7.192584</span></span>
<span><span class="co">#&gt; Nov 2005 11.92689  7.337220</span></span>
<span><span class="co">#&gt; Dec 2005 12.08876  7.452424</span></span>
<span><span class="co">#&gt; Jan 2006 12.26392  7.582192</span></span>
<span><span class="co">#&gt; Feb 2006 12.36161  7.667934</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 19.34436  12.10839</span></span>
<span><span class="co">#&gt; Jun 2005 17.55402  11.10768</span></span>
<span><span class="co">#&gt; Jul 2005 17.20643  10.98045</span></span>
<span><span class="co">#&gt; Aug 2005 16.66921  10.67894</span></span>
<span><span class="co">#&gt; Sep 2005 16.64920  10.65603</span></span>
<span><span class="co">#&gt; Oct 2005 16.67681  10.66528</span></span>
<span><span class="co">#&gt; Nov 2005 16.91145  10.80991</span></span>
<span><span class="co">#&gt; Dec 2005 17.07332  10.92512</span></span>
<span><span class="co">#&gt; Jan 2006 17.24848  11.05489</span></span>
<span><span class="co">#&gt; Feb 2006 17.34617  11.14063</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;            Quotes   TV.advert</span></span>
<span><span class="co">#&gt;  [1,]  1.11874618  1.19921616</span></span>
<span><span class="co">#&gt;  [2,]  0.09390745  0.01901986</span></span>
<span><span class="co">#&gt;  [3,] -1.43434322 -1.16781389</span></span>
<span><span class="co">#&gt;  [4,]  1.27193197  1.24470742</span></span>
<span><span class="co">#&gt;  [5,] -1.49065784 -1.21723396</span></span>
<span><span class="co">#&gt;  [6,] -2.34261676 -1.51417390</span></span>
<span><span class="co">#&gt;  [7,] -0.46298299 -0.60250287</span></span>
<span><span class="co">#&gt;  [8,]  1.63235318  0.57215494</span></span>
<span><span class="co">#&gt;  [9,]  0.40411221 -0.32801633</span></span>
<span><span class="co">#&gt; [10,]  0.48277892  0.18055867</span></span>
<span><span class="co">#&gt; [11,]  0.57087239  0.21240486</span></span>
<span><span class="co">#&gt; [12,]  1.17734665  0.57331263</span></span>
<span><span class="co">#&gt; [13,]  0.11531808  0.03121107</span></span>
<span><span class="co">#&gt; [14,] -0.42672324 -0.52697371</span></span>
<span><span class="co">#&gt; [15,] -1.85435793 -1.23203209</span></span>
<span><span class="co">#&gt; [16,] -0.03066633  0.70089111</span></span>
<span><span class="co">#&gt; [17,]  2.03550258  1.71783757</span></span>
<span><span class="co">#&gt; [18,]  0.10090940  0.43690274</span></span>
<span><span class="co">#&gt; [19,] -0.06200294  0.01106144</span></span>
<span><span class="co">#&gt; [20,]  0.13620873  0.06072585</span></span>
<span><span class="co">#&gt; [21,] -1.89082466 -0.95683806</span></span>
<span><span class="co">#&gt; [22,] -0.59474544  0.01552906</span></span>
<span><span class="co">#&gt; [23,]  0.86784469  0.14757423</span></span>
<span><span class="co">#&gt; [24,]  0.64438935  0.39749239</span></span>
<span><span class="co">#&gt; [25,]  1.21235947  1.79794968</span></span>
<span><span class="co">#&gt; [26,] -0.72834160 -0.52926182</span></span>
<span><span class="co">#&gt; [27,] -2.25083381 -1.18159761</span></span>
<span><span class="co">#&gt; [28,]  1.33778080  0.97343623</span></span>
<span><span class="co">#&gt; [29,]  1.97229999  0.89921107</span></span>
<span><span class="co">#&gt; [30,]  0.98424529  0.52904493</span></span>
<span><span class="co">#&gt; [31,] -0.10842601 -0.11619745</span></span>
<span><span class="co">#&gt; [32,] -2.24369150 -1.28978017</span></span>
<span><span class="co">#&gt; [33,] -0.89142004 -0.54783127</span></span>
<span><span class="co">#&gt; [34,] -0.04783669  0.13304638</span></span>
<span><span class="co">#&gt; [35,] -1.11899454 -1.45036144</span></span>
<span><span class="co">#&gt; [36,]  0.60160639  0.35230619</span></span>
<span><span class="co">#&gt; [37,]  2.54250721  1.21587964</span></span>
<span><span class="co">#&gt; [38,]  0.43166441  0.33684394</span></span>
<span><span class="co">#&gt; [39,] -1.75521983 -1.09770352</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $coefficients</span></span>
<span><span class="co">#&gt;        Quotes  TV.advert</span></span>
<span><span class="co">#&gt; x1  3.4186614  1.5473408</span></span>
<span><span class="co">#&gt; x2 -3.1731701 -1.3443203</span></span>
<span><span class="co">#&gt; x3  0.1632802  0.3192611</span></span>
<span><span class="co">#&gt; x4  2.0400926  1.0944911</span></span>
<span><span class="co">#&gt; x5 -2.0400926 -1.0944911</span></span>
<span><span class="co">#&gt; h1  1.3316541  0.5511770</span></span>
<span><span class="co">#&gt; h2 -0.8883466 -0.2904272</span></span>
<span><span class="co">#&gt; h3  2.1231054  1.3697223</span></span>
<span><span class="co">#&gt; h4  1.4885414  0.7223003</span></span>
<span><span class="co">#&gt; h5 -0.4781963 -0.2255774</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res3</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert       </span></span>
<span><span class="co">#&gt;  Min.   :-2.3426   Min.   :-1.51417  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.8099   1st Qu.:-0.57517  </span></span>
<span><span class="co">#&gt;  Median : 0.1009   Median : 0.06073  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.00000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.9260   3rd Qu.: 0.55060  </span></span>
<span><span class="co">#&gt;  Max.   : 2.5425   Max.   : 1.79795</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res3</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.2913532 0.6500526</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res3</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.4150247 0.2507454</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res3</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/gaussian-xreg-kmeans-1.png" width="691.2"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res3</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/gaussian-xreg-kmeans-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-k-means-clustering">1 - 4 With K-Means clustering<a class="anchor" aria-label="anchor" href="#with-k-means-clustering"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">centers</span> <span class="op">&lt;-</span> <span class="fl">2L</span></span>
<span><span class="op">(</span><span class="va">res10</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, centers <span class="op">=</span> <span class="va">centers</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.10717  8.489682</span></span>
<span><span class="co">#&gt; Jun 2005 14.38158  8.175616</span></span>
<span><span class="co">#&gt; Jul 2005 15.45634  8.470898</span></span>
<span><span class="co">#&gt; Aug 2005 16.77134  9.147753</span></span>
<span><span class="co">#&gt; Sep 2005 17.34214  9.699675</span></span>
<span><span class="co">#&gt; Oct 2005 16.90309  9.754963</span></span>
<span><span class="co">#&gt; Nov 2005 15.99418  9.391872</span></span>
<span><span class="co">#&gt; Dec 2005 15.35446  8.958560</span></span>
<span><span class="co">#&gt; Jan 2006 15.36658  8.772022</span></span>
<span><span class="co">#&gt; Feb 2006 15.87293  8.905313</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 11.17305  6.463342</span></span>
<span><span class="co">#&gt; Jun 2005 11.44747  6.149277</span></span>
<span><span class="co">#&gt; Jul 2005 12.52222  6.444558</span></span>
<span><span class="co">#&gt; Aug 2005 13.83723  7.121414</span></span>
<span><span class="co">#&gt; Sep 2005 14.40802  7.673336</span></span>
<span><span class="co">#&gt; Oct 2005 13.96898  7.728624</span></span>
<span><span class="co">#&gt; Nov 2005 13.06007  7.365533</span></span>
<span><span class="co">#&gt; Dec 2005 12.42034  6.932220</span></span>
<span><span class="co">#&gt; Jan 2006 12.43246  6.745682</span></span>
<span><span class="co">#&gt; Feb 2006 12.93881  6.878974</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.04128  10.51602</span></span>
<span><span class="co">#&gt; Jun 2005 17.31569  10.20196</span></span>
<span><span class="co">#&gt; Jul 2005 18.39045  10.49724</span></span>
<span><span class="co">#&gt; Aug 2005 19.70546  11.17409</span></span>
<span><span class="co">#&gt; Sep 2005 20.27625  11.72601</span></span>
<span><span class="co">#&gt; Oct 2005 19.83721  11.78130</span></span>
<span><span class="co">#&gt; Nov 2005 18.92830  11.41821</span></span>
<span><span class="co">#&gt; Dec 2005 18.28857  10.98490</span></span>
<span><span class="co">#&gt; Jan 2006 18.30069  10.79836</span></span>
<span><span class="co">#&gt; Feb 2006 18.80704  10.93165</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;            Quotes   TV.advert</span></span>
<span><span class="co">#&gt;  [1,]  1.34231135  1.22967612</span></span>
<span><span class="co">#&gt;  [2,] -0.85477619 -0.98393029</span></span>
<span><span class="co">#&gt;  [3,] -1.00310653 -1.06267921</span></span>
<span><span class="co">#&gt;  [4,]  1.34231135  1.22967612</span></span>
<span><span class="co">#&gt;  [5,] -2.36146619 -2.10296529</span></span>
<span><span class="co">#&gt;  [6,] -3.36233492 -1.98959149</span></span>
<span><span class="co">#&gt;  [7,] -1.19409276 -0.96452874</span></span>
<span><span class="co">#&gt;  [8,]  0.77658242  0.14934530</span></span>
<span><span class="co">#&gt;  [9,]  0.59572299 -0.28721951</span></span>
<span><span class="co">#&gt; [10,] -0.05623678  0.01878023</span></span>
<span><span class="co">#&gt; [11,]  0.04224137 -0.21855884</span></span>
<span><span class="co">#&gt; [12,]  0.78363351  0.22949465</span></span>
<span><span class="co">#&gt; [13,]  0.06745138 -0.16899703</span></span>
<span><span class="co">#&gt; [14,] -0.47113613 -0.67865735</span></span>
<span><span class="co">#&gt; [15,] -1.96150053 -1.32047922</span></span>
<span><span class="co">#&gt; [16,] -0.39902461  0.60812604</span></span>
<span><span class="co">#&gt; [17,]  1.60642970  1.31542231</span></span>
<span><span class="co">#&gt; [18,] -0.38592136  0.01993791</span></span>
<span><span class="co">#&gt; [19,] -0.04845633  0.05173157</span></span>
<span><span class="co">#&gt; [20,] -0.88143921 -0.52155537</span></span>
<span><span class="co">#&gt; [21,] -2.56255162 -1.33780704</span></span>
<span><span class="co">#&gt; [22,] -0.54244587  0.01936417</span></span>
<span><span class="co">#&gt; [23,]  0.49795898 -0.11485376</span></span>
<span><span class="co">#&gt; [24,]  0.69509909  0.45274834</span></span>
<span><span class="co">#&gt; [25,]  0.63284087  1.48814559</span></span>
<span><span class="co">#&gt; [26,] -1.47632294 -0.92299854</span></span>
<span><span class="co">#&gt; [27,] -1.78763671 -0.97448637</span></span>
<span><span class="co">#&gt; [28,]  2.35063076  1.50826223</span></span>
<span><span class="co">#&gt; [29,]  1.67726281  0.73013283</span></span>
<span><span class="co">#&gt; [30,]  2.48613792  1.55203022</span></span>
<span><span class="co">#&gt; [31,] -0.13610810  0.06171409</span></span>
<span><span class="co">#&gt; [32,] -0.79383525 -0.25751529</span></span>
<span><span class="co">#&gt; [33,] -0.70470857 -0.41256032</span></span>
<span><span class="co">#&gt; [34,]  0.53215200  0.47720624</span></span>
<span><span class="co">#&gt; [35,] -0.78427460 -1.15615114</span></span>
<span><span class="co">#&gt; [36,]  2.38131744  1.46510425</span></span>
<span><span class="co">#&gt; [37,]  3.68215047  2.20096870</span></span>
<span><span class="co">#&gt; [38,]  1.36156864  1.07925077</span></span>
<span><span class="co">#&gt; [39,] -1.08642784 -0.41158288</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $coefficients</span></span>
<span><span class="co">#&gt;        Quotes   TV.advert</span></span>
<span><span class="co">#&gt; x1  2.4575845  0.91704166</span></span>
<span><span class="co">#&gt; x2 -2.0640894 -0.95963434</span></span>
<span><span class="co">#&gt; x3 -0.9277974 -0.39680734</span></span>
<span><span class="co">#&gt; x4  0.9277974  0.39680734</span></span>
<span><span class="co">#&gt; h1  0.8772790  0.54857210</span></span>
<span><span class="co">#&gt; h2 -1.6557144 -0.50781090</span></span>
<span><span class="co">#&gt; h3 -0.4923290 -0.01455017</span></span>
<span><span class="co">#&gt; h4  0.8215335  0.53984616</span></span>
<span><span class="co">#&gt; h5 -0.4400446 -0.52582355</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res10</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes           TV.advert       </span></span>
<span><span class="co">#&gt;  Min.   :-3.36233   Min.   :-2.10297  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.86811   1st Qu.:-0.80083  </span></span>
<span><span class="co">#&gt;  Median :-0.05624   Median : 0.01878  </span></span>
<span><span class="co">#&gt;  Mean   : 0.00000   Mean   : 0.00000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.78011   3rd Qu.: 0.66913  </span></span>
<span><span class="co">#&gt;  Max.   : 3.68215   Max.   : 2.20097</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res10</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Quotes  TV.advert </span></span>
<span><span class="co">#&gt; 0.04802834 0.26497281</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res10</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9888696 0.5936285</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res10</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/gaussian-kmeans-1.png" width="691.2"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res10</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/gaussian-kmeans-2.png" width="691.2"></p>
</div>
</div>
<div class="section level2">
<h2 id="prediction-intervals-based-on-independent-bootstrap">2 - Prediction intervals based on independent bootstrap<a class="anchor" aria-label="anchor" href="#prediction-intervals-based-on-independent-bootstrap"></a>
</h2>
<div class="section level3">
<h3 id="with-default-parameters-1">2 - 1 With default parameters<a class="anchor" aria-label="anchor" href="#with-default-parameters-1"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">10L</span> <span class="co"># number of bootstrap replications -- increase this</span></span>
<span><span class="op">(</span><span class="va">res4</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                        type_pi <span class="op">=</span> <span class="st">"bootstrap"</span>, B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.95424  8.917110</span></span>
<span><span class="co">#&gt; Jun 2005 14.49974  8.636097</span></span>
<span><span class="co">#&gt; Jul 2005 14.89943  9.021361</span></span>
<span><span class="co">#&gt; Aug 2005 13.81663  8.379904</span></span>
<span><span class="co">#&gt; Sep 2005 13.21467  7.907439</span></span>
<span><span class="co">#&gt; Oct 2005 12.43278  7.492033</span></span>
<span><span class="co">#&gt; Nov 2005 13.26207  8.025966</span></span>
<span><span class="co">#&gt; Dec 2005 13.83344  8.416299</span></span>
<span><span class="co">#&gt; Jan 2006 14.05378  8.520859</span></span>
<span><span class="co">#&gt; Feb 2006 14.27316  8.593758</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 12.084705  7.338993</span></span>
<span><span class="co">#&gt; Jun 2005 12.334471  6.899060</span></span>
<span><span class="co">#&gt; Jul 2005 10.169184  6.394872</span></span>
<span><span class="co">#&gt; Aug 2005 11.009906  6.891660</span></span>
<span><span class="co">#&gt; Sep 2005 10.892449  5.821847</span></span>
<span><span class="co">#&gt; Oct 2005  9.512025  5.810005</span></span>
<span><span class="co">#&gt; Nov 2005 11.136196  7.072952</span></span>
<span><span class="co">#&gt; Dec 2005  9.352377  6.033064</span></span>
<span><span class="co">#&gt; Jan 2006 10.779190  6.889282</span></span>
<span><span class="co">#&gt; Feb 2006 10.410663  6.496912</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.25320 10.490874</span></span>
<span><span class="co">#&gt; Jun 2005 15.53240  9.620957</span></span>
<span><span class="co">#&gt; Jul 2005 17.01236 10.447844</span></span>
<span><span class="co">#&gt; Aug 2005 16.25077 10.429662</span></span>
<span><span class="co">#&gt; Sep 2005 15.17868  9.484860</span></span>
<span><span class="co">#&gt; Oct 2005 13.87775  8.808728</span></span>
<span><span class="co">#&gt; Nov 2005 15.02885  9.384877</span></span>
<span><span class="co">#&gt; Dec 2005 16.01964  9.714979</span></span>
<span><span class="co">#&gt; Jan 2006 16.78336 10.055364</span></span>
<span><span class="co">#&gt; Feb 2006 17.73885 10.720315</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.09470  8.546350</span></span>
<span><span class="co">#&gt; Jun 2005 15.26574  8.957984</span></span>
<span><span class="co">#&gt; Jul 2005 17.14212 10.521963</span></span>
<span><span class="co">#&gt; Aug 2005 14.47419  8.777585</span></span>
<span><span class="co">#&gt; Sep 2005 13.80475  7.662264</span></span>
<span><span class="co">#&gt; Oct 2005 13.29210  7.242733</span></span>
<span><span class="co">#&gt; Nov 2005 12.93090  7.530277</span></span>
<span><span class="co">#&gt; Dec 2005 14.38592  8.007453</span></span>
<span><span class="co">#&gt; Jan 2006 13.75002  8.075816</span></span>
<span><span class="co">#&gt; Feb 2006 13.91423  7.624468</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.693479  8.890481</span></span>
<span><span class="co">#&gt; Jun 2005 12.071239  6.621006</span></span>
<span><span class="co">#&gt; Jul 2005 16.321333  9.408312</span></span>
<span><span class="co">#&gt; Aug 2005 16.301909 10.599011</span></span>
<span><span class="co">#&gt; Sep 2005 10.751088  6.451488</span></span>
<span><span class="co">#&gt; Oct 2005 12.825250  8.975899</span></span>
<span><span class="co">#&gt; Nov 2005 10.917488  7.055409</span></span>
<span><span class="co">#&gt; Dec 2005  8.509706  5.597015</span></span>
<span><span class="co">#&gt; Jan 2006 12.748927  8.157222</span></span>
<span><span class="co">#&gt; Feb 2006 15.261147  9.472318</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.25320 10.490874</span></span>
<span><span class="co">#&gt; Jun 2005 15.51548  9.305770</span></span>
<span><span class="co">#&gt; Jul 2005 15.51882  9.127883</span></span>
<span><span class="co">#&gt; Aug 2005 13.05521  7.008770</span></span>
<span><span class="co">#&gt; Sep 2005 11.37936  5.649254</span></span>
<span><span class="co">#&gt; Oct 2005 13.04494  7.183429</span></span>
<span><span class="co">#&gt; Nov 2005 14.34255  7.673654</span></span>
<span><span class="co">#&gt; Dec 2005 15.68812  9.097144</span></span>
<span><span class="co">#&gt; Jan 2006 15.08182  8.093210</span></span>
<span><span class="co">#&gt; Feb 2006 15.28630  8.804900</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 11.68915  7.181272</span></span>
<span><span class="co">#&gt; Jun 2005 15.16186  9.360902</span></span>
<span><span class="co">#&gt; Jul 2005 16.50681 10.087084</span></span>
<span><span class="co">#&gt; Aug 2005 13.47757  8.178792</span></span>
<span><span class="co">#&gt; Sep 2005 14.49698  8.965963</span></span>
<span><span class="co">#&gt; Oct 2005 12.82710  7.912189</span></span>
<span><span class="co">#&gt; Nov 2005 12.26039  7.194058</span></span>
<span><span class="co">#&gt; Dec 2005 16.11588  9.746326</span></span>
<span><span class="co">#&gt; Jan 2006 17.15008 10.279865</span></span>
<span><span class="co">#&gt; Feb 2006 16.07570  9.332013</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.67039  8.878271</span></span>
<span><span class="co">#&gt; Jun 2005 15.53732  9.650251</span></span>
<span><span class="co">#&gt; Jul 2005 10.79614  6.687064</span></span>
<span><span class="co">#&gt; Aug 2005 12.45865  7.752375</span></span>
<span><span class="co">#&gt; Sep 2005 15.36642  9.557945</span></span>
<span><span class="co">#&gt; Oct 2005 12.55254  7.850653</span></span>
<span><span class="co">#&gt; Nov 2005 15.04672  9.338306</span></span>
<span><span class="co">#&gt; Dec 2005 13.15837  8.368249</span></span>
<span><span class="co">#&gt; Jan 2006 14.75788  9.282082</span></span>
<span><span class="co">#&gt; Feb 2006 10.12754  6.388148</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.09470  8.546350</span></span>
<span><span class="co">#&gt; Jun 2005 14.32990  7.856803</span></span>
<span><span class="co">#&gt; Jul 2005 16.26642  9.830921</span></span>
<span><span class="co">#&gt; Aug 2005 16.07463  9.846349</span></span>
<span><span class="co">#&gt; Sep 2005 13.61470  8.234302</span></span>
<span><span class="co">#&gt; Oct 2005 13.38812  8.232918</span></span>
<span><span class="co">#&gt; Nov 2005 13.58878  8.044008</span></span>
<span><span class="co">#&gt; Dec 2005 15.48621  9.136085</span></span>
<span><span class="co">#&gt; Jan 2006 15.52022  9.209342</span></span>
<span><span class="co">#&gt; Feb 2006 17.23132 10.632457</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.25320 10.490874</span></span>
<span><span class="co">#&gt; Jun 2005 15.14628  8.991276</span></span>
<span><span class="co">#&gt; Jul 2005 15.61068 10.192546</span></span>
<span><span class="co">#&gt; Aug 2005 10.58930  6.857661</span></span>
<span><span class="co">#&gt; Sep 2005 13.47287  8.511551</span></span>
<span><span class="co">#&gt; Oct 2005 10.19723  5.739297</span></span>
<span><span class="co">#&gt; Nov 2005 11.88952  7.133378</span></span>
<span><span class="co">#&gt; Dec 2005 12.25491  7.535011</span></span>
<span><span class="co">#&gt; Jan 2006 10.44075  6.714824</span></span>
<span><span class="co">#&gt; Feb 2006 13.16995  8.647643</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.447159  7.882252</span></span>
<span><span class="co">#&gt; Jun 2005 13.241160  7.983379</span></span>
<span><span class="co">#&gt; Jul 2005 16.565430 10.160963</span></span>
<span><span class="co">#&gt; Aug 2005 14.500822  8.968994</span></span>
<span><span class="co">#&gt; Sep 2005 13.156521  8.392164</span></span>
<span><span class="co">#&gt; Oct 2005  9.313095  6.053557</span></span>
<span><span class="co">#&gt; Nov 2005 12.581349  8.323640</span></span>
<span><span class="co">#&gt; Dec 2005 14.074785  8.890812</span></span>
<span><span class="co">#&gt; Jan 2006 11.944916  7.490191</span></span>
<span><span class="co">#&gt; Feb 2006 11.385856  6.871544</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.616890  9.121409</span></span>
<span><span class="co">#&gt; Jun 2005 13.634215  9.520057</span></span>
<span><span class="co">#&gt; Jul 2005  9.987166  6.310043</span></span>
<span><span class="co">#&gt; Aug 2005 13.703893  8.339510</span></span>
<span><span class="co">#&gt; Sep 2005 11.571965  6.416334</span></span>
<span><span class="co">#&gt; Oct 2005 14.019898  7.954921</span></span>
<span><span class="co">#&gt; Nov 2005 14.095724  8.568528</span></span>
<span><span class="co">#&gt; Dec 2005 13.091223  8.177888</span></span>
<span><span class="co">#&gt; Jan 2006 14.042929  8.960467</span></span>
<span><span class="co">#&gt; Feb 2006 12.393313  7.418268</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.72954  9.142963</span></span>
<span><span class="co">#&gt; Jun 2005 15.09424  8.113548</span></span>
<span><span class="co">#&gt; Jul 2005 14.27943  7.886835</span></span>
<span><span class="co">#&gt; Aug 2005 13.53009  7.469997</span></span>
<span><span class="co">#&gt; Sep 2005 14.53202  9.233122</span></span>
<span><span class="co">#&gt; Oct 2005 12.86756  7.774732</span></span>
<span><span class="co">#&gt; Nov 2005 14.96732  9.398397</span></span>
<span><span class="co">#&gt; Dec 2005 15.56929  9.607004</span></span>
<span><span class="co">#&gt; Jan 2006 15.10023  8.945575</span></span>
<span><span class="co">#&gt; Feb 2006 17.88620 10.745822</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;            Quotes   TV.advert</span></span>
<span><span class="co">#&gt;  [1,]  1.40368643  1.33052782</span></span>
<span><span class="co">#&gt;  [2,] -1.08056990 -1.14582835</span></span>
<span><span class="co">#&gt;  [3,] -1.23343504 -1.15469695</span></span>
<span><span class="co">#&gt;  [4,]  1.40368643  1.33052782</span></span>
<span><span class="co">#&gt;  [5,] -2.58725990 -2.26486335</span></span>
<span><span class="co">#&gt;  [6,] -3.07477874 -1.76651025</span></span>
<span><span class="co">#&gt;  [7,] -1.31677412 -1.06553020</span></span>
<span><span class="co">#&gt;  [8,]  0.65681006  0.07019039</span></span>
<span><span class="co">#&gt;  [9,]  0.33076863 -0.40143292</span></span>
<span><span class="co">#&gt; [10,]  0.51993723  0.22434076</span></span>
<span><span class="co">#&gt; [11,]  0.10053432 -0.17249791</span></span>
<span><span class="co">#&gt; [12,]  0.95770684  0.35761548</span></span>
<span><span class="co">#&gt; [13,]  0.26825909 -0.01668861</span></span>
<span><span class="co">#&gt; [14,] -0.12839403 -0.42852687</span></span>
<span><span class="co">#&gt; [15,] -1.17137522 -0.76232506</span></span>
<span><span class="co">#&gt; [16,]  0.19770654  0.96971721</span></span>
<span><span class="co">#&gt; [17,]  1.62259434  1.31981494</span></span>
<span><span class="co">#&gt; [18,] -0.14704277  0.17362676</span></span>
<span><span class="co">#&gt; [19,] -0.07045343 -0.05730098</span></span>
<span><span class="co">#&gt; [20,] -1.17072203 -0.66882907</span></span>
<span><span class="co">#&gt; [21,] -2.89887258 -1.53863637</span></span>
<span><span class="co">#&gt; [22,] -0.62736155 -0.06504866</span></span>
<span><span class="co">#&gt; [23,]  0.96560231  0.19518092</span></span>
<span><span class="co">#&gt; [24,] -0.09354593 -0.06951135</span></span>
<span><span class="co">#&gt; [25,]  0.15915097  1.22257588</span></span>
<span><span class="co">#&gt; [26,]  0.29875209  0.25719228</span></span>
<span><span class="co">#&gt; [27,] -1.31329880 -0.69076345</span></span>
<span><span class="co">#&gt; [28,]  2.48926902  1.54309187</span></span>
<span><span class="co">#&gt; [29,]  1.91175656  0.91165371</span></span>
<span><span class="co">#&gt; [30,]  2.04130891  1.23352769</span></span>
<span><span class="co">#&gt; [31,] -0.29759583 -0.05351566</span></span>
<span><span class="co">#&gt; [32,] -1.22025180 -0.56162404</span></span>
<span><span class="co">#&gt; [33,] -0.95856611 -0.54609232</span></span>
<span><span class="co">#&gt; [34,]  0.20717781  0.29095534</span></span>
<span><span class="co">#&gt; [35,] -0.70462371 -1.15899926</span></span>
<span><span class="co">#&gt; [36,]  2.26007518  1.40841386</span></span>
<span><span class="co">#&gt; [37,]  2.95319223  1.69957104</span></span>
<span><span class="co">#&gt; [38,]  0.89317411  0.77051186</span></span>
<span><span class="co">#&gt; [39,] -1.54622760 -0.71981400</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res4</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert       </span></span>
<span><span class="co">#&gt;  Min.   :-3.0748   Min.   :-2.26486  </span></span>
<span><span class="co">#&gt;  1st Qu.:-1.1256   1st Qu.:-0.67980  </span></span>
<span><span class="co">#&gt;  Median : 0.1005   Median :-0.05352  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.00000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.9254   3rd Qu.: 0.84108  </span></span>
<span><span class="co">#&gt;  Max.   : 2.9532   Max.   : 1.69957</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res4</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Quotes  TV.advert </span></span>
<span><span class="co">#&gt; 0.06458106 0.32251812</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res4</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.7471878 0.3924569</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res4</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/bootstrap-default-1.png" width="691.2"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res4</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/bootstrap-default-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-external-regressors-1">2 - 2 With external regressors<a class="anchor" aria-label="anchor" href="#with-external-regressors-1"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res5</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, xreg <span class="op">=</span> <span class="va">xreg</span>, </span>
<span>                        type_pi <span class="op">=</span> <span class="st">"bootstrap"</span>, B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.83543  9.489772</span></span>
<span><span class="co">#&gt; Jun 2005 15.85604  9.556819</span></span>
<span><span class="co">#&gt; Jul 2005 16.47363 10.091468</span></span>
<span><span class="co">#&gt; Aug 2005 15.49717  9.499224</span></span>
<span><span class="co">#&gt; Sep 2005 14.92088  9.093326</span></span>
<span><span class="co">#&gt; Oct 2005 14.80031  9.044508</span></span>
<span><span class="co">#&gt; Nov 2005 16.07283  9.721118</span></span>
<span><span class="co">#&gt; Dec 2005 16.55953 10.012005</span></span>
<span><span class="co">#&gt; Jan 2006 16.38269  9.838773</span></span>
<span><span class="co">#&gt; Feb 2006 17.24196 10.332083</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 12.72699  7.686207</span></span>
<span><span class="co">#&gt; Jun 2005 14.27121  8.487002</span></span>
<span><span class="co">#&gt; Jul 2005 11.92056  7.522689</span></span>
<span><span class="co">#&gt; Aug 2005 12.63396  8.135428</span></span>
<span><span class="co">#&gt; Sep 2005 13.39517  8.189226</span></span>
<span><span class="co">#&gt; Oct 2005 10.62521  6.861347</span></span>
<span><span class="co">#&gt; Nov 2005 14.30810  8.911368</span></span>
<span><span class="co">#&gt; Dec 2005 11.71644  7.398021</span></span>
<span><span class="co">#&gt; Jan 2006 13.99457  8.665999</span></span>
<span><span class="co">#&gt; Feb 2006 11.97363  7.533064</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.72106  10.87268</span></span>
<span><span class="co">#&gt; Jun 2005 17.22584  10.42581</span></span>
<span><span class="co">#&gt; Jul 2005 19.31335  11.94216</span></span>
<span><span class="co">#&gt; Aug 2005 17.91034  11.35180</span></span>
<span><span class="co">#&gt; Sep 2005 17.67846  10.95107</span></span>
<span><span class="co">#&gt; Oct 2005 17.38254  10.35569</span></span>
<span><span class="co">#&gt; Nov 2005 17.67314  10.58502</span></span>
<span><span class="co">#&gt; Dec 2005 19.49927  11.56067</span></span>
<span><span class="co">#&gt; Jan 2006 19.08364  11.30186</span></span>
<span><span class="co">#&gt; Feb 2006 20.55522  12.37432</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.20933  9.248692</span></span>
<span><span class="co">#&gt; Jun 2005 17.27866 10.181992</span></span>
<span><span class="co">#&gt; Jul 2005 19.31439 11.954437</span></span>
<span><span class="co">#&gt; Aug 2005 15.71288  9.435132</span></span>
<span><span class="co">#&gt; Sep 2005 14.78888  8.245459</span></span>
<span><span class="co">#&gt; Oct 2005 17.46036  9.863086</span></span>
<span><span class="co">#&gt; Nov 2005 17.49723 10.226270</span></span>
<span><span class="co">#&gt; Dec 2005 18.65309 10.458171</span></span>
<span><span class="co">#&gt; Jan 2006 18.40507 10.598431</span></span>
<span><span class="co">#&gt; Feb 2006 17.45471  9.403776</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.72942  9.514972</span></span>
<span><span class="co">#&gt; Jun 2005 14.09346  8.458399</span></span>
<span><span class="co">#&gt; Jul 2005 18.25350 10.789118</span></span>
<span><span class="co">#&gt; Aug 2005 17.97007 11.672310</span></span>
<span><span class="co">#&gt; Sep 2005 13.23870  8.172901</span></span>
<span><span class="co">#&gt; Oct 2005 15.38918 10.437795</span></span>
<span><span class="co">#&gt; Nov 2005 14.13069  9.070793</span></span>
<span><span class="co">#&gt; Dec 2005 10.83028  6.903871</span></span>
<span><span class="co">#&gt; Jan 2006 14.01583  8.671829</span></span>
<span><span class="co">#&gt; Feb 2006 17.93777 10.714967</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.72106 10.872683</span></span>
<span><span class="co">#&gt; Jun 2005 14.88347  8.941699</span></span>
<span><span class="co">#&gt; Jul 2005 16.30249  9.738921</span></span>
<span><span class="co">#&gt; Aug 2005 14.81684  8.780448</span></span>
<span><span class="co">#&gt; Sep 2005 14.68504  8.613253</span></span>
<span><span class="co">#&gt; Oct 2005 15.71413  9.260283</span></span>
<span><span class="co">#&gt; Nov 2005 17.72422 10.022207</span></span>
<span><span class="co">#&gt; Dec 2005 19.66011 11.586327</span></span>
<span><span class="co">#&gt; Jan 2006 17.02992  9.157579</span></span>
<span><span class="co">#&gt; Feb 2006 20.63057 12.127529</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 12.17858  7.404155</span></span>
<span><span class="co">#&gt; Jun 2005 16.69438  9.967782</span></span>
<span><span class="co">#&gt; Jul 2005 18.79987 11.439357</span></span>
<span><span class="co">#&gt; Aug 2005 15.02971  9.083331</span></span>
<span><span class="co">#&gt; Sep 2005 14.87959  8.973301</span></span>
<span><span class="co">#&gt; Oct 2005 14.62332  8.894779</span></span>
<span><span class="co">#&gt; Nov 2005 15.10973  8.957506</span></span>
<span><span class="co">#&gt; Dec 2005 18.94525 11.472298</span></span>
<span><span class="co">#&gt; Jan 2006 19.23483 11.408549</span></span>
<span><span class="co">#&gt; Feb 2006 18.62945 10.815449</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.87497  9.639481</span></span>
<span><span class="co">#&gt; Jun 2005 16.27445 10.112087</span></span>
<span><span class="co">#&gt; Jul 2005 11.86508  7.401519</span></span>
<span><span class="co">#&gt; Aug 2005 14.58401  8.866675</span></span>
<span><span class="co">#&gt; Sep 2005 15.71663  9.728297</span></span>
<span><span class="co">#&gt; Oct 2005 13.97101  8.768716</span></span>
<span><span class="co">#&gt; Nov 2005 16.67898 10.212294</span></span>
<span><span class="co">#&gt; Dec 2005 15.91397 10.063626</span></span>
<span><span class="co">#&gt; Jan 2006 15.12939  9.691796</span></span>
<span><span class="co">#&gt; Feb 2006 11.21637  7.185258</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.20933  9.248692</span></span>
<span><span class="co">#&gt; Jun 2005 17.04391  9.825523</span></span>
<span><span class="co">#&gt; Jul 2005 19.30979 11.899881</span></span>
<span><span class="co">#&gt; Aug 2005 16.84484 10.247832</span></span>
<span><span class="co">#&gt; Sep 2005 14.78831  9.037350</span></span>
<span><span class="co">#&gt; Oct 2005 14.18791  8.715208</span></span>
<span><span class="co">#&gt; Nov 2005 15.20932  8.897974</span></span>
<span><span class="co">#&gt; Dec 2005 18.19603 10.650764</span></span>
<span><span class="co">#&gt; Jan 2006 18.56289 10.934366</span></span>
<span><span class="co">#&gt; Feb 2006 20.29570 12.445974</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.72106 10.872683</span></span>
<span><span class="co">#&gt; Jun 2005 16.11642  9.726278</span></span>
<span><span class="co">#&gt; Jul 2005 15.68071 10.246019</span></span>
<span><span class="co">#&gt; Aug 2005 12.06781  7.948164</span></span>
<span><span class="co">#&gt; Sep 2005 14.92835  9.304370</span></span>
<span><span class="co">#&gt; Oct 2005 13.30382  8.105049</span></span>
<span><span class="co">#&gt; Nov 2005 14.91919  8.993319</span></span>
<span><span class="co">#&gt; Dec 2005 15.52932  9.381070</span></span>
<span><span class="co">#&gt; Jan 2006 13.98840  8.664306</span></span>
<span><span class="co">#&gt; Feb 2006 17.44368 11.101247</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.61594  8.657718</span></span>
<span><span class="co">#&gt; Jun 2005 15.46367  9.272312</span></span>
<span><span class="co">#&gt; Jul 2005 16.19348  9.995896</span></span>
<span><span class="co">#&gt; Aug 2005 15.58329  9.977242</span></span>
<span><span class="co">#&gt; Sep 2005 14.00118  9.245992</span></span>
<span><span class="co">#&gt; Oct 2005  9.84755  6.500272</span></span>
<span><span class="co">#&gt; Nov 2005 15.00607  9.664711</span></span>
<span><span class="co">#&gt; Dec 2005 16.81473 10.389499</span></span>
<span><span class="co">#&gt; Jan 2006 14.59121  9.035259</span></span>
<span><span class="co">#&gt; Feb 2006 14.58196  8.731063</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.63319  9.847365</span></span>
<span><span class="co">#&gt; Jun 2005 15.00880 10.496599</span></span>
<span><span class="co">#&gt; Jul 2005 12.11165  7.940050</span></span>
<span><span class="co">#&gt; Aug 2005 14.65761  8.898576</span></span>
<span><span class="co">#&gt; Sep 2005 13.93412  8.306272</span></span>
<span><span class="co">#&gt; Oct 2005 17.11447 10.072885</span></span>
<span><span class="co">#&gt; Nov 2005 17.23442 10.579489</span></span>
<span><span class="co">#&gt; Dec 2005 14.76880  9.100092</span></span>
<span><span class="co">#&gt; Jan 2006 16.11455 10.015358</span></span>
<span><span class="co">#&gt; Feb 2006 15.53897  9.273544</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.46143  9.591273</span></span>
<span><span class="co">#&gt; Jun 2005 15.70312  8.585523</span></span>
<span><span class="co">#&gt; Jul 2005 16.90533  9.509479</span></span>
<span><span class="co">#&gt; Aug 2005 17.70462 10.082533</span></span>
<span><span class="co">#&gt; Sep 2005 18.24802 11.306063</span></span>
<span><span class="co">#&gt; Oct 2005 16.39132  9.827007</span></span>
<span><span class="co">#&gt; Nov 2005 17.21848 10.586622</span></span>
<span><span class="co">#&gt; Dec 2005 16.28371 10.114332</span></span>
<span><span class="co">#&gt; Jan 2006 16.75483 10.210257</span></span>
<span><span class="co">#&gt; Feb 2006 18.69041 11.522023</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;            Quotes    TV.advert</span></span>
<span><span class="co">#&gt;  [1,]  1.67535261  1.600318363</span></span>
<span><span class="co">#&gt;  [2,] -0.09454667  0.059245589</span></span>
<span><span class="co">#&gt;  [3,] -0.61710349 -0.617562341</span></span>
<span><span class="co">#&gt;  [4,]  1.55432930  1.431543276</span></span>
<span><span class="co">#&gt;  [5,] -1.65830176 -1.201288646</span></span>
<span><span class="co">#&gt;  [6,] -3.27721670 -1.999680352</span></span>
<span><span class="co">#&gt;  [7,] -0.83986146 -0.746117612</span></span>
<span><span class="co">#&gt;  [8,]  1.04485279  0.291750330</span></span>
<span><span class="co">#&gt;  [9,]  0.75352722 -0.155143365</span></span>
<span><span class="co">#&gt; [10,]  0.26745241  0.004965096</span></span>
<span><span class="co">#&gt; [11,]  0.43157027  0.102861987</span></span>
<span><span class="co">#&gt; [12,]  1.13693270  0.494399368</span></span>
<span><span class="co">#&gt; [13,]  0.49053241  0.135721074</span></span>
<span><span class="co">#&gt; [14,] -0.10253286 -0.465058629</span></span>
<span><span class="co">#&gt; [15,] -1.85353900 -1.312388835</span></span>
<span><span class="co">#&gt; [16,] -0.33001834  0.475005003</span></span>
<span><span class="co">#&gt; [17,]  2.16635830  1.749815332</span></span>
<span><span class="co">#&gt; [18,]  0.17739319  0.443529161</span></span>
<span><span class="co">#&gt; [19,]  0.27361734  0.111136601</span></span>
<span><span class="co">#&gt; [20,] -0.58111949 -0.379519019</span></span>
<span><span class="co">#&gt; [21,] -2.30767070 -1.246635836</span></span>
<span><span class="co">#&gt; [22,] -0.19353452  0.176564889</span></span>
<span><span class="co">#&gt; [23,]  1.00563207  0.187437814</span></span>
<span><span class="co">#&gt; [24,]  0.41917089  0.235645632</span></span>
<span><span class="co">#&gt; [25,]  0.52295932  1.364524163</span></span>
<span><span class="co">#&gt; [26,] -0.95933919 -0.673442252</span></span>
<span><span class="co">#&gt; [27,] -1.56353647 -0.843576594</span></span>
<span><span class="co">#&gt; [28,]  2.26526358  1.468847972</span></span>
<span><span class="co">#&gt; [29,]  1.69164304  0.697529740</span></span>
<span><span class="co">#&gt; [30,]  2.01008148  1.118934668</span></span>
<span><span class="co">#&gt; [31,] -0.38235687 -0.261094013</span></span>
<span><span class="co">#&gt; [32,] -1.39361339 -0.785256869</span></span>
<span><span class="co">#&gt; [33,] -1.33394033 -0.789489620</span></span>
<span><span class="co">#&gt; [34,] -0.37279705 -0.008190995</span></span>
<span><span class="co">#&gt; [35,] -1.43004502 -1.625855697</span></span>
<span><span class="co">#&gt; [36,]  0.16351013  0.242165460</span></span>
<span><span class="co">#&gt; [37,]  2.64510868  1.356646561</span></span>
<span><span class="co">#&gt; [38,]  0.59781674  0.490409659</span></span>
<span><span class="co">#&gt; [39,] -2.00203118 -1.128697062</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res5</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert      </span></span>
<span><span class="co">#&gt;  Min.   :-3.2772   Min.   :-1.9997  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.8996   1st Qu.:-0.7098  </span></span>
<span><span class="co">#&gt;  Median : 0.1635   Median : 0.1029  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.0000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.8796   3rd Qu.: 0.4827  </span></span>
<span><span class="co">#&gt;  Max.   : 2.6451   Max.   : 1.7498</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res5</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.1553145 0.4247378</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res5</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9498845 0.5141136</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res5</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/bootstrap-xreg-1.png" width="691.2"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res5</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/bootstrap-xreg-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-external-regressors-and-k-means-clustering-1">2 - 3 With external regressors and K-Means clustering<a class="anchor" aria-label="anchor" href="#with-external-regressors-and-k-means-clustering-1"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res6</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, xreg <span class="op">=</span> <span class="va">xreg</span>, </span>
<span>                        centers <span class="op">=</span> <span class="va">centers</span>, </span>
<span>                        type_pi <span class="op">=</span> <span class="st">"bootstrap"</span>, B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.07501 10.388766</span></span>
<span><span class="co">#&gt; Jun 2005 15.43253  9.426450</span></span>
<span><span class="co">#&gt; Jul 2005 16.06612 10.032875</span></span>
<span><span class="co">#&gt; Aug 2005 15.55843  9.781757</span></span>
<span><span class="co">#&gt; Sep 2005 15.38803  9.561312</span></span>
<span><span class="co">#&gt; Oct 2005 14.29577  8.922294</span></span>
<span><span class="co">#&gt; Nov 2005 15.14111  9.437209</span></span>
<span><span class="co">#&gt; Dec 2005 15.62042  9.786917</span></span>
<span><span class="co">#&gt; Jan 2006 15.07962  9.427875</span></span>
<span><span class="co">#&gt; Feb 2006 15.75082  9.817742</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.93238  9.062999</span></span>
<span><span class="co">#&gt; Jun 2005 12.69504  7.635103</span></span>
<span><span class="co">#&gt; Jul 2005 12.02952  7.593689</span></span>
<span><span class="co">#&gt; Aug 2005 10.84778  7.172965</span></span>
<span><span class="co">#&gt; Sep 2005 11.62026  7.728688</span></span>
<span><span class="co">#&gt; Oct 2005 10.99568  6.889067</span></span>
<span><span class="co">#&gt; Nov 2005 11.91647  7.224795</span></span>
<span><span class="co">#&gt; Dec 2005 12.52659  8.282338</span></span>
<span><span class="co">#&gt; Jan 2006 12.09162  7.762180</span></span>
<span><span class="co">#&gt; Feb 2006 12.45194  7.679870</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 18.18986  11.34548</span></span>
<span><span class="co">#&gt; Jun 2005 18.44062  11.17688</span></span>
<span><span class="co">#&gt; Jul 2005 20.85434  13.21411</span></span>
<span><span class="co">#&gt; Aug 2005 20.12044  12.47538</span></span>
<span><span class="co">#&gt; Sep 2005 18.78197  11.33696</span></span>
<span><span class="co">#&gt; Oct 2005 17.49535  10.54290</span></span>
<span><span class="co">#&gt; Nov 2005 17.84692  10.68494</span></span>
<span><span class="co">#&gt; Dec 2005 19.52352  12.08598</span></span>
<span><span class="co">#&gt; Jan 2006 18.63094  11.31156</span></span>
<span><span class="co">#&gt; Feb 2006 18.26613  11.54401</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.25619 10.044030</span></span>
<span><span class="co">#&gt; Jun 2005 18.73895 11.413493</span></span>
<span><span class="co">#&gt; Jul 2005 21.59912 13.829240</span></span>
<span><span class="co">#&gt; Aug 2005 20.67822 12.672639</span></span>
<span><span class="co">#&gt; Sep 2005 19.07756 10.732739</span></span>
<span><span class="co">#&gt; Oct 2005 17.87501 10.108171</span></span>
<span><span class="co">#&gt; Nov 2005 16.07176  9.649668</span></span>
<span><span class="co">#&gt; Dec 2005 15.56584  9.027154</span></span>
<span><span class="co">#&gt; Jan 2006 18.72426 11.502984</span></span>
<span><span class="co">#&gt; Feb 2006 14.86814  8.268011</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.79008 10.383108</span></span>
<span><span class="co">#&gt; Jun 2005 12.31255  7.295241</span></span>
<span><span class="co">#&gt; Jul 2005 18.28898 10.708656</span></span>
<span><span class="co">#&gt; Aug 2005 18.07230 11.795922</span></span>
<span><span class="co">#&gt; Sep 2005 17.08844 10.800062</span></span>
<span><span class="co">#&gt; Oct 2005 15.26409 10.651944</span></span>
<span><span class="co">#&gt; Nov 2005 15.74207 10.320349</span></span>
<span><span class="co">#&gt; Dec 2005 12.63185  8.281412</span></span>
<span><span class="co">#&gt; Jan 2006 13.12904  8.348276</span></span>
<span><span class="co">#&gt; Feb 2006 18.09217 10.991725</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 18.18986 11.345483</span></span>
<span><span class="co">#&gt; Jun 2005 15.29909  9.330493</span></span>
<span><span class="co">#&gt; Jul 2005 16.43677 10.181040</span></span>
<span><span class="co">#&gt; Aug 2005 13.17118  8.044474</span></span>
<span><span class="co">#&gt; Sep 2005 13.86599  8.221628</span></span>
<span><span class="co">#&gt; Oct 2005 14.73454  8.849249</span></span>
<span><span class="co">#&gt; Nov 2005 18.29295 10.693085</span></span>
<span><span class="co">#&gt; Dec 2005 20.34044 12.591561</span></span>
<span><span class="co">#&gt; Jan 2006 18.30950 10.435445</span></span>
<span><span class="co">#&gt; Feb 2006 18.31664 11.315339</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.50946  8.857873</span></span>
<span><span class="co">#&gt; Jun 2005 14.82960  9.079181</span></span>
<span><span class="co">#&gt; Jul 2005 17.61633 11.095309</span></span>
<span><span class="co">#&gt; Aug 2005 12.92689  8.308982</span></span>
<span><span class="co">#&gt; Sep 2005 15.69561  9.844969</span></span>
<span><span class="co">#&gt; Oct 2005 13.68268  8.697224</span></span>
<span><span class="co">#&gt; Nov 2005 11.38714  6.919177</span></span>
<span><span class="co">#&gt; Dec 2005 16.45313 10.221813</span></span>
<span><span class="co">#&gt; Jan 2006 14.81343  9.285194</span></span>
<span><span class="co">#&gt; Feb 2006 17.37824 10.916374</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.49647 10.769539</span></span>
<span><span class="co">#&gt; Jun 2005 14.85714  9.099847</span></span>
<span><span class="co">#&gt; Jul 2005 11.78886  7.254220</span></span>
<span><span class="co">#&gt; Aug 2005 15.23442  9.316137</span></span>
<span><span class="co">#&gt; Sep 2005 13.77734  8.539092</span></span>
<span><span class="co">#&gt; Oct 2005 14.95766  9.428613</span></span>
<span><span class="co">#&gt; Nov 2005 13.89406  8.729591</span></span>
<span><span class="co">#&gt; Dec 2005 15.64772 10.212206</span></span>
<span><span class="co">#&gt; Jan 2006 14.16236  9.215672</span></span>
<span><span class="co">#&gt; Feb 2006 13.14627  8.432472</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.25619 10.044030</span></span>
<span><span class="co">#&gt; Jun 2005 17.41304 10.361876</span></span>
<span><span class="co">#&gt; Jul 2005 17.29974 10.956613</span></span>
<span><span class="co">#&gt; Aug 2005 17.04012 10.969462</span></span>
<span><span class="co">#&gt; Sep 2005 12.72317  8.123417</span></span>
<span><span class="co">#&gt; Oct 2005 12.03883  7.574503</span></span>
<span><span class="co">#&gt; Nov 2005 13.73972  8.277479</span></span>
<span><span class="co">#&gt; Dec 2005 16.65257 10.040701</span></span>
<span><span class="co">#&gt; Jan 2006 16.93919 10.522729</span></span>
<span><span class="co">#&gt; Feb 2006 16.41777 10.798443</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 18.18986 11.345483</span></span>
<span><span class="co">#&gt; Jun 2005 15.96543  9.870816</span></span>
<span><span class="co">#&gt; Jul 2005 12.85845  8.762974</span></span>
<span><span class="co">#&gt; Aug 2005 10.24417  6.919946</span></span>
<span><span class="co">#&gt; Sep 2005 15.60678 10.013383</span></span>
<span><span class="co">#&gt; Oct 2005 10.94730  6.819761</span></span>
<span><span class="co">#&gt; Nov 2005 14.70745  8.977825</span></span>
<span><span class="co">#&gt; Dec 2005 16.70968 10.344554</span></span>
<span><span class="co">#&gt; Jan 2006 12.14156  7.877396</span></span>
<span><span class="co">#&gt; Feb 2006 17.71229 11.610400</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.38910  9.769544</span></span>
<span><span class="co">#&gt; Jun 2005 15.07803  9.235066</span></span>
<span><span class="co">#&gt; Jul 2005 14.90282  9.239625</span></span>
<span><span class="co">#&gt; Aug 2005 16.56806 10.758096</span></span>
<span><span class="co">#&gt; Sep 2005 11.30006  7.614089</span></span>
<span><span class="co">#&gt; Oct 2005 11.16230  7.127788</span></span>
<span><span class="co">#&gt; Nov 2005 16.31061 10.656895</span></span>
<span><span class="co">#&gt; Dec 2005 16.03564 10.097145</span></span>
<span><span class="co">#&gt; Jan 2006 12.07712  7.728730</span></span>
<span><span class="co">#&gt; Feb 2006 13.35216  8.037539</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.95299 10.808949</span></span>
<span><span class="co">#&gt; Jun 2005 14.01249  9.772747</span></span>
<span><span class="co">#&gt; Jul 2005 14.16247  9.128365</span></span>
<span><span class="co">#&gt; Aug 2005 13.44972  8.252735</span></span>
<span><span class="co">#&gt; Sep 2005 16.98154 10.230916</span></span>
<span><span class="co">#&gt; Oct 2005 16.18762  9.798373</span></span>
<span><span class="co">#&gt; Nov 2005 16.14857 10.428086</span></span>
<span><span class="co">#&gt; Dec 2005 12.49604  8.285530</span></span>
<span><span class="co">#&gt; Jan 2006 13.42923  8.710094</span></span>
<span><span class="co">#&gt; Feb 2006 12.25036  7.576030</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.71992 10.519621</span></span>
<span><span class="co">#&gt; Jun 2005 15.81894  8.805736</span></span>
<span><span class="co">#&gt; Jul 2005 15.70763  9.172703</span></span>
<span><span class="co">#&gt; Aug 2005 18.19918 10.779171</span></span>
<span><span class="co">#&gt; Sep 2005 17.76383 11.492828</span></span>
<span><span class="co">#&gt; Oct 2005 16.10768 10.167317</span></span>
<span><span class="co">#&gt; Nov 2005 15.11675  9.719931</span></span>
<span><span class="co">#&gt; Dec 2005 13.67129  8.767092</span></span>
<span><span class="co">#&gt; Jan 2006 17.07047 10.652228</span></span>
<span><span class="co">#&gt; Feb 2006 15.97413 10.231085</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;            Quotes   TV.advert</span></span>
<span><span class="co">#&gt;  [1,]  1.11874618  1.19921616</span></span>
<span><span class="co">#&gt;  [2,]  0.09390745  0.01901986</span></span>
<span><span class="co">#&gt;  [3,] -1.43434322 -1.16781389</span></span>
<span><span class="co">#&gt;  [4,]  1.27193197  1.24470742</span></span>
<span><span class="co">#&gt;  [5,] -1.49065784 -1.21723396</span></span>
<span><span class="co">#&gt;  [6,] -2.34261676 -1.51417390</span></span>
<span><span class="co">#&gt;  [7,] -0.46298299 -0.60250287</span></span>
<span><span class="co">#&gt;  [8,]  1.63235318  0.57215494</span></span>
<span><span class="co">#&gt;  [9,]  0.40411221 -0.32801633</span></span>
<span><span class="co">#&gt; [10,]  0.48277892  0.18055867</span></span>
<span><span class="co">#&gt; [11,]  0.57087239  0.21240486</span></span>
<span><span class="co">#&gt; [12,]  1.17734665  0.57331263</span></span>
<span><span class="co">#&gt; [13,]  0.11531808  0.03121107</span></span>
<span><span class="co">#&gt; [14,] -0.42672324 -0.52697371</span></span>
<span><span class="co">#&gt; [15,] -1.85435793 -1.23203209</span></span>
<span><span class="co">#&gt; [16,] -0.03066633  0.70089111</span></span>
<span><span class="co">#&gt; [17,]  2.03550258  1.71783757</span></span>
<span><span class="co">#&gt; [18,]  0.10090940  0.43690274</span></span>
<span><span class="co">#&gt; [19,] -0.06200294  0.01106144</span></span>
<span><span class="co">#&gt; [20,]  0.13620873  0.06072585</span></span>
<span><span class="co">#&gt; [21,] -1.89082466 -0.95683806</span></span>
<span><span class="co">#&gt; [22,] -0.59474544  0.01552906</span></span>
<span><span class="co">#&gt; [23,]  0.86784469  0.14757423</span></span>
<span><span class="co">#&gt; [24,]  0.64438935  0.39749239</span></span>
<span><span class="co">#&gt; [25,]  1.21235947  1.79794968</span></span>
<span><span class="co">#&gt; [26,] -0.72834160 -0.52926182</span></span>
<span><span class="co">#&gt; [27,] -2.25083381 -1.18159761</span></span>
<span><span class="co">#&gt; [28,]  1.33778080  0.97343623</span></span>
<span><span class="co">#&gt; [29,]  1.97229999  0.89921107</span></span>
<span><span class="co">#&gt; [30,]  0.98424529  0.52904493</span></span>
<span><span class="co">#&gt; [31,] -0.10842601 -0.11619745</span></span>
<span><span class="co">#&gt; [32,] -2.24369150 -1.28978017</span></span>
<span><span class="co">#&gt; [33,] -0.89142004 -0.54783127</span></span>
<span><span class="co">#&gt; [34,] -0.04783669  0.13304638</span></span>
<span><span class="co">#&gt; [35,] -1.11899454 -1.45036144</span></span>
<span><span class="co">#&gt; [36,]  0.60160639  0.35230619</span></span>
<span><span class="co">#&gt; [37,]  2.54250721  1.21587964</span></span>
<span><span class="co">#&gt; [38,]  0.43166441  0.33684394</span></span>
<span><span class="co">#&gt; [39,] -1.75521983 -1.09770352</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res6</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert       </span></span>
<span><span class="co">#&gt;  Min.   :-2.3426   Min.   :-1.51417  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.8099   1st Qu.:-0.57517  </span></span>
<span><span class="co">#&gt;  Median : 0.1009   Median : 0.06073  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.00000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.9260   3rd Qu.: 0.55060  </span></span>
<span><span class="co">#&gt;  Max.   : 2.5425   Max.   : 1.79795</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res6</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.2913532 0.6500526</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res6</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.4150247 0.2507454</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res6</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/bootstrap-xreg-clustering-1.png" width="691.2"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res6</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/bootstrap-xreg-clustering-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-k-means-clustering-1">2 - 4 With K-Means clustering<a class="anchor" aria-label="anchor" href="#with-k-means-clustering-1"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">centers</span> <span class="op">&lt;-</span> <span class="fl">2L</span></span>
<span><span class="op">(</span><span class="va">res11</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                         centers <span class="op">=</span> <span class="va">centers</span>, </span>
<span>                         type_pi <span class="op">=</span> <span class="st">"bootstrap"</span>, B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.31666  8.479435</span></span>
<span><span class="co">#&gt; Jun 2005 14.25565  8.154158</span></span>
<span><span class="co">#&gt; Jul 2005 15.32783  8.849378</span></span>
<span><span class="co">#&gt; Aug 2005 14.97984  8.637996</span></span>
<span><span class="co">#&gt; Sep 2005 14.41556  8.203976</span></span>
<span><span class="co">#&gt; Oct 2005 14.04290  7.945506</span></span>
<span><span class="co">#&gt; Nov 2005 15.13941  8.638793</span></span>
<span><span class="co">#&gt; Dec 2005 15.89219  9.179574</span></span>
<span><span class="co">#&gt; Jan 2006 15.94669  9.254438</span></span>
<span><span class="co">#&gt; Feb 2006 15.77654  9.120208</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 11.23269  6.730729</span></span>
<span><span class="co">#&gt; Jun 2005 11.95664  6.225578</span></span>
<span><span class="co">#&gt; Jul 2005 12.06328  6.933796</span></span>
<span><span class="co">#&gt; Aug 2005 13.46931  6.740782</span></span>
<span><span class="co">#&gt; Sep 2005 11.79276  6.411252</span></span>
<span><span class="co">#&gt; Oct 2005 11.77875  6.409959</span></span>
<span><span class="co">#&gt; Nov 2005 12.60936  7.454808</span></span>
<span><span class="co">#&gt; Dec 2005 10.86506  6.316466</span></span>
<span><span class="co">#&gt; Jan 2006 12.03038  7.018978</span></span>
<span><span class="co">#&gt; Feb 2006 11.90936  7.053172</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.45780  9.997944</span></span>
<span><span class="co">#&gt; Jun 2005 15.83645  9.396756</span></span>
<span><span class="co">#&gt; Jul 2005 17.29322 10.338273</span></span>
<span><span class="co">#&gt; Aug 2005 17.19264 10.697252</span></span>
<span><span class="co">#&gt; Sep 2005 18.31322 10.266108</span></span>
<span><span class="co">#&gt; Oct 2005 17.38426  9.911348</span></span>
<span><span class="co">#&gt; Nov 2005 18.14288 10.850637</span></span>
<span><span class="co">#&gt; Dec 2005 20.46698 11.798062</span></span>
<span><span class="co">#&gt; Jan 2006 19.23890 10.905728</span></span>
<span><span class="co">#&gt; Feb 2006 19.93362 11.471999</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.70289  8.202462</span></span>
<span><span class="co">#&gt; Jun 2005 15.44244  8.971895</span></span>
<span><span class="co">#&gt; Jul 2005 16.65242 10.398943</span></span>
<span><span class="co">#&gt; Aug 2005 13.76268  8.828618</span></span>
<span><span class="co">#&gt; Sep 2005 11.75347  6.747740</span></span>
<span><span class="co">#&gt; Oct 2005 12.05234  6.685820</span></span>
<span><span class="co">#&gt; Nov 2005 12.45439  7.763001</span></span>
<span><span class="co">#&gt; Dec 2005 13.29424  7.594640</span></span>
<span><span class="co">#&gt; Jan 2006 13.58044  7.687717</span></span>
<span><span class="co">#&gt; Feb 2006 13.42123  7.263689</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.05871  8.541413</span></span>
<span><span class="co">#&gt; Jun 2005 11.58674  5.895681</span></span>
<span><span class="co">#&gt; Jul 2005 17.36302 10.129300</span></span>
<span><span class="co">#&gt; Aug 2005 16.83803 10.749865</span></span>
<span><span class="co">#&gt; Sep 2005 12.00571  7.770114</span></span>
<span><span class="co">#&gt; Oct 2005 13.19773  8.953938</span></span>
<span><span class="co">#&gt; Nov 2005 13.14312  7.992185</span></span>
<span><span class="co">#&gt; Dec 2005 10.15981  5.945383</span></span>
<span><span class="co">#&gt; Jan 2006 14.22426  8.712856</span></span>
<span><span class="co">#&gt; Feb 2006 17.53565 10.402912</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.45780  9.997944</span></span>
<span><span class="co">#&gt; Jun 2005 13.51019  7.743635</span></span>
<span><span class="co">#&gt; Jul 2005 14.60094  7.899539</span></span>
<span><span class="co">#&gt; Aug 2005 13.65309  6.468222</span></span>
<span><span class="co">#&gt; Sep 2005 13.83630  6.387669</span></span>
<span><span class="co">#&gt; Oct 2005 15.24162  7.578134</span></span>
<span><span class="co">#&gt; Nov 2005 17.97593  8.817839</span></span>
<span><span class="co">#&gt; Dec 2005 21.01367 12.053274</span></span>
<span><span class="co">#&gt; Jan 2006 16.67699  9.595067</span></span>
<span><span class="co">#&gt; Feb 2006 15.53215  9.407233</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 10.74483  6.500090</span></span>
<span><span class="co">#&gt; Jun 2005 14.67264  8.833011</span></span>
<span><span class="co">#&gt; Jul 2005 16.82310  9.876155</span></span>
<span><span class="co">#&gt; Aug 2005 14.18025  8.028508</span></span>
<span><span class="co">#&gt; Sep 2005 13.53450  7.662990</span></span>
<span><span class="co">#&gt; Oct 2005 13.92479  7.693246</span></span>
<span><span class="co">#&gt; Nov 2005 13.94236  7.368910</span></span>
<span><span class="co">#&gt; Dec 2005 17.61862 10.054156</span></span>
<span><span class="co">#&gt; Jan 2006 19.26549 11.092494</span></span>
<span><span class="co">#&gt; Feb 2006 16.83597 10.007784</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.80227  8.942430</span></span>
<span><span class="co">#&gt; Jun 2005 15.95084  9.271505</span></span>
<span><span class="co">#&gt; Jul 2005 12.57431  6.816889</span></span>
<span><span class="co">#&gt; Aug 2005 15.14212  8.361352</span></span>
<span><span class="co">#&gt; Sep 2005 18.35558 10.352236</span></span>
<span><span class="co">#&gt; Oct 2005 16.16587  9.822699</span></span>
<span><span class="co">#&gt; Nov 2005 17.36944 10.147720</span></span>
<span><span class="co">#&gt; Dec 2005 15.38180  9.415355</span></span>
<span><span class="co">#&gt; Jan 2006 16.56284  9.978913</span></span>
<span><span class="co">#&gt; Feb 2006 11.47043  6.992055</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.70289  8.202462</span></span>
<span><span class="co">#&gt; Jun 2005 14.57545  7.847502</span></span>
<span><span class="co">#&gt; Jul 2005 17.05279  9.871072</span></span>
<span><span class="co">#&gt; Aug 2005 17.29559 10.516029</span></span>
<span><span class="co">#&gt; Sep 2005 14.32197  8.573326</span></span>
<span><span class="co">#&gt; Oct 2005 13.88101  7.767504</span></span>
<span><span class="co">#&gt; Nov 2005 14.26019  7.750676</span></span>
<span><span class="co">#&gt; Dec 2005 16.62553  8.611713</span></span>
<span><span class="co">#&gt; Jan 2006 19.14733 10.262425</span></span>
<span><span class="co">#&gt; Feb 2006 20.62981 11.782378</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.45780  9.997944</span></span>
<span><span class="co">#&gt; Jun 2005 14.93806  8.718365</span></span>
<span><span class="co">#&gt; Jul 2005 14.85002  9.109522</span></span>
<span><span class="co">#&gt; Aug 2005 13.41595  7.972350</span></span>
<span><span class="co">#&gt; Sep 2005 16.11198  9.853527</span></span>
<span><span class="co">#&gt; Oct 2005 12.03373  6.614444</span></span>
<span><span class="co">#&gt; Nov 2005 13.54604  7.913295</span></span>
<span><span class="co">#&gt; Dec 2005 13.30479  7.682164</span></span>
<span><span class="co">#&gt; Jan 2006 11.58037  6.824828</span></span>
<span><span class="co">#&gt; Feb 2006 14.71056  8.799706</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 12.91307  7.525153</span></span>
<span><span class="co">#&gt; Jun 2005 13.23075  7.361891</span></span>
<span><span class="co">#&gt; Jul 2005 16.70298  9.709794</span></span>
<span><span class="co">#&gt; Aug 2005 15.28784  9.344990</span></span>
<span><span class="co">#&gt; Sep 2005 14.14065  8.230223</span></span>
<span><span class="co">#&gt; Oct 2005 11.70473  6.350592</span></span>
<span><span class="co">#&gt; Nov 2005 15.26251  9.033212</span></span>
<span><span class="co">#&gt; Dec 2005 18.58394 10.919000</span></span>
<span><span class="co">#&gt; Jan 2006 15.79686  9.100816</span></span>
<span><span class="co">#&gt; Feb 2006 14.80357  7.907821</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.72125  8.509620</span></span>
<span><span class="co">#&gt; Jun 2005 13.88374  9.433119</span></span>
<span><span class="co">#&gt; Jul 2005 11.91491  7.336475</span></span>
<span><span class="co">#&gt; Aug 2005 14.24248  8.430432</span></span>
<span><span class="co">#&gt; Sep 2005 11.92810  6.492484</span></span>
<span><span class="co">#&gt; Oct 2005 14.48919  8.051597</span></span>
<span><span class="co">#&gt; Nov 2005 15.24881  8.546381</span></span>
<span><span class="co">#&gt; Dec 2005 15.38240  8.756149</span></span>
<span><span class="co">#&gt; Jan 2006 17.29359  9.880730</span></span>
<span><span class="co">#&gt; Feb 2006 16.20881  8.726606</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.60513  8.374828</span></span>
<span><span class="co">#&gt; Jun 2005 14.76563  7.464978</span></span>
<span><span class="co">#&gt; Jul 2005 14.74379  7.346095</span></span>
<span><span class="co">#&gt; Aug 2005 15.98038  7.679598</span></span>
<span><span class="co">#&gt; Sep 2005 18.16731  9.969448</span></span>
<span><span class="co">#&gt; Oct 2005 17.73799  9.937085</span></span>
<span><span class="co">#&gt; Nov 2005 18.19135 11.054709</span></span>
<span><span class="co">#&gt; Dec 2005 17.55707 10.763910</span></span>
<span><span class="co">#&gt; Jan 2006 15.33870  9.408533</span></span>
<span><span class="co">#&gt; Feb 2006 16.61721  9.911892</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;            Quotes   TV.advert</span></span>
<span><span class="co">#&gt;  [1,]  1.34231135  1.22967612</span></span>
<span><span class="co">#&gt;  [2,] -0.85477619 -0.98393029</span></span>
<span><span class="co">#&gt;  [3,] -1.00310653 -1.06267921</span></span>
<span><span class="co">#&gt;  [4,]  1.34231135  1.22967612</span></span>
<span><span class="co">#&gt;  [5,] -2.36146619 -2.10296529</span></span>
<span><span class="co">#&gt;  [6,] -3.36233492 -1.98959149</span></span>
<span><span class="co">#&gt;  [7,] -1.19409276 -0.96452874</span></span>
<span><span class="co">#&gt;  [8,]  0.77658242  0.14934530</span></span>
<span><span class="co">#&gt;  [9,]  0.59572299 -0.28721951</span></span>
<span><span class="co">#&gt; [10,] -0.05623678  0.01878023</span></span>
<span><span class="co">#&gt; [11,]  0.04224137 -0.21855884</span></span>
<span><span class="co">#&gt; [12,]  0.78363351  0.22949465</span></span>
<span><span class="co">#&gt; [13,]  0.06745138 -0.16899703</span></span>
<span><span class="co">#&gt; [14,] -0.47113613 -0.67865735</span></span>
<span><span class="co">#&gt; [15,] -1.96150053 -1.32047922</span></span>
<span><span class="co">#&gt; [16,] -0.39902461  0.60812604</span></span>
<span><span class="co">#&gt; [17,]  1.60642970  1.31542231</span></span>
<span><span class="co">#&gt; [18,] -0.38592136  0.01993791</span></span>
<span><span class="co">#&gt; [19,] -0.04845633  0.05173157</span></span>
<span><span class="co">#&gt; [20,] -0.88143921 -0.52155537</span></span>
<span><span class="co">#&gt; [21,] -2.56255162 -1.33780704</span></span>
<span><span class="co">#&gt; [22,] -0.54244587  0.01936417</span></span>
<span><span class="co">#&gt; [23,]  0.49795898 -0.11485376</span></span>
<span><span class="co">#&gt; [24,]  0.69509909  0.45274834</span></span>
<span><span class="co">#&gt; [25,]  0.63284087  1.48814559</span></span>
<span><span class="co">#&gt; [26,] -1.47632294 -0.92299854</span></span>
<span><span class="co">#&gt; [27,] -1.78763671 -0.97448637</span></span>
<span><span class="co">#&gt; [28,]  2.35063076  1.50826223</span></span>
<span><span class="co">#&gt; [29,]  1.67726281  0.73013283</span></span>
<span><span class="co">#&gt; [30,]  2.48613792  1.55203022</span></span>
<span><span class="co">#&gt; [31,] -0.13610810  0.06171409</span></span>
<span><span class="co">#&gt; [32,] -0.79383525 -0.25751529</span></span>
<span><span class="co">#&gt; [33,] -0.70470857 -0.41256032</span></span>
<span><span class="co">#&gt; [34,]  0.53215200  0.47720624</span></span>
<span><span class="co">#&gt; [35,] -0.78427460 -1.15615114</span></span>
<span><span class="co">#&gt; [36,]  2.38131744  1.46510425</span></span>
<span><span class="co">#&gt; [37,]  3.68215047  2.20096870</span></span>
<span><span class="co">#&gt; [38,]  1.36156864  1.07925077</span></span>
<span><span class="co">#&gt; [39,] -1.08642784 -0.41158288</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res11</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes           TV.advert       </span></span>
<span><span class="co">#&gt;  Min.   :-3.36233   Min.   :-2.10297  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.86811   1st Qu.:-0.80083  </span></span>
<span><span class="co">#&gt;  Median :-0.05624   Median : 0.01878  </span></span>
<span><span class="co">#&gt;  Mean   : 0.00000   Mean   : 0.00000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.78011   3rd Qu.: 0.66913  </span></span>
<span><span class="co">#&gt;  Max.   : 3.68215   Max.   : 2.20097</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res11</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Quotes  TV.advert </span></span>
<span><span class="co">#&gt; 0.04802834 0.26497281</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res11</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9888696 0.5936285</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res11</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/bootstrap-kmeans-1.png" width="691.2"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res11</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/bootstrap-kmeans-2.png" width="691.2"></p>
</div>
</div>
<div class="section level2">
<h2 id="prediction-intervals-based-on-block-bootstrap">3 - Prediction intervals based on block bootstrap<a class="anchor" aria-label="anchor" href="#prediction-intervals-based-on-block-bootstrap"></a>
</h2>
<div class="section level3">
<h3 id="with-default-parameters-2">3 - 1 With default parameters<a class="anchor" aria-label="anchor" href="#with-default-parameters-2"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">block_length</span> <span class="op">&lt;-</span> <span class="fl">5L</span></span>
<span><span class="op">(</span><span class="va">res7</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                        type_pi <span class="op">=</span> <span class="st">"blockbootstrap"</span>, </span>
<span>                        block_length <span class="op">=</span> <span class="va">block_length</span>,</span>
<span>                        B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.13318  9.457489</span></span>
<span><span class="co">#&gt; Jun 2005 13.06337  8.059138</span></span>
<span><span class="co">#&gt; Jul 2005 12.29234  7.795193</span></span>
<span><span class="co">#&gt; Aug 2005 12.73193  7.997832</span></span>
<span><span class="co">#&gt; Sep 2005 12.95504  7.942264</span></span>
<span><span class="co">#&gt; Oct 2005 13.33709  8.048628</span></span>
<span><span class="co">#&gt; Nov 2005 14.27552  8.641482</span></span>
<span><span class="co">#&gt; Dec 2005 13.62071  8.193504</span></span>
<span><span class="co">#&gt; Jan 2006 13.64814  8.365103</span></span>
<span><span class="co">#&gt; Feb 2006 13.39110  8.073276</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.640946  8.306569</span></span>
<span><span class="co">#&gt; Jun 2005 10.252219  6.779478</span></span>
<span><span class="co">#&gt; Jul 2005  9.527768  6.292099</span></span>
<span><span class="co">#&gt; Aug 2005 10.764155  6.980176</span></span>
<span><span class="co">#&gt; Sep 2005 10.343459  6.313223</span></span>
<span><span class="co">#&gt; Oct 2005 10.244834  6.218023</span></span>
<span><span class="co">#&gt; Nov 2005 12.441824  8.122031</span></span>
<span><span class="co">#&gt; Dec 2005  9.709844  5.664417</span></span>
<span><span class="co">#&gt; Jan 2006  8.779085  5.462274</span></span>
<span><span class="co">#&gt; Feb 2006  8.997235  5.866455</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.66178 10.256485</span></span>
<span><span class="co">#&gt; Jun 2005 15.70532  9.203036</span></span>
<span><span class="co">#&gt; Jul 2005 15.91362 10.524887</span></span>
<span><span class="co">#&gt; Aug 2005 15.81746  9.412302</span></span>
<span><span class="co">#&gt; Sep 2005 17.83907 10.571785</span></span>
<span><span class="co">#&gt; Oct 2005 17.24635 10.231500</span></span>
<span><span class="co">#&gt; Nov 2005 15.92240  9.537640</span></span>
<span><span class="co">#&gt; Dec 2005 17.98942 10.281448</span></span>
<span><span class="co">#&gt; Jan 2006 19.43840 11.082768</span></span>
<span><span class="co">#&gt; Feb 2006 19.10688 11.037584</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.961639  9.917500</span></span>
<span><span class="co">#&gt; Jun 2005 12.743466  8.424202</span></span>
<span><span class="co">#&gt; Jul 2005 10.975130  7.368483</span></span>
<span><span class="co">#&gt; Aug 2005 10.575207  6.859284</span></span>
<span><span class="co">#&gt; Sep 2005 10.219173  6.588731</span></span>
<span><span class="co">#&gt; Oct 2005 10.184934  6.103088</span></span>
<span><span class="co">#&gt; Nov 2005 13.689388  8.851325</span></span>
<span><span class="co">#&gt; Dec 2005  9.389090  5.325269</span></span>
<span><span class="co">#&gt; Jan 2006  8.593317  5.164489</span></span>
<span><span class="co">#&gt; Feb 2006  9.911279  5.838859</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.923084 10.170358</span></span>
<span><span class="co">#&gt; Jun 2005 10.252219  6.779478</span></span>
<span><span class="co">#&gt; Jul 2005  9.527768  6.292099</span></span>
<span><span class="co">#&gt; Aug 2005 13.169226  8.421625</span></span>
<span><span class="co">#&gt; Sep 2005 14.211894  8.687393</span></span>
<span><span class="co">#&gt; Oct 2005 14.800152  8.720328</span></span>
<span><span class="co">#&gt; Nov 2005 15.592098  8.705125</span></span>
<span><span class="co">#&gt; Dec 2005 16.399773  9.292347</span></span>
<span><span class="co">#&gt; Jan 2006 16.353486  9.145230</span></span>
<span><span class="co">#&gt; Feb 2006 17.237784  9.606621</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.923084 10.170358</span></span>
<span><span class="co">#&gt; Jun 2005 10.252219  6.779478</span></span>
<span><span class="co">#&gt; Jul 2005  9.527768  6.292099</span></span>
<span><span class="co">#&gt; Aug 2005 13.169226  8.421625</span></span>
<span><span class="co">#&gt; Sep 2005 14.211894  8.687393</span></span>
<span><span class="co">#&gt; Oct 2005 12.826568  7.584607</span></span>
<span><span class="co">#&gt; Nov 2005 14.675960  8.544418</span></span>
<span><span class="co">#&gt; Dec 2005 15.571327  8.625669</span></span>
<span><span class="co">#&gt; Jan 2006 16.417689  9.255064</span></span>
<span><span class="co">#&gt; Feb 2006 16.383271  9.126644</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.59321  8.278953</span></span>
<span><span class="co">#&gt; Jun 2005 11.20004  7.117434</span></span>
<span><span class="co">#&gt; Jul 2005 11.46427  7.551714</span></span>
<span><span class="co">#&gt; Aug 2005 12.22603  7.424259</span></span>
<span><span class="co">#&gt; Sep 2005 13.55649  8.331353</span></span>
<span><span class="co">#&gt; Oct 2005 12.81698  7.949924</span></span>
<span><span class="co">#&gt; Nov 2005 13.54421  8.564323</span></span>
<span><span class="co">#&gt; Dec 2005 12.06123  6.832594</span></span>
<span><span class="co">#&gt; Jan 2006 15.68414  9.311793</span></span>
<span><span class="co">#&gt; Feb 2006 18.64480 11.054873</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.80524 10.181310</span></span>
<span><span class="co">#&gt; Jun 2005 14.94485  9.028306</span></span>
<span><span class="co">#&gt; Jul 2005 13.57398  8.380690</span></span>
<span><span class="co">#&gt; Aug 2005 12.66011  7.870669</span></span>
<span><span class="co">#&gt; Sep 2005 13.41813  8.498107</span></span>
<span><span class="co">#&gt; Oct 2005 12.95384  7.940495</span></span>
<span><span class="co">#&gt; Nov 2005 13.59121  8.033005</span></span>
<span><span class="co">#&gt; Dec 2005 13.35516  8.005734</span></span>
<span><span class="co">#&gt; Jan 2006 14.59959  9.748521</span></span>
<span><span class="co">#&gt; Feb 2006 12.42439  8.281098</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.729535  9.142963</span></span>
<span><span class="co">#&gt; Jun 2005 15.705318  9.203036</span></span>
<span><span class="co">#&gt; Jul 2005 15.913618 10.524887</span></span>
<span><span class="co">#&gt; Aug 2005 11.576221  7.396579</span></span>
<span><span class="co">#&gt; Sep 2005 10.771554  6.936910</span></span>
<span><span class="co">#&gt; Oct 2005 12.588134  7.571416</span></span>
<span><span class="co">#&gt; Nov 2005 13.803821  8.428673</span></span>
<span><span class="co">#&gt; Dec 2005 14.228496  9.854274</span></span>
<span><span class="co">#&gt; Jan 2006  9.606171  6.487977</span></span>
<span><span class="co">#&gt; Feb 2006  8.887510  5.961508</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.729535  9.142963</span></span>
<span><span class="co">#&gt; Jun 2005 15.705318  9.203036</span></span>
<span><span class="co">#&gt; Jul 2005 15.913618 10.524887</span></span>
<span><span class="co">#&gt; Aug 2005 11.576221  7.396579</span></span>
<span><span class="co">#&gt; Sep 2005 10.771554  6.936910</span></span>
<span><span class="co">#&gt; Oct 2005 10.451156  6.613910</span></span>
<span><span class="co">#&gt; Nov 2005 12.121776  8.478145</span></span>
<span><span class="co">#&gt; Dec 2005 10.814666  7.561439</span></span>
<span><span class="co">#&gt; Jan 2006  9.418952  6.567691</span></span>
<span><span class="co">#&gt; Feb 2006  9.375176  6.226668</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.69348  8.890481</span></span>
<span><span class="co">#&gt; Jun 2005 13.48778  8.217040</span></span>
<span><span class="co">#&gt; Jul 2005 11.16029  7.102348</span></span>
<span><span class="co">#&gt; Aug 2005 11.41497  7.526636</span></span>
<span><span class="co">#&gt; Sep 2005 12.18701  7.403738</span></span>
<span><span class="co">#&gt; Oct 2005 16.57467 10.085307</span></span>
<span><span class="co">#&gt; Nov 2005 15.88382  9.736893</span></span>
<span><span class="co">#&gt; Dec 2005 12.94425  8.027855</span></span>
<span><span class="co">#&gt; Jan 2006 14.79569  9.634984</span></span>
<span><span class="co">#&gt; Feb 2006 10.75217  6.322139</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.80537  8.401690</span></span>
<span><span class="co">#&gt; Jun 2005 14.39382  8.981247</span></span>
<span><span class="co">#&gt; Jul 2005 12.72469  7.125754</span></span>
<span><span class="co">#&gt; Aug 2005 16.09680  9.479206</span></span>
<span><span class="co">#&gt; Sep 2005 18.89212 11.118867</span></span>
<span><span class="co">#&gt; Oct 2005 17.44136 10.273943</span></span>
<span><span class="co">#&gt; Nov 2005 15.93361  8.588339</span></span>
<span><span class="co">#&gt; Dec 2005 18.45093 10.405466</span></span>
<span><span class="co">#&gt; Jan 2006 20.31538 11.470130</span></span>
<span><span class="co">#&gt; Feb 2006 19.24104 10.978036</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.16762 10.278310</span></span>
<span><span class="co">#&gt; Jun 2005 11.94868  6.858120</span></span>
<span><span class="co">#&gt; Jul 2005 12.14228  6.788973</span></span>
<span><span class="co">#&gt; Aug 2005 14.85531  9.181855</span></span>
<span><span class="co">#&gt; Sep 2005 11.31063  6.233237</span></span>
<span><span class="co">#&gt; Oct 2005 12.73315  7.643266</span></span>
<span><span class="co">#&gt; Nov 2005 13.91935  8.484571</span></span>
<span><span class="co">#&gt; Dec 2005 12.99215  8.004390</span></span>
<span><span class="co">#&gt; Jan 2006 10.69701  6.865152</span></span>
<span><span class="co">#&gt; Feb 2006 11.05357  7.336318</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;            Quotes   TV.advert</span></span>
<span><span class="co">#&gt;  [1,]  1.40368643  1.33052782</span></span>
<span><span class="co">#&gt;  [2,] -1.08056990 -1.14582835</span></span>
<span><span class="co">#&gt;  [3,] -1.23343504 -1.15469695</span></span>
<span><span class="co">#&gt;  [4,]  1.40368643  1.33052782</span></span>
<span><span class="co">#&gt;  [5,] -2.58725990 -2.26486335</span></span>
<span><span class="co">#&gt;  [6,] -3.07477874 -1.76651025</span></span>
<span><span class="co">#&gt;  [7,] -1.31677412 -1.06553020</span></span>
<span><span class="co">#&gt;  [8,]  0.65681006  0.07019039</span></span>
<span><span class="co">#&gt;  [9,]  0.33076863 -0.40143292</span></span>
<span><span class="co">#&gt; [10,]  0.51993723  0.22434076</span></span>
<span><span class="co">#&gt; [11,]  0.10053432 -0.17249791</span></span>
<span><span class="co">#&gt; [12,]  0.95770684  0.35761548</span></span>
<span><span class="co">#&gt; [13,]  0.26825909 -0.01668861</span></span>
<span><span class="co">#&gt; [14,] -0.12839403 -0.42852687</span></span>
<span><span class="co">#&gt; [15,] -1.17137522 -0.76232506</span></span>
<span><span class="co">#&gt; [16,]  0.19770654  0.96971721</span></span>
<span><span class="co">#&gt; [17,]  1.62259434  1.31981494</span></span>
<span><span class="co">#&gt; [18,] -0.14704277  0.17362676</span></span>
<span><span class="co">#&gt; [19,] -0.07045343 -0.05730098</span></span>
<span><span class="co">#&gt; [20,] -1.17072203 -0.66882907</span></span>
<span><span class="co">#&gt; [21,] -2.89887258 -1.53863637</span></span>
<span><span class="co">#&gt; [22,] -0.62736155 -0.06504866</span></span>
<span><span class="co">#&gt; [23,]  0.96560231  0.19518092</span></span>
<span><span class="co">#&gt; [24,] -0.09354593 -0.06951135</span></span>
<span><span class="co">#&gt; [25,]  0.15915097  1.22257588</span></span>
<span><span class="co">#&gt; [26,]  0.29875209  0.25719228</span></span>
<span><span class="co">#&gt; [27,] -1.31329880 -0.69076345</span></span>
<span><span class="co">#&gt; [28,]  2.48926902  1.54309187</span></span>
<span><span class="co">#&gt; [29,]  1.91175656  0.91165371</span></span>
<span><span class="co">#&gt; [30,]  2.04130891  1.23352769</span></span>
<span><span class="co">#&gt; [31,] -0.29759583 -0.05351566</span></span>
<span><span class="co">#&gt; [32,] -1.22025180 -0.56162404</span></span>
<span><span class="co">#&gt; [33,] -0.95856611 -0.54609232</span></span>
<span><span class="co">#&gt; [34,]  0.20717781  0.29095534</span></span>
<span><span class="co">#&gt; [35,] -0.70462371 -1.15899926</span></span>
<span><span class="co">#&gt; [36,]  2.26007518  1.40841386</span></span>
<span><span class="co">#&gt; [37,]  2.95319223  1.69957104</span></span>
<span><span class="co">#&gt; [38,]  0.89317411  0.77051186</span></span>
<span><span class="co">#&gt; [39,] -1.54622760 -0.71981400</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res7</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert       </span></span>
<span><span class="co">#&gt;  Min.   :-3.0748   Min.   :-2.26486  </span></span>
<span><span class="co">#&gt;  1st Qu.:-1.1256   1st Qu.:-0.67980  </span></span>
<span><span class="co">#&gt;  Median : 0.1005   Median :-0.05352  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.00000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.9254   3rd Qu.: 0.84108  </span></span>
<span><span class="co">#&gt;  Max.   : 2.9532   Max.   : 1.69957</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res7</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Quotes  TV.advert </span></span>
<span><span class="co">#&gt; 0.06458106 0.32251812</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res7</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.7471878 0.3924569</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res7</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-default-1.png" width="691.2"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res7</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-default-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-external-regressors-2">3 - 2 With external regressors<a class="anchor" aria-label="anchor" href="#with-external-regressors-2"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res8</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, xreg <span class="op">=</span> <span class="va">xreg</span>, </span>
<span>                        type_pi <span class="op">=</span> <span class="st">"blockbootstrap"</span>, </span>
<span>                        block_length <span class="op">=</span> <span class="va">block_length</span>,</span>
<span>                        B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.93292  9.927867</span></span>
<span><span class="co">#&gt; Jun 2005 14.62582  9.159010</span></span>
<span><span class="co">#&gt; Jul 2005 13.75974  8.768195</span></span>
<span><span class="co">#&gt; Aug 2005 14.37756  9.002538</span></span>
<span><span class="co">#&gt; Sep 2005 14.82859  9.086496</span></span>
<span><span class="co">#&gt; Oct 2005 15.50606  9.312723</span></span>
<span><span class="co">#&gt; Nov 2005 16.56312  9.907583</span></span>
<span><span class="co">#&gt; Dec 2005 16.46826  9.883022</span></span>
<span><span class="co">#&gt; Jan 2006 16.63819 10.087099</span></span>
<span><span class="co">#&gt; Feb 2006 17.05429 10.250023</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.29124  8.706589</span></span>
<span><span class="co">#&gt; Jun 2005 11.34974  7.525175</span></span>
<span><span class="co">#&gt; Jul 2005 10.98139  7.100955</span></span>
<span><span class="co">#&gt; Aug 2005 11.91583  7.837910</span></span>
<span><span class="co">#&gt; Sep 2005 12.13687  7.691967</span></span>
<span><span class="co">#&gt; Oct 2005 12.46851  7.484113</span></span>
<span><span class="co">#&gt; Nov 2005 14.81651  8.811267</span></span>
<span><span class="co">#&gt; Dec 2005 13.63208  7.894731</span></span>
<span><span class="co">#&gt; Jan 2006 12.49490  7.621327</span></span>
<span><span class="co">#&gt; Feb 2006 12.76658  8.094808</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.39057  10.95110</span></span>
<span><span class="co">#&gt; Jun 2005 17.55234  10.44702</span></span>
<span><span class="co">#&gt; Jul 2005 17.42791  11.45397</span></span>
<span><span class="co">#&gt; Aug 2005 16.72187  10.33188</span></span>
<span><span class="co">#&gt; Sep 2005 18.98099  11.22142</span></span>
<span><span class="co">#&gt; Oct 2005 18.50937  10.97776</span></span>
<span><span class="co">#&gt; Nov 2005 18.37324  10.94087</span></span>
<span><span class="co">#&gt; Dec 2005 19.72103  11.60998</span></span>
<span><span class="co">#&gt; Jan 2006 21.10967  12.08978</span></span>
<span><span class="co">#&gt; Feb 2006 21.21273  11.98270</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.12578  9.878841</span></span>
<span><span class="co">#&gt; Jun 2005 15.41501 10.378988</span></span>
<span><span class="co">#&gt; Jul 2005 12.54950  8.710196</span></span>
<span><span class="co">#&gt; Aug 2005 11.73579  7.789848</span></span>
<span><span class="co">#&gt; Sep 2005 12.11073  7.680743</span></span>
<span><span class="co">#&gt; Oct 2005 13.33255  7.974199</span></span>
<span><span class="co">#&gt; Nov 2005 17.34201 10.874971</span></span>
<span><span class="co">#&gt; Dec 2005 13.79355  8.378351</span></span>
<span><span class="co">#&gt; Jan 2006 12.38883  7.467185</span></span>
<span><span class="co">#&gt; Feb 2006 14.73481  8.531035</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.97876 10.768360</span></span>
<span><span class="co">#&gt; Jun 2005 11.34974  7.525175</span></span>
<span><span class="co">#&gt; Jul 2005 10.98139  7.100955</span></span>
<span><span class="co">#&gt; Aug 2005 15.44516  9.621484</span></span>
<span><span class="co">#&gt; Sep 2005 16.72932 10.088001</span></span>
<span><span class="co">#&gt; Oct 2005 17.51265 10.291912</span></span>
<span><span class="co">#&gt; Nov 2005 18.38565 10.321924</span></span>
<span><span class="co">#&gt; Dec 2005 19.81424 11.270619</span></span>
<span><span class="co">#&gt; Jan 2006 20.19970 11.421108</span></span>
<span><span class="co">#&gt; Feb 2006 21.35149 12.002285</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.97876 10.768360</span></span>
<span><span class="co">#&gt; Jun 2005 11.34974  7.525175</span></span>
<span><span class="co">#&gt; Jul 2005 10.98139  7.100955</span></span>
<span><span class="co">#&gt; Aug 2005 15.44516  9.621484</span></span>
<span><span class="co">#&gt; Sep 2005 16.72932 10.088001</span></span>
<span><span class="co">#&gt; Oct 2005 15.62793  9.254044</span></span>
<span><span class="co">#&gt; Nov 2005 17.82430 10.383988</span></span>
<span><span class="co">#&gt; Dec 2005 18.86784 10.533007</span></span>
<span><span class="co">#&gt; Jan 2006 20.29563 11.474313</span></span>
<span><span class="co">#&gt; Feb 2006 20.70262 11.633848</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.87468  9.024316</span></span>
<span><span class="co">#&gt; Jun 2005 13.12866  8.202981</span></span>
<span><span class="co">#&gt; Jul 2005 14.10769  8.998497</span></span>
<span><span class="co">#&gt; Aug 2005 15.00476  9.017367</span></span>
<span><span class="co">#&gt; Sep 2005 16.41816  9.940874</span></span>
<span><span class="co">#&gt; Oct 2005 14.91342  9.130982</span></span>
<span><span class="co">#&gt; Nov 2005 15.22212  9.548900</span></span>
<span><span class="co">#&gt; Dec 2005 13.58520  7.754325</span></span>
<span><span class="co">#&gt; Jan 2006 17.39954 10.286250</span></span>
<span><span class="co">#&gt; Feb 2006 20.27961 11.897792</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.46588 10.522770</span></span>
<span><span class="co">#&gt; Jun 2005 16.00567  9.593406</span></span>
<span><span class="co">#&gt; Jul 2005 14.80009  9.068744</span></span>
<span><span class="co">#&gt; Aug 2005 13.96074  8.614358</span></span>
<span><span class="co">#&gt; Sep 2005 14.60824  9.186582</span></span>
<span><span class="co">#&gt; Oct 2005 15.14617  9.290168</span></span>
<span><span class="co">#&gt; Nov 2005 15.48430  9.114929</span></span>
<span><span class="co">#&gt; Dec 2005 15.11850  8.843028</span></span>
<span><span class="co">#&gt; Jan 2006 16.78499 10.650305</span></span>
<span><span class="co">#&gt; Feb 2006 17.26246 11.243429</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.46143  9.591273</span></span>
<span><span class="co">#&gt; Jun 2005 17.55234 10.447025</span></span>
<span><span class="co">#&gt; Jul 2005 17.42791 11.453975</span></span>
<span><span class="co">#&gt; Aug 2005 12.53595  8.003457</span></span>
<span><span class="co">#&gt; Sep 2005 12.22690  7.730630</span></span>
<span><span class="co">#&gt; Oct 2005 15.07683  8.841656</span></span>
<span><span class="co">#&gt; Nov 2005 17.30371 10.303588</span></span>
<span><span class="co">#&gt; Dec 2005 17.73890 11.695926</span></span>
<span><span class="co">#&gt; Jan 2006 12.86025  8.227742</span></span>
<span><span class="co">#&gt; Feb 2006 12.63914  7.968162</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.46143  9.591273</span></span>
<span><span class="co">#&gt; Jun 2005 17.55234 10.447025</span></span>
<span><span class="co">#&gt; Jul 2005 17.42791 11.453975</span></span>
<span><span class="co">#&gt; Aug 2005 12.53595  8.003457</span></span>
<span><span class="co">#&gt; Sep 2005 12.22690  7.730630</span></span>
<span><span class="co">#&gt; Oct 2005 12.21766  7.341830</span></span>
<span><span class="co">#&gt; Nov 2005 15.04576  9.633535</span></span>
<span><span class="co">#&gt; Dec 2005 16.51964 10.856920</span></span>
<span><span class="co">#&gt; Jan 2006 13.96170  9.379486</span></span>
<span><span class="co">#&gt; Feb 2006 13.20556  8.565970</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.72942  9.514972</span></span>
<span><span class="co">#&gt; Jun 2005 15.17064  9.280168</span></span>
<span><span class="co">#&gt; Jul 2005 13.04263  8.213002</span></span>
<span><span class="co">#&gt; Aug 2005 13.96530  8.942326</span></span>
<span><span class="co">#&gt; Sep 2005 14.94964  8.987836</span></span>
<span><span class="co">#&gt; Oct 2005 18.69609 11.083351</span></span>
<span><span class="co">#&gt; Nov 2005 18.33051 10.960007</span></span>
<span><span class="co">#&gt; Dec 2005 15.39545  9.235400</span></span>
<span><span class="co">#&gt; Jan 2006 18.16634 11.572344</span></span>
<span><span class="co">#&gt; Feb 2006 15.14727  9.561710</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.12186  8.614346</span></span>
<span><span class="co">#&gt; Jun 2005 14.71754  9.221823</span></span>
<span><span class="co">#&gt; Jul 2005 13.10834  7.471507</span></span>
<span><span class="co">#&gt; Aug 2005 16.84335  9.976562</span></span>
<span><span class="co">#&gt; Sep 2005 19.63471 11.550480</span></span>
<span><span class="co">#&gt; Oct 2005 17.86625 10.614059</span></span>
<span><span class="co">#&gt; Nov 2005 15.94289  8.723108</span></span>
<span><span class="co">#&gt; Dec 2005 19.39999 11.313965</span></span>
<span><span class="co">#&gt; Jan 2006 21.34601 12.240000</span></span>
<span><span class="co">#&gt; Feb 2006 20.73479 11.915256</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.13115 11.004154</span></span>
<span><span class="co">#&gt; Jun 2005 14.01651  8.968336</span></span>
<span><span class="co">#&gt; Jul 2005 13.17051  8.110142</span></span>
<span><span class="co">#&gt; Aug 2005 16.30345 10.435035</span></span>
<span><span class="co">#&gt; Sep 2005 12.65203  7.881186</span></span>
<span><span class="co">#&gt; Oct 2005 14.67111  9.305029</span></span>
<span><span class="co">#&gt; Nov 2005 14.74995  9.210878</span></span>
<span><span class="co">#&gt; Dec 2005 14.44934  8.948683</span></span>
<span><span class="co">#&gt; Jan 2006 12.97897  8.152258</span></span>
<span><span class="co">#&gt; Feb 2006 14.48511  9.180738</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;            Quotes    TV.advert</span></span>
<span><span class="co">#&gt;  [1,]  1.67535261  1.600318363</span></span>
<span><span class="co">#&gt;  [2,] -0.09454667  0.059245589</span></span>
<span><span class="co">#&gt;  [3,] -0.61710349 -0.617562341</span></span>
<span><span class="co">#&gt;  [4,]  1.55432930  1.431543276</span></span>
<span><span class="co">#&gt;  [5,] -1.65830176 -1.201288646</span></span>
<span><span class="co">#&gt;  [6,] -3.27721670 -1.999680352</span></span>
<span><span class="co">#&gt;  [7,] -0.83986146 -0.746117612</span></span>
<span><span class="co">#&gt;  [8,]  1.04485279  0.291750330</span></span>
<span><span class="co">#&gt;  [9,]  0.75352722 -0.155143365</span></span>
<span><span class="co">#&gt; [10,]  0.26745241  0.004965096</span></span>
<span><span class="co">#&gt; [11,]  0.43157027  0.102861987</span></span>
<span><span class="co">#&gt; [12,]  1.13693270  0.494399368</span></span>
<span><span class="co">#&gt; [13,]  0.49053241  0.135721074</span></span>
<span><span class="co">#&gt; [14,] -0.10253286 -0.465058629</span></span>
<span><span class="co">#&gt; [15,] -1.85353900 -1.312388835</span></span>
<span><span class="co">#&gt; [16,] -0.33001834  0.475005003</span></span>
<span><span class="co">#&gt; [17,]  2.16635830  1.749815332</span></span>
<span><span class="co">#&gt; [18,]  0.17739319  0.443529161</span></span>
<span><span class="co">#&gt; [19,]  0.27361734  0.111136601</span></span>
<span><span class="co">#&gt; [20,] -0.58111949 -0.379519019</span></span>
<span><span class="co">#&gt; [21,] -2.30767070 -1.246635836</span></span>
<span><span class="co">#&gt; [22,] -0.19353452  0.176564889</span></span>
<span><span class="co">#&gt; [23,]  1.00563207  0.187437814</span></span>
<span><span class="co">#&gt; [24,]  0.41917089  0.235645632</span></span>
<span><span class="co">#&gt; [25,]  0.52295932  1.364524163</span></span>
<span><span class="co">#&gt; [26,] -0.95933919 -0.673442252</span></span>
<span><span class="co">#&gt; [27,] -1.56353647 -0.843576594</span></span>
<span><span class="co">#&gt; [28,]  2.26526358  1.468847972</span></span>
<span><span class="co">#&gt; [29,]  1.69164304  0.697529740</span></span>
<span><span class="co">#&gt; [30,]  2.01008148  1.118934668</span></span>
<span><span class="co">#&gt; [31,] -0.38235687 -0.261094013</span></span>
<span><span class="co">#&gt; [32,] -1.39361339 -0.785256869</span></span>
<span><span class="co">#&gt; [33,] -1.33394033 -0.789489620</span></span>
<span><span class="co">#&gt; [34,] -0.37279705 -0.008190995</span></span>
<span><span class="co">#&gt; [35,] -1.43004502 -1.625855697</span></span>
<span><span class="co">#&gt; [36,]  0.16351013  0.242165460</span></span>
<span><span class="co">#&gt; [37,]  2.64510868  1.356646561</span></span>
<span><span class="co">#&gt; [38,]  0.59781674  0.490409659</span></span>
<span><span class="co">#&gt; [39,] -2.00203118 -1.128697062</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res8</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert      </span></span>
<span><span class="co">#&gt;  Min.   :-3.2772   Min.   :-1.9997  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.8996   1st Qu.:-0.7098  </span></span>
<span><span class="co">#&gt;  Median : 0.1635   Median : 0.1029  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.0000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.8796   3rd Qu.: 0.4827  </span></span>
<span><span class="co">#&gt;  Max.   : 2.6451   Max.   : 1.7498</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res8</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.1553145 0.4247378</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res8</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9498845 0.5141136</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res8</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-xreg-1.png" width="691.2"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res8</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-xreg-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-external-regressors-and-k-means-clustering-2">3 - 3 With external regressors and K-Means clustering<a class="anchor" aria-label="anchor" href="#with-external-regressors-and-k-means-clustering-2"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res9</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                        xreg <span class="op">=</span> <span class="va">xreg</span>, centers <span class="op">=</span> <span class="va">centers</span>, </span>
<span>                        type_pi <span class="op">=</span> <span class="st">"blockbootstrap"</span>, </span>
<span>                        block_length <span class="op">=</span> <span class="va">block_length</span>,</span>
<span>                        B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.39363 10.956462</span></span>
<span><span class="co">#&gt; Jun 2005 15.32734  9.663891</span></span>
<span><span class="co">#&gt; Jul 2005 13.01520  8.462715</span></span>
<span><span class="co">#&gt; Aug 2005 14.30795  9.183655</span></span>
<span><span class="co">#&gt; Sep 2005 13.82213  8.684953</span></span>
<span><span class="co">#&gt; Oct 2005 15.50101  9.534365</span></span>
<span><span class="co">#&gt; Nov 2005 15.19927  9.272217</span></span>
<span><span class="co">#&gt; Dec 2005 15.44275  9.525640</span></span>
<span><span class="co">#&gt; Jan 2006 17.37508 10.905782</span></span>
<span><span class="co">#&gt; Feb 2006 18.05586 11.198881</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.14728  9.949966</span></span>
<span><span class="co">#&gt; Jun 2005 12.52053  7.901074</span></span>
<span><span class="co">#&gt; Jul 2005 10.35541  6.462820</span></span>
<span><span class="co">#&gt; Aug 2005 10.86573  7.069793</span></span>
<span><span class="co">#&gt; Sep 2005 10.68630  7.305022</span></span>
<span><span class="co">#&gt; Oct 2005 11.54633  7.180077</span></span>
<span><span class="co">#&gt; Nov 2005 12.28864  7.933619</span></span>
<span><span class="co">#&gt; Dec 2005 12.34999  7.209061</span></span>
<span><span class="co">#&gt; Jan 2006 11.82261  7.488115</span></span>
<span><span class="co">#&gt; Feb 2006 11.06547  7.540693</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 18.06444  12.17000</span></span>
<span><span class="co">#&gt; Jun 2005 17.58232  10.65359</span></span>
<span><span class="co">#&gt; Jul 2005 16.76485  11.25645</span></span>
<span><span class="co">#&gt; Aug 2005 16.46684  10.49139</span></span>
<span><span class="co">#&gt; Sep 2005 19.02135  11.43617</span></span>
<span><span class="co">#&gt; Oct 2005 20.27107  12.16026</span></span>
<span><span class="co">#&gt; Nov 2005 18.66400  10.75354</span></span>
<span><span class="co">#&gt; Dec 2005 21.94331  13.07700</span></span>
<span><span class="co">#&gt; Jan 2006 25.06197  14.92559</span></span>
<span><span class="co">#&gt; Feb 2006 27.86401  16.22140</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.82141 11.072938</span></span>
<span><span class="co">#&gt; Jun 2005 15.31206 10.300731</span></span>
<span><span class="co">#&gt; Jul 2005 12.68251  8.858470</span></span>
<span><span class="co">#&gt; Aug 2005 11.16030  7.598533</span></span>
<span><span class="co">#&gt; Sep 2005 13.53445  8.785540</span></span>
<span><span class="co">#&gt; Oct 2005 11.48830  7.132788</span></span>
<span><span class="co">#&gt; Nov 2005 16.17267 10.485054</span></span>
<span><span class="co">#&gt; Dec 2005 12.33995  7.812477</span></span>
<span><span class="co">#&gt; Jan 2006 12.05871  7.459504</span></span>
<span><span class="co">#&gt; Feb 2006 13.84908  8.181968</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 18.06444 12.169996</span></span>
<span><span class="co">#&gt; Jun 2005 15.06062  9.803147</span></span>
<span><span class="co">#&gt; Jul 2005 10.35541  7.015425</span></span>
<span><span class="co">#&gt; Aug 2005 16.32757 10.491386</span></span>
<span><span class="co">#&gt; Sep 2005 14.00206  8.542838</span></span>
<span><span class="co">#&gt; Oct 2005 20.54226 12.294248</span></span>
<span><span class="co">#&gt; Nov 2005 18.69799 10.357479</span></span>
<span><span class="co">#&gt; Dec 2005 22.80289 13.605061</span></span>
<span><span class="co">#&gt; Jan 2006 25.53267 15.151924</span></span>
<span><span class="co">#&gt; Feb 2006 28.64222 16.595618</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 18.06444 12.169996</span></span>
<span><span class="co">#&gt; Jun 2005 15.06062  9.803147</span></span>
<span><span class="co">#&gt; Jul 2005 10.35541  7.015425</span></span>
<span><span class="co">#&gt; Aug 2005 16.32757 10.491386</span></span>
<span><span class="co">#&gt; Sep 2005 14.00206  8.542838</span></span>
<span><span class="co">#&gt; Oct 2005 18.44692 11.119590</span></span>
<span><span class="co">#&gt; Nov 2005 18.54694 10.831490</span></span>
<span><span class="co">#&gt; Dec 2005 17.82191 10.048336</span></span>
<span><span class="co">#&gt; Jan 2006 23.06103 13.872155</span></span>
<span><span class="co">#&gt; Feb 2006 25.18352 14.932417</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.98829 10.432772</span></span>
<span><span class="co">#&gt; Jun 2005 12.42416  7.827292</span></span>
<span><span class="co">#&gt; Jul 2005 14.34085  9.307761</span></span>
<span><span class="co">#&gt; Aug 2005 13.56437  8.327571</span></span>
<span><span class="co">#&gt; Sep 2005 15.25635  9.414196</span></span>
<span><span class="co">#&gt; Oct 2005 11.74621  7.342958</span></span>
<span><span class="co">#&gt; Nov 2005 14.02463  8.797739</span></span>
<span><span class="co">#&gt; Dec 2005 12.38456  7.033875</span></span>
<span><span class="co">#&gt; Jan 2006 17.06191 10.120543</span></span>
<span><span class="co">#&gt; Feb 2006 21.36329 12.846685</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.83632 10.901091</span></span>
<span><span class="co">#&gt; Jun 2005 17.03125 10.472043</span></span>
<span><span class="co">#&gt; Jul 2005 14.59177  9.329591</span></span>
<span><span class="co">#&gt; Aug 2005 10.78022  6.916288</span></span>
<span><span class="co">#&gt; Sep 2005 13.61707  8.672344</span></span>
<span><span class="co">#&gt; Oct 2005 13.71126  8.656449</span></span>
<span><span class="co">#&gt; Nov 2005 13.50935  8.227707</span></span>
<span><span class="co">#&gt; Dec 2005 13.97536  8.507638</span></span>
<span><span class="co">#&gt; Jan 2006 16.47141 10.886484</span></span>
<span><span class="co">#&gt; Feb 2006 14.99904 10.327371</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.71992 10.519621</span></span>
<span><span class="co">#&gt; Jun 2005 17.58232 10.653589</span></span>
<span><span class="co">#&gt; Jul 2005 16.76485 11.256446</span></span>
<span><span class="co">#&gt; Aug 2005 14.30530  9.522930</span></span>
<span><span class="co">#&gt; Sep 2005 10.68630  7.305022</span></span>
<span><span class="co">#&gt; Oct 2005 15.32595  9.404004</span></span>
<span><span class="co">#&gt; Nov 2005 13.60859  8.463473</span></span>
<span><span class="co">#&gt; Dec 2005 14.95386 10.338206</span></span>
<span><span class="co">#&gt; Jan 2006 13.55924  9.120954</span></span>
<span><span class="co">#&gt; Feb 2006 10.80552  7.376831</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.71992 10.519621</span></span>
<span><span class="co">#&gt; Jun 2005 17.58232 10.653589</span></span>
<span><span class="co">#&gt; Jul 2005 16.76485 11.256446</span></span>
<span><span class="co">#&gt; Aug 2005 14.30530  9.522930</span></span>
<span><span class="co">#&gt; Sep 2005 10.68630  7.305022</span></span>
<span><span class="co">#&gt; Oct 2005 12.60375  8.024398</span></span>
<span><span class="co">#&gt; Nov 2005 12.91387  8.802365</span></span>
<span><span class="co">#&gt; Dec 2005 13.80778  9.481290</span></span>
<span><span class="co">#&gt; Jan 2006 12.80654  8.924245</span></span>
<span><span class="co">#&gt; Feb 2006 11.96083  8.105108</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.79008 10.383108</span></span>
<span><span class="co">#&gt; Jun 2005 13.93942  8.573201</span></span>
<span><span class="co">#&gt; Jul 2005 11.71636  7.455115</span></span>
<span><span class="co">#&gt; Aug 2005 13.93505  9.054271</span></span>
<span><span class="co">#&gt; Sep 2005 13.57815  8.311494</span></span>
<span><span class="co">#&gt; Oct 2005 17.34450 10.337137</span></span>
<span><span class="co">#&gt; Nov 2005 15.92128  9.769700</span></span>
<span><span class="co">#&gt; Dec 2005 14.01365  8.773361</span></span>
<span><span class="co">#&gt; Jan 2006 18.00455 11.789364</span></span>
<span><span class="co">#&gt; Feb 2006 15.90175 10.303007</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.96066  9.824215</span></span>
<span><span class="co">#&gt; Jun 2005 12.85247  8.155213</span></span>
<span><span class="co">#&gt; Jul 2005 11.39427  6.378208</span></span>
<span><span class="co">#&gt; Aug 2005 16.50727  9.772911</span></span>
<span><span class="co">#&gt; Sep 2005 20.11441 12.023197</span></span>
<span><span class="co">#&gt; Oct 2005 19.33697 11.698746</span></span>
<span><span class="co">#&gt; Nov 2005 16.49027  9.138918</span></span>
<span><span class="co">#&gt; Dec 2005 18.98253 11.258109</span></span>
<span><span class="co">#&gt; Jan 2006 23.44069 14.145984</span></span>
<span><span class="co">#&gt; Feb 2006 23.77138 14.099723</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 17.97083 11.571263</span></span>
<span><span class="co">#&gt; Jun 2005 16.42812 10.396952</span></span>
<span><span class="co">#&gt; Jul 2005 11.18577  6.754259</span></span>
<span><span class="co">#&gt; Aug 2005 15.86655 10.138341</span></span>
<span><span class="co">#&gt; Sep 2005 12.74417  7.947039</span></span>
<span><span class="co">#&gt; Oct 2005 14.46394  9.333333</span></span>
<span><span class="co">#&gt; Nov 2005 12.10712  7.848239</span></span>
<span><span class="co">#&gt; Dec 2005 13.34502  8.398047</span></span>
<span><span class="co">#&gt; Jan 2006 11.75407  7.586662</span></span>
<span><span class="co">#&gt; Feb 2006 14.08193  9.220084</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;            Quotes   TV.advert</span></span>
<span><span class="co">#&gt;  [1,]  1.11874618  1.19921616</span></span>
<span><span class="co">#&gt;  [2,]  0.09390745  0.01901986</span></span>
<span><span class="co">#&gt;  [3,] -1.43434322 -1.16781389</span></span>
<span><span class="co">#&gt;  [4,]  1.27193197  1.24470742</span></span>
<span><span class="co">#&gt;  [5,] -1.49065784 -1.21723396</span></span>
<span><span class="co">#&gt;  [6,] -2.34261676 -1.51417390</span></span>
<span><span class="co">#&gt;  [7,] -0.46298299 -0.60250287</span></span>
<span><span class="co">#&gt;  [8,]  1.63235318  0.57215494</span></span>
<span><span class="co">#&gt;  [9,]  0.40411221 -0.32801633</span></span>
<span><span class="co">#&gt; [10,]  0.48277892  0.18055867</span></span>
<span><span class="co">#&gt; [11,]  0.57087239  0.21240486</span></span>
<span><span class="co">#&gt; [12,]  1.17734665  0.57331263</span></span>
<span><span class="co">#&gt; [13,]  0.11531808  0.03121107</span></span>
<span><span class="co">#&gt; [14,] -0.42672324 -0.52697371</span></span>
<span><span class="co">#&gt; [15,] -1.85435793 -1.23203209</span></span>
<span><span class="co">#&gt; [16,] -0.03066633  0.70089111</span></span>
<span><span class="co">#&gt; [17,]  2.03550258  1.71783757</span></span>
<span><span class="co">#&gt; [18,]  0.10090940  0.43690274</span></span>
<span><span class="co">#&gt; [19,] -0.06200294  0.01106144</span></span>
<span><span class="co">#&gt; [20,]  0.13620873  0.06072585</span></span>
<span><span class="co">#&gt; [21,] -1.89082466 -0.95683806</span></span>
<span><span class="co">#&gt; [22,] -0.59474544  0.01552906</span></span>
<span><span class="co">#&gt; [23,]  0.86784469  0.14757423</span></span>
<span><span class="co">#&gt; [24,]  0.64438935  0.39749239</span></span>
<span><span class="co">#&gt; [25,]  1.21235947  1.79794968</span></span>
<span><span class="co">#&gt; [26,] -0.72834160 -0.52926182</span></span>
<span><span class="co">#&gt; [27,] -2.25083381 -1.18159761</span></span>
<span><span class="co">#&gt; [28,]  1.33778080  0.97343623</span></span>
<span><span class="co">#&gt; [29,]  1.97229999  0.89921107</span></span>
<span><span class="co">#&gt; [30,]  0.98424529  0.52904493</span></span>
<span><span class="co">#&gt; [31,] -0.10842601 -0.11619745</span></span>
<span><span class="co">#&gt; [32,] -2.24369150 -1.28978017</span></span>
<span><span class="co">#&gt; [33,] -0.89142004 -0.54783127</span></span>
<span><span class="co">#&gt; [34,] -0.04783669  0.13304638</span></span>
<span><span class="co">#&gt; [35,] -1.11899454 -1.45036144</span></span>
<span><span class="co">#&gt; [36,]  0.60160639  0.35230619</span></span>
<span><span class="co">#&gt; [37,]  2.54250721  1.21587964</span></span>
<span><span class="co">#&gt; [38,]  0.43166441  0.33684394</span></span>
<span><span class="co">#&gt; [39,] -1.75521983 -1.09770352</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res9</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes          TV.advert       </span></span>
<span><span class="co">#&gt;  Min.   :-2.3426   Min.   :-1.51417  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.8099   1st Qu.:-0.57517  </span></span>
<span><span class="co">#&gt;  Median : 0.1009   Median : 0.06073  </span></span>
<span><span class="co">#&gt;  Mean   : 0.0000   Mean   : 0.00000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.9260   3rd Qu.: 0.55060  </span></span>
<span><span class="co">#&gt;  Max.   : 2.5425   Max.   : 1.79795</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res9</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.2913532 0.6500526</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res9</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.4150247 0.2507454</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res9</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-xreg-clustering-1.png" width="691.2"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res9</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-xreg-clustering-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="with-k-means-clustering-2">3 - 4 With K-Means clustering<a class="anchor" aria-label="anchor" href="#with-k-means-clustering-2"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res12</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                         centers <span class="op">=</span> <span class="va">centers</span>, </span>
<span>                         type_pi <span class="op">=</span> <span class="st">"blockbootstrap"</span>, </span>
<span>                         block_length <span class="op">=</span> <span class="va">block_length</span>,</span>
<span>                         B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.51281  9.015085</span></span>
<span><span class="co">#&gt; Jun 2005 13.23118  7.958613</span></span>
<span><span class="co">#&gt; Jul 2005 12.82519  7.737483</span></span>
<span><span class="co">#&gt; Aug 2005 13.51905  8.276239</span></span>
<span><span class="co">#&gt; Sep 2005 13.62542  8.047506</span></span>
<span><span class="co">#&gt; Oct 2005 13.98444  8.116326</span></span>
<span><span class="co">#&gt; Nov 2005 14.78781  8.551834</span></span>
<span><span class="co">#&gt; Dec 2005 14.85769  8.456788</span></span>
<span><span class="co">#&gt; Jan 2006 14.95417  8.951681</span></span>
<span><span class="co">#&gt; Feb 2006 14.46327  8.860760</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.265492  7.992650</span></span>
<span><span class="co">#&gt; Jun 2005 10.011067  6.730118</span></span>
<span><span class="co">#&gt; Jul 2005  9.204177  5.861179</span></span>
<span><span class="co">#&gt; Aug 2005 11.973064  7.397854</span></span>
<span><span class="co">#&gt; Sep 2005 10.636133  6.193960</span></span>
<span><span class="co">#&gt; Oct 2005 10.445116  5.935517</span></span>
<span><span class="co">#&gt; Nov 2005 11.876683  7.255208</span></span>
<span><span class="co">#&gt; Dec 2005 10.265930  5.726151</span></span>
<span><span class="co">#&gt; Jan 2006  8.507776  5.625904</span></span>
<span><span class="co">#&gt; Feb 2006  8.972333  5.749044</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.33594 10.027338</span></span>
<span><span class="co">#&gt; Jun 2005 16.24500  9.073878</span></span>
<span><span class="co">#&gt; Jul 2005 17.42852 10.647134</span></span>
<span><span class="co">#&gt; Aug 2005 16.79755  9.613295</span></span>
<span><span class="co">#&gt; Sep 2005 19.38790 11.284791</span></span>
<span><span class="co">#&gt; Oct 2005 18.43310 10.642500</span></span>
<span><span class="co">#&gt; Nov 2005 18.73383 10.685986</span></span>
<span><span class="co">#&gt; Dec 2005 18.11738 10.017318</span></span>
<span><span class="co">#&gt; Jan 2006 21.39913 12.165645</span></span>
<span><span class="co">#&gt; Feb 2006 22.41147 13.357304</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.708143  9.097808</span></span>
<span><span class="co">#&gt; Jun 2005 13.823827  8.723703</span></span>
<span><span class="co">#&gt; Jul 2005 12.985556  7.775434</span></span>
<span><span class="co">#&gt; Aug 2005 13.002288  8.319168</span></span>
<span><span class="co">#&gt; Sep 2005 11.866496  7.127413</span></span>
<span><span class="co">#&gt; Oct 2005 11.510448  6.770107</span></span>
<span><span class="co">#&gt; Nov 2005 13.720577  9.022614</span></span>
<span><span class="co">#&gt; Dec 2005  9.872584  5.481126</span></span>
<span><span class="co">#&gt; Jan 2006  8.226746  5.428077</span></span>
<span><span class="co">#&gt; Feb 2006  8.661913  5.570686</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.740008  9.977827</span></span>
<span><span class="co">#&gt; Jun 2005 10.011067  6.804492</span></span>
<span><span class="co">#&gt; Jul 2005  9.204177  5.861179</span></span>
<span><span class="co">#&gt; Aug 2005 13.246686  8.256440</span></span>
<span><span class="co">#&gt; Sep 2005 14.839684  8.638325</span></span>
<span><span class="co">#&gt; Oct 2005 15.631654  9.011983</span></span>
<span><span class="co">#&gt; Nov 2005 16.541170  8.472721</span></span>
<span><span class="co">#&gt; Dec 2005 18.020906 10.018941</span></span>
<span><span class="co">#&gt; Jan 2006 17.078373  9.955407</span></span>
<span><span class="co">#&gt; Feb 2006 16.392166  9.716583</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.740008  9.977827</span></span>
<span><span class="co">#&gt; Jun 2005 10.011067  6.804492</span></span>
<span><span class="co">#&gt; Jul 2005  9.204177  5.861179</span></span>
<span><span class="co">#&gt; Aug 2005 13.246686  8.256440</span></span>
<span><span class="co">#&gt; Sep 2005 14.839684  8.638325</span></span>
<span><span class="co">#&gt; Oct 2005 13.660979  7.898109</span></span>
<span><span class="co">#&gt; Nov 2005 15.506526  8.218883</span></span>
<span><span class="co">#&gt; Dec 2005 17.067402  8.785388</span></span>
<span><span class="co">#&gt; Jan 2006 18.227690 10.460169</span></span>
<span><span class="co">#&gt; Feb 2006 16.289102  9.816177</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.22573  7.968126</span></span>
<span><span class="co">#&gt; Jun 2005 11.18621  6.708525</span></span>
<span><span class="co">#&gt; Jul 2005 12.05381  7.414828</span></span>
<span><span class="co">#&gt; Aug 2005 13.43576  7.497384</span></span>
<span><span class="co">#&gt; Sep 2005 15.38119  8.639415</span></span>
<span><span class="co">#&gt; Oct 2005 15.38756  8.490611</span></span>
<span><span class="co">#&gt; Nov 2005 17.10059  9.536766</span></span>
<span><span class="co">#&gt; Dec 2005 16.57768  8.263104</span></span>
<span><span class="co">#&gt; Jan 2006 21.23660 11.215624</span></span>
<span><span class="co">#&gt; Feb 2006 23.43130 13.838238</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.59331 10.041712</span></span>
<span><span class="co">#&gt; Jun 2005 14.65011  8.987163</span></span>
<span><span class="co">#&gt; Jul 2005 12.88358  8.196931</span></span>
<span><span class="co">#&gt; Aug 2005 11.88947  7.415110</span></span>
<span><span class="co">#&gt; Sep 2005 12.78137  8.239067</span></span>
<span><span class="co">#&gt; Oct 2005 12.37170  7.570947</span></span>
<span><span class="co">#&gt; Nov 2005 12.55772  7.107249</span></span>
<span><span class="co">#&gt; Dec 2005 12.01519  6.570126</span></span>
<span><span class="co">#&gt; Jan 2006 13.65345  8.300098</span></span>
<span><span class="co">#&gt; Feb 2006 15.70388  9.272431</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.60513  8.374828</span></span>
<span><span class="co">#&gt; Jun 2005 16.24500  9.073878</span></span>
<span><span class="co">#&gt; Jul 2005 17.42852 10.647134</span></span>
<span><span class="co">#&gt; Aug 2005 13.00449  8.327721</span></span>
<span><span class="co">#&gt; Sep 2005 10.63613  6.755276</span></span>
<span><span class="co">#&gt; Oct 2005 12.59529  6.898842</span></span>
<span><span class="co">#&gt; Nov 2005 14.72629  8.516219</span></span>
<span><span class="co">#&gt; Dec 2005 15.79601 10.011731</span></span>
<span><span class="co">#&gt; Jan 2006 11.78220  7.555532</span></span>
<span><span class="co">#&gt; Feb 2006 10.65551  6.363389</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.60513  8.374828</span></span>
<span><span class="co">#&gt; Jun 2005 16.24500  9.073878</span></span>
<span><span class="co">#&gt; Jul 2005 17.42852 10.647134</span></span>
<span><span class="co">#&gt; Aug 2005 13.00449  8.327721</span></span>
<span><span class="co">#&gt; Sep 2005 10.63613  6.755276</span></span>
<span><span class="co">#&gt; Oct 2005 10.13583  5.693216</span></span>
<span><span class="co">#&gt; Nov 2005 11.70276  7.901233</span></span>
<span><span class="co">#&gt; Dec 2005 13.44827  8.585715</span></span>
<span><span class="co">#&gt; Jan 2006 12.66159  7.604806</span></span>
<span><span class="co">#&gt; Feb 2006 12.68982  8.254080</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.05871  8.541413</span></span>
<span><span class="co">#&gt; Jun 2005 13.06677  7.477091</span></span>
<span><span class="co">#&gt; Jul 2005 11.35088  6.837713</span></span>
<span><span class="co">#&gt; Aug 2005 12.26101  7.392845</span></span>
<span><span class="co">#&gt; Sep 2005 13.72248  7.598158</span></span>
<span><span class="co">#&gt; Oct 2005 18.69996 10.457618</span></span>
<span><span class="co">#&gt; Nov 2005 19.20800 11.019630</span></span>
<span><span class="co">#&gt; Dec 2005 16.01270  9.630958</span></span>
<span><span class="co">#&gt; Jan 2006 15.75294 10.248332</span></span>
<span><span class="co">#&gt; Feb 2006 11.86871  7.214686</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.40246  8.077121</span></span>
<span><span class="co">#&gt; Jun 2005 14.35696  8.591234</span></span>
<span><span class="co">#&gt; Jul 2005 13.32299  7.043137</span></span>
<span><span class="co">#&gt; Aug 2005 17.40934  9.718443</span></span>
<span><span class="co">#&gt; Sep 2005 20.55114 12.052804</span></span>
<span><span class="co">#&gt; Oct 2005 17.51390 10.696175</span></span>
<span><span class="co">#&gt; Nov 2005 14.33869  7.764844</span></span>
<span><span class="co">#&gt; Dec 2005 18.14539  9.894546</span></span>
<span><span class="co">#&gt; Jan 2006 21.44632 12.441457</span></span>
<span><span class="co">#&gt; Feb 2006 18.89871 11.700751</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.44948  9.719358</span></span>
<span><span class="co">#&gt; Jun 2005 12.71580  7.341674</span></span>
<span><span class="co">#&gt; Jul 2005 12.38966  7.090157</span></span>
<span><span class="co">#&gt; Aug 2005 14.69030  9.251118</span></span>
<span><span class="co">#&gt; Sep 2005 10.99989  6.030998</span></span>
<span><span class="co">#&gt; Oct 2005 12.33706  7.675653</span></span>
<span><span class="co">#&gt; Nov 2005 12.47576  7.958183</span></span>
<span><span class="co">#&gt; Dec 2005 11.62079  7.326245</span></span>
<span><span class="co">#&gt; Jan 2006  9.47577  6.307308</span></span>
<span><span class="co">#&gt; Feb 2006 10.04156  6.860583</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;            Quotes   TV.advert</span></span>
<span><span class="co">#&gt;  [1,]  1.34231135  1.22967612</span></span>
<span><span class="co">#&gt;  [2,] -0.85477619 -0.98393029</span></span>
<span><span class="co">#&gt;  [3,] -1.00310653 -1.06267921</span></span>
<span><span class="co">#&gt;  [4,]  1.34231135  1.22967612</span></span>
<span><span class="co">#&gt;  [5,] -2.36146619 -2.10296529</span></span>
<span><span class="co">#&gt;  [6,] -3.36233492 -1.98959149</span></span>
<span><span class="co">#&gt;  [7,] -1.19409276 -0.96452874</span></span>
<span><span class="co">#&gt;  [8,]  0.77658242  0.14934530</span></span>
<span><span class="co">#&gt;  [9,]  0.59572299 -0.28721951</span></span>
<span><span class="co">#&gt; [10,] -0.05623678  0.01878023</span></span>
<span><span class="co">#&gt; [11,]  0.04224137 -0.21855884</span></span>
<span><span class="co">#&gt; [12,]  0.78363351  0.22949465</span></span>
<span><span class="co">#&gt; [13,]  0.06745138 -0.16899703</span></span>
<span><span class="co">#&gt; [14,] -0.47113613 -0.67865735</span></span>
<span><span class="co">#&gt; [15,] -1.96150053 -1.32047922</span></span>
<span><span class="co">#&gt; [16,] -0.39902461  0.60812604</span></span>
<span><span class="co">#&gt; [17,]  1.60642970  1.31542231</span></span>
<span><span class="co">#&gt; [18,] -0.38592136  0.01993791</span></span>
<span><span class="co">#&gt; [19,] -0.04845633  0.05173157</span></span>
<span><span class="co">#&gt; [20,] -0.88143921 -0.52155537</span></span>
<span><span class="co">#&gt; [21,] -2.56255162 -1.33780704</span></span>
<span><span class="co">#&gt; [22,] -0.54244587  0.01936417</span></span>
<span><span class="co">#&gt; [23,]  0.49795898 -0.11485376</span></span>
<span><span class="co">#&gt; [24,]  0.69509909  0.45274834</span></span>
<span><span class="co">#&gt; [25,]  0.63284087  1.48814559</span></span>
<span><span class="co">#&gt; [26,] -1.47632294 -0.92299854</span></span>
<span><span class="co">#&gt; [27,] -1.78763671 -0.97448637</span></span>
<span><span class="co">#&gt; [28,]  2.35063076  1.50826223</span></span>
<span><span class="co">#&gt; [29,]  1.67726281  0.73013283</span></span>
<span><span class="co">#&gt; [30,]  2.48613792  1.55203022</span></span>
<span><span class="co">#&gt; [31,] -0.13610810  0.06171409</span></span>
<span><span class="co">#&gt; [32,] -0.79383525 -0.25751529</span></span>
<span><span class="co">#&gt; [33,] -0.70470857 -0.41256032</span></span>
<span><span class="co">#&gt; [34,]  0.53215200  0.47720624</span></span>
<span><span class="co">#&gt; [35,] -0.78427460 -1.15615114</span></span>
<span><span class="co">#&gt; [36,]  2.38131744  1.46510425</span></span>
<span><span class="co">#&gt; [37,]  3.68215047  2.20096870</span></span>
<span><span class="co">#&gt; [38,]  1.36156864  1.07925077</span></span>
<span><span class="co">#&gt; [39,] -1.08642784 -0.41158288</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res12</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes           TV.advert       </span></span>
<span><span class="co">#&gt;  Min.   :-3.36233   Min.   :-2.10297  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.86811   1st Qu.:-0.80083  </span></span>
<span><span class="co">#&gt;  Median :-0.05624   Median : 0.01878  </span></span>
<span><span class="co">#&gt;  Mean   : 0.00000   Mean   : 0.00000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.78011   3rd Qu.: 0.66913  </span></span>
<span><span class="co">#&gt;  Max.   : 3.68215   Max.   : 2.20097</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res12</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Quotes  TV.advert </span></span>
<span><span class="co">#&gt; 0.04802834 0.26497281</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res12</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9888696 0.5936285</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res12</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-kmeans-1.png" width="691.2"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res12</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-kmeans-2.png" width="691.2"></p>
</div>
<div class="section level3">
<h3 id="using-the-median-instead-of-the-mean-in-bootstrap-aggregation">3 - 5 Using the median instead of the mean in bootstrap
aggregation<a class="anchor" aria-label="anchor" href="#using-the-median-instead-of-the-mean-in-bootstrap-aggregation"></a>
</h3>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res13</span> <span class="op">&lt;-</span> <span class="fu">ahead</span><span class="fu">::</span><span class="fu"><a href="../reference/ridge2f.html">ridge2f</a></span><span class="op">(</span><span class="fu">fpp</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/fpp/man/insurance.html" class="external-link">insurance</a></span>, </span>
<span>                         centers <span class="op">=</span> <span class="va">centers</span>, </span>
<span>                         type_pi <span class="op">=</span> <span class="st">"blockbootstrap"</span>, </span>
<span>                         type_aggregation <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>                         block_length <span class="op">=</span> <span class="va">block_length</span>,</span>
<span>                         B <span class="op">=</span> <span class="va">B</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.60513  8.819610</span></span>
<span><span class="co">#&gt; Jun 2005 13.44530  8.034163</span></span>
<span><span class="co">#&gt; Jul 2005 12.63662  7.252493</span></span>
<span><span class="co">#&gt; Aug 2005 13.12559  8.287804</span></span>
<span><span class="co">#&gt; Sep 2005 13.25193  7.918613</span></span>
<span><span class="co">#&gt; Oct 2005 13.12813  7.786881</span></span>
<span><span class="co">#&gt; Nov 2005 14.53249  8.345802</span></span>
<span><span class="co">#&gt; Dec 2005 15.90436  8.685551</span></span>
<span><span class="co">#&gt; Jan 2006 14.70320  9.127752</span></span>
<span><span class="co">#&gt; Feb 2006 14.19685  8.763255</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.265492  7.992650</span></span>
<span><span class="co">#&gt; Jun 2005 10.011067  6.730118</span></span>
<span><span class="co">#&gt; Jul 2005  9.204177  5.861179</span></span>
<span><span class="co">#&gt; Aug 2005 11.973064  7.397854</span></span>
<span><span class="co">#&gt; Sep 2005 10.636133  6.193960</span></span>
<span><span class="co">#&gt; Oct 2005 10.445116  5.935517</span></span>
<span><span class="co">#&gt; Nov 2005 11.876683  7.255208</span></span>
<span><span class="co">#&gt; Dec 2005 10.265930  5.726151</span></span>
<span><span class="co">#&gt; Jan 2006  8.507776  5.625904</span></span>
<span><span class="co">#&gt; Feb 2006  8.972333  5.749044</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.33594 10.027338</span></span>
<span><span class="co">#&gt; Jun 2005 16.24500  9.073878</span></span>
<span><span class="co">#&gt; Jul 2005 17.42852 10.647134</span></span>
<span><span class="co">#&gt; Aug 2005 16.79755  9.613295</span></span>
<span><span class="co">#&gt; Sep 2005 19.38790 11.284791</span></span>
<span><span class="co">#&gt; Oct 2005 18.43310 10.642500</span></span>
<span><span class="co">#&gt; Nov 2005 18.73383 10.685986</span></span>
<span><span class="co">#&gt; Dec 2005 18.11738 10.017318</span></span>
<span><span class="co">#&gt; Jan 2006 21.39913 12.165645</span></span>
<span><span class="co">#&gt; Feb 2006 22.41147 13.357304</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims</span></span>
<span><span class="co">#&gt; $sims[[1]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.708143  9.097808</span></span>
<span><span class="co">#&gt; Jun 2005 13.823827  8.723703</span></span>
<span><span class="co">#&gt; Jul 2005 12.985556  7.775434</span></span>
<span><span class="co">#&gt; Aug 2005 13.002288  8.319168</span></span>
<span><span class="co">#&gt; Sep 2005 11.866496  7.127413</span></span>
<span><span class="co">#&gt; Oct 2005 11.510448  6.770107</span></span>
<span><span class="co">#&gt; Nov 2005 13.720577  9.022614</span></span>
<span><span class="co">#&gt; Dec 2005  9.872584  5.481126</span></span>
<span><span class="co">#&gt; Jan 2006  8.226746  5.428077</span></span>
<span><span class="co">#&gt; Feb 2006  8.661913  5.570686</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[2]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.740008  9.977827</span></span>
<span><span class="co">#&gt; Jun 2005 10.011067  6.804492</span></span>
<span><span class="co">#&gt; Jul 2005  9.204177  5.861179</span></span>
<span><span class="co">#&gt; Aug 2005 13.246686  8.256440</span></span>
<span><span class="co">#&gt; Sep 2005 14.839684  8.638325</span></span>
<span><span class="co">#&gt; Oct 2005 15.631654  9.011983</span></span>
<span><span class="co">#&gt; Nov 2005 16.541170  8.472721</span></span>
<span><span class="co">#&gt; Dec 2005 18.020906 10.018941</span></span>
<span><span class="co">#&gt; Jan 2006 17.078373  9.955407</span></span>
<span><span class="co">#&gt; Feb 2006 16.392166  9.716583</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[3]]</span></span>
<span><span class="co">#&gt;             Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.740008  9.977827</span></span>
<span><span class="co">#&gt; Jun 2005 10.011067  6.804492</span></span>
<span><span class="co">#&gt; Jul 2005  9.204177  5.861179</span></span>
<span><span class="co">#&gt; Aug 2005 13.246686  8.256440</span></span>
<span><span class="co">#&gt; Sep 2005 14.839684  8.638325</span></span>
<span><span class="co">#&gt; Oct 2005 13.660979  7.898109</span></span>
<span><span class="co">#&gt; Nov 2005 15.506526  8.218883</span></span>
<span><span class="co">#&gt; Dec 2005 17.067402  8.785388</span></span>
<span><span class="co">#&gt; Jan 2006 18.227690 10.460169</span></span>
<span><span class="co">#&gt; Feb 2006 16.289102  9.816177</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[4]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.22573  7.968126</span></span>
<span><span class="co">#&gt; Jun 2005 11.18621  6.708525</span></span>
<span><span class="co">#&gt; Jul 2005 12.05381  7.414828</span></span>
<span><span class="co">#&gt; Aug 2005 13.43576  7.497384</span></span>
<span><span class="co">#&gt; Sep 2005 15.38119  8.639415</span></span>
<span><span class="co">#&gt; Oct 2005 15.38756  8.490611</span></span>
<span><span class="co">#&gt; Nov 2005 17.10059  9.536766</span></span>
<span><span class="co">#&gt; Dec 2005 16.57768  8.263104</span></span>
<span><span class="co">#&gt; Jan 2006 21.23660 11.215624</span></span>
<span><span class="co">#&gt; Feb 2006 23.43130 13.838238</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[5]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 16.59331 10.041712</span></span>
<span><span class="co">#&gt; Jun 2005 14.65011  8.987163</span></span>
<span><span class="co">#&gt; Jul 2005 12.88358  8.196931</span></span>
<span><span class="co">#&gt; Aug 2005 11.88947  7.415110</span></span>
<span><span class="co">#&gt; Sep 2005 12.78137  8.239067</span></span>
<span><span class="co">#&gt; Oct 2005 12.37170  7.570947</span></span>
<span><span class="co">#&gt; Nov 2005 12.55772  7.107249</span></span>
<span><span class="co">#&gt; Dec 2005 12.01519  6.570126</span></span>
<span><span class="co">#&gt; Jan 2006 13.65345  8.300098</span></span>
<span><span class="co">#&gt; Feb 2006 15.70388  9.272431</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[6]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.60513  8.374828</span></span>
<span><span class="co">#&gt; Jun 2005 16.24500  9.073878</span></span>
<span><span class="co">#&gt; Jul 2005 17.42852 10.647134</span></span>
<span><span class="co">#&gt; Aug 2005 13.00449  8.327721</span></span>
<span><span class="co">#&gt; Sep 2005 10.63613  6.755276</span></span>
<span><span class="co">#&gt; Oct 2005 12.59529  6.898842</span></span>
<span><span class="co">#&gt; Nov 2005 14.72629  8.516219</span></span>
<span><span class="co">#&gt; Dec 2005 15.79601 10.011731</span></span>
<span><span class="co">#&gt; Jan 2006 11.78220  7.555532</span></span>
<span><span class="co">#&gt; Feb 2006 10.65551  6.363389</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[7]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.60513  8.374828</span></span>
<span><span class="co">#&gt; Jun 2005 16.24500  9.073878</span></span>
<span><span class="co">#&gt; Jul 2005 17.42852 10.647134</span></span>
<span><span class="co">#&gt; Aug 2005 13.00449  8.327721</span></span>
<span><span class="co">#&gt; Sep 2005 10.63613  6.755276</span></span>
<span><span class="co">#&gt; Oct 2005 10.13583  5.693216</span></span>
<span><span class="co">#&gt; Nov 2005 11.70276  7.901233</span></span>
<span><span class="co">#&gt; Dec 2005 13.44827  8.585715</span></span>
<span><span class="co">#&gt; Jan 2006 12.66159  7.604806</span></span>
<span><span class="co">#&gt; Feb 2006 12.68982  8.254080</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[8]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 14.05871  8.541413</span></span>
<span><span class="co">#&gt; Jun 2005 13.06677  7.477091</span></span>
<span><span class="co">#&gt; Jul 2005 11.35088  6.837713</span></span>
<span><span class="co">#&gt; Aug 2005 12.26101  7.392845</span></span>
<span><span class="co">#&gt; Sep 2005 13.72248  7.598158</span></span>
<span><span class="co">#&gt; Oct 2005 18.69996 10.457618</span></span>
<span><span class="co">#&gt; Nov 2005 19.20800 11.019630</span></span>
<span><span class="co">#&gt; Dec 2005 16.01270  9.630958</span></span>
<span><span class="co">#&gt; Jan 2006 15.75294 10.248332</span></span>
<span><span class="co">#&gt; Feb 2006 11.86871  7.214686</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[9]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 13.40246  8.077121</span></span>
<span><span class="co">#&gt; Jun 2005 14.35696  8.591234</span></span>
<span><span class="co">#&gt; Jul 2005 13.32299  7.043137</span></span>
<span><span class="co">#&gt; Aug 2005 17.40934  9.718443</span></span>
<span><span class="co">#&gt; Sep 2005 20.55114 12.052804</span></span>
<span><span class="co">#&gt; Oct 2005 17.51390 10.696175</span></span>
<span><span class="co">#&gt; Nov 2005 14.33869  7.764844</span></span>
<span><span class="co">#&gt; Dec 2005 18.14539  9.894546</span></span>
<span><span class="co">#&gt; Jan 2006 21.44632 12.441457</span></span>
<span><span class="co">#&gt; Feb 2006 18.89871 11.700751</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sims[[10]]</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; May 2005 15.44948  9.719358</span></span>
<span><span class="co">#&gt; Jun 2005 12.71580  7.341674</span></span>
<span><span class="co">#&gt; Jul 2005 12.38966  7.090157</span></span>
<span><span class="co">#&gt; Aug 2005 14.69030  9.251118</span></span>
<span><span class="co">#&gt; Sep 2005 10.99989  6.030998</span></span>
<span><span class="co">#&gt; Oct 2005 12.33706  7.675653</span></span>
<span><span class="co">#&gt; Nov 2005 12.47576  7.958183</span></span>
<span><span class="co">#&gt; Dec 2005 11.62079  7.326245</span></span>
<span><span class="co">#&gt; Jan 2006  9.47577  6.307308</span></span>
<span><span class="co">#&gt; Feb 2006 10.04156  6.860583</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $x</span></span>
<span><span class="co">#&gt;            Quotes TV.advert</span></span>
<span><span class="co">#&gt; Jan 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; Feb 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Mar 2002 13.22957  7.534250</span></span>
<span><span class="co">#&gt; Apr 2002 12.97065  7.212725</span></span>
<span><span class="co">#&gt; May 2002 15.38714  9.443570</span></span>
<span><span class="co">#&gt; Jun 2002 11.72288  6.415215</span></span>
<span><span class="co">#&gt; Jul 2002 10.06177  5.806990</span></span>
<span><span class="co">#&gt; Aug 2002 10.82279  6.203600</span></span>
<span><span class="co">#&gt; Sep 2002 13.28707  7.586430</span></span>
<span><span class="co">#&gt; Oct 2002 14.57832  8.004935</span></span>
<span><span class="co">#&gt; Nov 2002 15.60542  8.834980</span></span>
<span><span class="co">#&gt; Dec 2002 15.93515  8.957255</span></span>
<span><span class="co">#&gt; Jan 2003 16.99486  9.532990</span></span>
<span><span class="co">#&gt; Feb 2003 16.87821  9.392950</span></span>
<span><span class="co">#&gt; Mar 2003 16.45128  8.918560</span></span>
<span><span class="co">#&gt; Apr 2003 15.28118  8.374120</span></span>
<span><span class="co">#&gt; May 2003 15.88901  9.844505</span></span>
<span><span class="co">#&gt; Jun 2003 15.67747  9.849390</span></span>
<span><span class="co">#&gt; Jul 2003 13.28780  8.402730</span></span>
<span><span class="co">#&gt; Aug 2003 12.64484  7.920675</span></span>
<span><span class="co">#&gt; Sep 2003 11.82771  7.436085</span></span>
<span><span class="co">#&gt; Oct 2003  9.69184  6.340490</span></span>
<span><span class="co">#&gt; Nov 2003 10.30415  6.939995</span></span>
<span><span class="co">#&gt; Dec 2003 11.38253  6.977100</span></span>
<span><span class="co">#&gt; Jan 2004 12.95149  8.010201</span></span>
<span><span class="co">#&gt; Feb 2004 13.63092  9.565460</span></span>
<span><span class="co">#&gt; Mar 2004  9.12098  6.272510</span></span>
<span><span class="co">#&gt; Apr 2004  8.39468  5.707495</span></span>
<span><span class="co">#&gt; May 2004 12.30076  7.963540</span></span>
<span><span class="co">#&gt; Jun 2004 13.84831  8.494221</span></span>
<span><span class="co">#&gt; Jul 2004 15.96246  9.789085</span></span>
<span><span class="co">#&gt; Aug 2004 14.19738  8.692825</span></span>
<span><span class="co">#&gt; Sep 2004 12.85922  8.057230</span></span>
<span><span class="co">#&gt; Oct 2004 12.08837  7.588995</span></span>
<span><span class="co">#&gt; Nov 2004 12.93375  8.244881</span></span>
<span><span class="co">#&gt; Dec 2004 11.72235  6.675540</span></span>
<span><span class="co">#&gt; Jan 2005 15.47126  9.219604</span></span>
<span><span class="co">#&gt; Feb 2005 18.43898 10.963800</span></span>
<span><span class="co">#&gt; Mar 2005 17.49186 10.456290</span></span>
<span><span class="co">#&gt; Apr 2005 14.49168  8.728600</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $level</span></span>
<span><span class="co">#&gt; [1] 95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ridge2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $residuals</span></span>
<span><span class="co">#&gt;            Quotes   TV.advert</span></span>
<span><span class="co">#&gt;  [1,]  1.34231135  1.22967612</span></span>
<span><span class="co">#&gt;  [2,] -0.85477619 -0.98393029</span></span>
<span><span class="co">#&gt;  [3,] -1.00310653 -1.06267921</span></span>
<span><span class="co">#&gt;  [4,]  1.34231135  1.22967612</span></span>
<span><span class="co">#&gt;  [5,] -2.36146619 -2.10296529</span></span>
<span><span class="co">#&gt;  [6,] -3.36233492 -1.98959149</span></span>
<span><span class="co">#&gt;  [7,] -1.19409276 -0.96452874</span></span>
<span><span class="co">#&gt;  [8,]  0.77658242  0.14934530</span></span>
<span><span class="co">#&gt;  [9,]  0.59572299 -0.28721951</span></span>
<span><span class="co">#&gt; [10,] -0.05623678  0.01878023</span></span>
<span><span class="co">#&gt; [11,]  0.04224137 -0.21855884</span></span>
<span><span class="co">#&gt; [12,]  0.78363351  0.22949465</span></span>
<span><span class="co">#&gt; [13,]  0.06745138 -0.16899703</span></span>
<span><span class="co">#&gt; [14,] -0.47113613 -0.67865735</span></span>
<span><span class="co">#&gt; [15,] -1.96150053 -1.32047922</span></span>
<span><span class="co">#&gt; [16,] -0.39902461  0.60812604</span></span>
<span><span class="co">#&gt; [17,]  1.60642970  1.31542231</span></span>
<span><span class="co">#&gt; [18,] -0.38592136  0.01993791</span></span>
<span><span class="co">#&gt; [19,] -0.04845633  0.05173157</span></span>
<span><span class="co">#&gt; [20,] -0.88143921 -0.52155537</span></span>
<span><span class="co">#&gt; [21,] -2.56255162 -1.33780704</span></span>
<span><span class="co">#&gt; [22,] -0.54244587  0.01936417</span></span>
<span><span class="co">#&gt; [23,]  0.49795898 -0.11485376</span></span>
<span><span class="co">#&gt; [24,]  0.69509909  0.45274834</span></span>
<span><span class="co">#&gt; [25,]  0.63284087  1.48814559</span></span>
<span><span class="co">#&gt; [26,] -1.47632294 -0.92299854</span></span>
<span><span class="co">#&gt; [27,] -1.78763671 -0.97448637</span></span>
<span><span class="co">#&gt; [28,]  2.35063076  1.50826223</span></span>
<span><span class="co">#&gt; [29,]  1.67726281  0.73013283</span></span>
<span><span class="co">#&gt; [30,]  2.48613792  1.55203022</span></span>
<span><span class="co">#&gt; [31,] -0.13610810  0.06171409</span></span>
<span><span class="co">#&gt; [32,] -0.79383525 -0.25751529</span></span>
<span><span class="co">#&gt; [33,] -0.70470857 -0.41256032</span></span>
<span><span class="co">#&gt; [34,]  0.53215200  0.47720624</span></span>
<span><span class="co">#&gt; [35,] -0.78427460 -1.15615114</span></span>
<span><span class="co">#&gt; [36,]  2.38131744  1.46510425</span></span>
<span><span class="co">#&gt; [37,]  3.68215047  2.20096870</span></span>
<span><span class="co">#&gt; [38,]  1.36156864  1.07925077</span></span>
<span><span class="co">#&gt; [39,] -1.08642784 -0.41158288</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "mtsforecast"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res13</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># Gaussian?</span></span>
<span><span class="co">#&gt;    Quotes TV.advert </span></span>
<span><span class="co">#&gt; 0.9888696 0.5936285</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res13</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Quotes           TV.advert       </span></span>
<span><span class="co">#&gt;  Min.   :-3.36233   Min.   :-2.10297  </span></span>
<span><span class="co">#&gt;  1st Qu.:-0.86811   1st Qu.:-0.80083  </span></span>
<span><span class="co">#&gt;  Median :-0.05624   Median : 0.01878  </span></span>
<span><span class="co">#&gt;  Mean   : 0.00000   Mean   : 0.00000  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 0.78011   3rd Qu.: 0.66913  </span></span>
<span><span class="co">#&gt;  Max.   : 3.68215   Max.   : 2.20097</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res13</span><span class="op">$</span><span class="va">residuals</span>, <span class="fl">2</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/box.test.html" class="external-link">Box.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Quotes  TV.advert </span></span>
<span><span class="co">#&gt; 0.04802834 0.26497281</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res13</span>, <span class="st">"Quotes"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-median-kmeans-1.png" width="691.2"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res13</span>, <span class="st">"TV.advert"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ahead-ridge2-prediction-intervals_files/figure-html/blockbootstrap-median-kmeans-2.png" width="691.2"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://thierrymoudiki.github.io/" class="external-link">T. Moudiki</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
