<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SVM model â€¢ rvfl</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="SVM model">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rvfl</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/rvfl.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bootstrap.html">Ridge model (bootstrap) model</a>
    </li>
    <li>
      <a href="../articles/GLM.html">Ridge GLM model</a>
    </li>
    <li>
      <a href="../articles/GLMGamma.html">Ridge GLM Gamma model</a>
    </li>
    <li>
      <a href="../articles/nnet.html">Ridge NNET model</a>
    </li>
    <li>
      <a href="../articles/ridgemodel_summary_plot.html">Ridge model</a>
    </li>
    <li>
      <a href="../articles/ridgemodel.html">Ridge model</a>
    </li>
    <li>
      <a href="../articles/rvfl_summary_plot.html">Ridge model</a>
    </li>
    <li>
      <a href="../articles/surrogate.html">Ridge model (surrogate) model</a>
    </li>
    <li>
      <a href="../articles/svm.html">SVM model</a>
    </li>
    <li>
      <a href="../articles/zeroinfl.html">Zero-inflated GLM model (plus other models)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>SVM model</h1>
            
      

      <div class="hidden name"><code>svm.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rvfl</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glmGamma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html" class="external-link">svm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level2">
<h2 id="example-1-mpg-prediction-mtcars-dataset">Example 1: MPG Prediction (mtcars dataset)<a class="anchor" aria-label="anchor" href="#example-1-mpg-prediction-mtcars-dataset"></a>
</h2>
<div class="section level3">
<h3 id="load-and-prepare-data">Load and prepare data<a class="anchor" aria-label="anchor" href="#load-and-prepare-data"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1243</span><span class="op">)</span></span>
<span><span class="va">train_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">[</span><span class="va">train_idx</span>, <span class="op">]</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-models">Fit models<a class="anchor" aria-label="anchor" href="#fit-models"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit regular linear model</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">lm_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.011</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = mpg ~ ., data = train_data)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -3.5211 -0.9792 -0.0324  1.1808  4.9814 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span><span class="co">## (Intercept) -5.054416  25.456900  -0.199   0.8455  </span></span>
<span><span class="co">## cyl          0.695392   1.396506   0.498   0.6262  </span></span>
<span><span class="co">## disp         0.005254   0.017342   0.303   0.7664  </span></span>
<span><span class="co">## hp          -0.007610   0.027723  -0.274   0.7877  </span></span>
<span><span class="co">## drat         4.128157   2.724353   1.515   0.1520  </span></span>
<span><span class="co">## wt          -1.621396   2.139071  -0.758   0.4610  </span></span>
<span><span class="co">## qsec         0.064356   0.932144   0.069   0.9459  </span></span>
<span><span class="co">## vs           0.138716   3.421183   0.041   0.9682  </span></span>
<span><span class="co">## am          -0.498476   2.956568  -0.169   0.8685  </span></span>
<span><span class="co">## gear         4.402648   2.287816   1.924   0.0749 .</span></span>
<span><span class="co">## carb        -1.999389   1.299580  -1.538   0.1462  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 2.464 on 14 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.8938, Adjusted R-squared:  0.818 </span></span>
<span><span class="co">## F-statistic: 11.79 on 10 and 14 DF,  p-value: 3.4e-05</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    2.5 %      97.5 %</span></span>
<span><span class="co">## (Intercept) -59.65403559 49.54520296</span></span>
<span><span class="co">## cyl          -2.29981561  3.69060001</span></span>
<span><span class="co">## disp         -0.03194096  0.04244882</span></span>
<span><span class="co">## hp           -0.06707095  0.05185084</span></span>
<span><span class="co">## drat         -1.71500030  9.97131342</span></span>
<span><span class="co">## wt           -6.20924769  2.96645550</span></span>
<span><span class="co">## qsec         -1.93489537  2.06360651</span></span>
<span><span class="co">## vs           -7.19899241  7.47642359</span></span>
<span><span class="co">## am           -6.83968216  5.84273112</span></span>
<span><span class="co">## gear         -0.50422869  9.30952400</span></span>
<span><span class="co">## carb         -4.78671119  0.78793282</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit calibrated model </span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">svm_model</span> <span class="op">&lt;-</span> <span class="fu">rvfl</span><span class="fu">::</span><span class="fu">calibmodel</span><span class="op">(</span>lambda<span class="op">=</span><span class="fl">10</span><span class="op">**</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train_data</span><span class="op">$</span><span class="va">mpg</span>, engine <span class="op">=</span> <span class="va">glmGamma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##    0.18</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">svm_model</span><span class="op">$</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## svm(formula = formula, data = ..1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##    SVM-Type:  eps-regression </span></span>
<span><span class="co">##  SVM-Kernel:  radial </span></span>
<span><span class="co">##        cost:  1 </span></span>
<span><span class="co">##       gamma:  0.1 </span></span>
<span><span class="co">##     epsilon:  0.1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Support Vectors:  22</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#print(confint(svm_model$model))</span></span>
<span><span class="co">#print(simulate(svm_model, newdata = test_data))</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="make-predictions">Make predictions<a class="anchor" aria-label="anchor" href="#make-predictions"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">lm_model</span>, newdata <span class="op">=</span> <span class="va">test_data</span>, interval <span class="op">=</span> <span class="st">"prediction"</span><span class="op">)</span></span>
<span><span class="va">svm_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_model</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"bootstrap"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compare-predictions">Compare predictions<a class="anchor" aria-label="anchor" href="#compare-predictions"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Actual <span class="op">=</span> <span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">mpg</span>,</span>
<span>  LM_Pred <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"fit"</span><span class="op">]</span>,</span>
<span>  LM_Lower <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"lwr"</span><span class="op">]</span>,</span>
<span>  LM_Upper <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"upr"</span><span class="op">]</span>,</span>
<span>  svm_Pred <span class="op">=</span> <span class="va">svm_pred</span><span class="op">[</span>,<span class="st">"fit"</span><span class="op">]</span>,</span>
<span>  svm_Lower <span class="op">=</span> <span class="va">svm_pred</span><span class="op">[</span>,<span class="st">"lwr"</span><span class="op">]</span>, </span>
<span>  svm_Upper <span class="op">=</span> <span class="va">svm_pred</span><span class="op">[</span>,<span class="st">"upr"</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Prediction Intervals Comparison:"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Prediction Intervals Comparison:"</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                Actual  LM_Pred  LM_Lower LM_Upper svm_Pred svm_Lower svm_Upper</span></span>
<span><span class="co">## Valiant          18.1 17.93324 10.149847 25.71663 21.33478  15.06733  26.60367</span></span>
<span><span class="co">## Merc 280C        17.8 20.63530 13.636618 27.63398 20.86656  15.31682  26.85315</span></span>
<span><span class="co">## Toyota Corolla   33.9 28.58373 22.379666 34.78779 28.16744  22.61770  34.15404</span></span>
<span><span class="co">## Camaro Z28       13.3 15.85710  8.140858 23.57335 18.65393  13.10419  24.64052</span></span>
<span><span class="co">## Porsche 914-2    26.0 31.07535 18.988702 43.16201 23.89842  18.42376  29.96010</span></span>
<span><span class="co">## Ford Pantera L   15.8 27.07516 14.930150 39.22016 21.36127  15.81153  27.34786</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate coverage and Winkler scores</span></span>
<span><span class="va">lm_coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">mpg</span> <span class="op">&gt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">LM_Lower</span> <span class="op">&amp;</span> </span>
<span>                   <span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">mpg</span> <span class="op">&lt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">LM_Upper</span><span class="op">)</span></span>
<span><span class="va">svm_coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">mpg</span> <span class="op">&gt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">svm_Lower</span> <span class="op">&amp;</span> </span>
<span>                      <span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">mpg</span> <span class="op">&lt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">svm_Upper</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lm_winkler</span> <span class="op">&lt;-</span> <span class="fu">misc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/misc/man/winkler_score.html" class="external-link">winkler_score</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">mpg</span>, <span class="va">results</span><span class="op">$</span><span class="va">LM_Lower</span>, <span class="va">results</span><span class="op">$</span><span class="va">LM_Upper</span><span class="op">)</span></span>
<span><span class="va">svm_winkler</span> <span class="op">&lt;-</span> <span class="fu">misc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/misc/man/winkler_score.html" class="external-link">winkler_score</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">mpg</span>, <span class="va">results</span><span class="op">$</span><span class="va">svm_Lower</span>, <span class="va">results</span><span class="op">$</span><span class="va">svm_Upper</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"\nPrediction interval metrics:"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "\nPrediction interval metrics:"</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Linear Model: %.1f%% coverage, %.3f Winkler score"</span>, </span>
<span>              <span class="fl">100</span> <span class="op">*</span> <span class="va">lm_coverage</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">lm_winkler</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Linear Model: 100.0% coverage, 18.226 Winkler score"</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Calibrated Model: %.1f%% coverage, %.3f Winkler score"</span>, </span>
<span>              <span class="fl">100</span> <span class="op">*</span> <span class="va">svm_coverage</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">svm_winkler</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Calibrated Model: 71.4% coverage, 17.780 Winkler score"</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">svm_model</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, nsim <span class="op">=</span> <span class="fl">500</span>, method<span class="op">=</span><span class="st">"bootstrap"</span><span class="op">)</span></span>
<span><span class="co"># Plot simulations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">sims</span>, type <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"obs. #"</span>, ylab <span class="op">=</span> <span class="st">"Simulated MPG"</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Ridge Model Simulations"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">mpg</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>        </span></code></pre></div>
<p><img src="svm_files/figure-html/unnamed-chunk-7-1.png" width="720"></p>
</div>
</div>
<div class="section level2">
<h2 id="example-2-boston-housing-price-prediction">Example 2: Boston Housing Price Prediction<a class="anchor" aria-label="anchor" href="#example-2-boston-housing-price-prediction"></a>
</h2>
<div class="section level3">
<h3 id="load-and-prepare-data-1">Load and prepare data<a class="anchor" aria-label="anchor" href="#load-and-prepare-data-1"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1243</span><span class="op">)</span></span>
<span><span class="va">train_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">Boston</span><span class="op">[</span><span class="va">train_idx</span>, <span class="op">]</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">-</span><span class="fl">14</span><span class="op">]</span>  <span class="co"># -14 removes 'medv' (target variable)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-models-1">Fit models<a class="anchor" aria-label="anchor" href="#fit-models-1"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit regular linear model</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">lm_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">medv</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.009</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = medv ~ ., data = train_data)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -15.220  -2.757  -0.494   1.863  26.961 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  35.832339   5.763210   6.217 1.30e-09 ***</span></span>
<span><span class="co">## crim         -0.095389   0.034717  -2.748 0.006282 ** </span></span>
<span><span class="co">## zn            0.042689   0.016086   2.654 0.008283 ** </span></span>
<span><span class="co">## indus        -0.033013   0.073521  -0.449 0.653657    </span></span>
<span><span class="co">## chas          2.506064   0.939731   2.667 0.007977 ** </span></span>
<span><span class="co">## nox         -17.521010   4.237379  -4.135 4.35e-05 ***</span></span>
<span><span class="co">## rm            3.966727   0.477640   8.305 1.66e-15 ***</span></span>
<span><span class="co">## age           0.006479   0.014922   0.434 0.664410    </span></span>
<span><span class="co">## dis          -1.463187   0.232348  -6.297 8.17e-10 ***</span></span>
<span><span class="co">## rad           0.253984   0.075379   3.369 0.000828 ***</span></span>
<span><span class="co">## tax          -0.009853   0.004350  -2.265 0.024068 *  </span></span>
<span><span class="co">## ptratio      -1.002914   0.147016  -6.822 3.44e-11 ***</span></span>
<span><span class="co">## black         0.008723   0.002984   2.923 0.003664 ** </span></span>
<span><span class="co">## lstat        -0.501984   0.057704  -8.699  &lt; 2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 4.835 on 390 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.7403, Adjusted R-squared:  0.7316 </span></span>
<span><span class="co">## F-statistic: 85.51 on 13 and 390 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    2.5 %      97.5 %</span></span>
<span><span class="co">## (Intercept)  24.50149090 47.16318623</span></span>
<span><span class="co">## crim         -0.16364441 -0.02713269</span></span>
<span><span class="co">## zn            0.01106383  0.07431451</span></span>
<span><span class="co">## indus        -0.17755967  0.11153316</span></span>
<span><span class="co">## chas          0.65849254  4.35363615</span></span>
<span><span class="co">## nox         -25.85197459 -9.19004505</span></span>
<span><span class="co">## rm            3.02765548  4.90579898</span></span>
<span><span class="co">## age          -0.02285933  0.03581667</span></span>
<span><span class="co">## dis          -1.91999833 -1.00637601</span></span>
<span><span class="co">## rad           0.10578379  0.40218383</span></span>
<span><span class="co">## tax          -0.01840515 -0.00129986</span></span>
<span><span class="co">## ptratio      -1.29195676 -0.71387117</span></span>
<span><span class="co">## black         0.00285660  0.01458927</span></span>
<span><span class="co">## lstat        -0.61543411 -0.38853422</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit calibrated model </span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">svm_model</span> <span class="op">&lt;-</span> <span class="fu">rvfl</span><span class="fu">::</span><span class="fu">calibmodel</span><span class="op">(</span>lambda<span class="op">=</span><span class="fl">10</span><span class="op">**</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">14</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train_data</span><span class="op">$</span><span class="va">medv</span>, engine <span class="op">=</span> <span class="va">glmGamma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.092</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">svm_model</span><span class="op">$</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## svm(formula = formula, data = ..1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##    SVM-Type:  eps-regression </span></span>
<span><span class="co">##  SVM-Kernel:  radial </span></span>
<span><span class="co">##        cost:  1 </span></span>
<span><span class="co">##       gamma:  0.07692308 </span></span>
<span><span class="co">##     epsilon:  0.1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Support Vectors:  147</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#print(confint(svm_model$model))</span></span>
<span><span class="co">#print(simulate(svm_model, newdata = test_data))</span></span>
<span></span>
<span><span class="va">lm_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">lm_model</span>, newdata <span class="op">=</span> <span class="va">test_data</span>, interval <span class="op">=</span> <span class="st">"prediction"</span><span class="op">)</span></span>
<span><span class="va">svm_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_model</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"bootstrap"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="make-predictions-and-compare">Make predictions and compare<a class="anchor" aria-label="anchor" href="#make-predictions-and-compare"></a>
</h3>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Actual <span class="op">=</span> <span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>,</span>
<span>  LM_Pred <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"fit"</span><span class="op">]</span>,</span>
<span>  LM_Lower <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"lwr"</span><span class="op">]</span>,</span>
<span>  LM_Upper <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"upr"</span><span class="op">]</span>,</span>
<span>  svm_Pred <span class="op">=</span> <span class="va">svm_pred</span><span class="op">[</span>,<span class="st">"fit"</span><span class="op">]</span>,</span>
<span>  svm_Lower <span class="op">=</span> <span class="va">svm_pred</span><span class="op">[</span>,<span class="st">"lwr"</span><span class="op">]</span>, </span>
<span>  svm_Upper <span class="op">=</span> <span class="va">svm_pred</span><span class="op">[</span>,<span class="st">"upr"</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Prediction Intervals Comparison:"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Prediction Intervals Comparison:"</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Actual  LM_Pred  LM_Lower LM_Upper svm_Pred svm_Lower svm_Upper</span></span>
<span><span class="co">## 1    24.0 30.57209 20.958399 40.18579 28.85933 24.333712  37.61434</span></span>
<span><span class="co">## 3    34.7 30.68339 21.107377 40.25940 32.92264 23.340798  42.66320</span></span>
<span><span class="co">## 4    33.4 28.70511 19.107688 38.30253 31.68660 26.522509  41.24607</span></span>
<span><span class="co">## 18   17.5 17.06191  7.487523 26.63630 16.95144  9.299141  25.05877</span></span>
<span><span class="co">## 21   13.6 12.85420  3.239688 22.46872 14.40651  9.001747  24.53908</span></span>
<span><span class="co">## 24   14.5 14.14956  4.535627 23.76348 15.06066  9.452245  26.41643</span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate coverage and Winkler scores</span></span>
<span><span class="va">lm_coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span> <span class="op">&gt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">LM_Lower</span> <span class="op">&amp;</span> </span>
<span>                   <span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span> <span class="op">&lt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">LM_Upper</span><span class="op">)</span></span>
<span><span class="va">svm_coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span> <span class="op">&gt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">svm_Lower</span> <span class="op">&amp;</span> </span>
<span>                      <span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span> <span class="op">&lt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">svm_Upper</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lm_winkler</span> <span class="op">&lt;-</span> <span class="fu">misc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/misc/man/winkler_score.html" class="external-link">winkler_score</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>, <span class="va">results</span><span class="op">$</span><span class="va">LM_Lower</span>, <span class="va">results</span><span class="op">$</span><span class="va">LM_Upper</span><span class="op">)</span></span>
<span><span class="va">svm_winkler</span> <span class="op">&lt;-</span> <span class="fu">misc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/misc/man/winkler_score.html" class="external-link">winkler_score</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>, <span class="va">results</span><span class="op">$</span><span class="va">svm_Lower</span>, <span class="va">results</span><span class="op">$</span><span class="va">svm_Upper</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"\nPrediction interval metrics:"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "\nPrediction interval metrics:"</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Linear Model: %.1f%% coverage, %.3f Winkler score"</span>, </span>
<span>              <span class="fl">100</span> <span class="op">*</span> <span class="va">lm_coverage</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">lm_winkler</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Linear Model: 95.1% coverage, 26.711 Winkler score"</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Calibrated Model: %.1f%% coverage, %.3f Winkler score"</span>, </span>
<span>              <span class="fl">100</span> <span class="op">*</span> <span class="va">svm_coverage</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">svm_winkler</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Calibrated Model: 96.1% coverage, 27.987 Winkler score"</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">svm_model</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, nsim <span class="op">=</span> <span class="fl">500</span>, method<span class="op">=</span><span class="st">"bootstrap"</span><span class="op">)</span></span>
<span><span class="co"># Plot simulations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">sims</span>, type <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"obs. #"</span>, ylab <span class="op">=</span> <span class="st">"Simulated MPG"</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Ridge Model Simulations"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>        </span></code></pre></div>
<p><img src="svm_files/figure-html/unnamed-chunk-11-1.png" width="720"></p>
</div>
</div>
<div class="section level2">
<h2 id="example-3-car-price-analysis-cars93-dataset">Example 3: Car Price Analysis (Cars93 dataset)<a class="anchor" aria-label="anchor" href="#example-3-car-price-analysis-cars93-dataset"></a>
</h2>
<div class="section level3">
<h3 id="load-and-prepare-data-2">Load and prepare data<a class="anchor" aria-label="anchor" href="#load-and-prepare-data-2"></a>
</h3>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Cars93</span>, package <span class="op">=</span> <span class="st">"MASS"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove rows with missing values</span></span>
<span><span class="va">Cars93</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">Cars93</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select numeric predictors and price as response</span></span>
<span><span class="va">predictors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MPG.city"</span>, <span class="st">"MPG.highway"</span>, <span class="st">"EngineSize"</span>, <span class="st">"Horsepower"</span>, </span>
<span>                <span class="st">"RPM"</span>, <span class="st">"Rev.per.mile"</span>, <span class="st">"Fuel.tank.capacity"</span>, <span class="st">"Length"</span>, </span>
<span>                <span class="st">"Wheelbase"</span>, <span class="st">"Width"</span>, <span class="st">"Turn.circle"</span>, <span class="st">"Weight"</span><span class="op">)</span></span>
<span><span class="va">car_data</span> <span class="op">&lt;-</span> <span class="va">Cars93</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">predictors</span>, <span class="st">"Price"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1243</span><span class="op">)</span></span>
<span><span class="va">train_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">car_data</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">car_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">car_data</span><span class="op">[</span><span class="va">train_idx</span>, <span class="op">]</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">car_data</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">car_data</span><span class="op">)</span> <span class="op">==</span> <span class="st">"Price"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-models-2">Fit models<a class="anchor" aria-label="anchor" href="#fit-models-2"></a>
</h3>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit regular linear model</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">lm_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Price</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.028</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = Price ~ ., data = train_data)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -8.9444 -3.4879 -0.0823  2.5740 10.7036 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                      Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span><span class="co">## (Intercept)         6.0285088 31.8235292   0.189   0.8505  </span></span>
<span><span class="co">## MPG.city           -0.3069383  0.4798163  -0.640   0.5252  </span></span>
<span><span class="co">## MPG.highway        -0.0041568  0.4591254  -0.009   0.9928  </span></span>
<span><span class="co">## EngineSize          2.4810783  2.4779636   1.001   0.3213  </span></span>
<span><span class="co">## Horsepower          0.1016741  0.0446071   2.279   0.0268 *</span></span>
<span><span class="co">## RPM                 0.0001602  0.0023006   0.070   0.9448  </span></span>
<span><span class="co">## Rev.per.mile        0.0049762  0.0026868   1.852   0.0697 .</span></span>
<span><span class="co">## Fuel.tank.capacity -0.1866149  0.5198553  -0.359   0.7211  </span></span>
<span><span class="co">## Length              0.0203242  0.1333518   0.152   0.8795  </span></span>
<span><span class="co">## Wheelbase           0.4888949  0.2655782   1.841   0.0713 .</span></span>
<span><span class="co">## Width              -0.8957689  0.4446575  -2.015   0.0491 *</span></span>
<span><span class="co">## Turn.circle        -0.3835124  0.3579624  -1.071   0.2889  </span></span>
<span><span class="co">## Weight              0.0041302  0.0059593   0.693   0.4914  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 4.731 on 52 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.7886, Adjusted R-squared:  0.7398 </span></span>
<span><span class="co">## F-statistic: 16.16 on 12 and 52 DF,  p-value: 1.548e-13</span></span></code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                            2.5 %       97.5 %</span></span>
<span><span class="co">## (Intercept)        -5.783007e+01 69.887091986</span></span>
<span><span class="co">## MPG.city           -1.269760e+00  0.655883438</span></span>
<span><span class="co">## MPG.highway        -9.254594e-01  0.917145804</span></span>
<span><span class="co">## EngineSize         -2.491319e+00  7.453475962</span></span>
<span><span class="co">## Horsepower          1.216348e-02  0.191184768</span></span>
<span><span class="co">## RPM                -4.456410e-03  0.004776746</span></span>
<span><span class="co">## Rev.per.mile       -4.152533e-04  0.010367616</span></span>
<span><span class="co">## Fuel.tank.capacity -1.229781e+00  0.856550981</span></span>
<span><span class="co">## Length             -2.472657e-01  0.287914102</span></span>
<span><span class="co">## Wheelbase          -4.402679e-02  1.021816593</span></span>
<span><span class="co">## Width              -1.788039e+00 -0.003498354</span></span>
<span><span class="co">## Turn.circle        -1.101817e+00  0.334791684</span></span>
<span><span class="co">## Weight             -7.828121e-03  0.016088453</span></span></code></pre>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit calibrated model </span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">svm_model</span> <span class="op">&lt;-</span> <span class="fu">rvfl</span><span class="fu">::</span><span class="fu">calibmodel</span><span class="op">(</span>lambda<span class="op">=</span><span class="fl">10</span><span class="op">**</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">)</span> <span class="op">==</span> <span class="st">"Price"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                               y <span class="op">=</span> <span class="va">train_data</span><span class="op">$</span><span class="va">Price</span>, engine <span class="op">=</span> <span class="va">glmGamma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.097</span></span></code></pre>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">svm_model</span><span class="op">$</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## svm(formula = formula, data = ..1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##    SVM-Type:  eps-regression </span></span>
<span><span class="co">##  SVM-Kernel:  radial </span></span>
<span><span class="co">##        cost:  1 </span></span>
<span><span class="co">##       gamma:  0.08333333 </span></span>
<span><span class="co">##     epsilon:  0.1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Support Vectors:  37</span></span></code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#print(confint(svm_model$model))</span></span>
<span><span class="co">#print(simulate(svm_model, newdata = as.matrix(test_data)))</span></span>
<span></span>
<span><span class="va">lm_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">lm_model</span>, newdata <span class="op">=</span> <span class="va">test_data</span>, interval <span class="op">=</span> <span class="st">"prediction"</span><span class="op">)</span></span>
<span><span class="va">svm_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_model</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"bootstrap"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="make-predictions-and-compare-1">Make predictions and compare<a class="anchor" aria-label="anchor" href="#make-predictions-and-compare-1"></a>
</h3>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Actual <span class="op">=</span> <span class="va">car_data</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="st">"Price"</span><span class="op">]</span>,</span>
<span>  LM_Pred <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"fit"</span><span class="op">]</span>,</span>
<span>  LM_Lower <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"lwr"</span><span class="op">]</span>,</span>
<span>  LM_Upper <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"upr"</span><span class="op">]</span>,</span>
<span>  svm_Pred <span class="op">=</span> <span class="va">svm_pred</span><span class="op">[</span>,<span class="st">"fit"</span><span class="op">]</span>,</span>
<span>  svm_Lower <span class="op">=</span> <span class="va">svm_pred</span><span class="op">[</span>,<span class="st">"lwr"</span><span class="op">]</span>, </span>
<span>  svm_Upper <span class="op">=</span> <span class="va">svm_pred</span><span class="op">[</span>,<span class="st">"upr"</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Prediction Intervals Comparison:"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Prediction Intervals Comparison:"</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Actual   LM_Pred   LM_Lower LM_Upper  svm_Pred svm_Lower svm_Upper</span></span>
<span><span class="co">## 7    20.8 22.284761 12.3951390 32.17438 24.644307 17.807962  43.33853</span></span>
<span><span class="co">## 12   13.4 14.354853  3.3289673 25.38074 11.674070  4.883566  30.36830</span></span>
<span><span class="co">## 15   15.9 17.852333  7.2347759 28.46989 16.590922 10.534942  36.07882</span></span>
<span><span class="co">## 21   15.8 19.516709  9.4219263 29.61149 18.463087 11.904269  34.04776</span></span>
<span><span class="co">## 23    9.2 14.340649  3.5068316 25.17447 13.462951  6.904134  31.68293</span></span>
<span><span class="co">## 29   12.2  9.028432 -1.4360619 19.49293 10.021731  3.476222  28.24171</span></span>
<span><span class="co">## 30   19.3 29.775630 19.1961282 40.35513 23.626379 16.776725  42.32061</span></span>
<span><span class="co">## 31    7.4  6.013838 -5.5354656 17.56314 12.873051  6.023397  30.80219</span></span>
<span><span class="co">## 32   10.1 14.806645  4.1551453 25.45814 14.838166  8.133931  32.91272</span></span>
<span><span class="co">## 42   12.1  8.704607 -3.6984146 21.10763 13.314959  6.756141  31.53493</span></span>
<span><span class="co">## 54   11.6 10.002970 -0.3839704 20.38991  9.754851  3.209342  28.73991</span></span>
<span><span class="co">## 59   61.9 34.711053 24.1509123 45.27119 22.914288 16.414621  38.49896</span></span>
<span><span class="co">## 72   14.4  9.110664 -1.1222765 19.34360 12.453800  5.578156  31.12204</span></span>
<span><span class="co">## 73    9.0 11.005860  0.0448295 21.96689 10.922573  4.060237  29.59081</span></span>
<span><span class="co">## 76   18.5 26.775186 16.6537717 36.89660 23.760965 16.911311  39.05481</span></span>
<span><span class="co">## 91   23.3 24.122428 12.0542302 36.19063 20.927726 14.078073  39.62195</span></span>
<span><span class="co">## 92   22.7 18.531114  8.4532906 28.60894 16.130723  9.571905  34.35070</span></span></code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate coverage and Winkler scores</span></span>
<span><span class="va">lm_coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">car_data</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="st">"Price"</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">LM_Lower</span> <span class="op">&amp;</span> </span>
<span>                   <span class="va">car_data</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="st">"Price"</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">LM_Upper</span><span class="op">)</span></span>
<span><span class="va">svm_coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">car_data</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="st">"Price"</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">svm_Lower</span> <span class="op">&amp;</span> </span>
<span>                      <span class="va">car_data</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="st">"Price"</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">svm_Upper</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lm_winkler</span> <span class="op">&lt;-</span> <span class="fu">misc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/misc/man/winkler_score.html" class="external-link">winkler_score</a></span><span class="op">(</span><span class="va">car_data</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="st">"Price"</span><span class="op">]</span>, <span class="va">results</span><span class="op">$</span><span class="va">LM_Lower</span>, <span class="va">results</span><span class="op">$</span><span class="va">LM_Upper</span><span class="op">)</span></span>
<span><span class="va">svm_winkler</span> <span class="op">&lt;-</span> <span class="fu">misc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/misc/man/winkler_score.html" class="external-link">winkler_score</a></span><span class="op">(</span><span class="va">car_data</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="st">"Price"</span><span class="op">]</span>, <span class="va">results</span><span class="op">$</span><span class="va">svm_Lower</span>, <span class="va">results</span><span class="op">$</span><span class="va">svm_Upper</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"\nPrediction interval metrics:"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "\nPrediction interval metrics:"</span></span></code></pre>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Linear Model: %.1f%% coverage, %.3f Winkler score"</span>, </span>
<span>              <span class="fl">100</span> <span class="op">*</span> <span class="va">lm_coverage</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">lm_winkler</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Linear Model: 94.1% coverage, 60.599 Winkler score"</span></span></code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Calibrated Model: %.1f%% coverage, %.3f Winkler score"</span>, </span>
<span>              <span class="fl">100</span> <span class="op">*</span> <span class="va">svm_coverage</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">svm_winkler</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Calibrated Model: 94.1% coverage, 79.725 Winkler score"</span></span></code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">svm_model</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, nsim <span class="op">=</span> <span class="fl">500</span>, method<span class="op">=</span><span class="st">"bootstrap"</span><span class="op">)</span></span>
<span><span class="co"># Plot simulations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">sims</span>, type <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"obs. #"</span>, ylab <span class="op">=</span> <span class="st">"Simulated Price"</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Ridge Model Simulations"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">car_data</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="st">"Price"</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>        </span></code></pre></div>
<p><img src="svm_files/figure-html/unnamed-chunk-15-1.png" width="720"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by T. Moudiki.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
