<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ridge model â€¢ rvfl</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Ridge model">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rvfl</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/rvfl.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bootstrap.html">Ridge model (bootstrap) model</a>
    </li>
    <li>
      <a href="../articles/GLM.html">Ridge GLM model</a>
    </li>
    <li>
      <a href="../articles/GLMGamma.html">Ridge GLM Gamma model</a>
    </li>
    <li>
      <a href="../articles/nnet.html">Ridge NNET model</a>
    </li>
    <li>
      <a href="../articles/ridgemodel_summary_plot.html">Ridge model</a>
    </li>
    <li>
      <a href="../articles/ridgemodel.html">Ridge model</a>
    </li>
    <li>
      <a href="../articles/rvfl_summary_plot.html">Ridge model</a>
    </li>
    <li>
      <a href="../articles/surrogate.html">Ridge model (surrogate) model</a>
    </li>
    <li>
      <a href="../articles/svm.html">SVM model</a>
    </li>
    <li>
      <a href="../articles/zeroinfl.html">Zero-inflated GLM model (plus other models)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Ridge model</h1>
            
      

      <div class="hidden name"><code>rvfl_summary_plot.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rvfl</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="example-1-mpg-prediction-mtcars-dataset">Example 1: MPG Prediction (mtcars dataset)<a class="anchor" aria-label="anchor" href="#example-1-mpg-prediction-mtcars-dataset"></a>
</h2>
<div class="section level3">
<h3 id="load-and-prepare-data">Load and prepare data<a class="anchor" aria-label="anchor" href="#load-and-prepare-data"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1243</span><span class="op">)</span></span>
<span><span class="va">train_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">[</span><span class="va">train_idx</span>, <span class="op">]</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-models">Fit models<a class="anchor" aria-label="anchor" href="#fit-models"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit regular linear model</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">lm_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.014</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = mpg ~ ., data = train_data)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -3.5211 -0.9792 -0.0324  1.1808  4.9814 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span><span class="co">## (Intercept) -5.054416  25.456900  -0.199   0.8455  </span></span>
<span><span class="co">## cyl          0.695392   1.396506   0.498   0.6262  </span></span>
<span><span class="co">## disp         0.005254   0.017342   0.303   0.7664  </span></span>
<span><span class="co">## hp          -0.007610   0.027723  -0.274   0.7877  </span></span>
<span><span class="co">## drat         4.128157   2.724353   1.515   0.1520  </span></span>
<span><span class="co">## wt          -1.621396   2.139071  -0.758   0.4610  </span></span>
<span><span class="co">## qsec         0.064356   0.932144   0.069   0.9459  </span></span>
<span><span class="co">## vs           0.138716   3.421183   0.041   0.9682  </span></span>
<span><span class="co">## am          -0.498476   2.956568  -0.169   0.8685  </span></span>
<span><span class="co">## gear         4.402648   2.287816   1.924   0.0749 .</span></span>
<span><span class="co">## carb        -1.999389   1.299580  -1.538   0.1462  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 2.464 on 14 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.8938, Adjusted R-squared:  0.818 </span></span>
<span><span class="co">## F-statistic: 11.79 on 10 and 14 DF,  p-value: 3.4e-05</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    2.5 %      97.5 %</span></span>
<span><span class="co">## (Intercept) -59.65403559 49.54520296</span></span>
<span><span class="co">## cyl          -2.29981561  3.69060001</span></span>
<span><span class="co">## disp         -0.03194096  0.04244882</span></span>
<span><span class="co">## hp           -0.06707095  0.05185084</span></span>
<span><span class="co">## drat         -1.71500030  9.97131342</span></span>
<span><span class="co">## wt           -6.20924769  2.96645550</span></span>
<span><span class="co">## qsec         -1.93489537  2.06360651</span></span>
<span><span class="co">## vs           -7.19899241  7.47642359</span></span>
<span><span class="co">## am           -6.83968216  5.84273112</span></span>
<span><span class="co">## gear         -0.50422869  9.30952400</span></span>
<span><span class="co">## carb         -4.78671119  0.78793282</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit calibrated model </span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">ridge_model</span> <span class="op">&lt;-</span> <span class="fu">rvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/rvfl.html">rvfl</a></span><span class="op">(</span>n_hidden_features<span class="op">=</span><span class="fl">10L</span>, lambda<span class="op">=</span><span class="fl">10</span><span class="op">**</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train_data</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.081</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ridge_model</span>, <span class="va">test_data</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Random Vector Functional Link (RVFL) Model Summary</span></span>
<span><span class="co">## --------------------------------------------------</span></span>
<span><span class="co">## Number of Hidden Features: 10 </span></span>
<span><span class="co">## Activation Function: relu </span></span>
<span><span class="co">## Node Simulation Method: sobol </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Derivative Statistics:</span></span>
<span><span class="co">##              Mean       StdDev     CI_Lower     CI_Upper      P_Value</span></span>
<span><span class="co">## cyl  -0.138236475 4.559425e-15 -0.138236475 -0.138236475 2.533579e-82</span></span>
<span><span class="co">## disp -0.002691253 6.287376e-17 -0.002691253 -0.002691253 3.199622e-83</span></span>
<span><span class="co">## hp   -0.006255885 1.011837e-16 -0.006255885 -0.006255885 3.523233e-84</span></span>
<span><span class="co">## drat  0.794444228 5.384486e-15  0.794444228  0.794444228 1.907633e-86</span></span>
<span><span class="co">## wt   -0.450181717 7.040622e-15 -0.450181717 -0.450181717 2.879709e-84</span></span>
<span><span class="co">## qsec  0.090752939 1.464035e-15  0.090752939  0.090752939 3.468605e-84</span></span>
<span><span class="co">## vs    0.492812907 3.637933e-12  0.492812907  0.492812907 3.184529e-68</span></span>
<span><span class="co">## am    0.636977474 3.681965e-12  0.636977474  0.636977474 7.340791e-69</span></span>
<span><span class="co">## gear  0.378969079 2.586486e-15  0.378969079  0.378969079 1.989060e-86</span></span>
<span><span class="co">## carb -0.290480655 1.121543e-14 -0.290480655 -0.290480655 6.519307e-82</span></span>
<span><span class="co">##      Significance</span></span>
<span><span class="co">## cyl           ***</span></span>
<span><span class="co">## disp          ***</span></span>
<span><span class="co">## hp            ***</span></span>
<span><span class="co">## drat          ***</span></span>
<span><span class="co">## wt            ***</span></span>
<span><span class="co">## qsec          ***</span></span>
<span><span class="co">## vs            ***</span></span>
<span><span class="co">## am            ***</span></span>
<span><span class="co">## gear          ***</span></span>
<span><span class="co">## carb          ***</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ridge_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-3-1.png" width="700"><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-3-2.png" width="700"><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-3-3.png" width="700"><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-3-4.png" width="700"></p>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="example-2-boston-housing-price-prediction">Example 2: Boston Housing Price Prediction<a class="anchor" aria-label="anchor" href="#example-2-boston-housing-price-prediction"></a>
</h2>
<div class="section level3">
<h3 id="load-and-prepare-data-1">Load and prepare data<a class="anchor" aria-label="anchor" href="#load-and-prepare-data-1"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1243</span><span class="op">)</span></span>
<span><span class="va">train_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">Boston</span><span class="op">[</span><span class="va">train_idx</span>, <span class="op">]</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">-</span><span class="fl">14</span><span class="op">]</span>  <span class="co"># -14 removes 'medv' (target variable)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-models-1">Fit models<a class="anchor" aria-label="anchor" href="#fit-models-1"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit regular linear model</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">lm_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">medv</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##    0.01</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = medv ~ ., data = train_data)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -15.220  -2.757  -0.494   1.863  26.961 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  35.832339   5.763210   6.217 1.30e-09 ***</span></span>
<span><span class="co">## crim         -0.095389   0.034717  -2.748 0.006282 ** </span></span>
<span><span class="co">## zn            0.042689   0.016086   2.654 0.008283 ** </span></span>
<span><span class="co">## indus        -0.033013   0.073521  -0.449 0.653657    </span></span>
<span><span class="co">## chas          2.506064   0.939731   2.667 0.007977 ** </span></span>
<span><span class="co">## nox         -17.521010   4.237379  -4.135 4.35e-05 ***</span></span>
<span><span class="co">## rm            3.966727   0.477640   8.305 1.66e-15 ***</span></span>
<span><span class="co">## age           0.006479   0.014922   0.434 0.664410    </span></span>
<span><span class="co">## dis          -1.463187   0.232348  -6.297 8.17e-10 ***</span></span>
<span><span class="co">## rad           0.253984   0.075379   3.369 0.000828 ***</span></span>
<span><span class="co">## tax          -0.009853   0.004350  -2.265 0.024068 *  </span></span>
<span><span class="co">## ptratio      -1.002914   0.147016  -6.822 3.44e-11 ***</span></span>
<span><span class="co">## black         0.008723   0.002984   2.923 0.003664 ** </span></span>
<span><span class="co">## lstat        -0.501984   0.057704  -8.699  &lt; 2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 4.835 on 390 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.7403, Adjusted R-squared:  0.7316 </span></span>
<span><span class="co">## F-statistic: 85.51 on 13 and 390 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    2.5 %      97.5 %</span></span>
<span><span class="co">## (Intercept)  24.50149090 47.16318623</span></span>
<span><span class="co">## crim         -0.16364441 -0.02713269</span></span>
<span><span class="co">## zn            0.01106383  0.07431451</span></span>
<span><span class="co">## indus        -0.17755967  0.11153316</span></span>
<span><span class="co">## chas          0.65849254  4.35363615</span></span>
<span><span class="co">## nox         -25.85197459 -9.19004505</span></span>
<span><span class="co">## rm            3.02765548  4.90579898</span></span>
<span><span class="co">## age          -0.02285933  0.03581667</span></span>
<span><span class="co">## dis          -1.91999833 -1.00637601</span></span>
<span><span class="co">## rad           0.10578379  0.40218383</span></span>
<span><span class="co">## tax          -0.01840515 -0.00129986</span></span>
<span><span class="co">## ptratio      -1.29195676 -0.71387117</span></span>
<span><span class="co">## black         0.00285660  0.01458927</span></span>
<span><span class="co">## lstat        -0.61543411 -0.38853422</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit calibrated model </span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">ridge_model</span> <span class="op">&lt;-</span> <span class="fu">rvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/rvfl.html">rvfl</a></span><span class="op">(</span>n_hidden_features<span class="op">=</span><span class="fl">10L</span>, lambda<span class="op">=</span><span class="fl">10</span><span class="op">**</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">14</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train_data</span><span class="op">$</span><span class="va">medv</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.035</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ridge_model</span>, <span class="va">test_data</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Random Vector Functional Link (RVFL) Model Summary</span></span>
<span><span class="co">## --------------------------------------------------</span></span>
<span><span class="co">## Number of Hidden Features: 10 </span></span>
<span><span class="co">## Activation Function: relu </span></span>
<span><span class="co">## Node Simulation Method: sobol </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Derivative Statistics:</span></span>
<span><span class="co">##                  Mean       StdDev     CI_Lower     CI_Upper       P_Value</span></span>
<span><span class="co">## crim     -0.152720908 4.494768e-13 -0.152720908 -0.152720908  0.000000e+00</span></span>
<span><span class="co">## zn       -0.050159952 4.845844e-03 -0.051111766 -0.049208138 9.312597e-105</span></span>
<span><span class="co">## indus     0.180779801 2.694666e-14  0.180779801  0.180779801  0.000000e+00</span></span>
<span><span class="co">## chas      4.484327582 1.086106e-11  4.484327582  4.484327582  0.000000e+00</span></span>
<span><span class="co">## nox     -30.739470810 6.361871e-14           NA           NA            NA</span></span>
<span><span class="co">## rm        0.676350256 5.237704e-15           NA           NA            NA</span></span>
<span><span class="co">## age       0.065921212 1.021842e-15           NA           NA            NA</span></span>
<span><span class="co">## dis      -0.522955647 8.892063e-15           NA           NA            NA</span></span>
<span><span class="co">## rad       0.153122015 7.610750e-15  0.153122015  0.153122015  0.000000e+00</span></span>
<span><span class="co">## tax      -0.000699621 6.361451e-17 -0.000699621 -0.000699621  0.000000e+00</span></span>
<span><span class="co">## ptratio  -0.206126438 1.449176e-15           NA           NA            NA</span></span>
<span><span class="co">## black    -0.005566961 8.810461e-17           NA           NA            NA</span></span>
<span><span class="co">## lstat    -0.383839907 3.540817e-15           NA           NA            NA</span></span>
<span><span class="co">##         Significance</span></span>
<span><span class="co">## crim             ***</span></span>
<span><span class="co">## zn               ***</span></span>
<span><span class="co">## indus            ***</span></span>
<span><span class="co">## chas             ***</span></span>
<span><span class="co">## nox                 </span></span>
<span><span class="co">## rm                  </span></span>
<span><span class="co">## age                 </span></span>
<span><span class="co">## dis                 </span></span>
<span><span class="co">## rad              ***</span></span>
<span><span class="co">## tax              ***</span></span>
<span><span class="co">## ptratio             </span></span>
<span><span class="co">## black               </span></span>
<span><span class="co">## lstat</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ridge_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-5-1.png" width="700"><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-5-2.png" width="700"><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-5-3.png" width="700"><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-5-4.png" width="700"></p>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="example-3-economic-indicators-longley-dataset">Example 3: Economic Indicators (Longley dataset)<a class="anchor" aria-label="anchor" href="#example-3-economic-indicators-longley-dataset"></a>
</h2>
<div class="section level3">
<h3 id="load-and-prepare-data-2">Load and prepare data<a class="anchor" aria-label="anchor" href="#load-and-prepare-data-2"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">longley</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1243</span><span class="op">)</span></span>
<span><span class="va">train_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">longley</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">longley</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">longley</span><span class="op">[</span><span class="va">train_idx</span>, <span class="op">]</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">longley</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">-</span><span class="fl">7</span><span class="op">]</span>  <span class="co"># -7 removes 'Employed' (target variable)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-models-2">Fit models<a class="anchor" aria-label="anchor" href="#fit-models-2"></a>
</h3>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit regular linear model</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">lm_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Employed</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.006</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = Employed ~ ., data = train_data)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     1948     1951     1962     1960     1953     1958     1956     1947 </span></span>
<span><span class="co">## -0.15209  0.23935 -0.15902 -0.15702  0.04017 -0.11637  0.35418  0.07762 </span></span>
<span><span class="co">##     1954     1955     1952     1961 </span></span>
<span><span class="co">## -0.03138 -0.23164 -0.18207  0.31828 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">## (Intercept)  -3.314e+03  9.930e+02  -3.338  0.02061 * </span></span>
<span><span class="co">## GNP.deflator -7.877e-02  1.033e-01  -0.763  0.48016   </span></span>
<span><span class="co">## GNP          -6.186e-03  4.032e-02  -0.153  0.88407   </span></span>
<span><span class="co">## Unemployed   -1.578e-02  6.060e-03  -2.604  0.04802 * </span></span>
<span><span class="co">## Armed.Forces -1.074e-02  2.478e-03  -4.336  0.00745 **</span></span>
<span><span class="co">## Population   -3.256e-01  2.798e-01  -1.164  0.29697   </span></span>
<span><span class="co">## Year          1.758e+00  5.066e-01   3.470  0.01784 * </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.3053 on 5 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.9962, Adjusted R-squared:  0.9916 </span></span>
<span><span class="co">## F-statistic: 216.2 on 6 and 5 DF,  p-value: 7.153e-06</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                      2.5 %        97.5 %</span></span>
<span><span class="co">## (Intercept)  -5.866601e+03 -7.615995e+02</span></span>
<span><span class="co">## GNP.deflator -3.443182e-01  1.867776e-01</span></span>
<span><span class="co">## GNP          -1.098296e-01  9.745798e-02</span></span>
<span><span class="co">## Unemployed   -3.135588e-02 -2.021522e-04</span></span>
<span><span class="co">## Armed.Forces -1.711223e-02 -4.374897e-03</span></span>
<span><span class="co">## Population   -1.044745e+00  3.935168e-01</span></span>
<span><span class="co">## Year          4.557539e-01  3.060217e+00</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit calibrated model </span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">ridge_model</span> <span class="op">&lt;-</span> <span class="fu">rvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/rvfl.html">rvfl</a></span><span class="op">(</span>n_hidden_features<span class="op">=</span><span class="fl">10L</span>, lambda<span class="op">=</span><span class="fl">10</span><span class="op">**</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train_data</span><span class="op">$</span><span class="va">Employed</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.045</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ridge_model</span>, <span class="va">test_data</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Random Vector Functional Link (RVFL) Model Summary</span></span>
<span><span class="co">## --------------------------------------------------</span></span>
<span><span class="co">## Number of Hidden Features: 10 </span></span>
<span><span class="co">## Activation Function: relu </span></span>
<span><span class="co">## Node Simulation Method: sobol </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Derivative Statistics:</span></span>
<span><span class="co">##                       Mean       StdDev      CI_Lower      CI_Upper</span></span>
<span><span class="co">## GNP.deflator -9.240589e-02 3.012897e-16            NA            NA</span></span>
<span><span class="co">## GNP          -3.748982e-05 1.509959e-16 -3.748982e-05 -3.748982e-05</span></span>
<span><span class="co">## Unemployed    1.747488e-02 2.706317e-16  1.747488e-02  1.747488e-02</span></span>
<span><span class="co">## Armed.Forces -3.242640e-02 4.355503e-16 -3.242640e-02 -3.242640e-02</span></span>
<span><span class="co">## Population    9.068076e-02 6.858398e-16  9.068076e-02  9.068076e-02</span></span>
<span><span class="co">## Year          4.334012e-01 7.523075e-16            NA            NA</span></span>
<span><span class="co">##                   P_Value Significance</span></span>
<span><span class="co">## GNP.deflator           NA             </span></span>
<span><span class="co">## GNP          1.801092e-35          ***</span></span>
<span><span class="co">## Unemployed   1.023940e-42          ***</span></span>
<span><span class="co">## Armed.Forces 6.680354e-43          ***</span></span>
<span><span class="co">## Population   1.192624e-43          ***</span></span>
<span><span class="co">## Year                   NA</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ridge_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-7-1.png" width="700"><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-7-2.png" width="700"><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-7-3.png" width="700"></p>
<pre><code><span><span class="co">## Warning in sqrt(crit * p * (1 - hh)/hh): NaNs produced</span></span>
<span><span class="co">## Warning in sqrt(crit * p * (1 - hh)/hh): NaNs produced</span></span></code></pre>
<p><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-7-4.png" width="700"></p>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="example-4-us-crime-rate-analysis">Example 4: US Crime Rate Analysis<a class="anchor" aria-label="anchor" href="#example-4-us-crime-rate-analysis"></a>
</h2>
<div class="section level3">
<h3 id="load-and-prepare-data-3">Load and prepare data<a class="anchor" aria-label="anchor" href="#load-and-prepare-data-3"></a>
</h3>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">UScrime</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1243</span><span class="op">)</span></span>
<span><span class="va">train_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">UScrime</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">UScrime</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">UScrime</span><span class="op">[</span><span class="va">train_idx</span>, <span class="op">]</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">UScrime</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">-</span><span class="fl">16</span><span class="op">]</span>  <span class="co"># -16 removes 'y' (crime rate)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-models-3">Fit models<a class="anchor" aria-label="anchor" href="#fit-models-3"></a>
</h3>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit regular linear model</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">lm_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.012</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = y ~ ., data = train_data)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -391.18 -114.34  -14.92  117.15  460.03 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">## (Intercept) -6991.5860  2219.2203  -3.150  0.00483 **</span></span>
<span><span class="co">## M               7.1029     5.4076   1.313  0.20319   </span></span>
<span><span class="co">## So            -89.2556   183.9512  -0.485  0.63255   </span></span>
<span><span class="co">## Ed             22.1862     7.7816   2.851  0.00956 **</span></span>
<span><span class="co">## Po1            19.4504    15.2637   1.274  0.21648   </span></span>
<span><span class="co">## Po2           -10.7837    16.0263  -0.673  0.50837   </span></span>
<span><span class="co">## LF             -1.3616     1.8522  -0.735  0.47038   </span></span>
<span><span class="co">## M.F             2.9017     2.6491   1.095  0.28576   </span></span>
<span><span class="co">## Pop            -0.9371     1.6448  -0.570  0.57492   </span></span>
<span><span class="co">## NW              0.8155     0.9873   0.826  0.41810   </span></span>
<span><span class="co">## U1             -8.4003     5.8482  -1.436  0.16562   </span></span>
<span><span class="co">## U2             19.8835    11.0640   1.797  0.08671 . </span></span>
<span><span class="co">## GDP             0.7120     1.2620   0.564  0.57861   </span></span>
<span><span class="co">## Ineq            8.0589     2.8019   2.876  0.00904 **</span></span>
<span><span class="co">## Prob        -3533.2550  2862.6770  -1.234  0.23074   </span></span>
<span><span class="co">## Time            1.3920     9.4699   0.147  0.88454   </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 234.8 on 21 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.758,  Adjusted R-squared:  0.5851 </span></span>
<span><span class="co">## F-statistic: 4.385 on 15 and 21 DF,  p-value: 0.001081</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                     2.5 %       97.5 %</span></span>
<span><span class="co">## (Intercept) -11606.707241 -2376.464825</span></span>
<span><span class="co">## M               -4.142866    18.348646</span></span>
<span><span class="co">## So            -471.803028   293.291831</span></span>
<span><span class="co">## Ed               6.003559    38.368826</span></span>
<span><span class="co">## Po1            -12.292291    51.193066</span></span>
<span><span class="co">## Po2            -44.112293    22.544935</span></span>
<span><span class="co">## LF              -5.213545     2.490260</span></span>
<span><span class="co">## M.F             -2.607377     8.410782</span></span>
<span><span class="co">## Pop             -4.357700     2.483540</span></span>
<span><span class="co">## NW              -1.237650     2.868551</span></span>
<span><span class="co">## U1             -20.562297     3.761712</span></span>
<span><span class="co">## U2              -3.125406    42.892337</span></span>
<span><span class="co">## GDP             -1.912548     3.336557</span></span>
<span><span class="co">## Ineq             2.232069    13.885810</span></span>
<span><span class="co">## Prob         -9486.517778  2420.007809</span></span>
<span><span class="co">## Time           -18.301822    21.085767</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit calibrated model </span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">ridge_model</span> <span class="op">&lt;-</span> <span class="fu">rvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/rvfl.html">rvfl</a></span><span class="op">(</span>n_hidden_features<span class="op">=</span><span class="fl">10L</span>, lambda<span class="op">=</span><span class="fl">10</span><span class="op">**</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">16</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train_data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.034</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ridge_model</span>, <span class="va">test_data</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Random Vector Functional Link (RVFL) Model Summary</span></span>
<span><span class="co">## --------------------------------------------------</span></span>
<span><span class="co">## Number of Hidden Features: 10 </span></span>
<span><span class="co">## Activation Function: relu </span></span>
<span><span class="co">## Node Simulation Method: sobol </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Derivative Statistics:</span></span>
<span><span class="co">##               Mean       StdDev    CI_Lower    CI_Upper       P_Value</span></span>
<span><span class="co">## M        5.2538485 7.725961e-15          NA          NA            NA</span></span>
<span><span class="co">## So     -92.0902989 1.770662e-10 -92.0902989 -92.0902989 5.783176e-107</span></span>
<span><span class="co">## Ed       2.9000441 6.255898e-15          NA          NA            NA</span></span>
<span><span class="co">## Po1      2.2536893 1.151782e-14          NA          NA            NA</span></span>
<span><span class="co">## Po2      2.3610994 1.522981e-14          NA          NA            NA</span></span>
<span><span class="co">## LF       0.7729132 2.466761e-15          NA          NA            NA</span></span>
<span><span class="co">## M.F      0.9284752 2.636893e-15          NA          NA            NA</span></span>
<span><span class="co">## Pop     -0.2759635 7.907530e-14  -0.2759635  -0.2759635 2.096878e-114</span></span>
<span><span class="co">## NW       0.5677779 7.038032e-15   0.5677779   0.5677779 1.112566e-126</span></span>
<span><span class="co">## U1      -1.8670268 6.463918e-15          NA          NA            NA</span></span>
<span><span class="co">## U2      -2.4253262 2.157987e-14  -2.4253262  -2.4253262 5.628326e-128</span></span>
<span><span class="co">## GDP      0.7095275 1.444239e-15          NA          NA            NA</span></span>
<span><span class="co">## Ineq     0.7155947 3.883665e-15          NA          NA            NA</span></span>
<span><span class="co">## Prob -3680.3338967 1.663199e-11          NA          NA            NA</span></span>
<span><span class="co">## Time    11.4828793 5.345821e-14          NA          NA            NA</span></span>
<span><span class="co">##      Significance</span></span>
<span><span class="co">## M                </span></span>
<span><span class="co">## So            ***</span></span>
<span><span class="co">## Ed               </span></span>
<span><span class="co">## Po1              </span></span>
<span><span class="co">## Po2              </span></span>
<span><span class="co">## LF               </span></span>
<span><span class="co">## M.F              </span></span>
<span><span class="co">## Pop           ***</span></span>
<span><span class="co">## NW            ***</span></span>
<span><span class="co">## U1               </span></span>
<span><span class="co">## U2            ***</span></span>
<span><span class="co">## GDP              </span></span>
<span><span class="co">## Ineq             </span></span>
<span><span class="co">## Prob             </span></span>
<span><span class="co">## Time</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ridge_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-9-1.png" width="700"><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-9-2.png" width="700"><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-9-3.png" width="700"><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-9-4.png" width="700"></p>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="example-5-car-price-analysis-cars93-dataset">Example 5: Car Price Analysis (Cars93 dataset)<a class="anchor" aria-label="anchor" href="#example-5-car-price-analysis-cars93-dataset"></a>
</h2>
<div class="section level3">
<h3 id="load-and-prepare-data-4">Load and prepare data<a class="anchor" aria-label="anchor" href="#load-and-prepare-data-4"></a>
</h3>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Cars93</span>, package <span class="op">=</span> <span class="st">"MASS"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove rows with missing values</span></span>
<span><span class="va">Cars93</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">Cars93</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select numeric predictors and price as response</span></span>
<span><span class="va">predictors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MPG.city"</span>, <span class="st">"MPG.highway"</span>, <span class="st">"EngineSize"</span>, <span class="st">"Horsepower"</span>, </span>
<span>                <span class="st">"RPM"</span>, <span class="st">"Rev.per.mile"</span>, <span class="st">"Fuel.tank.capacity"</span>, <span class="st">"Length"</span>, </span>
<span>                <span class="st">"Wheelbase"</span>, <span class="st">"Width"</span>, <span class="st">"Turn.circle"</span>, <span class="st">"Weight"</span><span class="op">)</span></span>
<span><span class="va">car_data</span> <span class="op">&lt;-</span> <span class="va">Cars93</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">predictors</span>, <span class="st">"Price"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1243</span><span class="op">)</span></span>
<span><span class="va">train_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">car_data</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">car_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">car_data</span><span class="op">[</span><span class="va">train_idx</span>, <span class="op">]</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">car_data</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">car_data</span><span class="op">)</span> <span class="op">==</span> <span class="st">"Price"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-models-4">Fit models<a class="anchor" aria-label="anchor" href="#fit-models-4"></a>
</h3>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit regular linear model</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">lm_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Price</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##    0.01</span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = Price ~ ., data = train_data)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -8.9444 -3.4879 -0.0823  2.5740 10.7036 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                      Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span><span class="co">## (Intercept)         6.0285088 31.8235292   0.189   0.8505  </span></span>
<span><span class="co">## MPG.city           -0.3069383  0.4798163  -0.640   0.5252  </span></span>
<span><span class="co">## MPG.highway        -0.0041568  0.4591254  -0.009   0.9928  </span></span>
<span><span class="co">## EngineSize          2.4810783  2.4779636   1.001   0.3213  </span></span>
<span><span class="co">## Horsepower          0.1016741  0.0446071   2.279   0.0268 *</span></span>
<span><span class="co">## RPM                 0.0001602  0.0023006   0.070   0.9448  </span></span>
<span><span class="co">## Rev.per.mile        0.0049762  0.0026868   1.852   0.0697 .</span></span>
<span><span class="co">## Fuel.tank.capacity -0.1866149  0.5198553  -0.359   0.7211  </span></span>
<span><span class="co">## Length              0.0203242  0.1333518   0.152   0.8795  </span></span>
<span><span class="co">## Wheelbase           0.4888949  0.2655782   1.841   0.0713 .</span></span>
<span><span class="co">## Width              -0.8957689  0.4446575  -2.015   0.0491 *</span></span>
<span><span class="co">## Turn.circle        -0.3835124  0.3579624  -1.071   0.2889  </span></span>
<span><span class="co">## Weight              0.0041302  0.0059593   0.693   0.4914  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 4.731 on 52 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.7886, Adjusted R-squared:  0.7398 </span></span>
<span><span class="co">## F-statistic: 16.16 on 12 and 52 DF,  p-value: 1.548e-13</span></span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                            2.5 %       97.5 %</span></span>
<span><span class="co">## (Intercept)        -5.783007e+01 69.887091986</span></span>
<span><span class="co">## MPG.city           -1.269760e+00  0.655883438</span></span>
<span><span class="co">## MPG.highway        -9.254594e-01  0.917145804</span></span>
<span><span class="co">## EngineSize         -2.491319e+00  7.453475962</span></span>
<span><span class="co">## Horsepower          1.216348e-02  0.191184768</span></span>
<span><span class="co">## RPM                -4.456410e-03  0.004776746</span></span>
<span><span class="co">## Rev.per.mile       -4.152533e-04  0.010367616</span></span>
<span><span class="co">## Fuel.tank.capacity -1.229781e+00  0.856550981</span></span>
<span><span class="co">## Length             -2.472657e-01  0.287914102</span></span>
<span><span class="co">## Wheelbase          -4.402679e-02  1.021816593</span></span>
<span><span class="co">## Width              -1.788039e+00 -0.003498354</span></span>
<span><span class="co">## Turn.circle        -1.101817e+00  0.334791684</span></span>
<span><span class="co">## Weight             -7.828121e-03  0.016088453</span></span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit calibrated model </span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">ridge_model</span> <span class="op">&lt;-</span> <span class="fu">rvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/rvfl.html">rvfl</a></span><span class="op">(</span>n_hidden_features<span class="op">=</span><span class="fl">10L</span>, lambda<span class="op">=</span><span class="fl">10</span><span class="op">**</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">)</span> <span class="op">==</span> <span class="st">"Price"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                               y <span class="op">=</span> <span class="va">train_data</span><span class="op">$</span><span class="va">Price</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.024</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ridge_model</span>, <span class="va">test_data</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Random Vector Functional Link (RVFL) Model Summary</span></span>
<span><span class="co">## --------------------------------------------------</span></span>
<span><span class="co">## Number of Hidden Features: 10 </span></span>
<span><span class="co">## Activation Function: relu </span></span>
<span><span class="co">## Node Simulation Method: sobol </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Derivative Statistics:</span></span>
<span><span class="co">##                            Mean       StdDev    CI_Lower    CI_Upper</span></span>
<span><span class="co">## MPG.city           -1.419309710 2.385042e-15          NA          NA</span></span>
<span><span class="co">## MPG.highway         0.617404449 1.723753e-15          NA          NA</span></span>
<span><span class="co">## EngineSize          2.405020135 1.280516e-14          NA          NA</span></span>
<span><span class="co">## Horsepower         -0.014276341 1.793531e-16 -0.01427634 -0.01427634</span></span>
<span><span class="co">## RPM                -0.001808223 6.070322e-18          NA          NA</span></span>
<span><span class="co">## Rev.per.mile        0.010468670 1.537581e-17          NA          NA</span></span>
<span><span class="co">## Fuel.tank.capacity  1.453563178 2.297518e-15          NA          NA</span></span>
<span><span class="co">## Length             -0.243981243 1.698258e-16          NA          NA</span></span>
<span><span class="co">## Wheelbase           0.828600532 7.691851e-16          NA          NA</span></span>
<span><span class="co">## Width               0.030780888 9.182240e-16  0.03078089  0.03078089</span></span>
<span><span class="co">## Turn.circle        -1.755292917 7.570712e-16          NA          NA</span></span>
<span><span class="co">## Weight              0.006863605 9.894199e-18          NA          NA</span></span>
<span><span class="co">##                          P_Value Significance</span></span>
<span><span class="co">## MPG.city                      NA             </span></span>
<span><span class="co">## MPG.highway                   NA             </span></span>
<span><span class="co">## EngineSize                    NA             </span></span>
<span><span class="co">## Horsepower         4.655216e-224          ***</span></span>
<span><span class="co">## RPM                           NA             </span></span>
<span><span class="co">## Rev.per.mile                  NA             </span></span>
<span><span class="co">## Fuel.tank.capacity            NA             </span></span>
<span><span class="co">## Length                        NA             </span></span>
<span><span class="co">## Wheelbase                     NA             </span></span>
<span><span class="co">## Width              4.754959e-218          ***</span></span>
<span><span class="co">## Turn.circle                   NA             </span></span>
<span><span class="co">## Weight                        NA</span></span></code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ridge_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-11-1.png" width="700"><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-11-2.png" width="700"><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-11-3.png" width="700"><img src="rvfl_summary_plot_files/figure-html/unnamed-chunk-11-4.png" width="700"></p>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by T. Moudiki.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
