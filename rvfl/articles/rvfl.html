<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RVFL model â€¢ rvfl</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="RVFL model">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rvfl</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/rvfl.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bootstrap.html">Ridge model (bootstrap) model</a>
    </li>
    <li>
      <a href="../articles/GLM.html">Ridge GLM model</a>
    </li>
    <li>
      <a href="../articles/GLMGamma.html">Ridge GLM Gamma model</a>
    </li>
    <li>
      <a href="../articles/nnet.html">Ridge NNET model</a>
    </li>
    <li>
      <a href="../articles/ridgemodel_summary_plot.html">Ridge model</a>
    </li>
    <li>
      <a href="../articles/ridgemodel.html">Ridge model</a>
    </li>
    <li>
      <a href="../articles/rvfl_summary_plot.html">Ridge model</a>
    </li>
    <li>
      <a href="../articles/surrogate.html">Ridge model (surrogate) model</a>
    </li>
    <li>
      <a href="../articles/svm.html">SVM model</a>
    </li>
    <li>
      <a href="../articles/zeroinfl.html">Zero-inflated GLM model (plus other models)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>RVFL model</h1>
            
      

      <div class="hidden name"><code>rvfl.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rvfl</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="example-1-mpg-prediction-mtcars-dataset">Example 1: MPG Prediction (mtcars dataset)<a class="anchor" aria-label="anchor" href="#example-1-mpg-prediction-mtcars-dataset"></a>
</h2>
<div class="section level3">
<h3 id="load-and-prepare-data">Load and prepare data<a class="anchor" aria-label="anchor" href="#load-and-prepare-data"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1243</span><span class="op">)</span></span>
<span><span class="va">train_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">[</span><span class="va">train_idx</span>, <span class="op">]</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-models">Fit models<a class="anchor" aria-label="anchor" href="#fit-models"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit regular linear model</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">lm_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.017</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = mpg ~ ., data = train_data)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -3.5211 -0.9792 -0.0324  1.1808  4.9814 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##              Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span><span class="co">## (Intercept) -5.054416  25.456900  -0.199   0.8455  </span></span>
<span><span class="co">## cyl          0.695392   1.396506   0.498   0.6262  </span></span>
<span><span class="co">## disp         0.005254   0.017342   0.303   0.7664  </span></span>
<span><span class="co">## hp          -0.007610   0.027723  -0.274   0.7877  </span></span>
<span><span class="co">## drat         4.128157   2.724353   1.515   0.1520  </span></span>
<span><span class="co">## wt          -1.621396   2.139071  -0.758   0.4610  </span></span>
<span><span class="co">## qsec         0.064356   0.932144   0.069   0.9459  </span></span>
<span><span class="co">## vs           0.138716   3.421183   0.041   0.9682  </span></span>
<span><span class="co">## am          -0.498476   2.956568  -0.169   0.8685  </span></span>
<span><span class="co">## gear         4.402648   2.287816   1.924   0.0749 .</span></span>
<span><span class="co">## carb        -1.999389   1.299580  -1.538   0.1462  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 2.464 on 14 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.8938, Adjusted R-squared:  0.818 </span></span>
<span><span class="co">## F-statistic: 11.79 on 10 and 14 DF,  p-value: 3.4e-05</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    2.5 %      97.5 %</span></span>
<span><span class="co">## (Intercept) -59.65403559 49.54520296</span></span>
<span><span class="co">## cyl          -2.29981561  3.69060001</span></span>
<span><span class="co">## disp         -0.03194096  0.04244882</span></span>
<span><span class="co">## hp           -0.06707095  0.05185084</span></span>
<span><span class="co">## drat         -1.71500030  9.97131342</span></span>
<span><span class="co">## wt           -6.20924769  2.96645550</span></span>
<span><span class="co">## qsec         -1.93489537  2.06360651</span></span>
<span><span class="co">## vs           -7.19899241  7.47642359</span></span>
<span><span class="co">## am           -6.83968216  5.84273112</span></span>
<span><span class="co">## gear         -0.50422869  9.30952400</span></span>
<span><span class="co">## carb         -4.78671119  0.78793282</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit calibrated model </span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">ridge_model</span> <span class="op">&lt;-</span> <span class="fu">rvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/rvfl.html">rvfl</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train_data</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.193</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ridge_model</span><span class="op">$</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## engine(formula = y ~ . - 1, data = df_train)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -3.4586 -1.7751 -0.4056  1.5360  5.2494 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##      Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">## cyl   -0.2934     0.6109  -0.480    0.638</span></span>
<span><span class="co">## disp  -0.4021     0.6033  -0.667    0.516</span></span>
<span><span class="co">## hp    -0.4266     0.6034  -0.707    0.491</span></span>
<span><span class="co">## drat   0.5285     0.5736   0.921    0.372</span></span>
<span><span class="co">## wt    -0.5200     0.5947  -0.874    0.397</span></span>
<span><span class="co">## qsec   0.1419     0.5949   0.238    0.815</span></span>
<span><span class="co">## vs     0.2738     0.5787   0.473    0.643</span></span>
<span><span class="co">## am     0.4077     0.5711   0.714    0.487</span></span>
<span><span class="co">## gear   0.2922     0.5785   0.505    0.621</span></span>
<span><span class="co">## carb  -0.3778     0.5421  -0.697    0.497</span></span>
<span><span class="co">## h1    -0.2444     0.6039  -0.405    0.692</span></span>
<span><span class="co">## h2     0.6964     0.5848   1.191    0.253</span></span>
<span><span class="co">## h3    -0.3387     0.5802  -0.584    0.569</span></span>
<span><span class="co">## h4    -0.1628     0.5448  -0.299    0.769</span></span>
<span><span class="co">## h5     0.5906     0.5822   1.014    0.328</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 2.925 on 14 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.7534, Adjusted R-squared:  0.4892 </span></span>
<span><span class="co">## F-statistic: 2.851 on 15 and 14 DF,  p-value: 0.02863</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">ridge_model</span><span class="op">$</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           2.5 %    97.5 %</span></span>
<span><span class="co">## cyl  -1.6037724 1.0168960</span></span>
<span><span class="co">## disp -1.6959495 0.8917476</span></span>
<span><span class="co">## hp   -1.7208611 0.8676077</span></span>
<span><span class="co">## drat -0.7018175 1.7587974</span></span>
<span><span class="co">## wt   -1.7955969 0.7555437</span></span>
<span><span class="co">## qsec -1.1340563 1.4177867</span></span>
<span><span class="co">## vs   -0.9673542 1.5149112</span></span>
<span><span class="co">## am   -0.8172659 1.6326674</span></span>
<span><span class="co">## gear -0.9485594 1.5330304</span></span>
<span><span class="co">## carb -1.5405137 0.7848791</span></span>
<span><span class="co">## h1   -1.5396642 1.0508179</span></span>
<span><span class="co">## h2   -0.5577916 1.9506325</span></span>
<span><span class="co">## h3   -1.5831708 0.9057347</span></span>
<span><span class="co">## h4   -1.3312796 1.0055891</span></span>
<span><span class="co">## h5   -0.6580768 1.8392040</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#print(simulate(ridge_model, newdata = test_data))</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="make-predictions">Make predictions<a class="anchor" aria-label="anchor" href="#make-predictions"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">lm_model</span>, newdata <span class="op">=</span> <span class="va">test_data</span>, interval <span class="op">=</span> <span class="st">"prediction"</span><span class="op">)</span></span>
<span><span class="va">ridge_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ridge_model</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compare-predictions">Compare predictions<a class="anchor" aria-label="anchor" href="#compare-predictions"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Actual <span class="op">=</span> <span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">mpg</span>,</span>
<span>  LM_Pred <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"fit"</span><span class="op">]</span>,</span>
<span>  LM_Lower <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"lwr"</span><span class="op">]</span>,</span>
<span>  LM_Upper <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"upr"</span><span class="op">]</span>,</span>
<span>  Ridge_Pred <span class="op">=</span> <span class="va">ridge_pred</span><span class="op">[</span>,<span class="st">"fit"</span><span class="op">]</span>,</span>
<span>  Ridge_Lower <span class="op">=</span> <span class="va">ridge_pred</span><span class="op">[</span>,<span class="st">"lwr"</span><span class="op">]</span>, </span>
<span>  Ridge_Upper <span class="op">=</span> <span class="va">ridge_pred</span><span class="op">[</span>,<span class="st">"upr"</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Prediction Intervals Comparison:"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Prediction Intervals Comparison:"</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                Actual  LM_Pred  LM_Lower LM_Upper Ridge_Pred Ridge_Lower</span></span>
<span><span class="co">## Valiant          18.1 17.93324 10.149847 25.71663   18.96396    15.81971</span></span>
<span><span class="co">## Merc 280C        17.8 20.63530 13.636618 27.63398   19.75734    15.72996</span></span>
<span><span class="co">## Toyota Corolla   33.9 28.58373 22.379666 34.78779   26.85749    23.43556</span></span>
<span><span class="co">## Camaro Z28       13.3 15.85710  8.140858 23.57335   15.29984    11.44900</span></span>
<span><span class="co">## Porsche 914-2    26.0 31.07535 18.988702 43.16201   25.59502    22.15517</span></span>
<span><span class="co">## Ford Pantera L   15.8 27.07516 14.930150 39.22016   19.74423    16.25442</span></span>
<span><span class="co">##                Ridge_Upper</span></span>
<span><span class="co">## Valiant           22.78275</span></span>
<span><span class="co">## Merc 280C         23.97086</span></span>
<span><span class="co">## Toyota Corolla    32.21672</span></span>
<span><span class="co">## Camaro Z28        18.58237</span></span>
<span><span class="co">## Porsche 914-2     28.98960</span></span>
<span><span class="co">## Ford Pantera L    23.25351</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate coverage and Winkler scores</span></span>
<span><span class="va">lm_coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">mpg</span> <span class="op">&gt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">LM_Lower</span> <span class="op">&amp;</span> </span>
<span>                   <span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">mpg</span> <span class="op">&lt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">LM_Upper</span><span class="op">)</span></span>
<span><span class="va">ridge_coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">mpg</span> <span class="op">&gt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">Ridge_Lower</span> <span class="op">&amp;</span> </span>
<span>                      <span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">mpg</span> <span class="op">&lt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">Ridge_Upper</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lm_winkler</span> <span class="op">&lt;-</span> <span class="fu">misc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/misc/man/winkler_score.html" class="external-link">winkler_score</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">mpg</span>, <span class="va">results</span><span class="op">$</span><span class="va">LM_Lower</span>, <span class="va">results</span><span class="op">$</span><span class="va">LM_Upper</span><span class="op">)</span></span>
<span><span class="va">ridge_winkler</span> <span class="op">&lt;-</span> <span class="fu">misc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/misc/man/winkler_score.html" class="external-link">winkler_score</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">mpg</span>, <span class="va">results</span><span class="op">$</span><span class="va">Ridge_Lower</span>, <span class="va">results</span><span class="op">$</span><span class="va">Ridge_Upper</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"\nPrediction interval metrics:"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "\nPrediction interval metrics:"</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Linear Model: %.1f%% coverage, %.3f Winkler score"</span>, </span>
<span>              <span class="fl">100</span> <span class="op">*</span> <span class="va">lm_coverage</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">lm_winkler</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Linear Model: 100.0% coverage, 18.226 Winkler score"</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Calibrated Model: %.1f%% coverage, %.3f Winkler score"</span>, </span>
<span>              <span class="fl">100</span> <span class="op">*</span> <span class="va">ridge_coverage</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ridge_winkler</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Calibrated Model: 71.4% coverage, 19.857 Winkler score"</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set common y-axis limits for both plots</span></span>
<span><span class="va">y_limits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">LM_Lower</span>, <span class="va">results</span><span class="op">$</span><span class="va">LM_Upper</span>,</span>
<span>                   <span class="va">results</span><span class="op">$</span><span class="va">Ridge_Lower</span>, <span class="va">results</span><span class="op">$</span><span class="va">Ridge_Upper</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot prediction intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Linear Model Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span>, <span class="va">results</span><span class="op">$</span><span class="va">LM_Pred</span>, </span>
<span>     main<span class="op">=</span><span class="st">"Linear Model Predictions"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Actual MPG"</span>, ylab<span class="op">=</span><span class="st">"Predicted MPG"</span>,</span>
<span>     ylim<span class="op">=</span><span class="va">y_limits</span><span class="op">)</span></span>
<span><span class="co"># Add shaded prediction intervals</span></span>
<span><span class="va">x_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">LM_Lower</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">LM_Upper</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span>, <span class="va">results</span><span class="op">$</span><span class="va">LM_Pred</span><span class="op">)</span>  <span class="co"># Replot points over shading</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, col<span class="op">=</span><span class="st">"red"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>  <span class="co"># Add diagonal line</span></span>
<span></span>
<span><span class="co"># Ridge Model Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span>, <span class="va">results</span><span class="op">$</span><span class="va">Ridge_Pred</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Ridge Model Predictions"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Actual MPG"</span>, ylab<span class="op">=</span><span class="st">"Predicted MPG"</span>,</span>
<span>     ylim<span class="op">=</span><span class="va">y_limits</span><span class="op">)</span></span>
<span><span class="co"># Add shaded prediction intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Ridge_Lower</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Ridge_Upper</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span>, <span class="va">results</span><span class="op">$</span><span class="va">Ridge_Pred</span><span class="op">)</span>  <span class="co"># Replot points over shading</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, col<span class="op">=</span><span class="st">"red"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>  <span class="co"># Add diagonal line</span></span></code></pre></div>
<p><img src="rvfl_files/figure-html/unnamed-chunk-5-1.png" width="720"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add simulation plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Generate 100 simulations</span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">ridge_model</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, nsim <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="co"># Plot simulations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">sims</span>, type <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"obs. #"</span>, ylab <span class="op">=</span> <span class="st">"Simulated MPG"</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Ridge Model Simulations"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">mpg</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>        </span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="example-2-boston-housing-price-prediction">Example 2: Boston Housing Price Prediction<a class="anchor" aria-label="anchor" href="#example-2-boston-housing-price-prediction"></a>
</h2>
<div class="section level3">
<h3 id="load-and-prepare-data-1">Load and prepare data<a class="anchor" aria-label="anchor" href="#load-and-prepare-data-1"></a>
</h3>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1243</span><span class="op">)</span></span>
<span><span class="va">train_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fl">0.8</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">Boston</span><span class="op">[</span><span class="va">train_idx</span>, <span class="op">]</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">-</span><span class="fl">14</span><span class="op">]</span>  <span class="co"># -14 removes 'medv' (target variable)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-models-1">Fit models<a class="anchor" aria-label="anchor" href="#fit-models-1"></a>
</h3>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit regular linear model</span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">lm_model</span> <span class="op">&lt;-</span> <span class="fu">rvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/rvfl.html">rvfl</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">14</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train_data</span><span class="op">$</span><span class="va">medv</span>, activ <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span><span class="co">#lm(medv ~ ., data = train_data)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.097</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">$</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## engine(formula = y ~ . - 1, data = df_train)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -10.8740  -2.8709  -0.5828   1.8772  26.0796 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##         Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## crim    -0.97711    1.03548  -0.944   0.3465    </span></span>
<span><span class="co">## zn       1.05329    1.00842   1.044   0.2975    </span></span>
<span><span class="co">## indus    0.25561    1.09993   0.232   0.8165    </span></span>
<span><span class="co">## chas     0.69443    0.85692   0.810   0.4187    </span></span>
<span><span class="co">## nox     -1.65544    1.11978  -1.478   0.1409    </span></span>
<span><span class="co">## rm       2.54157    1.01833   2.496   0.0134 *  </span></span>
<span><span class="co">## age      0.59156    1.15721   0.511   0.6098    </span></span>
<span><span class="co">## dis     -2.50321    1.19731  -2.091   0.0378 *  </span></span>
<span><span class="co">## rad      2.05723    1.09839   1.873   0.0625 .  </span></span>
<span><span class="co">## tax     -1.12820    1.30239  -0.866   0.3874    </span></span>
<span><span class="co">## ptratio -1.49972    1.00988  -1.485   0.1391    </span></span>
<span><span class="co">## black    0.88341    0.90808   0.973   0.3318    </span></span>
<span><span class="co">## lstat   -3.85354    0.94186  -4.091 6.18e-05 ***</span></span>
<span><span class="co">## h1      -0.12471    1.90545  -0.065   0.9479    </span></span>
<span><span class="co">## h2       0.12471    1.90545   0.065   0.9479    </span></span>
<span><span class="co">## h3       0.12541    1.60619   0.078   0.9378    </span></span>
<span><span class="co">## h4      -0.06691    1.61069  -0.042   0.9669    </span></span>
<span><span class="co">## h5       0.68743    1.65118   0.416   0.6776    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 5.062 on 203 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:   0.69,  Adjusted R-squared:  0.6625 </span></span>
<span><span class="co">## F-statistic:  25.1 on 18 and 203 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">lm_model</span><span class="op">$</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##              2.5 %     97.5 %</span></span>
<span><span class="co">## crim    -3.0187805  1.0645547</span></span>
<span><span class="co">## zn      -0.9350311  3.0416020</span></span>
<span><span class="co">## indus   -1.9131387  2.4243638</span></span>
<span><span class="co">## chas    -0.9951706  2.3840263</span></span>
<span><span class="co">## nox     -3.8633281  0.5524414</span></span>
<span><span class="co">## rm       0.5337147  4.5494251</span></span>
<span><span class="co">## age     -1.6901406  2.8732508</span></span>
<span><span class="co">## dis     -4.8639566 -0.1424538</span></span>
<span><span class="co">## rad     -0.1084805  4.2229500</span></span>
<span><span class="co">## tax     -3.6961423  1.4397357</span></span>
<span><span class="co">## ptratio -3.4909239  0.4914810</span></span>
<span><span class="co">## black   -0.9070666  2.6738816</span></span>
<span><span class="co">## lstat   -5.7106232 -1.9964644</span></span>
<span><span class="co">## h1      -3.8817198  3.6323082</span></span>
<span><span class="co">## h2      -3.6323082  3.8817198</span></span>
<span><span class="co">## h3      -3.0415556  3.2923664</span></span>
<span><span class="co">## h4      -3.2427373  3.1089125</span></span>
<span><span class="co">## h5      -2.5682466  3.9430974</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit calibrated model </span></span>
<span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">ridge_model</span> <span class="op">&lt;-</span> <span class="fu">rvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/rvfl.html">rvfl</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">14</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train_data</span><span class="op">$</span><span class="va">medv</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## elapsed </span></span>
<span><span class="co">##   0.135</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ridge_model</span><span class="op">$</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## engine(formula = y ~ . - 1, data = df_train)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -9.6436 -2.5860 -0.4639  2.0094 24.4992 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##         Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## crim     -3.0623     1.1491  -2.665 0.008317 ** </span></span>
<span><span class="co">## zn        0.2952     0.9853   0.300 0.764763    </span></span>
<span><span class="co">## indus     0.3479     0.9903   0.351 0.725768    </span></span>
<span><span class="co">## chas      0.7550     0.7475   1.010 0.313689    </span></span>
<span><span class="co">## nox      -2.4144     0.9770  -2.471 0.014291 *  </span></span>
<span><span class="co">## rm        1.6957     0.8527   1.989 0.048091 *  </span></span>
<span><span class="co">## age       1.0275     0.9888   1.039 0.299986    </span></span>
<span><span class="co">## dis      -3.8911     1.0732  -3.626 0.000364 ***</span></span>
<span><span class="co">## rad       2.9026     1.1001   2.639 0.008970 ** </span></span>
<span><span class="co">## tax      -1.8431     1.2394  -1.487 0.138527    </span></span>
<span><span class="co">## ptratio  -0.7089     0.9333  -0.760 0.448393    </span></span>
<span><span class="co">## black     1.3562     1.0188   1.331 0.184607    </span></span>
<span><span class="co">## lstat    -3.6097     0.8140  -4.434 1.51e-05 ***</span></span>
<span><span class="co">## h1        1.4467     1.5982   0.905 0.366441    </span></span>
<span><span class="co">## h2        2.2793     1.6075   1.418 0.157757    </span></span>
<span><span class="co">## h3        2.0981     0.6087   3.447 0.000689 ***</span></span>
<span><span class="co">## h4        1.8865     1.3423   1.405 0.161431    </span></span>
<span><span class="co">## h5        1.8774     0.7984   2.352 0.019650 *  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 4.403 on 203 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.7655, Adjusted R-squared:  0.7447 </span></span>
<span><span class="co">## F-statistic: 36.81 on 18 and 203 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">ridge_model</span><span class="op">$</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##               2.5 %     97.5 %</span></span>
<span><span class="co">## crim    -5.32791535 -0.7966590</span></span>
<span><span class="co">## zn      -1.64742341  2.2378519</span></span>
<span><span class="co">## indus   -1.60482173  2.3005293</span></span>
<span><span class="co">## chas    -0.71890031  2.2289375</span></span>
<span><span class="co">## nox     -4.34089360 -0.4879895</span></span>
<span><span class="co">## rm       0.01437801  3.3770093</span></span>
<span><span class="co">## age     -0.92219782  2.9772528</span></span>
<span><span class="co">## dis     -6.00709823 -1.7751782</span></span>
<span><span class="co">## rad      0.73360783  5.0715876</span></span>
<span><span class="co">## tax     -4.28680612  0.6005612</span></span>
<span><span class="co">## ptratio -2.54904493  1.1312701</span></span>
<span><span class="co">## black   -0.65250165  3.3648953</span></span>
<span><span class="co">## lstat   -5.21467118 -2.0046819</span></span>
<span><span class="co">## h1      -1.70458059  4.5979892</span></span>
<span><span class="co">## h2      -0.89028309  5.4487882</span></span>
<span><span class="co">## h3       0.89797558  3.2982400</span></span>
<span><span class="co">## h4      -0.76016904  4.5331138</span></span>
<span><span class="co">## h5       0.30329787  3.4515435</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#print(simulate(ridge_model, newdata = test_data))</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="make-predictions-and-compare">Make predictions and compare<a class="anchor" aria-label="anchor" href="#make-predictions-and-compare"></a>
</h3>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">lm_model</span>, newdata <span class="op">=</span> <span class="va">test_data</span>, interval <span class="op">=</span> <span class="st">"prediction"</span><span class="op">)</span></span>
<span><span class="va">ridge_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ridge_model</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Actual <span class="op">=</span> <span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>,</span>
<span>  LM_Pred <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"fit"</span><span class="op">]</span>,</span>
<span>  LM_Lower <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"lwr"</span><span class="op">]</span>,</span>
<span>  LM_Upper <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"upr"</span><span class="op">]</span>,</span>
<span>  Ridge_Pred <span class="op">=</span> <span class="va">ridge_pred</span><span class="op">[</span>,<span class="st">"fit"</span><span class="op">]</span>,</span>
<span>  Ridge_Lower <span class="op">=</span> <span class="va">ridge_pred</span><span class="op">[</span>,<span class="st">"lwr"</span><span class="op">]</span>, </span>
<span>  Ridge_Upper <span class="op">=</span> <span class="va">ridge_pred</span><span class="op">[</span>,<span class="st">"upr"</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Prediction Intervals Comparison:"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Prediction Intervals Comparison:"</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Actual  LM_Pred  LM_Lower LM_Upper Ridge_Pred Ridge_Lower Ridge_Upper</span></span>
<span><span class="co">## 1    24.0 29.79046 19.608073 39.97285   28.75770   19.568995    37.96624</span></span>
<span><span class="co">## 3    34.7 30.96586 20.872948 41.05878   34.14903   25.222195    40.80861</span></span>
<span><span class="co">## 4    33.4 29.08560 18.927692 39.24351   34.41607   25.955182    42.07926</span></span>
<span><span class="co">## 18   17.5 17.88680  7.769896 28.00369   14.73369    7.990620    25.30735</span></span>
<span><span class="co">## 21   13.6 13.55881  3.342978 23.77464   13.65759    6.005290    22.40761</span></span>
<span><span class="co">## 24   14.5 15.04997  4.841070 25.25886   13.86386    5.700152    22.48673</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate coverage and Winkler scores</span></span>
<span><span class="va">lm_coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span> <span class="op">&gt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">LM_Lower</span> <span class="op">&amp;</span> </span>
<span>                   <span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span> <span class="op">&lt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">LM_Upper</span><span class="op">)</span></span>
<span><span class="va">ridge_coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span> <span class="op">&gt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">Ridge_Lower</span> <span class="op">&amp;</span> </span>
<span>                      <span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span> <span class="op">&lt;=</span> <span class="va">results</span><span class="op">$</span><span class="va">Ridge_Upper</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lm_winkler</span> <span class="op">&lt;-</span> <span class="fu">misc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/misc/man/winkler_score.html" class="external-link">winkler_score</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>, <span class="va">results</span><span class="op">$</span><span class="va">LM_Lower</span>, <span class="va">results</span><span class="op">$</span><span class="va">LM_Upper</span><span class="op">)</span></span>
<span><span class="va">ridge_winkler</span> <span class="op">&lt;-</span> <span class="fu">misc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/misc/man/winkler_score.html" class="external-link">winkler_score</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>, <span class="va">results</span><span class="op">$</span><span class="va">Ridge_Lower</span>, <span class="va">results</span><span class="op">$</span><span class="va">Ridge_Upper</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"\nPrediction interval metrics:"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "\nPrediction interval metrics:"</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Linear Model: %.1f%% coverage, %.3f Winkler score"</span>, </span>
<span>              <span class="fl">100</span> <span class="op">*</span> <span class="va">lm_coverage</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">lm_winkler</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Linear Model: 94.1% coverage, 26.946 Winkler score"</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Calibrated Model: %.1f%% coverage, %.3f Winkler score"</span>, </span>
<span>              <span class="fl">100</span> <span class="op">*</span> <span class="va">ridge_coverage</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ridge_winkler</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Calibrated Model: 95.1% coverage, 25.419 Winkler score"</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualization</span></span>
<span><span class="co"># Set common y-axis limits for both plots</span></span>
<span><span class="va">y_limits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">LM_Lower</span>, <span class="va">results</span><span class="op">$</span><span class="va">LM_Upper</span>,</span>
<span>                   <span class="va">results</span><span class="op">$</span><span class="va">Ridge_Lower</span>, <span class="va">results</span><span class="op">$</span><span class="va">Ridge_Upper</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Linear Model Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span>, <span class="va">results</span><span class="op">$</span><span class="va">LM_Pred</span>, </span>
<span>     main<span class="op">=</span><span class="st">"Linear Model Predictions"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Actual Median Value"</span>, ylab<span class="op">=</span><span class="st">"Predicted Median Value"</span>,</span>
<span>     ylim<span class="op">=</span><span class="va">y_limits</span><span class="op">)</span></span>
<span><span class="va">x_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">LM_Lower</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">LM_Upper</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span>, <span class="va">results</span><span class="op">$</span><span class="va">LM_Pred</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, col<span class="op">=</span><span class="st">"red"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ridge Model Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span>, <span class="va">results</span><span class="op">$</span><span class="va">Ridge_Pred</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Ridge Model Predictions"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Actual Median Value"</span>, ylab<span class="op">=</span><span class="st">"Predicted Median Value"</span>,</span>
<span>     ylim<span class="op">=</span><span class="va">y_limits</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Ridge_Lower</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Ridge_Upper</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">Actual</span>, <span class="va">results</span><span class="op">$</span><span class="va">Ridge_Pred</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, col<span class="op">=</span><span class="st">"red"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="rvfl_files/figure-html/unnamed-chunk-9-1.png" width="720"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add simulation plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">ridge_model</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, nsim <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">sims</span>, type <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"obs. #"</span>, ylab <span class="op">=</span> <span class="st">"Simulated Median Value"</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Ridge Model Simulations"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="compare-different-activation-functions">Compare different activation functions<a class="anchor" aria-label="anchor" href="#compare-different-activation-functions"></a>
</h2>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adjust margins to fit plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Bottom, left, top, right margins</span></span>
<span></span>
<span><span class="co"># Fit models with different activation functions</span></span>
<span><span class="va">ridge_relu</span> <span class="op">&lt;-</span> <span class="fu">rvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/rvfl.html">rvfl</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">14</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train_data</span><span class="op">$</span><span class="va">medv</span>, activ <span class="op">=</span> <span class="st">"relu"</span><span class="op">)</span></span>
<span><span class="va">ridge_sigmoid</span> <span class="op">&lt;-</span> <span class="fu">rvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/rvfl.html">rvfl</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">14</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train_data</span><span class="op">$</span><span class="va">medv</span>, activ <span class="op">=</span> <span class="st">"sigmoid"</span><span class="op">)</span></span>
<span><span class="va">ridge_tanh</span> <span class="op">&lt;-</span> <span class="fu">rvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/rvfl.html">rvfl</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">[</span>,<span class="op">-</span><span class="fl">14</span><span class="op">]</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train_data</span><span class="op">$</span><span class="va">medv</span>, activ <span class="op">=</span> <span class="st">"tanh"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make predictions</span></span>
<span><span class="va">relu_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ridge_relu</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="va">sigmoid_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ridge_sigmoid</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="va">tanh_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">ridge_tanh</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine results</span></span>
<span><span class="va">results_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Actual <span class="op">=</span> <span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>,</span>
<span>  LM_Pred <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"fit"</span><span class="op">]</span>,</span>
<span>  LM_Lower <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"lwr"</span><span class="op">]</span>,</span>
<span>  LM_Upper <span class="op">=</span> <span class="va">lm_pred</span><span class="op">[</span>,<span class="st">"upr"</span><span class="op">]</span>,</span>
<span>  ReLU_Pred <span class="op">=</span> <span class="va">relu_pred</span><span class="op">[</span>,<span class="st">"fit"</span><span class="op">]</span>,</span>
<span>  ReLU_Lower <span class="op">=</span> <span class="va">relu_pred</span><span class="op">[</span>,<span class="st">"lwr"</span><span class="op">]</span>,</span>
<span>  ReLU_Upper <span class="op">=</span> <span class="va">relu_pred</span><span class="op">[</span>,<span class="st">"upr"</span><span class="op">]</span>,</span>
<span>  Sigmoid_Pred <span class="op">=</span> <span class="va">sigmoid_pred</span><span class="op">[</span>,<span class="st">"fit"</span><span class="op">]</span>,</span>
<span>  Sigmoid_Lower <span class="op">=</span> <span class="va">sigmoid_pred</span><span class="op">[</span>,<span class="st">"lwr"</span><span class="op">]</span>,</span>
<span>  Sigmoid_Upper <span class="op">=</span> <span class="va">sigmoid_pred</span><span class="op">[</span>,<span class="st">"upr"</span><span class="op">]</span>,</span>
<span>  Tanh_Pred <span class="op">=</span> <span class="va">tanh_pred</span><span class="op">[</span>,<span class="st">"fit"</span><span class="op">]</span>,</span>
<span>  Tanh_Lower <span class="op">=</span> <span class="va">tanh_pred</span><span class="op">[</span>,<span class="st">"lwr"</span><span class="op">]</span>,</span>
<span>  Tanh_Upper <span class="op">=</span> <span class="va">tanh_pred</span><span class="op">[</span>,<span class="st">"upr"</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate coverage and Winkler scores for each model</span></span>
<span><span class="va">lm_coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span> <span class="op">&gt;=</span> <span class="va">results_all</span><span class="op">$</span><span class="va">LM_Lower</span> <span class="op">&amp;</span> </span>
<span>                   <span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span> <span class="op">&lt;=</span> <span class="va">results_all</span><span class="op">$</span><span class="va">LM_Upper</span><span class="op">)</span></span>
<span><span class="va">relu_coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span> <span class="op">&gt;=</span> <span class="va">results_all</span><span class="op">$</span><span class="va">ReLU_Lower</span> <span class="op">&amp;</span> </span>
<span>                     <span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span> <span class="op">&lt;=</span> <span class="va">results_all</span><span class="op">$</span><span class="va">ReLU_Upper</span><span class="op">)</span></span>
<span><span class="va">sigmoid_coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span> <span class="op">&gt;=</span> <span class="va">results_all</span><span class="op">$</span><span class="va">Sigmoid_Lower</span> <span class="op">&amp;</span> </span>
<span>                        <span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span> <span class="op">&lt;=</span> <span class="va">results_all</span><span class="op">$</span><span class="va">Sigmoid_Upper</span><span class="op">)</span></span>
<span><span class="va">tanh_coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span> <span class="op">&gt;=</span> <span class="va">results_all</span><span class="op">$</span><span class="va">Tanh_Lower</span> <span class="op">&amp;</span> </span>
<span>                     <span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span> <span class="op">&lt;=</span> <span class="va">results_all</span><span class="op">$</span><span class="va">Tanh_Upper</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lm_winkler</span> <span class="op">&lt;-</span> <span class="fu">misc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/misc/man/winkler_score.html" class="external-link">winkler_score</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>, </span>
<span>                                 <span class="va">results_all</span><span class="op">$</span><span class="va">LM_Lower</span>, <span class="va">results_all</span><span class="op">$</span><span class="va">LM_Upper</span><span class="op">)</span></span>
<span><span class="va">relu_winkler</span> <span class="op">&lt;-</span> <span class="fu">misc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/misc/man/winkler_score.html" class="external-link">winkler_score</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>, </span>
<span>                                   <span class="va">results_all</span><span class="op">$</span><span class="va">ReLU_Lower</span>, <span class="va">results_all</span><span class="op">$</span><span class="va">ReLU_Upper</span><span class="op">)</span></span>
<span><span class="va">sigmoid_winkler</span> <span class="op">&lt;-</span> <span class="fu">misc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/misc/man/winkler_score.html" class="external-link">winkler_score</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>, </span>
<span>                                      <span class="va">results_all</span><span class="op">$</span><span class="va">Sigmoid_Lower</span>, <span class="va">results_all</span><span class="op">$</span><span class="va">Sigmoid_Upper</span><span class="op">)</span></span>
<span><span class="va">tanh_winkler</span> <span class="op">&lt;-</span> <span class="fu">misc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/misc/man/winkler_score.html" class="external-link">winkler_score</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>, </span>
<span>                                   <span class="va">results_all</span><span class="op">$</span><span class="va">Tanh_Lower</span>, <span class="va">results_all</span><span class="op">$</span><span class="va">Tanh_Upper</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"\nPrediction interval metrics:"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "\nPrediction interval metrics:"</span></span></code></pre>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Linear Model: %.1f%% coverage, %.3f Winkler score"</span>, </span>
<span>              <span class="fl">100</span> <span class="op">*</span> <span class="va">lm_coverage</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">lm_winkler</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Linear Model: 94.1% coverage, 26.946 Winkler score"</span></span></code></pre>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"ReLU Model: %.1f%% coverage, %.3f Winkler score"</span>, </span>
<span>              <span class="fl">100</span> <span class="op">*</span> <span class="va">relu_coverage</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">relu_winkler</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "ReLU Model: 95.1% coverage, 25.419 Winkler score"</span></span></code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Sigmoid Model: %.1f%% coverage, %.3f Winkler score"</span>, </span>
<span>              <span class="fl">100</span> <span class="op">*</span> <span class="va">sigmoid_coverage</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sigmoid_winkler</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Sigmoid Model: 93.1% coverage, 31.566 Winkler score"</span></span></code></pre>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Tanh Model: %.1f%% coverage, %.3f Winkler score"</span>, </span>
<span>              <span class="fl">100</span> <span class="op">*</span> <span class="va">tanh_coverage</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tanh_winkler</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Tanh Model: 93.1% coverage, 30.259 Winkler score"</span></span></code></pre>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Linear Model Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span>, <span class="va">results_all</span><span class="op">$</span><span class="va">LM_Pred</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Linear Model"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Actual"</span>, ylab<span class="op">=</span><span class="st">"Predicted"</span>,</span>
<span>     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LM_Lower"</span>,<span class="st">"LM_Upper"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x_ordered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">LM_Lower</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">LM_Upper</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.2</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span>, <span class="va">results_all</span><span class="op">$</span><span class="va">LM_Pred</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, col<span class="op">=</span><span class="st">"red"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ReLU Model Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span>, <span class="va">results_all</span><span class="op">$</span><span class="va">ReLU_Pred</span>,</span>
<span>     main<span class="op">=</span><span class="st">"ReLU Model"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Actual"</span>, ylab<span class="op">=</span><span class="st">"Predicted"</span>,</span>
<span>     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ReLU_Lower"</span>,<span class="st">"ReLU_Upper"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">ReLU_Lower</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">ReLU_Upper</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.2</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span>, <span class="va">results_all</span><span class="op">$</span><span class="va">ReLU_Pred</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, col<span class="op">=</span><span class="st">"red"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sigmoid Model Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span>, <span class="va">results_all</span><span class="op">$</span><span class="va">Sigmoid_Pred</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Sigmoid Model"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Actual"</span>, ylab<span class="op">=</span><span class="st">"Predicted"</span>,</span>
<span>     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sigmoid_Lower"</span>,<span class="st">"Sigmoid_Upper"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Sigmoid_Lower</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Sigmoid_Upper</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.2</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span>, <span class="va">results_all</span><span class="op">$</span><span class="va">Sigmoid_Pred</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, col<span class="op">=</span><span class="st">"red"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tanh Model Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span>, <span class="va">results_all</span><span class="op">$</span><span class="va">Tanh_Pred</span>,</span>
<span>     main<span class="op">=</span><span class="st">"Tanh Model"</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Actual"</span>, ylab<span class="op">=</span><span class="st">"Predicted"</span>,</span>
<span>     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tanh_Lower"</span>,<span class="st">"Tanh_Upper"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Tanh_Lower</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Tanh_Upper</span><span class="op">[</span><span class="va">x_ordered</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.2</span><span class="op">)</span>, border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">results_all</span><span class="op">$</span><span class="va">Actual</span>, <span class="va">results_all</span><span class="op">$</span><span class="va">Tanh_Pred</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>, col<span class="op">=</span><span class="st">"red"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="rvfl_files/figure-html/unnamed-chunk-11-1.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="simulation-plots">Simulation plots<a class="anchor" aria-label="anchor" href="#simulation-plots"></a>
</h2>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adjust margins to fit plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Bottom, left, top, right margins</span></span>
<span></span>
<span><span class="co"># Linear Model simulations</span></span>
<span><span class="va">sims_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">lm_model</span>, newdata <span class="op">=</span> <span class="va">test_data</span>, nsim <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">sims_lm</span>, type <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"obs. #"</span>, ylab <span class="op">=</span> <span class="st">"Simulated Value"</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Linear Model Simulations"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ReLU Model simulations</span></span>
<span><span class="va">sims_relu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">ridge_relu</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, nsim <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">sims_relu</span>, type <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"obs. #"</span>, ylab <span class="op">=</span> <span class="st">"Simulated Value"</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"ReLU Model Simulations"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sigmoid Model simulations</span></span>
<span><span class="va">sims_sigmoid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">ridge_sigmoid</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, nsim <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">sims_sigmoid</span>, type <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"obs. #"</span>, ylab <span class="op">=</span> <span class="st">"Simulated Value"</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Sigmoid Model Simulations"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tanh Model simulations</span></span>
<span><span class="va">sims_tanh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">ridge_tanh</span>, newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, nsim <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">sims_tanh</span>, type <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.1</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"obs. #"</span>, ylab <span class="op">=</span> <span class="st">"Simulated Value"</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Tanh Model Simulations"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span><span class="op">$</span><span class="va">medv</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="rvfl_files/figure-html/unnamed-chunk-12-1.png" width="960"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by T. Moudiki.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
