<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.4.0"/>
    <title>survivalist.ensemble.genboosting API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! theme.css */:root{--pdoc-background:#212529;}.pdoc{--text:#f7f7f7;--muted:#9d9d9d;--link:#58a6ff;--link-hover:#3989ff;--code:#333;--active:#555;--accent:#343434;--accent2:#555;--nav-hover:rgba(0, 0, 0, 0.1);--name:#77C1FF;--def:#0cdd0c;--annotation:#00c037;}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#49483e}.pdoc-code{background:#272822; color:#f8f8f2}.pdoc-code .c{color:#75715e}.pdoc-code .err{color:#960050; background-color:#1e0010}.pdoc-code .esc{color:#f8f8f2}.pdoc-code .g{color:#f8f8f2}.pdoc-code .k{color:#66d9ef}.pdoc-code .l{color:#ae81ff}.pdoc-code .n{color:#f8f8f2}.pdoc-code .o{color:#f92672}.pdoc-code .x{color:#f8f8f2}.pdoc-code .p{color:#f8f8f2}.pdoc-code .ch{color:#75715e}.pdoc-code .cm{color:#75715e}.pdoc-code .cp{color:#75715e}.pdoc-code .cpf{color:#75715e}.pdoc-code .c1{color:#75715e}.pdoc-code .cs{color:#75715e}.pdoc-code .gd{color:#f92672}.pdoc-code .ge{color:#f8f8f2; font-style:italic}.pdoc-code .gr{color:#f8f8f2}.pdoc-code .gh{color:#f8f8f2}.pdoc-code .gi{color:#a6e22e}.pdoc-code .go{color:#66d9ef}.pdoc-code .gp{color:#f92672; font-weight:bold}.pdoc-code .gs{color:#f8f8f2; font-weight:bold}.pdoc-code .gu{color:#75715e}.pdoc-code .gt{color:#f8f8f2}.pdoc-code .kc{color:#66d9ef}.pdoc-code .kd{color:#66d9ef}.pdoc-code .kn{color:#f92672}.pdoc-code .kp{color:#66d9ef}.pdoc-code .kr{color:#66d9ef}.pdoc-code .kt{color:#66d9ef}.pdoc-code .ld{color:#e6db74}.pdoc-code .m{color:#ae81ff}.pdoc-code .s{color:#e6db74}.pdoc-code .na{color:#a6e22e}.pdoc-code .nb{color:#f8f8f2}.pdoc-code .nc{color:#a6e22e}.pdoc-code .no{color:#66d9ef}.pdoc-code .nd{color:#a6e22e}.pdoc-code .ni{color:#f8f8f2}.pdoc-code .ne{color:#a6e22e}.pdoc-code .nf{color:#a6e22e}.pdoc-code .nl{color:#f8f8f2}.pdoc-code .nn{color:#f8f8f2}.pdoc-code .nx{color:#a6e22e}.pdoc-code .py{color:#f8f8f2}.pdoc-code .nt{color:#f92672}.pdoc-code .nv{color:#f8f8f2}.pdoc-code .ow{color:#f92672}.pdoc-code .w{color:#f8f8f2}.pdoc-code .mb{color:#ae81ff}.pdoc-code .mf{color:#ae81ff}.pdoc-code .mh{color:#ae81ff}.pdoc-code .mi{color:#ae81ff}.pdoc-code .mo{color:#ae81ff}.pdoc-code .sa{color:#e6db74}.pdoc-code .sb{color:#e6db74}.pdoc-code .sc{color:#e6db74}.pdoc-code .dl{color:#e6db74}.pdoc-code .sd{color:#e6db74}.pdoc-code .s2{color:#e6db74}.pdoc-code .se{color:#ae81ff}.pdoc-code .sh{color:#e6db74}.pdoc-code .si{color:#e6db74}.pdoc-code .sx{color:#e6db74}.pdoc-code .sr{color:#e6db74}.pdoc-code .s1{color:#e6db74}.pdoc-code .ss{color:#e6db74}.pdoc-code .bp{color:#f8f8f2}.pdoc-code .fm{color:#a6e22e}.pdoc-code .vc{color:#f8f8f2}.pdoc-code .vg{color:#f8f8f2}.pdoc-code .vi{color:#f8f8f2}.pdoc-code .vm{color:#f8f8f2}</style>
    <style>/*! theme.css */:root{--pdoc-background:#212529;}.pdoc{--text:#f7f7f7;--muted:#9d9d9d;--link:#58a6ff;--link-hover:#3989ff;--code:#333;--active:#555;--accent:#343434;--accent2:#555;--nav-hover:rgba(0, 0, 0, 0.1);--name:#77C1FF;--def:#0cdd0c;--annotation:#00c037;}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#49483e}.pdoc-code{background:#272822; color:#f8f8f2}.pdoc-code .c{color:#75715e}.pdoc-code .err{color:#960050; background-color:#1e0010}.pdoc-code .esc{color:#f8f8f2}.pdoc-code .g{color:#f8f8f2}.pdoc-code .k{color:#66d9ef}.pdoc-code .l{color:#ae81ff}.pdoc-code .n{color:#f8f8f2}.pdoc-code .o{color:#f92672}.pdoc-code .x{color:#f8f8f2}.pdoc-code .p{color:#f8f8f2}.pdoc-code .ch{color:#75715e}.pdoc-code .cm{color:#75715e}.pdoc-code .cp{color:#75715e}.pdoc-code .cpf{color:#75715e}.pdoc-code .c1{color:#75715e}.pdoc-code .cs{color:#75715e}.pdoc-code .gd{color:#f92672}.pdoc-code .ge{color:#f8f8f2; font-style:italic}.pdoc-code .gr{color:#f8f8f2}.pdoc-code .gh{color:#f8f8f2}.pdoc-code .gi{color:#a6e22e}.pdoc-code .go{color:#66d9ef}.pdoc-code .gp{color:#f92672; font-weight:bold}.pdoc-code .gs{color:#f8f8f2; font-weight:bold}.pdoc-code .gu{color:#75715e}.pdoc-code .gt{color:#f8f8f2}.pdoc-code .kc{color:#66d9ef}.pdoc-code .kd{color:#66d9ef}.pdoc-code .kn{color:#f92672}.pdoc-code .kp{color:#66d9ef}.pdoc-code .kr{color:#66d9ef}.pdoc-code .kt{color:#66d9ef}.pdoc-code .ld{color:#e6db74}.pdoc-code .m{color:#ae81ff}.pdoc-code .s{color:#e6db74}.pdoc-code .na{color:#a6e22e}.pdoc-code .nb{color:#f8f8f2}.pdoc-code .nc{color:#a6e22e}.pdoc-code .no{color:#66d9ef}.pdoc-code .nd{color:#a6e22e}.pdoc-code .ni{color:#f8f8f2}.pdoc-code .ne{color:#a6e22e}.pdoc-code .nf{color:#a6e22e}.pdoc-code .nl{color:#f8f8f2}.pdoc-code .nn{color:#f8f8f2}.pdoc-code .nx{color:#a6e22e}.pdoc-code .py{color:#f8f8f2}.pdoc-code .nt{color:#f92672}.pdoc-code .nv{color:#f8f8f2}.pdoc-code .ow{color:#f92672}.pdoc-code .w{color:#f8f8f2}.pdoc-code .mb{color:#ae81ff}.pdoc-code .mf{color:#ae81ff}.pdoc-code .mh{color:#ae81ff}.pdoc-code .mi{color:#ae81ff}.pdoc-code .mo{color:#ae81ff}.pdoc-code .sa{color:#e6db74}.pdoc-code .sb{color:#e6db74}.pdoc-code .sc{color:#e6db74}.pdoc-code .dl{color:#e6db74}.pdoc-code .sd{color:#e6db74}.pdoc-code .s2{color:#e6db74}.pdoc-code .se{color:#ae81ff}.pdoc-code .sh{color:#e6db74}.pdoc-code .si{color:#e6db74}.pdoc-code .sx{color:#e6db74}.pdoc-code .sr{color:#e6db74}.pdoc-code .s1{color:#e6db74}.pdoc-code .ss{color:#e6db74}.pdoc-code .bp{color:#f8f8f2}.pdoc-code .fm{color:#a6e22e}.pdoc-code .vc{color:#f8f8f2}.pdoc-code .vg{color:#f8f8f2}.pdoc-code .vi{color:#f8f8f2}.pdoc-code .vm{color:#f8f8f2}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../ensemble.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;survivalist.ensemble</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>            
                <ul class="memberlist">
            <li>
                    <a class="class" href="#ComponentwiseGenGradientBoostingSurvivalAnalysis">ComponentwiseGenGradientBoostingSurvivalAnalysis</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../survivalist.html">survivalist</a><wbr>.<a href="./../ensemble.html">ensemble</a><wbr>.genboosting    </h1>

                
                        <input id="mod-genboosting-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-genboosting-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="kn">import</span> <span class="nn">numbers</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">BaseEstimator</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">from</span> <span class="nn">sklearn.ensemble._base</span> <span class="kn">import</span> <span class="n">BaseEnsemble</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">from</span> <span class="nn">sklearn.ensemble._gb</span> <span class="kn">import</span> <span class="n">VerboseReporter</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">from</span> <span class="nn">sklearn.ensemble._gradient_boosting</span> <span class="kn">import</span> <span class="n">_random_sample_mask</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span> <span class="nn">sklearn.utils</span> <span class="kn">import</span> <span class="n">check_random_state</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">from</span> <span class="nn">sklearn.utils._param_validation</span> <span class="kn">import</span> <span class="n">Interval</span><span class="p">,</span> <span class="n">StrOptions</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">from</span> <span class="nn">sklearn.utils.extmath</span> <span class="kn">import</span> <span class="n">squared_norm</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">from</span> <span class="nn">sklearn.utils.validation</span> <span class="kn">import</span> <span class="n">_check_sample_weight</span><span class="p">,</span> <span class="n">check_is_fitted</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">from</span> <span class="nn">..base</span> <span class="kn">import</span> <span class="n">SurvivalAnalysisMixin</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">from</span> <span class="nn">..linear_model.coxph</span> <span class="kn">import</span> <span class="n">BreslowEstimator</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">from</span> <span class="nn">..util</span> <span class="kn">import</span> <span class="n">check_array_survival</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">from</span> <span class="nn">.survival_loss</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>    <span class="n">LOSS_FUNCTIONS</span><span class="p">,</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>    <span class="n">CensoredSquaredLoss</span><span class="p">,</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>    <span class="n">CoxPH</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>    <span class="n">IPCWLeastSquaresError</span><span class="p">,</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="p">)</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ComponentwiseGenGradientBoostingSurvivalAnalysis&quot;</span><span class="p">]</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="k">def</span> <span class="nf">_sample_binomial_plus_one</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">random_state</span><span class="p">):</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>    <span class="n">drop_model</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>    <span class="n">n_dropped</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">drop_model</span><span class="p">)</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>    <span class="k">if</span> <span class="n">n_dropped</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>        <span class="n">drop_model</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>        <span class="n">n_dropped</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>    <span class="k">return</span> <span class="n">drop_model</span><span class="p">,</span> <span class="n">n_dropped</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="k">class</span> <span class="nc">_ComponentwiseBaseLearner</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">):</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component</span><span class="p">,</span> <span class="n">regr</span><span class="p">):</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">component</span> <span class="o">=</span> <span class="n">component</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">regr</span> <span class="o">=</span> <span class="n">regr</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>            <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">)</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>        <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">regr</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">component</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="k">def</span> <span class="nf">_fit_stage_componentwise</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">regr</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">):</span>  <span class="c1"># pylint: disable=unused-argument</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Fit component-wise weighted least squares model&quot;&quot;&quot;</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>    <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>    <span class="n">base_learners</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>    <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>    <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">):</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>        <span class="n">learner</span> <span class="o">=</span> <span class="n">_ComponentwiseBaseLearner</span><span class="p">(</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>            <span class="n">component</span><span class="p">,</span> <span class="n">regr</span><span class="o">=</span><span class="n">regr</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">residuals</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">)</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>        <span class="n">l_pred</span> <span class="o">=</span> <span class="n">learner</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>        <span class="n">error</span><span class="p">[</span><span class="n">component</span><span class="p">]</span> <span class="o">=</span> <span class="n">squared_norm</span><span class="p">(</span><span class="n">residuals</span> <span class="o">-</span> <span class="n">l_pred</span><span class="p">)</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>        <span class="n">base_learners</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">learner</span><span class="p">)</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>    <span class="c1"># TODO: could use bottleneck.nanargmin for speed</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>    <span class="k">return</span> <span class="n">base_learners</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanargmin</span><span class="p">(</span><span class="n">error</span><span class="p">)]</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="k">class</span> <span class="nc">ComponentwiseGenGradientBoostingSurvivalAnalysis</span><span class="p">(</span><span class="n">BaseEnsemble</span><span class="p">,</span> <span class="n">SurvivalAnalysisMixin</span><span class="p">):</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generic Gradient boosting with any base learner.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">    Parameters</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">    ----------</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">    loss : {&#39;coxph&#39;, &#39;squared&#39;, &#39;ipcwls&#39;}, optional, default: &#39;coxph&#39;</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">        loss function to be optimized. &#39;coxph&#39; refers to partial likelihood loss</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">        of Cox&#39;s proportional hazards model. The loss &#39;squared&#39; minimizes a</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">        squared regression loss that ignores predictions beyond the time of censoring,</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">        and &#39;ipcwls&#39; refers to inverse-probability of censoring weighted least squares error.</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">    learning_rate : float, optional, default: 0.1</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">        learning rate shrinks the contribution of each base learner by `learning_rate`.</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">        There is a trade-off between `learning_rate` and `n_estimators`.</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">        Values must be in the range `[0.0, inf)`.</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">    n_estimators : int, default: 100</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">        The number of boosting stages to perform. Gradient boosting</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">        is fairly robust to over-fitting so a large number usually</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">        results in better performance.</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        Values must be in the range `[1, inf)`.</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">    subsample : float, optional, default: 1.0</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">        The fraction of samples to be used for fitting the individual base</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">        learners. If smaller than 1.0 this results in Stochastic Gradient</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">        Boosting. `subsample` interacts with the parameter `n_estimators`.</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">        Choosing `subsample &lt; 1.0` leads to a reduction of variance</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">        and an increase in bias.</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">        Values must be in the range `(0.0, 1.0]`.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">    warm_start : bool, default: False</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">        When set to ``True``, reuse the solution of the previous call to fit</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="sd">        and add more estimators to the ensemble, otherwise, just erase the</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">        previous solution.</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">    dropout_rate : float, optional, default: 0.0</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="sd">        If larger than zero, the residuals at each iteration are only computed</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">        from a random subset of base learners. The value corresponds to the</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">        percentage of base learners that are dropped. In each iteration,</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">        at least one base learner is dropped. This is an alternative regularization</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">        to shrinkage, i.e., setting `learning_rate &lt; 1.0`.</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">        Values must be in the range `[0.0, 1.0)`.</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="sd">    random_state : int seed, RandomState instance, or None, default: None</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">        The seed of the pseudo random number generator to use when</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">        shuffling the data.</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">    verbose : int, default: 0</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">        Enable verbose output. If 1 then it prints progress and performance</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="sd">        once in a while.</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="sd">        Values must be in the range `[0, inf)`.</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">    show_progress : bool, default: True</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">        If set, show a progress bar for the fitting process.</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">    Attributes</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="sd">    ----------</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">    estimators_ : list of base learners</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">        The collection of fitted sub-estimators.</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a><span class="sd">    train_score_ : ndarray, shape = (n_estimators,)</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">        The i-th score ``train_score_[i]`` is the loss of the</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">        model at iteration ``i`` on the in-bag sample.</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">        If ``subsample == 1`` this is the loss on the training data.</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="sd">    oob_improvement_ : ndarray, shape = (n_estimators,)</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="sd">        The improvement in loss on the out-of-bag samples</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="sd">        relative to the previous iteration.</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">        ``oob_improvement_[0]`` is the improvement in</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">        loss of the first stage over the ``init`` estimator.</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">        Only available if ``subsample &lt; 1.0``.</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="sd">    oob_scores_ : ndarray of shape (n_estimators,)</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="sd">        The full history of the loss values on the out-of-bag</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="sd">        samples. Only available if ``subsample &lt; 1.0``.</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">    oob_score_ : float</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a><span class="sd">        The last value of the loss on the out-of-bag samples. It is</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="sd">        the same as ``oob_scores_[-1]``. Only available if ``subsample &lt; 1.0``.</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">    n_features_in_ : int</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">        Number of features seen during ``fit``.</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">    feature_names_in_ : ndarray of shape (`n_features_in_`,)</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">        Names of features seen during ``fit``. Defined only when `X`</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">        has feature names that are all strings.</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">    unique_times_ : array of shape = (n_unique_times,)</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">        Unique time points.</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">    References</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="sd">    ----------</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="sd">    .. [1] Hothorn, T., Bhlmann, P., Dudoit, S., Molinaro, A., van der Laan, M. J.,</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="sd">           &quot;Survival ensembles&quot;, Biostatistics, 7(3), 355-73, 2006</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>    <span class="n">_parameter_constraints</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>        <span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">StrOptions</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">LOSS_FUNCTIONS</span><span class="o">.</span><span class="n">keys</span><span class="p">()))],</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>        <span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Interval</span><span class="p">(</span><span class="n">numbers</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)],</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>        <span class="s2">&quot;n_estimators&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Interval</span><span class="p">(</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)],</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>        <span class="s2">&quot;subsample&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Interval</span><span class="p">(</span><span class="n">numbers</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)],</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>        <span class="s2">&quot;warm_start&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;boolean&quot;</span><span class="p">],</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="s2">&quot;dropout_rate&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Interval</span><span class="p">(</span><span class="n">numbers</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)],</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>        <span class="s2">&quot;random_state&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;random_state&quot;</span><span class="p">],</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>        <span class="s2">&quot;verbose&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;verbose&quot;</span><span class="p">],</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>    <span class="p">}</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="n">regr</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>        <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;coxph&quot;</span><span class="p">,</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>        <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>        <span class="n">subsample</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>        <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>        <span class="n">dropout_rate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>        <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>    <span class="p">):</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">regr</span> <span class="o">=</span> <span class="n">regr</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loss</span> <span class="o">=</span> <span class="n">loss</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="n">n_estimators</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">learning_rate</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subsample</span> <span class="o">=</span> <span class="n">subsample</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">warm_start</span> <span class="o">=</span> <span class="n">warm_start</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">=</span> <span class="n">dropout_rate</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span> <span class="o">=</span> <span class="n">show_progress</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quantiles_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>    <span class="nd">@property</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>    <span class="k">def</span> <span class="nf">_predict_risk_score</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="p">,</span> <span class="n">CoxPH</span><span class="p">)</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>    <span class="k">def</span> <span class="nf">_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;estimators_&quot;</span><span class="p">,</span> <span class="p">[]))</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>    <span class="k">def</span> <span class="nf">_init_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_score_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>        <span class="c1"># do oob?</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsample</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">oob_improvement_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">oob_score_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>    <span class="k">def</span> <span class="nf">_resize_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add additional ``n_estimators`` entries to all attributes.&quot;&quot;&quot;</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>        <span class="c1"># self.n_estimators is the number of additional est to fit</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>        <span class="n">total_n_estimators</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="p">,</span> <span class="n">total_n_estimators</span><span class="p">)</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_score_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_score_</span><span class="p">,</span> <span class="n">total_n_estimators</span><span class="p">)</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsample</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;oob_improvement_&quot;</span><span class="p">):</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>            <span class="c1"># if do oob resize arrays or create new if not available</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;oob_improvement_&quot;</span><span class="p">):</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_improvement_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">oob_improvement_</span><span class="p">,</span> <span class="n">total_n_estimators</span><span class="p">)</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span><span class="p">,</span> <span class="n">total_n_estimators</span><span class="p">)</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_score_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_improvement_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>                    <span class="n">total_n_estimators</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>                    <span class="p">(</span><span class="n">total_n_estimators</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_score_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_scale&quot;</span><span class="p">):</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>                    <span class="s2">&quot;fitting with warm_start=True and dropout_rate &gt; 0 is only &quot;</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>                    <span class="s2">&quot;supported if the previous fit used dropout_rate &gt; 0 too&quot;</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>                <span class="p">)</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scale</span><span class="p">,</span> <span class="n">total_n_estimators</span><span class="p">)</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators_</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>    <span class="k">def</span> <span class="nf">_clear_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the state of the gradient boosting model.&quot;&quot;&quot;</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;estimators_&quot;</span><span class="p">):</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;train_score_&quot;</span><span class="p">):</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_score_</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;oob_improvement_&quot;</span><span class="p">):</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">oob_improvement_</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;oob_scores_&quot;</span><span class="p">):</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;oob_score_&quot;</span><span class="p">):</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">oob_score_</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_rng&quot;</span><span class="p">):</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_scale&quot;</span><span class="p">):</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>    <span class="k">def</span> <span class="nf">_update_with_dropout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">raw_predictions</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">random_state</span><span class="p">):</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>        <span class="c1"># select base learners to be dropped for next iteration</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>        <span class="n">drop_model</span><span class="p">,</span> <span class="n">n_dropped</span> <span class="o">=</span> <span class="n">_sample_binomial_plus_one</span><span class="p">(</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>        <span class="c1"># adjust scaling factor of tree that is going to be trained in next iteration</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>        <span class="n">scale</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_dropped</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="n">raw_predictions</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>            <span class="k">if</span> <span class="n">drop_model</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>                <span class="c1"># adjust scaling factor of dropped trees</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>                <span class="n">scale</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*=</span> <span class="n">n_dropped</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_dropped</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>                <span class="c1"># pseudoresponse of next iteration (without contribution of dropped trees)</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>                <span class="n">raw_predictions</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> \
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>                    <span class="n">scale</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>    <span class="k">def</span> <span class="nf">_fit</span><span class="p">(</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>        <span class="n">X</span><span class="p">,</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>        <span class="n">event</span><span class="p">,</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>        <span class="n">time</span><span class="p">,</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>        <span class="n">y_pred</span><span class="p">,</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>        <span class="n">sample_weight</span><span class="p">,</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>        <span class="n">random_state</span><span class="p">,</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>        <span class="n">begin_at_stage</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>    <span class="p">):</span>  <span class="c1"># noqa: C901</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>        <span class="n">n_samples</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>        <span class="c1"># account for intercept</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">time</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>                        <span class="p">(</span><span class="s2">&quot;event&quot;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)])</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>        <span class="n">do_oob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsample</span> <span class="o">&lt;</span> <span class="mf">1.0</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>        <span class="k">if</span> <span class="n">do_oob</span><span class="p">:</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>            <span class="n">n_inbag</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subsample</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">))</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="n">do_dropout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>        <span class="k">if</span> <span class="n">do_dropout</span><span class="p">:</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>            <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>            <span class="n">verbose_reporter</span> <span class="o">=</span> <span class="n">VerboseReporter</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>            <span class="n">verbose_reporter</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>        <span class="c1"># perform boosting iterations</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>        <span class="n">i</span> <span class="o">=</span> <span class="n">begin_at_stage</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">:</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>            <span class="n">iterator</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">begin_at_stage</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)))</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>            <span class="n">iterator</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">begin_at_stage</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">))</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>            <span class="c1"># subsampling</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>            <span class="k">if</span> <span class="n">do_oob</span><span class="p">:</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>                <span class="n">sample_mask</span> <span class="o">=</span> <span class="n">_random_sample_mask</span><span class="p">(</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>                    <span class="n">n_samples</span><span class="p">,</span> <span class="n">n_inbag</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>                <span class="n">subsample_weight</span> <span class="o">=</span> <span class="n">sample_weight</span> <span class="o">*</span> \
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>                    <span class="n">sample_mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>                <span class="c1"># OOB score before adding this stage</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>                <span class="n">y_oob_masked</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">sample_mask</span><span class="p">]</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>                <span class="n">sample_weight_oob_masked</span> <span class="o">=</span> <span class="n">sample_weight</span><span class="p">[</span><span class="o">~</span><span class="n">sample_mask</span><span class="p">]</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># store the initial loss to compute the OOB score</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>                    <span class="n">initial_loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="p">(</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>                        <span class="n">y_true</span><span class="o">=</span><span class="n">y_oob_masked</span><span class="p">,</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>                        <span class="n">raw_prediction</span><span class="o">=</span><span class="n">y_pred</span><span class="p">[</span><span class="o">~</span><span class="n">sample_mask</span><span class="p">],</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>                        <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight_oob_masked</span><span class="p">,</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>                    <span class="p">)</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>                <span class="n">subsample_weight</span> <span class="o">=</span> <span class="n">sample_weight</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>                <span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">)</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>            <span class="n">best_learner</span> <span class="o">=</span> <span class="n">_fit_stage_componentwise</span><span class="p">(</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>                <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">residuals</span><span class="o">=</span><span class="n">residuals</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">subsample_weight</span><span class="p">,</span> <span class="n">regr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">regr</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>            <span class="p">)</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_learner</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>            <span class="k">if</span> <span class="n">do_dropout</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_update_with_dropout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>                <span class="n">y_pred</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">best_learner</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>            <span class="c1"># track loss</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>            <span class="k">if</span> <span class="n">do_oob</span><span class="p">:</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">train_score_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="p">(</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>                    <span class="n">y_true</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">sample_mask</span><span class="p">],</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>                    <span class="n">raw_prediction</span><span class="o">=</span><span class="n">y_pred</span><span class="p">[</span><span class="n">sample_mask</span><span class="p">],</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>                    <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">[</span><span class="n">sample_mask</span><span class="p">],</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>                <span class="p">)</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="p">(</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>                    <span class="n">y_true</span><span class="o">=</span><span class="n">y_oob_masked</span><span class="p">,</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>                    <span class="n">raw_prediction</span><span class="o">=</span><span class="n">y_pred</span><span class="p">[</span><span class="o">~</span><span class="n">sample_mask</span><span class="p">],</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>                    <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight_oob_masked</span><span class="p">,</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>                <span class="p">)</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>                <span class="n">previous_loss</span> <span class="o">=</span> <span class="n">initial_loss</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span><span class="p">[</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>                    <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_improvement_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">previous_loss</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_score_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>                <span class="c1"># no need to fancy index w/ no subsampling</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">train_score_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="p">(</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>                    <span class="n">y_true</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">raw_prediction</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">)</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>                <span class="n">verbose_reporter</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>        <span class="k">return</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit estimator.</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="sd">        Parameters</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a><span class="sd">        ----------</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a><span class="sd">        X : array-like, shape = (n_samples, n_features)</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a><span class="sd">            Data matrix</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a><span class="sd">        y : structured array, shape = (n_samples,)</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a><span class="sd">            A structured array containing the binary event indicator</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a><span class="sd">            as first field, and time of event or time of censoring as</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a><span class="sd">            second field.</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a><span class="sd">        sample_weight : array-like, shape = (n_samples,), optional</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="sd">            Weights given to each sample. If omitted, all samples have weight 1.</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a><span class="sd">        Returns</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a><span class="sd">        -------</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a><span class="sd">        self</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_params</span><span class="p">()</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">warm_start</span><span class="p">:</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_clear_state</span><span class="p">()</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">ensure_min_samples</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>        <span class="n">event</span><span class="p">,</span> <span class="n">time</span> <span class="o">=</span> <span class="n">check_array_survival</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>        <span class="n">sample_weight</span> <span class="o">=</span> <span class="n">_check_sample_weight</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>        <span class="n">n_samples</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>        <span class="n">Xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_samples</span><span class="p">),</span> <span class="n">X</span><span class="p">))</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span> <span class="o">=</span> <span class="n">LOSS_FUNCTIONS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">loss</span><span class="p">]()</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="p">,</span> <span class="p">(</span><span class="n">CensoredSquaredLoss</span><span class="p">,</span> <span class="n">IPCWLeastSquaresError</span><span class="p">)):</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>            <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_fitted</span><span class="p">():</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_init_state</span><span class="p">()</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>            <span class="n">begin_at_stage</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>            <span class="c1"># add more estimators to fitted model</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>            <span class="c1"># invariant: warm_start = True</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>                    <span class="s2">&quot;n_estimators=</span><span class="si">%d</span><span class="s2"> must be larger or equal to &quot;</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>                    <span class="s2">&quot;estimators_.shape[0]=</span><span class="si">%d</span><span class="s2"> when &quot;</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>                    <span class="s2">&quot;warm_start==True&quot;</span> <span class="o">%</span> <span class="p">(</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>                <span class="p">)</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>            <span class="n">begin_at_stage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raw_predict</span><span class="p">(</span><span class="n">Xi</span><span class="p">)</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_resize_state</span><span class="p">()</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>            <span class="c1"># apply dropout to last stage of previous fit</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_scale&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>                <span class="c1"># pylint: disable-next=access-member-before-definition</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_update_with_dropout</span><span class="p">(</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators_</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Xi</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span><span class="p">)</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit</span><span class="p">(</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>            <span class="n">Xi</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span><span class="p">,</span> <span class="n">begin_at_stage</span><span class="p">)</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_baseline_model</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regr</span><span class="o">.</span><span class="n">X_</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>            <span class="k">pass</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>    <span class="k">def</span> <span class="nf">set_baseline_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="p">,</span> <span class="n">CoxPH</span><span class="p">):</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>            <span class="n">risk_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">baseline_model</span> <span class="o">=</span> <span class="n">BreslowEstimator</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">risk_scores</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">baseline_model</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>    <span class="k">def</span> <span class="nf">_raw_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;return_pi&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>            <span class="n">pred</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>                <span class="c1"># 4 is mean, std, lower, upper</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>                <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>                <span class="s2">&quot;lower&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>                <span class="s2">&quot;upper&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>            <span class="p">}</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>            <span class="k">for</span> <span class="n">estimator</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="p">:</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>                <span class="n">preds</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>                <span class="k">if</span> <span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>                    <span class="n">pred</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">preds</span><span class="o">.</span><span class="n">mean</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>                    <span class="n">pred</span><span class="p">[</span><span class="s2">&quot;lower&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">preds</span><span class="o">.</span><span class="n">upper</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>                    <span class="n">pred</span><span class="p">[</span><span class="s2">&quot;upper&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">preds</span><span class="o">.</span><span class="n">lower</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">])</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>            <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">],</span> <span class="n">pred</span><span class="p">[</span><span class="s2">&quot;lower&quot;</span><span class="p">],</span> <span class="n">pred</span><span class="p">[</span><span class="s2">&quot;upper&quot;</span><span class="p">])</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>        <span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>        <span class="k">for</span> <span class="n">estimator</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="p">:</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>            <span class="n">pred</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>        <span class="k">return</span> <span class="n">pred</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>    <span class="k">def</span> <span class="nf">_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>        <span class="c1"># account for intercept</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>        <span class="n">Xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">X</span><span class="p">))</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>        <span class="n">pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raw_predict</span><span class="p">(</span><span class="n">Xi</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="o">.</span><span class="n">_scale_raw_prediction</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;return_pi&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">])</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="o">.</span><span class="n">_scale_raw_prediction</span><span class="p">(</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>                <span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pred</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pred</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>            <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict risk scores.</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a><span class="sd">        If `loss=&#39;coxph&#39;`, predictions can be interpreted as log hazard ratio</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a><span class="sd">        corresponding to the linear predictor of a Cox proportional hazards</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a><span class="sd">        model. If `loss=&#39;squared&#39;` or `loss=&#39;ipcwls&#39;`, predictions are the</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a><span class="sd">        time to event.</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a><span class="sd">        Parameters</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a><span class="sd">        ----------</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a><span class="sd">        X : array-like, shape = (n_samples, n_features)</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a><span class="sd">            Data matrix.</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a><span class="sd">        Returns</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a><span class="sd">        -------</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a><span class="sd">        risk_score : array, shape = (n_samples,)</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a><span class="sd">            Predicted risk scores.</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;estimators_&quot;</span><span class="p">)</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>    <span class="k">def</span> <span class="nf">get_baseline_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>                <span class="s2">&quot;`fit` must be called with the loss option set to &#39;coxph&#39;.&quot;</span><span class="p">)</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_model</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>    <span class="k">def</span> <span class="nf">predict_cumulative_hazard_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">return_array</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict cumulative hazard function.</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a><span class="sd">        Only available if :meth:`fit` has been called with `loss = &quot;coxph&quot;`.</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a><span class="sd">        The cumulative hazard function for an individual</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a><span class="sd">        with feature vector :math:`x` is defined as</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a><span class="sd">        .. math::</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a><span class="sd">            H(t \\mid x) = \\exp(f(x)) H_0(t) ,</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a><span class="sd">        where :math:`f(\\cdot)` is the additive ensemble of base learners,</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a><span class="sd">        and :math:`H_0(t)` is the baseline hazard function,</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a><span class="sd">        estimated by Breslow&#39;s estimator.</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a><span class="sd">        Parameters</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a><span class="sd">        ----------</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a><span class="sd">        X : array-like, shape = (n_samples, n_features)</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a><span class="sd">            Data matrix.</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a><span class="sd">        return_array : boolean, default: False</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a><span class="sd">            If set, return an array with the cumulative hazard rate</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a><span class="sd">            for each `self.unique_times_`, otherwise an array of</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a><span class="sd">            :class:`survivalist.functions.StepFunction`.</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a><span class="sd">        Returns</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a><span class="sd">        -------</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a><span class="sd">        cum_hazard : ndarray</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a><span class="sd">            If `return_array` is set, an array with the cumulative hazard rate</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a><span class="sd">            for each `self.unique_times_`, otherwise an array of length `n_samples`</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a><span class="sd">            of :class:`survivalist.functions.StepFunction` instances will be returned.</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a><span class="sd">        Examples</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a><span class="sd">        --------</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a><span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a><span class="sd">        &gt;&gt;&gt; from survivalist.datasets import load_whas500</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a><span class="sd">        &gt;&gt;&gt; from survivalist.ensemble import ComponentwiseGradientBoostingSurvivalAnalysis</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a><span class="sd">        Load the data.</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a><span class="sd">        &gt;&gt;&gt; X, y = load_whas500()</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a><span class="sd">        &gt;&gt;&gt; X = X.astype(float)</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a><span class="sd">        Fit the model.</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a><span class="sd">        &gt;&gt;&gt; estimator = ComponentwiseGradientBoostingSurvivalAnalysis(loss=&quot;coxph&quot;).fit(X, y)</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a><span class="sd">        Estimate the cumulative hazard function for the first 10 samples.</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a><span class="sd">        &gt;&gt;&gt; chf_funcs = estimator.predict_cumulative_hazard_function(X.iloc[:10])</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a><span class="sd">        Plot the estimated cumulative hazard functions.</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a><span class="sd">        &gt;&gt;&gt; for fn in chf_funcs:</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a><span class="sd">        ...     plt.step(fn.x, fn(fn.x), where=&quot;post&quot;)</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a><span class="sd">        ...</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a><span class="sd">        &gt;&gt;&gt; plt.ylim(0, 1)</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a><span class="sd">        &gt;&gt;&gt; plt.show()</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantiles_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>            <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">])</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_predict_cumulative_hazard_function</span><span class="p">(</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">(),</span> <span class="n">preds</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">return_array</span><span class="p">),</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_predict_cumulative_hazard_function</span><span class="p">(</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">(),</span> <span class="n">preds</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">return_array</span><span class="p">),</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_predict_cumulative_hazard_function</span><span class="p">(</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">(),</span> <span class="n">preds</span><span class="o">.</span><span class="n">upper</span><span class="p">,</span> <span class="n">return_array</span><span class="p">),</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a>            <span class="p">)</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a>            <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_cumulative_hazard_function</span><span class="p">(</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">return_array</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a>        <span class="p">)</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>    <span class="k">def</span> <span class="nf">predict_survival_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">return_array</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict survival function.</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a><span class="sd">        Only available if :meth:`fit` has been called with `loss = &quot;coxph&quot;`.</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a><span class="sd">        The survival function for an individual</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a><span class="sd">        with feature vector :math:`x` is defined as</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a><span class="sd">        .. math::</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a><span class="sd">            S(t \\mid x) = S_0(t)^{\\exp(f(x)} ,</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a><span class="sd">        where :math:`f(\\cdot)` is the additive ensemble of base learners,</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a><span class="sd">        and :math:`S_0(t)` is the baseline survival function,</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a><span class="sd">        estimated by Breslow&#39;s estimator.</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a><span class="sd">        Parameters</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a><span class="sd">        ----------</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a><span class="sd">        X : array-like, shape = (n_samples, n_features)</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a><span class="sd">            Data matrix.</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a><span class="sd">        return_array : boolean, default: False</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a><span class="sd">            If set, return an array with the probability</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a><span class="sd">            of survival for each `self.unique_times_`,</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a><span class="sd">            otherwise an array of :class:`survivalist.functions.StepFunction`.</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a><span class="sd">        Returns</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a><span class="sd">        -------</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a><span class="sd">        survival : ndarray</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a><span class="sd">            If `return_array` is set, an array with the probability of</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a><span class="sd">            survival for each `self.unique_times_`, otherwise an array of</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a><span class="sd">            length `n_samples` of :class:`survivalist.functions.StepFunction`</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a><span class="sd">            instances will be returned.</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a><span class="sd">        Examples</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a><span class="sd">        --------</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a><span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a><span class="sd">        &gt;&gt;&gt; from survivalist.datasets import load_whas500</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a><span class="sd">        &gt;&gt;&gt; from survivalist.ensemble import ComponentwiseGradientBoostingSurvivalAnalysis</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a><span class="sd">        Load the data.</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a><span class="sd">        &gt;&gt;&gt; X, y = load_whas500()</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a><span class="sd">        &gt;&gt;&gt; X = X.astype(float)</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a><span class="sd">        Fit the model.</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a><span class="sd">        &gt;&gt;&gt; estimator = ComponentwiseGradientBoostingSurvivalAnalysis(loss=&quot;coxph&quot;).fit(X, y)</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a><span class="sd">        Estimate the survival function for the first 10 samples.</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a><span class="sd">        &gt;&gt;&gt; surv_funcs = estimator.predict_survival_function(X.iloc[:10])</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a><span class="sd">        Plot the estimated survival functions.</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a>
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a><span class="sd">        &gt;&gt;&gt; for fn in surv_funcs:</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a><span class="sd">        ...     plt.step(fn.x, fn(fn.x), where=&quot;post&quot;)</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a><span class="sd">        ...</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a><span class="sd">        &gt;&gt;&gt; plt.ylim(0, 1)</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a><span class="sd">        &gt;&gt;&gt; plt.show()</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;return_pi&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a>            <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">])</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_predict_survival_function</span><span class="p">(</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">(),</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a>                    <span class="n">preds</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a>                    <span class="n">return_array</span><span class="p">,</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a>                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a>                <span class="p">),</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_predict_survival_function</span><span class="p">(</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">(),</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a>                    <span class="n">preds</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a>                    <span class="n">return_array</span><span class="p">,</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a>                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a>                <span class="p">),</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_predict_survival_function</span><span class="p">(</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">(),</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a>                    <span class="n">preds</span><span class="o">.</span><span class="n">upper</span><span class="p">,</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a>                    <span class="n">return_array</span><span class="p">,</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a>                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a>                <span class="p">),</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a>            <span class="p">)</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a>            <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_survival_function</span><span class="p">(</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">(),</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a>            <span class="n">return_array</span><span class="p">,</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a>        <span class="p">)</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a>
</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a>    <span class="nd">@property</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a>    <span class="k">def</span> <span class="nf">unique_times_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">()</span><span class="o">.</span><span class="n">unique_times_</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a>
</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a>    <span class="nd">@property</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a>    <span class="k">def</span> <span class="nf">feature_importances_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a>        <span class="n">imp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_features_in_</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">imp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a>            <span class="n">imp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a>
</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">estimator</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="p">):</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a>            <span class="n">imp</span><span class="p">[</span><span class="n">estimator</span><span class="o">.</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a>
</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a>        <span class="k">def</span> <span class="nf">_importance</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a>                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a>
</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">_importance</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">imp</span><span class="p">])</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos">724</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a>
</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a>    <span class="k">def</span> <span class="nf">_make_estimator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a>        <span class="c1"># we don&#39;t need _make_estimator</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></pre></div>


            </section>
                <section id="ComponentwiseGenGradientBoostingSurvivalAnalysis">
                            <input id="ComponentwiseGenGradientBoostingSurvivalAnalysis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ComponentwiseGenGradientBoostingSurvivalAnalysis</span><wbr>(<span class="base">sklearn.ensemble._base.BaseEnsemble</span>, <span class="base"><a href="../base.html#SurvivalAnalysisMixin">survivalist.base.SurvivalAnalysisMixin</a></span>):

                <label class="view-source-button" for="ComponentwiseGenGradientBoostingSurvivalAnalysis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ComponentwiseGenGradientBoostingSurvivalAnalysis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-78"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-78"><span class="linenos"> 78</span></a><span class="k">class</span> <span class="nc">ComponentwiseGenGradientBoostingSurvivalAnalysis</span><span class="p">(</span><span class="n">BaseEnsemble</span><span class="p">,</span> <span class="n">SurvivalAnalysisMixin</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-79"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-79"><span class="linenos"> 79</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generic Gradient boosting with any base learner.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-80"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-80"><span class="linenos"> 80</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-81"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-81"><span class="linenos"> 81</span></a><span class="sd">    Parameters</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-82"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-82"><span class="linenos"> 82</span></a><span class="sd">    ----------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-83"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-83"><span class="linenos"> 83</span></a><span class="sd">    loss : {&#39;coxph&#39;, &#39;squared&#39;, &#39;ipcwls&#39;}, optional, default: &#39;coxph&#39;</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-84"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-84"><span class="linenos"> 84</span></a><span class="sd">        loss function to be optimized. &#39;coxph&#39; refers to partial likelihood loss</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-85"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-85"><span class="linenos"> 85</span></a><span class="sd">        of Cox&#39;s proportional hazards model. The loss &#39;squared&#39; minimizes a</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-86"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-86"><span class="linenos"> 86</span></a><span class="sd">        squared regression loss that ignores predictions beyond the time of censoring,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-87"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-87"><span class="linenos"> 87</span></a><span class="sd">        and &#39;ipcwls&#39; refers to inverse-probability of censoring weighted least squares error.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-88"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-88"><span class="linenos"> 88</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-89"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-89"><span class="linenos"> 89</span></a><span class="sd">    learning_rate : float, optional, default: 0.1</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-90"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-90"><span class="linenos"> 90</span></a><span class="sd">        learning rate shrinks the contribution of each base learner by `learning_rate`.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-91"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-91"><span class="linenos"> 91</span></a><span class="sd">        There is a trade-off between `learning_rate` and `n_estimators`.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-92"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-92"><span class="linenos"> 92</span></a><span class="sd">        Values must be in the range `[0.0, inf)`.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-93"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-93"><span class="linenos"> 93</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-94"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-94"><span class="linenos"> 94</span></a><span class="sd">    n_estimators : int, default: 100</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-95"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-95"><span class="linenos"> 95</span></a><span class="sd">        The number of boosting stages to perform. Gradient boosting</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-96"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-96"><span class="linenos"> 96</span></a><span class="sd">        is fairly robust to over-fitting so a large number usually</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-97"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-97"><span class="linenos"> 97</span></a><span class="sd">        results in better performance.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-98"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-98"><span class="linenos"> 98</span></a><span class="sd">        Values must be in the range `[1, inf)`.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-99"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-99"><span class="linenos"> 99</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-100"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-100"><span class="linenos">100</span></a><span class="sd">    subsample : float, optional, default: 1.0</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-101"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-101"><span class="linenos">101</span></a><span class="sd">        The fraction of samples to be used for fitting the individual base</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-102"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-102"><span class="linenos">102</span></a><span class="sd">        learners. If smaller than 1.0 this results in Stochastic Gradient</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-103"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-103"><span class="linenos">103</span></a><span class="sd">        Boosting. `subsample` interacts with the parameter `n_estimators`.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-104"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-104"><span class="linenos">104</span></a><span class="sd">        Choosing `subsample &lt; 1.0` leads to a reduction of variance</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-105"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-105"><span class="linenos">105</span></a><span class="sd">        and an increase in bias.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-106"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-106"><span class="linenos">106</span></a><span class="sd">        Values must be in the range `(0.0, 1.0]`.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-107"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-107"><span class="linenos">107</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-108"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-108"><span class="linenos">108</span></a><span class="sd">    warm_start : bool, default: False</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-109"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-109"><span class="linenos">109</span></a><span class="sd">        When set to ``True``, reuse the solution of the previous call to fit</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-110"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-110"><span class="linenos">110</span></a><span class="sd">        and add more estimators to the ensemble, otherwise, just erase the</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-111"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-111"><span class="linenos">111</span></a><span class="sd">        previous solution.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-112"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-112"><span class="linenos">112</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-113"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-113"><span class="linenos">113</span></a><span class="sd">    dropout_rate : float, optional, default: 0.0</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-114"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-114"><span class="linenos">114</span></a><span class="sd">        If larger than zero, the residuals at each iteration are only computed</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-115"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-115"><span class="linenos">115</span></a><span class="sd">        from a random subset of base learners. The value corresponds to the</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-116"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-116"><span class="linenos">116</span></a><span class="sd">        percentage of base learners that are dropped. In each iteration,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-117"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-117"><span class="linenos">117</span></a><span class="sd">        at least one base learner is dropped. This is an alternative regularization</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-118"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-118"><span class="linenos">118</span></a><span class="sd">        to shrinkage, i.e., setting `learning_rate &lt; 1.0`.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-119"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-119"><span class="linenos">119</span></a><span class="sd">        Values must be in the range `[0.0, 1.0)`.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-120"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-120"><span class="linenos">120</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-121"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-121"><span class="linenos">121</span></a><span class="sd">    random_state : int seed, RandomState instance, or None, default: None</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-122"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-122"><span class="linenos">122</span></a><span class="sd">        The seed of the pseudo random number generator to use when</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-123"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-123"><span class="linenos">123</span></a><span class="sd">        shuffling the data.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-124"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-124"><span class="linenos">124</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-125"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-125"><span class="linenos">125</span></a><span class="sd">    verbose : int, default: 0</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-126"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-126"><span class="linenos">126</span></a><span class="sd">        Enable verbose output. If 1 then it prints progress and performance</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-127"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-127"><span class="linenos">127</span></a><span class="sd">        once in a while.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-128"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-128"><span class="linenos">128</span></a><span class="sd">        Values must be in the range `[0, inf)`.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-129"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-129"><span class="linenos">129</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-130"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-130"><span class="linenos">130</span></a><span class="sd">    show_progress : bool, default: True</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-131"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-131"><span class="linenos">131</span></a><span class="sd">        If set, show a progress bar for the fitting process.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-132"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-132"><span class="linenos">132</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-133"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-133"><span class="linenos">133</span></a><span class="sd">    Attributes</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-134"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-134"><span class="linenos">134</span></a><span class="sd">    ----------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-135"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-135"><span class="linenos">135</span></a><span class="sd">    estimators_ : list of base learners</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-136"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-136"><span class="linenos">136</span></a><span class="sd">        The collection of fitted sub-estimators.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-137"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-137"><span class="linenos">137</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-138"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-138"><span class="linenos">138</span></a><span class="sd">    train_score_ : ndarray, shape = (n_estimators,)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-139"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-139"><span class="linenos">139</span></a><span class="sd">        The i-th score ``train_score_[i]`` is the loss of the</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-140"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-140"><span class="linenos">140</span></a><span class="sd">        model at iteration ``i`` on the in-bag sample.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-141"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-141"><span class="linenos">141</span></a><span class="sd">        If ``subsample == 1`` this is the loss on the training data.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-142"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-142"><span class="linenos">142</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-143"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-143"><span class="linenos">143</span></a><span class="sd">    oob_improvement_ : ndarray, shape = (n_estimators,)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-144"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-144"><span class="linenos">144</span></a><span class="sd">        The improvement in loss on the out-of-bag samples</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-145"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-145"><span class="linenos">145</span></a><span class="sd">        relative to the previous iteration.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-146"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-146"><span class="linenos">146</span></a><span class="sd">        ``oob_improvement_[0]`` is the improvement in</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-147"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-147"><span class="linenos">147</span></a><span class="sd">        loss of the first stage over the ``init`` estimator.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-148"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-148"><span class="linenos">148</span></a><span class="sd">        Only available if ``subsample &lt; 1.0``.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-149"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-149"><span class="linenos">149</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-150"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-150"><span class="linenos">150</span></a><span class="sd">    oob_scores_ : ndarray of shape (n_estimators,)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-151"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-151"><span class="linenos">151</span></a><span class="sd">        The full history of the loss values on the out-of-bag</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-152"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-152"><span class="linenos">152</span></a><span class="sd">        samples. Only available if ``subsample &lt; 1.0``.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-153"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-153"><span class="linenos">153</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-154"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-154"><span class="linenos">154</span></a><span class="sd">    oob_score_ : float</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-155"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-155"><span class="linenos">155</span></a><span class="sd">        The last value of the loss on the out-of-bag samples. It is</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-156"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-156"><span class="linenos">156</span></a><span class="sd">        the same as ``oob_scores_[-1]``. Only available if ``subsample &lt; 1.0``.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-157"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-157"><span class="linenos">157</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-158"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-158"><span class="linenos">158</span></a><span class="sd">    n_features_in_ : int</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-159"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-159"><span class="linenos">159</span></a><span class="sd">        Number of features seen during ``fit``.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-160"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-160"><span class="linenos">160</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-161"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-161"><span class="linenos">161</span></a><span class="sd">    feature_names_in_ : ndarray of shape (`n_features_in_`,)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-162"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-162"><span class="linenos">162</span></a><span class="sd">        Names of features seen during ``fit``. Defined only when `X`</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-163"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-163"><span class="linenos">163</span></a><span class="sd">        has feature names that are all strings.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-164"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-164"><span class="linenos">164</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-165"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-165"><span class="linenos">165</span></a><span class="sd">    unique_times_ : array of shape = (n_unique_times,)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-166"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-166"><span class="linenos">166</span></a><span class="sd">        Unique time points.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-167"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-167"><span class="linenos">167</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-168"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-168"><span class="linenos">168</span></a><span class="sd">    References</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-169"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-169"><span class="linenos">169</span></a><span class="sd">    ----------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-170"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-170"><span class="linenos">170</span></a><span class="sd">    .. [1] Hothorn, T., Bhlmann, P., Dudoit, S., Molinaro, A., van der Laan, M. J.,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-171"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-171"><span class="linenos">171</span></a><span class="sd">           &quot;Survival ensembles&quot;, Biostatistics, 7(3), 355-73, 2006</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-172"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-172"><span class="linenos">172</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-173"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-173"><span class="linenos">173</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-174"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-174"><span class="linenos">174</span></a>    <span class="n">_parameter_constraints</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-175"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-175"><span class="linenos">175</span></a>        <span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">StrOptions</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">LOSS_FUNCTIONS</span><span class="o">.</span><span class="n">keys</span><span class="p">()))],</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-176"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-176"><span class="linenos">176</span></a>        <span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Interval</span><span class="p">(</span><span class="n">numbers</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)],</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-177"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-177"><span class="linenos">177</span></a>        <span class="s2">&quot;n_estimators&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Interval</span><span class="p">(</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)],</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-178"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-178"><span class="linenos">178</span></a>        <span class="s2">&quot;subsample&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Interval</span><span class="p">(</span><span class="n">numbers</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)],</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-179"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-179"><span class="linenos">179</span></a>        <span class="s2">&quot;warm_start&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;boolean&quot;</span><span class="p">],</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-180"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-180"><span class="linenos">180</span></a>        <span class="s2">&quot;dropout_rate&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Interval</span><span class="p">(</span><span class="n">numbers</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)],</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-181"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-181"><span class="linenos">181</span></a>        <span class="s2">&quot;random_state&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;random_state&quot;</span><span class="p">],</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-182"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-182"><span class="linenos">182</span></a>        <span class="s2">&quot;verbose&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;verbose&quot;</span><span class="p">],</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-183"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-183"><span class="linenos">183</span></a>    <span class="p">}</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-184"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-184"><span class="linenos">184</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-185"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-186"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-186"><span class="linenos">186</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-187"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-187"><span class="linenos">187</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-188"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-188"><span class="linenos">188</span></a>        <span class="n">regr</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-189"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-189"><span class="linenos">189</span></a>        <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;coxph&quot;</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-190"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-190"><span class="linenos">190</span></a>        <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-191"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-191"><span class="linenos">191</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-192"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-192"><span class="linenos">192</span></a>        <span class="n">subsample</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-193"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-193"><span class="linenos">193</span></a>        <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-194"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-194"><span class="linenos">194</span></a>        <span class="n">dropout_rate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-195"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-195"><span class="linenos">195</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-196"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-196"><span class="linenos">196</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-197"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-197"><span class="linenos">197</span></a>        <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-198"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-198"><span class="linenos">198</span></a>    <span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-199"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">regr</span> <span class="o">=</span> <span class="n">regr</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-200"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loss</span> <span class="o">=</span> <span class="n">loss</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-201"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="n">n_estimators</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-202"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">learning_rate</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-203"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-203"><span class="linenos">203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subsample</span> <span class="o">=</span> <span class="n">subsample</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-204"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-204"><span class="linenos">204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">warm_start</span> <span class="o">=</span> <span class="n">warm_start</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-205"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-205"><span class="linenos">205</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">=</span> <span class="n">dropout_rate</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-206"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-206"><span class="linenos">206</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-207"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-208"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span> <span class="o">=</span> <span class="n">show_progress</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-209"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-209"><span class="linenos">209</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quantiles_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-210"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-210"><span class="linenos">210</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-211"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-211"><span class="linenos">211</span></a>    <span class="nd">@property</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-212"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-212"><span class="linenos">212</span></a>    <span class="k">def</span> <span class="nf">_predict_risk_score</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-213"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-213"><span class="linenos">213</span></a>        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="p">,</span> <span class="n">CoxPH</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-214"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-214"><span class="linenos">214</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-215"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-215"><span class="linenos">215</span></a>    <span class="k">def</span> <span class="nf">_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-216"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-216"><span class="linenos">216</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;estimators_&quot;</span><span class="p">,</span> <span class="p">[]))</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-217"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-217"><span class="linenos">217</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-218"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-218"><span class="linenos">218</span></a>    <span class="k">def</span> <span class="nf">_init_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-219"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-219"><span class="linenos">219</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-220"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-220"><span class="linenos">220</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-221"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_score_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-222"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-222"><span class="linenos">222</span></a>        <span class="c1"># do oob?</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-223"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-223"><span class="linenos">223</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsample</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-224"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-224"><span class="linenos">224</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">oob_improvement_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-225"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-225"><span class="linenos">225</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-226"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-226"><span class="linenos">226</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-227"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-227"><span class="linenos">227</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">oob_score_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-228"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-228"><span class="linenos">228</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-229"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-229"><span class="linenos">229</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-230"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-230"><span class="linenos">230</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-231"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-231"><span class="linenos">231</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-232"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-232"><span class="linenos">232</span></a>    <span class="k">def</span> <span class="nf">_resize_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-233"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-233"><span class="linenos">233</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add additional ``n_estimators`` entries to all attributes.&quot;&quot;&quot;</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-234"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-234"><span class="linenos">234</span></a>        <span class="c1"># self.n_estimators is the number of additional est to fit</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-235"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-235"><span class="linenos">235</span></a>        <span class="n">total_n_estimators</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-236"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-236"><span class="linenos">236</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-237"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="p">,</span> <span class="n">total_n_estimators</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-238"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">train_score_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_score_</span><span class="p">,</span> <span class="n">total_n_estimators</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-239"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-239"><span class="linenos">239</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsample</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;oob_improvement_&quot;</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-240"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-240"><span class="linenos">240</span></a>            <span class="c1"># if do oob resize arrays or create new if not available</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-241"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-241"><span class="linenos">241</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;oob_improvement_&quot;</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-242"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-242"><span class="linenos">242</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_improvement_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-243"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-243"><span class="linenos">243</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">oob_improvement_</span><span class="p">,</span> <span class="n">total_n_estimators</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-244"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-244"><span class="linenos">244</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-245"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-245"><span class="linenos">245</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span><span class="p">,</span> <span class="n">total_n_estimators</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-246"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-246"><span class="linenos">246</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_score_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-247"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-247"><span class="linenos">247</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-248"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-248"><span class="linenos">248</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_improvement_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-249"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-249"><span class="linenos">249</span></a>                    <span class="n">total_n_estimators</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-250"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-250"><span class="linenos">250</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-251"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-251"><span class="linenos">251</span></a>                    <span class="p">(</span><span class="n">total_n_estimators</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-252"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-252"><span class="linenos">252</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_score_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-253"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-253"><span class="linenos">253</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-254"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-254"><span class="linenos">254</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-255"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-255"><span class="linenos">255</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_scale&quot;</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-256"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-256"><span class="linenos">256</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-257"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-257"><span class="linenos">257</span></a>                    <span class="s2">&quot;fitting with warm_start=True and dropout_rate &gt; 0 is only &quot;</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-258"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-258"><span class="linenos">258</span></a>                    <span class="s2">&quot;supported if the previous fit used dropout_rate &gt; 0 too&quot;</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-259"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-259"><span class="linenos">259</span></a>                <span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-260"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-260"><span class="linenos">260</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-261"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-261"><span class="linenos">261</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scale</span><span class="p">,</span> <span class="n">total_n_estimators</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-262"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-262"><span class="linenos">262</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators_</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-263"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-263"><span class="linenos">263</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-264"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-264"><span class="linenos">264</span></a>    <span class="k">def</span> <span class="nf">_clear_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-265"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-265"><span class="linenos">265</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the state of the gradient boosting model.&quot;&quot;&quot;</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-266"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-266"><span class="linenos">266</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;estimators_&quot;</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-267"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-267"><span class="linenos">267</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-268"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-268"><span class="linenos">268</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;train_score_&quot;</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-269"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-269"><span class="linenos">269</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">train_score_</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-270"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-270"><span class="linenos">270</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;oob_improvement_&quot;</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-271"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-271"><span class="linenos">271</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">oob_improvement_</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-272"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-272"><span class="linenos">272</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;oob_scores_&quot;</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-273"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-273"><span class="linenos">273</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-274"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-274"><span class="linenos">274</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;oob_score_&quot;</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-275"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-275"><span class="linenos">275</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">oob_score_</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-276"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-276"><span class="linenos">276</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_rng&quot;</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-277"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-277"><span class="linenos">277</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-278"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-278"><span class="linenos">278</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_scale&quot;</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-279"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-279"><span class="linenos">279</span></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-280"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-280"><span class="linenos">280</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-281"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-281"><span class="linenos">281</span></a>    <span class="k">def</span> <span class="nf">_update_with_dropout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">raw_predictions</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">random_state</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-282"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-282"><span class="linenos">282</span></a>        <span class="c1"># select base learners to be dropped for next iteration</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-283"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-283"><span class="linenos">283</span></a>        <span class="n">drop_model</span><span class="p">,</span> <span class="n">n_dropped</span> <span class="o">=</span> <span class="n">_sample_binomial_plus_one</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-284"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-284"><span class="linenos">284</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-285"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-285"><span class="linenos">285</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-286"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-286"><span class="linenos">286</span></a>        <span class="c1"># adjust scaling factor of tree that is going to be trained in next iteration</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-287"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-287"><span class="linenos">287</span></a>        <span class="n">scale</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_dropped</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-288"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-288"><span class="linenos">288</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-289"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-289"><span class="linenos">289</span></a>        <span class="n">raw_predictions</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-290"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-290"><span class="linenos">290</span></a>        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-291"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-291"><span class="linenos">291</span></a>            <span class="k">if</span> <span class="n">drop_model</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-292"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-292"><span class="linenos">292</span></a>                <span class="c1"># adjust scaling factor of dropped trees</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-293"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-293"><span class="linenos">293</span></a>                <span class="n">scale</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*=</span> <span class="n">n_dropped</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_dropped</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-294"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-294"><span class="linenos">294</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-295"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-295"><span class="linenos">295</span></a>                <span class="c1"># pseudoresponse of next iteration (without contribution of dropped trees)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-296"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-296"><span class="linenos">296</span></a>                <span class="n">raw_predictions</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> \
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-297"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-297"><span class="linenos">297</span></a>                    <span class="n">scale</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-298"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-298"><span class="linenos">298</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-299"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-299"><span class="linenos">299</span></a>    <span class="k">def</span> <span class="nf">_fit</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-300"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-300"><span class="linenos">300</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-301"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-301"><span class="linenos">301</span></a>        <span class="n">X</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-302"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-302"><span class="linenos">302</span></a>        <span class="n">event</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-303"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-303"><span class="linenos">303</span></a>        <span class="n">time</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-304"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-304"><span class="linenos">304</span></a>        <span class="n">y_pred</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-305"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-305"><span class="linenos">305</span></a>        <span class="n">sample_weight</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-306"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-306"><span class="linenos">306</span></a>        <span class="n">random_state</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-307"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-307"><span class="linenos">307</span></a>        <span class="n">begin_at_stage</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-308"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-308"><span class="linenos">308</span></a>    <span class="p">):</span>  <span class="c1"># noqa: C901</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-309"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-309"><span class="linenos">309</span></a>        <span class="n">n_samples</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-310"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-310"><span class="linenos">310</span></a>        <span class="c1"># account for intercept</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-311"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-311"><span class="linenos">311</span></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">time</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-312"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-312"><span class="linenos">312</span></a>                        <span class="p">(</span><span class="s2">&quot;event&quot;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)])</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-313"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-313"><span class="linenos">313</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-314"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-314"><span class="linenos">314</span></a>        <span class="n">do_oob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsample</span> <span class="o">&lt;</span> <span class="mf">1.0</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-315"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-315"><span class="linenos">315</span></a>        <span class="k">if</span> <span class="n">do_oob</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-316"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-316"><span class="linenos">316</span></a>            <span class="n">n_inbag</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subsample</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">))</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-317"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-317"><span class="linenos">317</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-318"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-318"><span class="linenos">318</span></a>        <span class="n">do_dropout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-319"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-319"><span class="linenos">319</span></a>        <span class="k">if</span> <span class="n">do_dropout</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-320"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-320"><span class="linenos">320</span></a>            <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-321"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-321"><span class="linenos">321</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-322"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-322"><span class="linenos">322</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-323"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-323"><span class="linenos">323</span></a>            <span class="n">verbose_reporter</span> <span class="o">=</span> <span class="n">VerboseReporter</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-324"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-324"><span class="linenos">324</span></a>            <span class="n">verbose_reporter</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-325"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-325"><span class="linenos">325</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-326"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-326"><span class="linenos">326</span></a>        <span class="c1"># perform boosting iterations</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-327"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-327"><span class="linenos">327</span></a>        <span class="n">i</span> <span class="o">=</span> <span class="n">begin_at_stage</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-328"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-328"><span class="linenos">328</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-329"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-329"><span class="linenos">329</span></a>            <span class="n">iterator</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">begin_at_stage</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)))</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-330"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-330"><span class="linenos">330</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-331"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-331"><span class="linenos">331</span></a>            <span class="n">iterator</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">begin_at_stage</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">))</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-332"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-332"><span class="linenos">332</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-333"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-333"><span class="linenos">333</span></a>            <span class="c1"># subsampling</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-334"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-334"><span class="linenos">334</span></a>            <span class="k">if</span> <span class="n">do_oob</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-335"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-335"><span class="linenos">335</span></a>                <span class="n">sample_mask</span> <span class="o">=</span> <span class="n">_random_sample_mask</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-336"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-336"><span class="linenos">336</span></a>                    <span class="n">n_samples</span><span class="p">,</span> <span class="n">n_inbag</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-337"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-337"><span class="linenos">337</span></a>                <span class="n">subsample_weight</span> <span class="o">=</span> <span class="n">sample_weight</span> <span class="o">*</span> \
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-338"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-338"><span class="linenos">338</span></a>                    <span class="n">sample_mask</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-339"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-339"><span class="linenos">339</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-340"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-340"><span class="linenos">340</span></a>                <span class="c1"># OOB score before adding this stage</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-341"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-341"><span class="linenos">341</span></a>                <span class="n">y_oob_masked</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">sample_mask</span><span class="p">]</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-342"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-342"><span class="linenos">342</span></a>                <span class="n">sample_weight_oob_masked</span> <span class="o">=</span> <span class="n">sample_weight</span><span class="p">[</span><span class="o">~</span><span class="n">sample_mask</span><span class="p">]</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-343"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-343"><span class="linenos">343</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># store the initial loss to compute the OOB score</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-344"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-344"><span class="linenos">344</span></a>                    <span class="n">initial_loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-345"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-345"><span class="linenos">345</span></a>                        <span class="n">y_true</span><span class="o">=</span><span class="n">y_oob_masked</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-346"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-346"><span class="linenos">346</span></a>                        <span class="n">raw_prediction</span><span class="o">=</span><span class="n">y_pred</span><span class="p">[</span><span class="o">~</span><span class="n">sample_mask</span><span class="p">],</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-347"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-347"><span class="linenos">347</span></a>                        <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight_oob_masked</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-348"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-348"><span class="linenos">348</span></a>                    <span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-349"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-349"><span class="linenos">349</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-350"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-350"><span class="linenos">350</span></a>                <span class="n">subsample_weight</span> <span class="o">=</span> <span class="n">sample_weight</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-351"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-351"><span class="linenos">351</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-352"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-352"><span class="linenos">352</span></a>            <span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-353"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-353"><span class="linenos">353</span></a>                <span class="n">y</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-354"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-354"><span class="linenos">354</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-355"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-355"><span class="linenos">355</span></a>            <span class="n">best_learner</span> <span class="o">=</span> <span class="n">_fit_stage_componentwise</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-356"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-356"><span class="linenos">356</span></a>                <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">residuals</span><span class="o">=</span><span class="n">residuals</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">subsample_weight</span><span class="p">,</span> <span class="n">regr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">regr</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-357"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-357"><span class="linenos">357</span></a>            <span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-358"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-358"><span class="linenos">358</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_learner</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-359"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-359"><span class="linenos">359</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-360"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-360"><span class="linenos">360</span></a>            <span class="k">if</span> <span class="n">do_dropout</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-361"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-361"><span class="linenos">361</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_update_with_dropout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">random_state</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-362"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-362"><span class="linenos">362</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-363"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-363"><span class="linenos">363</span></a>                <span class="n">y_pred</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">best_learner</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-364"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-364"><span class="linenos">364</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-365"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-365"><span class="linenos">365</span></a>            <span class="c1"># track loss</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-366"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-366"><span class="linenos">366</span></a>            <span class="k">if</span> <span class="n">do_oob</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-367"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-367"><span class="linenos">367</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">train_score_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-368"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-368"><span class="linenos">368</span></a>                    <span class="n">y_true</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="n">sample_mask</span><span class="p">],</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-369"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-369"><span class="linenos">369</span></a>                    <span class="n">raw_prediction</span><span class="o">=</span><span class="n">y_pred</span><span class="p">[</span><span class="n">sample_mask</span><span class="p">],</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-370"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-370"><span class="linenos">370</span></a>                    <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">[</span><span class="n">sample_mask</span><span class="p">],</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-371"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-371"><span class="linenos">371</span></a>                <span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-372"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-372"><span class="linenos">372</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-373"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-373"><span class="linenos">373</span></a>                    <span class="n">y_true</span><span class="o">=</span><span class="n">y_oob_masked</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-374"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-374"><span class="linenos">374</span></a>                    <span class="n">raw_prediction</span><span class="o">=</span><span class="n">y_pred</span><span class="p">[</span><span class="o">~</span><span class="n">sample_mask</span><span class="p">],</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-375"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-375"><span class="linenos">375</span></a>                    <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight_oob_masked</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-376"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-376"><span class="linenos">376</span></a>                <span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-377"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-377"><span class="linenos">377</span></a>                <span class="n">previous_loss</span> <span class="o">=</span> <span class="n">initial_loss</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span><span class="p">[</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-378"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-378"><span class="linenos">378</span></a>                    <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-379"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-379"><span class="linenos">379</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_improvement_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">previous_loss</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-380"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-380"><span class="linenos">380</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">oob_score_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oob_scores_</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-381"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-381"><span class="linenos">381</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-382"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-382"><span class="linenos">382</span></a>                <span class="c1"># no need to fancy index w/ no subsampling</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-383"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-383"><span class="linenos">383</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">train_score_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-384"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-384"><span class="linenos">384</span></a>                    <span class="n">y_true</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">raw_prediction</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-385"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-385"><span class="linenos">385</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-386"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-386"><span class="linenos">386</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-387"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-387"><span class="linenos">387</span></a>                <span class="n">verbose_reporter</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-388"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-388"><span class="linenos">388</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-389"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-389"><span class="linenos">389</span></a>        <span class="k">return</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-390"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-390"><span class="linenos">390</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-391"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-391"><span class="linenos">391</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-392"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-392"><span class="linenos">392</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit estimator.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-393"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-393"><span class="linenos">393</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-394"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-394"><span class="linenos">394</span></a><span class="sd">        Parameters</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-395"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-395"><span class="linenos">395</span></a><span class="sd">        ----------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-396"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-396"><span class="linenos">396</span></a><span class="sd">        X : array-like, shape = (n_samples, n_features)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-397"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-397"><span class="linenos">397</span></a><span class="sd">            Data matrix</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-398"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-398"><span class="linenos">398</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-399"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-399"><span class="linenos">399</span></a><span class="sd">        y : structured array, shape = (n_samples,)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-400"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-400"><span class="linenos">400</span></a><span class="sd">            A structured array containing the binary event indicator</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-401"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-401"><span class="linenos">401</span></a><span class="sd">            as first field, and time of event or time of censoring as</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-402"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-402"><span class="linenos">402</span></a><span class="sd">            second field.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-403"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-403"><span class="linenos">403</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-404"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-404"><span class="linenos">404</span></a><span class="sd">        sample_weight : array-like, shape = (n_samples,), optional</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-405"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-405"><span class="linenos">405</span></a><span class="sd">            Weights given to each sample. If omitted, all samples have weight 1.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-406"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-406"><span class="linenos">406</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-407"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-407"><span class="linenos">407</span></a><span class="sd">        Returns</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-408"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-408"><span class="linenos">408</span></a><span class="sd">        -------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-409"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-409"><span class="linenos">409</span></a><span class="sd">        self</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-410"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-410"><span class="linenos">410</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-411"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-411"><span class="linenos">411</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_params</span><span class="p">()</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-412"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-412"><span class="linenos">412</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-413"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-413"><span class="linenos">413</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">warm_start</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-414"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-414"><span class="linenos">414</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_clear_state</span><span class="p">()</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-415"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-415"><span class="linenos">415</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-416"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-416"><span class="linenos">416</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">ensure_min_samples</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-417"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-417"><span class="linenos">417</span></a>        <span class="n">event</span><span class="p">,</span> <span class="n">time</span> <span class="o">=</span> <span class="n">check_array_survival</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-418"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-418"><span class="linenos">418</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-419"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-419"><span class="linenos">419</span></a>        <span class="n">sample_weight</span> <span class="o">=</span> <span class="n">_check_sample_weight</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-420"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-420"><span class="linenos">420</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-421"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-421"><span class="linenos">421</span></a>        <span class="n">n_samples</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-422"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-422"><span class="linenos">422</span></a>        <span class="n">Xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_samples</span><span class="p">),</span> <span class="n">X</span><span class="p">))</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-423"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-423"><span class="linenos">423</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-424"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-424"><span class="linenos">424</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span> <span class="o">=</span> <span class="n">LOSS_FUNCTIONS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">loss</span><span class="p">]()</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-425"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-425"><span class="linenos">425</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="p">,</span> <span class="p">(</span><span class="n">CensoredSquaredLoss</span><span class="p">,</span> <span class="n">IPCWLeastSquaresError</span><span class="p">)):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-426"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-426"><span class="linenos">426</span></a>            <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-427"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-427"><span class="linenos">427</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-428"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-428"><span class="linenos">428</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_fitted</span><span class="p">():</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-429"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-429"><span class="linenos">429</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_init_state</span><span class="p">()</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-430"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-430"><span class="linenos">430</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-431"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-431"><span class="linenos">431</span></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-432"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-432"><span class="linenos">432</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-433"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-433"><span class="linenos">433</span></a>            <span class="n">begin_at_stage</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-434"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-434"><span class="linenos">434</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-435"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-435"><span class="linenos">435</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-436"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-436"><span class="linenos">436</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-437"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-437"><span class="linenos">437</span></a>            <span class="c1"># add more estimators to fitted model</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-438"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-438"><span class="linenos">438</span></a>            <span class="c1"># invariant: warm_start = True</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-439"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-439"><span class="linenos">439</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-440"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-440"><span class="linenos">440</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-441"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-441"><span class="linenos">441</span></a>                    <span class="s2">&quot;n_estimators=</span><span class="si">%d</span><span class="s2"> must be larger or equal to &quot;</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-442"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-442"><span class="linenos">442</span></a>                    <span class="s2">&quot;estimators_.shape[0]=</span><span class="si">%d</span><span class="s2"> when &quot;</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-443"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-443"><span class="linenos">443</span></a>                    <span class="s2">&quot;warm_start==True&quot;</span> <span class="o">%</span> <span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-444"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-444"><span class="linenos">444</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-445"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-445"><span class="linenos">445</span></a>                <span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-446"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-446"><span class="linenos">446</span></a>            <span class="n">begin_at_stage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-447"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-447"><span class="linenos">447</span></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raw_predict</span><span class="p">(</span><span class="n">Xi</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-448"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-448"><span class="linenos">448</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_resize_state</span><span class="p">()</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-449"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-449"><span class="linenos">449</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-450"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-450"><span class="linenos">450</span></a>            <span class="c1"># apply dropout to last stage of previous fit</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-451"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-451"><span class="linenos">451</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_scale&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-452"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-452"><span class="linenos">452</span></a>                <span class="c1"># pylint: disable-next=access-member-before-definition</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-453"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-453"><span class="linenos">453</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_update_with_dropout</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-454"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-454"><span class="linenos">454</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators_</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Xi</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-455"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-455"><span class="linenos">455</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-456"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-456"><span class="linenos">456</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-457"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-457"><span class="linenos">457</span></a>            <span class="n">Xi</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span><span class="p">,</span> <span class="n">begin_at_stage</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-458"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-458"><span class="linenos">458</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-459"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-459"><span class="linenos">459</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_baseline_model</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-460"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-460"><span class="linenos">460</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-461"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-461"><span class="linenos">461</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regr</span><span class="o">.</span><span class="n">X_</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-462"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-462"><span class="linenos">462</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-463"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-463"><span class="linenos">463</span></a>            <span class="k">pass</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-464"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-464"><span class="linenos">464</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-465"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-465"><span class="linenos">465</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-466"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-466"><span class="linenos">466</span></a>    <span class="k">def</span> <span class="nf">set_baseline_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-467"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-467"><span class="linenos">467</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="p">,</span> <span class="n">CoxPH</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-468"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-468"><span class="linenos">468</span></a>            <span class="n">risk_scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-469"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-469"><span class="linenos">469</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">baseline_model</span> <span class="o">=</span> <span class="n">BreslowEstimator</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">risk_scores</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-470"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-470"><span class="linenos">470</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-471"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-471"><span class="linenos">471</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">baseline_model</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-472"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-472"><span class="linenos">472</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-473"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-473"><span class="linenos">473</span></a>    <span class="k">def</span> <span class="nf">_raw_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-474"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-474"><span class="linenos">474</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;return_pi&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-475"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-475"><span class="linenos">475</span></a>            <span class="n">pred</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-476"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-476"><span class="linenos">476</span></a>                <span class="c1"># 4 is mean, std, lower, upper</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-477"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-477"><span class="linenos">477</span></a>                <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-478"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-478"><span class="linenos">478</span></a>                <span class="s2">&quot;lower&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-479"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-479"><span class="linenos">479</span></a>                <span class="s2">&quot;upper&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-480"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-480"><span class="linenos">480</span></a>            <span class="p">}</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-481"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-481"><span class="linenos">481</span></a>            <span class="k">for</span> <span class="n">estimator</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-482"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-482"><span class="linenos">482</span></a>                <span class="n">preds</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-483"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-483"><span class="linenos">483</span></a>                <span class="k">if</span> <span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-484"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-484"><span class="linenos">484</span></a>                    <span class="n">pred</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">preds</span><span class="o">.</span><span class="n">mean</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-485"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-485"><span class="linenos">485</span></a>                    <span class="n">pred</span><span class="p">[</span><span class="s2">&quot;lower&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">preds</span><span class="o">.</span><span class="n">upper</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-486"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-486"><span class="linenos">486</span></a>                    <span class="n">pred</span><span class="p">[</span><span class="s2">&quot;upper&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">preds</span><span class="o">.</span><span class="n">lower</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-487"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-487"><span class="linenos">487</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-488"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-488"><span class="linenos">488</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">])</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-489"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-489"><span class="linenos">489</span></a>            <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">],</span> <span class="n">pred</span><span class="p">[</span><span class="s2">&quot;lower&quot;</span><span class="p">],</span> <span class="n">pred</span><span class="p">[</span><span class="s2">&quot;upper&quot;</span><span class="p">])</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-490"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-490"><span class="linenos">490</span></a>        <span class="n">pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-491"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-491"><span class="linenos">491</span></a>        <span class="k">for</span> <span class="n">estimator</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-492"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-492"><span class="linenos">492</span></a>            <span class="n">pred</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-493"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-493"><span class="linenos">493</span></a>        <span class="k">return</span> <span class="n">pred</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-494"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-494"><span class="linenos">494</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-495"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-495"><span class="linenos">495</span></a>    <span class="k">def</span> <span class="nf">_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-496"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-496"><span class="linenos">496</span></a>        <span class="c1"># account for intercept</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-497"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-497"><span class="linenos">497</span></a>        <span class="n">Xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">X</span><span class="p">))</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-498"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-498"><span class="linenos">498</span></a>        <span class="n">pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raw_predict</span><span class="p">(</span><span class="n">Xi</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-499"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-499"><span class="linenos">499</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-500"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-500"><span class="linenos">500</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="o">.</span><span class="n">_scale_raw_prediction</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-501"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-501"><span class="linenos">501</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;return_pi&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-502"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-502"><span class="linenos">502</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-503"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-503"><span class="linenos">503</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">])</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-504"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-504"><span class="linenos">504</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="o">.</span><span class="n">_scale_raw_prediction</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-505"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-505"><span class="linenos">505</span></a>                <span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pred</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pred</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-506"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-506"><span class="linenos">506</span></a>            <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-507"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-507"><span class="linenos">507</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-508"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-508"><span class="linenos">508</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-509"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-509"><span class="linenos">509</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict risk scores.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-510"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-510"><span class="linenos">510</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-511"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-511"><span class="linenos">511</span></a><span class="sd">        If `loss=&#39;coxph&#39;`, predictions can be interpreted as log hazard ratio</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-512"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-512"><span class="linenos">512</span></a><span class="sd">        corresponding to the linear predictor of a Cox proportional hazards</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-513"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-513"><span class="linenos">513</span></a><span class="sd">        model. If `loss=&#39;squared&#39;` or `loss=&#39;ipcwls&#39;`, predictions are the</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-514"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-514"><span class="linenos">514</span></a><span class="sd">        time to event.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-515"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-515"><span class="linenos">515</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-516"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-516"><span class="linenos">516</span></a><span class="sd">        Parameters</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-517"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-517"><span class="linenos">517</span></a><span class="sd">        ----------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-518"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-518"><span class="linenos">518</span></a><span class="sd">        X : array-like, shape = (n_samples, n_features)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-519"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-519"><span class="linenos">519</span></a><span class="sd">            Data matrix.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-520"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-520"><span class="linenos">520</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-521"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-521"><span class="linenos">521</span></a><span class="sd">        Returns</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-522"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-522"><span class="linenos">522</span></a><span class="sd">        -------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-523"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-523"><span class="linenos">523</span></a><span class="sd">        risk_score : array, shape = (n_samples,)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-524"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-524"><span class="linenos">524</span></a><span class="sd">            Predicted risk scores.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-525"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-525"><span class="linenos">525</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-526"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-526"><span class="linenos">526</span></a>        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;estimators_&quot;</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-527"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-527"><span class="linenos">527</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-528"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-528"><span class="linenos">528</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-529"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-529"><span class="linenos">529</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-530"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-530"><span class="linenos">530</span></a>    <span class="k">def</span> <span class="nf">get_baseline_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-531"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-531"><span class="linenos">531</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-532"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-532"><span class="linenos">532</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-533"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-533"><span class="linenos">533</span></a>                <span class="s2">&quot;`fit` must be called with the loss option set to &#39;coxph&#39;.&quot;</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-534"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-534"><span class="linenos">534</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_model</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-535"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-535"><span class="linenos">535</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-536"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-536"><span class="linenos">536</span></a>    <span class="k">def</span> <span class="nf">predict_cumulative_hazard_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">return_array</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-537"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-537"><span class="linenos">537</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict cumulative hazard function.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-538"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-538"><span class="linenos">538</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-539"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-539"><span class="linenos">539</span></a><span class="sd">        Only available if :meth:`fit` has been called with `loss = &quot;coxph&quot;`.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-540"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-540"><span class="linenos">540</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-541"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-541"><span class="linenos">541</span></a><span class="sd">        The cumulative hazard function for an individual</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-542"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-542"><span class="linenos">542</span></a><span class="sd">        with feature vector :math:`x` is defined as</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-543"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-543"><span class="linenos">543</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-544"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-544"><span class="linenos">544</span></a><span class="sd">        .. math::</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-545"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-545"><span class="linenos">545</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-546"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-546"><span class="linenos">546</span></a><span class="sd">            H(t \\mid x) = \\exp(f(x)) H_0(t) ,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-547"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-547"><span class="linenos">547</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-548"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-548"><span class="linenos">548</span></a><span class="sd">        where :math:`f(\\cdot)` is the additive ensemble of base learners,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-549"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-549"><span class="linenos">549</span></a><span class="sd">        and :math:`H_0(t)` is the baseline hazard function,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-550"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-550"><span class="linenos">550</span></a><span class="sd">        estimated by Breslow&#39;s estimator.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-551"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-551"><span class="linenos">551</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-552"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-552"><span class="linenos">552</span></a><span class="sd">        Parameters</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-553"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-553"><span class="linenos">553</span></a><span class="sd">        ----------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-554"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-554"><span class="linenos">554</span></a><span class="sd">        X : array-like, shape = (n_samples, n_features)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-555"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-555"><span class="linenos">555</span></a><span class="sd">            Data matrix.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-556"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-556"><span class="linenos">556</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-557"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-557"><span class="linenos">557</span></a><span class="sd">        return_array : boolean, default: False</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-558"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-558"><span class="linenos">558</span></a><span class="sd">            If set, return an array with the cumulative hazard rate</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-559"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-559"><span class="linenos">559</span></a><span class="sd">            for each `self.unique_times_`, otherwise an array of</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-560"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-560"><span class="linenos">560</span></a><span class="sd">            :class:`survivalist.functions.StepFunction`.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-561"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-561"><span class="linenos">561</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-562"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-562"><span class="linenos">562</span></a><span class="sd">        Returns</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-563"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-563"><span class="linenos">563</span></a><span class="sd">        -------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-564"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-564"><span class="linenos">564</span></a><span class="sd">        cum_hazard : ndarray</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-565"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-565"><span class="linenos">565</span></a><span class="sd">            If `return_array` is set, an array with the cumulative hazard rate</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-566"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-566"><span class="linenos">566</span></a><span class="sd">            for each `self.unique_times_`, otherwise an array of length `n_samples`</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-567"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-567"><span class="linenos">567</span></a><span class="sd">            of :class:`survivalist.functions.StepFunction` instances will be returned.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-568"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-568"><span class="linenos">568</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-569"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-569"><span class="linenos">569</span></a><span class="sd">        Examples</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-570"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-570"><span class="linenos">570</span></a><span class="sd">        --------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-571"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-571"><span class="linenos">571</span></a><span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-572"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-572"><span class="linenos">572</span></a><span class="sd">        &gt;&gt;&gt; from survivalist.datasets import load_whas500</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-573"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-573"><span class="linenos">573</span></a><span class="sd">        &gt;&gt;&gt; from survivalist.ensemble import ComponentwiseGradientBoostingSurvivalAnalysis</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-574"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-574"><span class="linenos">574</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-575"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-575"><span class="linenos">575</span></a><span class="sd">        Load the data.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-576"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-576"><span class="linenos">576</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-577"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-577"><span class="linenos">577</span></a><span class="sd">        &gt;&gt;&gt; X, y = load_whas500()</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-578"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-578"><span class="linenos">578</span></a><span class="sd">        &gt;&gt;&gt; X = X.astype(float)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-579"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-579"><span class="linenos">579</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-580"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-580"><span class="linenos">580</span></a><span class="sd">        Fit the model.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-581"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-581"><span class="linenos">581</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-582"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-582"><span class="linenos">582</span></a><span class="sd">        &gt;&gt;&gt; estimator = ComponentwiseGradientBoostingSurvivalAnalysis(loss=&quot;coxph&quot;).fit(X, y)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-583"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-583"><span class="linenos">583</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-584"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-584"><span class="linenos">584</span></a><span class="sd">        Estimate the cumulative hazard function for the first 10 samples.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-585"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-585"><span class="linenos">585</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-586"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-586"><span class="linenos">586</span></a><span class="sd">        &gt;&gt;&gt; chf_funcs = estimator.predict_cumulative_hazard_function(X.iloc[:10])</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-587"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-587"><span class="linenos">587</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-588"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-588"><span class="linenos">588</span></a><span class="sd">        Plot the estimated cumulative hazard functions.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-589"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-589"><span class="linenos">589</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-590"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-590"><span class="linenos">590</span></a><span class="sd">        &gt;&gt;&gt; for fn in chf_funcs:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-591"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-591"><span class="linenos">591</span></a><span class="sd">        ...     plt.step(fn.x, fn(fn.x), where=&quot;post&quot;)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-592"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-592"><span class="linenos">592</span></a><span class="sd">        ...</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-593"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-593"><span class="linenos">593</span></a><span class="sd">        &gt;&gt;&gt; plt.ylim(0, 1)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-594"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-594"><span class="linenos">594</span></a><span class="sd">        &gt;&gt;&gt; plt.show()</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-595"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-595"><span class="linenos">595</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-596"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-596"><span class="linenos">596</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantiles_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-597"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-597"><span class="linenos">597</span></a>            <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-598"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-598"><span class="linenos">598</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-599"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-599"><span class="linenos">599</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">])</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-600"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-600"><span class="linenos">600</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-601"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-601"><span class="linenos">601</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_predict_cumulative_hazard_function</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-602"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-602"><span class="linenos">602</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">(),</span> <span class="n">preds</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">return_array</span><span class="p">),</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-603"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-603"><span class="linenos">603</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_predict_cumulative_hazard_function</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-604"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-604"><span class="linenos">604</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">(),</span> <span class="n">preds</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">return_array</span><span class="p">),</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-605"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-605"><span class="linenos">605</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_predict_cumulative_hazard_function</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-606"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-606"><span class="linenos">606</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">(),</span> <span class="n">preds</span><span class="o">.</span><span class="n">upper</span><span class="p">,</span> <span class="n">return_array</span><span class="p">),</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-607"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-607"><span class="linenos">607</span></a>            <span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-608"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-608"><span class="linenos">608</span></a>            <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-609"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-609"><span class="linenos">609</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_cumulative_hazard_function</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-610"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-610"><span class="linenos">610</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">return_array</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-611"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-611"><span class="linenos">611</span></a>        <span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-612"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-612"><span class="linenos">612</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-613"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-613"><span class="linenos">613</span></a>    <span class="k">def</span> <span class="nf">predict_survival_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">return_array</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-614"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-614"><span class="linenos">614</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict survival function.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-615"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-615"><span class="linenos">615</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-616"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-616"><span class="linenos">616</span></a><span class="sd">        Only available if :meth:`fit` has been called with `loss = &quot;coxph&quot;`.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-617"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-617"><span class="linenos">617</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-618"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-618"><span class="linenos">618</span></a><span class="sd">        The survival function for an individual</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-619"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-619"><span class="linenos">619</span></a><span class="sd">        with feature vector :math:`x` is defined as</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-620"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-620"><span class="linenos">620</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-621"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-621"><span class="linenos">621</span></a><span class="sd">        .. math::</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-622"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-622"><span class="linenos">622</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-623"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-623"><span class="linenos">623</span></a><span class="sd">            S(t \\mid x) = S_0(t)^{\\exp(f(x)} ,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-624"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-624"><span class="linenos">624</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-625"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-625"><span class="linenos">625</span></a><span class="sd">        where :math:`f(\\cdot)` is the additive ensemble of base learners,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-626"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-626"><span class="linenos">626</span></a><span class="sd">        and :math:`S_0(t)` is the baseline survival function,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-627"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-627"><span class="linenos">627</span></a><span class="sd">        estimated by Breslow&#39;s estimator.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-628"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-628"><span class="linenos">628</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-629"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-629"><span class="linenos">629</span></a><span class="sd">        Parameters</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-630"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-630"><span class="linenos">630</span></a><span class="sd">        ----------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-631"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-631"><span class="linenos">631</span></a><span class="sd">        X : array-like, shape = (n_samples, n_features)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-632"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-632"><span class="linenos">632</span></a><span class="sd">            Data matrix.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-633"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-633"><span class="linenos">633</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-634"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-634"><span class="linenos">634</span></a><span class="sd">        return_array : boolean, default: False</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-635"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-635"><span class="linenos">635</span></a><span class="sd">            If set, return an array with the probability</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-636"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-636"><span class="linenos">636</span></a><span class="sd">            of survival for each `self.unique_times_`,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-637"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-637"><span class="linenos">637</span></a><span class="sd">            otherwise an array of :class:`survivalist.functions.StepFunction`.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-638"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-638"><span class="linenos">638</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-639"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-639"><span class="linenos">639</span></a><span class="sd">        Returns</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-640"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-640"><span class="linenos">640</span></a><span class="sd">        -------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-641"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-641"><span class="linenos">641</span></a><span class="sd">        survival : ndarray</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-642"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-642"><span class="linenos">642</span></a><span class="sd">            If `return_array` is set, an array with the probability of</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-643"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-643"><span class="linenos">643</span></a><span class="sd">            survival for each `self.unique_times_`, otherwise an array of</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-644"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-644"><span class="linenos">644</span></a><span class="sd">            length `n_samples` of :class:`survivalist.functions.StepFunction`</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-645"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-645"><span class="linenos">645</span></a><span class="sd">            instances will be returned.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-646"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-646"><span class="linenos">646</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-647"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-647"><span class="linenos">647</span></a><span class="sd">        Examples</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-648"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-648"><span class="linenos">648</span></a><span class="sd">        --------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-649"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-649"><span class="linenos">649</span></a><span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-650"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-650"><span class="linenos">650</span></a><span class="sd">        &gt;&gt;&gt; from survivalist.datasets import load_whas500</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-651"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-651"><span class="linenos">651</span></a><span class="sd">        &gt;&gt;&gt; from survivalist.ensemble import ComponentwiseGradientBoostingSurvivalAnalysis</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-652"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-652"><span class="linenos">652</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-653"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-653"><span class="linenos">653</span></a><span class="sd">        Load the data.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-654"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-654"><span class="linenos">654</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-655"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-655"><span class="linenos">655</span></a><span class="sd">        &gt;&gt;&gt; X, y = load_whas500()</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-656"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-656"><span class="linenos">656</span></a><span class="sd">        &gt;&gt;&gt; X = X.astype(float)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-657"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-657"><span class="linenos">657</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-658"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-658"><span class="linenos">658</span></a><span class="sd">        Fit the model.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-659"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-659"><span class="linenos">659</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-660"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-660"><span class="linenos">660</span></a><span class="sd">        &gt;&gt;&gt; estimator = ComponentwiseGradientBoostingSurvivalAnalysis(loss=&quot;coxph&quot;).fit(X, y)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-661"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-661"><span class="linenos">661</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-662"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-662"><span class="linenos">662</span></a><span class="sd">        Estimate the survival function for the first 10 samples.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-663"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-663"><span class="linenos">663</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-664"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-664"><span class="linenos">664</span></a><span class="sd">        &gt;&gt;&gt; surv_funcs = estimator.predict_survival_function(X.iloc[:10])</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-665"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-665"><span class="linenos">665</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-666"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-666"><span class="linenos">666</span></a><span class="sd">        Plot the estimated survival functions.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-667"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-667"><span class="linenos">667</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-668"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-668"><span class="linenos">668</span></a><span class="sd">        &gt;&gt;&gt; for fn in surv_funcs:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-669"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-669"><span class="linenos">669</span></a><span class="sd">        ...     plt.step(fn.x, fn(fn.x), where=&quot;post&quot;)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-670"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-670"><span class="linenos">670</span></a><span class="sd">        ...</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-671"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-671"><span class="linenos">671</span></a><span class="sd">        &gt;&gt;&gt; plt.ylim(0, 1)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-672"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-672"><span class="linenos">672</span></a><span class="sd">        &gt;&gt;&gt; plt.show()</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-673"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-673"><span class="linenos">673</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-674"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-674"><span class="linenos">674</span></a>        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;return_pi&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-675"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-675"><span class="linenos">675</span></a>            <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-676"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-676"><span class="linenos">676</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-677"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-677"><span class="linenos">677</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">])</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-678"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-678"><span class="linenos">678</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-679"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-679"><span class="linenos">679</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_predict_survival_function</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-680"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-680"><span class="linenos">680</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">(),</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-681"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-681"><span class="linenos">681</span></a>                    <span class="n">preds</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-682"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-682"><span class="linenos">682</span></a>                    <span class="n">return_array</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-683"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-683"><span class="linenos">683</span></a>                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-684"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-684"><span class="linenos">684</span></a>                <span class="p">),</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-685"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-685"><span class="linenos">685</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_predict_survival_function</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-686"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-686"><span class="linenos">686</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">(),</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-687"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-687"><span class="linenos">687</span></a>                    <span class="n">preds</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-688"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-688"><span class="linenos">688</span></a>                    <span class="n">return_array</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-689"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-689"><span class="linenos">689</span></a>                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-690"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-690"><span class="linenos">690</span></a>                <span class="p">),</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-691"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-691"><span class="linenos">691</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_predict_survival_function</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-692"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-692"><span class="linenos">692</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">(),</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-693"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-693"><span class="linenos">693</span></a>                    <span class="n">preds</span><span class="o">.</span><span class="n">upper</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-694"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-694"><span class="linenos">694</span></a>                    <span class="n">return_array</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-695"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-695"><span class="linenos">695</span></a>                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-696"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-696"><span class="linenos">696</span></a>                <span class="p">),</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-697"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-697"><span class="linenos">697</span></a>            <span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-698"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-698"><span class="linenos">698</span></a>            <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-699"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-699"><span class="linenos">699</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_survival_function</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-700"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-700"><span class="linenos">700</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">(),</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-701"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-701"><span class="linenos">701</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-702"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-702"><span class="linenos">702</span></a>            <span class="n">return_array</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-703"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-703"><span class="linenos">703</span></a>            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-704"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-704"><span class="linenos">704</span></a>        <span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-705"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-705"><span class="linenos">705</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-706"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-706"><span class="linenos">706</span></a>    <span class="nd">@property</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-707"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-707"><span class="linenos">707</span></a>    <span class="k">def</span> <span class="nf">unique_times_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-708"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-708"><span class="linenos">708</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_baseline_model</span><span class="p">()</span><span class="o">.</span><span class="n">unique_times_</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-709"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-709"><span class="linenos">709</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-710"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-710"><span class="linenos">710</span></a>    <span class="nd">@property</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-711"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-711"><span class="linenos">711</span></a>    <span class="k">def</span> <span class="nf">feature_importances_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-712"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-712"><span class="linenos">712</span></a>        <span class="n">imp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_features_in_</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-713"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-713"><span class="linenos">713</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">imp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-714"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-714"><span class="linenos">714</span></a>            <span class="n">imp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-715"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-715"><span class="linenos">715</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-716"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-716"><span class="linenos">716</span></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">estimator</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-717"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-717"><span class="linenos">717</span></a>            <span class="n">imp</span><span class="p">[</span><span class="n">estimator</span><span class="o">.</span><span class="n">component</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-718"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-718"><span class="linenos">718</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-719"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-719"><span class="linenos">719</span></a>        <span class="k">def</span> <span class="nf">_importance</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-720"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-720"><span class="linenos">720</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-721"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-721"><span class="linenos">721</span></a>                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-722"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-722"><span class="linenos">722</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-723"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-723"><span class="linenos">723</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-724"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-724"><span class="linenos">724</span></a>        <span class="n">ret</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">_importance</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">imp</span><span class="p">])</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-725"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-725"><span class="linenos">725</span></a>        <span class="k">return</span> <span class="n">ret</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-726"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-726"><span class="linenos">726</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-727"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-727"><span class="linenos">727</span></a>    <span class="k">def</span> <span class="nf">_make_estimator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-728"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-728"><span class="linenos">728</span></a>        <span class="c1"># we don&#39;t need _make_estimator</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis-729"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis-729"><span class="linenos">729</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Generic Gradient boosting with any base learner.</p>

<h2 id="parameters">Parameters</h2>

<p>loss : {'coxph', 'squared', 'ipcwls'}, optional, default: 'coxph'
    loss function to be optimized. 'coxph' refers to partial likelihood loss
    of Cox's proportional hazards model. The loss 'squared' minimizes a
    squared regression loss that ignores predictions beyond the time of censoring,
    and 'ipcwls' refers to inverse-probability of censoring weighted least squares error.</p>

<p>learning_rate : float, optional, default: 0.1
    learning rate shrinks the contribution of each base learner by <code><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.learning_rate">learning_rate</a></code>.
    There is a trade-off between <code><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.learning_rate">learning_rate</a></code> and <code><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.n_estimators">n_estimators</a></code>.
    Values must be in the range <code>[0.0, inf)</code>.</p>

<p>n_estimators : int, default: 100
    The number of boosting stages to perform. Gradient boosting
    is fairly robust to over-fitting so a large number usually
    results in better performance.
    Values must be in the range <code>[1, inf)</code>.</p>

<p>subsample : float, optional, default: 1.0
    The fraction of samples to be used for fitting the individual base
    learners. If smaller than 1.0 this results in Stochastic Gradient
    Boosting. <code><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.subsample">subsample</a></code> interacts with the parameter <code><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.n_estimators">n_estimators</a></code>.
    Choosing <code>subsample &lt; 1.0</code> leads to a reduction of variance
    and an increase in bias.
    Values must be in the range <code>(0.0, 1.0]</code>.</p>

<p>warm_start : bool, default: False
    When set to <code>True</code>, reuse the solution of the previous call to fit
    and add more estimators to the ensemble, otherwise, just erase the
    previous solution.</p>

<p>dropout_rate : float, optional, default: 0.0
    If larger than zero, the residuals at each iteration are only computed
    from a random subset of base learners. The value corresponds to the
    percentage of base learners that are dropped. In each iteration,
    at least one base learner is dropped. This is an alternative regularization
    to shrinkage, i.e., setting <code>learning_rate &lt; 1.0</code>.
    Values must be in the range <code>[0.0, 1.0)</code>.</p>

<p>random_state : int seed, RandomState instance, or None, default: None
    The seed of the pseudo random number generator to use when
    shuffling the data.</p>

<p>verbose : int, default: 0
    Enable verbose output. If 1 then it prints progress and performance
    once in a while.
    Values must be in the range <code>[0, inf)</code>.</p>

<p>show_progress : bool, default: True
    If set, show a progress bar for the fitting process.</p>

<h2 id="attributes">Attributes</h2>

<p>estimators_ : list of base learners
    The collection of fitted sub-estimators.</p>

<p>train_score_ : ndarray, shape = (n_estimators,)
    The i-th score <code>train_score_[i]</code> is the loss of the
    model at iteration <code>i</code> on the in-bag sample.
    If <code>subsample == 1</code> this is the loss on the training data.</p>

<p>oob_improvement_ : ndarray, shape = (n_estimators,)
    The improvement in loss on the out-of-bag samples
    relative to the previous iteration.
    <code>oob_improvement_[0]</code> is the improvement in
    loss of the first stage over the <code>init</code> estimator.
    Only available if <code>subsample &lt; 1.0</code>.</p>

<p>oob_scores_ : ndarray of shape (n_estimators,)
    The full history of the loss values on the out-of-bag
    samples. Only available if <code>subsample &lt; 1.0</code>.</p>

<p>oob_score_ : float
    The last value of the loss on the out-of-bag samples. It is
    the same as <code>oob_scores_[-1]</code>. Only available if <code>subsample &lt; 1.0</code>.</p>

<p>n_features_in_ : int
    Number of features seen during <code><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit">fit</a></code>.</p>

<p>feature_names_in_ : ndarray of shape (<code>n_features_in_</code>,)
    Names of features seen during <code><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit">fit</a></code>. Defined only when <code>X</code>
    has feature names that are all strings.</p>

<p>unique_times_ : array of shape = (n_unique_times,)
    Unique time points.</p>

<h2 id="references">References</h2>

<div class="footnotes">
<hr />
<ol>
</ol>
</div>
</div>


                                <div id="ComponentwiseGenGradientBoostingSurvivalAnalysis.subsample" class="classattr">
                                    <div class="attr variable">
            <span class="name">subsample</span>

        
    </div>
    <a class="headerlink" href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.subsample"></a>
    
    

                                </div>
                                <div id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit" class="classattr">
                                            <input id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-391"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-391"><span class="linenos">391</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-392"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-392"><span class="linenos">392</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit estimator.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-393"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-393"><span class="linenos">393</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-394"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-394"><span class="linenos">394</span></a><span class="sd">        Parameters</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-395"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-395"><span class="linenos">395</span></a><span class="sd">        ----------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-396"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-396"><span class="linenos">396</span></a><span class="sd">        X : array-like, shape = (n_samples, n_features)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-397"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-397"><span class="linenos">397</span></a><span class="sd">            Data matrix</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-398"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-398"><span class="linenos">398</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-399"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-399"><span class="linenos">399</span></a><span class="sd">        y : structured array, shape = (n_samples,)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-400"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-400"><span class="linenos">400</span></a><span class="sd">            A structured array containing the binary event indicator</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-401"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-401"><span class="linenos">401</span></a><span class="sd">            as first field, and time of event or time of censoring as</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-402"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-402"><span class="linenos">402</span></a><span class="sd">            second field.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-403"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-403"><span class="linenos">403</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-404"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-404"><span class="linenos">404</span></a><span class="sd">        sample_weight : array-like, shape = (n_samples,), optional</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-405"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-405"><span class="linenos">405</span></a><span class="sd">            Weights given to each sample. If omitted, all samples have weight 1.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-406"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-406"><span class="linenos">406</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-407"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-407"><span class="linenos">407</span></a><span class="sd">        Returns</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-408"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-408"><span class="linenos">408</span></a><span class="sd">        -------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-409"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-409"><span class="linenos">409</span></a><span class="sd">        self</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-410"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-410"><span class="linenos">410</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-411"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-411"><span class="linenos">411</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_params</span><span class="p">()</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-412"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-412"><span class="linenos">412</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-413"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-413"><span class="linenos">413</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">warm_start</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-414"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-414"><span class="linenos">414</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_clear_state</span><span class="p">()</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-415"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-415"><span class="linenos">415</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-416"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-416"><span class="linenos">416</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">ensure_min_samples</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-417"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-417"><span class="linenos">417</span></a>        <span class="n">event</span><span class="p">,</span> <span class="n">time</span> <span class="o">=</span> <span class="n">check_array_survival</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-418"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-418"><span class="linenos">418</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-419"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-419"><span class="linenos">419</span></a>        <span class="n">sample_weight</span> <span class="o">=</span> <span class="n">_check_sample_weight</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-420"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-420"><span class="linenos">420</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-421"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-421"><span class="linenos">421</span></a>        <span class="n">n_samples</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-422"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-422"><span class="linenos">422</span></a>        <span class="n">Xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_samples</span><span class="p">),</span> <span class="n">X</span><span class="p">))</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-423"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-423"><span class="linenos">423</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-424"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-424"><span class="linenos">424</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span> <span class="o">=</span> <span class="n">LOSS_FUNCTIONS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">loss</span><span class="p">]()</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-425"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-425"><span class="linenos">425</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_obj</span><span class="p">,</span> <span class="p">(</span><span class="n">CensoredSquaredLoss</span><span class="p">,</span> <span class="n">IPCWLeastSquaresError</span><span class="p">)):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-426"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-426"><span class="linenos">426</span></a>            <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-427"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-427"><span class="linenos">427</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-428"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-428"><span class="linenos">428</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_fitted</span><span class="p">():</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-429"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-429"><span class="linenos">429</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_init_state</span><span class="p">()</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-430"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-430"><span class="linenos">430</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-431"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-431"><span class="linenos">431</span></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-432"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-432"><span class="linenos">432</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-433"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-433"><span class="linenos">433</span></a>            <span class="n">begin_at_stage</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-434"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-434"><span class="linenos">434</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-435"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-435"><span class="linenos">435</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-436"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-436"><span class="linenos">436</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-437"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-437"><span class="linenos">437</span></a>            <span class="c1"># add more estimators to fitted model</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-438"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-438"><span class="linenos">438</span></a>            <span class="c1"># invariant: warm_start = True</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-439"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-439"><span class="linenos">439</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-440"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-440"><span class="linenos">440</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-441"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-441"><span class="linenos">441</span></a>                    <span class="s2">&quot;n_estimators=</span><span class="si">%d</span><span class="s2"> must be larger or equal to &quot;</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-442"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-442"><span class="linenos">442</span></a>                    <span class="s2">&quot;estimators_.shape[0]=</span><span class="si">%d</span><span class="s2"> when &quot;</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-443"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-443"><span class="linenos">443</span></a>                    <span class="s2">&quot;warm_start==True&quot;</span> <span class="o">%</span> <span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-444"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-444"><span class="linenos">444</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-445"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-445"><span class="linenos">445</span></a>                <span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-446"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-446"><span class="linenos">446</span></a>            <span class="n">begin_at_stage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-447"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-447"><span class="linenos">447</span></a>            <span class="n">y_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raw_predict</span><span class="p">(</span><span class="n">Xi</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-448"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-448"><span class="linenos">448</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_resize_state</span><span class="p">()</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-449"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-449"><span class="linenos">449</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-450"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-450"><span class="linenos">450</span></a>            <span class="c1"># apply dropout to last stage of previous fit</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-451"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-451"><span class="linenos">451</span></a>            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_scale&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-452"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-452"><span class="linenos">452</span></a>                <span class="c1"># pylint: disable-next=access-member-before-definition</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-453"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-453"><span class="linenos">453</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_update_with_dropout</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-454"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-454"><span class="linenos">454</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators_</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Xi</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-455"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-455"><span class="linenos">455</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-456"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-456"><span class="linenos">456</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit</span><span class="p">(</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-457"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-457"><span class="linenos">457</span></a>            <span class="n">Xi</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span><span class="p">,</span> <span class="n">begin_at_stage</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-458"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-458"><span class="linenos">458</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-459"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-459"><span class="linenos">459</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_baseline_model</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-460"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-460"><span class="linenos">460</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-461"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-461"><span class="linenos">461</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regr</span><span class="o">.</span><span class="n">X_</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-462"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-462"><span class="linenos">462</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-463"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-463"><span class="linenos">463</span></a>            <span class="k">pass</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-464"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.fit-464"><span class="linenos">464</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit estimator.</p>

<h2 id="parameters">Parameters</h2>

<p>X : array-like, shape = (n_samples, n_features)
    Data matrix</p>

<p>y : structured array, shape = (n_samples,)
    A structured array containing the binary event indicator
    as first field, and time of event or time of censoring as
    second field.</p>

<p>sample_weight : array-like, shape = (n_samples,), optional
    Weights given to each sample. If omitted, all samples have weight 1.</p>

<h2 id="returns">Returns</h2>

<p>self</p>
</div>


                                </div>
                                <div id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict" class="classattr">
                                            <input id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-508"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-508"><span class="linenos">508</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-509"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-509"><span class="linenos">509</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict risk scores.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-510"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-510"><span class="linenos">510</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-511"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-511"><span class="linenos">511</span></a><span class="sd">        If `loss=&#39;coxph&#39;`, predictions can be interpreted as log hazard ratio</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-512"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-512"><span class="linenos">512</span></a><span class="sd">        corresponding to the linear predictor of a Cox proportional hazards</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-513"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-513"><span class="linenos">513</span></a><span class="sd">        model. If `loss=&#39;squared&#39;` or `loss=&#39;ipcwls&#39;`, predictions are the</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-514"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-514"><span class="linenos">514</span></a><span class="sd">        time to event.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-515"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-515"><span class="linenos">515</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-516"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-516"><span class="linenos">516</span></a><span class="sd">        Parameters</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-517"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-517"><span class="linenos">517</span></a><span class="sd">        ----------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-518"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-518"><span class="linenos">518</span></a><span class="sd">        X : array-like, shape = (n_samples, n_features)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-519"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-519"><span class="linenos">519</span></a><span class="sd">            Data matrix.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-520"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-520"><span class="linenos">520</span></a>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-521"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-521"><span class="linenos">521</span></a><span class="sd">        Returns</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-522"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-522"><span class="linenos">522</span></a><span class="sd">        -------</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-523"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-523"><span class="linenos">523</span></a><span class="sd">        risk_score : array, shape = (n_samples,)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-524"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-524"><span class="linenos">524</span></a><span class="sd">            Predicted risk scores.</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-525"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-525"><span class="linenos">525</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-526"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-526"><span class="linenos">526</span></a>        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;estimators_&quot;</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-527"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-527"><span class="linenos">527</span></a>        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-528"><a href="#ComponentwiseGenGradientBoostingSurvivalAnalysis.predict-528"><span class="linenos">528</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict risk scores.</p>

<p>If <code>loss='coxph'</code>, predictions can be interpreted as log hazard ratio
corresponding to the linear predictor of a Cox proportional hazards
model. If <code>loss='squared'</code> or <code>loss='ipcwls'</code>, predictions are the
time to event.</p>

<h2 id="parameters">Parameters</h2>

<p>X : array-like, shape = (n_samples, n_features)
    Data matrix.</p>

<h2 id="returns">Returns</h2>

<p>risk_score : array, shape = (n_samples,)
    Predicted risk scores.</p>
</div>


                                </div>
                        
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>