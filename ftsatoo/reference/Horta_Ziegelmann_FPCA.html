<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Dynamic functional principal component analysis for density forecasting — Horta_Ziegelmann_FPCA • ftsatoo</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Dynamic functional principal component analysis for density forecasting — Horta_Ziegelmann_FPCA"><meta property="og:description" content="Implementation of a dynamic functional principal component analysis to forecast densities."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ftsatoo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Dynamic functional principal component analysis for density forecasting</h1>

    <div class="hidden name"><code>Horta_Ziegelmann_FPCA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Implementation of a dynamic functional principal component analysis to forecast densities.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Horta_Ziegelmann_FPCA</span><span class="op">(</span><span class="va">data</span>, <span class="va">gridpoints</span>, h_scale <span class="op">=</span> <span class="fl">1</span>, p <span class="op">=</span> <span class="fl">5</span>, m <span class="op">=</span> <span class="fl">5001</span>, </span>
<span>  kernel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"epanechnikov"</span><span class="op">)</span>, band_choice <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Silverman"</span>, <span class="st">"DPI"</span><span class="op">)</span>, </span>
<span>  VAR_type <span class="op">=</span> <span class="st">"both"</span>, lag_maximum <span class="op">=</span> <span class="fl">6</span>, no_boot <span class="op">=</span> <span class="fl">1000</span>, alpha_val <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>  ncomp_select <span class="op">=</span> <span class="st">"TRUE"</span>, D_val <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Densities or raw data matrix of dimension N by p, where N denotes sample size and p denotes dimensionality</p></dd>

  <dt id="arg-gridpoints">gridpoints<a class="anchor" aria-label="anchor" href="#arg-gridpoints"></a></dt>
<dd><p>Grid points</p></dd>

  <dt id="arg-h-scale">h_scale<a class="anchor" aria-label="anchor" href="#arg-h-scale"></a></dt>
<dd><p>Scaling parameter in the kernel density estimator</p></dd>

  <dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Number of backward parameters</p></dd>

  <dt id="arg-m">m<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>Number of grid points</p></dd>

  <dt id="arg-kernel">kernel<a class="anchor" aria-label="anchor" href="#arg-kernel"></a></dt>
<dd><p>Type of kernel function</p></dd>

  <dt id="arg-band-choice">band_choice<a class="anchor" aria-label="anchor" href="#arg-band-choice"></a></dt>
<dd><p>Selection of optimal bandwidth</p></dd>

  <dt id="arg-var-type">VAR_type<a class="anchor" aria-label="anchor" href="#arg-var-type"></a></dt>
<dd><p>Type of vector autoregressive process</p></dd>

  <dt id="arg-lag-maximum">lag_maximum<a class="anchor" aria-label="anchor" href="#arg-lag-maximum"></a></dt>
<dd><p>A tuning parameter in the <code>super_fun</code> function</p></dd>

  <dt id="arg-no-boot">no_boot<a class="anchor" aria-label="anchor" href="#arg-no-boot"></a></dt>
<dd><p>A tuning parameter in the <code>super_fun</code> function</p></dd>

  <dt id="arg-alpha-val">alpha_val<a class="anchor" aria-label="anchor" href="#arg-alpha-val"></a></dt>
<dd><p>A tuning parameter in the <code>super_fun</code> function</p></dd>

  <dt id="arg-ncomp-select">ncomp_select<a class="anchor" aria-label="anchor" href="#arg-ncomp-select"></a></dt>
<dd><p>A tuning parameter in the <code>super_fun</code> function</p></dd>

  <dt id="arg-d-val">D_val<a class="anchor" aria-label="anchor" href="#arg-d-val"></a></dt>
<dd><p>A tuning parameter in the <code>super_fun</code> function</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>1) Compute a kernel covariance function
2) Via eigen-decomposition, a density can be decomposed into a set of functional principal components and their associated scores
3) Fit a vector autoregressive model to the scores with the order selected by Akaike information criterion
4) By multiplying the estimated functional principal components with the forecast scores, obtain forecast densities
5) Since forecast densities may neither be non-negative nor sum to one, normalize the forecast densities accordingly</p>
    </div>
    <div id="value">
    <h2>Value</h2>


<dl><dt>Yhat.fix_den</dt>
<dd><p>Forecast density</p></dd>

<dt>u</dt>
<dd><p>Grid points</p></dd>

<dt>du</dt>
<dd><p>Distance between two successive grid points</p></dd>

<dt>Ybar_est</dt>
<dd><p>Mean of density functions</p></dd>

<dt>psihat_est</dt>
<dd><p>Estimated functional principal components</p></dd>

<dt>etahat_est</dt>
<dd><p>Estimated principal component scores</p></dd>

<dt>etahat_pred_val</dt>
<dd><p>Forecast principal component scores</p></dd>

<dt>selected_d0</dt>
<dd><p>Selected number of components</p></dd>

<dt>selected_d0_pvalues</dt>
<dd><p>p-values associated with the selected functional principal components</p></dd>

<dt>thetahat_val</dt>
<dd><p>Estimated eigenvalues</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Horta, E. and Ziegelmann, F. (2018) `Dynamics of financial returns densities: A functional approach applied to the Bovespa intraday index', <em>International Journal of Forecasting</em>, <b>34</b>, 75-88.</p>
<p>Bathia, N., Yao, Q. and Ziegelmann, F. (2010) `Identifying the finite dimensionality of curve time series', <em>The Annals of Statistics</em>, <b>38</b>, 3353-3386.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Han Lin Shang</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code>CoDa_FPCA</code>, <code>LQDT_FPCA</code>, <code>skew_t_fun</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu">Horta_Ziegelmann_FPCA</span><span class="op">(</span>data <span class="op">=</span> <span class="va">DJI_return</span>, kernel <span class="op">=</span> <span class="st">"epanechnikov"</span>, </span></span>
<span class="r-in"><span>        band_choice <span class="op">=</span> <span class="st">"DPI"</span>, ncomp_select <span class="op">=</span> <span class="st">"FALSE"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rob Hyndman, Han Lin Shang.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

