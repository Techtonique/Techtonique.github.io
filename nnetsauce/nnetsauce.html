<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.5.0"/>
    <title>nnetsauce API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! theme.css */:root{--pdoc-background:#212529;}.pdoc{--text:#f7f7f7;--muted:#9d9d9d;--link:#58a6ff;--link-hover:#3989ff;--code:#333;--active:#555;--accent:#343434;--accent2:#555;--nav-hover:rgba(0, 0, 0, 0.1);--name:#77C1FF;--def:#0cdd0c;--annotation:#00c037;}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#49483e}.pdoc-code{background:#272822; color:#f8f8f2}.pdoc-code .c{color:#75715e}.pdoc-code .err{color:#960050; background-color:#1e0010}.pdoc-code .esc{color:#f8f8f2}.pdoc-code .g{color:#f8f8f2}.pdoc-code .k{color:#66d9ef}.pdoc-code .l{color:#ae81ff}.pdoc-code .n{color:#f8f8f2}.pdoc-code .o{color:#f92672}.pdoc-code .x{color:#f8f8f2}.pdoc-code .p{color:#f8f8f2}.pdoc-code .ch{color:#75715e}.pdoc-code .cm{color:#75715e}.pdoc-code .cp{color:#75715e}.pdoc-code .cpf{color:#75715e}.pdoc-code .c1{color:#75715e}.pdoc-code .cs{color:#75715e}.pdoc-code .gd{color:#f92672}.pdoc-code .ge{color:#f8f8f2; font-style:italic}.pdoc-code .gr{color:#f8f8f2}.pdoc-code .gh{color:#f8f8f2}.pdoc-code .gi{color:#a6e22e}.pdoc-code .go{color:#66d9ef}.pdoc-code .gp{color:#f92672; font-weight:bold}.pdoc-code .gs{color:#f8f8f2; font-weight:bold}.pdoc-code .gu{color:#75715e}.pdoc-code .gt{color:#f8f8f2}.pdoc-code .kc{color:#66d9ef}.pdoc-code .kd{color:#66d9ef}.pdoc-code .kn{color:#f92672}.pdoc-code .kp{color:#66d9ef}.pdoc-code .kr{color:#66d9ef}.pdoc-code .kt{color:#66d9ef}.pdoc-code .ld{color:#e6db74}.pdoc-code .m{color:#ae81ff}.pdoc-code .s{color:#e6db74}.pdoc-code .na{color:#a6e22e}.pdoc-code .nb{color:#f8f8f2}.pdoc-code .nc{color:#a6e22e}.pdoc-code .no{color:#66d9ef}.pdoc-code .nd{color:#a6e22e}.pdoc-code .ni{color:#f8f8f2}.pdoc-code .ne{color:#a6e22e}.pdoc-code .nf{color:#a6e22e}.pdoc-code .nl{color:#f8f8f2}.pdoc-code .nn{color:#f8f8f2}.pdoc-code .nx{color:#a6e22e}.pdoc-code .py{color:#f8f8f2}.pdoc-code .nt{color:#f92672}.pdoc-code .nv{color:#f8f8f2}.pdoc-code .ow{color:#f92672}.pdoc-code .w{color:#f8f8f2}.pdoc-code .mb{color:#ae81ff}.pdoc-code .mf{color:#ae81ff}.pdoc-code .mh{color:#ae81ff}.pdoc-code .mi{color:#ae81ff}.pdoc-code .mo{color:#ae81ff}.pdoc-code .sa{color:#e6db74}.pdoc-code .sb{color:#e6db74}.pdoc-code .sc{color:#e6db74}.pdoc-code .dl{color:#e6db74}.pdoc-code .sd{color:#e6db74}.pdoc-code .s2{color:#e6db74}.pdoc-code .se{color:#ae81ff}.pdoc-code .sh{color:#e6db74}.pdoc-code .si{color:#e6db74}.pdoc-code .sx{color:#e6db74}.pdoc-code .sr{color:#e6db74}.pdoc-code .s1{color:#e6db74}.pdoc-code .ss{color:#e6db74}.pdoc-code .bp{color:#f8f8f2}.pdoc-code .fm{color:#a6e22e}.pdoc-code .vc{color:#f8f8f2}.pdoc-code .vg{color:#f8f8f2}.pdoc-code .vi{color:#f8f8f2}.pdoc-code .vm{color:#f8f8f2}</style>
    <style>/*! theme.css */:root{--pdoc-background:#212529;}.pdoc{--text:#f7f7f7;--muted:#9d9d9d;--link:#58a6ff;--link-hover:#3989ff;--code:#333;--active:#555;--accent:#343434;--accent2:#555;--nav-hover:rgba(0, 0, 0, 0.1);--name:#77C1FF;--def:#0cdd0c;--annotation:#00c037;}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#49483e}.pdoc-code{background:#272822; color:#f8f8f2}.pdoc-code .c{color:#75715e}.pdoc-code .err{color:#960050; background-color:#1e0010}.pdoc-code .esc{color:#f8f8f2}.pdoc-code .g{color:#f8f8f2}.pdoc-code .k{color:#66d9ef}.pdoc-code .l{color:#ae81ff}.pdoc-code .n{color:#f8f8f2}.pdoc-code .o{color:#f92672}.pdoc-code .x{color:#f8f8f2}.pdoc-code .p{color:#f8f8f2}.pdoc-code .ch{color:#75715e}.pdoc-code .cm{color:#75715e}.pdoc-code .cp{color:#75715e}.pdoc-code .cpf{color:#75715e}.pdoc-code .c1{color:#75715e}.pdoc-code .cs{color:#75715e}.pdoc-code .gd{color:#f92672}.pdoc-code .ge{color:#f8f8f2; font-style:italic}.pdoc-code .gr{color:#f8f8f2}.pdoc-code .gh{color:#f8f8f2}.pdoc-code .gi{color:#a6e22e}.pdoc-code .go{color:#66d9ef}.pdoc-code .gp{color:#f92672; font-weight:bold}.pdoc-code .gs{color:#f8f8f2; font-weight:bold}.pdoc-code .gu{color:#75715e}.pdoc-code .gt{color:#f8f8f2}.pdoc-code .kc{color:#66d9ef}.pdoc-code .kd{color:#66d9ef}.pdoc-code .kn{color:#f92672}.pdoc-code .kp{color:#66d9ef}.pdoc-code .kr{color:#66d9ef}.pdoc-code .kt{color:#66d9ef}.pdoc-code .ld{color:#e6db74}.pdoc-code .m{color:#ae81ff}.pdoc-code .s{color:#e6db74}.pdoc-code .na{color:#a6e22e}.pdoc-code .nb{color:#f8f8f2}.pdoc-code .nc{color:#a6e22e}.pdoc-code .no{color:#66d9ef}.pdoc-code .nd{color:#a6e22e}.pdoc-code .ni{color:#f8f8f2}.pdoc-code .ne{color:#a6e22e}.pdoc-code .nf{color:#a6e22e}.pdoc-code .nl{color:#f8f8f2}.pdoc-code .nn{color:#f8f8f2}.pdoc-code .nx{color:#a6e22e}.pdoc-code .py{color:#f8f8f2}.pdoc-code .nt{color:#f92672}.pdoc-code .nv{color:#f8f8f2}.pdoc-code .ow{color:#f92672}.pdoc-code .w{color:#f8f8f2}.pdoc-code .mb{color:#ae81ff}.pdoc-code .mf{color:#ae81ff}.pdoc-code .mh{color:#ae81ff}.pdoc-code .mi{color:#ae81ff}.pdoc-code .mo{color:#ae81ff}.pdoc-code .sa{color:#e6db74}.pdoc-code .sb{color:#e6db74}.pdoc-code .sc{color:#e6db74}.pdoc-code .dl{color:#e6db74}.pdoc-code .sd{color:#e6db74}.pdoc-code .s2{color:#e6db74}.pdoc-code .se{color:#ae81ff}.pdoc-code .sh{color:#e6db74}.pdoc-code .si{color:#e6db74}.pdoc-code .sx{color:#e6db74}.pdoc-code .sr{color:#e6db74}.pdoc-code .s1{color:#e6db74}.pdoc-code .ss{color:#e6db74}.pdoc-code .bp{color:#f8f8f2}.pdoc-code .fm{color:#a6e22e}.pdoc-code .vc{color:#f8f8f2}.pdoc-code .vg{color:#f8f8f2}.pdoc-code .vi{color:#f8f8f2}.pdoc-code .vm{color:#f8f8f2}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>            
                <ul class="memberlist">
            <li>
                    <a class="class" href="#AdaBoostClassifier">AdaBoostClassifier</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#Base">Base</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#BaseRegressor">BaseRegressor</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#BayesianRVFLRegressor">BayesianRVFLRegressor</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#BayesianRVFL2Regressor">BayesianRVFL2Regressor</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#CustomClassifier">CustomClassifier</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#CustomRegressor">CustomRegressor</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#DeepClassifier">DeepClassifier</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#DeepRegressor">DeepRegressor</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#DeepMTS">DeepMTS</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#Downloader">Downloader</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#GLMClassifier">GLMClassifier</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#GLMRegressor">GLMRegressor</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#LazyClassifier">LazyClassifier</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#LazyRegressor">LazyRegressor</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#LazyMTS">LazyMTS</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#LazyDeepClassifier">LazyDeepClassifier</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#LazyDeepRegressor">LazyDeepRegressor</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#LazyDeepMTS">LazyDeepMTS</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#MTS">MTS</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#MultitaskClassifier">MultitaskClassifier</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#PredictionInterval">PredictionInterval</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#SimpleMultitaskClassifier">SimpleMultitaskClassifier</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#Optimizer">Optimizer</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#RandomBagRegressor">RandomBagRegressor</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#RandomBagClassifier">RandomBagClassifier</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#Ridge2Regressor">Ridge2Regressor</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#Ridge2Classifier">Ridge2Classifier</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#Ridge2MultitaskClassifier">Ridge2MultitaskClassifier</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#SubSampler">SubSampler</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
nnetsauce    </h1>

                
                        <input id="mod-nnetsauce-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-nnetsauce-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="kn">from</span> <span class="nn">.base.base</span> <span class="kn">import</span> <span class="n">Base</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="kn">from</span> <span class="nn">.base.baseRegressor</span> <span class="kn">import</span> <span class="n">BaseRegressor</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="kn">from</span> <span class="nn">.boosting.adaBoostClassifier</span> <span class="kn">import</span> <span class="n">AdaBoostClassifier</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="kn">from</span> <span class="nn">.custom.customClassifier</span> <span class="kn">import</span> <span class="n">CustomClassifier</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="kn">from</span> <span class="nn">.custom.customRegressor</span> <span class="kn">import</span> <span class="n">CustomRegressor</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="kn">from</span> <span class="nn">.datasets</span> <span class="kn">import</span> <span class="n">Downloader</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a><span class="kn">from</span> <span class="nn">.deep.deepClassifier</span> <span class="kn">import</span> <span class="n">DeepClassifier</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="kn">from</span> <span class="nn">.deep.deepRegressor</span> <span class="kn">import</span> <span class="n">DeepRegressor</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a><span class="kn">from</span> <span class="nn">.deep.deepMTS</span> <span class="kn">import</span> <span class="n">DeepMTS</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a><span class="kn">from</span> <span class="nn">.glm.glmClassifier</span> <span class="kn">import</span> <span class="n">GLMClassifier</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a><span class="kn">from</span> <span class="nn">.glm.glmRegressor</span> <span class="kn">import</span> <span class="n">GLMRegressor</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a><span class="kn">from</span> <span class="nn">.lazypredict.lazyClassifier</span> <span class="kn">import</span> <span class="n">LazyClassifier</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a><span class="kn">from</span> <span class="nn">.lazypredict.lazyRegressor</span> <span class="kn">import</span> <span class="n">LazyRegressor</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="kn">from</span> <span class="nn">.lazypredict.lazyMTS</span> <span class="kn">import</span> <span class="n">LazyMTS</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="kn">from</span> <span class="nn">.lazypredict.lazydeepClassifier</span> <span class="kn">import</span> <span class="n">LazyDeepClassifier</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a><span class="kn">from</span> <span class="nn">.lazypredict.lazydeepRegressor</span> <span class="kn">import</span> <span class="n">LazyDeepRegressor</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a><span class="kn">from</span> <span class="nn">.lazypredict.lazydeepMTS</span> <span class="kn">import</span> <span class="n">LazyDeepMTS</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a><span class="kn">from</span> <span class="nn">.mts.mts</span> <span class="kn">import</span> <span class="n">MTS</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a><span class="kn">from</span> <span class="nn">.multitask.multitaskClassifier</span> <span class="kn">import</span> <span class="n">MultitaskClassifier</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a><span class="kn">from</span> <span class="nn">.multitask.simplemultitaskClassifier</span> <span class="kn">import</span> <span class="n">SimpleMultitaskClassifier</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a><span class="kn">from</span> <span class="nn">.optimizers.optimizer</span> <span class="kn">import</span> <span class="n">Optimizer</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a><span class="kn">from</span> <span class="nn">.predictioninterval</span> <span class="kn">import</span> <span class="n">PredictionInterval</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a><span class="kn">from</span> <span class="nn">.randombag.randomBagClassifier</span> <span class="kn">import</span> <span class="n">RandomBagClassifier</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a><span class="kn">from</span> <span class="nn">.randombag.randomBagRegressor</span> <span class="kn">import</span> <span class="n">RandomBagRegressor</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a><span class="kn">from</span> <span class="nn">.ridge2.ridge2Classifier</span> <span class="kn">import</span> <span class="n">Ridge2Classifier</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a><span class="kn">from</span> <span class="nn">.ridge2.ridge2Regressor</span> <span class="kn">import</span> <span class="n">Ridge2Regressor</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a><span class="kn">from</span> <span class="nn">.ridge2.ridge2MultitaskClassifier</span> <span class="kn">import</span> <span class="n">Ridge2MultitaskClassifier</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a><span class="kn">from</span> <span class="nn">.rvfl.bayesianrvflRegressor</span> <span class="kn">import</span> <span class="n">BayesianRVFLRegressor</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a><span class="kn">from</span> <span class="nn">.rvfl.bayesianrvfl2Regressor</span> <span class="kn">import</span> <span class="n">BayesianRVFL2Regressor</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a><span class="kn">from</span> <span class="nn">.sampling</span> <span class="kn">import</span> <span class="n">SubSampler</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>    <span class="s2">&quot;AdaBoostClassifier&quot;</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a>    <span class="s2">&quot;Base&quot;</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a>    <span class="s2">&quot;BaseRegressor&quot;</span><span class="p">,</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a>    <span class="s2">&quot;BayesianRVFLRegressor&quot;</span><span class="p">,</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a>    <span class="s2">&quot;BayesianRVFL2Regressor&quot;</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a>    <span class="s2">&quot;CustomClassifier&quot;</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a>    <span class="s2">&quot;CustomRegressor&quot;</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a>    <span class="s2">&quot;DeepClassifier&quot;</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>    <span class="s2">&quot;DeepRegressor&quot;</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a>    <span class="s2">&quot;DeepMTS&quot;</span><span class="p">,</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a>    <span class="s2">&quot;Downloader&quot;</span><span class="p">,</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>    <span class="s2">&quot;GLMClassifier&quot;</span><span class="p">,</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a>    <span class="s2">&quot;GLMRegressor&quot;</span><span class="p">,</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">46</span></a>    <span class="s2">&quot;LazyClassifier&quot;</span><span class="p">,</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">47</span></a>    <span class="s2">&quot;LazyRegressor&quot;</span><span class="p">,</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">48</span></a>    <span class="s2">&quot;LazyMTS&quot;</span><span class="p">,</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">49</span></a>    <span class="s2">&quot;LazyDeepClassifier&quot;</span><span class="p">,</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">50</span></a>    <span class="s2">&quot;LazyDeepRegressor&quot;</span><span class="p">,</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">51</span></a>    <span class="s2">&quot;LazyDeepMTS&quot;</span><span class="p">,</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">52</span></a>    <span class="s2">&quot;MTS&quot;</span><span class="p">,</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">53</span></a>    <span class="s2">&quot;MultitaskClassifier&quot;</span><span class="p">,</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">54</span></a>    <span class="s2">&quot;PredictionInterval&quot;</span><span class="p">,</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">55</span></a>    <span class="s2">&quot;SimpleMultitaskClassifier&quot;</span><span class="p">,</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">56</span></a>    <span class="s2">&quot;Optimizer&quot;</span><span class="p">,</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">57</span></a>    <span class="s2">&quot;RandomBagRegressor&quot;</span><span class="p">,</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">58</span></a>    <span class="s2">&quot;RandomBagClassifier&quot;</span><span class="p">,</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">59</span></a>    <span class="s2">&quot;Ridge2Regressor&quot;</span><span class="p">,</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">60</span></a>    <span class="s2">&quot;Ridge2Classifier&quot;</span><span class="p">,</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">61</span></a>    <span class="s2">&quot;Ridge2MultitaskClassifier&quot;</span><span class="p">,</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">62</span></a>    <span class="s2">&quot;SubSampler&quot;</span><span class="p">,</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">63</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="AdaBoostClassifier">
                            <input id="AdaBoostClassifier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">AdaBoostClassifier</span><wbr>(<span class="base">nnetsauce.boosting.bst.Boosting</span>, <span class="base">sklearn.base.ClassifierMixin</span>):

                <label class="view-source-button" for="AdaBoostClassifier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdaBoostClassifier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdaBoostClassifier-19"><a href="#AdaBoostClassifier-19"><span class="linenos"> 19</span></a><span class="k">class</span> <span class="nc">AdaBoostClassifier</span><span class="p">(</span><span class="n">Boosting</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">):</span>
</span><span id="AdaBoostClassifier-20"><a href="#AdaBoostClassifier-20"><span class="linenos"> 20</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;AdaBoost Classification (SAMME) model class derived from class Boosting</span>
</span><span id="AdaBoostClassifier-21"><a href="#AdaBoostClassifier-21"><span class="linenos"> 21</span></a>
</span><span id="AdaBoostClassifier-22"><a href="#AdaBoostClassifier-22"><span class="linenos"> 22</span></a><span class="sd">    Parameters:</span>
</span><span id="AdaBoostClassifier-23"><a href="#AdaBoostClassifier-23"><span class="linenos"> 23</span></a>
</span><span id="AdaBoostClassifier-24"><a href="#AdaBoostClassifier-24"><span class="linenos"> 24</span></a><span class="sd">        obj: object</span>
</span><span id="AdaBoostClassifier-25"><a href="#AdaBoostClassifier-25"><span class="linenos"> 25</span></a><span class="sd">            any object containing a method fit (obj.fit()) and a method predict</span>
</span><span id="AdaBoostClassifier-26"><a href="#AdaBoostClassifier-26"><span class="linenos"> 26</span></a><span class="sd">            (obj.predict())</span>
</span><span id="AdaBoostClassifier-27"><a href="#AdaBoostClassifier-27"><span class="linenos"> 27</span></a>
</span><span id="AdaBoostClassifier-28"><a href="#AdaBoostClassifier-28"><span class="linenos"> 28</span></a><span class="sd">        n_estimators: int</span>
</span><span id="AdaBoostClassifier-29"><a href="#AdaBoostClassifier-29"><span class="linenos"> 29</span></a><span class="sd">            number of boosting iterations</span>
</span><span id="AdaBoostClassifier-30"><a href="#AdaBoostClassifier-30"><span class="linenos"> 30</span></a>
</span><span id="AdaBoostClassifier-31"><a href="#AdaBoostClassifier-31"><span class="linenos"> 31</span></a><span class="sd">        learning_rate: float</span>
</span><span id="AdaBoostClassifier-32"><a href="#AdaBoostClassifier-32"><span class="linenos"> 32</span></a><span class="sd">            learning rate of the boosting procedure</span>
</span><span id="AdaBoostClassifier-33"><a href="#AdaBoostClassifier-33"><span class="linenos"> 33</span></a>
</span><span id="AdaBoostClassifier-34"><a href="#AdaBoostClassifier-34"><span class="linenos"> 34</span></a><span class="sd">        n_hidden_features: int</span>
</span><span id="AdaBoostClassifier-35"><a href="#AdaBoostClassifier-35"><span class="linenos"> 35</span></a><span class="sd">            number of nodes in the hidden layer</span>
</span><span id="AdaBoostClassifier-36"><a href="#AdaBoostClassifier-36"><span class="linenos"> 36</span></a>
</span><span id="AdaBoostClassifier-37"><a href="#AdaBoostClassifier-37"><span class="linenos"> 37</span></a><span class="sd">        reg_lambda: float</span>
</span><span id="AdaBoostClassifier-38"><a href="#AdaBoostClassifier-38"><span class="linenos"> 38</span></a><span class="sd">            regularization parameter for weights</span>
</span><span id="AdaBoostClassifier-39"><a href="#AdaBoostClassifier-39"><span class="linenos"> 39</span></a>
</span><span id="AdaBoostClassifier-40"><a href="#AdaBoostClassifier-40"><span class="linenos"> 40</span></a><span class="sd">        reg_alpha: float</span>
</span><span id="AdaBoostClassifier-41"><a href="#AdaBoostClassifier-41"><span class="linenos"> 41</span></a><span class="sd">            controls compromize between l1 and l2 norm of weights</span>
</span><span id="AdaBoostClassifier-42"><a href="#AdaBoostClassifier-42"><span class="linenos"> 42</span></a>
</span><span id="AdaBoostClassifier-43"><a href="#AdaBoostClassifier-43"><span class="linenos"> 43</span></a><span class="sd">        activation_name: str</span>
</span><span id="AdaBoostClassifier-44"><a href="#AdaBoostClassifier-44"><span class="linenos"> 44</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;</span>
</span><span id="AdaBoostClassifier-45"><a href="#AdaBoostClassifier-45"><span class="linenos"> 45</span></a>
</span><span id="AdaBoostClassifier-46"><a href="#AdaBoostClassifier-46"><span class="linenos"> 46</span></a><span class="sd">        a: float</span>
</span><span id="AdaBoostClassifier-47"><a href="#AdaBoostClassifier-47"><span class="linenos"> 47</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function</span>
</span><span id="AdaBoostClassifier-48"><a href="#AdaBoostClassifier-48"><span class="linenos"> 48</span></a>
</span><span id="AdaBoostClassifier-49"><a href="#AdaBoostClassifier-49"><span class="linenos"> 49</span></a><span class="sd">        nodes_sim: str</span>
</span><span id="AdaBoostClassifier-50"><a href="#AdaBoostClassifier-50"><span class="linenos"> 50</span></a><span class="sd">            type of simulation for the nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;,</span>
</span><span id="AdaBoostClassifier-51"><a href="#AdaBoostClassifier-51"><span class="linenos"> 51</span></a><span class="sd">            &#39;uniform&#39;</span>
</span><span id="AdaBoostClassifier-52"><a href="#AdaBoostClassifier-52"><span class="linenos"> 52</span></a>
</span><span id="AdaBoostClassifier-53"><a href="#AdaBoostClassifier-53"><span class="linenos"> 53</span></a><span class="sd">        bias: boolean</span>
</span><span id="AdaBoostClassifier-54"><a href="#AdaBoostClassifier-54"><span class="linenos"> 54</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or not</span>
</span><span id="AdaBoostClassifier-55"><a href="#AdaBoostClassifier-55"><span class="linenos"> 55</span></a><span class="sd">            (False)</span>
</span><span id="AdaBoostClassifier-56"><a href="#AdaBoostClassifier-56"><span class="linenos"> 56</span></a>
</span><span id="AdaBoostClassifier-57"><a href="#AdaBoostClassifier-57"><span class="linenos"> 57</span></a><span class="sd">        dropout: float</span>
</span><span id="AdaBoostClassifier-58"><a href="#AdaBoostClassifier-58"><span class="linenos"> 58</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="AdaBoostClassifier-59"><a href="#AdaBoostClassifier-59"><span class="linenos"> 59</span></a><span class="sd">            of the training</span>
</span><span id="AdaBoostClassifier-60"><a href="#AdaBoostClassifier-60"><span class="linenos"> 60</span></a>
</span><span id="AdaBoostClassifier-61"><a href="#AdaBoostClassifier-61"><span class="linenos"> 61</span></a><span class="sd">        direct_link: boolean</span>
</span><span id="AdaBoostClassifier-62"><a href="#AdaBoostClassifier-62"><span class="linenos"> 62</span></a><span class="sd">            indicates if the original predictors are included (True) in model&#39;s</span>
</span><span id="AdaBoostClassifier-63"><a href="#AdaBoostClassifier-63"><span class="linenos"> 63</span></a><span class="sd">            fitting or not (False)</span>
</span><span id="AdaBoostClassifier-64"><a href="#AdaBoostClassifier-64"><span class="linenos"> 64</span></a>
</span><span id="AdaBoostClassifier-65"><a href="#AdaBoostClassifier-65"><span class="linenos"> 65</span></a><span class="sd">        n_clusters: int</span>
</span><span id="AdaBoostClassifier-66"><a href="#AdaBoostClassifier-66"><span class="linenos"> 66</span></a><span class="sd">            number of clusters for &#39;kmeans&#39; or &#39;gmm&#39; clustering (could be 0:</span>
</span><span id="AdaBoostClassifier-67"><a href="#AdaBoostClassifier-67"><span class="linenos"> 67</span></a><span class="sd">                no clustering)</span>
</span><span id="AdaBoostClassifier-68"><a href="#AdaBoostClassifier-68"><span class="linenos"> 68</span></a>
</span><span id="AdaBoostClassifier-69"><a href="#AdaBoostClassifier-69"><span class="linenos"> 69</span></a><span class="sd">        cluster_encode: bool</span>
</span><span id="AdaBoostClassifier-70"><a href="#AdaBoostClassifier-70"><span class="linenos"> 70</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot)</span>
</span><span id="AdaBoostClassifier-71"><a href="#AdaBoostClassifier-71"><span class="linenos"> 71</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding</span>
</span><span id="AdaBoostClassifier-72"><a href="#AdaBoostClassifier-72"><span class="linenos"> 72</span></a>
</span><span id="AdaBoostClassifier-73"><a href="#AdaBoostClassifier-73"><span class="linenos"> 73</span></a><span class="sd">        type_clust: str</span>
</span><span id="AdaBoostClassifier-74"><a href="#AdaBoostClassifier-74"><span class="linenos"> 74</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian</span>
</span><span id="AdaBoostClassifier-75"><a href="#AdaBoostClassifier-75"><span class="linenos"> 75</span></a><span class="sd">            Mixture Model (&#39;gmm&#39;)</span>
</span><span id="AdaBoostClassifier-76"><a href="#AdaBoostClassifier-76"><span class="linenos"> 76</span></a>
</span><span id="AdaBoostClassifier-77"><a href="#AdaBoostClassifier-77"><span class="linenos"> 77</span></a><span class="sd">        type_scaling: a tuple of 3 strings</span>
</span><span id="AdaBoostClassifier-78"><a href="#AdaBoostClassifier-78"><span class="linenos"> 78</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="AdaBoostClassifier-79"><a href="#AdaBoostClassifier-79"><span class="linenos"> 79</span></a><span class="sd">            (and when relevant).</span>
</span><span id="AdaBoostClassifier-80"><a href="#AdaBoostClassifier-80"><span class="linenos"> 80</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;)</span>
</span><span id="AdaBoostClassifier-81"><a href="#AdaBoostClassifier-81"><span class="linenos"> 81</span></a>
</span><span id="AdaBoostClassifier-82"><a href="#AdaBoostClassifier-82"><span class="linenos"> 82</span></a><span class="sd">        col_sample: float</span>
</span><span id="AdaBoostClassifier-83"><a href="#AdaBoostClassifier-83"><span class="linenos"> 83</span></a><span class="sd">            percentage of covariates randomly chosen for training</span>
</span><span id="AdaBoostClassifier-84"><a href="#AdaBoostClassifier-84"><span class="linenos"> 84</span></a>
</span><span id="AdaBoostClassifier-85"><a href="#AdaBoostClassifier-85"><span class="linenos"> 85</span></a><span class="sd">        row_sample: float</span>
</span><span id="AdaBoostClassifier-86"><a href="#AdaBoostClassifier-86"><span class="linenos"> 86</span></a><span class="sd">            percentage of rows chosen for training, by stratified bootstrapping</span>
</span><span id="AdaBoostClassifier-87"><a href="#AdaBoostClassifier-87"><span class="linenos"> 87</span></a>
</span><span id="AdaBoostClassifier-88"><a href="#AdaBoostClassifier-88"><span class="linenos"> 88</span></a><span class="sd">        seed: int</span>
</span><span id="AdaBoostClassifier-89"><a href="#AdaBoostClassifier-89"><span class="linenos"> 89</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39;</span>
</span><span id="AdaBoostClassifier-90"><a href="#AdaBoostClassifier-90"><span class="linenos"> 90</span></a>
</span><span id="AdaBoostClassifier-91"><a href="#AdaBoostClassifier-91"><span class="linenos"> 91</span></a><span class="sd">        verbose: int</span>
</span><span id="AdaBoostClassifier-92"><a href="#AdaBoostClassifier-92"><span class="linenos"> 92</span></a><span class="sd">            0 for no output, 1 for a progress bar (default is 1)</span>
</span><span id="AdaBoostClassifier-93"><a href="#AdaBoostClassifier-93"><span class="linenos"> 93</span></a>
</span><span id="AdaBoostClassifier-94"><a href="#AdaBoostClassifier-94"><span class="linenos"> 94</span></a><span class="sd">        method: str</span>
</span><span id="AdaBoostClassifier-95"><a href="#AdaBoostClassifier-95"><span class="linenos"> 95</span></a><span class="sd">            type of Adaboost method, &#39;SAMME&#39; (discrete) or &#39;SAMME.R&#39; (real)</span>
</span><span id="AdaBoostClassifier-96"><a href="#AdaBoostClassifier-96"><span class="linenos"> 96</span></a>
</span><span id="AdaBoostClassifier-97"><a href="#AdaBoostClassifier-97"><span class="linenos"> 97</span></a><span class="sd">        backend: str</span>
</span><span id="AdaBoostClassifier-98"><a href="#AdaBoostClassifier-98"><span class="linenos"> 98</span></a><span class="sd">            &quot;cpu&quot; or &quot;gpu&quot; or &quot;tpu&quot;</span>
</span><span id="AdaBoostClassifier-99"><a href="#AdaBoostClassifier-99"><span class="linenos"> 99</span></a>
</span><span id="AdaBoostClassifier-100"><a href="#AdaBoostClassifier-100"><span class="linenos">100</span></a><span class="sd">    Attributes:</span>
</span><span id="AdaBoostClassifier-101"><a href="#AdaBoostClassifier-101"><span class="linenos">101</span></a>
</span><span id="AdaBoostClassifier-102"><a href="#AdaBoostClassifier-102"><span class="linenos">102</span></a><span class="sd">        alpha_: list</span>
</span><span id="AdaBoostClassifier-103"><a href="#AdaBoostClassifier-103"><span class="linenos">103</span></a><span class="sd">            AdaBoost coefficients alpha_m</span>
</span><span id="AdaBoostClassifier-104"><a href="#AdaBoostClassifier-104"><span class="linenos">104</span></a>
</span><span id="AdaBoostClassifier-105"><a href="#AdaBoostClassifier-105"><span class="linenos">105</span></a><span class="sd">        base_learners_: dict</span>
</span><span id="AdaBoostClassifier-106"><a href="#AdaBoostClassifier-106"><span class="linenos">106</span></a><span class="sd">            a dictionary containing the base learners</span>
</span><span id="AdaBoostClassifier-107"><a href="#AdaBoostClassifier-107"><span class="linenos">107</span></a>
</span><span id="AdaBoostClassifier-108"><a href="#AdaBoostClassifier-108"><span class="linenos">108</span></a><span class="sd">    Examples:</span>
</span><span id="AdaBoostClassifier-109"><a href="#AdaBoostClassifier-109"><span class="linenos">109</span></a>
</span><span id="AdaBoostClassifier-110"><a href="#AdaBoostClassifier-110"><span class="linenos">110</span></a><span class="sd">    See also [https://github.com/Techtonique/nnetsauce/blob/master/examples/adaboost_classification.py](https://github.com/Techtonique/nnetsauce/blob/master/examples/adaboost_classification.py)</span>
</span><span id="AdaBoostClassifier-111"><a href="#AdaBoostClassifier-111"><span class="linenos">111</span></a>
</span><span id="AdaBoostClassifier-112"><a href="#AdaBoostClassifier-112"><span class="linenos">112</span></a><span class="sd">    ```python</span>
</span><span id="AdaBoostClassifier-113"><a href="#AdaBoostClassifier-113"><span class="linenos">113</span></a><span class="sd">    import nnetsauce as ns</span>
</span><span id="AdaBoostClassifier-114"><a href="#AdaBoostClassifier-114"><span class="linenos">114</span></a><span class="sd">    import numpy as np</span>
</span><span id="AdaBoostClassifier-115"><a href="#AdaBoostClassifier-115"><span class="linenos">115</span></a><span class="sd">    from sklearn.datasets import load_breast_cancer</span>
</span><span id="AdaBoostClassifier-116"><a href="#AdaBoostClassifier-116"><span class="linenos">116</span></a><span class="sd">    from sklearn.linear_model import LogisticRegression</span>
</span><span id="AdaBoostClassifier-117"><a href="#AdaBoostClassifier-117"><span class="linenos">117</span></a><span class="sd">    from sklearn.model_selection import train_test_split</span>
</span><span id="AdaBoostClassifier-118"><a href="#AdaBoostClassifier-118"><span class="linenos">118</span></a><span class="sd">    from sklearn import metrics</span>
</span><span id="AdaBoostClassifier-119"><a href="#AdaBoostClassifier-119"><span class="linenos">119</span></a><span class="sd">    from time import time</span>
</span><span id="AdaBoostClassifier-120"><a href="#AdaBoostClassifier-120"><span class="linenos">120</span></a>
</span><span id="AdaBoostClassifier-121"><a href="#AdaBoostClassifier-121"><span class="linenos">121</span></a><span class="sd">    breast_cancer = load_breast_cancer()</span>
</span><span id="AdaBoostClassifier-122"><a href="#AdaBoostClassifier-122"><span class="linenos">122</span></a><span class="sd">    Z = breast_cancer.data</span>
</span><span id="AdaBoostClassifier-123"><a href="#AdaBoostClassifier-123"><span class="linenos">123</span></a><span class="sd">    t = breast_cancer.target</span>
</span><span id="AdaBoostClassifier-124"><a href="#AdaBoostClassifier-124"><span class="linenos">124</span></a><span class="sd">    np.random.seed(123)</span>
</span><span id="AdaBoostClassifier-125"><a href="#AdaBoostClassifier-125"><span class="linenos">125</span></a><span class="sd">    X_train, X_test, y_train, y_test = train_test_split(Z, t, test_size=0.2)</span>
</span><span id="AdaBoostClassifier-126"><a href="#AdaBoostClassifier-126"><span class="linenos">126</span></a>
</span><span id="AdaBoostClassifier-127"><a href="#AdaBoostClassifier-127"><span class="linenos">127</span></a><span class="sd">    # SAMME.R</span>
</span><span id="AdaBoostClassifier-128"><a href="#AdaBoostClassifier-128"><span class="linenos">128</span></a><span class="sd">    clf = LogisticRegression(solver=&#39;liblinear&#39;, multi_class = &#39;ovr&#39;,</span>
</span><span id="AdaBoostClassifier-129"><a href="#AdaBoostClassifier-129"><span class="linenos">129</span></a><span class="sd">                            random_state=123)</span>
</span><span id="AdaBoostClassifier-130"><a href="#AdaBoostClassifier-130"><span class="linenos">130</span></a><span class="sd">    fit_obj = ns.AdaBoostClassifier(clf,</span>
</span><span id="AdaBoostClassifier-131"><a href="#AdaBoostClassifier-131"><span class="linenos">131</span></a><span class="sd">                                    n_hidden_features=int(11.22338867),</span>
</span><span id="AdaBoostClassifier-132"><a href="#AdaBoostClassifier-132"><span class="linenos">132</span></a><span class="sd">                                    direct_link=True,</span>
</span><span id="AdaBoostClassifier-133"><a href="#AdaBoostClassifier-133"><span class="linenos">133</span></a><span class="sd">                                    n_estimators=250, learning_rate=0.01126343,</span>
</span><span id="AdaBoostClassifier-134"><a href="#AdaBoostClassifier-134"><span class="linenos">134</span></a><span class="sd">                                    col_sample=0.72684326, row_sample=0.86429443,</span>
</span><span id="AdaBoostClassifier-135"><a href="#AdaBoostClassifier-135"><span class="linenos">135</span></a><span class="sd">                                    dropout=0.63078613, n_clusters=2,</span>
</span><span id="AdaBoostClassifier-136"><a href="#AdaBoostClassifier-136"><span class="linenos">136</span></a><span class="sd">                                    type_clust=&quot;gmm&quot;,</span>
</span><span id="AdaBoostClassifier-137"><a href="#AdaBoostClassifier-137"><span class="linenos">137</span></a><span class="sd">                                    verbose=1, seed = 123,</span>
</span><span id="AdaBoostClassifier-138"><a href="#AdaBoostClassifier-138"><span class="linenos">138</span></a><span class="sd">                                    method=&quot;SAMME.R&quot;)</span>
</span><span id="AdaBoostClassifier-139"><a href="#AdaBoostClassifier-139"><span class="linenos">139</span></a>
</span><span id="AdaBoostClassifier-140"><a href="#AdaBoostClassifier-140"><span class="linenos">140</span></a><span class="sd">    start = time()</span>
</span><span id="AdaBoostClassifier-141"><a href="#AdaBoostClassifier-141"><span class="linenos">141</span></a><span class="sd">    fit_obj.fit(X_train, y_train)</span>
</span><span id="AdaBoostClassifier-142"><a href="#AdaBoostClassifier-142"><span class="linenos">142</span></a><span class="sd">    print(f&quot;Elapsed {time() - start}&quot;)</span>
</span><span id="AdaBoostClassifier-143"><a href="#AdaBoostClassifier-143"><span class="linenos">143</span></a>
</span><span id="AdaBoostClassifier-144"><a href="#AdaBoostClassifier-144"><span class="linenos">144</span></a><span class="sd">    start = time()</span>
</span><span id="AdaBoostClassifier-145"><a href="#AdaBoostClassifier-145"><span class="linenos">145</span></a><span class="sd">    print(fit_obj.score(X_test, y_test))</span>
</span><span id="AdaBoostClassifier-146"><a href="#AdaBoostClassifier-146"><span class="linenos">146</span></a><span class="sd">    print(f&quot;Elapsed {time() - start}&quot;)</span>
</span><span id="AdaBoostClassifier-147"><a href="#AdaBoostClassifier-147"><span class="linenos">147</span></a>
</span><span id="AdaBoostClassifier-148"><a href="#AdaBoostClassifier-148"><span class="linenos">148</span></a><span class="sd">    preds = fit_obj.predict(X_test)</span>
</span><span id="AdaBoostClassifier-149"><a href="#AdaBoostClassifier-149"><span class="linenos">149</span></a>
</span><span id="AdaBoostClassifier-150"><a href="#AdaBoostClassifier-150"><span class="linenos">150</span></a><span class="sd">    print(fit_obj.score(X_test, y_test, scoring=&quot;roc_auc&quot;))</span>
</span><span id="AdaBoostClassifier-151"><a href="#AdaBoostClassifier-151"><span class="linenos">151</span></a><span class="sd">    print(metrics.classification_report(preds, y_test))</span>
</span><span id="AdaBoostClassifier-152"><a href="#AdaBoostClassifier-152"><span class="linenos">152</span></a>
</span><span id="AdaBoostClassifier-153"><a href="#AdaBoostClassifier-153"><span class="linenos">153</span></a><span class="sd">    ```</span>
</span><span id="AdaBoostClassifier-154"><a href="#AdaBoostClassifier-154"><span class="linenos">154</span></a>
</span><span id="AdaBoostClassifier-155"><a href="#AdaBoostClassifier-155"><span class="linenos">155</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="AdaBoostClassifier-156"><a href="#AdaBoostClassifier-156"><span class="linenos">156</span></a>
</span><span id="AdaBoostClassifier-157"><a href="#AdaBoostClassifier-157"><span class="linenos">157</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="AdaBoostClassifier-158"><a href="#AdaBoostClassifier-158"><span class="linenos">158</span></a>
</span><span id="AdaBoostClassifier-159"><a href="#AdaBoostClassifier-159"><span class="linenos">159</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="AdaBoostClassifier-160"><a href="#AdaBoostClassifier-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-161"><a href="#AdaBoostClassifier-161"><span class="linenos">161</span></a>        <span class="n">obj</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-162"><a href="#AdaBoostClassifier-162"><span class="linenos">162</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-163"><a href="#AdaBoostClassifier-163"><span class="linenos">163</span></a>        <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-164"><a href="#AdaBoostClassifier-164"><span class="linenos">164</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-165"><a href="#AdaBoostClassifier-165"><span class="linenos">165</span></a>        <span class="n">reg_lambda</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-166"><a href="#AdaBoostClassifier-166"><span class="linenos">166</span></a>        <span class="n">reg_alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-167"><a href="#AdaBoostClassifier-167"><span class="linenos">167</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-168"><a href="#AdaBoostClassifier-168"><span class="linenos">168</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-169"><a href="#AdaBoostClassifier-169"><span class="linenos">169</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-170"><a href="#AdaBoostClassifier-170"><span class="linenos">170</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-171"><a href="#AdaBoostClassifier-171"><span class="linenos">171</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-172"><a href="#AdaBoostClassifier-172"><span class="linenos">172</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-173"><a href="#AdaBoostClassifier-173"><span class="linenos">173</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-174"><a href="#AdaBoostClassifier-174"><span class="linenos">174</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-175"><a href="#AdaBoostClassifier-175"><span class="linenos">175</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-176"><a href="#AdaBoostClassifier-176"><span class="linenos">176</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="AdaBoostClassifier-177"><a href="#AdaBoostClassifier-177"><span class="linenos">177</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-178"><a href="#AdaBoostClassifier-178"><span class="linenos">178</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-179"><a href="#AdaBoostClassifier-179"><span class="linenos">179</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-180"><a href="#AdaBoostClassifier-180"><span class="linenos">180</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-181"><a href="#AdaBoostClassifier-181"><span class="linenos">181</span></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;SAMME&quot;</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-182"><a href="#AdaBoostClassifier-182"><span class="linenos">182</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-183"><a href="#AdaBoostClassifier-183"><span class="linenos">183</span></a>    <span class="p">):</span>
</span><span id="AdaBoostClassifier-184"><a href="#AdaBoostClassifier-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_fit</span> <span class="o">=</span> <span class="s2">&quot;classification&quot;</span>
</span><span id="AdaBoostClassifier-185"><a href="#AdaBoostClassifier-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="AdaBoostClassifier-186"><a href="#AdaBoostClassifier-186"><span class="linenos">186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
</span><span id="AdaBoostClassifier-187"><a href="#AdaBoostClassifier-187"><span class="linenos">187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reg_lambda</span> <span class="o">=</span> <span class="n">reg_lambda</span>
</span><span id="AdaBoostClassifier-188"><a href="#AdaBoostClassifier-188"><span class="linenos">188</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reg_alpha</span> <span class="o">=</span> <span class="n">reg_alpha</span>
</span><span id="AdaBoostClassifier-189"><a href="#AdaBoostClassifier-189"><span class="linenos">189</span></a>
</span><span id="AdaBoostClassifier-190"><a href="#AdaBoostClassifier-190"><span class="linenos">190</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="AdaBoostClassifier-191"><a href="#AdaBoostClassifier-191"><span class="linenos">191</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-192"><a href="#AdaBoostClassifier-192"><span class="linenos">192</span></a>            <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-193"><a href="#AdaBoostClassifier-193"><span class="linenos">193</span></a>            <span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-194"><a href="#AdaBoostClassifier-194"><span class="linenos">194</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-195"><a href="#AdaBoostClassifier-195"><span class="linenos">195</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-196"><a href="#AdaBoostClassifier-196"><span class="linenos">196</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-197"><a href="#AdaBoostClassifier-197"><span class="linenos">197</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-198"><a href="#AdaBoostClassifier-198"><span class="linenos">198</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-199"><a href="#AdaBoostClassifier-199"><span class="linenos">199</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-200"><a href="#AdaBoostClassifier-200"><span class="linenos">200</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-201"><a href="#AdaBoostClassifier-201"><span class="linenos">201</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-202"><a href="#AdaBoostClassifier-202"><span class="linenos">202</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-203"><a href="#AdaBoostClassifier-203"><span class="linenos">203</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-204"><a href="#AdaBoostClassifier-204"><span class="linenos">204</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-205"><a href="#AdaBoostClassifier-205"><span class="linenos">205</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-206"><a href="#AdaBoostClassifier-206"><span class="linenos">206</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-207"><a href="#AdaBoostClassifier-207"><span class="linenos">207</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-208"><a href="#AdaBoostClassifier-208"><span class="linenos">208</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-209"><a href="#AdaBoostClassifier-209"><span class="linenos">209</span></a>        <span class="p">)</span>
</span><span id="AdaBoostClassifier-210"><a href="#AdaBoostClassifier-210"><span class="linenos">210</span></a>
</span><span id="AdaBoostClassifier-211"><a href="#AdaBoostClassifier-211"><span class="linenos">211</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="AdaBoostClassifier-212"><a href="#AdaBoostClassifier-212"><span class="linenos">212</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_learners_</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_estimators</span><span class="p">))</span>
</span><span id="AdaBoostClassifier-213"><a href="#AdaBoostClassifier-213"><span class="linenos">213</span></a>
</span><span id="AdaBoostClassifier-214"><a href="#AdaBoostClassifier-214"><span class="linenos">214</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="AdaBoostClassifier-215"><a href="#AdaBoostClassifier-215"><span class="linenos">215</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Boosting model to training data (X, y).</span>
</span><span id="AdaBoostClassifier-216"><a href="#AdaBoostClassifier-216"><span class="linenos">216</span></a>
</span><span id="AdaBoostClassifier-217"><a href="#AdaBoostClassifier-217"><span class="linenos">217</span></a><span class="sd">        Parameters:</span>
</span><span id="AdaBoostClassifier-218"><a href="#AdaBoostClassifier-218"><span class="linenos">218</span></a>
</span><span id="AdaBoostClassifier-219"><a href="#AdaBoostClassifier-219"><span class="linenos">219</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="AdaBoostClassifier-220"><a href="#AdaBoostClassifier-220"><span class="linenos">220</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="AdaBoostClassifier-221"><a href="#AdaBoostClassifier-221"><span class="linenos">221</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="AdaBoostClassifier-222"><a href="#AdaBoostClassifier-222"><span class="linenos">222</span></a>
</span><span id="AdaBoostClassifier-223"><a href="#AdaBoostClassifier-223"><span class="linenos">223</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="AdaBoostClassifier-224"><a href="#AdaBoostClassifier-224"><span class="linenos">224</span></a><span class="sd">                Target values.</span>
</span><span id="AdaBoostClassifier-225"><a href="#AdaBoostClassifier-225"><span class="linenos">225</span></a>
</span><span id="AdaBoostClassifier-226"><a href="#AdaBoostClassifier-226"><span class="linenos">226</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="AdaBoostClassifier-227"><a href="#AdaBoostClassifier-227"><span class="linenos">227</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="AdaBoostClassifier-228"><a href="#AdaBoostClassifier-228"><span class="linenos">228</span></a>
</span><span id="AdaBoostClassifier-229"><a href="#AdaBoostClassifier-229"><span class="linenos">229</span></a><span class="sd">        Returns:</span>
</span><span id="AdaBoostClassifier-230"><a href="#AdaBoostClassifier-230"><span class="linenos">230</span></a>
</span><span id="AdaBoostClassifier-231"><a href="#AdaBoostClassifier-231"><span class="linenos">231</span></a><span class="sd">             self: object</span>
</span><span id="AdaBoostClassifier-232"><a href="#AdaBoostClassifier-232"><span class="linenos">232</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdaBoostClassifier-233"><a href="#AdaBoostClassifier-233"><span class="linenos">233</span></a>
</span><span id="AdaBoostClassifier-234"><a href="#AdaBoostClassifier-234"><span class="linenos">234</span></a>        <span class="k">assert</span> <span class="n">mx</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s2">&quot;y must contain only integers&quot;</span>
</span><span id="AdaBoostClassifier-235"><a href="#AdaBoostClassifier-235"><span class="linenos">235</span></a>
</span><span id="AdaBoostClassifier-236"><a href="#AdaBoostClassifier-236"><span class="linenos">236</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="AdaBoostClassifier-237"><a href="#AdaBoostClassifier-237"><span class="linenos">237</span></a>            <span class="s2">&quot;SAMME&quot;</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-238"><a href="#AdaBoostClassifier-238"><span class="linenos">238</span></a>            <span class="s2">&quot;SAMME.R&quot;</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-239"><a href="#AdaBoostClassifier-239"><span class="linenos">239</span></a>        <span class="p">),</span> <span class="s2">&quot;`method` must be either &#39;SAMME&#39; or &#39;SAMME.R&#39;&quot;</span>
</span><span id="AdaBoostClassifier-240"><a href="#AdaBoostClassifier-240"><span class="linenos">240</span></a>
</span><span id="AdaBoostClassifier-241"><a href="#AdaBoostClassifier-241"><span class="linenos">241</span></a>        <span class="k">assert</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reg_lambda</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
</span><span id="AdaBoostClassifier-242"><a href="#AdaBoostClassifier-242"><span class="linenos">242</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reg_lambda</span> <span class="o">&gt;=</span> <span class="mi">0</span>
</span><span id="AdaBoostClassifier-243"><a href="#AdaBoostClassifier-243"><span class="linenos">243</span></a>        <span class="p">),</span> <span class="s2">&quot;must have self.reg_lambda &lt;= 1 &amp;  self.reg_lambda &gt;= 0&quot;</span>
</span><span id="AdaBoostClassifier-244"><a href="#AdaBoostClassifier-244"><span class="linenos">244</span></a>
</span><span id="AdaBoostClassifier-245"><a href="#AdaBoostClassifier-245"><span class="linenos">245</span></a>        <span class="k">assert</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reg_alpha</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
</span><span id="AdaBoostClassifier-246"><a href="#AdaBoostClassifier-246"><span class="linenos">246</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reg_alpha</span> <span class="o">&gt;=</span> <span class="mi">0</span>
</span><span id="AdaBoostClassifier-247"><a href="#AdaBoostClassifier-247"><span class="linenos">247</span></a>        <span class="p">),</span> <span class="s2">&quot;must have self.reg_alpha &lt;= 1 &amp;  self.reg_alpha &gt;= 0&quot;</span>
</span><span id="AdaBoostClassifier-248"><a href="#AdaBoostClassifier-248"><span class="linenos">248</span></a>
</span><span id="AdaBoostClassifier-249"><a href="#AdaBoostClassifier-249"><span class="linenos">249</span></a>        <span class="c1"># training</span>
</span><span id="AdaBoostClassifier-250"><a href="#AdaBoostClassifier-250"><span class="linenos">250</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="AdaBoostClassifier-251"><a href="#AdaBoostClassifier-251"><span class="linenos">251</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="AdaBoostClassifier-252"><a href="#AdaBoostClassifier-252"><span class="linenos">252</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="AdaBoostClassifier-253"><a href="#AdaBoostClassifier-253"><span class="linenos">253</span></a>
</span><span id="AdaBoostClassifier-254"><a href="#AdaBoostClassifier-254"><span class="linenos">254</span></a>        <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AdaBoostClassifier-255"><a href="#AdaBoostClassifier-255"><span class="linenos">255</span></a>            <span class="n">w_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-256"><a href="#AdaBoostClassifier-256"><span class="linenos">256</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AdaBoostClassifier-257"><a href="#AdaBoostClassifier-257"><span class="linenos">257</span></a>            <span class="n">w_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-258"><a href="#AdaBoostClassifier-258"><span class="linenos">258</span></a>
</span><span id="AdaBoostClassifier-259"><a href="#AdaBoostClassifier-259"><span class="linenos">259</span></a>        <span class="n">base_learner</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="AdaBoostClassifier-260"><a href="#AdaBoostClassifier-260"><span class="linenos">260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-261"><a href="#AdaBoostClassifier-261"><span class="linenos">261</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-262"><a href="#AdaBoostClassifier-262"><span class="linenos">262</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-263"><a href="#AdaBoostClassifier-263"><span class="linenos">263</span></a>            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-264"><a href="#AdaBoostClassifier-264"><span class="linenos">264</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-265"><a href="#AdaBoostClassifier-265"><span class="linenos">265</span></a>            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-266"><a href="#AdaBoostClassifier-266"><span class="linenos">266</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-267"><a href="#AdaBoostClassifier-267"><span class="linenos">267</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-268"><a href="#AdaBoostClassifier-268"><span class="linenos">268</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-269"><a href="#AdaBoostClassifier-269"><span class="linenos">269</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-270"><a href="#AdaBoostClassifier-270"><span class="linenos">270</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-271"><a href="#AdaBoostClassifier-271"><span class="linenos">271</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-272"><a href="#AdaBoostClassifier-272"><span class="linenos">272</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-273"><a href="#AdaBoostClassifier-273"><span class="linenos">273</span></a>            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-274"><a href="#AdaBoostClassifier-274"><span class="linenos">274</span></a>        <span class="p">)</span>
</span><span id="AdaBoostClassifier-275"><a href="#AdaBoostClassifier-275"><span class="linenos">275</span></a>
</span><span id="AdaBoostClassifier-276"><a href="#AdaBoostClassifier-276"><span class="linenos">276</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AdaBoostClassifier-277"><a href="#AdaBoostClassifier-277"><span class="linenos">277</span></a>            <span class="n">pbar</span> <span class="o">=</span> <span class="n">Progbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-278"><a href="#AdaBoostClassifier-278"><span class="linenos">278</span></a>
</span><span id="AdaBoostClassifier-279"><a href="#AdaBoostClassifier-279"><span class="linenos">279</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;SAMME&quot;</span><span class="p">:</span>
</span><span id="AdaBoostClassifier-280"><a href="#AdaBoostClassifier-280"><span class="linenos">280</span></a>            <span class="n">err_m</span> <span class="o">=</span> <span class="mf">1e6</span>
</span><span id="AdaBoostClassifier-281"><a href="#AdaBoostClassifier-281"><span class="linenos">281</span></a>            <span class="n">err_bound</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span>
</span><span id="AdaBoostClassifier-282"><a href="#AdaBoostClassifier-282"><span class="linenos">282</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-283"><a href="#AdaBoostClassifier-283"><span class="linenos">283</span></a>            <span class="n">x_range_n</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-284"><a href="#AdaBoostClassifier-284"><span class="linenos">284</span></a>
</span><span id="AdaBoostClassifier-285"><a href="#AdaBoostClassifier-285"><span class="linenos">285</span></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="AdaBoostClassifier-286"><a href="#AdaBoostClassifier-286"><span class="linenos">286</span></a>                <span class="n">preds</span> <span class="o">=</span> <span class="n">base_learner</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="AdaBoostClassifier-287"><a href="#AdaBoostClassifier-287"><span class="linenos">287</span></a>                    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">w_m</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="AdaBoostClassifier-288"><a href="#AdaBoostClassifier-288"><span class="linenos">288</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-289"><a href="#AdaBoostClassifier-289"><span class="linenos">289</span></a>
</span><span id="AdaBoostClassifier-290"><a href="#AdaBoostClassifier-290"><span class="linenos">290</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">base_learners_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="AdaBoostClassifier-291"><a href="#AdaBoostClassifier-291"><span class="linenos">291</span></a>                    <span class="p">{</span><span class="n">m</span><span class="p">:</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">base_learner</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))}</span>
</span><span id="AdaBoostClassifier-292"><a href="#AdaBoostClassifier-292"><span class="linenos">292</span></a>                <span class="p">)</span>
</span><span id="AdaBoostClassifier-293"><a href="#AdaBoostClassifier-293"><span class="linenos">293</span></a>
</span><span id="AdaBoostClassifier-294"><a href="#AdaBoostClassifier-294"><span class="linenos">294</span></a>                <span class="n">cond</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x_range_n</span><span class="p">]</span>
</span><span id="AdaBoostClassifier-295"><a href="#AdaBoostClassifier-295"><span class="linenos">295</span></a>
</span><span id="AdaBoostClassifier-296"><a href="#AdaBoostClassifier-296"><span class="linenos">296</span></a>                <span class="n">err_m</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
</span><span id="AdaBoostClassifier-297"><a href="#AdaBoostClassifier-297"><span class="linenos">297</span></a>                    <span class="nb">sum</span><span class="p">([</span><span class="n">elt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">elt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">elt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">w_m</span><span class="p">)]),</span>
</span><span id="AdaBoostClassifier-298"><a href="#AdaBoostClassifier-298"><span class="linenos">298</span></a>                    <span class="mf">2.220446049250313e-16</span><span class="p">,</span>
</span><span id="AdaBoostClassifier-299"><a href="#AdaBoostClassifier-299"><span class="linenos">299</span></a>                <span class="p">)</span>  <span class="c1"># sum(w_m) == 1</span>
</span><span id="AdaBoostClassifier-300"><a href="#AdaBoostClassifier-300"><span class="linenos">300</span></a>
</span><span id="AdaBoostClassifier-301"><a href="#AdaBoostClassifier-301"><span class="linenos">301</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reg_lambda</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AdaBoostClassifier-302"><a href="#AdaBoostClassifier-302"><span class="linenos">302</span></a>                    <span class="n">err_m</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reg_lambda</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="AdaBoostClassifier-303"><a href="#AdaBoostClassifier-303"><span class="linenos">303</span></a>                        <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">reg_alpha</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">w_m</span><span class="p">])</span>
</span><span id="AdaBoostClassifier-304"><a href="#AdaBoostClassifier-304"><span class="linenos">304</span></a>                        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">reg_alpha</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">w_m</span><span class="p">])</span>
</span><span id="AdaBoostClassifier-305"><a href="#AdaBoostClassifier-305"><span class="linenos">305</span></a>                    <span class="p">)</span>
</span><span id="AdaBoostClassifier-306"><a href="#AdaBoostClassifier-306"><span class="linenos">306</span></a>
</span><span id="AdaBoostClassifier-307"><a href="#AdaBoostClassifier-307"><span class="linenos">307</span></a>                <span class="n">err_m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">err_m</span><span class="p">,</span> <span class="n">err_bound</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-308"><a href="#AdaBoostClassifier-308"><span class="linenos">308</span></a>
</span><span id="AdaBoostClassifier-309"><a href="#AdaBoostClassifier-309"><span class="linenos">309</span></a>                <span class="n">alpha_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span>
</span><span id="AdaBoostClassifier-310"><a href="#AdaBoostClassifier-310"><span class="linenos">310</span></a>                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">err_m</span><span class="p">)</span> <span class="o">/</span> <span class="n">err_m</span>
</span><span id="AdaBoostClassifier-311"><a href="#AdaBoostClassifier-311"><span class="linenos">311</span></a>                <span class="p">)</span>
</span><span id="AdaBoostClassifier-312"><a href="#AdaBoostClassifier-312"><span class="linenos">312</span></a>
</span><span id="AdaBoostClassifier-313"><a href="#AdaBoostClassifier-313"><span class="linenos">313</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alpha_m</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-314"><a href="#AdaBoostClassifier-314"><span class="linenos">314</span></a>
</span><span id="AdaBoostClassifier-315"><a href="#AdaBoostClassifier-315"><span class="linenos">315</span></a>                <span class="n">w_m_temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">exp</span><span class="p">(</span><span class="n">alpha_m</span> <span class="o">*</span> <span class="n">cond</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x_range_n</span><span class="p">]</span>
</span><span id="AdaBoostClassifier-316"><a href="#AdaBoostClassifier-316"><span class="linenos">316</span></a>
</span><span id="AdaBoostClassifier-317"><a href="#AdaBoostClassifier-317"><span class="linenos">317</span></a>                <span class="n">sum_w_m</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">w_m_temp</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-318"><a href="#AdaBoostClassifier-318"><span class="linenos">318</span></a>
</span><span id="AdaBoostClassifier-319"><a href="#AdaBoostClassifier-319"><span class="linenos">319</span></a>                <span class="n">w_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">w_m_temp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">sum_w_m</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x_range_n</span><span class="p">])</span>
</span><span id="AdaBoostClassifier-320"><a href="#AdaBoostClassifier-320"><span class="linenos">320</span></a>
</span><span id="AdaBoostClassifier-321"><a href="#AdaBoostClassifier-321"><span class="linenos">321</span></a>                <span class="n">base_learner</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-322"><a href="#AdaBoostClassifier-322"><span class="linenos">322</span></a>
</span><span id="AdaBoostClassifier-323"><a href="#AdaBoostClassifier-323"><span class="linenos">323</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AdaBoostClassifier-324"><a href="#AdaBoostClassifier-324"><span class="linenos">324</span></a>                    <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-325"><a href="#AdaBoostClassifier-325"><span class="linenos">325</span></a>
</span><span id="AdaBoostClassifier-326"><a href="#AdaBoostClassifier-326"><span class="linenos">326</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AdaBoostClassifier-327"><a href="#AdaBoostClassifier-327"><span class="linenos">327</span></a>                <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-328"><a href="#AdaBoostClassifier-328"><span class="linenos">328</span></a>
</span><span id="AdaBoostClassifier-329"><a href="#AdaBoostClassifier-329"><span class="linenos">329</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_learners_</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-330"><a href="#AdaBoostClassifier-330"><span class="linenos">330</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-331"><a href="#AdaBoostClassifier-331"><span class="linenos">331</span></a>
</span><span id="AdaBoostClassifier-332"><a href="#AdaBoostClassifier-332"><span class="linenos">332</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="AdaBoostClassifier-333"><a href="#AdaBoostClassifier-333"><span class="linenos">333</span></a>
</span><span id="AdaBoostClassifier-334"><a href="#AdaBoostClassifier-334"><span class="linenos">334</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;SAMME.R&quot;</span><span class="p">:</span>
</span><span id="AdaBoostClassifier-335"><a href="#AdaBoostClassifier-335"><span class="linenos">335</span></a>            <span class="n">Y</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">one_hot_encode2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-336"><a href="#AdaBoostClassifier-336"><span class="linenos">336</span></a>
</span><span id="AdaBoostClassifier-337"><a href="#AdaBoostClassifier-337"><span class="linenos">337</span></a>            <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AdaBoostClassifier-338"><a href="#AdaBoostClassifier-338"><span class="linenos">338</span></a>                <span class="n">w_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># (N, 1)</span>
</span><span id="AdaBoostClassifier-339"><a href="#AdaBoostClassifier-339"><span class="linenos">339</span></a>
</span><span id="AdaBoostClassifier-340"><a href="#AdaBoostClassifier-340"><span class="linenos">340</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AdaBoostClassifier-341"><a href="#AdaBoostClassifier-341"><span class="linenos">341</span></a>                <span class="n">w_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-342"><a href="#AdaBoostClassifier-342"><span class="linenos">342</span></a>
</span><span id="AdaBoostClassifier-343"><a href="#AdaBoostClassifier-343"><span class="linenos">343</span></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="AdaBoostClassifier-344"><a href="#AdaBoostClassifier-344"><span class="linenos">344</span></a>                <span class="n">probs</span> <span class="o">=</span> <span class="n">base_learner</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="AdaBoostClassifier-345"><a href="#AdaBoostClassifier-345"><span class="linenos">345</span></a>                    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">w_m</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="AdaBoostClassifier-346"><a href="#AdaBoostClassifier-346"><span class="linenos">346</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-347"><a href="#AdaBoostClassifier-347"><span class="linenos">347</span></a>
</span><span id="AdaBoostClassifier-348"><a href="#AdaBoostClassifier-348"><span class="linenos">348</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span>
</span><span id="AdaBoostClassifier-349"><a href="#AdaBoostClassifier-349"><span class="linenos">349</span></a>                    <span class="n">a</span><span class="o">=</span><span class="n">probs</span><span class="p">,</span> <span class="n">a_min</span><span class="o">=</span><span class="mf">2.220446049250313e-16</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">probs</span>
</span><span id="AdaBoostClassifier-350"><a href="#AdaBoostClassifier-350"><span class="linenos">350</span></a>                <span class="p">)</span>
</span><span id="AdaBoostClassifier-351"><a href="#AdaBoostClassifier-351"><span class="linenos">351</span></a>
</span><span id="AdaBoostClassifier-352"><a href="#AdaBoostClassifier-352"><span class="linenos">352</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">base_learners_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="AdaBoostClassifier-353"><a href="#AdaBoostClassifier-353"><span class="linenos">353</span></a>                    <span class="p">{</span><span class="n">m</span><span class="p">:</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">base_learner</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))}</span>
</span><span id="AdaBoostClassifier-354"><a href="#AdaBoostClassifier-354"><span class="linenos">354</span></a>                <span class="p">)</span>
</span><span id="AdaBoostClassifier-355"><a href="#AdaBoostClassifier-355"><span class="linenos">355</span></a>
</span><span id="AdaBoostClassifier-356"><a href="#AdaBoostClassifier-356"><span class="linenos">356</span></a>                <span class="n">w_m</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
</span><span id="AdaBoostClassifier-357"><a href="#AdaBoostClassifier-357"><span class="linenos">357</span></a>                    <span class="o">-</span><span class="mf">1.0</span>
</span><span id="AdaBoostClassifier-358"><a href="#AdaBoostClassifier-358"><span class="linenos">358</span></a>                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span>
</span><span id="AdaBoostClassifier-359"><a href="#AdaBoostClassifier-359"><span class="linenos">359</span></a>                    <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-360"><a href="#AdaBoostClassifier-360"><span class="linenos">360</span></a>                    <span class="o">*</span> <span class="n">xlogy</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">probs</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-361"><a href="#AdaBoostClassifier-361"><span class="linenos">361</span></a>                <span class="p">)</span>
</span><span id="AdaBoostClassifier-362"><a href="#AdaBoostClassifier-362"><span class="linenos">362</span></a>
</span><span id="AdaBoostClassifier-363"><a href="#AdaBoostClassifier-363"><span class="linenos">363</span></a>                <span class="n">w_m</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">w_m</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-364"><a href="#AdaBoostClassifier-364"><span class="linenos">364</span></a>
</span><span id="AdaBoostClassifier-365"><a href="#AdaBoostClassifier-365"><span class="linenos">365</span></a>                <span class="n">base_learner</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-366"><a href="#AdaBoostClassifier-366"><span class="linenos">366</span></a>
</span><span id="AdaBoostClassifier-367"><a href="#AdaBoostClassifier-367"><span class="linenos">367</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AdaBoostClassifier-368"><a href="#AdaBoostClassifier-368"><span class="linenos">368</span></a>                    <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-369"><a href="#AdaBoostClassifier-369"><span class="linenos">369</span></a>
</span><span id="AdaBoostClassifier-370"><a href="#AdaBoostClassifier-370"><span class="linenos">370</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AdaBoostClassifier-371"><a href="#AdaBoostClassifier-371"><span class="linenos">371</span></a>                <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-372"><a href="#AdaBoostClassifier-372"><span class="linenos">372</span></a>
</span><span id="AdaBoostClassifier-373"><a href="#AdaBoostClassifier-373"><span class="linenos">373</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_learners_</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-374"><a href="#AdaBoostClassifier-374"><span class="linenos">374</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-375"><a href="#AdaBoostClassifier-375"><span class="linenos">375</span></a>
</span><span id="AdaBoostClassifier-376"><a href="#AdaBoostClassifier-376"><span class="linenos">376</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="AdaBoostClassifier-377"><a href="#AdaBoostClassifier-377"><span class="linenos">377</span></a>
</span><span id="AdaBoostClassifier-378"><a href="#AdaBoostClassifier-378"><span class="linenos">378</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="AdaBoostClassifier-379"><a href="#AdaBoostClassifier-379"><span class="linenos">379</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="AdaBoostClassifier-380"><a href="#AdaBoostClassifier-380"><span class="linenos">380</span></a>
</span><span id="AdaBoostClassifier-381"><a href="#AdaBoostClassifier-381"><span class="linenos">381</span></a><span class="sd">        Parameters:</span>
</span><span id="AdaBoostClassifier-382"><a href="#AdaBoostClassifier-382"><span class="linenos">382</span></a>
</span><span id="AdaBoostClassifier-383"><a href="#AdaBoostClassifier-383"><span class="linenos">383</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="AdaBoostClassifier-384"><a href="#AdaBoostClassifier-384"><span class="linenos">384</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="AdaBoostClassifier-385"><a href="#AdaBoostClassifier-385"><span class="linenos">385</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="AdaBoostClassifier-386"><a href="#AdaBoostClassifier-386"><span class="linenos">386</span></a>
</span><span id="AdaBoostClassifier-387"><a href="#AdaBoostClassifier-387"><span class="linenos">387</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="AdaBoostClassifier-388"><a href="#AdaBoostClassifier-388"><span class="linenos">388</span></a><span class="sd">                  self.cook_test_set</span>
</span><span id="AdaBoostClassifier-389"><a href="#AdaBoostClassifier-389"><span class="linenos">389</span></a>
</span><span id="AdaBoostClassifier-390"><a href="#AdaBoostClassifier-390"><span class="linenos">390</span></a><span class="sd">        Returns:</span>
</span><span id="AdaBoostClassifier-391"><a href="#AdaBoostClassifier-391"><span class="linenos">391</span></a>
</span><span id="AdaBoostClassifier-392"><a href="#AdaBoostClassifier-392"><span class="linenos">392</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="AdaBoostClassifier-393"><a href="#AdaBoostClassifier-393"><span class="linenos">393</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdaBoostClassifier-394"><a href="#AdaBoostClassifier-394"><span class="linenos">394</span></a>
</span><span id="AdaBoostClassifier-395"><a href="#AdaBoostClassifier-395"><span class="linenos">395</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-396"><a href="#AdaBoostClassifier-396"><span class="linenos">396</span></a>
</span><span id="AdaBoostClassifier-397"><a href="#AdaBoostClassifier-397"><span class="linenos">397</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="AdaBoostClassifier-398"><a href="#AdaBoostClassifier-398"><span class="linenos">398</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probabilities for test data X.</span>
</span><span id="AdaBoostClassifier-399"><a href="#AdaBoostClassifier-399"><span class="linenos">399</span></a>
</span><span id="AdaBoostClassifier-400"><a href="#AdaBoostClassifier-400"><span class="linenos">400</span></a><span class="sd">        Parameters:</span>
</span><span id="AdaBoostClassifier-401"><a href="#AdaBoostClassifier-401"><span class="linenos">401</span></a>
</span><span id="AdaBoostClassifier-402"><a href="#AdaBoostClassifier-402"><span class="linenos">402</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="AdaBoostClassifier-403"><a href="#AdaBoostClassifier-403"><span class="linenos">403</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="AdaBoostClassifier-404"><a href="#AdaBoostClassifier-404"><span class="linenos">404</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="AdaBoostClassifier-405"><a href="#AdaBoostClassifier-405"><span class="linenos">405</span></a>
</span><span id="AdaBoostClassifier-406"><a href="#AdaBoostClassifier-406"><span class="linenos">406</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="AdaBoostClassifier-407"><a href="#AdaBoostClassifier-407"><span class="linenos">407</span></a><span class="sd">                  self.cook_test_set</span>
</span><span id="AdaBoostClassifier-408"><a href="#AdaBoostClassifier-408"><span class="linenos">408</span></a>
</span><span id="AdaBoostClassifier-409"><a href="#AdaBoostClassifier-409"><span class="linenos">409</span></a><span class="sd">        Returns:</span>
</span><span id="AdaBoostClassifier-410"><a href="#AdaBoostClassifier-410"><span class="linenos">410</span></a>
</span><span id="AdaBoostClassifier-411"><a href="#AdaBoostClassifier-411"><span class="linenos">411</span></a><span class="sd">            probability estimates for test data: {array-like}</span>
</span><span id="AdaBoostClassifier-412"><a href="#AdaBoostClassifier-412"><span class="linenos">412</span></a>
</span><span id="AdaBoostClassifier-413"><a href="#AdaBoostClassifier-413"><span class="linenos">413</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdaBoostClassifier-414"><a href="#AdaBoostClassifier-414"><span class="linenos">414</span></a>
</span><span id="AdaBoostClassifier-415"><a href="#AdaBoostClassifier-415"><span class="linenos">415</span></a>        <span class="n">n_iter</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_learners_</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-416"><a href="#AdaBoostClassifier-416"><span class="linenos">416</span></a>
</span><span id="AdaBoostClassifier-417"><a href="#AdaBoostClassifier-417"><span class="linenos">417</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;SAMME&quot;</span><span class="p">:</span>
</span><span id="AdaBoostClassifier-418"><a href="#AdaBoostClassifier-418"><span class="linenos">418</span></a>            <span class="n">ensemble_learner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">))</span>
</span><span id="AdaBoostClassifier-419"><a href="#AdaBoostClassifier-419"><span class="linenos">419</span></a>
</span><span id="AdaBoostClassifier-420"><a href="#AdaBoostClassifier-420"><span class="linenos">420</span></a>            <span class="c1"># if self.verbose == 1:</span>
</span><span id="AdaBoostClassifier-421"><a href="#AdaBoostClassifier-421"><span class="linenos">421</span></a>            <span class="c1">#    pbar = Progbar(n_iter)</span>
</span><span id="AdaBoostClassifier-422"><a href="#AdaBoostClassifier-422"><span class="linenos">422</span></a>
</span><span id="AdaBoostClassifier-423"><a href="#AdaBoostClassifier-423"><span class="linenos">423</span></a>            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">base_learner</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_learners_</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="AdaBoostClassifier-424"><a href="#AdaBoostClassifier-424"><span class="linenos">424</span></a>                <span class="n">preds</span> <span class="o">=</span> <span class="n">base_learner</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-425"><a href="#AdaBoostClassifier-425"><span class="linenos">425</span></a>
</span><span id="AdaBoostClassifier-426"><a href="#AdaBoostClassifier-426"><span class="linenos">426</span></a>                <span class="n">ensemble_learner</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">mo</span><span class="o">.</span><span class="n">one_hot_encode2</span><span class="p">(</span>
</span><span id="AdaBoostClassifier-427"><a href="#AdaBoostClassifier-427"><span class="linenos">427</span></a>                    <span class="n">preds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span>
</span><span id="AdaBoostClassifier-428"><a href="#AdaBoostClassifier-428"><span class="linenos">428</span></a>                <span class="p">)</span>
</span><span id="AdaBoostClassifier-429"><a href="#AdaBoostClassifier-429"><span class="linenos">429</span></a>
</span><span id="AdaBoostClassifier-430"><a href="#AdaBoostClassifier-430"><span class="linenos">430</span></a>                <span class="c1"># if self.verbose == 1:</span>
</span><span id="AdaBoostClassifier-431"><a href="#AdaBoostClassifier-431"><span class="linenos">431</span></a>                <span class="c1">#    pbar.update(idx)</span>
</span><span id="AdaBoostClassifier-432"><a href="#AdaBoostClassifier-432"><span class="linenos">432</span></a>
</span><span id="AdaBoostClassifier-433"><a href="#AdaBoostClassifier-433"><span class="linenos">433</span></a>            <span class="c1"># if self.verbose == 1:</span>
</span><span id="AdaBoostClassifier-434"><a href="#AdaBoostClassifier-434"><span class="linenos">434</span></a>            <span class="c1">#    pbar.update(n_iter)</span>
</span><span id="AdaBoostClassifier-435"><a href="#AdaBoostClassifier-435"><span class="linenos">435</span></a>
</span><span id="AdaBoostClassifier-436"><a href="#AdaBoostClassifier-436"><span class="linenos">436</span></a>            <span class="n">expit_ensemble_learner</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">ensemble_learner</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-437"><a href="#AdaBoostClassifier-437"><span class="linenos">437</span></a>
</span><span id="AdaBoostClassifier-438"><a href="#AdaBoostClassifier-438"><span class="linenos">438</span></a>            <span class="n">sum_ensemble</span> <span class="o">=</span> <span class="n">expit_ensemble_learner</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-439"><a href="#AdaBoostClassifier-439"><span class="linenos">439</span></a>
</span><span id="AdaBoostClassifier-440"><a href="#AdaBoostClassifier-440"><span class="linenos">440</span></a>            <span class="k">return</span> <span class="n">expit_ensemble_learner</span> <span class="o">/</span> <span class="n">sum_ensemble</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="AdaBoostClassifier-441"><a href="#AdaBoostClassifier-441"><span class="linenos">441</span></a>
</span><span id="AdaBoostClassifier-442"><a href="#AdaBoostClassifier-442"><span class="linenos">442</span></a>        <span class="c1"># if self.method == &quot;SAMME.R&quot;:</span>
</span><span id="AdaBoostClassifier-443"><a href="#AdaBoostClassifier-443"><span class="linenos">443</span></a>        <span class="n">ensemble_learner</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="AdaBoostClassifier-444"><a href="#AdaBoostClassifier-444"><span class="linenos">444</span></a>
</span><span id="AdaBoostClassifier-445"><a href="#AdaBoostClassifier-445"><span class="linenos">445</span></a>        <span class="c1"># if self.verbose == 1:</span>
</span><span id="AdaBoostClassifier-446"><a href="#AdaBoostClassifier-446"><span class="linenos">446</span></a>        <span class="c1">#    pbar = Progbar(n_iter)</span>
</span><span id="AdaBoostClassifier-447"><a href="#AdaBoostClassifier-447"><span class="linenos">447</span></a>
</span><span id="AdaBoostClassifier-448"><a href="#AdaBoostClassifier-448"><span class="linenos">448</span></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">base_learner</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_learners_</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="AdaBoostClassifier-449"><a href="#AdaBoostClassifier-449"><span class="linenos">449</span></a>            <span class="n">probs</span> <span class="o">=</span> <span class="n">base_learner</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-450"><a href="#AdaBoostClassifier-450"><span class="linenos">450</span></a>
</span><span id="AdaBoostClassifier-451"><a href="#AdaBoostClassifier-451"><span class="linenos">451</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">probs</span><span class="p">,</span> <span class="n">a_min</span><span class="o">=</span><span class="mf">2.220446049250313e-16</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">probs</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-452"><a href="#AdaBoostClassifier-452"><span class="linenos">452</span></a>
</span><span id="AdaBoostClassifier-453"><a href="#AdaBoostClassifier-453"><span class="linenos">453</span></a>            <span class="n">log_preds_proba</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-454"><a href="#AdaBoostClassifier-454"><span class="linenos">454</span></a>
</span><span id="AdaBoostClassifier-455"><a href="#AdaBoostClassifier-455"><span class="linenos">455</span></a>            <span class="n">ensemble_learner</span> <span class="o">+=</span> <span class="p">(</span>
</span><span id="AdaBoostClassifier-456"><a href="#AdaBoostClassifier-456"><span class="linenos">456</span></a>                <span class="n">log_preds_proba</span> <span class="o">-</span> <span class="n">log_preds_proba</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="AdaBoostClassifier-457"><a href="#AdaBoostClassifier-457"><span class="linenos">457</span></a>            <span class="p">)</span>
</span><span id="AdaBoostClassifier-458"><a href="#AdaBoostClassifier-458"><span class="linenos">458</span></a>
</span><span id="AdaBoostClassifier-459"><a href="#AdaBoostClassifier-459"><span class="linenos">459</span></a>            <span class="c1"># if self.verbose == 1:</span>
</span><span id="AdaBoostClassifier-460"><a href="#AdaBoostClassifier-460"><span class="linenos">460</span></a>            <span class="c1">#    pbar.update(idx)</span>
</span><span id="AdaBoostClassifier-461"><a href="#AdaBoostClassifier-461"><span class="linenos">461</span></a>
</span><span id="AdaBoostClassifier-462"><a href="#AdaBoostClassifier-462"><span class="linenos">462</span></a>        <span class="n">ensemble_learner</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="AdaBoostClassifier-463"><a href="#AdaBoostClassifier-463"><span class="linenos">463</span></a>
</span><span id="AdaBoostClassifier-464"><a href="#AdaBoostClassifier-464"><span class="linenos">464</span></a>        <span class="c1"># if self.verbose == 1:</span>
</span><span id="AdaBoostClassifier-465"><a href="#AdaBoostClassifier-465"><span class="linenos">465</span></a>        <span class="c1">#    pbar.update(n_iter)</span>
</span><span id="AdaBoostClassifier-466"><a href="#AdaBoostClassifier-466"><span class="linenos">466</span></a>
</span><span id="AdaBoostClassifier-467"><a href="#AdaBoostClassifier-467"><span class="linenos">467</span></a>        <span class="n">expit_ensemble_learner</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">ensemble_learner</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-468"><a href="#AdaBoostClassifier-468"><span class="linenos">468</span></a>
</span><span id="AdaBoostClassifier-469"><a href="#AdaBoostClassifier-469"><span class="linenos">469</span></a>        <span class="n">sum_ensemble</span> <span class="o">=</span> <span class="n">expit_ensemble_learner</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AdaBoostClassifier-470"><a href="#AdaBoostClassifier-470"><span class="linenos">470</span></a>
</span><span id="AdaBoostClassifier-471"><a href="#AdaBoostClassifier-471"><span class="linenos">471</span></a>        <span class="k">return</span> <span class="n">expit_ensemble_learner</span> <span class="o">/</span> <span class="n">sum_ensemble</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>AdaBoost Classification (SAMME) model class derived from class Boosting</p>

<p>Parameters:</p>

<pre><code>obj: object
    any object containing a method fit (obj.fit()) and a method predict
    (obj.predict())

n_estimators: int
    number of boosting iterations

learning_rate: float
    learning rate of the boosting procedure

n_hidden_features: int
    number of nodes in the hidden layer

reg_lambda: float
    regularization parameter for weights

reg_alpha: float
    controls compromize between l1 and l2 norm of weights

activation_name: str
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'

a: float
    hyperparameter for 'prelu' or 'elu' activation function

nodes_sim: str
    type of simulation for the nodes: 'sobol', 'hammersley', 'halton',
    'uniform'

bias: boolean
    indicates if the hidden layer contains a bias term (True) or not
    (False)

dropout: float
    regularization parameter; (random) percentage of nodes dropped out
    of the training

direct_link: boolean
    indicates if the original predictors are included (True) in model's
    fitting or not (False)

n_clusters: int
    number of clusters for 'kmeans' or 'gmm' clustering (could be 0:
        no clustering)

cluster_encode: bool
    defines how the variable containing clusters is treated (default is one-hot)
    if `False`, then labels are used, without one-hot encoding

type_clust: str
    type of clustering method: currently k-means ('kmeans') or Gaussian
    Mixture Model ('gmm')

type_scaling: a tuple of 3 strings
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax')

col_sample: float
    percentage of covariates randomly chosen for training

row_sample: float
    percentage of rows chosen for training, by stratified bootstrapping

seed: int
    reproducibility seed for nodes_sim=='uniform'

verbose: int
    0 for no output, 1 for a progress bar (default is 1)

method: str
    type of Adaboost method, 'SAMME' (discrete) or 'SAMME.R' (real)

backend: str
    "cpu" or "gpu" or "tpu"
</code></pre>

<p>Attributes:</p>

<pre><code>alpha_: list
    AdaBoost coefficients alpha_m

base_learners_: dict
    a dictionary containing the base learners
</code></pre>

<p>Examples:</p>

<p>See also <a href="https://github.com/Techtonique/nnetsauce/blob/master/examples/adaboost_classification.py">https://github.com/Techtonique/nnetsauce/blob/master/examples/adaboost_classification.py</a></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>

<span class="n">breast_cancer</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">breast_cancer</span><span class="o">.</span><span class="n">data</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">breast_cancer</span><span class="o">.</span><span class="n">target</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># SAMME.R</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">,</span> <span class="n">multi_class</span> <span class="o">=</span> <span class="s1">&#39;ovr&#39;</span><span class="p">,</span>
                        <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">fit_obj</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span>
                                <span class="n">n_hidden_features</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">11.22338867</span><span class="p">),</span>
                                <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">n_estimators</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01126343</span><span class="p">,</span>
                                <span class="n">col_sample</span><span class="o">=</span><span class="mf">0.72684326</span><span class="p">,</span> <span class="n">row_sample</span><span class="o">=</span><span class="mf">0.86429443</span><span class="p">,</span>
                                <span class="n">dropout</span><span class="o">=</span><span class="mf">0.63078613</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;gmm&quot;</span><span class="p">,</span>
                                <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
                                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;SAMME.R&quot;</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">fit_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Elapsed </span><span class="si">{</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fit_obj</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Elapsed </span><span class="si">{</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">preds</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fit_obj</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;roc_auc&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</code></pre>
</div>
</div>


                                <div id="AdaBoostClassifier.fit" class="classattr">
                                            <input id="AdaBoostClassifier.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AdaBoostClassifier.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdaBoostClassifier.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdaBoostClassifier.fit-214"><a href="#AdaBoostClassifier.fit-214"><span class="linenos">214</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="AdaBoostClassifier.fit-215"><a href="#AdaBoostClassifier.fit-215"><span class="linenos">215</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Boosting model to training data (X, y).</span>
</span><span id="AdaBoostClassifier.fit-216"><a href="#AdaBoostClassifier.fit-216"><span class="linenos">216</span></a>
</span><span id="AdaBoostClassifier.fit-217"><a href="#AdaBoostClassifier.fit-217"><span class="linenos">217</span></a><span class="sd">        Parameters:</span>
</span><span id="AdaBoostClassifier.fit-218"><a href="#AdaBoostClassifier.fit-218"><span class="linenos">218</span></a>
</span><span id="AdaBoostClassifier.fit-219"><a href="#AdaBoostClassifier.fit-219"><span class="linenos">219</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="AdaBoostClassifier.fit-220"><a href="#AdaBoostClassifier.fit-220"><span class="linenos">220</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="AdaBoostClassifier.fit-221"><a href="#AdaBoostClassifier.fit-221"><span class="linenos">221</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="AdaBoostClassifier.fit-222"><a href="#AdaBoostClassifier.fit-222"><span class="linenos">222</span></a>
</span><span id="AdaBoostClassifier.fit-223"><a href="#AdaBoostClassifier.fit-223"><span class="linenos">223</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="AdaBoostClassifier.fit-224"><a href="#AdaBoostClassifier.fit-224"><span class="linenos">224</span></a><span class="sd">                Target values.</span>
</span><span id="AdaBoostClassifier.fit-225"><a href="#AdaBoostClassifier.fit-225"><span class="linenos">225</span></a>
</span><span id="AdaBoostClassifier.fit-226"><a href="#AdaBoostClassifier.fit-226"><span class="linenos">226</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="AdaBoostClassifier.fit-227"><a href="#AdaBoostClassifier.fit-227"><span class="linenos">227</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="AdaBoostClassifier.fit-228"><a href="#AdaBoostClassifier.fit-228"><span class="linenos">228</span></a>
</span><span id="AdaBoostClassifier.fit-229"><a href="#AdaBoostClassifier.fit-229"><span class="linenos">229</span></a><span class="sd">        Returns:</span>
</span><span id="AdaBoostClassifier.fit-230"><a href="#AdaBoostClassifier.fit-230"><span class="linenos">230</span></a>
</span><span id="AdaBoostClassifier.fit-231"><a href="#AdaBoostClassifier.fit-231"><span class="linenos">231</span></a><span class="sd">             self: object</span>
</span><span id="AdaBoostClassifier.fit-232"><a href="#AdaBoostClassifier.fit-232"><span class="linenos">232</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdaBoostClassifier.fit-233"><a href="#AdaBoostClassifier.fit-233"><span class="linenos">233</span></a>
</span><span id="AdaBoostClassifier.fit-234"><a href="#AdaBoostClassifier.fit-234"><span class="linenos">234</span></a>        <span class="k">assert</span> <span class="n">mx</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s2">&quot;y must contain only integers&quot;</span>
</span><span id="AdaBoostClassifier.fit-235"><a href="#AdaBoostClassifier.fit-235"><span class="linenos">235</span></a>
</span><span id="AdaBoostClassifier.fit-236"><a href="#AdaBoostClassifier.fit-236"><span class="linenos">236</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="AdaBoostClassifier.fit-237"><a href="#AdaBoostClassifier.fit-237"><span class="linenos">237</span></a>            <span class="s2">&quot;SAMME&quot;</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-238"><a href="#AdaBoostClassifier.fit-238"><span class="linenos">238</span></a>            <span class="s2">&quot;SAMME.R&quot;</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-239"><a href="#AdaBoostClassifier.fit-239"><span class="linenos">239</span></a>        <span class="p">),</span> <span class="s2">&quot;`method` must be either &#39;SAMME&#39; or &#39;SAMME.R&#39;&quot;</span>
</span><span id="AdaBoostClassifier.fit-240"><a href="#AdaBoostClassifier.fit-240"><span class="linenos">240</span></a>
</span><span id="AdaBoostClassifier.fit-241"><a href="#AdaBoostClassifier.fit-241"><span class="linenos">241</span></a>        <span class="k">assert</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reg_lambda</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
</span><span id="AdaBoostClassifier.fit-242"><a href="#AdaBoostClassifier.fit-242"><span class="linenos">242</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reg_lambda</span> <span class="o">&gt;=</span> <span class="mi">0</span>
</span><span id="AdaBoostClassifier.fit-243"><a href="#AdaBoostClassifier.fit-243"><span class="linenos">243</span></a>        <span class="p">),</span> <span class="s2">&quot;must have self.reg_lambda &lt;= 1 &amp;  self.reg_lambda &gt;= 0&quot;</span>
</span><span id="AdaBoostClassifier.fit-244"><a href="#AdaBoostClassifier.fit-244"><span class="linenos">244</span></a>
</span><span id="AdaBoostClassifier.fit-245"><a href="#AdaBoostClassifier.fit-245"><span class="linenos">245</span></a>        <span class="k">assert</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reg_alpha</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
</span><span id="AdaBoostClassifier.fit-246"><a href="#AdaBoostClassifier.fit-246"><span class="linenos">246</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">reg_alpha</span> <span class="o">&gt;=</span> <span class="mi">0</span>
</span><span id="AdaBoostClassifier.fit-247"><a href="#AdaBoostClassifier.fit-247"><span class="linenos">247</span></a>        <span class="p">),</span> <span class="s2">&quot;must have self.reg_alpha &lt;= 1 &amp;  self.reg_alpha &gt;= 0&quot;</span>
</span><span id="AdaBoostClassifier.fit-248"><a href="#AdaBoostClassifier.fit-248"><span class="linenos">248</span></a>
</span><span id="AdaBoostClassifier.fit-249"><a href="#AdaBoostClassifier.fit-249"><span class="linenos">249</span></a>        <span class="c1"># training</span>
</span><span id="AdaBoostClassifier.fit-250"><a href="#AdaBoostClassifier.fit-250"><span class="linenos">250</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="AdaBoostClassifier.fit-251"><a href="#AdaBoostClassifier.fit-251"><span class="linenos">251</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="AdaBoostClassifier.fit-252"><a href="#AdaBoostClassifier.fit-252"><span class="linenos">252</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="AdaBoostClassifier.fit-253"><a href="#AdaBoostClassifier.fit-253"><span class="linenos">253</span></a>
</span><span id="AdaBoostClassifier.fit-254"><a href="#AdaBoostClassifier.fit-254"><span class="linenos">254</span></a>        <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AdaBoostClassifier.fit-255"><a href="#AdaBoostClassifier.fit-255"><span class="linenos">255</span></a>            <span class="n">w_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-256"><a href="#AdaBoostClassifier.fit-256"><span class="linenos">256</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="AdaBoostClassifier.fit-257"><a href="#AdaBoostClassifier.fit-257"><span class="linenos">257</span></a>            <span class="n">w_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-258"><a href="#AdaBoostClassifier.fit-258"><span class="linenos">258</span></a>
</span><span id="AdaBoostClassifier.fit-259"><a href="#AdaBoostClassifier.fit-259"><span class="linenos">259</span></a>        <span class="n">base_learner</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="AdaBoostClassifier.fit-260"><a href="#AdaBoostClassifier.fit-260"><span class="linenos">260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-261"><a href="#AdaBoostClassifier.fit-261"><span class="linenos">261</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-262"><a href="#AdaBoostClassifier.fit-262"><span class="linenos">262</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-263"><a href="#AdaBoostClassifier.fit-263"><span class="linenos">263</span></a>            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-264"><a href="#AdaBoostClassifier.fit-264"><span class="linenos">264</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-265"><a href="#AdaBoostClassifier.fit-265"><span class="linenos">265</span></a>            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-266"><a href="#AdaBoostClassifier.fit-266"><span class="linenos">266</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-267"><a href="#AdaBoostClassifier.fit-267"><span class="linenos">267</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-268"><a href="#AdaBoostClassifier.fit-268"><span class="linenos">268</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-269"><a href="#AdaBoostClassifier.fit-269"><span class="linenos">269</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-270"><a href="#AdaBoostClassifier.fit-270"><span class="linenos">270</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-271"><a href="#AdaBoostClassifier.fit-271"><span class="linenos">271</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-272"><a href="#AdaBoostClassifier.fit-272"><span class="linenos">272</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-273"><a href="#AdaBoostClassifier.fit-273"><span class="linenos">273</span></a>            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-274"><a href="#AdaBoostClassifier.fit-274"><span class="linenos">274</span></a>        <span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-275"><a href="#AdaBoostClassifier.fit-275"><span class="linenos">275</span></a>
</span><span id="AdaBoostClassifier.fit-276"><a href="#AdaBoostClassifier.fit-276"><span class="linenos">276</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AdaBoostClassifier.fit-277"><a href="#AdaBoostClassifier.fit-277"><span class="linenos">277</span></a>            <span class="n">pbar</span> <span class="o">=</span> <span class="n">Progbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-278"><a href="#AdaBoostClassifier.fit-278"><span class="linenos">278</span></a>
</span><span id="AdaBoostClassifier.fit-279"><a href="#AdaBoostClassifier.fit-279"><span class="linenos">279</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;SAMME&quot;</span><span class="p">:</span>
</span><span id="AdaBoostClassifier.fit-280"><a href="#AdaBoostClassifier.fit-280"><span class="linenos">280</span></a>            <span class="n">err_m</span> <span class="o">=</span> <span class="mf">1e6</span>
</span><span id="AdaBoostClassifier.fit-281"><a href="#AdaBoostClassifier.fit-281"><span class="linenos">281</span></a>            <span class="n">err_bound</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span>
</span><span id="AdaBoostClassifier.fit-282"><a href="#AdaBoostClassifier.fit-282"><span class="linenos">282</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-283"><a href="#AdaBoostClassifier.fit-283"><span class="linenos">283</span></a>            <span class="n">x_range_n</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-284"><a href="#AdaBoostClassifier.fit-284"><span class="linenos">284</span></a>
</span><span id="AdaBoostClassifier.fit-285"><a href="#AdaBoostClassifier.fit-285"><span class="linenos">285</span></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="AdaBoostClassifier.fit-286"><a href="#AdaBoostClassifier.fit-286"><span class="linenos">286</span></a>                <span class="n">preds</span> <span class="o">=</span> <span class="n">base_learner</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="AdaBoostClassifier.fit-287"><a href="#AdaBoostClassifier.fit-287"><span class="linenos">287</span></a>                    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">w_m</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="AdaBoostClassifier.fit-288"><a href="#AdaBoostClassifier.fit-288"><span class="linenos">288</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-289"><a href="#AdaBoostClassifier.fit-289"><span class="linenos">289</span></a>
</span><span id="AdaBoostClassifier.fit-290"><a href="#AdaBoostClassifier.fit-290"><span class="linenos">290</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">base_learners_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="AdaBoostClassifier.fit-291"><a href="#AdaBoostClassifier.fit-291"><span class="linenos">291</span></a>                    <span class="p">{</span><span class="n">m</span><span class="p">:</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">base_learner</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))}</span>
</span><span id="AdaBoostClassifier.fit-292"><a href="#AdaBoostClassifier.fit-292"><span class="linenos">292</span></a>                <span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-293"><a href="#AdaBoostClassifier.fit-293"><span class="linenos">293</span></a>
</span><span id="AdaBoostClassifier.fit-294"><a href="#AdaBoostClassifier.fit-294"><span class="linenos">294</span></a>                <span class="n">cond</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x_range_n</span><span class="p">]</span>
</span><span id="AdaBoostClassifier.fit-295"><a href="#AdaBoostClassifier.fit-295"><span class="linenos">295</span></a>
</span><span id="AdaBoostClassifier.fit-296"><a href="#AdaBoostClassifier.fit-296"><span class="linenos">296</span></a>                <span class="n">err_m</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
</span><span id="AdaBoostClassifier.fit-297"><a href="#AdaBoostClassifier.fit-297"><span class="linenos">297</span></a>                    <span class="nb">sum</span><span class="p">([</span><span class="n">elt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">elt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">elt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">w_m</span><span class="p">)]),</span>
</span><span id="AdaBoostClassifier.fit-298"><a href="#AdaBoostClassifier.fit-298"><span class="linenos">298</span></a>                    <span class="mf">2.220446049250313e-16</span><span class="p">,</span>
</span><span id="AdaBoostClassifier.fit-299"><a href="#AdaBoostClassifier.fit-299"><span class="linenos">299</span></a>                <span class="p">)</span>  <span class="c1"># sum(w_m) == 1</span>
</span><span id="AdaBoostClassifier.fit-300"><a href="#AdaBoostClassifier.fit-300"><span class="linenos">300</span></a>
</span><span id="AdaBoostClassifier.fit-301"><a href="#AdaBoostClassifier.fit-301"><span class="linenos">301</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reg_lambda</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="AdaBoostClassifier.fit-302"><a href="#AdaBoostClassifier.fit-302"><span class="linenos">302</span></a>                    <span class="n">err_m</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reg_lambda</span> <span class="o">*</span> <span class="p">(</span>
</span><span id="AdaBoostClassifier.fit-303"><a href="#AdaBoostClassifier.fit-303"><span class="linenos">303</span></a>                        <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">reg_alpha</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">w_m</span><span class="p">])</span>
</span><span id="AdaBoostClassifier.fit-304"><a href="#AdaBoostClassifier.fit-304"><span class="linenos">304</span></a>                        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">reg_alpha</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">w_m</span><span class="p">])</span>
</span><span id="AdaBoostClassifier.fit-305"><a href="#AdaBoostClassifier.fit-305"><span class="linenos">305</span></a>                    <span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-306"><a href="#AdaBoostClassifier.fit-306"><span class="linenos">306</span></a>
</span><span id="AdaBoostClassifier.fit-307"><a href="#AdaBoostClassifier.fit-307"><span class="linenos">307</span></a>                <span class="n">err_m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">err_m</span><span class="p">,</span> <span class="n">err_bound</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-308"><a href="#AdaBoostClassifier.fit-308"><span class="linenos">308</span></a>
</span><span id="AdaBoostClassifier.fit-309"><a href="#AdaBoostClassifier.fit-309"><span class="linenos">309</span></a>                <span class="n">alpha_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span>
</span><span id="AdaBoostClassifier.fit-310"><a href="#AdaBoostClassifier.fit-310"><span class="linenos">310</span></a>                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">err_m</span><span class="p">)</span> <span class="o">/</span> <span class="n">err_m</span>
</span><span id="AdaBoostClassifier.fit-311"><a href="#AdaBoostClassifier.fit-311"><span class="linenos">311</span></a>                <span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-312"><a href="#AdaBoostClassifier.fit-312"><span class="linenos">312</span></a>
</span><span id="AdaBoostClassifier.fit-313"><a href="#AdaBoostClassifier.fit-313"><span class="linenos">313</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alpha_m</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-314"><a href="#AdaBoostClassifier.fit-314"><span class="linenos">314</span></a>
</span><span id="AdaBoostClassifier.fit-315"><a href="#AdaBoostClassifier.fit-315"><span class="linenos">315</span></a>                <span class="n">w_m_temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">exp</span><span class="p">(</span><span class="n">alpha_m</span> <span class="o">*</span> <span class="n">cond</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x_range_n</span><span class="p">]</span>
</span><span id="AdaBoostClassifier.fit-316"><a href="#AdaBoostClassifier.fit-316"><span class="linenos">316</span></a>
</span><span id="AdaBoostClassifier.fit-317"><a href="#AdaBoostClassifier.fit-317"><span class="linenos">317</span></a>                <span class="n">sum_w_m</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">w_m_temp</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-318"><a href="#AdaBoostClassifier.fit-318"><span class="linenos">318</span></a>
</span><span id="AdaBoostClassifier.fit-319"><a href="#AdaBoostClassifier.fit-319"><span class="linenos">319</span></a>                <span class="n">w_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">w_m_temp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">sum_w_m</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x_range_n</span><span class="p">])</span>
</span><span id="AdaBoostClassifier.fit-320"><a href="#AdaBoostClassifier.fit-320"><span class="linenos">320</span></a>
</span><span id="AdaBoostClassifier.fit-321"><a href="#AdaBoostClassifier.fit-321"><span class="linenos">321</span></a>                <span class="n">base_learner</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-322"><a href="#AdaBoostClassifier.fit-322"><span class="linenos">322</span></a>
</span><span id="AdaBoostClassifier.fit-323"><a href="#AdaBoostClassifier.fit-323"><span class="linenos">323</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AdaBoostClassifier.fit-324"><a href="#AdaBoostClassifier.fit-324"><span class="linenos">324</span></a>                    <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-325"><a href="#AdaBoostClassifier.fit-325"><span class="linenos">325</span></a>
</span><span id="AdaBoostClassifier.fit-326"><a href="#AdaBoostClassifier.fit-326"><span class="linenos">326</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AdaBoostClassifier.fit-327"><a href="#AdaBoostClassifier.fit-327"><span class="linenos">327</span></a>                <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-328"><a href="#AdaBoostClassifier.fit-328"><span class="linenos">328</span></a>
</span><span id="AdaBoostClassifier.fit-329"><a href="#AdaBoostClassifier.fit-329"><span class="linenos">329</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_learners_</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-330"><a href="#AdaBoostClassifier.fit-330"><span class="linenos">330</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-331"><a href="#AdaBoostClassifier.fit-331"><span class="linenos">331</span></a>
</span><span id="AdaBoostClassifier.fit-332"><a href="#AdaBoostClassifier.fit-332"><span class="linenos">332</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="AdaBoostClassifier.fit-333"><a href="#AdaBoostClassifier.fit-333"><span class="linenos">333</span></a>
</span><span id="AdaBoostClassifier.fit-334"><a href="#AdaBoostClassifier.fit-334"><span class="linenos">334</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;SAMME.R&quot;</span><span class="p">:</span>
</span><span id="AdaBoostClassifier.fit-335"><a href="#AdaBoostClassifier.fit-335"><span class="linenos">335</span></a>            <span class="n">Y</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">one_hot_encode2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-336"><a href="#AdaBoostClassifier.fit-336"><span class="linenos">336</span></a>
</span><span id="AdaBoostClassifier.fit-337"><a href="#AdaBoostClassifier.fit-337"><span class="linenos">337</span></a>            <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="AdaBoostClassifier.fit-338"><a href="#AdaBoostClassifier.fit-338"><span class="linenos">338</span></a>                <span class="n">w_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># (N, 1)</span>
</span><span id="AdaBoostClassifier.fit-339"><a href="#AdaBoostClassifier.fit-339"><span class="linenos">339</span></a>
</span><span id="AdaBoostClassifier.fit-340"><a href="#AdaBoostClassifier.fit-340"><span class="linenos">340</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="AdaBoostClassifier.fit-341"><a href="#AdaBoostClassifier.fit-341"><span class="linenos">341</span></a>                <span class="n">w_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-342"><a href="#AdaBoostClassifier.fit-342"><span class="linenos">342</span></a>
</span><span id="AdaBoostClassifier.fit-343"><a href="#AdaBoostClassifier.fit-343"><span class="linenos">343</span></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="AdaBoostClassifier.fit-344"><a href="#AdaBoostClassifier.fit-344"><span class="linenos">344</span></a>                <span class="n">probs</span> <span class="o">=</span> <span class="n">base_learner</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="AdaBoostClassifier.fit-345"><a href="#AdaBoostClassifier.fit-345"><span class="linenos">345</span></a>                    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">w_m</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="AdaBoostClassifier.fit-346"><a href="#AdaBoostClassifier.fit-346"><span class="linenos">346</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-347"><a href="#AdaBoostClassifier.fit-347"><span class="linenos">347</span></a>
</span><span id="AdaBoostClassifier.fit-348"><a href="#AdaBoostClassifier.fit-348"><span class="linenos">348</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span>
</span><span id="AdaBoostClassifier.fit-349"><a href="#AdaBoostClassifier.fit-349"><span class="linenos">349</span></a>                    <span class="n">a</span><span class="o">=</span><span class="n">probs</span><span class="p">,</span> <span class="n">a_min</span><span class="o">=</span><span class="mf">2.220446049250313e-16</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">probs</span>
</span><span id="AdaBoostClassifier.fit-350"><a href="#AdaBoostClassifier.fit-350"><span class="linenos">350</span></a>                <span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-351"><a href="#AdaBoostClassifier.fit-351"><span class="linenos">351</span></a>
</span><span id="AdaBoostClassifier.fit-352"><a href="#AdaBoostClassifier.fit-352"><span class="linenos">352</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">base_learners_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
</span><span id="AdaBoostClassifier.fit-353"><a href="#AdaBoostClassifier.fit-353"><span class="linenos">353</span></a>                    <span class="p">{</span><span class="n">m</span><span class="p">:</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">base_learner</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))}</span>
</span><span id="AdaBoostClassifier.fit-354"><a href="#AdaBoostClassifier.fit-354"><span class="linenos">354</span></a>                <span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-355"><a href="#AdaBoostClassifier.fit-355"><span class="linenos">355</span></a>
</span><span id="AdaBoostClassifier.fit-356"><a href="#AdaBoostClassifier.fit-356"><span class="linenos">356</span></a>                <span class="n">w_m</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
</span><span id="AdaBoostClassifier.fit-357"><a href="#AdaBoostClassifier.fit-357"><span class="linenos">357</span></a>                    <span class="o">-</span><span class="mf">1.0</span>
</span><span id="AdaBoostClassifier.fit-358"><a href="#AdaBoostClassifier.fit-358"><span class="linenos">358</span></a>                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span>
</span><span id="AdaBoostClassifier.fit-359"><a href="#AdaBoostClassifier.fit-359"><span class="linenos">359</span></a>                    <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-360"><a href="#AdaBoostClassifier.fit-360"><span class="linenos">360</span></a>                    <span class="o">*</span> <span class="n">xlogy</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">probs</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-361"><a href="#AdaBoostClassifier.fit-361"><span class="linenos">361</span></a>                <span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-362"><a href="#AdaBoostClassifier.fit-362"><span class="linenos">362</span></a>
</span><span id="AdaBoostClassifier.fit-363"><a href="#AdaBoostClassifier.fit-363"><span class="linenos">363</span></a>                <span class="n">w_m</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">w_m</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-364"><a href="#AdaBoostClassifier.fit-364"><span class="linenos">364</span></a>
</span><span id="AdaBoostClassifier.fit-365"><a href="#AdaBoostClassifier.fit-365"><span class="linenos">365</span></a>                <span class="n">base_learner</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-366"><a href="#AdaBoostClassifier.fit-366"><span class="linenos">366</span></a>
</span><span id="AdaBoostClassifier.fit-367"><a href="#AdaBoostClassifier.fit-367"><span class="linenos">367</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AdaBoostClassifier.fit-368"><a href="#AdaBoostClassifier.fit-368"><span class="linenos">368</span></a>                    <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-369"><a href="#AdaBoostClassifier.fit-369"><span class="linenos">369</span></a>
</span><span id="AdaBoostClassifier.fit-370"><a href="#AdaBoostClassifier.fit-370"><span class="linenos">370</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="AdaBoostClassifier.fit-371"><a href="#AdaBoostClassifier.fit-371"><span class="linenos">371</span></a>                <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-372"><a href="#AdaBoostClassifier.fit-372"><span class="linenos">372</span></a>
</span><span id="AdaBoostClassifier.fit-373"><a href="#AdaBoostClassifier.fit-373"><span class="linenos">373</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_learners_</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-374"><a href="#AdaBoostClassifier.fit-374"><span class="linenos">374</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.fit-375"><a href="#AdaBoostClassifier.fit-375"><span class="linenos">375</span></a>
</span><span id="AdaBoostClassifier.fit-376"><a href="#AdaBoostClassifier.fit-376"><span class="linenos">376</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit Boosting model to training data (X, y).</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

y: array-like, shape = [n_samples]
    Target values.

**kwargs: additional parameters to be passed to
        self.cook_training_set or self.obj.fit
</code></pre>

<p>Returns:</p>

<pre><code> self: object
</code></pre>
</div>


                                </div>
                                <div id="AdaBoostClassifier.predict" class="classattr">
                                            <input id="AdaBoostClassifier.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AdaBoostClassifier.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdaBoostClassifier.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdaBoostClassifier.predict-378"><a href="#AdaBoostClassifier.predict-378"><span class="linenos">378</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="AdaBoostClassifier.predict-379"><a href="#AdaBoostClassifier.predict-379"><span class="linenos">379</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="AdaBoostClassifier.predict-380"><a href="#AdaBoostClassifier.predict-380"><span class="linenos">380</span></a>
</span><span id="AdaBoostClassifier.predict-381"><a href="#AdaBoostClassifier.predict-381"><span class="linenos">381</span></a><span class="sd">        Parameters:</span>
</span><span id="AdaBoostClassifier.predict-382"><a href="#AdaBoostClassifier.predict-382"><span class="linenos">382</span></a>
</span><span id="AdaBoostClassifier.predict-383"><a href="#AdaBoostClassifier.predict-383"><span class="linenos">383</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="AdaBoostClassifier.predict-384"><a href="#AdaBoostClassifier.predict-384"><span class="linenos">384</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="AdaBoostClassifier.predict-385"><a href="#AdaBoostClassifier.predict-385"><span class="linenos">385</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="AdaBoostClassifier.predict-386"><a href="#AdaBoostClassifier.predict-386"><span class="linenos">386</span></a>
</span><span id="AdaBoostClassifier.predict-387"><a href="#AdaBoostClassifier.predict-387"><span class="linenos">387</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="AdaBoostClassifier.predict-388"><a href="#AdaBoostClassifier.predict-388"><span class="linenos">388</span></a><span class="sd">                  self.cook_test_set</span>
</span><span id="AdaBoostClassifier.predict-389"><a href="#AdaBoostClassifier.predict-389"><span class="linenos">389</span></a>
</span><span id="AdaBoostClassifier.predict-390"><a href="#AdaBoostClassifier.predict-390"><span class="linenos">390</span></a><span class="sd">        Returns:</span>
</span><span id="AdaBoostClassifier.predict-391"><a href="#AdaBoostClassifier.predict-391"><span class="linenos">391</span></a>
</span><span id="AdaBoostClassifier.predict-392"><a href="#AdaBoostClassifier.predict-392"><span class="linenos">392</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="AdaBoostClassifier.predict-393"><a href="#AdaBoostClassifier.predict-393"><span class="linenos">393</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdaBoostClassifier.predict-394"><a href="#AdaBoostClassifier.predict-394"><span class="linenos">394</span></a>
</span><span id="AdaBoostClassifier.predict-395"><a href="#AdaBoostClassifier.predict-395"><span class="linenos">395</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict test data X.</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
      self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>model predictions: {array-like}
</code></pre>
</div>


                                </div>
                                <div id="AdaBoostClassifier.predict_proba" class="classattr">
                                            <input id="AdaBoostClassifier.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="AdaBoostClassifier.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#AdaBoostClassifier.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="AdaBoostClassifier.predict_proba-397"><a href="#AdaBoostClassifier.predict_proba-397"><span class="linenos">397</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="AdaBoostClassifier.predict_proba-398"><a href="#AdaBoostClassifier.predict_proba-398"><span class="linenos">398</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probabilities for test data X.</span>
</span><span id="AdaBoostClassifier.predict_proba-399"><a href="#AdaBoostClassifier.predict_proba-399"><span class="linenos">399</span></a>
</span><span id="AdaBoostClassifier.predict_proba-400"><a href="#AdaBoostClassifier.predict_proba-400"><span class="linenos">400</span></a><span class="sd">        Parameters:</span>
</span><span id="AdaBoostClassifier.predict_proba-401"><a href="#AdaBoostClassifier.predict_proba-401"><span class="linenos">401</span></a>
</span><span id="AdaBoostClassifier.predict_proba-402"><a href="#AdaBoostClassifier.predict_proba-402"><span class="linenos">402</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="AdaBoostClassifier.predict_proba-403"><a href="#AdaBoostClassifier.predict_proba-403"><span class="linenos">403</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="AdaBoostClassifier.predict_proba-404"><a href="#AdaBoostClassifier.predict_proba-404"><span class="linenos">404</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="AdaBoostClassifier.predict_proba-405"><a href="#AdaBoostClassifier.predict_proba-405"><span class="linenos">405</span></a>
</span><span id="AdaBoostClassifier.predict_proba-406"><a href="#AdaBoostClassifier.predict_proba-406"><span class="linenos">406</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="AdaBoostClassifier.predict_proba-407"><a href="#AdaBoostClassifier.predict_proba-407"><span class="linenos">407</span></a><span class="sd">                  self.cook_test_set</span>
</span><span id="AdaBoostClassifier.predict_proba-408"><a href="#AdaBoostClassifier.predict_proba-408"><span class="linenos">408</span></a>
</span><span id="AdaBoostClassifier.predict_proba-409"><a href="#AdaBoostClassifier.predict_proba-409"><span class="linenos">409</span></a><span class="sd">        Returns:</span>
</span><span id="AdaBoostClassifier.predict_proba-410"><a href="#AdaBoostClassifier.predict_proba-410"><span class="linenos">410</span></a>
</span><span id="AdaBoostClassifier.predict_proba-411"><a href="#AdaBoostClassifier.predict_proba-411"><span class="linenos">411</span></a><span class="sd">            probability estimates for test data: {array-like}</span>
</span><span id="AdaBoostClassifier.predict_proba-412"><a href="#AdaBoostClassifier.predict_proba-412"><span class="linenos">412</span></a>
</span><span id="AdaBoostClassifier.predict_proba-413"><a href="#AdaBoostClassifier.predict_proba-413"><span class="linenos">413</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="AdaBoostClassifier.predict_proba-414"><a href="#AdaBoostClassifier.predict_proba-414"><span class="linenos">414</span></a>
</span><span id="AdaBoostClassifier.predict_proba-415"><a href="#AdaBoostClassifier.predict_proba-415"><span class="linenos">415</span></a>        <span class="n">n_iter</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_learners_</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.predict_proba-416"><a href="#AdaBoostClassifier.predict_proba-416"><span class="linenos">416</span></a>
</span><span id="AdaBoostClassifier.predict_proba-417"><a href="#AdaBoostClassifier.predict_proba-417"><span class="linenos">417</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;SAMME&quot;</span><span class="p">:</span>
</span><span id="AdaBoostClassifier.predict_proba-418"><a href="#AdaBoostClassifier.predict_proba-418"><span class="linenos">418</span></a>            <span class="n">ensemble_learner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">))</span>
</span><span id="AdaBoostClassifier.predict_proba-419"><a href="#AdaBoostClassifier.predict_proba-419"><span class="linenos">419</span></a>
</span><span id="AdaBoostClassifier.predict_proba-420"><a href="#AdaBoostClassifier.predict_proba-420"><span class="linenos">420</span></a>            <span class="c1"># if self.verbose == 1:</span>
</span><span id="AdaBoostClassifier.predict_proba-421"><a href="#AdaBoostClassifier.predict_proba-421"><span class="linenos">421</span></a>            <span class="c1">#    pbar = Progbar(n_iter)</span>
</span><span id="AdaBoostClassifier.predict_proba-422"><a href="#AdaBoostClassifier.predict_proba-422"><span class="linenos">422</span></a>
</span><span id="AdaBoostClassifier.predict_proba-423"><a href="#AdaBoostClassifier.predict_proba-423"><span class="linenos">423</span></a>            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">base_learner</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_learners_</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="AdaBoostClassifier.predict_proba-424"><a href="#AdaBoostClassifier.predict_proba-424"><span class="linenos">424</span></a>                <span class="n">preds</span> <span class="o">=</span> <span class="n">base_learner</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.predict_proba-425"><a href="#AdaBoostClassifier.predict_proba-425"><span class="linenos">425</span></a>
</span><span id="AdaBoostClassifier.predict_proba-426"><a href="#AdaBoostClassifier.predict_proba-426"><span class="linenos">426</span></a>                <span class="n">ensemble_learner</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">mo</span><span class="o">.</span><span class="n">one_hot_encode2</span><span class="p">(</span>
</span><span id="AdaBoostClassifier.predict_proba-427"><a href="#AdaBoostClassifier.predict_proba-427"><span class="linenos">427</span></a>                    <span class="n">preds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span>
</span><span id="AdaBoostClassifier.predict_proba-428"><a href="#AdaBoostClassifier.predict_proba-428"><span class="linenos">428</span></a>                <span class="p">)</span>
</span><span id="AdaBoostClassifier.predict_proba-429"><a href="#AdaBoostClassifier.predict_proba-429"><span class="linenos">429</span></a>
</span><span id="AdaBoostClassifier.predict_proba-430"><a href="#AdaBoostClassifier.predict_proba-430"><span class="linenos">430</span></a>                <span class="c1"># if self.verbose == 1:</span>
</span><span id="AdaBoostClassifier.predict_proba-431"><a href="#AdaBoostClassifier.predict_proba-431"><span class="linenos">431</span></a>                <span class="c1">#    pbar.update(idx)</span>
</span><span id="AdaBoostClassifier.predict_proba-432"><a href="#AdaBoostClassifier.predict_proba-432"><span class="linenos">432</span></a>
</span><span id="AdaBoostClassifier.predict_proba-433"><a href="#AdaBoostClassifier.predict_proba-433"><span class="linenos">433</span></a>            <span class="c1"># if self.verbose == 1:</span>
</span><span id="AdaBoostClassifier.predict_proba-434"><a href="#AdaBoostClassifier.predict_proba-434"><span class="linenos">434</span></a>            <span class="c1">#    pbar.update(n_iter)</span>
</span><span id="AdaBoostClassifier.predict_proba-435"><a href="#AdaBoostClassifier.predict_proba-435"><span class="linenos">435</span></a>
</span><span id="AdaBoostClassifier.predict_proba-436"><a href="#AdaBoostClassifier.predict_proba-436"><span class="linenos">436</span></a>            <span class="n">expit_ensemble_learner</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">ensemble_learner</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.predict_proba-437"><a href="#AdaBoostClassifier.predict_proba-437"><span class="linenos">437</span></a>
</span><span id="AdaBoostClassifier.predict_proba-438"><a href="#AdaBoostClassifier.predict_proba-438"><span class="linenos">438</span></a>            <span class="n">sum_ensemble</span> <span class="o">=</span> <span class="n">expit_ensemble_learner</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.predict_proba-439"><a href="#AdaBoostClassifier.predict_proba-439"><span class="linenos">439</span></a>
</span><span id="AdaBoostClassifier.predict_proba-440"><a href="#AdaBoostClassifier.predict_proba-440"><span class="linenos">440</span></a>            <span class="k">return</span> <span class="n">expit_ensemble_learner</span> <span class="o">/</span> <span class="n">sum_ensemble</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="AdaBoostClassifier.predict_proba-441"><a href="#AdaBoostClassifier.predict_proba-441"><span class="linenos">441</span></a>
</span><span id="AdaBoostClassifier.predict_proba-442"><a href="#AdaBoostClassifier.predict_proba-442"><span class="linenos">442</span></a>        <span class="c1"># if self.method == &quot;SAMME.R&quot;:</span>
</span><span id="AdaBoostClassifier.predict_proba-443"><a href="#AdaBoostClassifier.predict_proba-443"><span class="linenos">443</span></a>        <span class="n">ensemble_learner</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="AdaBoostClassifier.predict_proba-444"><a href="#AdaBoostClassifier.predict_proba-444"><span class="linenos">444</span></a>
</span><span id="AdaBoostClassifier.predict_proba-445"><a href="#AdaBoostClassifier.predict_proba-445"><span class="linenos">445</span></a>        <span class="c1"># if self.verbose == 1:</span>
</span><span id="AdaBoostClassifier.predict_proba-446"><a href="#AdaBoostClassifier.predict_proba-446"><span class="linenos">446</span></a>        <span class="c1">#    pbar = Progbar(n_iter)</span>
</span><span id="AdaBoostClassifier.predict_proba-447"><a href="#AdaBoostClassifier.predict_proba-447"><span class="linenos">447</span></a>
</span><span id="AdaBoostClassifier.predict_proba-448"><a href="#AdaBoostClassifier.predict_proba-448"><span class="linenos">448</span></a>        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">base_learner</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_learners_</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="AdaBoostClassifier.predict_proba-449"><a href="#AdaBoostClassifier.predict_proba-449"><span class="linenos">449</span></a>            <span class="n">probs</span> <span class="o">=</span> <span class="n">base_learner</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.predict_proba-450"><a href="#AdaBoostClassifier.predict_proba-450"><span class="linenos">450</span></a>
</span><span id="AdaBoostClassifier.predict_proba-451"><a href="#AdaBoostClassifier.predict_proba-451"><span class="linenos">451</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">probs</span><span class="p">,</span> <span class="n">a_min</span><span class="o">=</span><span class="mf">2.220446049250313e-16</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">probs</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.predict_proba-452"><a href="#AdaBoostClassifier.predict_proba-452"><span class="linenos">452</span></a>
</span><span id="AdaBoostClassifier.predict_proba-453"><a href="#AdaBoostClassifier.predict_proba-453"><span class="linenos">453</span></a>            <span class="n">log_preds_proba</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.predict_proba-454"><a href="#AdaBoostClassifier.predict_proba-454"><span class="linenos">454</span></a>
</span><span id="AdaBoostClassifier.predict_proba-455"><a href="#AdaBoostClassifier.predict_proba-455"><span class="linenos">455</span></a>            <span class="n">ensemble_learner</span> <span class="o">+=</span> <span class="p">(</span>
</span><span id="AdaBoostClassifier.predict_proba-456"><a href="#AdaBoostClassifier.predict_proba-456"><span class="linenos">456</span></a>                <span class="n">log_preds_proba</span> <span class="o">-</span> <span class="n">log_preds_proba</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="AdaBoostClassifier.predict_proba-457"><a href="#AdaBoostClassifier.predict_proba-457"><span class="linenos">457</span></a>            <span class="p">)</span>
</span><span id="AdaBoostClassifier.predict_proba-458"><a href="#AdaBoostClassifier.predict_proba-458"><span class="linenos">458</span></a>
</span><span id="AdaBoostClassifier.predict_proba-459"><a href="#AdaBoostClassifier.predict_proba-459"><span class="linenos">459</span></a>            <span class="c1"># if self.verbose == 1:</span>
</span><span id="AdaBoostClassifier.predict_proba-460"><a href="#AdaBoostClassifier.predict_proba-460"><span class="linenos">460</span></a>            <span class="c1">#    pbar.update(idx)</span>
</span><span id="AdaBoostClassifier.predict_proba-461"><a href="#AdaBoostClassifier.predict_proba-461"><span class="linenos">461</span></a>
</span><span id="AdaBoostClassifier.predict_proba-462"><a href="#AdaBoostClassifier.predict_proba-462"><span class="linenos">462</span></a>        <span class="n">ensemble_learner</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="AdaBoostClassifier.predict_proba-463"><a href="#AdaBoostClassifier.predict_proba-463"><span class="linenos">463</span></a>
</span><span id="AdaBoostClassifier.predict_proba-464"><a href="#AdaBoostClassifier.predict_proba-464"><span class="linenos">464</span></a>        <span class="c1"># if self.verbose == 1:</span>
</span><span id="AdaBoostClassifier.predict_proba-465"><a href="#AdaBoostClassifier.predict_proba-465"><span class="linenos">465</span></a>        <span class="c1">#    pbar.update(n_iter)</span>
</span><span id="AdaBoostClassifier.predict_proba-466"><a href="#AdaBoostClassifier.predict_proba-466"><span class="linenos">466</span></a>
</span><span id="AdaBoostClassifier.predict_proba-467"><a href="#AdaBoostClassifier.predict_proba-467"><span class="linenos">467</span></a>        <span class="n">expit_ensemble_learner</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">ensemble_learner</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.predict_proba-468"><a href="#AdaBoostClassifier.predict_proba-468"><span class="linenos">468</span></a>
</span><span id="AdaBoostClassifier.predict_proba-469"><a href="#AdaBoostClassifier.predict_proba-469"><span class="linenos">469</span></a>        <span class="n">sum_ensemble</span> <span class="o">=</span> <span class="n">expit_ensemble_learner</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="AdaBoostClassifier.predict_proba-470"><a href="#AdaBoostClassifier.predict_proba-470"><span class="linenos">470</span></a>
</span><span id="AdaBoostClassifier.predict_proba-471"><a href="#AdaBoostClassifier.predict_proba-471"><span class="linenos">471</span></a>        <span class="k">return</span> <span class="n">expit_ensemble_learner</span> <span class="o">/</span> <span class="n">sum_ensemble</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Predict probabilities for test data X.</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
      self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>probability estimates for test data: {array-like}
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="Base">
                            <input id="Base-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Base</span><wbr>(<span class="base">sklearn.base.BaseEstimator</span>):

                <label class="view-source-button" for="Base-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Base"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Base-32"><a href="#Base-32"><span class="linenos"> 32</span></a><span class="k">class</span> <span class="nc">Base</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">):</span>
</span><span id="Base-33"><a href="#Base-33"><span class="linenos"> 33</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Base model from which all the other classes inherit.</span>
</span><span id="Base-34"><a href="#Base-34"><span class="linenos"> 34</span></a>
</span><span id="Base-35"><a href="#Base-35"><span class="linenos"> 35</span></a><span class="sd">    This class contains the most important data preprocessing/feature engineering methods.</span>
</span><span id="Base-36"><a href="#Base-36"><span class="linenos"> 36</span></a>
</span><span id="Base-37"><a href="#Base-37"><span class="linenos"> 37</span></a><span class="sd">    Parameters:</span>
</span><span id="Base-38"><a href="#Base-38"><span class="linenos"> 38</span></a>
</span><span id="Base-39"><a href="#Base-39"><span class="linenos"> 39</span></a><span class="sd">        n_hidden_features: int</span>
</span><span id="Base-40"><a href="#Base-40"><span class="linenos"> 40</span></a><span class="sd">            number of nodes in the hidden layer</span>
</span><span id="Base-41"><a href="#Base-41"><span class="linenos"> 41</span></a>
</span><span id="Base-42"><a href="#Base-42"><span class="linenos"> 42</span></a><span class="sd">        activation_name: str</span>
</span><span id="Base-43"><a href="#Base-43"><span class="linenos"> 43</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;</span>
</span><span id="Base-44"><a href="#Base-44"><span class="linenos"> 44</span></a>
</span><span id="Base-45"><a href="#Base-45"><span class="linenos"> 45</span></a><span class="sd">        a: float</span>
</span><span id="Base-46"><a href="#Base-46"><span class="linenos"> 46</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function</span>
</span><span id="Base-47"><a href="#Base-47"><span class="linenos"> 47</span></a>
</span><span id="Base-48"><a href="#Base-48"><span class="linenos"> 48</span></a><span class="sd">        nodes_sim: str</span>
</span><span id="Base-49"><a href="#Base-49"><span class="linenos"> 49</span></a><span class="sd">            type of simulation for hidden layer nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;,</span>
</span><span id="Base-50"><a href="#Base-50"><span class="linenos"> 50</span></a><span class="sd">            &#39;uniform&#39;</span>
</span><span id="Base-51"><a href="#Base-51"><span class="linenos"> 51</span></a>
</span><span id="Base-52"><a href="#Base-52"><span class="linenos"> 52</span></a><span class="sd">        bias: boolean</span>
</span><span id="Base-53"><a href="#Base-53"><span class="linenos"> 53</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or</span>
</span><span id="Base-54"><a href="#Base-54"><span class="linenos"> 54</span></a><span class="sd">            not (False)</span>
</span><span id="Base-55"><a href="#Base-55"><span class="linenos"> 55</span></a>
</span><span id="Base-56"><a href="#Base-56"><span class="linenos"> 56</span></a><span class="sd">        dropout: float</span>
</span><span id="Base-57"><a href="#Base-57"><span class="linenos"> 57</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="Base-58"><a href="#Base-58"><span class="linenos"> 58</span></a><span class="sd">            of the training</span>
</span><span id="Base-59"><a href="#Base-59"><span class="linenos"> 59</span></a>
</span><span id="Base-60"><a href="#Base-60"><span class="linenos"> 60</span></a><span class="sd">        direct_link: boolean</span>
</span><span id="Base-61"><a href="#Base-61"><span class="linenos"> 61</span></a><span class="sd">            indicates if the original features are included (True) in model&#39;s</span>
</span><span id="Base-62"><a href="#Base-62"><span class="linenos"> 62</span></a><span class="sd">            fitting or not (False)</span>
</span><span id="Base-63"><a href="#Base-63"><span class="linenos"> 63</span></a>
</span><span id="Base-64"><a href="#Base-64"><span class="linenos"> 64</span></a><span class="sd">        n_clusters: int</span>
</span><span id="Base-65"><a href="#Base-65"><span class="linenos"> 65</span></a><span class="sd">            number of clusters for type_clust=&#39;kmeans&#39; or type_clust=&#39;gmm&#39;</span>
</span><span id="Base-66"><a href="#Base-66"><span class="linenos"> 66</span></a><span class="sd">            clustering (could be 0: no clustering)</span>
</span><span id="Base-67"><a href="#Base-67"><span class="linenos"> 67</span></a>
</span><span id="Base-68"><a href="#Base-68"><span class="linenos"> 68</span></a><span class="sd">        cluster_encode: bool</span>
</span><span id="Base-69"><a href="#Base-69"><span class="linenos"> 69</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot);</span>
</span><span id="Base-70"><a href="#Base-70"><span class="linenos"> 70</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding</span>
</span><span id="Base-71"><a href="#Base-71"><span class="linenos"> 71</span></a>
</span><span id="Base-72"><a href="#Base-72"><span class="linenos"> 72</span></a><span class="sd">        type_clust: str</span>
</span><span id="Base-73"><a href="#Base-73"><span class="linenos"> 73</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian</span>
</span><span id="Base-74"><a href="#Base-74"><span class="linenos"> 74</span></a><span class="sd">            Mixture Model (&#39;gmm&#39;)</span>
</span><span id="Base-75"><a href="#Base-75"><span class="linenos"> 75</span></a>
</span><span id="Base-76"><a href="#Base-76"><span class="linenos"> 76</span></a><span class="sd">        type_scaling: a tuple of 3 strings</span>
</span><span id="Base-77"><a href="#Base-77"><span class="linenos"> 77</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="Base-78"><a href="#Base-78"><span class="linenos"> 78</span></a><span class="sd">            (and when relevant).</span>
</span><span id="Base-79"><a href="#Base-79"><span class="linenos"> 79</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;) or robust scaling (&#39;robust&#39;)</span>
</span><span id="Base-80"><a href="#Base-80"><span class="linenos"> 80</span></a>
</span><span id="Base-81"><a href="#Base-81"><span class="linenos"> 81</span></a><span class="sd">        col_sample: float</span>
</span><span id="Base-82"><a href="#Base-82"><span class="linenos"> 82</span></a><span class="sd">            percentage of features randomly chosen for training</span>
</span><span id="Base-83"><a href="#Base-83"><span class="linenos"> 83</span></a>
</span><span id="Base-84"><a href="#Base-84"><span class="linenos"> 84</span></a><span class="sd">        row_sample: float</span>
</span><span id="Base-85"><a href="#Base-85"><span class="linenos"> 85</span></a><span class="sd">            percentage of rows chosen for training, by stratified bootstrapping</span>
</span><span id="Base-86"><a href="#Base-86"><span class="linenos"> 86</span></a>
</span><span id="Base-87"><a href="#Base-87"><span class="linenos"> 87</span></a><span class="sd">        seed: int</span>
</span><span id="Base-88"><a href="#Base-88"><span class="linenos"> 88</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39;, clustering and dropout</span>
</span><span id="Base-89"><a href="#Base-89"><span class="linenos"> 89</span></a>
</span><span id="Base-90"><a href="#Base-90"><span class="linenos"> 90</span></a><span class="sd">        backend: str</span>
</span><span id="Base-91"><a href="#Base-91"><span class="linenos"> 91</span></a><span class="sd">            &quot;cpu&quot; or &quot;gpu&quot; or &quot;tpu&quot;</span>
</span><span id="Base-92"><a href="#Base-92"><span class="linenos"> 92</span></a>
</span><span id="Base-93"><a href="#Base-93"><span class="linenos"> 93</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Base-94"><a href="#Base-94"><span class="linenos"> 94</span></a>
</span><span id="Base-95"><a href="#Base-95"><span class="linenos"> 95</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="Base-96"><a href="#Base-96"><span class="linenos"> 96</span></a>
</span><span id="Base-97"><a href="#Base-97"><span class="linenos"> 97</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Base-98"><a href="#Base-98"><span class="linenos"> 98</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Base-99"><a href="#Base-99"><span class="linenos"> 99</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="Base-100"><a href="#Base-100"><span class="linenos">100</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="Base-101"><a href="#Base-101"><span class="linenos">101</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="Base-102"><a href="#Base-102"><span class="linenos">102</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="Base-103"><a href="#Base-103"><span class="linenos">103</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Base-104"><a href="#Base-104"><span class="linenos">104</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Base-105"><a href="#Base-105"><span class="linenos">105</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Base-106"><a href="#Base-106"><span class="linenos">106</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="Base-107"><a href="#Base-107"><span class="linenos">107</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Base-108"><a href="#Base-108"><span class="linenos">108</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="Base-109"><a href="#Base-109"><span class="linenos">109</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="Base-110"><a href="#Base-110"><span class="linenos">110</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Base-111"><a href="#Base-111"><span class="linenos">111</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Base-112"><a href="#Base-112"><span class="linenos">112</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="Base-113"><a href="#Base-113"><span class="linenos">113</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="Base-114"><a href="#Base-114"><span class="linenos">114</span></a>    <span class="p">):</span>
</span><span id="Base-115"><a href="#Base-115"><span class="linenos">115</span></a>        <span class="c1"># input checks -----</span>
</span><span id="Base-116"><a href="#Base-116"><span class="linenos">116</span></a>
</span><span id="Base-117"><a href="#Base-117"><span class="linenos">117</span></a>        <span class="n">sys_platform</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
</span><span id="Base-118"><a href="#Base-118"><span class="linenos">118</span></a>
</span><span id="Base-119"><a href="#Base-119"><span class="linenos">119</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">sys_platform</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">backend</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;gpu&quot;</span><span class="p">,</span> <span class="s2">&quot;tpu&quot;</span><span class="p">)):</span>
</span><span id="Base-120"><a href="#Base-120"><span class="linenos">120</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="Base-121"><a href="#Base-121"><span class="linenos">121</span></a>                <span class="s2">&quot;No GPU/TPU computing on Windows yet, backend set to &#39;cpu&#39;&quot;</span>
</span><span id="Base-122"><a href="#Base-122"><span class="linenos">122</span></a>            <span class="p">)</span>
</span><span id="Base-123"><a href="#Base-123"><span class="linenos">123</span></a>            <span class="n">backend</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span>
</span><span id="Base-124"><a href="#Base-124"><span class="linenos">124</span></a>
</span><span id="Base-125"><a href="#Base-125"><span class="linenos">125</span></a>        <span class="k">assert</span> <span class="n">activation_name</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="Base-126"><a href="#Base-126"><span class="linenos">126</span></a>            <span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="Base-127"><a href="#Base-127"><span class="linenos">127</span></a>            <span class="s2">&quot;tanh&quot;</span><span class="p">,</span>
</span><span id="Base-128"><a href="#Base-128"><span class="linenos">128</span></a>            <span class="s2">&quot;sigmoid&quot;</span><span class="p">,</span>
</span><span id="Base-129"><a href="#Base-129"><span class="linenos">129</span></a>            <span class="s2">&quot;prelu&quot;</span><span class="p">,</span>
</span><span id="Base-130"><a href="#Base-130"><span class="linenos">130</span></a>            <span class="s2">&quot;elu&quot;</span><span class="p">,</span>
</span><span id="Base-131"><a href="#Base-131"><span class="linenos">131</span></a>        <span class="p">),</span> <span class="s2">&quot;&#39;activation_name&#39; must be in (&#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;,&#39;prelu&#39;, &#39;elu&#39;)&quot;</span>
</span><span id="Base-132"><a href="#Base-132"><span class="linenos">132</span></a>
</span><span id="Base-133"><a href="#Base-133"><span class="linenos">133</span></a>        <span class="k">assert</span> <span class="n">nodes_sim</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="Base-134"><a href="#Base-134"><span class="linenos">134</span></a>            <span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="Base-135"><a href="#Base-135"><span class="linenos">135</span></a>            <span class="s2">&quot;hammersley&quot;</span><span class="p">,</span>
</span><span id="Base-136"><a href="#Base-136"><span class="linenos">136</span></a>            <span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
</span><span id="Base-137"><a href="#Base-137"><span class="linenos">137</span></a>            <span class="s2">&quot;halton&quot;</span><span class="p">,</span>
</span><span id="Base-138"><a href="#Base-138"><span class="linenos">138</span></a>        <span class="p">),</span> <span class="s2">&quot;&#39;nodes_sim&#39; must be in (&#39;sobol&#39;, &#39;hammersley&#39;, &#39;uniform&#39;, &#39;halton&#39;)&quot;</span>
</span><span id="Base-139"><a href="#Base-139"><span class="linenos">139</span></a>
</span><span id="Base-140"><a href="#Base-140"><span class="linenos">140</span></a>        <span class="k">assert</span> <span class="n">type_clust</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="Base-141"><a href="#Base-141"><span class="linenos">141</span></a>            <span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="Base-142"><a href="#Base-142"><span class="linenos">142</span></a>            <span class="s2">&quot;gmm&quot;</span><span class="p">,</span>
</span><span id="Base-143"><a href="#Base-143"><span class="linenos">143</span></a>        <span class="p">),</span> <span class="s2">&quot;&#39;type_clust&#39; must be in (&#39;kmeans&#39;, &#39;gmm&#39;)&quot;</span>
</span><span id="Base-144"><a href="#Base-144"><span class="linenos">144</span></a>
</span><span id="Base-145"><a href="#Base-145"><span class="linenos">145</span></a>        <span class="k">assert</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">type_scaling</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="Base-146"><a href="#Base-146"><span class="linenos">146</span></a>            <span class="n">type_scaling</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;minmax&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;robust&quot;</span><span class="p">)</span>
</span><span id="Base-147"><a href="#Base-147"><span class="linenos">147</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">type_scaling</span><span class="p">))</span>
</span><span id="Base-148"><a href="#Base-148"><span class="linenos">148</span></a>        <span class="p">),</span> <span class="s2">&quot;&#39;type_scaling&#39; must have length 3, and available scaling methods are &#39;minmax&#39; scaling, standardization (&#39;std&#39;) and robust scaling (&#39;robust&#39;)&quot;</span>
</span><span id="Base-149"><a href="#Base-149"><span class="linenos">149</span></a>
</span><span id="Base-150"><a href="#Base-150"><span class="linenos">150</span></a>        <span class="k">assert</span> <span class="p">(</span><span class="n">col_sample</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
</span><span id="Base-151"><a href="#Base-151"><span class="linenos">151</span></a>            <span class="n">col_sample</span> <span class="o">&lt;=</span> <span class="mi">1</span>
</span><span id="Base-152"><a href="#Base-152"><span class="linenos">152</span></a>        <span class="p">),</span> <span class="s2">&quot;&#39;col_sample&#39; must be comprised between 0 and 1 (both included)&quot;</span>
</span><span id="Base-153"><a href="#Base-153"><span class="linenos">153</span></a>
</span><span id="Base-154"><a href="#Base-154"><span class="linenos">154</span></a>        <span class="k">assert</span> <span class="n">backend</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="Base-155"><a href="#Base-155"><span class="linenos">155</span></a>            <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="Base-156"><a href="#Base-156"><span class="linenos">156</span></a>            <span class="s2">&quot;gpu&quot;</span><span class="p">,</span>
</span><span id="Base-157"><a href="#Base-157"><span class="linenos">157</span></a>            <span class="s2">&quot;tpu&quot;</span><span class="p">,</span>
</span><span id="Base-158"><a href="#Base-158"><span class="linenos">158</span></a>        <span class="p">),</span> <span class="s2">&quot;must have &#39;backend&#39; in (&#39;cpu&#39;, &#39;gpu&#39;, &#39;tpu&#39;)&quot;</span>
</span><span id="Base-159"><a href="#Base-159"><span class="linenos">159</span></a>
</span><span id="Base-160"><a href="#Base-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span> <span class="o">=</span> <span class="n">n_hidden_features</span>
</span><span id="Base-161"><a href="#Base-161"><span class="linenos">161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span> <span class="o">=</span> <span class="n">activation_name</span>
</span><span id="Base-162"><a href="#Base-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
</span><span id="Base-163"><a href="#Base-163"><span class="linenos">163</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span> <span class="o">=</span> <span class="n">nodes_sim</span>
</span><span id="Base-164"><a href="#Base-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">bias</span>
</span><span id="Base-165"><a href="#Base-165"><span class="linenos">165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
</span><span id="Base-166"><a href="#Base-166"><span class="linenos">166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">=</span> <span class="n">backend</span>
</span><span id="Base-167"><a href="#Base-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">dropout</span>
</span><span id="Base-168"><a href="#Base-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span> <span class="o">=</span> <span class="n">direct_link</span>
</span><span id="Base-169"><a href="#Base-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span> <span class="o">=</span> <span class="n">cluster_encode</span>
</span><span id="Base-170"><a href="#Base-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span> <span class="o">=</span> <span class="n">type_clust</span>
</span><span id="Base-171"><a href="#Base-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span> <span class="o">=</span> <span class="n">type_scaling</span>
</span><span id="Base-172"><a href="#Base-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span> <span class="o">=</span> <span class="n">col_sample</span>
</span><span id="Base-173"><a href="#Base-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span> <span class="o">=</span> <span class="n">row_sample</span>
</span><span id="Base-174"><a href="#Base-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span> <span class="o">=</span> <span class="n">n_clusters</span>
</span><span id="Base-175"><a href="#Base-175"><span class="linenos">175</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">RegressorMixin</span><span class="p">):</span>
</span><span id="Base-176"><a href="#Base-176"><span class="linenos">176</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">type_fit</span> <span class="o">=</span> <span class="s2">&quot;regression&quot;</span>
</span><span id="Base-177"><a href="#Base-177"><span class="linenos">177</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">):</span>
</span><span id="Base-178"><a href="#Base-178"><span class="linenos">178</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">type_fit</span> <span class="o">=</span> <span class="s2">&quot;classification&quot;</span>
</span><span id="Base-179"><a href="#Base-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">subsampler_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Base-180"><a href="#Base-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_col_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Base-181"><a href="#Base-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Base-182"><a href="#Base-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clustering_obj_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Base-183"><a href="#Base-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clustering_scaler_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Base-184"><a href="#Base-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nn_scaler_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Base-185"><a href="#Base-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Base-186"><a href="#Base-186"><span class="linenos">186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">encoder_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Base-187"><a href="#Base-187"><span class="linenos">187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Base-188"><a href="#Base-188"><span class="linenos">188</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Base-189"><a href="#Base-189"><span class="linenos">189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Base-190"><a href="#Base-190"><span class="linenos">190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Base-191"><a href="#Base-191"><span class="linenos">191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Base-192"><a href="#Base-192"><span class="linenos">192</span></a>
</span><span id="Base-193"><a href="#Base-193"><span class="linenos">193</span></a>        <span class="c1"># activation function -----</span>
</span><span id="Base-194"><a href="#Base-194"><span class="linenos">194</span></a>        <span class="k">if</span> <span class="n">sys_platform</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Linux&quot;</span><span class="p">,</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">):</span>
</span><span id="Base-195"><a href="#Base-195"><span class="linenos">195</span></a>            <span class="n">activation_options</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Base-196"><a href="#Base-196"><span class="linenos">196</span></a>                <span class="s2">&quot;relu&quot;</span><span class="p">:</span> <span class="n">ac</span><span class="o">.</span><span class="n">relu</span> <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">jnn</span><span class="o">.</span><span class="n">relu</span><span class="p">,</span>
</span><span id="Base-197"><a href="#Base-197"><span class="linenos">197</span></a>                <span class="s2">&quot;tanh&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span> <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">jnp</span><span class="o">.</span><span class="n">tanh</span><span class="p">,</span>
</span><span id="Base-198"><a href="#Base-198"><span class="linenos">198</span></a>                <span class="s2">&quot;sigmoid&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="Base-199"><a href="#Base-199"><span class="linenos">199</span></a>                    <span class="n">ac</span><span class="o">.</span><span class="n">sigmoid</span> <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="n">jnn</span><span class="o">.</span><span class="n">sigmoid</span>
</span><span id="Base-200"><a href="#Base-200"><span class="linenos">200</span></a>                <span class="p">),</span>
</span><span id="Base-201"><a href="#Base-201"><span class="linenos">201</span></a>                <span class="s2">&quot;prelu&quot;</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">prelu</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">),</span>
</span><span id="Base-202"><a href="#Base-202"><span class="linenos">202</span></a>                <span class="s2">&quot;elu&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="Base-203"><a href="#Base-203"><span class="linenos">203</span></a>                    <span class="n">partial</span><span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">elu</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
</span><span id="Base-204"><a href="#Base-204"><span class="linenos">204</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
</span><span id="Base-205"><a href="#Base-205"><span class="linenos">205</span></a>                    <span class="k">else</span> <span class="n">partial</span><span class="p">(</span><span class="n">jnn</span><span class="o">.</span><span class="n">elu</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
</span><span id="Base-206"><a href="#Base-206"><span class="linenos">206</span></a>                <span class="p">),</span>
</span><span id="Base-207"><a href="#Base-207"><span class="linenos">207</span></a>            <span class="p">}</span>
</span><span id="Base-208"><a href="#Base-208"><span class="linenos">208</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># on Windows currently, no JAX</span>
</span><span id="Base-209"><a href="#Base-209"><span class="linenos">209</span></a>            <span class="n">activation_options</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Base-210"><a href="#Base-210"><span class="linenos">210</span></a>                <span class="s2">&quot;relu&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="Base-211"><a href="#Base-211"><span class="linenos">211</span></a>                    <span class="n">ac</span><span class="o">.</span><span class="n">relu</span> <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="ne">NotImplementedError</span>
</span><span id="Base-212"><a href="#Base-212"><span class="linenos">212</span></a>                <span class="p">),</span>
</span><span id="Base-213"><a href="#Base-213"><span class="linenos">213</span></a>                <span class="s2">&quot;tanh&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="Base-214"><a href="#Base-214"><span class="linenos">214</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">tanh</span> <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="ne">NotImplementedError</span>
</span><span id="Base-215"><a href="#Base-215"><span class="linenos">215</span></a>                <span class="p">),</span>
</span><span id="Base-216"><a href="#Base-216"><span class="linenos">216</span></a>                <span class="s2">&quot;sigmoid&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="Base-217"><a href="#Base-217"><span class="linenos">217</span></a>                    <span class="n">ac</span><span class="o">.</span><span class="n">sigmoid</span>
</span><span id="Base-218"><a href="#Base-218"><span class="linenos">218</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
</span><span id="Base-219"><a href="#Base-219"><span class="linenos">219</span></a>                    <span class="k">else</span> <span class="ne">NotImplementedError</span>
</span><span id="Base-220"><a href="#Base-220"><span class="linenos">220</span></a>                <span class="p">),</span>
</span><span id="Base-221"><a href="#Base-221"><span class="linenos">221</span></a>                <span class="s2">&quot;prelu&quot;</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">prelu</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">),</span>
</span><span id="Base-222"><a href="#Base-222"><span class="linenos">222</span></a>                <span class="s2">&quot;elu&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="Base-223"><a href="#Base-223"><span class="linenos">223</span></a>                    <span class="n">partial</span><span class="p">(</span><span class="n">ac</span><span class="o">.</span><span class="n">elu</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
</span><span id="Base-224"><a href="#Base-224"><span class="linenos">224</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
</span><span id="Base-225"><a href="#Base-225"><span class="linenos">225</span></a>                    <span class="k">else</span> <span class="ne">NotImplementedError</span>
</span><span id="Base-226"><a href="#Base-226"><span class="linenos">226</span></a>                <span class="p">),</span>
</span><span id="Base-227"><a href="#Base-227"><span class="linenos">227</span></a>            <span class="p">}</span>
</span><span id="Base-228"><a href="#Base-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">activation_func</span> <span class="o">=</span> <span class="n">activation_options</span><span class="p">[</span><span class="n">activation_name</span><span class="p">]</span>
</span><span id="Base-229"><a href="#Base-229"><span class="linenos">229</span></a>
</span><span id="Base-230"><a href="#Base-230"><span class="linenos">230</span></a>    <span class="c1"># &quot;preprocessing&quot; methods to be inherited -----</span>
</span><span id="Base-231"><a href="#Base-231"><span class="linenos">231</span></a>
</span><span id="Base-232"><a href="#Base-232"><span class="linenos">232</span></a>    <span class="k">def</span> <span class="nf">encode_clusters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">predict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1">#</span>
</span><span id="Base-233"><a href="#Base-233"><span class="linenos">233</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create new covariates with kmeans or GMM clustering</span>
</span><span id="Base-234"><a href="#Base-234"><span class="linenos">234</span></a>
</span><span id="Base-235"><a href="#Base-235"><span class="linenos">235</span></a><span class="sd">        Parameters:</span>
</span><span id="Base-236"><a href="#Base-236"><span class="linenos">236</span></a>
</span><span id="Base-237"><a href="#Base-237"><span class="linenos">237</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Base-238"><a href="#Base-238"><span class="linenos">238</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Base-239"><a href="#Base-239"><span class="linenos">239</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Base-240"><a href="#Base-240"><span class="linenos">240</span></a>
</span><span id="Base-241"><a href="#Base-241"><span class="linenos">241</span></a><span class="sd">            predict: boolean</span>
</span><span id="Base-242"><a href="#Base-242"><span class="linenos">242</span></a><span class="sd">                is False on training set and True on test set</span>
</span><span id="Base-243"><a href="#Base-243"><span class="linenos">243</span></a>
</span><span id="Base-244"><a href="#Base-244"><span class="linenos">244</span></a><span class="sd">            **kwargs:</span>
</span><span id="Base-245"><a href="#Base-245"><span class="linenos">245</span></a><span class="sd">                additional parameters to be passed to the</span>
</span><span id="Base-246"><a href="#Base-246"><span class="linenos">246</span></a><span class="sd">                clustering method</span>
</span><span id="Base-247"><a href="#Base-247"><span class="linenos">247</span></a>
</span><span id="Base-248"><a href="#Base-248"><span class="linenos">248</span></a><span class="sd">        Returns:</span>
</span><span id="Base-249"><a href="#Base-249"><span class="linenos">249</span></a>
</span><span id="Base-250"><a href="#Base-250"><span class="linenos">250</span></a><span class="sd">            Clusters&#39; matrix, one-hot encoded: {array-like}</span>
</span><span id="Base-251"><a href="#Base-251"><span class="linenos">251</span></a>
</span><span id="Base-252"><a href="#Base-252"><span class="linenos">252</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Base-253"><a href="#Base-253"><span class="linenos">253</span></a>
</span><span id="Base-254"><a href="#Base-254"><span class="linenos">254</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="Base-255"><a href="#Base-255"><span class="linenos">255</span></a>
</span><span id="Base-256"><a href="#Base-256"><span class="linenos">256</span></a>        <span class="k">if</span> <span class="n">X</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Base-257"><a href="#Base-257"><span class="linenos">257</span></a>            <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span>
</span><span id="Base-258"><a href="#Base-258"><span class="linenos">258</span></a>
</span><span id="Base-259"><a href="#Base-259"><span class="linenos">259</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Base-260"><a href="#Base-260"><span class="linenos">260</span></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
</span><span id="Base-261"><a href="#Base-261"><span class="linenos">261</span></a>
</span><span id="Base-262"><a href="#Base-262"><span class="linenos">262</span></a>        <span class="k">if</span> <span class="n">predict</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>  <span class="c1"># encode training set</span>
</span><span id="Base-263"><a href="#Base-263"><span class="linenos">263</span></a>            <span class="c1"># scale input data before clustering</span>
</span><span id="Base-264"><a href="#Base-264"><span class="linenos">264</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">clustering_scaler_</span><span class="p">,</span> <span class="n">scaled_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">scale_covariates</span><span class="p">(</span>
</span><span id="Base-265"><a href="#Base-265"><span class="linenos">265</span></a>                <span class="n">X</span><span class="p">,</span> <span class="n">choice</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Base-266"><a href="#Base-266"><span class="linenos">266</span></a>            <span class="p">)</span>
</span><span id="Base-267"><a href="#Base-267"><span class="linenos">267</span></a>
</span><span id="Base-268"><a href="#Base-268"><span class="linenos">268</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">clustering_obj_</span><span class="p">,</span> <span class="n">X_clustered</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">cluster_covariates</span><span class="p">(</span>
</span><span id="Base-269"><a href="#Base-269"><span class="linenos">269</span></a>                <span class="n">scaled_X</span><span class="p">,</span>
</span><span id="Base-270"><a href="#Base-270"><span class="linenos">270</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="Base-271"><a href="#Base-271"><span class="linenos">271</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base-272"><a href="#Base-272"><span class="linenos">272</span></a>                <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="Base-273"><a href="#Base-273"><span class="linenos">273</span></a>                <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Base-274"><a href="#Base-274"><span class="linenos">274</span></a>            <span class="p">)</span>
</span><span id="Base-275"><a href="#Base-275"><span class="linenos">275</span></a>
</span><span id="Base-276"><a href="#Base-276"><span class="linenos">276</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Base-277"><a href="#Base-277"><span class="linenos">277</span></a>                <span class="k">return</span> <span class="n">mo</span><span class="o">.</span><span class="n">one_hot_encode</span><span class="p">(</span><span class="n">X_clustered</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
</span><span id="Base-278"><a href="#Base-278"><span class="linenos">278</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">float16</span>
</span><span id="Base-279"><a href="#Base-279"><span class="linenos">279</span></a>                <span class="p">)</span>
</span><span id="Base-280"><a href="#Base-280"><span class="linenos">280</span></a>
</span><span id="Base-281"><a href="#Base-281"><span class="linenos">281</span></a>            <span class="k">return</span> <span class="n">X_clustered</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
</span><span id="Base-282"><a href="#Base-282"><span class="linenos">282</span></a>
</span><span id="Base-283"><a href="#Base-283"><span class="linenos">283</span></a>        <span class="c1"># if predict == True, encode test set</span>
</span><span id="Base-284"><a href="#Base-284"><span class="linenos">284</span></a>        <span class="n">X_clustered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clustering_obj_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="Base-285"><a href="#Base-285"><span class="linenos">285</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">clustering_scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="Base-286"><a href="#Base-286"><span class="linenos">286</span></a>        <span class="p">)</span>
</span><span id="Base-287"><a href="#Base-287"><span class="linenos">287</span></a>
</span><span id="Base-288"><a href="#Base-288"><span class="linenos">288</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Base-289"><a href="#Base-289"><span class="linenos">289</span></a>            <span class="k">return</span> <span class="n">mo</span><span class="o">.</span><span class="n">one_hot_encode</span><span class="p">(</span><span class="n">X_clustered</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
</span><span id="Base-290"><a href="#Base-290"><span class="linenos">290</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">float16</span>
</span><span id="Base-291"><a href="#Base-291"><span class="linenos">291</span></a>            <span class="p">)</span>
</span><span id="Base-292"><a href="#Base-292"><span class="linenos">292</span></a>
</span><span id="Base-293"><a href="#Base-293"><span class="linenos">293</span></a>        <span class="k">return</span> <span class="n">X_clustered</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
</span><span id="Base-294"><a href="#Base-294"><span class="linenos">294</span></a>
</span><span id="Base-295"><a href="#Base-295"><span class="linenos">295</span></a>    <span class="k">def</span> <span class="nf">create_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scaled_X</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Base-296"><a href="#Base-296"><span class="linenos">296</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create hidden layer.</span>
</span><span id="Base-297"><a href="#Base-297"><span class="linenos">297</span></a>
</span><span id="Base-298"><a href="#Base-298"><span class="linenos">298</span></a><span class="sd">        Parameters:</span>
</span><span id="Base-299"><a href="#Base-299"><span class="linenos">299</span></a>
</span><span id="Base-300"><a href="#Base-300"><span class="linenos">300</span></a><span class="sd">            scaled_X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Base-301"><a href="#Base-301"><span class="linenos">301</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Base-302"><a href="#Base-302"><span class="linenos">302</span></a><span class="sd">                of samples and n_features is the number of features</span>
</span><span id="Base-303"><a href="#Base-303"><span class="linenos">303</span></a>
</span><span id="Base-304"><a href="#Base-304"><span class="linenos">304</span></a><span class="sd">            W: {array-like}, shape = [n_features, hidden_features]</span>
</span><span id="Base-305"><a href="#Base-305"><span class="linenos">305</span></a><span class="sd">                if provided, constructs the hidden layer with W; otherwise computed internally</span>
</span><span id="Base-306"><a href="#Base-306"><span class="linenos">306</span></a>
</span><span id="Base-307"><a href="#Base-307"><span class="linenos">307</span></a><span class="sd">        Returns:</span>
</span><span id="Base-308"><a href="#Base-308"><span class="linenos">308</span></a>
</span><span id="Base-309"><a href="#Base-309"><span class="linenos">309</span></a><span class="sd">            Hidden layer matrix: {array-like}</span>
</span><span id="Base-310"><a href="#Base-310"><span class="linenos">310</span></a>
</span><span id="Base-311"><a href="#Base-311"><span class="linenos">311</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Base-312"><a href="#Base-312"><span class="linenos">312</span></a>
</span><span id="Base-313"><a href="#Base-313"><span class="linenos">313</span></a>        <span class="n">n_features</span> <span class="o">=</span> <span class="n">scaled_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Base-314"><a href="#Base-314"><span class="linenos">314</span></a>
</span><span id="Base-315"><a href="#Base-315"><span class="linenos">315</span></a>        <span class="c1"># hash_sim = {</span>
</span><span id="Base-316"><a href="#Base-316"><span class="linenos">316</span></a>        <span class="c1">#         &quot;sobol&quot;: generate_sobol,</span>
</span><span id="Base-317"><a href="#Base-317"><span class="linenos">317</span></a>        <span class="c1">#         &quot;hammersley&quot;: generate_hammersley,</span>
</span><span id="Base-318"><a href="#Base-318"><span class="linenos">318</span></a>        <span class="c1">#         &quot;uniform&quot;: generate_uniform,</span>
</span><span id="Base-319"><a href="#Base-319"><span class="linenos">319</span></a>        <span class="c1">#         &quot;halton&quot;: generate_halton</span>
</span><span id="Base-320"><a href="#Base-320"><span class="linenos">320</span></a>        <span class="c1">#     }</span>
</span><span id="Base-321"><a href="#Base-321"><span class="linenos">321</span></a>
</span><span id="Base-322"><a href="#Base-322"><span class="linenos">322</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>  <span class="c1"># no bias term in the hidden layer</span>
</span><span id="Base-323"><a href="#Base-323"><span class="linenos">323</span></a>            <span class="k">if</span> <span class="n">W</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Base-324"><a href="#Base-324"><span class="linenos">324</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span> <span class="o">==</span> <span class="s2">&quot;sobol&quot;</span><span class="p">:</span>
</span><span id="Base-325"><a href="#Base-325"><span class="linenos">325</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="n">generate_sobol</span><span class="p">(</span>
</span><span id="Base-326"><a href="#Base-326"><span class="linenos">326</span></a>                        <span class="n">n_dims</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span>
</span><span id="Base-327"><a href="#Base-327"><span class="linenos">327</span></a>                        <span class="n">n_points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Base-328"><a href="#Base-328"><span class="linenos">328</span></a>                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base-329"><a href="#Base-329"><span class="linenos">329</span></a>                    <span class="p">)</span>
</span><span id="Base-330"><a href="#Base-330"><span class="linenos">330</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span> <span class="o">==</span> <span class="s2">&quot;hammersley&quot;</span><span class="p">:</span>
</span><span id="Base-331"><a href="#Base-331"><span class="linenos">331</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="n">generate_hammersley</span><span class="p">(</span>
</span><span id="Base-332"><a href="#Base-332"><span class="linenos">332</span></a>                        <span class="n">n_dims</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span>
</span><span id="Base-333"><a href="#Base-333"><span class="linenos">333</span></a>                        <span class="n">n_points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Base-334"><a href="#Base-334"><span class="linenos">334</span></a>                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base-335"><a href="#Base-335"><span class="linenos">335</span></a>                    <span class="p">)</span>
</span><span id="Base-336"><a href="#Base-336"><span class="linenos">336</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span> <span class="o">==</span> <span class="s2">&quot;uniform&quot;</span><span class="p">:</span>
</span><span id="Base-337"><a href="#Base-337"><span class="linenos">337</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="n">generate_uniform</span><span class="p">(</span>
</span><span id="Base-338"><a href="#Base-338"><span class="linenos">338</span></a>                        <span class="n">n_dims</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span>
</span><span id="Base-339"><a href="#Base-339"><span class="linenos">339</span></a>                        <span class="n">n_points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Base-340"><a href="#Base-340"><span class="linenos">340</span></a>                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base-341"><a href="#Base-341"><span class="linenos">341</span></a>                    <span class="p">)</span>
</span><span id="Base-342"><a href="#Base-342"><span class="linenos">342</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Base-343"><a href="#Base-343"><span class="linenos">343</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="n">generate_halton</span><span class="p">(</span>
</span><span id="Base-344"><a href="#Base-344"><span class="linenos">344</span></a>                        <span class="n">n_dims</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span>
</span><span id="Base-345"><a href="#Base-345"><span class="linenos">345</span></a>                        <span class="n">n_points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Base-346"><a href="#Base-346"><span class="linenos">346</span></a>                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base-347"><a href="#Base-347"><span class="linenos">347</span></a>                    <span class="p">)</span>
</span><span id="Base-348"><a href="#Base-348"><span class="linenos">348</span></a>
</span><span id="Base-349"><a href="#Base-349"><span class="linenos">349</span></a>                <span class="c1"># self.W_ = hash_sim[self.nodes_sim](</span>
</span><span id="Base-350"><a href="#Base-350"><span class="linenos">350</span></a>                <span class="c1">#             n_dims=n_features,</span>
</span><span id="Base-351"><a href="#Base-351"><span class="linenos">351</span></a>                <span class="c1">#             n_points=self.n_hidden_features,</span>
</span><span id="Base-352"><a href="#Base-352"><span class="linenos">352</span></a>                <span class="c1">#             seed=self.seed,</span>
</span><span id="Base-353"><a href="#Base-353"><span class="linenos">353</span></a>                <span class="c1">#         )</span>
</span><span id="Base-354"><a href="#Base-354"><span class="linenos">354</span></a>
</span><span id="Base-355"><a href="#Base-355"><span class="linenos">355</span></a>                <span class="k">assert</span> <span class="p">(</span>
</span><span id="Base-356"><a href="#Base-356"><span class="linenos">356</span></a>                    <span class="n">scaled_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Base-357"><a href="#Base-357"><span class="linenos">357</span></a>                <span class="p">),</span> <span class="s2">&quot;check dimensions of covariates X and matrix W&quot;</span>
</span><span id="Base-358"><a href="#Base-358"><span class="linenos">358</span></a>
</span><span id="Base-359"><a href="#Base-359"><span class="linenos">359</span></a>                <span class="k">return</span> <span class="n">mo</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span>
</span><span id="Base-360"><a href="#Base-360"><span class="linenos">360</span></a>                    <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_func</span><span class="p">(</span>
</span><span id="Base-361"><a href="#Base-361"><span class="linenos">361</span></a>                        <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Base-362"><a href="#Base-362"><span class="linenos">362</span></a>                            <span class="n">a</span><span class="o">=</span><span class="n">scaled_X</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">W_</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span>
</span><span id="Base-363"><a href="#Base-363"><span class="linenos">363</span></a>                        <span class="p">)</span>
</span><span id="Base-364"><a href="#Base-364"><span class="linenos">364</span></a>                    <span class="p">),</span>
</span><span id="Base-365"><a href="#Base-365"><span class="linenos">365</span></a>                    <span class="n">drop_prob</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="Base-366"><a href="#Base-366"><span class="linenos">366</span></a>                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base-367"><a href="#Base-367"><span class="linenos">367</span></a>                <span class="p">)</span>
</span><span id="Base-368"><a href="#Base-368"><span class="linenos">368</span></a>
</span><span id="Base-369"><a href="#Base-369"><span class="linenos">369</span></a>            <span class="c1"># W is not none</span>
</span><span id="Base-370"><a href="#Base-370"><span class="linenos">370</span></a>            <span class="k">assert</span> <span class="p">(</span>
</span><span id="Base-371"><a href="#Base-371"><span class="linenos">371</span></a>                <span class="n">scaled_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">W</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Base-372"><a href="#Base-372"><span class="linenos">372</span></a>            <span class="p">),</span> <span class="s2">&quot;check dimensions of covariates X and matrix W&quot;</span>
</span><span id="Base-373"><a href="#Base-373"><span class="linenos">373</span></a>
</span><span id="Base-374"><a href="#Base-374"><span class="linenos">374</span></a>            <span class="c1"># self.W_ = W</span>
</span><span id="Base-375"><a href="#Base-375"><span class="linenos">375</span></a>            <span class="k">return</span> <span class="n">mo</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span>
</span><span id="Base-376"><a href="#Base-376"><span class="linenos">376</span></a>                <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_func</span><span class="p">(</span>
</span><span id="Base-377"><a href="#Base-377"><span class="linenos">377</span></a>                    <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">scaled_X</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Base-378"><a href="#Base-378"><span class="linenos">378</span></a>                <span class="p">),</span>
</span><span id="Base-379"><a href="#Base-379"><span class="linenos">379</span></a>                <span class="n">drop_prob</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="Base-380"><a href="#Base-380"><span class="linenos">380</span></a>                <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base-381"><a href="#Base-381"><span class="linenos">381</span></a>            <span class="p">)</span>
</span><span id="Base-382"><a href="#Base-382"><span class="linenos">382</span></a>
</span><span id="Base-383"><a href="#Base-383"><span class="linenos">383</span></a>        <span class="c1"># with bias term in the hidden layer</span>
</span><span id="Base-384"><a href="#Base-384"><span class="linenos">384</span></a>        <span class="k">if</span> <span class="n">W</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Base-385"><a href="#Base-385"><span class="linenos">385</span></a>            <span class="n">n_features_1</span> <span class="o">=</span> <span class="n">n_features</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Base-386"><a href="#Base-386"><span class="linenos">386</span></a>
</span><span id="Base-387"><a href="#Base-387"><span class="linenos">387</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span> <span class="o">==</span> <span class="s2">&quot;sobol&quot;</span><span class="p">:</span>
</span><span id="Base-388"><a href="#Base-388"><span class="linenos">388</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="n">generate_sobol</span><span class="p">(</span>
</span><span id="Base-389"><a href="#Base-389"><span class="linenos">389</span></a>                    <span class="n">n_dims</span><span class="o">=</span><span class="n">n_features_1</span><span class="p">,</span>
</span><span id="Base-390"><a href="#Base-390"><span class="linenos">390</span></a>                    <span class="n">n_points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Base-391"><a href="#Base-391"><span class="linenos">391</span></a>                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base-392"><a href="#Base-392"><span class="linenos">392</span></a>                <span class="p">)</span>
</span><span id="Base-393"><a href="#Base-393"><span class="linenos">393</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span> <span class="o">==</span> <span class="s2">&quot;hammersley&quot;</span><span class="p">:</span>
</span><span id="Base-394"><a href="#Base-394"><span class="linenos">394</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="n">generate_hammersley</span><span class="p">(</span>
</span><span id="Base-395"><a href="#Base-395"><span class="linenos">395</span></a>                    <span class="n">n_dims</span><span class="o">=</span><span class="n">n_features_1</span><span class="p">,</span>
</span><span id="Base-396"><a href="#Base-396"><span class="linenos">396</span></a>                    <span class="n">n_points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Base-397"><a href="#Base-397"><span class="linenos">397</span></a>                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base-398"><a href="#Base-398"><span class="linenos">398</span></a>                <span class="p">)</span>
</span><span id="Base-399"><a href="#Base-399"><span class="linenos">399</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span> <span class="o">==</span> <span class="s2">&quot;uniform&quot;</span><span class="p">:</span>
</span><span id="Base-400"><a href="#Base-400"><span class="linenos">400</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="n">generate_uniform</span><span class="p">(</span>
</span><span id="Base-401"><a href="#Base-401"><span class="linenos">401</span></a>                    <span class="n">n_dims</span><span class="o">=</span><span class="n">n_features_1</span><span class="p">,</span>
</span><span id="Base-402"><a href="#Base-402"><span class="linenos">402</span></a>                    <span class="n">n_points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Base-403"><a href="#Base-403"><span class="linenos">403</span></a>                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base-404"><a href="#Base-404"><span class="linenos">404</span></a>                <span class="p">)</span>
</span><span id="Base-405"><a href="#Base-405"><span class="linenos">405</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Base-406"><a href="#Base-406"><span class="linenos">406</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="n">generate_halton</span><span class="p">(</span>
</span><span id="Base-407"><a href="#Base-407"><span class="linenos">407</span></a>                    <span class="n">n_dims</span><span class="o">=</span><span class="n">n_features_1</span><span class="p">,</span>
</span><span id="Base-408"><a href="#Base-408"><span class="linenos">408</span></a>                    <span class="n">n_points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Base-409"><a href="#Base-409"><span class="linenos">409</span></a>                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base-410"><a href="#Base-410"><span class="linenos">410</span></a>                <span class="p">)</span>
</span><span id="Base-411"><a href="#Base-411"><span class="linenos">411</span></a>
</span><span id="Base-412"><a href="#Base-412"><span class="linenos">412</span></a>            <span class="c1"># self.W_ = hash_sim[self.nodes_sim](</span>
</span><span id="Base-413"><a href="#Base-413"><span class="linenos">413</span></a>            <span class="c1">#         n_dims=n_features_1,</span>
</span><span id="Base-414"><a href="#Base-414"><span class="linenos">414</span></a>            <span class="c1">#         n_points=self.n_hidden_features,</span>
</span><span id="Base-415"><a href="#Base-415"><span class="linenos">415</span></a>            <span class="c1">#         seed=self.seed,</span>
</span><span id="Base-416"><a href="#Base-416"><span class="linenos">416</span></a>            <span class="c1">#     )</span>
</span><span id="Base-417"><a href="#Base-417"><span class="linenos">417</span></a>
</span><span id="Base-418"><a href="#Base-418"><span class="linenos">418</span></a>            <span class="k">return</span> <span class="n">mo</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span>
</span><span id="Base-419"><a href="#Base-419"><span class="linenos">419</span></a>                <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_func</span><span class="p">(</span>
</span><span id="Base-420"><a href="#Base-420"><span class="linenos">420</span></a>                    <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Base-421"><a href="#Base-421"><span class="linenos">421</span></a>                        <span class="n">a</span><span class="o">=</span><span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span>
</span><span id="Base-422"><a href="#Base-422"><span class="linenos">422</span></a>                            <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">scaled_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="Base-423"><a href="#Base-423"><span class="linenos">423</span></a>                            <span class="n">scaled_X</span><span class="p">,</span>
</span><span id="Base-424"><a href="#Base-424"><span class="linenos">424</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Base-425"><a href="#Base-425"><span class="linenos">425</span></a>                        <span class="p">),</span>
</span><span id="Base-426"><a href="#Base-426"><span class="linenos">426</span></a>                        <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">W_</span><span class="p">,</span>
</span><span id="Base-427"><a href="#Base-427"><span class="linenos">427</span></a>                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Base-428"><a href="#Base-428"><span class="linenos">428</span></a>                    <span class="p">)</span>
</span><span id="Base-429"><a href="#Base-429"><span class="linenos">429</span></a>                <span class="p">),</span>
</span><span id="Base-430"><a href="#Base-430"><span class="linenos">430</span></a>                <span class="n">drop_prob</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="Base-431"><a href="#Base-431"><span class="linenos">431</span></a>                <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base-432"><a href="#Base-432"><span class="linenos">432</span></a>            <span class="p">)</span>
</span><span id="Base-433"><a href="#Base-433"><span class="linenos">433</span></a>
</span><span id="Base-434"><a href="#Base-434"><span class="linenos">434</span></a>        <span class="c1"># W is not None</span>
</span><span id="Base-435"><a href="#Base-435"><span class="linenos">435</span></a>        <span class="c1"># self.W_ = W</span>
</span><span id="Base-436"><a href="#Base-436"><span class="linenos">436</span></a>        <span class="k">return</span> <span class="n">mo</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span>
</span><span id="Base-437"><a href="#Base-437"><span class="linenos">437</span></a>            <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_func</span><span class="p">(</span>
</span><span id="Base-438"><a href="#Base-438"><span class="linenos">438</span></a>                <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Base-439"><a href="#Base-439"><span class="linenos">439</span></a>                    <span class="n">a</span><span class="o">=</span><span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span>
</span><span id="Base-440"><a href="#Base-440"><span class="linenos">440</span></a>                        <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">scaled_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="Base-441"><a href="#Base-441"><span class="linenos">441</span></a>                        <span class="n">scaled_X</span><span class="p">,</span>
</span><span id="Base-442"><a href="#Base-442"><span class="linenos">442</span></a>                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Base-443"><a href="#Base-443"><span class="linenos">443</span></a>                    <span class="p">),</span>
</span><span id="Base-444"><a href="#Base-444"><span class="linenos">444</span></a>                    <span class="n">b</span><span class="o">=</span><span class="n">W</span><span class="p">,</span>
</span><span id="Base-445"><a href="#Base-445"><span class="linenos">445</span></a>                    <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Base-446"><a href="#Base-446"><span class="linenos">446</span></a>                <span class="p">)</span>
</span><span id="Base-447"><a href="#Base-447"><span class="linenos">447</span></a>            <span class="p">),</span>
</span><span id="Base-448"><a href="#Base-448"><span class="linenos">448</span></a>            <span class="n">drop_prob</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="Base-449"><a href="#Base-449"><span class="linenos">449</span></a>            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base-450"><a href="#Base-450"><span class="linenos">450</span></a>        <span class="p">)</span>
</span><span id="Base-451"><a href="#Base-451"><span class="linenos">451</span></a>
</span><span id="Base-452"><a href="#Base-452"><span class="linenos">452</span></a>    <span class="k">def</span> <span class="nf">cook_training_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Base-453"><a href="#Base-453"><span class="linenos">453</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create new hidden features for training set, with hidden layer, center the response.</span>
</span><span id="Base-454"><a href="#Base-454"><span class="linenos">454</span></a>
</span><span id="Base-455"><a href="#Base-455"><span class="linenos">455</span></a><span class="sd">        Parameters:</span>
</span><span id="Base-456"><a href="#Base-456"><span class="linenos">456</span></a>
</span><span id="Base-457"><a href="#Base-457"><span class="linenos">457</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="Base-458"><a href="#Base-458"><span class="linenos">458</span></a><span class="sd">                Target values</span>
</span><span id="Base-459"><a href="#Base-459"><span class="linenos">459</span></a>
</span><span id="Base-460"><a href="#Base-460"><span class="linenos">460</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Base-461"><a href="#Base-461"><span class="linenos">461</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Base-462"><a href="#Base-462"><span class="linenos">462</span></a><span class="sd">                of samples and n_features is the number of features</span>
</span><span id="Base-463"><a href="#Base-463"><span class="linenos">463</span></a>
</span><span id="Base-464"><a href="#Base-464"><span class="linenos">464</span></a><span class="sd">            W: {array-like}, shape = [n_features, hidden_features]</span>
</span><span id="Base-465"><a href="#Base-465"><span class="linenos">465</span></a><span class="sd">                if provided, constructs the hidden layer via W</span>
</span><span id="Base-466"><a href="#Base-466"><span class="linenos">466</span></a>
</span><span id="Base-467"><a href="#Base-467"><span class="linenos">467</span></a><span class="sd">        Returns:</span>
</span><span id="Base-468"><a href="#Base-468"><span class="linenos">468</span></a>
</span><span id="Base-469"><a href="#Base-469"><span class="linenos">469</span></a><span class="sd">            (centered response, direct link + hidden layer matrix): {tuple}</span>
</span><span id="Base-470"><a href="#Base-470"><span class="linenos">470</span></a>
</span><span id="Base-471"><a href="#Base-471"><span class="linenos">471</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Base-472"><a href="#Base-472"><span class="linenos">472</span></a>
</span><span id="Base-473"><a href="#Base-473"><span class="linenos">473</span></a>        <span class="c1"># either X and y are stored or not</span>
</span><span id="Base-474"><a href="#Base-474"><span class="linenos">474</span></a>        <span class="c1"># assert ((y is None) &amp; (X is None)) | ((y is not None) &amp; (X is not None))</span>
</span><span id="Base-475"><a href="#Base-475"><span class="linenos">475</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># has a hidden layer</span>
</span><span id="Base-476"><a href="#Base-476"><span class="linenos">476</span></a>            <span class="k">assert</span> <span class="p">(</span>
</span><span id="Base-477"><a href="#Base-477"><span class="linenos">477</span></a>                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span>
</span><span id="Base-478"><a href="#Base-478"><span class="linenos">478</span></a>            <span class="p">),</span> <span class="s2">&quot;must have len(self.type_scaling) &gt;= 2 when self.n_hidden_features &gt; 0&quot;</span>
</span><span id="Base-479"><a href="#Base-479"><span class="linenos">479</span></a>
</span><span id="Base-480"><a href="#Base-480"><span class="linenos">480</span></a>        <span class="k">if</span> <span class="n">X</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Base-481"><a href="#Base-481"><span class="linenos">481</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Base-482"><a href="#Base-482"><span class="linenos">482</span></a>                <span class="n">input_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span>
</span><span id="Base-483"><a href="#Base-483"><span class="linenos">483</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Base-484"><a href="#Base-484"><span class="linenos">484</span></a>                <span class="n">n_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Base-485"><a href="#Base-485"><span class="linenos">485</span></a>                <span class="n">new_n_features</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_features</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">))</span>
</span><span id="Base-486"><a href="#Base-486"><span class="linenos">486</span></a>                <span class="k">assert</span> <span class="p">(</span>
</span><span id="Base-487"><a href="#Base-487"><span class="linenos">487</span></a>                    <span class="n">new_n_features</span> <span class="o">&gt;=</span> <span class="mi">1</span>
</span><span id="Base-488"><a href="#Base-488"><span class="linenos">488</span></a>                <span class="p">),</span> <span class="s2">&quot;check class attribute &#39;col_sample&#39; and the number of covariates provided for X&quot;</span>
</span><span id="Base-489"><a href="#Base-489"><span class="linenos">489</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="Base-490"><a href="#Base-490"><span class="linenos">490</span></a>                <span class="n">index_col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
</span><span id="Base-491"><a href="#Base-491"><span class="linenos">491</span></a>                    <span class="nb">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">new_n_features</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
</span><span id="Base-492"><a href="#Base-492"><span class="linenos">492</span></a>                <span class="p">)</span>
</span><span id="Base-493"><a href="#Base-493"><span class="linenos">493</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">index_col_</span> <span class="o">=</span> <span class="n">index_col</span>
</span><span id="Base-494"><a href="#Base-494"><span class="linenos">494</span></a>                <span class="n">input_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_col_</span><span class="p">]</span>
</span><span id="Base-495"><a href="#Base-495"><span class="linenos">495</span></a>
</span><span id="Base-496"><a href="#Base-496"><span class="linenos">496</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># X is not None # keep X vs self.X_</span>
</span><span id="Base-497"><a href="#Base-497"><span class="linenos">497</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Base-498"><a href="#Base-498"><span class="linenos">498</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
</span><span id="Base-499"><a href="#Base-499"><span class="linenos">499</span></a>
</span><span id="Base-500"><a href="#Base-500"><span class="linenos">500</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Base-501"><a href="#Base-501"><span class="linenos">501</span></a>                <span class="n">input_X</span> <span class="o">=</span> <span class="n">X</span>
</span><span id="Base-502"><a href="#Base-502"><span class="linenos">502</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Base-503"><a href="#Base-503"><span class="linenos">503</span></a>                <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Base-504"><a href="#Base-504"><span class="linenos">504</span></a>                <span class="n">new_n_features</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_features</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">))</span>
</span><span id="Base-505"><a href="#Base-505"><span class="linenos">505</span></a>                <span class="k">assert</span> <span class="p">(</span>
</span><span id="Base-506"><a href="#Base-506"><span class="linenos">506</span></a>                    <span class="n">new_n_features</span> <span class="o">&gt;=</span> <span class="mi">1</span>
</span><span id="Base-507"><a href="#Base-507"><span class="linenos">507</span></a>                <span class="p">),</span> <span class="s2">&quot;check class attribute &#39;col_sample&#39; and the number of covariates provided for X&quot;</span>
</span><span id="Base-508"><a href="#Base-508"><span class="linenos">508</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="Base-509"><a href="#Base-509"><span class="linenos">509</span></a>                <span class="n">index_col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
</span><span id="Base-510"><a href="#Base-510"><span class="linenos">510</span></a>                    <span class="nb">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">new_n_features</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
</span><span id="Base-511"><a href="#Base-511"><span class="linenos">511</span></a>                <span class="p">)</span>
</span><span id="Base-512"><a href="#Base-512"><span class="linenos">512</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">index_col_</span> <span class="o">=</span> <span class="n">index_col</span>
</span><span id="Base-513"><a href="#Base-513"><span class="linenos">513</span></a>                <span class="n">input_X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_col_</span><span class="p">]</span>
</span><span id="Base-514"><a href="#Base-514"><span class="linenos">514</span></a>
</span><span id="Base-515"><a href="#Base-515"><span class="linenos">515</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="Base-516"><a href="#Base-516"><span class="linenos">516</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span> <span class="o">&lt;=</span> <span class="mi">0</span>
</span><span id="Base-517"><a href="#Base-517"><span class="linenos">517</span></a>        <span class="p">):</span>  <span class="c1"># data without any clustering: self.n_clusters is None -----</span>
</span><span id="Base-518"><a href="#Base-518"><span class="linenos">518</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># with hidden layer</span>
</span><span id="Base-519"><a href="#Base-519"><span class="linenos">519</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">nn_scaler_</span><span class="p">,</span> <span class="n">scaled_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">scale_covariates</span><span class="p">(</span>
</span><span id="Base-520"><a href="#Base-520"><span class="linenos">520</span></a>                    <span class="n">input_X</span><span class="p">,</span> <span class="n">choice</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Base-521"><a href="#Base-521"><span class="linenos">521</span></a>                <span class="p">)</span>
</span><span id="Base-522"><a href="#Base-522"><span class="linenos">522</span></a>                <span class="n">Phi_X</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Base-523"><a href="#Base-523"><span class="linenos">523</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">create_layer</span><span class="p">(</span><span class="n">scaled_X</span><span class="p">)</span>
</span><span id="Base-524"><a href="#Base-524"><span class="linenos">524</span></a>                    <span class="k">if</span> <span class="n">W</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="Base-525"><a href="#Base-525"><span class="linenos">525</span></a>                    <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_layer</span><span class="p">(</span><span class="n">scaled_X</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>
</span><span id="Base-526"><a href="#Base-526"><span class="linenos">526</span></a>                <span class="p">)</span>
</span><span id="Base-527"><a href="#Base-527"><span class="linenos">527</span></a>                <span class="n">Z</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Base-528"><a href="#Base-528"><span class="linenos">528</span></a>                    <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">input_X</span><span class="p">,</span> <span class="n">Phi_X</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Base-529"><a href="#Base-529"><span class="linenos">529</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span> <span class="ow">is</span> <span class="kc">True</span>
</span><span id="Base-530"><a href="#Base-530"><span class="linenos">530</span></a>                    <span class="k">else</span> <span class="n">Phi_X</span>
</span><span id="Base-531"><a href="#Base-531"><span class="linenos">531</span></a>                <span class="p">)</span>
</span><span id="Base-532"><a href="#Base-532"><span class="linenos">532</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">scale_covariates</span><span class="p">(</span>
</span><span id="Base-533"><a href="#Base-533"><span class="linenos">533</span></a>                    <span class="n">Z</span><span class="p">,</span> <span class="n">choice</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Base-534"><a href="#Base-534"><span class="linenos">534</span></a>                <span class="p">)</span>
</span><span id="Base-535"><a href="#Base-535"><span class="linenos">535</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># no hidden layer</span>
</span><span id="Base-536"><a href="#Base-536"><span class="linenos">536</span></a>                <span class="n">Z</span> <span class="o">=</span> <span class="n">input_X</span>
</span><span id="Base-537"><a href="#Base-537"><span class="linenos">537</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">scale_covariates</span><span class="p">(</span>
</span><span id="Base-538"><a href="#Base-538"><span class="linenos">538</span></a>                    <span class="n">Z</span><span class="p">,</span> <span class="n">choice</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Base-539"><a href="#Base-539"><span class="linenos">539</span></a>                <span class="p">)</span>
</span><span id="Base-540"><a href="#Base-540"><span class="linenos">540</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># data with clustering: self.n_clusters is not None ----- # keep</span>
</span><span id="Base-541"><a href="#Base-541"><span class="linenos">541</span></a>            <span class="n">augmented_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span>
</span><span id="Base-542"><a href="#Base-542"><span class="linenos">542</span></a>                <span class="n">input_X</span><span class="p">,</span>
</span><span id="Base-543"><a href="#Base-543"><span class="linenos">543</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">encode_clusters</span><span class="p">(</span><span class="n">input_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="Base-544"><a href="#Base-544"><span class="linenos">544</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Base-545"><a href="#Base-545"><span class="linenos">545</span></a>            <span class="p">)</span>
</span><span id="Base-546"><a href="#Base-546"><span class="linenos">546</span></a>
</span><span id="Base-547"><a href="#Base-547"><span class="linenos">547</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># with hidden layer</span>
</span><span id="Base-548"><a href="#Base-548"><span class="linenos">548</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">nn_scaler_</span><span class="p">,</span> <span class="n">scaled_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">scale_covariates</span><span class="p">(</span>
</span><span id="Base-549"><a href="#Base-549"><span class="linenos">549</span></a>                    <span class="n">augmented_X</span><span class="p">,</span> <span class="n">choice</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Base-550"><a href="#Base-550"><span class="linenos">550</span></a>                <span class="p">)</span>
</span><span id="Base-551"><a href="#Base-551"><span class="linenos">551</span></a>                <span class="n">Phi_X</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Base-552"><a href="#Base-552"><span class="linenos">552</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">create_layer</span><span class="p">(</span><span class="n">scaled_X</span><span class="p">)</span>
</span><span id="Base-553"><a href="#Base-553"><span class="linenos">553</span></a>                    <span class="k">if</span> <span class="n">W</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="Base-554"><a href="#Base-554"><span class="linenos">554</span></a>                    <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_layer</span><span class="p">(</span><span class="n">scaled_X</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>
</span><span id="Base-555"><a href="#Base-555"><span class="linenos">555</span></a>                <span class="p">)</span>
</span><span id="Base-556"><a href="#Base-556"><span class="linenos">556</span></a>                <span class="n">Z</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Base-557"><a href="#Base-557"><span class="linenos">557</span></a>                    <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">augmented_X</span><span class="p">,</span> <span class="n">Phi_X</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Base-558"><a href="#Base-558"><span class="linenos">558</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span> <span class="ow">is</span> <span class="kc">True</span>
</span><span id="Base-559"><a href="#Base-559"><span class="linenos">559</span></a>                    <span class="k">else</span> <span class="n">Phi_X</span>
</span><span id="Base-560"><a href="#Base-560"><span class="linenos">560</span></a>                <span class="p">)</span>
</span><span id="Base-561"><a href="#Base-561"><span class="linenos">561</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">scale_covariates</span><span class="p">(</span>
</span><span id="Base-562"><a href="#Base-562"><span class="linenos">562</span></a>                    <span class="n">Z</span><span class="p">,</span> <span class="n">choice</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Base-563"><a href="#Base-563"><span class="linenos">563</span></a>                <span class="p">)</span>
</span><span id="Base-564"><a href="#Base-564"><span class="linenos">564</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># no hidden layer</span>
</span><span id="Base-565"><a href="#Base-565"><span class="linenos">565</span></a>                <span class="n">Z</span> <span class="o">=</span> <span class="n">augmented_X</span>
</span><span id="Base-566"><a href="#Base-566"><span class="linenos">566</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">scale_covariates</span><span class="p">(</span>
</span><span id="Base-567"><a href="#Base-567"><span class="linenos">567</span></a>                    <span class="n">Z</span><span class="p">,</span> <span class="n">choice</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Base-568"><a href="#Base-568"><span class="linenos">568</span></a>                <span class="p">)</span>
</span><span id="Base-569"><a href="#Base-569"><span class="linenos">569</span></a>
</span><span id="Base-570"><a href="#Base-570"><span class="linenos">570</span></a>        <span class="c1"># Returning model inputs -----</span>
</span><span id="Base-571"><a href="#Base-571"><span class="linenos">571</span></a>        <span class="k">if</span> <span class="n">mx</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>  <span class="c1"># regression</span>
</span><span id="Base-572"><a href="#Base-572"><span class="linenos">572</span></a>            <span class="c1"># center y</span>
</span><span id="Base-573"><a href="#Base-573"><span class="linenos">573</span></a>            <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Base-574"><a href="#Base-574"><span class="linenos">574</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span><span class="p">,</span> <span class="n">centered_y</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">center_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">)</span>
</span><span id="Base-575"><a href="#Base-575"><span class="linenos">575</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Base-576"><a href="#Base-576"><span class="linenos">576</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span><span class="p">,</span> <span class="n">centered_y</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">center_response</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="Base-577"><a href="#Base-577"><span class="linenos">577</span></a>
</span><span id="Base-578"><a href="#Base-578"><span class="linenos">578</span></a>            <span class="c1"># y is subsampled</span>
</span><span id="Base-579"><a href="#Base-579"><span class="linenos">579</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Base-580"><a href="#Base-580"><span class="linenos">580</span></a>                <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span>
</span><span id="Base-581"><a href="#Base-581"><span class="linenos">581</span></a>
</span><span id="Base-582"><a href="#Base-582"><span class="linenos">582</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">subsampler_</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Base-583"><a href="#Base-583"><span class="linenos">583</span></a>                    <span class="n">SubSampler</span><span class="p">(</span>
</span><span id="Base-584"><a href="#Base-584"><span class="linenos">584</span></a>                        <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">,</span> <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span>
</span><span id="Base-585"><a href="#Base-585"><span class="linenos">585</span></a>                    <span class="p">)</span>
</span><span id="Base-586"><a href="#Base-586"><span class="linenos">586</span></a>                    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="Base-587"><a href="#Base-587"><span class="linenos">587</span></a>                    <span class="k">else</span> <span class="n">SubSampler</span><span class="p">(</span>
</span><span id="Base-588"><a href="#Base-588"><span class="linenos">588</span></a>                        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span>
</span><span id="Base-589"><a href="#Base-589"><span class="linenos">589</span></a>                    <span class="p">)</span>
</span><span id="Base-590"><a href="#Base-590"><span class="linenos">590</span></a>                <span class="p">)</span>
</span><span id="Base-591"><a href="#Base-591"><span class="linenos">591</span></a>
</span><span id="Base-592"><a href="#Base-592"><span class="linenos">592</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsampler_</span><span class="o">.</span><span class="n">subsample</span><span class="p">()</span>
</span><span id="Base-593"><a href="#Base-593"><span class="linenos">593</span></a>
</span><span id="Base-594"><a href="#Base-594"><span class="linenos">594</span></a>                <span class="n">n_row_sample</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span><span class="p">)</span>
</span><span id="Base-595"><a href="#Base-595"><span class="linenos">595</span></a>                <span class="c1"># regression</span>
</span><span id="Base-596"><a href="#Base-596"><span class="linenos">596</span></a>                <span class="k">return</span> <span class="p">(</span>
</span><span id="Base-597"><a href="#Base-597"><span class="linenos">597</span></a>                    <span class="n">centered_y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_row_sample</span><span class="p">),</span>
</span><span id="Base-598"><a href="#Base-598"><span class="linenos">598</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
</span><span id="Base-599"><a href="#Base-599"><span class="linenos">599</span></a>                        <span class="n">Z</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_row_sample</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span><span id="Base-600"><a href="#Base-600"><span class="linenos">600</span></a>                    <span class="p">),</span>
</span><span id="Base-601"><a href="#Base-601"><span class="linenos">601</span></a>                <span class="p">)</span>
</span><span id="Base-602"><a href="#Base-602"><span class="linenos">602</span></a>            <span class="c1"># y is not subsampled</span>
</span><span id="Base-603"><a href="#Base-603"><span class="linenos">603</span></a>            <span class="c1"># regression</span>
</span><span id="Base-604"><a href="#Base-604"><span class="linenos">604</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">centered_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span>
</span><span id="Base-605"><a href="#Base-605"><span class="linenos">605</span></a>
</span><span id="Base-606"><a href="#Base-606"><span class="linenos">606</span></a>        <span class="c1"># classification</span>
</span><span id="Base-607"><a href="#Base-607"><span class="linenos">607</span></a>        <span class="c1"># y is subsampled</span>
</span><span id="Base-608"><a href="#Base-608"><span class="linenos">608</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Base-609"><a href="#Base-609"><span class="linenos">609</span></a>            <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span>
</span><span id="Base-610"><a href="#Base-610"><span class="linenos">610</span></a>
</span><span id="Base-611"><a href="#Base-611"><span class="linenos">611</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">subsampler_</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Base-612"><a href="#Base-612"><span class="linenos">612</span></a>                <span class="n">SubSampler</span><span class="p">(</span>
</span><span id="Base-613"><a href="#Base-613"><span class="linenos">613</span></a>                    <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">,</span> <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span>
</span><span id="Base-614"><a href="#Base-614"><span class="linenos">614</span></a>                <span class="p">)</span>
</span><span id="Base-615"><a href="#Base-615"><span class="linenos">615</span></a>                <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="Base-616"><a href="#Base-616"><span class="linenos">616</span></a>                <span class="k">else</span> <span class="n">SubSampler</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="Base-617"><a href="#Base-617"><span class="linenos">617</span></a>            <span class="p">)</span>
</span><span id="Base-618"><a href="#Base-618"><span class="linenos">618</span></a>
</span><span id="Base-619"><a href="#Base-619"><span class="linenos">619</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsampler_</span><span class="o">.</span><span class="n">subsample</span><span class="p">()</span>
</span><span id="Base-620"><a href="#Base-620"><span class="linenos">620</span></a>
</span><span id="Base-621"><a href="#Base-621"><span class="linenos">621</span></a>            <span class="n">n_row_sample</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span><span class="p">)</span>
</span><span id="Base-622"><a href="#Base-622"><span class="linenos">622</span></a>            <span class="c1"># classification</span>
</span><span id="Base-623"><a href="#Base-623"><span class="linenos">623</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="Base-624"><a href="#Base-624"><span class="linenos">624</span></a>                <span class="n">y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_row_sample</span><span class="p">),</span>
</span><span id="Base-625"><a href="#Base-625"><span class="linenos">625</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
</span><span id="Base-626"><a href="#Base-626"><span class="linenos">626</span></a>                    <span class="n">Z</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_row_sample</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span><span id="Base-627"><a href="#Base-627"><span class="linenos">627</span></a>                <span class="p">),</span>
</span><span id="Base-628"><a href="#Base-628"><span class="linenos">628</span></a>            <span class="p">)</span>
</span><span id="Base-629"><a href="#Base-629"><span class="linenos">629</span></a>        <span class="c1"># y is not subsampled</span>
</span><span id="Base-630"><a href="#Base-630"><span class="linenos">630</span></a>        <span class="c1"># classification</span>
</span><span id="Base-631"><a href="#Base-631"><span class="linenos">631</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span>
</span><span id="Base-632"><a href="#Base-632"><span class="linenos">632</span></a>
</span><span id="Base-633"><a href="#Base-633"><span class="linenos">633</span></a>    <span class="k">def</span> <span class="nf">cook_test_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Base-634"><a href="#Base-634"><span class="linenos">634</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Transform data from test set, with hidden layer.</span>
</span><span id="Base-635"><a href="#Base-635"><span class="linenos">635</span></a>
</span><span id="Base-636"><a href="#Base-636"><span class="linenos">636</span></a><span class="sd">        Parameters:</span>
</span><span id="Base-637"><a href="#Base-637"><span class="linenos">637</span></a>
</span><span id="Base-638"><a href="#Base-638"><span class="linenos">638</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Base-639"><a href="#Base-639"><span class="linenos">639</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Base-640"><a href="#Base-640"><span class="linenos">640</span></a><span class="sd">                of samples and n_features is the number of features</span>
</span><span id="Base-641"><a href="#Base-641"><span class="linenos">641</span></a>
</span><span id="Base-642"><a href="#Base-642"><span class="linenos">642</span></a><span class="sd">            **kwargs: additional parameters to be passed to self.encode_cluster</span>
</span><span id="Base-643"><a href="#Base-643"><span class="linenos">643</span></a>
</span><span id="Base-644"><a href="#Base-644"><span class="linenos">644</span></a><span class="sd">        Returns:</span>
</span><span id="Base-645"><a href="#Base-645"><span class="linenos">645</span></a>
</span><span id="Base-646"><a href="#Base-646"><span class="linenos">646</span></a><span class="sd">            Transformed test set : {array-like}</span>
</span><span id="Base-647"><a href="#Base-647"><span class="linenos">647</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Base-648"><a href="#Base-648"><span class="linenos">648</span></a>
</span><span id="Base-649"><a href="#Base-649"><span class="linenos">649</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Base-650"><a href="#Base-650"><span class="linenos">650</span></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
</span><span id="Base-651"><a href="#Base-651"><span class="linenos">651</span></a>
</span><span id="Base-652"><a href="#Base-652"><span class="linenos">652</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="Base-653"><a href="#Base-653"><span class="linenos">653</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span> <span class="o">==</span> <span class="mi">0</span>
</span><span id="Base-654"><a href="#Base-654"><span class="linenos">654</span></a>        <span class="p">):</span>  <span class="c1"># data without clustering: self.n_clusters is None -----</span>
</span><span id="Base-655"><a href="#Base-655"><span class="linenos">655</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Base-656"><a href="#Base-656"><span class="linenos">656</span></a>                <span class="c1"># if hidden layer</span>
</span><span id="Base-657"><a href="#Base-657"><span class="linenos">657</span></a>                <span class="n">scaled_X</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Base-658"><a href="#Base-658"><span class="linenos">658</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">nn_scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="Base-659"><a href="#Base-659"><span class="linenos">659</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Base-660"><a href="#Base-660"><span class="linenos">660</span></a>                    <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">nn_scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_col_</span><span class="p">])</span>
</span><span id="Base-661"><a href="#Base-661"><span class="linenos">661</span></a>                <span class="p">)</span>
</span><span id="Base-662"><a href="#Base-662"><span class="linenos">662</span></a>                <span class="n">Phi_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_layer</span><span class="p">(</span><span class="n">scaled_X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_</span><span class="p">)</span>
</span><span id="Base-663"><a href="#Base-663"><span class="linenos">663</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Base-664"><a href="#Base-664"><span class="linenos">664</span></a>                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
</span><span id="Base-665"><a href="#Base-665"><span class="linenos">665</span></a>                        <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">scaled_X</span><span class="p">,</span> <span class="n">Phi_X</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Base-666"><a href="#Base-666"><span class="linenos">666</span></a>                    <span class="p">)</span>
</span><span id="Base-667"><a href="#Base-667"><span class="linenos">667</span></a>                <span class="c1"># when self.direct_link == False</span>
</span><span id="Base-668"><a href="#Base-668"><span class="linenos">668</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Phi_X</span><span class="p">)</span>
</span><span id="Base-669"><a href="#Base-669"><span class="linenos">669</span></a>            <span class="c1"># if no hidden layer # self.n_hidden_features == 0</span>
</span><span id="Base-670"><a href="#Base-670"><span class="linenos">670</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="Base-671"><a href="#Base-671"><span class="linenos">671</span></a>
</span><span id="Base-672"><a href="#Base-672"><span class="linenos">672</span></a>        <span class="c1"># data with clustering: self.n_clusters &gt; 0 -----</span>
</span><span id="Base-673"><a href="#Base-673"><span class="linenos">673</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Base-674"><a href="#Base-674"><span class="linenos">674</span></a>            <span class="n">predicted_clusters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode_clusters</span><span class="p">(</span>
</span><span id="Base-675"><a href="#Base-675"><span class="linenos">675</span></a>                <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">predict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Base-676"><a href="#Base-676"><span class="linenos">676</span></a>            <span class="p">)</span>
</span><span id="Base-677"><a href="#Base-677"><span class="linenos">677</span></a>            <span class="n">augmented_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">predicted_clusters</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Base-678"><a href="#Base-678"><span class="linenos">678</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Base-679"><a href="#Base-679"><span class="linenos">679</span></a>            <span class="n">predicted_clusters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode_clusters</span><span class="p">(</span>
</span><span id="Base-680"><a href="#Base-680"><span class="linenos">680</span></a>                <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_col_</span><span class="p">],</span> <span class="n">predict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Base-681"><a href="#Base-681"><span class="linenos">681</span></a>            <span class="p">)</span>
</span><span id="Base-682"><a href="#Base-682"><span class="linenos">682</span></a>            <span class="n">augmented_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span>
</span><span id="Base-683"><a href="#Base-683"><span class="linenos">683</span></a>                <span class="n">X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_col_</span><span class="p">],</span> <span class="n">predicted_clusters</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span>
</span><span id="Base-684"><a href="#Base-684"><span class="linenos">684</span></a>            <span class="p">)</span>
</span><span id="Base-685"><a href="#Base-685"><span class="linenos">685</span></a>
</span><span id="Base-686"><a href="#Base-686"><span class="linenos">686</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># if hidden layer</span>
</span><span id="Base-687"><a href="#Base-687"><span class="linenos">687</span></a>            <span class="n">scaled_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nn_scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">augmented_X</span><span class="p">)</span>
</span><span id="Base-688"><a href="#Base-688"><span class="linenos">688</span></a>            <span class="n">Phi_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_layer</span><span class="p">(</span><span class="n">scaled_X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_</span><span class="p">)</span>
</span><span id="Base-689"><a href="#Base-689"><span class="linenos">689</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Base-690"><a href="#Base-690"><span class="linenos">690</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
</span><span id="Base-691"><a href="#Base-691"><span class="linenos">691</span></a>                    <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">augmented_X</span><span class="p">,</span> <span class="n">Phi_X</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Base-692"><a href="#Base-692"><span class="linenos">692</span></a>                <span class="p">)</span>
</span><span id="Base-693"><a href="#Base-693"><span class="linenos">693</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Phi_X</span><span class="p">)</span>
</span><span id="Base-694"><a href="#Base-694"><span class="linenos">694</span></a>
</span><span id="Base-695"><a href="#Base-695"><span class="linenos">695</span></a>        <span class="c1"># if no hidden layer</span>
</span><span id="Base-696"><a href="#Base-696"><span class="linenos">696</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">augmented_X</span><span class="p">)</span>
</span><span id="Base-697"><a href="#Base-697"><span class="linenos">697</span></a>
</span><span id="Base-698"><a href="#Base-698"><span class="linenos">698</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Base-699"><a href="#Base-699"><span class="linenos">699</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Score the model on test set features X and response y.</span>
</span><span id="Base-700"><a href="#Base-700"><span class="linenos">700</span></a>
</span><span id="Base-701"><a href="#Base-701"><span class="linenos">701</span></a><span class="sd">        Parameters:</span>
</span><span id="Base-702"><a href="#Base-702"><span class="linenos">702</span></a>
</span><span id="Base-703"><a href="#Base-703"><span class="linenos">703</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Base-704"><a href="#Base-704"><span class="linenos">704</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Base-705"><a href="#Base-705"><span class="linenos">705</span></a><span class="sd">                of samples and n_features is the number of features</span>
</span><span id="Base-706"><a href="#Base-706"><span class="linenos">706</span></a>
</span><span id="Base-707"><a href="#Base-707"><span class="linenos">707</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="Base-708"><a href="#Base-708"><span class="linenos">708</span></a><span class="sd">                Target values</span>
</span><span id="Base-709"><a href="#Base-709"><span class="linenos">709</span></a>
</span><span id="Base-710"><a href="#Base-710"><span class="linenos">710</span></a><span class="sd">            scoring: str</span>
</span><span id="Base-711"><a href="#Base-711"><span class="linenos">711</span></a><span class="sd">                must be in (&#39;explained_variance&#39;, &#39;neg_mean_absolute_error&#39;,</span>
</span><span id="Base-712"><a href="#Base-712"><span class="linenos">712</span></a><span class="sd">                            &#39;neg_mean_squared_error&#39;, &#39;neg_mean_squared_log_error&#39;,</span>
</span><span id="Base-713"><a href="#Base-713"><span class="linenos">713</span></a><span class="sd">                            &#39;neg_median_absolute_error&#39;, &#39;r2&#39;)</span>
</span><span id="Base-714"><a href="#Base-714"><span class="linenos">714</span></a>
</span><span id="Base-715"><a href="#Base-715"><span class="linenos">715</span></a><span class="sd">            **kwargs: additional parameters to be passed to scoring functions</span>
</span><span id="Base-716"><a href="#Base-716"><span class="linenos">716</span></a>
</span><span id="Base-717"><a href="#Base-717"><span class="linenos">717</span></a><span class="sd">        Returns:</span>
</span><span id="Base-718"><a href="#Base-718"><span class="linenos">718</span></a>
</span><span id="Base-719"><a href="#Base-719"><span class="linenos">719</span></a><span class="sd">        model scores: {array-like}</span>
</span><span id="Base-720"><a href="#Base-720"><span class="linenos">720</span></a>
</span><span id="Base-721"><a href="#Base-721"><span class="linenos">721</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Base-722"><a href="#Base-722"><span class="linenos">722</span></a>
</span><span id="Base-723"><a href="#Base-723"><span class="linenos">723</span></a>        <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="Base-724"><a href="#Base-724"><span class="linenos">724</span></a>
</span><span id="Base-725"><a href="#Base-725"><span class="linenos">725</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_fit</span> <span class="o">==</span> <span class="s2">&quot;classification&quot;</span><span class="p">:</span>
</span><span id="Base-726"><a href="#Base-726"><span class="linenos">726</span></a>
</span><span id="Base-727"><a href="#Base-727"><span class="linenos">727</span></a>            <span class="k">if</span> <span class="n">scoring</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Base-728"><a href="#Base-728"><span class="linenos">728</span></a>                <span class="n">scoring</span> <span class="o">=</span> <span class="s2">&quot;accuracy&quot;</span>
</span><span id="Base-729"><a href="#Base-729"><span class="linenos">729</span></a>
</span><span id="Base-730"><a href="#Base-730"><span class="linenos">730</span></a>            <span class="c1"># check inputs</span>
</span><span id="Base-731"><a href="#Base-731"><span class="linenos">731</span></a>            <span class="k">assert</span> <span class="n">scoring</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="Base-732"><a href="#Base-732"><span class="linenos">732</span></a>                <span class="s2">&quot;accuracy&quot;</span><span class="p">,</span>
</span><span id="Base-733"><a href="#Base-733"><span class="linenos">733</span></a>                <span class="s2">&quot;average_precision&quot;</span><span class="p">,</span>
</span><span id="Base-734"><a href="#Base-734"><span class="linenos">734</span></a>                <span class="s2">&quot;brier_score_loss&quot;</span><span class="p">,</span>
</span><span id="Base-735"><a href="#Base-735"><span class="linenos">735</span></a>                <span class="s2">&quot;f1&quot;</span><span class="p">,</span>
</span><span id="Base-736"><a href="#Base-736"><span class="linenos">736</span></a>                <span class="s2">&quot;f1_micro&quot;</span><span class="p">,</span>
</span><span id="Base-737"><a href="#Base-737"><span class="linenos">737</span></a>                <span class="s2">&quot;f1_macro&quot;</span><span class="p">,</span>
</span><span id="Base-738"><a href="#Base-738"><span class="linenos">738</span></a>                <span class="s2">&quot;f1_weighted&quot;</span><span class="p">,</span>
</span><span id="Base-739"><a href="#Base-739"><span class="linenos">739</span></a>                <span class="s2">&quot;f1_samples&quot;</span><span class="p">,</span>
</span><span id="Base-740"><a href="#Base-740"><span class="linenos">740</span></a>                <span class="s2">&quot;neg_log_loss&quot;</span><span class="p">,</span>
</span><span id="Base-741"><a href="#Base-741"><span class="linenos">741</span></a>                <span class="s2">&quot;precision&quot;</span><span class="p">,</span>
</span><span id="Base-742"><a href="#Base-742"><span class="linenos">742</span></a>                <span class="s2">&quot;recall&quot;</span><span class="p">,</span>
</span><span id="Base-743"><a href="#Base-743"><span class="linenos">743</span></a>                <span class="s2">&quot;roc_auc&quot;</span><span class="p">,</span>
</span><span id="Base-744"><a href="#Base-744"><span class="linenos">744</span></a>            <span class="p">),</span> <span class="s2">&quot;&#39;scoring&#39; should be in (&#39;accuracy&#39;, &#39;average_precision&#39;, </span><span class="se">\</span>
</span><span id="Base-745"><a href="#Base-745"><span class="linenos">745</span></a><span class="s2">                            &#39;brier_score_loss&#39;, &#39;f1&#39;, &#39;f1_micro&#39;, </span><span class="se">\</span>
</span><span id="Base-746"><a href="#Base-746"><span class="linenos">746</span></a><span class="s2">                            &#39;f1_macro&#39;, &#39;f1_weighted&#39;,  &#39;f1_samples&#39;, </span><span class="se">\</span>
</span><span id="Base-747"><a href="#Base-747"><span class="linenos">747</span></a><span class="s2">                            &#39;neg_log_loss&#39;, &#39;precision&#39;, &#39;recall&#39;, </span><span class="se">\</span>
</span><span id="Base-748"><a href="#Base-748"><span class="linenos">748</span></a><span class="s2">                            &#39;roc_auc&#39;)&quot;</span>
</span><span id="Base-749"><a href="#Base-749"><span class="linenos">749</span></a>
</span><span id="Base-750"><a href="#Base-750"><span class="linenos">750</span></a>            <span class="n">scoring_options</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Base-751"><a href="#Base-751"><span class="linenos">751</span></a>                <span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">,</span>
</span><span id="Base-752"><a href="#Base-752"><span class="linenos">752</span></a>                <span class="s2">&quot;average_precision&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">average_precision_score</span><span class="p">,</span>
</span><span id="Base-753"><a href="#Base-753"><span class="linenos">753</span></a>                <span class="s2">&quot;brier_score_loss&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">brier_score_loss</span><span class="p">,</span>
</span><span id="Base-754"><a href="#Base-754"><span class="linenos">754</span></a>                <span class="s2">&quot;f1&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">f1_score</span><span class="p">,</span>
</span><span id="Base-755"><a href="#Base-755"><span class="linenos">755</span></a>                <span class="s2">&quot;f1_micro&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">f1_score</span><span class="p">,</span>
</span><span id="Base-756"><a href="#Base-756"><span class="linenos">756</span></a>                <span class="s2">&quot;f1_macro&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">f1_score</span><span class="p">,</span>
</span><span id="Base-757"><a href="#Base-757"><span class="linenos">757</span></a>                <span class="s2">&quot;f1_weighted&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">f1_score</span><span class="p">,</span>
</span><span id="Base-758"><a href="#Base-758"><span class="linenos">758</span></a>                <span class="s2">&quot;f1_samples&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">f1_score</span><span class="p">,</span>
</span><span id="Base-759"><a href="#Base-759"><span class="linenos">759</span></a>                <span class="s2">&quot;neg_log_loss&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">log_loss</span><span class="p">,</span>
</span><span id="Base-760"><a href="#Base-760"><span class="linenos">760</span></a>                <span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">precision_score</span><span class="p">,</span>
</span><span id="Base-761"><a href="#Base-761"><span class="linenos">761</span></a>                <span class="s2">&quot;recall&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">recall_score</span><span class="p">,</span>
</span><span id="Base-762"><a href="#Base-762"><span class="linenos">762</span></a>                <span class="s2">&quot;roc_auc&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">roc_auc_score</span><span class="p">,</span>
</span><span id="Base-763"><a href="#Base-763"><span class="linenos">763</span></a>            <span class="p">}</span>
</span><span id="Base-764"><a href="#Base-764"><span class="linenos">764</span></a>
</span><span id="Base-765"><a href="#Base-765"><span class="linenos">765</span></a>            <span class="k">return</span> <span class="n">scoring_options</span><span class="p">[</span><span class="n">scoring</span><span class="p">](</span><span class="n">y</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Base-766"><a href="#Base-766"><span class="linenos">766</span></a>
</span><span id="Base-767"><a href="#Base-767"><span class="linenos">767</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_fit</span> <span class="o">==</span> <span class="s2">&quot;regression&quot;</span><span class="p">:</span>
</span><span id="Base-768"><a href="#Base-768"><span class="linenos">768</span></a>
</span><span id="Base-769"><a href="#Base-769"><span class="linenos">769</span></a>            <span class="k">if</span> <span class="p">(</span>
</span><span id="Base-770"><a href="#Base-770"><span class="linenos">770</span></a>                <span class="nb">type</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span>
</span><span id="Base-771"><a href="#Base-771"><span class="linenos">771</span></a>            <span class="p">):</span>  <span class="c1"># if there are std. devs in the predictions</span>
</span><span id="Base-772"><a href="#Base-772"><span class="linenos">772</span></a>                <span class="n">preds</span> <span class="o">=</span> <span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Base-773"><a href="#Base-773"><span class="linenos">773</span></a>
</span><span id="Base-774"><a href="#Base-774"><span class="linenos">774</span></a>            <span class="k">if</span> <span class="n">scoring</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Base-775"><a href="#Base-775"><span class="linenos">775</span></a>                <span class="n">scoring</span> <span class="o">=</span> <span class="s2">&quot;neg_root_mean_squared_error&quot;</span>
</span><span id="Base-776"><a href="#Base-776"><span class="linenos">776</span></a>
</span><span id="Base-777"><a href="#Base-777"><span class="linenos">777</span></a>            <span class="c1"># check inputs</span>
</span><span id="Base-778"><a href="#Base-778"><span class="linenos">778</span></a>            <span class="k">assert</span> <span class="n">scoring</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="Base-779"><a href="#Base-779"><span class="linenos">779</span></a>                <span class="s2">&quot;explained_variance&quot;</span><span class="p">,</span>
</span><span id="Base-780"><a href="#Base-780"><span class="linenos">780</span></a>                <span class="s2">&quot;neg_mean_absolute_error&quot;</span><span class="p">,</span>
</span><span id="Base-781"><a href="#Base-781"><span class="linenos">781</span></a>                <span class="s2">&quot;neg_mean_squared_error&quot;</span><span class="p">,</span>
</span><span id="Base-782"><a href="#Base-782"><span class="linenos">782</span></a>                <span class="s2">&quot;neg_mean_squared_log_error&quot;</span><span class="p">,</span>
</span><span id="Base-783"><a href="#Base-783"><span class="linenos">783</span></a>                <span class="s2">&quot;neg_median_absolute_error&quot;</span><span class="p">,</span>
</span><span id="Base-784"><a href="#Base-784"><span class="linenos">784</span></a>                <span class="s2">&quot;neg_root_mean_squared_error&quot;</span><span class="p">,</span>
</span><span id="Base-785"><a href="#Base-785"><span class="linenos">785</span></a>                <span class="s2">&quot;r2&quot;</span><span class="p">,</span>
</span><span id="Base-786"><a href="#Base-786"><span class="linenos">786</span></a>            <span class="p">),</span> <span class="s2">&quot;&#39;scoring&#39; should be in (&#39;explained_variance&#39;, &#39;neg_mean_absolute_error&#39;, </span><span class="se">\</span>
</span><span id="Base-787"><a href="#Base-787"><span class="linenos">787</span></a><span class="s2">                            &#39;neg_mean_squared_error&#39;, &#39;neg_mean_squared_log_error&#39;, </span><span class="se">\</span>
</span><span id="Base-788"><a href="#Base-788"><span class="linenos">788</span></a><span class="s2">                            &#39;neg_median_absolute_error&#39;, &#39;r2&#39;, &#39;neg_root_mean_squared_error&#39;)&quot;</span>
</span><span id="Base-789"><a href="#Base-789"><span class="linenos">789</span></a>
</span><span id="Base-790"><a href="#Base-790"><span class="linenos">790</span></a>            <span class="n">scoring_options</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Base-791"><a href="#Base-791"><span class="linenos">791</span></a>                <span class="s2">&quot;neg_root_mean_squared_error&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">root_mean_squared_error</span><span class="p">,</span>
</span><span id="Base-792"><a href="#Base-792"><span class="linenos">792</span></a>                <span class="s2">&quot;explained_variance&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">explained_variance_score</span><span class="p">,</span>
</span><span id="Base-793"><a href="#Base-793"><span class="linenos">793</span></a>                <span class="s2">&quot;neg_mean_absolute_error&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">median_absolute_error</span><span class="p">,</span>
</span><span id="Base-794"><a href="#Base-794"><span class="linenos">794</span></a>                <span class="s2">&quot;neg_mean_squared_error&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">,</span>
</span><span id="Base-795"><a href="#Base-795"><span class="linenos">795</span></a>                <span class="s2">&quot;neg_mean_squared_log_error&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">mean_squared_log_error</span><span class="p">,</span>
</span><span id="Base-796"><a href="#Base-796"><span class="linenos">796</span></a>                <span class="s2">&quot;neg_median_absolute_error&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">median_absolute_error</span><span class="p">,</span>
</span><span id="Base-797"><a href="#Base-797"><span class="linenos">797</span></a>                <span class="s2">&quot;r2&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">r2_score</span><span class="p">,</span>
</span><span id="Base-798"><a href="#Base-798"><span class="linenos">798</span></a>            <span class="p">}</span>
</span><span id="Base-799"><a href="#Base-799"><span class="linenos">799</span></a>
</span><span id="Base-800"><a href="#Base-800"><span class="linenos">800</span></a>            <span class="k">return</span> <span class="n">scoring_options</span><span class="p">[</span><span class="n">scoring</span><span class="p">](</span><span class="n">y</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Base model from which all the other classes inherit.</p>

<p>This class contains the most important data preprocessing/feature engineering methods.</p>

<p>Parameters:</p>

<pre><code>n_hidden_features: int
    number of nodes in the hidden layer

activation_name: str
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'

a: float
    hyperparameter for 'prelu' or 'elu' activation function

nodes_sim: str
    type of simulation for hidden layer nodes: 'sobol', 'hammersley', 'halton',
    'uniform'

bias: boolean
    indicates if the hidden layer contains a bias term (True) or
    not (False)

dropout: float
    regularization parameter; (random) percentage of nodes dropped out
    of the training

direct_link: boolean
    indicates if the original features are included (True) in model's
    fitting or not (False)

n_clusters: int
    number of clusters for type_clust='kmeans' or type_clust='gmm'
    clustering (could be 0: no clustering)

cluster_encode: bool
    defines how the variable containing clusters is treated (default is one-hot);
    if `False`, then labels are used, without one-hot encoding

type_clust: str
    type of clustering method: currently k-means ('kmeans') or Gaussian
    Mixture Model ('gmm')

type_scaling: a tuple of 3 strings
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax') or robust scaling ('robust')

col_sample: float
    percentage of features randomly chosen for training

row_sample: float
    percentage of rows chosen for training, by stratified bootstrapping

seed: int
    reproducibility seed for nodes_sim=='uniform', clustering and dropout

backend: str
    "cpu" or "gpu" or "tpu"
</code></pre>
</div>


                                <div id="Base.encode_clusters" class="classattr">
                                            <input id="Base.encode_clusters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">encode_clusters</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">predict</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Base.encode_clusters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Base.encode_clusters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Base.encode_clusters-232"><a href="#Base.encode_clusters-232"><span class="linenos">232</span></a>    <span class="k">def</span> <span class="nf">encode_clusters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">predict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1">#</span>
</span><span id="Base.encode_clusters-233"><a href="#Base.encode_clusters-233"><span class="linenos">233</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create new covariates with kmeans or GMM clustering</span>
</span><span id="Base.encode_clusters-234"><a href="#Base.encode_clusters-234"><span class="linenos">234</span></a>
</span><span id="Base.encode_clusters-235"><a href="#Base.encode_clusters-235"><span class="linenos">235</span></a><span class="sd">        Parameters:</span>
</span><span id="Base.encode_clusters-236"><a href="#Base.encode_clusters-236"><span class="linenos">236</span></a>
</span><span id="Base.encode_clusters-237"><a href="#Base.encode_clusters-237"><span class="linenos">237</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Base.encode_clusters-238"><a href="#Base.encode_clusters-238"><span class="linenos">238</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Base.encode_clusters-239"><a href="#Base.encode_clusters-239"><span class="linenos">239</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Base.encode_clusters-240"><a href="#Base.encode_clusters-240"><span class="linenos">240</span></a>
</span><span id="Base.encode_clusters-241"><a href="#Base.encode_clusters-241"><span class="linenos">241</span></a><span class="sd">            predict: boolean</span>
</span><span id="Base.encode_clusters-242"><a href="#Base.encode_clusters-242"><span class="linenos">242</span></a><span class="sd">                is False on training set and True on test set</span>
</span><span id="Base.encode_clusters-243"><a href="#Base.encode_clusters-243"><span class="linenos">243</span></a>
</span><span id="Base.encode_clusters-244"><a href="#Base.encode_clusters-244"><span class="linenos">244</span></a><span class="sd">            **kwargs:</span>
</span><span id="Base.encode_clusters-245"><a href="#Base.encode_clusters-245"><span class="linenos">245</span></a><span class="sd">                additional parameters to be passed to the</span>
</span><span id="Base.encode_clusters-246"><a href="#Base.encode_clusters-246"><span class="linenos">246</span></a><span class="sd">                clustering method</span>
</span><span id="Base.encode_clusters-247"><a href="#Base.encode_clusters-247"><span class="linenos">247</span></a>
</span><span id="Base.encode_clusters-248"><a href="#Base.encode_clusters-248"><span class="linenos">248</span></a><span class="sd">        Returns:</span>
</span><span id="Base.encode_clusters-249"><a href="#Base.encode_clusters-249"><span class="linenos">249</span></a>
</span><span id="Base.encode_clusters-250"><a href="#Base.encode_clusters-250"><span class="linenos">250</span></a><span class="sd">            Clusters&#39; matrix, one-hot encoded: {array-like}</span>
</span><span id="Base.encode_clusters-251"><a href="#Base.encode_clusters-251"><span class="linenos">251</span></a>
</span><span id="Base.encode_clusters-252"><a href="#Base.encode_clusters-252"><span class="linenos">252</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Base.encode_clusters-253"><a href="#Base.encode_clusters-253"><span class="linenos">253</span></a>
</span><span id="Base.encode_clusters-254"><a href="#Base.encode_clusters-254"><span class="linenos">254</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="Base.encode_clusters-255"><a href="#Base.encode_clusters-255"><span class="linenos">255</span></a>
</span><span id="Base.encode_clusters-256"><a href="#Base.encode_clusters-256"><span class="linenos">256</span></a>        <span class="k">if</span> <span class="n">X</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Base.encode_clusters-257"><a href="#Base.encode_clusters-257"><span class="linenos">257</span></a>            <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span>
</span><span id="Base.encode_clusters-258"><a href="#Base.encode_clusters-258"><span class="linenos">258</span></a>
</span><span id="Base.encode_clusters-259"><a href="#Base.encode_clusters-259"><span class="linenos">259</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Base.encode_clusters-260"><a href="#Base.encode_clusters-260"><span class="linenos">260</span></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
</span><span id="Base.encode_clusters-261"><a href="#Base.encode_clusters-261"><span class="linenos">261</span></a>
</span><span id="Base.encode_clusters-262"><a href="#Base.encode_clusters-262"><span class="linenos">262</span></a>        <span class="k">if</span> <span class="n">predict</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>  <span class="c1"># encode training set</span>
</span><span id="Base.encode_clusters-263"><a href="#Base.encode_clusters-263"><span class="linenos">263</span></a>            <span class="c1"># scale input data before clustering</span>
</span><span id="Base.encode_clusters-264"><a href="#Base.encode_clusters-264"><span class="linenos">264</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">clustering_scaler_</span><span class="p">,</span> <span class="n">scaled_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">scale_covariates</span><span class="p">(</span>
</span><span id="Base.encode_clusters-265"><a href="#Base.encode_clusters-265"><span class="linenos">265</span></a>                <span class="n">X</span><span class="p">,</span> <span class="n">choice</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Base.encode_clusters-266"><a href="#Base.encode_clusters-266"><span class="linenos">266</span></a>            <span class="p">)</span>
</span><span id="Base.encode_clusters-267"><a href="#Base.encode_clusters-267"><span class="linenos">267</span></a>
</span><span id="Base.encode_clusters-268"><a href="#Base.encode_clusters-268"><span class="linenos">268</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">clustering_obj_</span><span class="p">,</span> <span class="n">X_clustered</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">cluster_covariates</span><span class="p">(</span>
</span><span id="Base.encode_clusters-269"><a href="#Base.encode_clusters-269"><span class="linenos">269</span></a>                <span class="n">scaled_X</span><span class="p">,</span>
</span><span id="Base.encode_clusters-270"><a href="#Base.encode_clusters-270"><span class="linenos">270</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="Base.encode_clusters-271"><a href="#Base.encode_clusters-271"><span class="linenos">271</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base.encode_clusters-272"><a href="#Base.encode_clusters-272"><span class="linenos">272</span></a>                <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="Base.encode_clusters-273"><a href="#Base.encode_clusters-273"><span class="linenos">273</span></a>                <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Base.encode_clusters-274"><a href="#Base.encode_clusters-274"><span class="linenos">274</span></a>            <span class="p">)</span>
</span><span id="Base.encode_clusters-275"><a href="#Base.encode_clusters-275"><span class="linenos">275</span></a>
</span><span id="Base.encode_clusters-276"><a href="#Base.encode_clusters-276"><span class="linenos">276</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Base.encode_clusters-277"><a href="#Base.encode_clusters-277"><span class="linenos">277</span></a>                <span class="k">return</span> <span class="n">mo</span><span class="o">.</span><span class="n">one_hot_encode</span><span class="p">(</span><span class="n">X_clustered</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
</span><span id="Base.encode_clusters-278"><a href="#Base.encode_clusters-278"><span class="linenos">278</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">float16</span>
</span><span id="Base.encode_clusters-279"><a href="#Base.encode_clusters-279"><span class="linenos">279</span></a>                <span class="p">)</span>
</span><span id="Base.encode_clusters-280"><a href="#Base.encode_clusters-280"><span class="linenos">280</span></a>
</span><span id="Base.encode_clusters-281"><a href="#Base.encode_clusters-281"><span class="linenos">281</span></a>            <span class="k">return</span> <span class="n">X_clustered</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
</span><span id="Base.encode_clusters-282"><a href="#Base.encode_clusters-282"><span class="linenos">282</span></a>
</span><span id="Base.encode_clusters-283"><a href="#Base.encode_clusters-283"><span class="linenos">283</span></a>        <span class="c1"># if predict == True, encode test set</span>
</span><span id="Base.encode_clusters-284"><a href="#Base.encode_clusters-284"><span class="linenos">284</span></a>        <span class="n">X_clustered</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clustering_obj_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="Base.encode_clusters-285"><a href="#Base.encode_clusters-285"><span class="linenos">285</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">clustering_scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="Base.encode_clusters-286"><a href="#Base.encode_clusters-286"><span class="linenos">286</span></a>        <span class="p">)</span>
</span><span id="Base.encode_clusters-287"><a href="#Base.encode_clusters-287"><span class="linenos">287</span></a>
</span><span id="Base.encode_clusters-288"><a href="#Base.encode_clusters-288"><span class="linenos">288</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Base.encode_clusters-289"><a href="#Base.encode_clusters-289"><span class="linenos">289</span></a>            <span class="k">return</span> <span class="n">mo</span><span class="o">.</span><span class="n">one_hot_encode</span><span class="p">(</span><span class="n">X_clustered</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
</span><span id="Base.encode_clusters-290"><a href="#Base.encode_clusters-290"><span class="linenos">290</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">float16</span>
</span><span id="Base.encode_clusters-291"><a href="#Base.encode_clusters-291"><span class="linenos">291</span></a>            <span class="p">)</span>
</span><span id="Base.encode_clusters-292"><a href="#Base.encode_clusters-292"><span class="linenos">292</span></a>
</span><span id="Base.encode_clusters-293"><a href="#Base.encode_clusters-293"><span class="linenos">293</span></a>        <span class="k">return</span> <span class="n">X_clustered</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create new covariates with kmeans or GMM clustering</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

predict: boolean
    is False on training set and True on test set

**kwargs:
    additional parameters to be passed to the
    clustering method
</code></pre>

<p>Returns:</p>

<pre><code>Clusters' matrix, one-hot encoded: {array-like}
</code></pre>
</div>


                                </div>
                                <div id="Base.create_layer" class="classattr">
                                            <input id="Base.create_layer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_layer</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">scaled_X</span>, </span><span class="param"><span class="n">W</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Base.create_layer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Base.create_layer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Base.create_layer-295"><a href="#Base.create_layer-295"><span class="linenos">295</span></a>    <span class="k">def</span> <span class="nf">create_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scaled_X</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Base.create_layer-296"><a href="#Base.create_layer-296"><span class="linenos">296</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create hidden layer.</span>
</span><span id="Base.create_layer-297"><a href="#Base.create_layer-297"><span class="linenos">297</span></a>
</span><span id="Base.create_layer-298"><a href="#Base.create_layer-298"><span class="linenos">298</span></a><span class="sd">        Parameters:</span>
</span><span id="Base.create_layer-299"><a href="#Base.create_layer-299"><span class="linenos">299</span></a>
</span><span id="Base.create_layer-300"><a href="#Base.create_layer-300"><span class="linenos">300</span></a><span class="sd">            scaled_X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Base.create_layer-301"><a href="#Base.create_layer-301"><span class="linenos">301</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Base.create_layer-302"><a href="#Base.create_layer-302"><span class="linenos">302</span></a><span class="sd">                of samples and n_features is the number of features</span>
</span><span id="Base.create_layer-303"><a href="#Base.create_layer-303"><span class="linenos">303</span></a>
</span><span id="Base.create_layer-304"><a href="#Base.create_layer-304"><span class="linenos">304</span></a><span class="sd">            W: {array-like}, shape = [n_features, hidden_features]</span>
</span><span id="Base.create_layer-305"><a href="#Base.create_layer-305"><span class="linenos">305</span></a><span class="sd">                if provided, constructs the hidden layer with W; otherwise computed internally</span>
</span><span id="Base.create_layer-306"><a href="#Base.create_layer-306"><span class="linenos">306</span></a>
</span><span id="Base.create_layer-307"><a href="#Base.create_layer-307"><span class="linenos">307</span></a><span class="sd">        Returns:</span>
</span><span id="Base.create_layer-308"><a href="#Base.create_layer-308"><span class="linenos">308</span></a>
</span><span id="Base.create_layer-309"><a href="#Base.create_layer-309"><span class="linenos">309</span></a><span class="sd">            Hidden layer matrix: {array-like}</span>
</span><span id="Base.create_layer-310"><a href="#Base.create_layer-310"><span class="linenos">310</span></a>
</span><span id="Base.create_layer-311"><a href="#Base.create_layer-311"><span class="linenos">311</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Base.create_layer-312"><a href="#Base.create_layer-312"><span class="linenos">312</span></a>
</span><span id="Base.create_layer-313"><a href="#Base.create_layer-313"><span class="linenos">313</span></a>        <span class="n">n_features</span> <span class="o">=</span> <span class="n">scaled_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Base.create_layer-314"><a href="#Base.create_layer-314"><span class="linenos">314</span></a>
</span><span id="Base.create_layer-315"><a href="#Base.create_layer-315"><span class="linenos">315</span></a>        <span class="c1"># hash_sim = {</span>
</span><span id="Base.create_layer-316"><a href="#Base.create_layer-316"><span class="linenos">316</span></a>        <span class="c1">#         &quot;sobol&quot;: generate_sobol,</span>
</span><span id="Base.create_layer-317"><a href="#Base.create_layer-317"><span class="linenos">317</span></a>        <span class="c1">#         &quot;hammersley&quot;: generate_hammersley,</span>
</span><span id="Base.create_layer-318"><a href="#Base.create_layer-318"><span class="linenos">318</span></a>        <span class="c1">#         &quot;uniform&quot;: generate_uniform,</span>
</span><span id="Base.create_layer-319"><a href="#Base.create_layer-319"><span class="linenos">319</span></a>        <span class="c1">#         &quot;halton&quot;: generate_halton</span>
</span><span id="Base.create_layer-320"><a href="#Base.create_layer-320"><span class="linenos">320</span></a>        <span class="c1">#     }</span>
</span><span id="Base.create_layer-321"><a href="#Base.create_layer-321"><span class="linenos">321</span></a>
</span><span id="Base.create_layer-322"><a href="#Base.create_layer-322"><span class="linenos">322</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>  <span class="c1"># no bias term in the hidden layer</span>
</span><span id="Base.create_layer-323"><a href="#Base.create_layer-323"><span class="linenos">323</span></a>            <span class="k">if</span> <span class="n">W</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Base.create_layer-324"><a href="#Base.create_layer-324"><span class="linenos">324</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span> <span class="o">==</span> <span class="s2">&quot;sobol&quot;</span><span class="p">:</span>
</span><span id="Base.create_layer-325"><a href="#Base.create_layer-325"><span class="linenos">325</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="n">generate_sobol</span><span class="p">(</span>
</span><span id="Base.create_layer-326"><a href="#Base.create_layer-326"><span class="linenos">326</span></a>                        <span class="n">n_dims</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span>
</span><span id="Base.create_layer-327"><a href="#Base.create_layer-327"><span class="linenos">327</span></a>                        <span class="n">n_points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Base.create_layer-328"><a href="#Base.create_layer-328"><span class="linenos">328</span></a>                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base.create_layer-329"><a href="#Base.create_layer-329"><span class="linenos">329</span></a>                    <span class="p">)</span>
</span><span id="Base.create_layer-330"><a href="#Base.create_layer-330"><span class="linenos">330</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span> <span class="o">==</span> <span class="s2">&quot;hammersley&quot;</span><span class="p">:</span>
</span><span id="Base.create_layer-331"><a href="#Base.create_layer-331"><span class="linenos">331</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="n">generate_hammersley</span><span class="p">(</span>
</span><span id="Base.create_layer-332"><a href="#Base.create_layer-332"><span class="linenos">332</span></a>                        <span class="n">n_dims</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span>
</span><span id="Base.create_layer-333"><a href="#Base.create_layer-333"><span class="linenos">333</span></a>                        <span class="n">n_points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Base.create_layer-334"><a href="#Base.create_layer-334"><span class="linenos">334</span></a>                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base.create_layer-335"><a href="#Base.create_layer-335"><span class="linenos">335</span></a>                    <span class="p">)</span>
</span><span id="Base.create_layer-336"><a href="#Base.create_layer-336"><span class="linenos">336</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span> <span class="o">==</span> <span class="s2">&quot;uniform&quot;</span><span class="p">:</span>
</span><span id="Base.create_layer-337"><a href="#Base.create_layer-337"><span class="linenos">337</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="n">generate_uniform</span><span class="p">(</span>
</span><span id="Base.create_layer-338"><a href="#Base.create_layer-338"><span class="linenos">338</span></a>                        <span class="n">n_dims</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span>
</span><span id="Base.create_layer-339"><a href="#Base.create_layer-339"><span class="linenos">339</span></a>                        <span class="n">n_points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Base.create_layer-340"><a href="#Base.create_layer-340"><span class="linenos">340</span></a>                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base.create_layer-341"><a href="#Base.create_layer-341"><span class="linenos">341</span></a>                    <span class="p">)</span>
</span><span id="Base.create_layer-342"><a href="#Base.create_layer-342"><span class="linenos">342</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Base.create_layer-343"><a href="#Base.create_layer-343"><span class="linenos">343</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="n">generate_halton</span><span class="p">(</span>
</span><span id="Base.create_layer-344"><a href="#Base.create_layer-344"><span class="linenos">344</span></a>                        <span class="n">n_dims</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span>
</span><span id="Base.create_layer-345"><a href="#Base.create_layer-345"><span class="linenos">345</span></a>                        <span class="n">n_points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Base.create_layer-346"><a href="#Base.create_layer-346"><span class="linenos">346</span></a>                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base.create_layer-347"><a href="#Base.create_layer-347"><span class="linenos">347</span></a>                    <span class="p">)</span>
</span><span id="Base.create_layer-348"><a href="#Base.create_layer-348"><span class="linenos">348</span></a>
</span><span id="Base.create_layer-349"><a href="#Base.create_layer-349"><span class="linenos">349</span></a>                <span class="c1"># self.W_ = hash_sim[self.nodes_sim](</span>
</span><span id="Base.create_layer-350"><a href="#Base.create_layer-350"><span class="linenos">350</span></a>                <span class="c1">#             n_dims=n_features,</span>
</span><span id="Base.create_layer-351"><a href="#Base.create_layer-351"><span class="linenos">351</span></a>                <span class="c1">#             n_points=self.n_hidden_features,</span>
</span><span id="Base.create_layer-352"><a href="#Base.create_layer-352"><span class="linenos">352</span></a>                <span class="c1">#             seed=self.seed,</span>
</span><span id="Base.create_layer-353"><a href="#Base.create_layer-353"><span class="linenos">353</span></a>                <span class="c1">#         )</span>
</span><span id="Base.create_layer-354"><a href="#Base.create_layer-354"><span class="linenos">354</span></a>
</span><span id="Base.create_layer-355"><a href="#Base.create_layer-355"><span class="linenos">355</span></a>                <span class="k">assert</span> <span class="p">(</span>
</span><span id="Base.create_layer-356"><a href="#Base.create_layer-356"><span class="linenos">356</span></a>                    <span class="n">scaled_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Base.create_layer-357"><a href="#Base.create_layer-357"><span class="linenos">357</span></a>                <span class="p">),</span> <span class="s2">&quot;check dimensions of covariates X and matrix W&quot;</span>
</span><span id="Base.create_layer-358"><a href="#Base.create_layer-358"><span class="linenos">358</span></a>
</span><span id="Base.create_layer-359"><a href="#Base.create_layer-359"><span class="linenos">359</span></a>                <span class="k">return</span> <span class="n">mo</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span>
</span><span id="Base.create_layer-360"><a href="#Base.create_layer-360"><span class="linenos">360</span></a>                    <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_func</span><span class="p">(</span>
</span><span id="Base.create_layer-361"><a href="#Base.create_layer-361"><span class="linenos">361</span></a>                        <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Base.create_layer-362"><a href="#Base.create_layer-362"><span class="linenos">362</span></a>                            <span class="n">a</span><span class="o">=</span><span class="n">scaled_X</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">W_</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span>
</span><span id="Base.create_layer-363"><a href="#Base.create_layer-363"><span class="linenos">363</span></a>                        <span class="p">)</span>
</span><span id="Base.create_layer-364"><a href="#Base.create_layer-364"><span class="linenos">364</span></a>                    <span class="p">),</span>
</span><span id="Base.create_layer-365"><a href="#Base.create_layer-365"><span class="linenos">365</span></a>                    <span class="n">drop_prob</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="Base.create_layer-366"><a href="#Base.create_layer-366"><span class="linenos">366</span></a>                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base.create_layer-367"><a href="#Base.create_layer-367"><span class="linenos">367</span></a>                <span class="p">)</span>
</span><span id="Base.create_layer-368"><a href="#Base.create_layer-368"><span class="linenos">368</span></a>
</span><span id="Base.create_layer-369"><a href="#Base.create_layer-369"><span class="linenos">369</span></a>            <span class="c1"># W is not none</span>
</span><span id="Base.create_layer-370"><a href="#Base.create_layer-370"><span class="linenos">370</span></a>            <span class="k">assert</span> <span class="p">(</span>
</span><span id="Base.create_layer-371"><a href="#Base.create_layer-371"><span class="linenos">371</span></a>                <span class="n">scaled_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">W</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Base.create_layer-372"><a href="#Base.create_layer-372"><span class="linenos">372</span></a>            <span class="p">),</span> <span class="s2">&quot;check dimensions of covariates X and matrix W&quot;</span>
</span><span id="Base.create_layer-373"><a href="#Base.create_layer-373"><span class="linenos">373</span></a>
</span><span id="Base.create_layer-374"><a href="#Base.create_layer-374"><span class="linenos">374</span></a>            <span class="c1"># self.W_ = W</span>
</span><span id="Base.create_layer-375"><a href="#Base.create_layer-375"><span class="linenos">375</span></a>            <span class="k">return</span> <span class="n">mo</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span>
</span><span id="Base.create_layer-376"><a href="#Base.create_layer-376"><span class="linenos">376</span></a>                <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_func</span><span class="p">(</span>
</span><span id="Base.create_layer-377"><a href="#Base.create_layer-377"><span class="linenos">377</span></a>                    <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">scaled_X</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Base.create_layer-378"><a href="#Base.create_layer-378"><span class="linenos">378</span></a>                <span class="p">),</span>
</span><span id="Base.create_layer-379"><a href="#Base.create_layer-379"><span class="linenos">379</span></a>                <span class="n">drop_prob</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="Base.create_layer-380"><a href="#Base.create_layer-380"><span class="linenos">380</span></a>                <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base.create_layer-381"><a href="#Base.create_layer-381"><span class="linenos">381</span></a>            <span class="p">)</span>
</span><span id="Base.create_layer-382"><a href="#Base.create_layer-382"><span class="linenos">382</span></a>
</span><span id="Base.create_layer-383"><a href="#Base.create_layer-383"><span class="linenos">383</span></a>        <span class="c1"># with bias term in the hidden layer</span>
</span><span id="Base.create_layer-384"><a href="#Base.create_layer-384"><span class="linenos">384</span></a>        <span class="k">if</span> <span class="n">W</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Base.create_layer-385"><a href="#Base.create_layer-385"><span class="linenos">385</span></a>            <span class="n">n_features_1</span> <span class="o">=</span> <span class="n">n_features</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Base.create_layer-386"><a href="#Base.create_layer-386"><span class="linenos">386</span></a>
</span><span id="Base.create_layer-387"><a href="#Base.create_layer-387"><span class="linenos">387</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span> <span class="o">==</span> <span class="s2">&quot;sobol&quot;</span><span class="p">:</span>
</span><span id="Base.create_layer-388"><a href="#Base.create_layer-388"><span class="linenos">388</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="n">generate_sobol</span><span class="p">(</span>
</span><span id="Base.create_layer-389"><a href="#Base.create_layer-389"><span class="linenos">389</span></a>                    <span class="n">n_dims</span><span class="o">=</span><span class="n">n_features_1</span><span class="p">,</span>
</span><span id="Base.create_layer-390"><a href="#Base.create_layer-390"><span class="linenos">390</span></a>                    <span class="n">n_points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Base.create_layer-391"><a href="#Base.create_layer-391"><span class="linenos">391</span></a>                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base.create_layer-392"><a href="#Base.create_layer-392"><span class="linenos">392</span></a>                <span class="p">)</span>
</span><span id="Base.create_layer-393"><a href="#Base.create_layer-393"><span class="linenos">393</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span> <span class="o">==</span> <span class="s2">&quot;hammersley&quot;</span><span class="p">:</span>
</span><span id="Base.create_layer-394"><a href="#Base.create_layer-394"><span class="linenos">394</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="n">generate_hammersley</span><span class="p">(</span>
</span><span id="Base.create_layer-395"><a href="#Base.create_layer-395"><span class="linenos">395</span></a>                    <span class="n">n_dims</span><span class="o">=</span><span class="n">n_features_1</span><span class="p">,</span>
</span><span id="Base.create_layer-396"><a href="#Base.create_layer-396"><span class="linenos">396</span></a>                    <span class="n">n_points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Base.create_layer-397"><a href="#Base.create_layer-397"><span class="linenos">397</span></a>                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base.create_layer-398"><a href="#Base.create_layer-398"><span class="linenos">398</span></a>                <span class="p">)</span>
</span><span id="Base.create_layer-399"><a href="#Base.create_layer-399"><span class="linenos">399</span></a>            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span> <span class="o">==</span> <span class="s2">&quot;uniform&quot;</span><span class="p">:</span>
</span><span id="Base.create_layer-400"><a href="#Base.create_layer-400"><span class="linenos">400</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="n">generate_uniform</span><span class="p">(</span>
</span><span id="Base.create_layer-401"><a href="#Base.create_layer-401"><span class="linenos">401</span></a>                    <span class="n">n_dims</span><span class="o">=</span><span class="n">n_features_1</span><span class="p">,</span>
</span><span id="Base.create_layer-402"><a href="#Base.create_layer-402"><span class="linenos">402</span></a>                    <span class="n">n_points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Base.create_layer-403"><a href="#Base.create_layer-403"><span class="linenos">403</span></a>                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base.create_layer-404"><a href="#Base.create_layer-404"><span class="linenos">404</span></a>                <span class="p">)</span>
</span><span id="Base.create_layer-405"><a href="#Base.create_layer-405"><span class="linenos">405</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Base.create_layer-406"><a href="#Base.create_layer-406"><span class="linenos">406</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">W_</span> <span class="o">=</span> <span class="n">generate_halton</span><span class="p">(</span>
</span><span id="Base.create_layer-407"><a href="#Base.create_layer-407"><span class="linenos">407</span></a>                    <span class="n">n_dims</span><span class="o">=</span><span class="n">n_features_1</span><span class="p">,</span>
</span><span id="Base.create_layer-408"><a href="#Base.create_layer-408"><span class="linenos">408</span></a>                    <span class="n">n_points</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Base.create_layer-409"><a href="#Base.create_layer-409"><span class="linenos">409</span></a>                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base.create_layer-410"><a href="#Base.create_layer-410"><span class="linenos">410</span></a>                <span class="p">)</span>
</span><span id="Base.create_layer-411"><a href="#Base.create_layer-411"><span class="linenos">411</span></a>
</span><span id="Base.create_layer-412"><a href="#Base.create_layer-412"><span class="linenos">412</span></a>            <span class="c1"># self.W_ = hash_sim[self.nodes_sim](</span>
</span><span id="Base.create_layer-413"><a href="#Base.create_layer-413"><span class="linenos">413</span></a>            <span class="c1">#         n_dims=n_features_1,</span>
</span><span id="Base.create_layer-414"><a href="#Base.create_layer-414"><span class="linenos">414</span></a>            <span class="c1">#         n_points=self.n_hidden_features,</span>
</span><span id="Base.create_layer-415"><a href="#Base.create_layer-415"><span class="linenos">415</span></a>            <span class="c1">#         seed=self.seed,</span>
</span><span id="Base.create_layer-416"><a href="#Base.create_layer-416"><span class="linenos">416</span></a>            <span class="c1">#     )</span>
</span><span id="Base.create_layer-417"><a href="#Base.create_layer-417"><span class="linenos">417</span></a>
</span><span id="Base.create_layer-418"><a href="#Base.create_layer-418"><span class="linenos">418</span></a>            <span class="k">return</span> <span class="n">mo</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span>
</span><span id="Base.create_layer-419"><a href="#Base.create_layer-419"><span class="linenos">419</span></a>                <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_func</span><span class="p">(</span>
</span><span id="Base.create_layer-420"><a href="#Base.create_layer-420"><span class="linenos">420</span></a>                    <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Base.create_layer-421"><a href="#Base.create_layer-421"><span class="linenos">421</span></a>                        <span class="n">a</span><span class="o">=</span><span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span>
</span><span id="Base.create_layer-422"><a href="#Base.create_layer-422"><span class="linenos">422</span></a>                            <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">scaled_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="Base.create_layer-423"><a href="#Base.create_layer-423"><span class="linenos">423</span></a>                            <span class="n">scaled_X</span><span class="p">,</span>
</span><span id="Base.create_layer-424"><a href="#Base.create_layer-424"><span class="linenos">424</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Base.create_layer-425"><a href="#Base.create_layer-425"><span class="linenos">425</span></a>                        <span class="p">),</span>
</span><span id="Base.create_layer-426"><a href="#Base.create_layer-426"><span class="linenos">426</span></a>                        <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">W_</span><span class="p">,</span>
</span><span id="Base.create_layer-427"><a href="#Base.create_layer-427"><span class="linenos">427</span></a>                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Base.create_layer-428"><a href="#Base.create_layer-428"><span class="linenos">428</span></a>                    <span class="p">)</span>
</span><span id="Base.create_layer-429"><a href="#Base.create_layer-429"><span class="linenos">429</span></a>                <span class="p">),</span>
</span><span id="Base.create_layer-430"><a href="#Base.create_layer-430"><span class="linenos">430</span></a>                <span class="n">drop_prob</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="Base.create_layer-431"><a href="#Base.create_layer-431"><span class="linenos">431</span></a>                <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base.create_layer-432"><a href="#Base.create_layer-432"><span class="linenos">432</span></a>            <span class="p">)</span>
</span><span id="Base.create_layer-433"><a href="#Base.create_layer-433"><span class="linenos">433</span></a>
</span><span id="Base.create_layer-434"><a href="#Base.create_layer-434"><span class="linenos">434</span></a>        <span class="c1"># W is not None</span>
</span><span id="Base.create_layer-435"><a href="#Base.create_layer-435"><span class="linenos">435</span></a>        <span class="c1"># self.W_ = W</span>
</span><span id="Base.create_layer-436"><a href="#Base.create_layer-436"><span class="linenos">436</span></a>        <span class="k">return</span> <span class="n">mo</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span>
</span><span id="Base.create_layer-437"><a href="#Base.create_layer-437"><span class="linenos">437</span></a>            <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_func</span><span class="p">(</span>
</span><span id="Base.create_layer-438"><a href="#Base.create_layer-438"><span class="linenos">438</span></a>                <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Base.create_layer-439"><a href="#Base.create_layer-439"><span class="linenos">439</span></a>                    <span class="n">a</span><span class="o">=</span><span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span>
</span><span id="Base.create_layer-440"><a href="#Base.create_layer-440"><span class="linenos">440</span></a>                        <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">scaled_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="Base.create_layer-441"><a href="#Base.create_layer-441"><span class="linenos">441</span></a>                        <span class="n">scaled_X</span><span class="p">,</span>
</span><span id="Base.create_layer-442"><a href="#Base.create_layer-442"><span class="linenos">442</span></a>                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Base.create_layer-443"><a href="#Base.create_layer-443"><span class="linenos">443</span></a>                    <span class="p">),</span>
</span><span id="Base.create_layer-444"><a href="#Base.create_layer-444"><span class="linenos">444</span></a>                    <span class="n">b</span><span class="o">=</span><span class="n">W</span><span class="p">,</span>
</span><span id="Base.create_layer-445"><a href="#Base.create_layer-445"><span class="linenos">445</span></a>                    <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Base.create_layer-446"><a href="#Base.create_layer-446"><span class="linenos">446</span></a>                <span class="p">)</span>
</span><span id="Base.create_layer-447"><a href="#Base.create_layer-447"><span class="linenos">447</span></a>            <span class="p">),</span>
</span><span id="Base.create_layer-448"><a href="#Base.create_layer-448"><span class="linenos">448</span></a>            <span class="n">drop_prob</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="Base.create_layer-449"><a href="#Base.create_layer-449"><span class="linenos">449</span></a>            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Base.create_layer-450"><a href="#Base.create_layer-450"><span class="linenos">450</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create hidden layer.</p>

<p>Parameters:</p>

<pre><code>scaled_X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features

W: {array-like}, shape = [n_features, hidden_features]
    if provided, constructs the hidden layer with W; otherwise computed internally
</code></pre>

<p>Returns:</p>

<pre><code>Hidden layer matrix: {array-like}
</code></pre>
</div>


                                </div>
                                <div id="Base.cook_training_set" class="classattr">
                                            <input id="Base.cook_training_set-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cook_training_set</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">y</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">X</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">W</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Base.cook_training_set-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Base.cook_training_set"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Base.cook_training_set-452"><a href="#Base.cook_training_set-452"><span class="linenos">452</span></a>    <span class="k">def</span> <span class="nf">cook_training_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Base.cook_training_set-453"><a href="#Base.cook_training_set-453"><span class="linenos">453</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create new hidden features for training set, with hidden layer, center the response.</span>
</span><span id="Base.cook_training_set-454"><a href="#Base.cook_training_set-454"><span class="linenos">454</span></a>
</span><span id="Base.cook_training_set-455"><a href="#Base.cook_training_set-455"><span class="linenos">455</span></a><span class="sd">        Parameters:</span>
</span><span id="Base.cook_training_set-456"><a href="#Base.cook_training_set-456"><span class="linenos">456</span></a>
</span><span id="Base.cook_training_set-457"><a href="#Base.cook_training_set-457"><span class="linenos">457</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="Base.cook_training_set-458"><a href="#Base.cook_training_set-458"><span class="linenos">458</span></a><span class="sd">                Target values</span>
</span><span id="Base.cook_training_set-459"><a href="#Base.cook_training_set-459"><span class="linenos">459</span></a>
</span><span id="Base.cook_training_set-460"><a href="#Base.cook_training_set-460"><span class="linenos">460</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Base.cook_training_set-461"><a href="#Base.cook_training_set-461"><span class="linenos">461</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Base.cook_training_set-462"><a href="#Base.cook_training_set-462"><span class="linenos">462</span></a><span class="sd">                of samples and n_features is the number of features</span>
</span><span id="Base.cook_training_set-463"><a href="#Base.cook_training_set-463"><span class="linenos">463</span></a>
</span><span id="Base.cook_training_set-464"><a href="#Base.cook_training_set-464"><span class="linenos">464</span></a><span class="sd">            W: {array-like}, shape = [n_features, hidden_features]</span>
</span><span id="Base.cook_training_set-465"><a href="#Base.cook_training_set-465"><span class="linenos">465</span></a><span class="sd">                if provided, constructs the hidden layer via W</span>
</span><span id="Base.cook_training_set-466"><a href="#Base.cook_training_set-466"><span class="linenos">466</span></a>
</span><span id="Base.cook_training_set-467"><a href="#Base.cook_training_set-467"><span class="linenos">467</span></a><span class="sd">        Returns:</span>
</span><span id="Base.cook_training_set-468"><a href="#Base.cook_training_set-468"><span class="linenos">468</span></a>
</span><span id="Base.cook_training_set-469"><a href="#Base.cook_training_set-469"><span class="linenos">469</span></a><span class="sd">            (centered response, direct link + hidden layer matrix): {tuple}</span>
</span><span id="Base.cook_training_set-470"><a href="#Base.cook_training_set-470"><span class="linenos">470</span></a>
</span><span id="Base.cook_training_set-471"><a href="#Base.cook_training_set-471"><span class="linenos">471</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Base.cook_training_set-472"><a href="#Base.cook_training_set-472"><span class="linenos">472</span></a>
</span><span id="Base.cook_training_set-473"><a href="#Base.cook_training_set-473"><span class="linenos">473</span></a>        <span class="c1"># either X and y are stored or not</span>
</span><span id="Base.cook_training_set-474"><a href="#Base.cook_training_set-474"><span class="linenos">474</span></a>        <span class="c1"># assert ((y is None) &amp; (X is None)) | ((y is not None) &amp; (X is not None))</span>
</span><span id="Base.cook_training_set-475"><a href="#Base.cook_training_set-475"><span class="linenos">475</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># has a hidden layer</span>
</span><span id="Base.cook_training_set-476"><a href="#Base.cook_training_set-476"><span class="linenos">476</span></a>            <span class="k">assert</span> <span class="p">(</span>
</span><span id="Base.cook_training_set-477"><a href="#Base.cook_training_set-477"><span class="linenos">477</span></a>                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span>
</span><span id="Base.cook_training_set-478"><a href="#Base.cook_training_set-478"><span class="linenos">478</span></a>            <span class="p">),</span> <span class="s2">&quot;must have len(self.type_scaling) &gt;= 2 when self.n_hidden_features &gt; 0&quot;</span>
</span><span id="Base.cook_training_set-479"><a href="#Base.cook_training_set-479"><span class="linenos">479</span></a>
</span><span id="Base.cook_training_set-480"><a href="#Base.cook_training_set-480"><span class="linenos">480</span></a>        <span class="k">if</span> <span class="n">X</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Base.cook_training_set-481"><a href="#Base.cook_training_set-481"><span class="linenos">481</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Base.cook_training_set-482"><a href="#Base.cook_training_set-482"><span class="linenos">482</span></a>                <span class="n">input_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span>
</span><span id="Base.cook_training_set-483"><a href="#Base.cook_training_set-483"><span class="linenos">483</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Base.cook_training_set-484"><a href="#Base.cook_training_set-484"><span class="linenos">484</span></a>                <span class="n">n_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Base.cook_training_set-485"><a href="#Base.cook_training_set-485"><span class="linenos">485</span></a>                <span class="n">new_n_features</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_features</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">))</span>
</span><span id="Base.cook_training_set-486"><a href="#Base.cook_training_set-486"><span class="linenos">486</span></a>                <span class="k">assert</span> <span class="p">(</span>
</span><span id="Base.cook_training_set-487"><a href="#Base.cook_training_set-487"><span class="linenos">487</span></a>                    <span class="n">new_n_features</span> <span class="o">&gt;=</span> <span class="mi">1</span>
</span><span id="Base.cook_training_set-488"><a href="#Base.cook_training_set-488"><span class="linenos">488</span></a>                <span class="p">),</span> <span class="s2">&quot;check class attribute &#39;col_sample&#39; and the number of covariates provided for X&quot;</span>
</span><span id="Base.cook_training_set-489"><a href="#Base.cook_training_set-489"><span class="linenos">489</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="Base.cook_training_set-490"><a href="#Base.cook_training_set-490"><span class="linenos">490</span></a>                <span class="n">index_col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
</span><span id="Base.cook_training_set-491"><a href="#Base.cook_training_set-491"><span class="linenos">491</span></a>                    <span class="nb">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">new_n_features</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
</span><span id="Base.cook_training_set-492"><a href="#Base.cook_training_set-492"><span class="linenos">492</span></a>                <span class="p">)</span>
</span><span id="Base.cook_training_set-493"><a href="#Base.cook_training_set-493"><span class="linenos">493</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">index_col_</span> <span class="o">=</span> <span class="n">index_col</span>
</span><span id="Base.cook_training_set-494"><a href="#Base.cook_training_set-494"><span class="linenos">494</span></a>                <span class="n">input_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_col_</span><span class="p">]</span>
</span><span id="Base.cook_training_set-495"><a href="#Base.cook_training_set-495"><span class="linenos">495</span></a>
</span><span id="Base.cook_training_set-496"><a href="#Base.cook_training_set-496"><span class="linenos">496</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># X is not None # keep X vs self.X_</span>
</span><span id="Base.cook_training_set-497"><a href="#Base.cook_training_set-497"><span class="linenos">497</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Base.cook_training_set-498"><a href="#Base.cook_training_set-498"><span class="linenos">498</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
</span><span id="Base.cook_training_set-499"><a href="#Base.cook_training_set-499"><span class="linenos">499</span></a>
</span><span id="Base.cook_training_set-500"><a href="#Base.cook_training_set-500"><span class="linenos">500</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Base.cook_training_set-501"><a href="#Base.cook_training_set-501"><span class="linenos">501</span></a>                <span class="n">input_X</span> <span class="o">=</span> <span class="n">X</span>
</span><span id="Base.cook_training_set-502"><a href="#Base.cook_training_set-502"><span class="linenos">502</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Base.cook_training_set-503"><a href="#Base.cook_training_set-503"><span class="linenos">503</span></a>                <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Base.cook_training_set-504"><a href="#Base.cook_training_set-504"><span class="linenos">504</span></a>                <span class="n">new_n_features</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_features</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">))</span>
</span><span id="Base.cook_training_set-505"><a href="#Base.cook_training_set-505"><span class="linenos">505</span></a>                <span class="k">assert</span> <span class="p">(</span>
</span><span id="Base.cook_training_set-506"><a href="#Base.cook_training_set-506"><span class="linenos">506</span></a>                    <span class="n">new_n_features</span> <span class="o">&gt;=</span> <span class="mi">1</span>
</span><span id="Base.cook_training_set-507"><a href="#Base.cook_training_set-507"><span class="linenos">507</span></a>                <span class="p">),</span> <span class="s2">&quot;check class attribute &#39;col_sample&#39; and the number of covariates provided for X&quot;</span>
</span><span id="Base.cook_training_set-508"><a href="#Base.cook_training_set-508"><span class="linenos">508</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="Base.cook_training_set-509"><a href="#Base.cook_training_set-509"><span class="linenos">509</span></a>                <span class="n">index_col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
</span><span id="Base.cook_training_set-510"><a href="#Base.cook_training_set-510"><span class="linenos">510</span></a>                    <span class="nb">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">new_n_features</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
</span><span id="Base.cook_training_set-511"><a href="#Base.cook_training_set-511"><span class="linenos">511</span></a>                <span class="p">)</span>
</span><span id="Base.cook_training_set-512"><a href="#Base.cook_training_set-512"><span class="linenos">512</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">index_col_</span> <span class="o">=</span> <span class="n">index_col</span>
</span><span id="Base.cook_training_set-513"><a href="#Base.cook_training_set-513"><span class="linenos">513</span></a>                <span class="n">input_X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_col_</span><span class="p">]</span>
</span><span id="Base.cook_training_set-514"><a href="#Base.cook_training_set-514"><span class="linenos">514</span></a>
</span><span id="Base.cook_training_set-515"><a href="#Base.cook_training_set-515"><span class="linenos">515</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="Base.cook_training_set-516"><a href="#Base.cook_training_set-516"><span class="linenos">516</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span> <span class="o">&lt;=</span> <span class="mi">0</span>
</span><span id="Base.cook_training_set-517"><a href="#Base.cook_training_set-517"><span class="linenos">517</span></a>        <span class="p">):</span>  <span class="c1"># data without any clustering: self.n_clusters is None -----</span>
</span><span id="Base.cook_training_set-518"><a href="#Base.cook_training_set-518"><span class="linenos">518</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># with hidden layer</span>
</span><span id="Base.cook_training_set-519"><a href="#Base.cook_training_set-519"><span class="linenos">519</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">nn_scaler_</span><span class="p">,</span> <span class="n">scaled_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">scale_covariates</span><span class="p">(</span>
</span><span id="Base.cook_training_set-520"><a href="#Base.cook_training_set-520"><span class="linenos">520</span></a>                    <span class="n">input_X</span><span class="p">,</span> <span class="n">choice</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Base.cook_training_set-521"><a href="#Base.cook_training_set-521"><span class="linenos">521</span></a>                <span class="p">)</span>
</span><span id="Base.cook_training_set-522"><a href="#Base.cook_training_set-522"><span class="linenos">522</span></a>                <span class="n">Phi_X</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Base.cook_training_set-523"><a href="#Base.cook_training_set-523"><span class="linenos">523</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">create_layer</span><span class="p">(</span><span class="n">scaled_X</span><span class="p">)</span>
</span><span id="Base.cook_training_set-524"><a href="#Base.cook_training_set-524"><span class="linenos">524</span></a>                    <span class="k">if</span> <span class="n">W</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="Base.cook_training_set-525"><a href="#Base.cook_training_set-525"><span class="linenos">525</span></a>                    <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_layer</span><span class="p">(</span><span class="n">scaled_X</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>
</span><span id="Base.cook_training_set-526"><a href="#Base.cook_training_set-526"><span class="linenos">526</span></a>                <span class="p">)</span>
</span><span id="Base.cook_training_set-527"><a href="#Base.cook_training_set-527"><span class="linenos">527</span></a>                <span class="n">Z</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Base.cook_training_set-528"><a href="#Base.cook_training_set-528"><span class="linenos">528</span></a>                    <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">input_X</span><span class="p">,</span> <span class="n">Phi_X</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Base.cook_training_set-529"><a href="#Base.cook_training_set-529"><span class="linenos">529</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span> <span class="ow">is</span> <span class="kc">True</span>
</span><span id="Base.cook_training_set-530"><a href="#Base.cook_training_set-530"><span class="linenos">530</span></a>                    <span class="k">else</span> <span class="n">Phi_X</span>
</span><span id="Base.cook_training_set-531"><a href="#Base.cook_training_set-531"><span class="linenos">531</span></a>                <span class="p">)</span>
</span><span id="Base.cook_training_set-532"><a href="#Base.cook_training_set-532"><span class="linenos">532</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">scale_covariates</span><span class="p">(</span>
</span><span id="Base.cook_training_set-533"><a href="#Base.cook_training_set-533"><span class="linenos">533</span></a>                    <span class="n">Z</span><span class="p">,</span> <span class="n">choice</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Base.cook_training_set-534"><a href="#Base.cook_training_set-534"><span class="linenos">534</span></a>                <span class="p">)</span>
</span><span id="Base.cook_training_set-535"><a href="#Base.cook_training_set-535"><span class="linenos">535</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># no hidden layer</span>
</span><span id="Base.cook_training_set-536"><a href="#Base.cook_training_set-536"><span class="linenos">536</span></a>                <span class="n">Z</span> <span class="o">=</span> <span class="n">input_X</span>
</span><span id="Base.cook_training_set-537"><a href="#Base.cook_training_set-537"><span class="linenos">537</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">scale_covariates</span><span class="p">(</span>
</span><span id="Base.cook_training_set-538"><a href="#Base.cook_training_set-538"><span class="linenos">538</span></a>                    <span class="n">Z</span><span class="p">,</span> <span class="n">choice</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Base.cook_training_set-539"><a href="#Base.cook_training_set-539"><span class="linenos">539</span></a>                <span class="p">)</span>
</span><span id="Base.cook_training_set-540"><a href="#Base.cook_training_set-540"><span class="linenos">540</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># data with clustering: self.n_clusters is not None ----- # keep</span>
</span><span id="Base.cook_training_set-541"><a href="#Base.cook_training_set-541"><span class="linenos">541</span></a>            <span class="n">augmented_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span>
</span><span id="Base.cook_training_set-542"><a href="#Base.cook_training_set-542"><span class="linenos">542</span></a>                <span class="n">input_X</span><span class="p">,</span>
</span><span id="Base.cook_training_set-543"><a href="#Base.cook_training_set-543"><span class="linenos">543</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">encode_clusters</span><span class="p">(</span><span class="n">input_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="Base.cook_training_set-544"><a href="#Base.cook_training_set-544"><span class="linenos">544</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Base.cook_training_set-545"><a href="#Base.cook_training_set-545"><span class="linenos">545</span></a>            <span class="p">)</span>
</span><span id="Base.cook_training_set-546"><a href="#Base.cook_training_set-546"><span class="linenos">546</span></a>
</span><span id="Base.cook_training_set-547"><a href="#Base.cook_training_set-547"><span class="linenos">547</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># with hidden layer</span>
</span><span id="Base.cook_training_set-548"><a href="#Base.cook_training_set-548"><span class="linenos">548</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">nn_scaler_</span><span class="p">,</span> <span class="n">scaled_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">scale_covariates</span><span class="p">(</span>
</span><span id="Base.cook_training_set-549"><a href="#Base.cook_training_set-549"><span class="linenos">549</span></a>                    <span class="n">augmented_X</span><span class="p">,</span> <span class="n">choice</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Base.cook_training_set-550"><a href="#Base.cook_training_set-550"><span class="linenos">550</span></a>                <span class="p">)</span>
</span><span id="Base.cook_training_set-551"><a href="#Base.cook_training_set-551"><span class="linenos">551</span></a>                <span class="n">Phi_X</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Base.cook_training_set-552"><a href="#Base.cook_training_set-552"><span class="linenos">552</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">create_layer</span><span class="p">(</span><span class="n">scaled_X</span><span class="p">)</span>
</span><span id="Base.cook_training_set-553"><a href="#Base.cook_training_set-553"><span class="linenos">553</span></a>                    <span class="k">if</span> <span class="n">W</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="Base.cook_training_set-554"><a href="#Base.cook_training_set-554"><span class="linenos">554</span></a>                    <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_layer</span><span class="p">(</span><span class="n">scaled_X</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>
</span><span id="Base.cook_training_set-555"><a href="#Base.cook_training_set-555"><span class="linenos">555</span></a>                <span class="p">)</span>
</span><span id="Base.cook_training_set-556"><a href="#Base.cook_training_set-556"><span class="linenos">556</span></a>                <span class="n">Z</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Base.cook_training_set-557"><a href="#Base.cook_training_set-557"><span class="linenos">557</span></a>                    <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">augmented_X</span><span class="p">,</span> <span class="n">Phi_X</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Base.cook_training_set-558"><a href="#Base.cook_training_set-558"><span class="linenos">558</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span> <span class="ow">is</span> <span class="kc">True</span>
</span><span id="Base.cook_training_set-559"><a href="#Base.cook_training_set-559"><span class="linenos">559</span></a>                    <span class="k">else</span> <span class="n">Phi_X</span>
</span><span id="Base.cook_training_set-560"><a href="#Base.cook_training_set-560"><span class="linenos">560</span></a>                <span class="p">)</span>
</span><span id="Base.cook_training_set-561"><a href="#Base.cook_training_set-561"><span class="linenos">561</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">scale_covariates</span><span class="p">(</span>
</span><span id="Base.cook_training_set-562"><a href="#Base.cook_training_set-562"><span class="linenos">562</span></a>                    <span class="n">Z</span><span class="p">,</span> <span class="n">choice</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Base.cook_training_set-563"><a href="#Base.cook_training_set-563"><span class="linenos">563</span></a>                <span class="p">)</span>
</span><span id="Base.cook_training_set-564"><a href="#Base.cook_training_set-564"><span class="linenos">564</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># no hidden layer</span>
</span><span id="Base.cook_training_set-565"><a href="#Base.cook_training_set-565"><span class="linenos">565</span></a>                <span class="n">Z</span> <span class="o">=</span> <span class="n">augmented_X</span>
</span><span id="Base.cook_training_set-566"><a href="#Base.cook_training_set-566"><span class="linenos">566</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">scale_covariates</span><span class="p">(</span>
</span><span id="Base.cook_training_set-567"><a href="#Base.cook_training_set-567"><span class="linenos">567</span></a>                    <span class="n">Z</span><span class="p">,</span> <span class="n">choice</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Base.cook_training_set-568"><a href="#Base.cook_training_set-568"><span class="linenos">568</span></a>                <span class="p">)</span>
</span><span id="Base.cook_training_set-569"><a href="#Base.cook_training_set-569"><span class="linenos">569</span></a>
</span><span id="Base.cook_training_set-570"><a href="#Base.cook_training_set-570"><span class="linenos">570</span></a>        <span class="c1"># Returning model inputs -----</span>
</span><span id="Base.cook_training_set-571"><a href="#Base.cook_training_set-571"><span class="linenos">571</span></a>        <span class="k">if</span> <span class="n">mx</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>  <span class="c1"># regression</span>
</span><span id="Base.cook_training_set-572"><a href="#Base.cook_training_set-572"><span class="linenos">572</span></a>            <span class="c1"># center y</span>
</span><span id="Base.cook_training_set-573"><a href="#Base.cook_training_set-573"><span class="linenos">573</span></a>            <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Base.cook_training_set-574"><a href="#Base.cook_training_set-574"><span class="linenos">574</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span><span class="p">,</span> <span class="n">centered_y</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">center_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">)</span>
</span><span id="Base.cook_training_set-575"><a href="#Base.cook_training_set-575"><span class="linenos">575</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Base.cook_training_set-576"><a href="#Base.cook_training_set-576"><span class="linenos">576</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span><span class="p">,</span> <span class="n">centered_y</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">center_response</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="Base.cook_training_set-577"><a href="#Base.cook_training_set-577"><span class="linenos">577</span></a>
</span><span id="Base.cook_training_set-578"><a href="#Base.cook_training_set-578"><span class="linenos">578</span></a>            <span class="c1"># y is subsampled</span>
</span><span id="Base.cook_training_set-579"><a href="#Base.cook_training_set-579"><span class="linenos">579</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Base.cook_training_set-580"><a href="#Base.cook_training_set-580"><span class="linenos">580</span></a>                <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span>
</span><span id="Base.cook_training_set-581"><a href="#Base.cook_training_set-581"><span class="linenos">581</span></a>
</span><span id="Base.cook_training_set-582"><a href="#Base.cook_training_set-582"><span class="linenos">582</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">subsampler_</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Base.cook_training_set-583"><a href="#Base.cook_training_set-583"><span class="linenos">583</span></a>                    <span class="n">SubSampler</span><span class="p">(</span>
</span><span id="Base.cook_training_set-584"><a href="#Base.cook_training_set-584"><span class="linenos">584</span></a>                        <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">,</span> <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span>
</span><span id="Base.cook_training_set-585"><a href="#Base.cook_training_set-585"><span class="linenos">585</span></a>                    <span class="p">)</span>
</span><span id="Base.cook_training_set-586"><a href="#Base.cook_training_set-586"><span class="linenos">586</span></a>                    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="Base.cook_training_set-587"><a href="#Base.cook_training_set-587"><span class="linenos">587</span></a>                    <span class="k">else</span> <span class="n">SubSampler</span><span class="p">(</span>
</span><span id="Base.cook_training_set-588"><a href="#Base.cook_training_set-588"><span class="linenos">588</span></a>                        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span>
</span><span id="Base.cook_training_set-589"><a href="#Base.cook_training_set-589"><span class="linenos">589</span></a>                    <span class="p">)</span>
</span><span id="Base.cook_training_set-590"><a href="#Base.cook_training_set-590"><span class="linenos">590</span></a>                <span class="p">)</span>
</span><span id="Base.cook_training_set-591"><a href="#Base.cook_training_set-591"><span class="linenos">591</span></a>
</span><span id="Base.cook_training_set-592"><a href="#Base.cook_training_set-592"><span class="linenos">592</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsampler_</span><span class="o">.</span><span class="n">subsample</span><span class="p">()</span>
</span><span id="Base.cook_training_set-593"><a href="#Base.cook_training_set-593"><span class="linenos">593</span></a>
</span><span id="Base.cook_training_set-594"><a href="#Base.cook_training_set-594"><span class="linenos">594</span></a>                <span class="n">n_row_sample</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span><span class="p">)</span>
</span><span id="Base.cook_training_set-595"><a href="#Base.cook_training_set-595"><span class="linenos">595</span></a>                <span class="c1"># regression</span>
</span><span id="Base.cook_training_set-596"><a href="#Base.cook_training_set-596"><span class="linenos">596</span></a>                <span class="k">return</span> <span class="p">(</span>
</span><span id="Base.cook_training_set-597"><a href="#Base.cook_training_set-597"><span class="linenos">597</span></a>                    <span class="n">centered_y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_row_sample</span><span class="p">),</span>
</span><span id="Base.cook_training_set-598"><a href="#Base.cook_training_set-598"><span class="linenos">598</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
</span><span id="Base.cook_training_set-599"><a href="#Base.cook_training_set-599"><span class="linenos">599</span></a>                        <span class="n">Z</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_row_sample</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span><span id="Base.cook_training_set-600"><a href="#Base.cook_training_set-600"><span class="linenos">600</span></a>                    <span class="p">),</span>
</span><span id="Base.cook_training_set-601"><a href="#Base.cook_training_set-601"><span class="linenos">601</span></a>                <span class="p">)</span>
</span><span id="Base.cook_training_set-602"><a href="#Base.cook_training_set-602"><span class="linenos">602</span></a>            <span class="c1"># y is not subsampled</span>
</span><span id="Base.cook_training_set-603"><a href="#Base.cook_training_set-603"><span class="linenos">603</span></a>            <span class="c1"># regression</span>
</span><span id="Base.cook_training_set-604"><a href="#Base.cook_training_set-604"><span class="linenos">604</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">centered_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span>
</span><span id="Base.cook_training_set-605"><a href="#Base.cook_training_set-605"><span class="linenos">605</span></a>
</span><span id="Base.cook_training_set-606"><a href="#Base.cook_training_set-606"><span class="linenos">606</span></a>        <span class="c1"># classification</span>
</span><span id="Base.cook_training_set-607"><a href="#Base.cook_training_set-607"><span class="linenos">607</span></a>        <span class="c1"># y is subsampled</span>
</span><span id="Base.cook_training_set-608"><a href="#Base.cook_training_set-608"><span class="linenos">608</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Base.cook_training_set-609"><a href="#Base.cook_training_set-609"><span class="linenos">609</span></a>            <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span>
</span><span id="Base.cook_training_set-610"><a href="#Base.cook_training_set-610"><span class="linenos">610</span></a>
</span><span id="Base.cook_training_set-611"><a href="#Base.cook_training_set-611"><span class="linenos">611</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">subsampler_</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Base.cook_training_set-612"><a href="#Base.cook_training_set-612"><span class="linenos">612</span></a>                <span class="n">SubSampler</span><span class="p">(</span>
</span><span id="Base.cook_training_set-613"><a href="#Base.cook_training_set-613"><span class="linenos">613</span></a>                    <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">,</span> <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span>
</span><span id="Base.cook_training_set-614"><a href="#Base.cook_training_set-614"><span class="linenos">614</span></a>                <span class="p">)</span>
</span><span id="Base.cook_training_set-615"><a href="#Base.cook_training_set-615"><span class="linenos">615</span></a>                <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span>
</span><span id="Base.cook_training_set-616"><a href="#Base.cook_training_set-616"><span class="linenos">616</span></a>                <span class="k">else</span> <span class="n">SubSampler</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="Base.cook_training_set-617"><a href="#Base.cook_training_set-617"><span class="linenos">617</span></a>            <span class="p">)</span>
</span><span id="Base.cook_training_set-618"><a href="#Base.cook_training_set-618"><span class="linenos">618</span></a>
</span><span id="Base.cook_training_set-619"><a href="#Base.cook_training_set-619"><span class="linenos">619</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subsampler_</span><span class="o">.</span><span class="n">subsample</span><span class="p">()</span>
</span><span id="Base.cook_training_set-620"><a href="#Base.cook_training_set-620"><span class="linenos">620</span></a>
</span><span id="Base.cook_training_set-621"><a href="#Base.cook_training_set-621"><span class="linenos">621</span></a>            <span class="n">n_row_sample</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span><span class="p">)</span>
</span><span id="Base.cook_training_set-622"><a href="#Base.cook_training_set-622"><span class="linenos">622</span></a>            <span class="c1"># classification</span>
</span><span id="Base.cook_training_set-623"><a href="#Base.cook_training_set-623"><span class="linenos">623</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="Base.cook_training_set-624"><a href="#Base.cook_training_set-624"><span class="linenos">624</span></a>                <span class="n">y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_row_sample</span><span class="p">),</span>
</span><span id="Base.cook_training_set-625"><a href="#Base.cook_training_set-625"><span class="linenos">625</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
</span><span id="Base.cook_training_set-626"><a href="#Base.cook_training_set-626"><span class="linenos">626</span></a>                    <span class="n">Z</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_row_sample</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span><span id="Base.cook_training_set-627"><a href="#Base.cook_training_set-627"><span class="linenos">627</span></a>                <span class="p">),</span>
</span><span id="Base.cook_training_set-628"><a href="#Base.cook_training_set-628"><span class="linenos">628</span></a>            <span class="p">)</span>
</span><span id="Base.cook_training_set-629"><a href="#Base.cook_training_set-629"><span class="linenos">629</span></a>        <span class="c1"># y is not subsampled</span>
</span><span id="Base.cook_training_set-630"><a href="#Base.cook_training_set-630"><span class="linenos">630</span></a>        <span class="c1"># classification</span>
</span><span id="Base.cook_training_set-631"><a href="#Base.cook_training_set-631"><span class="linenos">631</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Create new hidden features for training set, with hidden layer, center the response.</p>

<p>Parameters:</p>

<pre><code>y: array-like, shape = [n_samples]
    Target values

X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features

W: {array-like}, shape = [n_features, hidden_features]
    if provided, constructs the hidden layer via W
</code></pre>

<p>Returns:</p>

<pre><code>(centered response, direct link + hidden layer matrix): {tuple}
</code></pre>
</div>


                                </div>
                                <div id="Base.cook_test_set" class="classattr">
                                            <input id="Base.cook_test_set-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cook_test_set</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Base.cook_test_set-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Base.cook_test_set"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Base.cook_test_set-633"><a href="#Base.cook_test_set-633"><span class="linenos">633</span></a>    <span class="k">def</span> <span class="nf">cook_test_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Base.cook_test_set-634"><a href="#Base.cook_test_set-634"><span class="linenos">634</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Transform data from test set, with hidden layer.</span>
</span><span id="Base.cook_test_set-635"><a href="#Base.cook_test_set-635"><span class="linenos">635</span></a>
</span><span id="Base.cook_test_set-636"><a href="#Base.cook_test_set-636"><span class="linenos">636</span></a><span class="sd">        Parameters:</span>
</span><span id="Base.cook_test_set-637"><a href="#Base.cook_test_set-637"><span class="linenos">637</span></a>
</span><span id="Base.cook_test_set-638"><a href="#Base.cook_test_set-638"><span class="linenos">638</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Base.cook_test_set-639"><a href="#Base.cook_test_set-639"><span class="linenos">639</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Base.cook_test_set-640"><a href="#Base.cook_test_set-640"><span class="linenos">640</span></a><span class="sd">                of samples and n_features is the number of features</span>
</span><span id="Base.cook_test_set-641"><a href="#Base.cook_test_set-641"><span class="linenos">641</span></a>
</span><span id="Base.cook_test_set-642"><a href="#Base.cook_test_set-642"><span class="linenos">642</span></a><span class="sd">            **kwargs: additional parameters to be passed to self.encode_cluster</span>
</span><span id="Base.cook_test_set-643"><a href="#Base.cook_test_set-643"><span class="linenos">643</span></a>
</span><span id="Base.cook_test_set-644"><a href="#Base.cook_test_set-644"><span class="linenos">644</span></a><span class="sd">        Returns:</span>
</span><span id="Base.cook_test_set-645"><a href="#Base.cook_test_set-645"><span class="linenos">645</span></a>
</span><span id="Base.cook_test_set-646"><a href="#Base.cook_test_set-646"><span class="linenos">646</span></a><span class="sd">            Transformed test set : {array-like}</span>
</span><span id="Base.cook_test_set-647"><a href="#Base.cook_test_set-647"><span class="linenos">647</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Base.cook_test_set-648"><a href="#Base.cook_test_set-648"><span class="linenos">648</span></a>
</span><span id="Base.cook_test_set-649"><a href="#Base.cook_test_set-649"><span class="linenos">649</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Base.cook_test_set-650"><a href="#Base.cook_test_set-650"><span class="linenos">650</span></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span>
</span><span id="Base.cook_test_set-651"><a href="#Base.cook_test_set-651"><span class="linenos">651</span></a>
</span><span id="Base.cook_test_set-652"><a href="#Base.cook_test_set-652"><span class="linenos">652</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="Base.cook_test_set-653"><a href="#Base.cook_test_set-653"><span class="linenos">653</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span> <span class="o">==</span> <span class="mi">0</span>
</span><span id="Base.cook_test_set-654"><a href="#Base.cook_test_set-654"><span class="linenos">654</span></a>        <span class="p">):</span>  <span class="c1"># data without clustering: self.n_clusters is None -----</span>
</span><span id="Base.cook_test_set-655"><a href="#Base.cook_test_set-655"><span class="linenos">655</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Base.cook_test_set-656"><a href="#Base.cook_test_set-656"><span class="linenos">656</span></a>                <span class="c1"># if hidden layer</span>
</span><span id="Base.cook_test_set-657"><a href="#Base.cook_test_set-657"><span class="linenos">657</span></a>                <span class="n">scaled_X</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Base.cook_test_set-658"><a href="#Base.cook_test_set-658"><span class="linenos">658</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">nn_scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="Base.cook_test_set-659"><a href="#Base.cook_test_set-659"><span class="linenos">659</span></a>                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Base.cook_test_set-660"><a href="#Base.cook_test_set-660"><span class="linenos">660</span></a>                    <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">nn_scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_col_</span><span class="p">])</span>
</span><span id="Base.cook_test_set-661"><a href="#Base.cook_test_set-661"><span class="linenos">661</span></a>                <span class="p">)</span>
</span><span id="Base.cook_test_set-662"><a href="#Base.cook_test_set-662"><span class="linenos">662</span></a>                <span class="n">Phi_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_layer</span><span class="p">(</span><span class="n">scaled_X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_</span><span class="p">)</span>
</span><span id="Base.cook_test_set-663"><a href="#Base.cook_test_set-663"><span class="linenos">663</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Base.cook_test_set-664"><a href="#Base.cook_test_set-664"><span class="linenos">664</span></a>                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
</span><span id="Base.cook_test_set-665"><a href="#Base.cook_test_set-665"><span class="linenos">665</span></a>                        <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">scaled_X</span><span class="p">,</span> <span class="n">Phi_X</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Base.cook_test_set-666"><a href="#Base.cook_test_set-666"><span class="linenos">666</span></a>                    <span class="p">)</span>
</span><span id="Base.cook_test_set-667"><a href="#Base.cook_test_set-667"><span class="linenos">667</span></a>                <span class="c1"># when self.direct_link == False</span>
</span><span id="Base.cook_test_set-668"><a href="#Base.cook_test_set-668"><span class="linenos">668</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Phi_X</span><span class="p">)</span>
</span><span id="Base.cook_test_set-669"><a href="#Base.cook_test_set-669"><span class="linenos">669</span></a>            <span class="c1"># if no hidden layer # self.n_hidden_features == 0</span>
</span><span id="Base.cook_test_set-670"><a href="#Base.cook_test_set-670"><span class="linenos">670</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="Base.cook_test_set-671"><a href="#Base.cook_test_set-671"><span class="linenos">671</span></a>
</span><span id="Base.cook_test_set-672"><a href="#Base.cook_test_set-672"><span class="linenos">672</span></a>        <span class="c1"># data with clustering: self.n_clusters &gt; 0 -----</span>
</span><span id="Base.cook_test_set-673"><a href="#Base.cook_test_set-673"><span class="linenos">673</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Base.cook_test_set-674"><a href="#Base.cook_test_set-674"><span class="linenos">674</span></a>            <span class="n">predicted_clusters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode_clusters</span><span class="p">(</span>
</span><span id="Base.cook_test_set-675"><a href="#Base.cook_test_set-675"><span class="linenos">675</span></a>                <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">predict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Base.cook_test_set-676"><a href="#Base.cook_test_set-676"><span class="linenos">676</span></a>            <span class="p">)</span>
</span><span id="Base.cook_test_set-677"><a href="#Base.cook_test_set-677"><span class="linenos">677</span></a>            <span class="n">augmented_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">predicted_clusters</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Base.cook_test_set-678"><a href="#Base.cook_test_set-678"><span class="linenos">678</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Base.cook_test_set-679"><a href="#Base.cook_test_set-679"><span class="linenos">679</span></a>            <span class="n">predicted_clusters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode_clusters</span><span class="p">(</span>
</span><span id="Base.cook_test_set-680"><a href="#Base.cook_test_set-680"><span class="linenos">680</span></a>                <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_col_</span><span class="p">],</span> <span class="n">predict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Base.cook_test_set-681"><a href="#Base.cook_test_set-681"><span class="linenos">681</span></a>            <span class="p">)</span>
</span><span id="Base.cook_test_set-682"><a href="#Base.cook_test_set-682"><span class="linenos">682</span></a>            <span class="n">augmented_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span>
</span><span id="Base.cook_test_set-683"><a href="#Base.cook_test_set-683"><span class="linenos">683</span></a>                <span class="n">X</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_col_</span><span class="p">],</span> <span class="n">predicted_clusters</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span>
</span><span id="Base.cook_test_set-684"><a href="#Base.cook_test_set-684"><span class="linenos">684</span></a>            <span class="p">)</span>
</span><span id="Base.cook_test_set-685"><a href="#Base.cook_test_set-685"><span class="linenos">685</span></a>
</span><span id="Base.cook_test_set-686"><a href="#Base.cook_test_set-686"><span class="linenos">686</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># if hidden layer</span>
</span><span id="Base.cook_test_set-687"><a href="#Base.cook_test_set-687"><span class="linenos">687</span></a>            <span class="n">scaled_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nn_scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">augmented_X</span><span class="p">)</span>
</span><span id="Base.cook_test_set-688"><a href="#Base.cook_test_set-688"><span class="linenos">688</span></a>            <span class="n">Phi_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_layer</span><span class="p">(</span><span class="n">scaled_X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">W_</span><span class="p">)</span>
</span><span id="Base.cook_test_set-689"><a href="#Base.cook_test_set-689"><span class="linenos">689</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Base.cook_test_set-690"><a href="#Base.cook_test_set-690"><span class="linenos">690</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
</span><span id="Base.cook_test_set-691"><a href="#Base.cook_test_set-691"><span class="linenos">691</span></a>                    <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">augmented_X</span><span class="p">,</span> <span class="n">Phi_X</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Base.cook_test_set-692"><a href="#Base.cook_test_set-692"><span class="linenos">692</span></a>                <span class="p">)</span>
</span><span id="Base.cook_test_set-693"><a href="#Base.cook_test_set-693"><span class="linenos">693</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Phi_X</span><span class="p">)</span>
</span><span id="Base.cook_test_set-694"><a href="#Base.cook_test_set-694"><span class="linenos">694</span></a>
</span><span id="Base.cook_test_set-695"><a href="#Base.cook_test_set-695"><span class="linenos">695</span></a>        <span class="c1"># if no hidden layer</span>
</span><span id="Base.cook_test_set-696"><a href="#Base.cook_test_set-696"><span class="linenos">696</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">augmented_X</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Transform data from test set, with hidden layer.</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features

**kwargs: additional parameters to be passed to self.encode_cluster
</code></pre>

<p>Returns:</p>

<pre><code>Transformed test set : {array-like}
</code></pre>
</div>


                                </div>
                                <div id="Base.score" class="classattr">
                                            <input id="Base.score-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">score</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">scoring</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Base.score-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Base.score"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Base.score-698"><a href="#Base.score-698"><span class="linenos">698</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Base.score-699"><a href="#Base.score-699"><span class="linenos">699</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Score the model on test set features X and response y.</span>
</span><span id="Base.score-700"><a href="#Base.score-700"><span class="linenos">700</span></a>
</span><span id="Base.score-701"><a href="#Base.score-701"><span class="linenos">701</span></a><span class="sd">        Parameters:</span>
</span><span id="Base.score-702"><a href="#Base.score-702"><span class="linenos">702</span></a>
</span><span id="Base.score-703"><a href="#Base.score-703"><span class="linenos">703</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Base.score-704"><a href="#Base.score-704"><span class="linenos">704</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Base.score-705"><a href="#Base.score-705"><span class="linenos">705</span></a><span class="sd">                of samples and n_features is the number of features</span>
</span><span id="Base.score-706"><a href="#Base.score-706"><span class="linenos">706</span></a>
</span><span id="Base.score-707"><a href="#Base.score-707"><span class="linenos">707</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="Base.score-708"><a href="#Base.score-708"><span class="linenos">708</span></a><span class="sd">                Target values</span>
</span><span id="Base.score-709"><a href="#Base.score-709"><span class="linenos">709</span></a>
</span><span id="Base.score-710"><a href="#Base.score-710"><span class="linenos">710</span></a><span class="sd">            scoring: str</span>
</span><span id="Base.score-711"><a href="#Base.score-711"><span class="linenos">711</span></a><span class="sd">                must be in (&#39;explained_variance&#39;, &#39;neg_mean_absolute_error&#39;,</span>
</span><span id="Base.score-712"><a href="#Base.score-712"><span class="linenos">712</span></a><span class="sd">                            &#39;neg_mean_squared_error&#39;, &#39;neg_mean_squared_log_error&#39;,</span>
</span><span id="Base.score-713"><a href="#Base.score-713"><span class="linenos">713</span></a><span class="sd">                            &#39;neg_median_absolute_error&#39;, &#39;r2&#39;)</span>
</span><span id="Base.score-714"><a href="#Base.score-714"><span class="linenos">714</span></a>
</span><span id="Base.score-715"><a href="#Base.score-715"><span class="linenos">715</span></a><span class="sd">            **kwargs: additional parameters to be passed to scoring functions</span>
</span><span id="Base.score-716"><a href="#Base.score-716"><span class="linenos">716</span></a>
</span><span id="Base.score-717"><a href="#Base.score-717"><span class="linenos">717</span></a><span class="sd">        Returns:</span>
</span><span id="Base.score-718"><a href="#Base.score-718"><span class="linenos">718</span></a>
</span><span id="Base.score-719"><a href="#Base.score-719"><span class="linenos">719</span></a><span class="sd">        model scores: {array-like}</span>
</span><span id="Base.score-720"><a href="#Base.score-720"><span class="linenos">720</span></a>
</span><span id="Base.score-721"><a href="#Base.score-721"><span class="linenos">721</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Base.score-722"><a href="#Base.score-722"><span class="linenos">722</span></a>
</span><span id="Base.score-723"><a href="#Base.score-723"><span class="linenos">723</span></a>        <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="Base.score-724"><a href="#Base.score-724"><span class="linenos">724</span></a>
</span><span id="Base.score-725"><a href="#Base.score-725"><span class="linenos">725</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_fit</span> <span class="o">==</span> <span class="s2">&quot;classification&quot;</span><span class="p">:</span>
</span><span id="Base.score-726"><a href="#Base.score-726"><span class="linenos">726</span></a>
</span><span id="Base.score-727"><a href="#Base.score-727"><span class="linenos">727</span></a>            <span class="k">if</span> <span class="n">scoring</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Base.score-728"><a href="#Base.score-728"><span class="linenos">728</span></a>                <span class="n">scoring</span> <span class="o">=</span> <span class="s2">&quot;accuracy&quot;</span>
</span><span id="Base.score-729"><a href="#Base.score-729"><span class="linenos">729</span></a>
</span><span id="Base.score-730"><a href="#Base.score-730"><span class="linenos">730</span></a>            <span class="c1"># check inputs</span>
</span><span id="Base.score-731"><a href="#Base.score-731"><span class="linenos">731</span></a>            <span class="k">assert</span> <span class="n">scoring</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="Base.score-732"><a href="#Base.score-732"><span class="linenos">732</span></a>                <span class="s2">&quot;accuracy&quot;</span><span class="p">,</span>
</span><span id="Base.score-733"><a href="#Base.score-733"><span class="linenos">733</span></a>                <span class="s2">&quot;average_precision&quot;</span><span class="p">,</span>
</span><span id="Base.score-734"><a href="#Base.score-734"><span class="linenos">734</span></a>                <span class="s2">&quot;brier_score_loss&quot;</span><span class="p">,</span>
</span><span id="Base.score-735"><a href="#Base.score-735"><span class="linenos">735</span></a>                <span class="s2">&quot;f1&quot;</span><span class="p">,</span>
</span><span id="Base.score-736"><a href="#Base.score-736"><span class="linenos">736</span></a>                <span class="s2">&quot;f1_micro&quot;</span><span class="p">,</span>
</span><span id="Base.score-737"><a href="#Base.score-737"><span class="linenos">737</span></a>                <span class="s2">&quot;f1_macro&quot;</span><span class="p">,</span>
</span><span id="Base.score-738"><a href="#Base.score-738"><span class="linenos">738</span></a>                <span class="s2">&quot;f1_weighted&quot;</span><span class="p">,</span>
</span><span id="Base.score-739"><a href="#Base.score-739"><span class="linenos">739</span></a>                <span class="s2">&quot;f1_samples&quot;</span><span class="p">,</span>
</span><span id="Base.score-740"><a href="#Base.score-740"><span class="linenos">740</span></a>                <span class="s2">&quot;neg_log_loss&quot;</span><span class="p">,</span>
</span><span id="Base.score-741"><a href="#Base.score-741"><span class="linenos">741</span></a>                <span class="s2">&quot;precision&quot;</span><span class="p">,</span>
</span><span id="Base.score-742"><a href="#Base.score-742"><span class="linenos">742</span></a>                <span class="s2">&quot;recall&quot;</span><span class="p">,</span>
</span><span id="Base.score-743"><a href="#Base.score-743"><span class="linenos">743</span></a>                <span class="s2">&quot;roc_auc&quot;</span><span class="p">,</span>
</span><span id="Base.score-744"><a href="#Base.score-744"><span class="linenos">744</span></a>            <span class="p">),</span> <span class="s2">&quot;&#39;scoring&#39; should be in (&#39;accuracy&#39;, &#39;average_precision&#39;, </span><span class="se">\</span>
</span><span id="Base.score-745"><a href="#Base.score-745"><span class="linenos">745</span></a><span class="s2">                            &#39;brier_score_loss&#39;, &#39;f1&#39;, &#39;f1_micro&#39;, </span><span class="se">\</span>
</span><span id="Base.score-746"><a href="#Base.score-746"><span class="linenos">746</span></a><span class="s2">                            &#39;f1_macro&#39;, &#39;f1_weighted&#39;,  &#39;f1_samples&#39;, </span><span class="se">\</span>
</span><span id="Base.score-747"><a href="#Base.score-747"><span class="linenos">747</span></a><span class="s2">                            &#39;neg_log_loss&#39;, &#39;precision&#39;, &#39;recall&#39;, </span><span class="se">\</span>
</span><span id="Base.score-748"><a href="#Base.score-748"><span class="linenos">748</span></a><span class="s2">                            &#39;roc_auc&#39;)&quot;</span>
</span><span id="Base.score-749"><a href="#Base.score-749"><span class="linenos">749</span></a>
</span><span id="Base.score-750"><a href="#Base.score-750"><span class="linenos">750</span></a>            <span class="n">scoring_options</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Base.score-751"><a href="#Base.score-751"><span class="linenos">751</span></a>                <span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">,</span>
</span><span id="Base.score-752"><a href="#Base.score-752"><span class="linenos">752</span></a>                <span class="s2">&quot;average_precision&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">average_precision_score</span><span class="p">,</span>
</span><span id="Base.score-753"><a href="#Base.score-753"><span class="linenos">753</span></a>                <span class="s2">&quot;brier_score_loss&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">brier_score_loss</span><span class="p">,</span>
</span><span id="Base.score-754"><a href="#Base.score-754"><span class="linenos">754</span></a>                <span class="s2">&quot;f1&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">f1_score</span><span class="p">,</span>
</span><span id="Base.score-755"><a href="#Base.score-755"><span class="linenos">755</span></a>                <span class="s2">&quot;f1_micro&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">f1_score</span><span class="p">,</span>
</span><span id="Base.score-756"><a href="#Base.score-756"><span class="linenos">756</span></a>                <span class="s2">&quot;f1_macro&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">f1_score</span><span class="p">,</span>
</span><span id="Base.score-757"><a href="#Base.score-757"><span class="linenos">757</span></a>                <span class="s2">&quot;f1_weighted&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">f1_score</span><span class="p">,</span>
</span><span id="Base.score-758"><a href="#Base.score-758"><span class="linenos">758</span></a>                <span class="s2">&quot;f1_samples&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">f1_score</span><span class="p">,</span>
</span><span id="Base.score-759"><a href="#Base.score-759"><span class="linenos">759</span></a>                <span class="s2">&quot;neg_log_loss&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">log_loss</span><span class="p">,</span>
</span><span id="Base.score-760"><a href="#Base.score-760"><span class="linenos">760</span></a>                <span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">precision_score</span><span class="p">,</span>
</span><span id="Base.score-761"><a href="#Base.score-761"><span class="linenos">761</span></a>                <span class="s2">&quot;recall&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">recall_score</span><span class="p">,</span>
</span><span id="Base.score-762"><a href="#Base.score-762"><span class="linenos">762</span></a>                <span class="s2">&quot;roc_auc&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">roc_auc_score</span><span class="p">,</span>
</span><span id="Base.score-763"><a href="#Base.score-763"><span class="linenos">763</span></a>            <span class="p">}</span>
</span><span id="Base.score-764"><a href="#Base.score-764"><span class="linenos">764</span></a>
</span><span id="Base.score-765"><a href="#Base.score-765"><span class="linenos">765</span></a>            <span class="k">return</span> <span class="n">scoring_options</span><span class="p">[</span><span class="n">scoring</span><span class="p">](</span><span class="n">y</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Base.score-766"><a href="#Base.score-766"><span class="linenos">766</span></a>
</span><span id="Base.score-767"><a href="#Base.score-767"><span class="linenos">767</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_fit</span> <span class="o">==</span> <span class="s2">&quot;regression&quot;</span><span class="p">:</span>
</span><span id="Base.score-768"><a href="#Base.score-768"><span class="linenos">768</span></a>
</span><span id="Base.score-769"><a href="#Base.score-769"><span class="linenos">769</span></a>            <span class="k">if</span> <span class="p">(</span>
</span><span id="Base.score-770"><a href="#Base.score-770"><span class="linenos">770</span></a>                <span class="nb">type</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span>
</span><span id="Base.score-771"><a href="#Base.score-771"><span class="linenos">771</span></a>            <span class="p">):</span>  <span class="c1"># if there are std. devs in the predictions</span>
</span><span id="Base.score-772"><a href="#Base.score-772"><span class="linenos">772</span></a>                <span class="n">preds</span> <span class="o">=</span> <span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Base.score-773"><a href="#Base.score-773"><span class="linenos">773</span></a>
</span><span id="Base.score-774"><a href="#Base.score-774"><span class="linenos">774</span></a>            <span class="k">if</span> <span class="n">scoring</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Base.score-775"><a href="#Base.score-775"><span class="linenos">775</span></a>                <span class="n">scoring</span> <span class="o">=</span> <span class="s2">&quot;neg_root_mean_squared_error&quot;</span>
</span><span id="Base.score-776"><a href="#Base.score-776"><span class="linenos">776</span></a>
</span><span id="Base.score-777"><a href="#Base.score-777"><span class="linenos">777</span></a>            <span class="c1"># check inputs</span>
</span><span id="Base.score-778"><a href="#Base.score-778"><span class="linenos">778</span></a>            <span class="k">assert</span> <span class="n">scoring</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="Base.score-779"><a href="#Base.score-779"><span class="linenos">779</span></a>                <span class="s2">&quot;explained_variance&quot;</span><span class="p">,</span>
</span><span id="Base.score-780"><a href="#Base.score-780"><span class="linenos">780</span></a>                <span class="s2">&quot;neg_mean_absolute_error&quot;</span><span class="p">,</span>
</span><span id="Base.score-781"><a href="#Base.score-781"><span class="linenos">781</span></a>                <span class="s2">&quot;neg_mean_squared_error&quot;</span><span class="p">,</span>
</span><span id="Base.score-782"><a href="#Base.score-782"><span class="linenos">782</span></a>                <span class="s2">&quot;neg_mean_squared_log_error&quot;</span><span class="p">,</span>
</span><span id="Base.score-783"><a href="#Base.score-783"><span class="linenos">783</span></a>                <span class="s2">&quot;neg_median_absolute_error&quot;</span><span class="p">,</span>
</span><span id="Base.score-784"><a href="#Base.score-784"><span class="linenos">784</span></a>                <span class="s2">&quot;neg_root_mean_squared_error&quot;</span><span class="p">,</span>
</span><span id="Base.score-785"><a href="#Base.score-785"><span class="linenos">785</span></a>                <span class="s2">&quot;r2&quot;</span><span class="p">,</span>
</span><span id="Base.score-786"><a href="#Base.score-786"><span class="linenos">786</span></a>            <span class="p">),</span> <span class="s2">&quot;&#39;scoring&#39; should be in (&#39;explained_variance&#39;, &#39;neg_mean_absolute_error&#39;, </span><span class="se">\</span>
</span><span id="Base.score-787"><a href="#Base.score-787"><span class="linenos">787</span></a><span class="s2">                            &#39;neg_mean_squared_error&#39;, &#39;neg_mean_squared_log_error&#39;, </span><span class="se">\</span>
</span><span id="Base.score-788"><a href="#Base.score-788"><span class="linenos">788</span></a><span class="s2">                            &#39;neg_median_absolute_error&#39;, &#39;r2&#39;, &#39;neg_root_mean_squared_error&#39;)&quot;</span>
</span><span id="Base.score-789"><a href="#Base.score-789"><span class="linenos">789</span></a>
</span><span id="Base.score-790"><a href="#Base.score-790"><span class="linenos">790</span></a>            <span class="n">scoring_options</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Base.score-791"><a href="#Base.score-791"><span class="linenos">791</span></a>                <span class="s2">&quot;neg_root_mean_squared_error&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">root_mean_squared_error</span><span class="p">,</span>
</span><span id="Base.score-792"><a href="#Base.score-792"><span class="linenos">792</span></a>                <span class="s2">&quot;explained_variance&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">explained_variance_score</span><span class="p">,</span>
</span><span id="Base.score-793"><a href="#Base.score-793"><span class="linenos">793</span></a>                <span class="s2">&quot;neg_mean_absolute_error&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">median_absolute_error</span><span class="p">,</span>
</span><span id="Base.score-794"><a href="#Base.score-794"><span class="linenos">794</span></a>                <span class="s2">&quot;neg_mean_squared_error&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">,</span>
</span><span id="Base.score-795"><a href="#Base.score-795"><span class="linenos">795</span></a>                <span class="s2">&quot;neg_mean_squared_log_error&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">mean_squared_log_error</span><span class="p">,</span>
</span><span id="Base.score-796"><a href="#Base.score-796"><span class="linenos">796</span></a>                <span class="s2">&quot;neg_median_absolute_error&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">median_absolute_error</span><span class="p">,</span>
</span><span id="Base.score-797"><a href="#Base.score-797"><span class="linenos">797</span></a>                <span class="s2">&quot;r2&quot;</span><span class="p">:</span> <span class="n">skm</span><span class="o">.</span><span class="n">r2_score</span><span class="p">,</span>
</span><span id="Base.score-798"><a href="#Base.score-798"><span class="linenos">798</span></a>            <span class="p">}</span>
</span><span id="Base.score-799"><a href="#Base.score-799"><span class="linenos">799</span></a>
</span><span id="Base.score-800"><a href="#Base.score-800"><span class="linenos">800</span></a>            <span class="k">return</span> <span class="n">scoring_options</span><span class="p">[</span><span class="n">scoring</span><span class="p">](</span><span class="n">y</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Score the model on test set features X and response y.</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features

y: array-like, shape = [n_samples]
    Target values

scoring: str
    must be in ('explained_variance', 'neg_mean_absolute_error',
                'neg_mean_squared_error', 'neg_mean_squared_log_error',
                'neg_median_absolute_error', 'r2')

**kwargs: additional parameters to be passed to scoring functions
</code></pre>

<p>Returns:</p>

<p>model scores: {array-like}</p>
</div>


                                </div>
                        
                </section>
                <section id="BaseRegressor">
                            <input id="BaseRegressor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">BaseRegressor</span><wbr>(<span class="base"><a href="#Base">nnetsauce.Base</a></span>, <span class="base">sklearn.base.RegressorMixin</span>):

                <label class="view-source-button" for="BaseRegressor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaseRegressor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseRegressor-15"><a href="#BaseRegressor-15"><span class="linenos"> 15</span></a><span class="k">class</span> <span class="nc">BaseRegressor</span><span class="p">(</span><span class="n">Base</span><span class="p">,</span> <span class="n">RegressorMixin</span><span class="p">):</span>
</span><span id="BaseRegressor-16"><a href="#BaseRegressor-16"><span class="linenos"> 16</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Random Vector Functional Link Network regression without shrinkage</span>
</span><span id="BaseRegressor-17"><a href="#BaseRegressor-17"><span class="linenos"> 17</span></a>
</span><span id="BaseRegressor-18"><a href="#BaseRegressor-18"><span class="linenos"> 18</span></a><span class="sd">    Parameters:</span>
</span><span id="BaseRegressor-19"><a href="#BaseRegressor-19"><span class="linenos"> 19</span></a>
</span><span id="BaseRegressor-20"><a href="#BaseRegressor-20"><span class="linenos"> 20</span></a><span class="sd">        n_hidden_features: int</span>
</span><span id="BaseRegressor-21"><a href="#BaseRegressor-21"><span class="linenos"> 21</span></a><span class="sd">            number of nodes in the hidden layer</span>
</span><span id="BaseRegressor-22"><a href="#BaseRegressor-22"><span class="linenos"> 22</span></a>
</span><span id="BaseRegressor-23"><a href="#BaseRegressor-23"><span class="linenos"> 23</span></a><span class="sd">        activation_name: str</span>
</span><span id="BaseRegressor-24"><a href="#BaseRegressor-24"><span class="linenos"> 24</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;</span>
</span><span id="BaseRegressor-25"><a href="#BaseRegressor-25"><span class="linenos"> 25</span></a>
</span><span id="BaseRegressor-26"><a href="#BaseRegressor-26"><span class="linenos"> 26</span></a><span class="sd">        a: float</span>
</span><span id="BaseRegressor-27"><a href="#BaseRegressor-27"><span class="linenos"> 27</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function</span>
</span><span id="BaseRegressor-28"><a href="#BaseRegressor-28"><span class="linenos"> 28</span></a>
</span><span id="BaseRegressor-29"><a href="#BaseRegressor-29"><span class="linenos"> 29</span></a><span class="sd">        nodes_sim: str</span>
</span><span id="BaseRegressor-30"><a href="#BaseRegressor-30"><span class="linenos"> 30</span></a><span class="sd">            type of simulation for hidden layer nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;,</span>
</span><span id="BaseRegressor-31"><a href="#BaseRegressor-31"><span class="linenos"> 31</span></a><span class="sd">            &#39;uniform&#39;</span>
</span><span id="BaseRegressor-32"><a href="#BaseRegressor-32"><span class="linenos"> 32</span></a>
</span><span id="BaseRegressor-33"><a href="#BaseRegressor-33"><span class="linenos"> 33</span></a><span class="sd">        bias: boolean</span>
</span><span id="BaseRegressor-34"><a href="#BaseRegressor-34"><span class="linenos"> 34</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or</span>
</span><span id="BaseRegressor-35"><a href="#BaseRegressor-35"><span class="linenos"> 35</span></a><span class="sd">            not (False)</span>
</span><span id="BaseRegressor-36"><a href="#BaseRegressor-36"><span class="linenos"> 36</span></a>
</span><span id="BaseRegressor-37"><a href="#BaseRegressor-37"><span class="linenos"> 37</span></a><span class="sd">        dropout: float</span>
</span><span id="BaseRegressor-38"><a href="#BaseRegressor-38"><span class="linenos"> 38</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="BaseRegressor-39"><a href="#BaseRegressor-39"><span class="linenos"> 39</span></a><span class="sd">            of the training</span>
</span><span id="BaseRegressor-40"><a href="#BaseRegressor-40"><span class="linenos"> 40</span></a>
</span><span id="BaseRegressor-41"><a href="#BaseRegressor-41"><span class="linenos"> 41</span></a><span class="sd">        direct_link: boolean</span>
</span><span id="BaseRegressor-42"><a href="#BaseRegressor-42"><span class="linenos"> 42</span></a><span class="sd">            indicates if the original features are included (True) in model&#39;s</span>
</span><span id="BaseRegressor-43"><a href="#BaseRegressor-43"><span class="linenos"> 43</span></a><span class="sd">            fitting or not (False)</span>
</span><span id="BaseRegressor-44"><a href="#BaseRegressor-44"><span class="linenos"> 44</span></a>
</span><span id="BaseRegressor-45"><a href="#BaseRegressor-45"><span class="linenos"> 45</span></a><span class="sd">        n_clusters: int</span>
</span><span id="BaseRegressor-46"><a href="#BaseRegressor-46"><span class="linenos"> 46</span></a><span class="sd">            number of clusters for type_clust=&#39;kmeans&#39; or type_clust=&#39;gmm&#39;</span>
</span><span id="BaseRegressor-47"><a href="#BaseRegressor-47"><span class="linenos"> 47</span></a><span class="sd">            clustering (could be 0: no clustering)</span>
</span><span id="BaseRegressor-48"><a href="#BaseRegressor-48"><span class="linenos"> 48</span></a>
</span><span id="BaseRegressor-49"><a href="#BaseRegressor-49"><span class="linenos"> 49</span></a><span class="sd">        cluster_encode: bool</span>
</span><span id="BaseRegressor-50"><a href="#BaseRegressor-50"><span class="linenos"> 50</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot);</span>
</span><span id="BaseRegressor-51"><a href="#BaseRegressor-51"><span class="linenos"> 51</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding</span>
</span><span id="BaseRegressor-52"><a href="#BaseRegressor-52"><span class="linenos"> 52</span></a>
</span><span id="BaseRegressor-53"><a href="#BaseRegressor-53"><span class="linenos"> 53</span></a><span class="sd">        type_clust: str</span>
</span><span id="BaseRegressor-54"><a href="#BaseRegressor-54"><span class="linenos"> 54</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian</span>
</span><span id="BaseRegressor-55"><a href="#BaseRegressor-55"><span class="linenos"> 55</span></a><span class="sd">            Mixture Model (&#39;gmm&#39;)</span>
</span><span id="BaseRegressor-56"><a href="#BaseRegressor-56"><span class="linenos"> 56</span></a>
</span><span id="BaseRegressor-57"><a href="#BaseRegressor-57"><span class="linenos"> 57</span></a><span class="sd">        type_scaling: a tuple of 3 strings</span>
</span><span id="BaseRegressor-58"><a href="#BaseRegressor-58"><span class="linenos"> 58</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="BaseRegressor-59"><a href="#BaseRegressor-59"><span class="linenos"> 59</span></a><span class="sd">            (and when relevant).</span>
</span><span id="BaseRegressor-60"><a href="#BaseRegressor-60"><span class="linenos"> 60</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;)</span>
</span><span id="BaseRegressor-61"><a href="#BaseRegressor-61"><span class="linenos"> 61</span></a>
</span><span id="BaseRegressor-62"><a href="#BaseRegressor-62"><span class="linenos"> 62</span></a><span class="sd">        col_sample: float</span>
</span><span id="BaseRegressor-63"><a href="#BaseRegressor-63"><span class="linenos"> 63</span></a><span class="sd">            percentage of features randomly chosen for training</span>
</span><span id="BaseRegressor-64"><a href="#BaseRegressor-64"><span class="linenos"> 64</span></a>
</span><span id="BaseRegressor-65"><a href="#BaseRegressor-65"><span class="linenos"> 65</span></a><span class="sd">        row_sample: float</span>
</span><span id="BaseRegressor-66"><a href="#BaseRegressor-66"><span class="linenos"> 66</span></a><span class="sd">            percentage of rows chosen for training, by stratified bootstrapping</span>
</span><span id="BaseRegressor-67"><a href="#BaseRegressor-67"><span class="linenos"> 67</span></a>
</span><span id="BaseRegressor-68"><a href="#BaseRegressor-68"><span class="linenos"> 68</span></a><span class="sd">        seed: int</span>
</span><span id="BaseRegressor-69"><a href="#BaseRegressor-69"><span class="linenos"> 69</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39;, clustering and dropout</span>
</span><span id="BaseRegressor-70"><a href="#BaseRegressor-70"><span class="linenos"> 70</span></a>
</span><span id="BaseRegressor-71"><a href="#BaseRegressor-71"><span class="linenos"> 71</span></a><span class="sd">        backend: str</span>
</span><span id="BaseRegressor-72"><a href="#BaseRegressor-72"><span class="linenos"> 72</span></a><span class="sd">            &quot;cpu&quot; or &quot;gpu&quot; or &quot;tpu&quot;</span>
</span><span id="BaseRegressor-73"><a href="#BaseRegressor-73"><span class="linenos"> 73</span></a>
</span><span id="BaseRegressor-74"><a href="#BaseRegressor-74"><span class="linenos"> 74</span></a><span class="sd">    Attributes:</span>
</span><span id="BaseRegressor-75"><a href="#BaseRegressor-75"><span class="linenos"> 75</span></a>
</span><span id="BaseRegressor-76"><a href="#BaseRegressor-76"><span class="linenos"> 76</span></a><span class="sd">        beta_: vector</span>
</span><span id="BaseRegressor-77"><a href="#BaseRegressor-77"><span class="linenos"> 77</span></a><span class="sd">            regression coefficients</span>
</span><span id="BaseRegressor-78"><a href="#BaseRegressor-78"><span class="linenos"> 78</span></a>
</span><span id="BaseRegressor-79"><a href="#BaseRegressor-79"><span class="linenos"> 79</span></a><span class="sd">        GCV_: float</span>
</span><span id="BaseRegressor-80"><a href="#BaseRegressor-80"><span class="linenos"> 80</span></a><span class="sd">            Generalized Cross-Validation error</span>
</span><span id="BaseRegressor-81"><a href="#BaseRegressor-81"><span class="linenos"> 81</span></a>
</span><span id="BaseRegressor-82"><a href="#BaseRegressor-82"><span class="linenos"> 82</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="BaseRegressor-83"><a href="#BaseRegressor-83"><span class="linenos"> 83</span></a>
</span><span id="BaseRegressor-84"><a href="#BaseRegressor-84"><span class="linenos"> 84</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="BaseRegressor-85"><a href="#BaseRegressor-85"><span class="linenos"> 85</span></a>
</span><span id="BaseRegressor-86"><a href="#BaseRegressor-86"><span class="linenos"> 86</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="BaseRegressor-87"><a href="#BaseRegressor-87"><span class="linenos"> 87</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="BaseRegressor-88"><a href="#BaseRegressor-88"><span class="linenos"> 88</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="BaseRegressor-89"><a href="#BaseRegressor-89"><span class="linenos"> 89</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="BaseRegressor-90"><a href="#BaseRegressor-90"><span class="linenos"> 90</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="BaseRegressor-91"><a href="#BaseRegressor-91"><span class="linenos"> 91</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="BaseRegressor-92"><a href="#BaseRegressor-92"><span class="linenos"> 92</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="BaseRegressor-93"><a href="#BaseRegressor-93"><span class="linenos"> 93</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="BaseRegressor-94"><a href="#BaseRegressor-94"><span class="linenos"> 94</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="BaseRegressor-95"><a href="#BaseRegressor-95"><span class="linenos"> 95</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="BaseRegressor-96"><a href="#BaseRegressor-96"><span class="linenos"> 96</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="BaseRegressor-97"><a href="#BaseRegressor-97"><span class="linenos"> 97</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="BaseRegressor-98"><a href="#BaseRegressor-98"><span class="linenos"> 98</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="BaseRegressor-99"><a href="#BaseRegressor-99"><span class="linenos"> 99</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="BaseRegressor-100"><a href="#BaseRegressor-100"><span class="linenos">100</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="BaseRegressor-101"><a href="#BaseRegressor-101"><span class="linenos">101</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="BaseRegressor-102"><a href="#BaseRegressor-102"><span class="linenos">102</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="BaseRegressor-103"><a href="#BaseRegressor-103"><span class="linenos">103</span></a>    <span class="p">):</span>
</span><span id="BaseRegressor-104"><a href="#BaseRegressor-104"><span class="linenos">104</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="BaseRegressor-105"><a href="#BaseRegressor-105"><span class="linenos">105</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="BaseRegressor-106"><a href="#BaseRegressor-106"><span class="linenos">106</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="BaseRegressor-107"><a href="#BaseRegressor-107"><span class="linenos">107</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="BaseRegressor-108"><a href="#BaseRegressor-108"><span class="linenos">108</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="BaseRegressor-109"><a href="#BaseRegressor-109"><span class="linenos">109</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="BaseRegressor-110"><a href="#BaseRegressor-110"><span class="linenos">110</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="BaseRegressor-111"><a href="#BaseRegressor-111"><span class="linenos">111</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="BaseRegressor-112"><a href="#BaseRegressor-112"><span class="linenos">112</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="BaseRegressor-113"><a href="#BaseRegressor-113"><span class="linenos">113</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="BaseRegressor-114"><a href="#BaseRegressor-114"><span class="linenos">114</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="BaseRegressor-115"><a href="#BaseRegressor-115"><span class="linenos">115</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="BaseRegressor-116"><a href="#BaseRegressor-116"><span class="linenos">116</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="BaseRegressor-117"><a href="#BaseRegressor-117"><span class="linenos">117</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="BaseRegressor-118"><a href="#BaseRegressor-118"><span class="linenos">118</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="BaseRegressor-119"><a href="#BaseRegressor-119"><span class="linenos">119</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BaseRegressor-120"><a href="#BaseRegressor-120"><span class="linenos">120</span></a>        <span class="p">)</span>
</span><span id="BaseRegressor-121"><a href="#BaseRegressor-121"><span class="linenos">121</span></a>
</span><span id="BaseRegressor-122"><a href="#BaseRegressor-122"><span class="linenos">122</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BaseRegressor-123"><a href="#BaseRegressor-123"><span class="linenos">123</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit BaseRegressor to training data (X, y)</span>
</span><span id="BaseRegressor-124"><a href="#BaseRegressor-124"><span class="linenos">124</span></a>
</span><span id="BaseRegressor-125"><a href="#BaseRegressor-125"><span class="linenos">125</span></a><span class="sd">        Parameters:</span>
</span><span id="BaseRegressor-126"><a href="#BaseRegressor-126"><span class="linenos">126</span></a>
</span><span id="BaseRegressor-127"><a href="#BaseRegressor-127"><span class="linenos">127</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="BaseRegressor-128"><a href="#BaseRegressor-128"><span class="linenos">128</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="BaseRegressor-129"><a href="#BaseRegressor-129"><span class="linenos">129</span></a><span class="sd">                of samples and n_features is the number of features</span>
</span><span id="BaseRegressor-130"><a href="#BaseRegressor-130"><span class="linenos">130</span></a>
</span><span id="BaseRegressor-131"><a href="#BaseRegressor-131"><span class="linenos">131</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="BaseRegressor-132"><a href="#BaseRegressor-132"><span class="linenos">132</span></a><span class="sd">                Target values</span>
</span><span id="BaseRegressor-133"><a href="#BaseRegressor-133"><span class="linenos">133</span></a>
</span><span id="BaseRegressor-134"><a href="#BaseRegressor-134"><span class="linenos">134</span></a><span class="sd">            **kwargs: additional parameters to be passed to self.cook_training_set</span>
</span><span id="BaseRegressor-135"><a href="#BaseRegressor-135"><span class="linenos">135</span></a>
</span><span id="BaseRegressor-136"><a href="#BaseRegressor-136"><span class="linenos">136</span></a><span class="sd">        Returns:</span>
</span><span id="BaseRegressor-137"><a href="#BaseRegressor-137"><span class="linenos">137</span></a>
</span><span id="BaseRegressor-138"><a href="#BaseRegressor-138"><span class="linenos">138</span></a><span class="sd">            self: object</span>
</span><span id="BaseRegressor-139"><a href="#BaseRegressor-139"><span class="linenos">139</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseRegressor-140"><a href="#BaseRegressor-140"><span class="linenos">140</span></a>
</span><span id="BaseRegressor-141"><a href="#BaseRegressor-141"><span class="linenos">141</span></a>        <span class="n">centered_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BaseRegressor-142"><a href="#BaseRegressor-142"><span class="linenos">142</span></a>
</span><span id="BaseRegressor-143"><a href="#BaseRegressor-143"><span class="linenos">143</span></a>        <span class="n">fit_obj</span> <span class="o">=</span> <span class="n">lmf</span><span class="o">.</span><span class="n">beta_Sigma_hat</span><span class="p">(</span>
</span><span id="BaseRegressor-144"><a href="#BaseRegressor-144"><span class="linenos">144</span></a>            <span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">centered_y</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span>
</span><span id="BaseRegressor-145"><a href="#BaseRegressor-145"><span class="linenos">145</span></a>        <span class="p">)</span>
</span><span id="BaseRegressor-146"><a href="#BaseRegressor-146"><span class="linenos">146</span></a>
</span><span id="BaseRegressor-147"><a href="#BaseRegressor-147"><span class="linenos">147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="p">[</span><span class="s2">&quot;beta_hat&quot;</span><span class="p">]</span>
</span><span id="BaseRegressor-148"><a href="#BaseRegressor-148"><span class="linenos">148</span></a>
</span><span id="BaseRegressor-149"><a href="#BaseRegressor-149"><span class="linenos">149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">GCV_</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="p">[</span><span class="s2">&quot;GCV&quot;</span><span class="p">]</span>
</span><span id="BaseRegressor-150"><a href="#BaseRegressor-150"><span class="linenos">150</span></a>
</span><span id="BaseRegressor-151"><a href="#BaseRegressor-151"><span class="linenos">151</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="BaseRegressor-152"><a href="#BaseRegressor-152"><span class="linenos">152</span></a>
</span><span id="BaseRegressor-153"><a href="#BaseRegressor-153"><span class="linenos">153</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BaseRegressor-154"><a href="#BaseRegressor-154"><span class="linenos">154</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="BaseRegressor-155"><a href="#BaseRegressor-155"><span class="linenos">155</span></a>
</span><span id="BaseRegressor-156"><a href="#BaseRegressor-156"><span class="linenos">156</span></a><span class="sd">        Parameters:</span>
</span><span id="BaseRegressor-157"><a href="#BaseRegressor-157"><span class="linenos">157</span></a>
</span><span id="BaseRegressor-158"><a href="#BaseRegressor-158"><span class="linenos">158</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="BaseRegressor-159"><a href="#BaseRegressor-159"><span class="linenos">159</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="BaseRegressor-160"><a href="#BaseRegressor-160"><span class="linenos">160</span></a><span class="sd">                of samples and n_features is the number of features</span>
</span><span id="BaseRegressor-161"><a href="#BaseRegressor-161"><span class="linenos">161</span></a>
</span><span id="BaseRegressor-162"><a href="#BaseRegressor-162"><span class="linenos">162</span></a><span class="sd">            **kwargs: additional parameters to be passed to self.cook_test_set</span>
</span><span id="BaseRegressor-163"><a href="#BaseRegressor-163"><span class="linenos">163</span></a>
</span><span id="BaseRegressor-164"><a href="#BaseRegressor-164"><span class="linenos">164</span></a><span class="sd">        Returns:</span>
</span><span id="BaseRegressor-165"><a href="#BaseRegressor-165"><span class="linenos">165</span></a>
</span><span id="BaseRegressor-166"><a href="#BaseRegressor-166"><span class="linenos">166</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="BaseRegressor-167"><a href="#BaseRegressor-167"><span class="linenos">167</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseRegressor-168"><a href="#BaseRegressor-168"><span class="linenos">168</span></a>
</span><span id="BaseRegressor-169"><a href="#BaseRegressor-169"><span class="linenos">169</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BaseRegressor-170"><a href="#BaseRegressor-170"><span class="linenos">170</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="BaseRegressor-171"><a href="#BaseRegressor-171"><span class="linenos">171</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="BaseRegressor-172"><a href="#BaseRegressor-172"><span class="linenos">172</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="BaseRegressor-173"><a href="#BaseRegressor-173"><span class="linenos">173</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="BaseRegressor-174"><a href="#BaseRegressor-174"><span class="linenos">174</span></a>            <span class="p">)</span>
</span><span id="BaseRegressor-175"><a href="#BaseRegressor-175"><span class="linenos">175</span></a>
</span><span id="BaseRegressor-176"><a href="#BaseRegressor-176"><span class="linenos">176</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="BaseRegressor-177"><a href="#BaseRegressor-177"><span class="linenos">177</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span>
</span><span id="BaseRegressor-178"><a href="#BaseRegressor-178"><span class="linenos">178</span></a>                <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="BaseRegressor-179"><a href="#BaseRegressor-179"><span class="linenos">179</span></a>                    <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="BaseRegressor-180"><a href="#BaseRegressor-180"><span class="linenos">180</span></a>                    <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BaseRegressor-181"><a href="#BaseRegressor-181"><span class="linenos">181</span></a>                    <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BaseRegressor-182"><a href="#BaseRegressor-182"><span class="linenos">182</span></a>                <span class="p">)</span>
</span><span id="BaseRegressor-183"><a href="#BaseRegressor-183"><span class="linenos">183</span></a>            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="BaseRegressor-184"><a href="#BaseRegressor-184"><span class="linenos">184</span></a>
</span><span id="BaseRegressor-185"><a href="#BaseRegressor-185"><span class="linenos">185</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="BaseRegressor-186"><a href="#BaseRegressor-186"><span class="linenos">186</span></a>            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="BaseRegressor-187"><a href="#BaseRegressor-187"><span class="linenos">187</span></a>            <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BaseRegressor-188"><a href="#BaseRegressor-188"><span class="linenos">188</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BaseRegressor-189"><a href="#BaseRegressor-189"><span class="linenos">189</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Random Vector Functional Link Network regression without shrinkage</p>

<p>Parameters:</p>

<pre><code>n_hidden_features: int
    number of nodes in the hidden layer

activation_name: str
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'

a: float
    hyperparameter for 'prelu' or 'elu' activation function

nodes_sim: str
    type of simulation for hidden layer nodes: 'sobol', 'hammersley', 'halton',
    'uniform'

bias: boolean
    indicates if the hidden layer contains a bias term (True) or
    not (False)

dropout: float
    regularization parameter; (random) percentage of nodes dropped out
    of the training

direct_link: boolean
    indicates if the original features are included (True) in model's
    fitting or not (False)

n_clusters: int
    number of clusters for type_clust='kmeans' or type_clust='gmm'
    clustering (could be 0: no clustering)

cluster_encode: bool
    defines how the variable containing clusters is treated (default is one-hot);
    if `False`, then labels are used, without one-hot encoding

type_clust: str
    type of clustering method: currently k-means ('kmeans') or Gaussian
    Mixture Model ('gmm')

type_scaling: a tuple of 3 strings
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax')

col_sample: float
    percentage of features randomly chosen for training

row_sample: float
    percentage of rows chosen for training, by stratified bootstrapping

seed: int
    reproducibility seed for nodes_sim=='uniform', clustering and dropout

backend: str
    "cpu" or "gpu" or "tpu"
</code></pre>

<p>Attributes:</p>

<pre><code>beta_: vector
    regression coefficients

GCV_: float
    Generalized Cross-Validation error
</code></pre>
</div>


                                <div id="BaseRegressor.fit" class="classattr">
                                            <input id="BaseRegressor.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BaseRegressor.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaseRegressor.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseRegressor.fit-122"><a href="#BaseRegressor.fit-122"><span class="linenos">122</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BaseRegressor.fit-123"><a href="#BaseRegressor.fit-123"><span class="linenos">123</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit BaseRegressor to training data (X, y)</span>
</span><span id="BaseRegressor.fit-124"><a href="#BaseRegressor.fit-124"><span class="linenos">124</span></a>
</span><span id="BaseRegressor.fit-125"><a href="#BaseRegressor.fit-125"><span class="linenos">125</span></a><span class="sd">        Parameters:</span>
</span><span id="BaseRegressor.fit-126"><a href="#BaseRegressor.fit-126"><span class="linenos">126</span></a>
</span><span id="BaseRegressor.fit-127"><a href="#BaseRegressor.fit-127"><span class="linenos">127</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="BaseRegressor.fit-128"><a href="#BaseRegressor.fit-128"><span class="linenos">128</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="BaseRegressor.fit-129"><a href="#BaseRegressor.fit-129"><span class="linenos">129</span></a><span class="sd">                of samples and n_features is the number of features</span>
</span><span id="BaseRegressor.fit-130"><a href="#BaseRegressor.fit-130"><span class="linenos">130</span></a>
</span><span id="BaseRegressor.fit-131"><a href="#BaseRegressor.fit-131"><span class="linenos">131</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="BaseRegressor.fit-132"><a href="#BaseRegressor.fit-132"><span class="linenos">132</span></a><span class="sd">                Target values</span>
</span><span id="BaseRegressor.fit-133"><a href="#BaseRegressor.fit-133"><span class="linenos">133</span></a>
</span><span id="BaseRegressor.fit-134"><a href="#BaseRegressor.fit-134"><span class="linenos">134</span></a><span class="sd">            **kwargs: additional parameters to be passed to self.cook_training_set</span>
</span><span id="BaseRegressor.fit-135"><a href="#BaseRegressor.fit-135"><span class="linenos">135</span></a>
</span><span id="BaseRegressor.fit-136"><a href="#BaseRegressor.fit-136"><span class="linenos">136</span></a><span class="sd">        Returns:</span>
</span><span id="BaseRegressor.fit-137"><a href="#BaseRegressor.fit-137"><span class="linenos">137</span></a>
</span><span id="BaseRegressor.fit-138"><a href="#BaseRegressor.fit-138"><span class="linenos">138</span></a><span class="sd">            self: object</span>
</span><span id="BaseRegressor.fit-139"><a href="#BaseRegressor.fit-139"><span class="linenos">139</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseRegressor.fit-140"><a href="#BaseRegressor.fit-140"><span class="linenos">140</span></a>
</span><span id="BaseRegressor.fit-141"><a href="#BaseRegressor.fit-141"><span class="linenos">141</span></a>        <span class="n">centered_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BaseRegressor.fit-142"><a href="#BaseRegressor.fit-142"><span class="linenos">142</span></a>
</span><span id="BaseRegressor.fit-143"><a href="#BaseRegressor.fit-143"><span class="linenos">143</span></a>        <span class="n">fit_obj</span> <span class="o">=</span> <span class="n">lmf</span><span class="o">.</span><span class="n">beta_Sigma_hat</span><span class="p">(</span>
</span><span id="BaseRegressor.fit-144"><a href="#BaseRegressor.fit-144"><span class="linenos">144</span></a>            <span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">centered_y</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span>
</span><span id="BaseRegressor.fit-145"><a href="#BaseRegressor.fit-145"><span class="linenos">145</span></a>        <span class="p">)</span>
</span><span id="BaseRegressor.fit-146"><a href="#BaseRegressor.fit-146"><span class="linenos">146</span></a>
</span><span id="BaseRegressor.fit-147"><a href="#BaseRegressor.fit-147"><span class="linenos">147</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="p">[</span><span class="s2">&quot;beta_hat&quot;</span><span class="p">]</span>
</span><span id="BaseRegressor.fit-148"><a href="#BaseRegressor.fit-148"><span class="linenos">148</span></a>
</span><span id="BaseRegressor.fit-149"><a href="#BaseRegressor.fit-149"><span class="linenos">149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">GCV_</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="p">[</span><span class="s2">&quot;GCV&quot;</span><span class="p">]</span>
</span><span id="BaseRegressor.fit-150"><a href="#BaseRegressor.fit-150"><span class="linenos">150</span></a>
</span><span id="BaseRegressor.fit-151"><a href="#BaseRegressor.fit-151"><span class="linenos">151</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit BaseRegressor to training data (X, y)</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features

y: array-like, shape = [n_samples]
    Target values

**kwargs: additional parameters to be passed to self.cook_training_set
</code></pre>

<p>Returns:</p>

<pre><code>self: object
</code></pre>
</div>


                                </div>
                                <div id="BaseRegressor.predict" class="classattr">
                                            <input id="BaseRegressor.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BaseRegressor.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaseRegressor.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseRegressor.predict-153"><a href="#BaseRegressor.predict-153"><span class="linenos">153</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BaseRegressor.predict-154"><a href="#BaseRegressor.predict-154"><span class="linenos">154</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="BaseRegressor.predict-155"><a href="#BaseRegressor.predict-155"><span class="linenos">155</span></a>
</span><span id="BaseRegressor.predict-156"><a href="#BaseRegressor.predict-156"><span class="linenos">156</span></a><span class="sd">        Parameters:</span>
</span><span id="BaseRegressor.predict-157"><a href="#BaseRegressor.predict-157"><span class="linenos">157</span></a>
</span><span id="BaseRegressor.predict-158"><a href="#BaseRegressor.predict-158"><span class="linenos">158</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="BaseRegressor.predict-159"><a href="#BaseRegressor.predict-159"><span class="linenos">159</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="BaseRegressor.predict-160"><a href="#BaseRegressor.predict-160"><span class="linenos">160</span></a><span class="sd">                of samples and n_features is the number of features</span>
</span><span id="BaseRegressor.predict-161"><a href="#BaseRegressor.predict-161"><span class="linenos">161</span></a>
</span><span id="BaseRegressor.predict-162"><a href="#BaseRegressor.predict-162"><span class="linenos">162</span></a><span class="sd">            **kwargs: additional parameters to be passed to self.cook_test_set</span>
</span><span id="BaseRegressor.predict-163"><a href="#BaseRegressor.predict-163"><span class="linenos">163</span></a>
</span><span id="BaseRegressor.predict-164"><a href="#BaseRegressor.predict-164"><span class="linenos">164</span></a><span class="sd">        Returns:</span>
</span><span id="BaseRegressor.predict-165"><a href="#BaseRegressor.predict-165"><span class="linenos">165</span></a>
</span><span id="BaseRegressor.predict-166"><a href="#BaseRegressor.predict-166"><span class="linenos">166</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="BaseRegressor.predict-167"><a href="#BaseRegressor.predict-167"><span class="linenos">167</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseRegressor.predict-168"><a href="#BaseRegressor.predict-168"><span class="linenos">168</span></a>
</span><span id="BaseRegressor.predict-169"><a href="#BaseRegressor.predict-169"><span class="linenos">169</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BaseRegressor.predict-170"><a href="#BaseRegressor.predict-170"><span class="linenos">170</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="BaseRegressor.predict-171"><a href="#BaseRegressor.predict-171"><span class="linenos">171</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="BaseRegressor.predict-172"><a href="#BaseRegressor.predict-172"><span class="linenos">172</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="BaseRegressor.predict-173"><a href="#BaseRegressor.predict-173"><span class="linenos">173</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="BaseRegressor.predict-174"><a href="#BaseRegressor.predict-174"><span class="linenos">174</span></a>            <span class="p">)</span>
</span><span id="BaseRegressor.predict-175"><a href="#BaseRegressor.predict-175"><span class="linenos">175</span></a>
</span><span id="BaseRegressor.predict-176"><a href="#BaseRegressor.predict-176"><span class="linenos">176</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="BaseRegressor.predict-177"><a href="#BaseRegressor.predict-177"><span class="linenos">177</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span>
</span><span id="BaseRegressor.predict-178"><a href="#BaseRegressor.predict-178"><span class="linenos">178</span></a>                <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="BaseRegressor.predict-179"><a href="#BaseRegressor.predict-179"><span class="linenos">179</span></a>                    <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="BaseRegressor.predict-180"><a href="#BaseRegressor.predict-180"><span class="linenos">180</span></a>                    <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BaseRegressor.predict-181"><a href="#BaseRegressor.predict-181"><span class="linenos">181</span></a>                    <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BaseRegressor.predict-182"><a href="#BaseRegressor.predict-182"><span class="linenos">182</span></a>                <span class="p">)</span>
</span><span id="BaseRegressor.predict-183"><a href="#BaseRegressor.predict-183"><span class="linenos">183</span></a>            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="BaseRegressor.predict-184"><a href="#BaseRegressor.predict-184"><span class="linenos">184</span></a>
</span><span id="BaseRegressor.predict-185"><a href="#BaseRegressor.predict-185"><span class="linenos">185</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="BaseRegressor.predict-186"><a href="#BaseRegressor.predict-186"><span class="linenos">186</span></a>            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="BaseRegressor.predict-187"><a href="#BaseRegressor.predict-187"><span class="linenos">187</span></a>            <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BaseRegressor.predict-188"><a href="#BaseRegressor.predict-188"><span class="linenos">188</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BaseRegressor.predict-189"><a href="#BaseRegressor.predict-189"><span class="linenos">189</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict test data X.</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features

**kwargs: additional parameters to be passed to self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>model predictions: {array-like}
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="BayesianRVFLRegressor">
                            <input id="BayesianRVFLRegressor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">BayesianRVFLRegressor</span><wbr>(<span class="base"><a href="#Base">nnetsauce.Base</a></span>, <span class="base">sklearn.base.RegressorMixin</span>):

                <label class="view-source-button" for="BayesianRVFLRegressor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BayesianRVFLRegressor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BayesianRVFLRegressor-15"><a href="#BayesianRVFLRegressor-15"><span class="linenos"> 15</span></a><span class="k">class</span> <span class="nc">BayesianRVFLRegressor</span><span class="p">(</span><span class="n">Base</span><span class="p">,</span> <span class="n">RegressorMixin</span><span class="p">):</span>
</span><span id="BayesianRVFLRegressor-16"><a href="#BayesianRVFLRegressor-16"><span class="linenos"> 16</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Bayesian Random Vector Functional Link Network regression with one prior</span>
</span><span id="BayesianRVFLRegressor-17"><a href="#BayesianRVFLRegressor-17"><span class="linenos"> 17</span></a>
</span><span id="BayesianRVFLRegressor-18"><a href="#BayesianRVFLRegressor-18"><span class="linenos"> 18</span></a><span class="sd">    Parameters:</span>
</span><span id="BayesianRVFLRegressor-19"><a href="#BayesianRVFLRegressor-19"><span class="linenos"> 19</span></a>
</span><span id="BayesianRVFLRegressor-20"><a href="#BayesianRVFLRegressor-20"><span class="linenos"> 20</span></a><span class="sd">        n_hidden_features: int</span>
</span><span id="BayesianRVFLRegressor-21"><a href="#BayesianRVFLRegressor-21"><span class="linenos"> 21</span></a><span class="sd">            number of nodes in the hidden layer</span>
</span><span id="BayesianRVFLRegressor-22"><a href="#BayesianRVFLRegressor-22"><span class="linenos"> 22</span></a>
</span><span id="BayesianRVFLRegressor-23"><a href="#BayesianRVFLRegressor-23"><span class="linenos"> 23</span></a><span class="sd">        activation_name: str</span>
</span><span id="BayesianRVFLRegressor-24"><a href="#BayesianRVFLRegressor-24"><span class="linenos"> 24</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;</span>
</span><span id="BayesianRVFLRegressor-25"><a href="#BayesianRVFLRegressor-25"><span class="linenos"> 25</span></a>
</span><span id="BayesianRVFLRegressor-26"><a href="#BayesianRVFLRegressor-26"><span class="linenos"> 26</span></a><span class="sd">        a: float</span>
</span><span id="BayesianRVFLRegressor-27"><a href="#BayesianRVFLRegressor-27"><span class="linenos"> 27</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function</span>
</span><span id="BayesianRVFLRegressor-28"><a href="#BayesianRVFLRegressor-28"><span class="linenos"> 28</span></a>
</span><span id="BayesianRVFLRegressor-29"><a href="#BayesianRVFLRegressor-29"><span class="linenos"> 29</span></a><span class="sd">        nodes_sim: str</span>
</span><span id="BayesianRVFLRegressor-30"><a href="#BayesianRVFLRegressor-30"><span class="linenos"> 30</span></a><span class="sd">            type of simulation for the nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;, &#39;uniform&#39;</span>
</span><span id="BayesianRVFLRegressor-31"><a href="#BayesianRVFLRegressor-31"><span class="linenos"> 31</span></a>
</span><span id="BayesianRVFLRegressor-32"><a href="#BayesianRVFLRegressor-32"><span class="linenos"> 32</span></a><span class="sd">        bias: boolean</span>
</span><span id="BayesianRVFLRegressor-33"><a href="#BayesianRVFLRegressor-33"><span class="linenos"> 33</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or not (False)</span>
</span><span id="BayesianRVFLRegressor-34"><a href="#BayesianRVFLRegressor-34"><span class="linenos"> 34</span></a>
</span><span id="BayesianRVFLRegressor-35"><a href="#BayesianRVFLRegressor-35"><span class="linenos"> 35</span></a><span class="sd">        dropout: float</span>
</span><span id="BayesianRVFLRegressor-36"><a href="#BayesianRVFLRegressor-36"><span class="linenos"> 36</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="BayesianRVFLRegressor-37"><a href="#BayesianRVFLRegressor-37"><span class="linenos"> 37</span></a><span class="sd">            of the training</span>
</span><span id="BayesianRVFLRegressor-38"><a href="#BayesianRVFLRegressor-38"><span class="linenos"> 38</span></a>
</span><span id="BayesianRVFLRegressor-39"><a href="#BayesianRVFLRegressor-39"><span class="linenos"> 39</span></a><span class="sd">        direct_link: boolean</span>
</span><span id="BayesianRVFLRegressor-40"><a href="#BayesianRVFLRegressor-40"><span class="linenos"> 40</span></a><span class="sd">            indicates if the original features are included (True) in model&#39;&#39;s fitting or not (False)</span>
</span><span id="BayesianRVFLRegressor-41"><a href="#BayesianRVFLRegressor-41"><span class="linenos"> 41</span></a>
</span><span id="BayesianRVFLRegressor-42"><a href="#BayesianRVFLRegressor-42"><span class="linenos"> 42</span></a><span class="sd">        n_clusters: int</span>
</span><span id="BayesianRVFLRegressor-43"><a href="#BayesianRVFLRegressor-43"><span class="linenos"> 43</span></a><span class="sd">            number of clusters for &#39;kmeans&#39; or &#39;gmm&#39; clustering (could be 0: no clustering)</span>
</span><span id="BayesianRVFLRegressor-44"><a href="#BayesianRVFLRegressor-44"><span class="linenos"> 44</span></a>
</span><span id="BayesianRVFLRegressor-45"><a href="#BayesianRVFLRegressor-45"><span class="linenos"> 45</span></a><span class="sd">        cluster_encode: bool</span>
</span><span id="BayesianRVFLRegressor-46"><a href="#BayesianRVFLRegressor-46"><span class="linenos"> 46</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot)</span>
</span><span id="BayesianRVFLRegressor-47"><a href="#BayesianRVFLRegressor-47"><span class="linenos"> 47</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding</span>
</span><span id="BayesianRVFLRegressor-48"><a href="#BayesianRVFLRegressor-48"><span class="linenos"> 48</span></a>
</span><span id="BayesianRVFLRegressor-49"><a href="#BayesianRVFLRegressor-49"><span class="linenos"> 49</span></a><span class="sd">        type_clust: str</span>
</span><span id="BayesianRVFLRegressor-50"><a href="#BayesianRVFLRegressor-50"><span class="linenos"> 50</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian Mixture Model (&#39;gmm&#39;)</span>
</span><span id="BayesianRVFLRegressor-51"><a href="#BayesianRVFLRegressor-51"><span class="linenos"> 51</span></a>
</span><span id="BayesianRVFLRegressor-52"><a href="#BayesianRVFLRegressor-52"><span class="linenos"> 52</span></a><span class="sd">        type_scaling: a tuple of 3 strings</span>
</span><span id="BayesianRVFLRegressor-53"><a href="#BayesianRVFLRegressor-53"><span class="linenos"> 53</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="BayesianRVFLRegressor-54"><a href="#BayesianRVFLRegressor-54"><span class="linenos"> 54</span></a><span class="sd">            (and when relevant).</span>
</span><span id="BayesianRVFLRegressor-55"><a href="#BayesianRVFLRegressor-55"><span class="linenos"> 55</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;)</span>
</span><span id="BayesianRVFLRegressor-56"><a href="#BayesianRVFLRegressor-56"><span class="linenos"> 56</span></a>
</span><span id="BayesianRVFLRegressor-57"><a href="#BayesianRVFLRegressor-57"><span class="linenos"> 57</span></a><span class="sd">        seed: int</span>
</span><span id="BayesianRVFLRegressor-58"><a href="#BayesianRVFLRegressor-58"><span class="linenos"> 58</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39;</span>
</span><span id="BayesianRVFLRegressor-59"><a href="#BayesianRVFLRegressor-59"><span class="linenos"> 59</span></a>
</span><span id="BayesianRVFLRegressor-60"><a href="#BayesianRVFLRegressor-60"><span class="linenos"> 60</span></a><span class="sd">        s: float</span>
</span><span id="BayesianRVFLRegressor-61"><a href="#BayesianRVFLRegressor-61"><span class="linenos"> 61</span></a><span class="sd">            std. dev. of regression parameters in Bayesian Ridge Regression</span>
</span><span id="BayesianRVFLRegressor-62"><a href="#BayesianRVFLRegressor-62"><span class="linenos"> 62</span></a>
</span><span id="BayesianRVFLRegressor-63"><a href="#BayesianRVFLRegressor-63"><span class="linenos"> 63</span></a><span class="sd">        sigma: float</span>
</span><span id="BayesianRVFLRegressor-64"><a href="#BayesianRVFLRegressor-64"><span class="linenos"> 64</span></a><span class="sd">            std. dev. of residuals in Bayesian Ridge Regression</span>
</span><span id="BayesianRVFLRegressor-65"><a href="#BayesianRVFLRegressor-65"><span class="linenos"> 65</span></a>
</span><span id="BayesianRVFLRegressor-66"><a href="#BayesianRVFLRegressor-66"><span class="linenos"> 66</span></a><span class="sd">        return_std: boolean</span>
</span><span id="BayesianRVFLRegressor-67"><a href="#BayesianRVFLRegressor-67"><span class="linenos"> 67</span></a><span class="sd">            if True, uncertainty around predictions is evaluated</span>
</span><span id="BayesianRVFLRegressor-68"><a href="#BayesianRVFLRegressor-68"><span class="linenos"> 68</span></a>
</span><span id="BayesianRVFLRegressor-69"><a href="#BayesianRVFLRegressor-69"><span class="linenos"> 69</span></a><span class="sd">        backend: str</span>
</span><span id="BayesianRVFLRegressor-70"><a href="#BayesianRVFLRegressor-70"><span class="linenos"> 70</span></a><span class="sd">            &quot;cpu&quot; or &quot;gpu&quot; or &quot;tpu&quot;</span>
</span><span id="BayesianRVFLRegressor-71"><a href="#BayesianRVFLRegressor-71"><span class="linenos"> 71</span></a>
</span><span id="BayesianRVFLRegressor-72"><a href="#BayesianRVFLRegressor-72"><span class="linenos"> 72</span></a><span class="sd">    Attributes:</span>
</span><span id="BayesianRVFLRegressor-73"><a href="#BayesianRVFLRegressor-73"><span class="linenos"> 73</span></a>
</span><span id="BayesianRVFLRegressor-74"><a href="#BayesianRVFLRegressor-74"><span class="linenos"> 74</span></a><span class="sd">        beta_: array-like</span>
</span><span id="BayesianRVFLRegressor-75"><a href="#BayesianRVFLRegressor-75"><span class="linenos"> 75</span></a><span class="sd">            regression&#39;&#39;s coefficients</span>
</span><span id="BayesianRVFLRegressor-76"><a href="#BayesianRVFLRegressor-76"><span class="linenos"> 76</span></a>
</span><span id="BayesianRVFLRegressor-77"><a href="#BayesianRVFLRegressor-77"><span class="linenos"> 77</span></a><span class="sd">        Sigma_: array-like</span>
</span><span id="BayesianRVFLRegressor-78"><a href="#BayesianRVFLRegressor-78"><span class="linenos"> 78</span></a><span class="sd">            covariance of the distribution of fitted parameters</span>
</span><span id="BayesianRVFLRegressor-79"><a href="#BayesianRVFLRegressor-79"><span class="linenos"> 79</span></a>
</span><span id="BayesianRVFLRegressor-80"><a href="#BayesianRVFLRegressor-80"><span class="linenos"> 80</span></a><span class="sd">        GCV_: float</span>
</span><span id="BayesianRVFLRegressor-81"><a href="#BayesianRVFLRegressor-81"><span class="linenos"> 81</span></a><span class="sd">            Generalized cross-validation error</span>
</span><span id="BayesianRVFLRegressor-82"><a href="#BayesianRVFLRegressor-82"><span class="linenos"> 82</span></a>
</span><span id="BayesianRVFLRegressor-83"><a href="#BayesianRVFLRegressor-83"><span class="linenos"> 83</span></a><span class="sd">        y_mean_: float</span>
</span><span id="BayesianRVFLRegressor-84"><a href="#BayesianRVFLRegressor-84"><span class="linenos"> 84</span></a><span class="sd">            average response</span>
</span><span id="BayesianRVFLRegressor-85"><a href="#BayesianRVFLRegressor-85"><span class="linenos"> 85</span></a>
</span><span id="BayesianRVFLRegressor-86"><a href="#BayesianRVFLRegressor-86"><span class="linenos"> 86</span></a><span class="sd">    Examples:</span>
</span><span id="BayesianRVFLRegressor-87"><a href="#BayesianRVFLRegressor-87"><span class="linenos"> 87</span></a>
</span><span id="BayesianRVFLRegressor-88"><a href="#BayesianRVFLRegressor-88"><span class="linenos"> 88</span></a><span class="sd">    ```python</span>
</span><span id="BayesianRVFLRegressor-89"><a href="#BayesianRVFLRegressor-89"><span class="linenos"> 89</span></a><span class="sd">    TBD</span>
</span><span id="BayesianRVFLRegressor-90"><a href="#BayesianRVFLRegressor-90"><span class="linenos"> 90</span></a><span class="sd">    ```</span>
</span><span id="BayesianRVFLRegressor-91"><a href="#BayesianRVFLRegressor-91"><span class="linenos"> 91</span></a>
</span><span id="BayesianRVFLRegressor-92"><a href="#BayesianRVFLRegressor-92"><span class="linenos"> 92</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="BayesianRVFLRegressor-93"><a href="#BayesianRVFLRegressor-93"><span class="linenos"> 93</span></a>
</span><span id="BayesianRVFLRegressor-94"><a href="#BayesianRVFLRegressor-94"><span class="linenos"> 94</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="BayesianRVFLRegressor-95"><a href="#BayesianRVFLRegressor-95"><span class="linenos"> 95</span></a>
</span><span id="BayesianRVFLRegressor-96"><a href="#BayesianRVFLRegressor-96"><span class="linenos"> 96</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="BayesianRVFLRegressor-97"><a href="#BayesianRVFLRegressor-97"><span class="linenos"> 97</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-98"><a href="#BayesianRVFLRegressor-98"><span class="linenos"> 98</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-99"><a href="#BayesianRVFLRegressor-99"><span class="linenos"> 99</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-100"><a href="#BayesianRVFLRegressor-100"><span class="linenos">100</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-101"><a href="#BayesianRVFLRegressor-101"><span class="linenos">101</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-102"><a href="#BayesianRVFLRegressor-102"><span class="linenos">102</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-103"><a href="#BayesianRVFLRegressor-103"><span class="linenos">103</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-104"><a href="#BayesianRVFLRegressor-104"><span class="linenos">104</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-105"><a href="#BayesianRVFLRegressor-105"><span class="linenos">105</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-106"><a href="#BayesianRVFLRegressor-106"><span class="linenos">106</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-107"><a href="#BayesianRVFLRegressor-107"><span class="linenos">107</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-108"><a href="#BayesianRVFLRegressor-108"><span class="linenos">108</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="BayesianRVFLRegressor-109"><a href="#BayesianRVFLRegressor-109"><span class="linenos">109</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-110"><a href="#BayesianRVFLRegressor-110"><span class="linenos">110</span></a>        <span class="n">s</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-111"><a href="#BayesianRVFLRegressor-111"><span class="linenos">111</span></a>        <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-112"><a href="#BayesianRVFLRegressor-112"><span class="linenos">112</span></a>        <span class="n">return_std</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-113"><a href="#BayesianRVFLRegressor-113"><span class="linenos">113</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-114"><a href="#BayesianRVFLRegressor-114"><span class="linenos">114</span></a>    <span class="p">):</span>
</span><span id="BayesianRVFLRegressor-115"><a href="#BayesianRVFLRegressor-115"><span class="linenos">115</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="BayesianRVFLRegressor-116"><a href="#BayesianRVFLRegressor-116"><span class="linenos">116</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-117"><a href="#BayesianRVFLRegressor-117"><span class="linenos">117</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-118"><a href="#BayesianRVFLRegressor-118"><span class="linenos">118</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-119"><a href="#BayesianRVFLRegressor-119"><span class="linenos">119</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-120"><a href="#BayesianRVFLRegressor-120"><span class="linenos">120</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-121"><a href="#BayesianRVFLRegressor-121"><span class="linenos">121</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-122"><a href="#BayesianRVFLRegressor-122"><span class="linenos">122</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-123"><a href="#BayesianRVFLRegressor-123"><span class="linenos">123</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-124"><a href="#BayesianRVFLRegressor-124"><span class="linenos">124</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-125"><a href="#BayesianRVFLRegressor-125"><span class="linenos">125</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-126"><a href="#BayesianRVFLRegressor-126"><span class="linenos">126</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-127"><a href="#BayesianRVFLRegressor-127"><span class="linenos">127</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-128"><a href="#BayesianRVFLRegressor-128"><span class="linenos">128</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-129"><a href="#BayesianRVFLRegressor-129"><span class="linenos">129</span></a>        <span class="p">)</span>
</span><span id="BayesianRVFLRegressor-130"><a href="#BayesianRVFLRegressor-130"><span class="linenos">130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">s</span>
</span><span id="BayesianRVFLRegressor-131"><a href="#BayesianRVFLRegressor-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span>
</span><span id="BayesianRVFLRegressor-132"><a href="#BayesianRVFLRegressor-132"><span class="linenos">132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="BayesianRVFLRegressor-133"><a href="#BayesianRVFLRegressor-133"><span class="linenos">133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Sigma_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="BayesianRVFLRegressor-134"><a href="#BayesianRVFLRegressor-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">GCV_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="BayesianRVFLRegressor-135"><a href="#BayesianRVFLRegressor-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">=</span> <span class="n">return_std</span>
</span><span id="BayesianRVFLRegressor-136"><a href="#BayesianRVFLRegressor-136"><span class="linenos">136</span></a>
</span><span id="BayesianRVFLRegressor-137"><a href="#BayesianRVFLRegressor-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BayesianRVFLRegressor-138"><a href="#BayesianRVFLRegressor-138"><span class="linenos">138</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit BayesianRVFLRegressor to training data (X, y).</span>
</span><span id="BayesianRVFLRegressor-139"><a href="#BayesianRVFLRegressor-139"><span class="linenos">139</span></a>
</span><span id="BayesianRVFLRegressor-140"><a href="#BayesianRVFLRegressor-140"><span class="linenos">140</span></a><span class="sd">        Parameters:</span>
</span><span id="BayesianRVFLRegressor-141"><a href="#BayesianRVFLRegressor-141"><span class="linenos">141</span></a>
</span><span id="BayesianRVFLRegressor-142"><a href="#BayesianRVFLRegressor-142"><span class="linenos">142</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="BayesianRVFLRegressor-143"><a href="#BayesianRVFLRegressor-143"><span class="linenos">143</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="BayesianRVFLRegressor-144"><a href="#BayesianRVFLRegressor-144"><span class="linenos">144</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="BayesianRVFLRegressor-145"><a href="#BayesianRVFLRegressor-145"><span class="linenos">145</span></a>
</span><span id="BayesianRVFLRegressor-146"><a href="#BayesianRVFLRegressor-146"><span class="linenos">146</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="BayesianRVFLRegressor-147"><a href="#BayesianRVFLRegressor-147"><span class="linenos">147</span></a><span class="sd">                Target values.</span>
</span><span id="BayesianRVFLRegressor-148"><a href="#BayesianRVFLRegressor-148"><span class="linenos">148</span></a>
</span><span id="BayesianRVFLRegressor-149"><a href="#BayesianRVFLRegressor-149"><span class="linenos">149</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="BayesianRVFLRegressor-150"><a href="#BayesianRVFLRegressor-150"><span class="linenos">150</span></a><span class="sd">                    self.cook_training_set</span>
</span><span id="BayesianRVFLRegressor-151"><a href="#BayesianRVFLRegressor-151"><span class="linenos">151</span></a>
</span><span id="BayesianRVFLRegressor-152"><a href="#BayesianRVFLRegressor-152"><span class="linenos">152</span></a><span class="sd">        Returns:</span>
</span><span id="BayesianRVFLRegressor-153"><a href="#BayesianRVFLRegressor-153"><span class="linenos">153</span></a>
</span><span id="BayesianRVFLRegressor-154"><a href="#BayesianRVFLRegressor-154"><span class="linenos">154</span></a><span class="sd">            self: object</span>
</span><span id="BayesianRVFLRegressor-155"><a href="#BayesianRVFLRegressor-155"><span class="linenos">155</span></a>
</span><span id="BayesianRVFLRegressor-156"><a href="#BayesianRVFLRegressor-156"><span class="linenos">156</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BayesianRVFLRegressor-157"><a href="#BayesianRVFLRegressor-157"><span class="linenos">157</span></a>
</span><span id="BayesianRVFLRegressor-158"><a href="#BayesianRVFLRegressor-158"><span class="linenos">158</span></a>        <span class="n">centered_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BayesianRVFLRegressor-159"><a href="#BayesianRVFLRegressor-159"><span class="linenos">159</span></a>
</span><span id="BayesianRVFLRegressor-160"><a href="#BayesianRVFLRegressor-160"><span class="linenos">160</span></a>        <span class="n">fit_obj</span> <span class="o">=</span> <span class="n">lmf</span><span class="o">.</span><span class="n">beta_Sigma_hat_rvfl</span><span class="p">(</span>
</span><span id="BayesianRVFLRegressor-161"><a href="#BayesianRVFLRegressor-161"><span class="linenos">161</span></a>            <span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-162"><a href="#BayesianRVFLRegressor-162"><span class="linenos">162</span></a>            <span class="n">y</span><span class="o">=</span><span class="n">centered_y</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-163"><a href="#BayesianRVFLRegressor-163"><span class="linenos">163</span></a>            <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-164"><a href="#BayesianRVFLRegressor-164"><span class="linenos">164</span></a>            <span class="n">sigma</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-165"><a href="#BayesianRVFLRegressor-165"><span class="linenos">165</span></a>            <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-166"><a href="#BayesianRVFLRegressor-166"><span class="linenos">166</span></a>            <span class="n">return_cov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">return_std</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-167"><a href="#BayesianRVFLRegressor-167"><span class="linenos">167</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-168"><a href="#BayesianRVFLRegressor-168"><span class="linenos">168</span></a>        <span class="p">)</span>
</span><span id="BayesianRVFLRegressor-169"><a href="#BayesianRVFLRegressor-169"><span class="linenos">169</span></a>
</span><span id="BayesianRVFLRegressor-170"><a href="#BayesianRVFLRegressor-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="p">[</span><span class="s2">&quot;beta_hat&quot;</span><span class="p">]</span>
</span><span id="BayesianRVFLRegressor-171"><a href="#BayesianRVFLRegressor-171"><span class="linenos">171</span></a>
</span><span id="BayesianRVFLRegressor-172"><a href="#BayesianRVFLRegressor-172"><span class="linenos">172</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="BayesianRVFLRegressor-173"><a href="#BayesianRVFLRegressor-173"><span class="linenos">173</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">Sigma_</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="p">[</span><span class="s2">&quot;Sigma_hat&quot;</span><span class="p">]</span>
</span><span id="BayesianRVFLRegressor-174"><a href="#BayesianRVFLRegressor-174"><span class="linenos">174</span></a>
</span><span id="BayesianRVFLRegressor-175"><a href="#BayesianRVFLRegressor-175"><span class="linenos">175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">GCV_</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="p">[</span><span class="s2">&quot;GCV&quot;</span><span class="p">]</span>
</span><span id="BayesianRVFLRegressor-176"><a href="#BayesianRVFLRegressor-176"><span class="linenos">176</span></a>
</span><span id="BayesianRVFLRegressor-177"><a href="#BayesianRVFLRegressor-177"><span class="linenos">177</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="BayesianRVFLRegressor-178"><a href="#BayesianRVFLRegressor-178"><span class="linenos">178</span></a>
</span><span id="BayesianRVFLRegressor-179"><a href="#BayesianRVFLRegressor-179"><span class="linenos">179</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BayesianRVFLRegressor-180"><a href="#BayesianRVFLRegressor-180"><span class="linenos">180</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="BayesianRVFLRegressor-181"><a href="#BayesianRVFLRegressor-181"><span class="linenos">181</span></a>
</span><span id="BayesianRVFLRegressor-182"><a href="#BayesianRVFLRegressor-182"><span class="linenos">182</span></a><span class="sd">        Parameters:</span>
</span><span id="BayesianRVFLRegressor-183"><a href="#BayesianRVFLRegressor-183"><span class="linenos">183</span></a>
</span><span id="BayesianRVFLRegressor-184"><a href="#BayesianRVFLRegressor-184"><span class="linenos">184</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="BayesianRVFLRegressor-185"><a href="#BayesianRVFLRegressor-185"><span class="linenos">185</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="BayesianRVFLRegressor-186"><a href="#BayesianRVFLRegressor-186"><span class="linenos">186</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="BayesianRVFLRegressor-187"><a href="#BayesianRVFLRegressor-187"><span class="linenos">187</span></a>
</span><span id="BayesianRVFLRegressor-188"><a href="#BayesianRVFLRegressor-188"><span class="linenos">188</span></a><span class="sd">            return_std: {boolean}, standard dev. is returned or not</span>
</span><span id="BayesianRVFLRegressor-189"><a href="#BayesianRVFLRegressor-189"><span class="linenos">189</span></a>
</span><span id="BayesianRVFLRegressor-190"><a href="#BayesianRVFLRegressor-190"><span class="linenos">190</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="BayesianRVFLRegressor-191"><a href="#BayesianRVFLRegressor-191"><span class="linenos">191</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="BayesianRVFLRegressor-192"><a href="#BayesianRVFLRegressor-192"><span class="linenos">192</span></a>
</span><span id="BayesianRVFLRegressor-193"><a href="#BayesianRVFLRegressor-193"><span class="linenos">193</span></a><span class="sd">        Returns:</span>
</span><span id="BayesianRVFLRegressor-194"><a href="#BayesianRVFLRegressor-194"><span class="linenos">194</span></a>
</span><span id="BayesianRVFLRegressor-195"><a href="#BayesianRVFLRegressor-195"><span class="linenos">195</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="BayesianRVFLRegressor-196"><a href="#BayesianRVFLRegressor-196"><span class="linenos">196</span></a>
</span><span id="BayesianRVFLRegressor-197"><a href="#BayesianRVFLRegressor-197"><span class="linenos">197</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BayesianRVFLRegressor-198"><a href="#BayesianRVFLRegressor-198"><span class="linenos">198</span></a>
</span><span id="BayesianRVFLRegressor-199"><a href="#BayesianRVFLRegressor-199"><span class="linenos">199</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># one observation in the test set only</span>
</span><span id="BayesianRVFLRegressor-200"><a href="#BayesianRVFLRegressor-200"><span class="linenos">200</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="BayesianRVFLRegressor-201"><a href="#BayesianRVFLRegressor-201"><span class="linenos">201</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="BayesianRVFLRegressor-202"><a href="#BayesianRVFLRegressor-202"><span class="linenos">202</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="BayesianRVFLRegressor-203"><a href="#BayesianRVFLRegressor-203"><span class="linenos">203</span></a>                <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="BayesianRVFLRegressor-204"><a href="#BayesianRVFLRegressor-204"><span class="linenos">204</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-205"><a href="#BayesianRVFLRegressor-205"><span class="linenos">205</span></a>            <span class="p">)</span>
</span><span id="BayesianRVFLRegressor-206"><a href="#BayesianRVFLRegressor-206"><span class="linenos">206</span></a>
</span><span id="BayesianRVFLRegressor-207"><a href="#BayesianRVFLRegressor-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">=</span> <span class="n">return_std</span>
</span><span id="BayesianRVFLRegressor-208"><a href="#BayesianRVFLRegressor-208"><span class="linenos">208</span></a>
</span><span id="BayesianRVFLRegressor-209"><a href="#BayesianRVFLRegressor-209"><span class="linenos">209</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="BayesianRVFLRegressor-210"><a href="#BayesianRVFLRegressor-210"><span class="linenos">210</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BayesianRVFLRegressor-211"><a href="#BayesianRVFLRegressor-211"><span class="linenos">211</span></a>                <span class="k">return</span> <span class="p">(</span>
</span><span id="BayesianRVFLRegressor-212"><a href="#BayesianRVFLRegressor-212"><span class="linenos">212</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span>
</span><span id="BayesianRVFLRegressor-213"><a href="#BayesianRVFLRegressor-213"><span class="linenos">213</span></a>                    <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="BayesianRVFLRegressor-214"><a href="#BayesianRVFLRegressor-214"><span class="linenos">214</span></a>                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="BayesianRVFLRegressor-215"><a href="#BayesianRVFLRegressor-215"><span class="linenos">215</span></a>                        <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-216"><a href="#BayesianRVFLRegressor-216"><span class="linenos">216</span></a>                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-217"><a href="#BayesianRVFLRegressor-217"><span class="linenos">217</span></a>                    <span class="p">)</span>
</span><span id="BayesianRVFLRegressor-218"><a href="#BayesianRVFLRegressor-218"><span class="linenos">218</span></a>                <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="BayesianRVFLRegressor-219"><a href="#BayesianRVFLRegressor-219"><span class="linenos">219</span></a>
</span><span id="BayesianRVFLRegressor-220"><a href="#BayesianRVFLRegressor-220"><span class="linenos">220</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="BayesianRVFLRegressor-221"><a href="#BayesianRVFLRegressor-221"><span class="linenos">221</span></a>                <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="BayesianRVFLRegressor-222"><a href="#BayesianRVFLRegressor-222"><span class="linenos">222</span></a>                <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-223"><a href="#BayesianRVFLRegressor-223"><span class="linenos">223</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-224"><a href="#BayesianRVFLRegressor-224"><span class="linenos">224</span></a>            <span class="p">)</span>
</span><span id="BayesianRVFLRegressor-225"><a href="#BayesianRVFLRegressor-225"><span class="linenos">225</span></a>
</span><span id="BayesianRVFLRegressor-226"><a href="#BayesianRVFLRegressor-226"><span class="linenos">226</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># confidence interval required for preds?</span>
</span><span id="BayesianRVFLRegressor-227"><a href="#BayesianRVFLRegressor-227"><span class="linenos">227</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BayesianRVFLRegressor-228"><a href="#BayesianRVFLRegressor-228"><span class="linenos">228</span></a>                <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BayesianRVFLRegressor-229"><a href="#BayesianRVFLRegressor-229"><span class="linenos">229</span></a>
</span><span id="BayesianRVFLRegressor-230"><a href="#BayesianRVFLRegressor-230"><span class="linenos">230</span></a>                <span class="n">pred_obj</span> <span class="o">=</span> <span class="n">lmf</span><span class="o">.</span><span class="n">beta_Sigma_hat_rvfl</span><span class="p">(</span>
</span><span id="BayesianRVFLRegressor-231"><a href="#BayesianRVFLRegressor-231"><span class="linenos">231</span></a>                    <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-232"><a href="#BayesianRVFLRegressor-232"><span class="linenos">232</span></a>                    <span class="n">sigma</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-233"><a href="#BayesianRVFLRegressor-233"><span class="linenos">233</span></a>                    <span class="n">X_star</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-234"><a href="#BayesianRVFLRegressor-234"><span class="linenos">234</span></a>                    <span class="n">return_cov</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-235"><a href="#BayesianRVFLRegressor-235"><span class="linenos">235</span></a>                    <span class="n">beta_hat_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-236"><a href="#BayesianRVFLRegressor-236"><span class="linenos">236</span></a>                    <span class="n">Sigma_hat_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sigma_</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-237"><a href="#BayesianRVFLRegressor-237"><span class="linenos">237</span></a>                    <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-238"><a href="#BayesianRVFLRegressor-238"><span class="linenos">238</span></a>                <span class="p">)</span>
</span><span id="BayesianRVFLRegressor-239"><a href="#BayesianRVFLRegressor-239"><span class="linenos">239</span></a>
</span><span id="BayesianRVFLRegressor-240"><a href="#BayesianRVFLRegressor-240"><span class="linenos">240</span></a>                <span class="k">return</span> <span class="p">(</span>
</span><span id="BayesianRVFLRegressor-241"><a href="#BayesianRVFLRegressor-241"><span class="linenos">241</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">pred_obj</span><span class="p">[</span><span class="s2">&quot;preds&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="BayesianRVFLRegressor-242"><a href="#BayesianRVFLRegressor-242"><span class="linenos">242</span></a>                    <span class="n">pred_obj</span><span class="p">[</span><span class="s2">&quot;preds_std&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="BayesianRVFLRegressor-243"><a href="#BayesianRVFLRegressor-243"><span class="linenos">243</span></a>                <span class="p">)</span>
</span><span id="BayesianRVFLRegressor-244"><a href="#BayesianRVFLRegressor-244"><span class="linenos">244</span></a>
</span><span id="BayesianRVFLRegressor-245"><a href="#BayesianRVFLRegressor-245"><span class="linenos">245</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BayesianRVFLRegressor-246"><a href="#BayesianRVFLRegressor-246"><span class="linenos">246</span></a>
</span><span id="BayesianRVFLRegressor-247"><a href="#BayesianRVFLRegressor-247"><span class="linenos">247</span></a>            <span class="n">pred_obj</span> <span class="o">=</span> <span class="n">lmf</span><span class="o">.</span><span class="n">beta_Sigma_hat_rvfl</span><span class="p">(</span>
</span><span id="BayesianRVFLRegressor-248"><a href="#BayesianRVFLRegressor-248"><span class="linenos">248</span></a>                <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-249"><a href="#BayesianRVFLRegressor-249"><span class="linenos">249</span></a>                <span class="n">sigma</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-250"><a href="#BayesianRVFLRegressor-250"><span class="linenos">250</span></a>                <span class="n">X_star</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-251"><a href="#BayesianRVFLRegressor-251"><span class="linenos">251</span></a>                <span class="n">return_cov</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-252"><a href="#BayesianRVFLRegressor-252"><span class="linenos">252</span></a>                <span class="n">beta_hat_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-253"><a href="#BayesianRVFLRegressor-253"><span class="linenos">253</span></a>                <span class="n">Sigma_hat_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sigma_</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-254"><a href="#BayesianRVFLRegressor-254"><span class="linenos">254</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor-255"><a href="#BayesianRVFLRegressor-255"><span class="linenos">255</span></a>            <span class="p">)</span>
</span><span id="BayesianRVFLRegressor-256"><a href="#BayesianRVFLRegressor-256"><span class="linenos">256</span></a>
</span><span id="BayesianRVFLRegressor-257"><a href="#BayesianRVFLRegressor-257"><span class="linenos">257</span></a>            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">pred_obj</span><span class="p">[</span><span class="s2">&quot;preds&quot;</span><span class="p">],</span> <span class="n">pred_obj</span><span class="p">[</span><span class="s2">&quot;preds_std&quot;</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Bayesian Random Vector Functional Link Network regression with one prior</p>

<p>Parameters:</p>

<pre><code>n_hidden_features: int
    number of nodes in the hidden layer

activation_name: str
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'

a: float
    hyperparameter for 'prelu' or 'elu' activation function

nodes_sim: str
    type of simulation for the nodes: 'sobol', 'hammersley', 'halton', 'uniform'

bias: boolean
    indicates if the hidden layer contains a bias term (True) or not (False)

dropout: float
    regularization parameter; (random) percentage of nodes dropped out
    of the training

direct_link: boolean
    indicates if the original features are included (True) in model''s fitting or not (False)

n_clusters: int
    number of clusters for 'kmeans' or 'gmm' clustering (could be 0: no clustering)

cluster_encode: bool
    defines how the variable containing clusters is treated (default is one-hot)
    if `False`, then labels are used, without one-hot encoding

type_clust: str
    type of clustering method: currently k-means ('kmeans') or Gaussian Mixture Model ('gmm')

type_scaling: a tuple of 3 strings
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax')

seed: int
    reproducibility seed for nodes_sim=='uniform'

s: float
    std. dev. of regression parameters in Bayesian Ridge Regression

sigma: float
    std. dev. of residuals in Bayesian Ridge Regression

return_std: boolean
    if True, uncertainty around predictions is evaluated

backend: str
    "cpu" or "gpu" or "tpu"
</code></pre>

<p>Attributes:</p>

<pre><code>beta_: array-like
    regression''s coefficients

Sigma_: array-like
    covariance of the distribution of fitted parameters

GCV_: float
    Generalized cross-validation error

y_mean_: float
    average response
</code></pre>

<p>Examples:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">TBD</span>
</code></pre>
</div>
</div>


                                <div id="BayesianRVFLRegressor.fit" class="classattr">
                                            <input id="BayesianRVFLRegressor.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BayesianRVFLRegressor.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BayesianRVFLRegressor.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BayesianRVFLRegressor.fit-137"><a href="#BayesianRVFLRegressor.fit-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BayesianRVFLRegressor.fit-138"><a href="#BayesianRVFLRegressor.fit-138"><span class="linenos">138</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit BayesianRVFLRegressor to training data (X, y).</span>
</span><span id="BayesianRVFLRegressor.fit-139"><a href="#BayesianRVFLRegressor.fit-139"><span class="linenos">139</span></a>
</span><span id="BayesianRVFLRegressor.fit-140"><a href="#BayesianRVFLRegressor.fit-140"><span class="linenos">140</span></a><span class="sd">        Parameters:</span>
</span><span id="BayesianRVFLRegressor.fit-141"><a href="#BayesianRVFLRegressor.fit-141"><span class="linenos">141</span></a>
</span><span id="BayesianRVFLRegressor.fit-142"><a href="#BayesianRVFLRegressor.fit-142"><span class="linenos">142</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="BayesianRVFLRegressor.fit-143"><a href="#BayesianRVFLRegressor.fit-143"><span class="linenos">143</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="BayesianRVFLRegressor.fit-144"><a href="#BayesianRVFLRegressor.fit-144"><span class="linenos">144</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="BayesianRVFLRegressor.fit-145"><a href="#BayesianRVFLRegressor.fit-145"><span class="linenos">145</span></a>
</span><span id="BayesianRVFLRegressor.fit-146"><a href="#BayesianRVFLRegressor.fit-146"><span class="linenos">146</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="BayesianRVFLRegressor.fit-147"><a href="#BayesianRVFLRegressor.fit-147"><span class="linenos">147</span></a><span class="sd">                Target values.</span>
</span><span id="BayesianRVFLRegressor.fit-148"><a href="#BayesianRVFLRegressor.fit-148"><span class="linenos">148</span></a>
</span><span id="BayesianRVFLRegressor.fit-149"><a href="#BayesianRVFLRegressor.fit-149"><span class="linenos">149</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="BayesianRVFLRegressor.fit-150"><a href="#BayesianRVFLRegressor.fit-150"><span class="linenos">150</span></a><span class="sd">                    self.cook_training_set</span>
</span><span id="BayesianRVFLRegressor.fit-151"><a href="#BayesianRVFLRegressor.fit-151"><span class="linenos">151</span></a>
</span><span id="BayesianRVFLRegressor.fit-152"><a href="#BayesianRVFLRegressor.fit-152"><span class="linenos">152</span></a><span class="sd">        Returns:</span>
</span><span id="BayesianRVFLRegressor.fit-153"><a href="#BayesianRVFLRegressor.fit-153"><span class="linenos">153</span></a>
</span><span id="BayesianRVFLRegressor.fit-154"><a href="#BayesianRVFLRegressor.fit-154"><span class="linenos">154</span></a><span class="sd">            self: object</span>
</span><span id="BayesianRVFLRegressor.fit-155"><a href="#BayesianRVFLRegressor.fit-155"><span class="linenos">155</span></a>
</span><span id="BayesianRVFLRegressor.fit-156"><a href="#BayesianRVFLRegressor.fit-156"><span class="linenos">156</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BayesianRVFLRegressor.fit-157"><a href="#BayesianRVFLRegressor.fit-157"><span class="linenos">157</span></a>
</span><span id="BayesianRVFLRegressor.fit-158"><a href="#BayesianRVFLRegressor.fit-158"><span class="linenos">158</span></a>        <span class="n">centered_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BayesianRVFLRegressor.fit-159"><a href="#BayesianRVFLRegressor.fit-159"><span class="linenos">159</span></a>
</span><span id="BayesianRVFLRegressor.fit-160"><a href="#BayesianRVFLRegressor.fit-160"><span class="linenos">160</span></a>        <span class="n">fit_obj</span> <span class="o">=</span> <span class="n">lmf</span><span class="o">.</span><span class="n">beta_Sigma_hat_rvfl</span><span class="p">(</span>
</span><span id="BayesianRVFLRegressor.fit-161"><a href="#BayesianRVFLRegressor.fit-161"><span class="linenos">161</span></a>            <span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.fit-162"><a href="#BayesianRVFLRegressor.fit-162"><span class="linenos">162</span></a>            <span class="n">y</span><span class="o">=</span><span class="n">centered_y</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.fit-163"><a href="#BayesianRVFLRegressor.fit-163"><span class="linenos">163</span></a>            <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.fit-164"><a href="#BayesianRVFLRegressor.fit-164"><span class="linenos">164</span></a>            <span class="n">sigma</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.fit-165"><a href="#BayesianRVFLRegressor.fit-165"><span class="linenos">165</span></a>            <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.fit-166"><a href="#BayesianRVFLRegressor.fit-166"><span class="linenos">166</span></a>            <span class="n">return_cov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">return_std</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.fit-167"><a href="#BayesianRVFLRegressor.fit-167"><span class="linenos">167</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.fit-168"><a href="#BayesianRVFLRegressor.fit-168"><span class="linenos">168</span></a>        <span class="p">)</span>
</span><span id="BayesianRVFLRegressor.fit-169"><a href="#BayesianRVFLRegressor.fit-169"><span class="linenos">169</span></a>
</span><span id="BayesianRVFLRegressor.fit-170"><a href="#BayesianRVFLRegressor.fit-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="p">[</span><span class="s2">&quot;beta_hat&quot;</span><span class="p">]</span>
</span><span id="BayesianRVFLRegressor.fit-171"><a href="#BayesianRVFLRegressor.fit-171"><span class="linenos">171</span></a>
</span><span id="BayesianRVFLRegressor.fit-172"><a href="#BayesianRVFLRegressor.fit-172"><span class="linenos">172</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="BayesianRVFLRegressor.fit-173"><a href="#BayesianRVFLRegressor.fit-173"><span class="linenos">173</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">Sigma_</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="p">[</span><span class="s2">&quot;Sigma_hat&quot;</span><span class="p">]</span>
</span><span id="BayesianRVFLRegressor.fit-174"><a href="#BayesianRVFLRegressor.fit-174"><span class="linenos">174</span></a>
</span><span id="BayesianRVFLRegressor.fit-175"><a href="#BayesianRVFLRegressor.fit-175"><span class="linenos">175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">GCV_</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="p">[</span><span class="s2">&quot;GCV&quot;</span><span class="p">]</span>
</span><span id="BayesianRVFLRegressor.fit-176"><a href="#BayesianRVFLRegressor.fit-176"><span class="linenos">176</span></a>
</span><span id="BayesianRVFLRegressor.fit-177"><a href="#BayesianRVFLRegressor.fit-177"><span class="linenos">177</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit BayesianRVFLRegressor to training data (X, y).</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

y: array-like, shape = [n_samples]
    Target values.

**kwargs: additional parameters to be passed to
        self.cook_training_set
</code></pre>

<p>Returns:</p>

<pre><code>self: object
</code></pre>
</div>


                                </div>
                                <div id="BayesianRVFLRegressor.predict" class="classattr">
                                            <input id="BayesianRVFLRegressor.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">return_std</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BayesianRVFLRegressor.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BayesianRVFLRegressor.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BayesianRVFLRegressor.predict-179"><a href="#BayesianRVFLRegressor.predict-179"><span class="linenos">179</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BayesianRVFLRegressor.predict-180"><a href="#BayesianRVFLRegressor.predict-180"><span class="linenos">180</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="BayesianRVFLRegressor.predict-181"><a href="#BayesianRVFLRegressor.predict-181"><span class="linenos">181</span></a>
</span><span id="BayesianRVFLRegressor.predict-182"><a href="#BayesianRVFLRegressor.predict-182"><span class="linenos">182</span></a><span class="sd">        Parameters:</span>
</span><span id="BayesianRVFLRegressor.predict-183"><a href="#BayesianRVFLRegressor.predict-183"><span class="linenos">183</span></a>
</span><span id="BayesianRVFLRegressor.predict-184"><a href="#BayesianRVFLRegressor.predict-184"><span class="linenos">184</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="BayesianRVFLRegressor.predict-185"><a href="#BayesianRVFLRegressor.predict-185"><span class="linenos">185</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="BayesianRVFLRegressor.predict-186"><a href="#BayesianRVFLRegressor.predict-186"><span class="linenos">186</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="BayesianRVFLRegressor.predict-187"><a href="#BayesianRVFLRegressor.predict-187"><span class="linenos">187</span></a>
</span><span id="BayesianRVFLRegressor.predict-188"><a href="#BayesianRVFLRegressor.predict-188"><span class="linenos">188</span></a><span class="sd">            return_std: {boolean}, standard dev. is returned or not</span>
</span><span id="BayesianRVFLRegressor.predict-189"><a href="#BayesianRVFLRegressor.predict-189"><span class="linenos">189</span></a>
</span><span id="BayesianRVFLRegressor.predict-190"><a href="#BayesianRVFLRegressor.predict-190"><span class="linenos">190</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="BayesianRVFLRegressor.predict-191"><a href="#BayesianRVFLRegressor.predict-191"><span class="linenos">191</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="BayesianRVFLRegressor.predict-192"><a href="#BayesianRVFLRegressor.predict-192"><span class="linenos">192</span></a>
</span><span id="BayesianRVFLRegressor.predict-193"><a href="#BayesianRVFLRegressor.predict-193"><span class="linenos">193</span></a><span class="sd">        Returns:</span>
</span><span id="BayesianRVFLRegressor.predict-194"><a href="#BayesianRVFLRegressor.predict-194"><span class="linenos">194</span></a>
</span><span id="BayesianRVFLRegressor.predict-195"><a href="#BayesianRVFLRegressor.predict-195"><span class="linenos">195</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="BayesianRVFLRegressor.predict-196"><a href="#BayesianRVFLRegressor.predict-196"><span class="linenos">196</span></a>
</span><span id="BayesianRVFLRegressor.predict-197"><a href="#BayesianRVFLRegressor.predict-197"><span class="linenos">197</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BayesianRVFLRegressor.predict-198"><a href="#BayesianRVFLRegressor.predict-198"><span class="linenos">198</span></a>
</span><span id="BayesianRVFLRegressor.predict-199"><a href="#BayesianRVFLRegressor.predict-199"><span class="linenos">199</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># one observation in the test set only</span>
</span><span id="BayesianRVFLRegressor.predict-200"><a href="#BayesianRVFLRegressor.predict-200"><span class="linenos">200</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="BayesianRVFLRegressor.predict-201"><a href="#BayesianRVFLRegressor.predict-201"><span class="linenos">201</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="BayesianRVFLRegressor.predict-202"><a href="#BayesianRVFLRegressor.predict-202"><span class="linenos">202</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="BayesianRVFLRegressor.predict-203"><a href="#BayesianRVFLRegressor.predict-203"><span class="linenos">203</span></a>                <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="BayesianRVFLRegressor.predict-204"><a href="#BayesianRVFLRegressor.predict-204"><span class="linenos">204</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-205"><a href="#BayesianRVFLRegressor.predict-205"><span class="linenos">205</span></a>            <span class="p">)</span>
</span><span id="BayesianRVFLRegressor.predict-206"><a href="#BayesianRVFLRegressor.predict-206"><span class="linenos">206</span></a>
</span><span id="BayesianRVFLRegressor.predict-207"><a href="#BayesianRVFLRegressor.predict-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">=</span> <span class="n">return_std</span>
</span><span id="BayesianRVFLRegressor.predict-208"><a href="#BayesianRVFLRegressor.predict-208"><span class="linenos">208</span></a>
</span><span id="BayesianRVFLRegressor.predict-209"><a href="#BayesianRVFLRegressor.predict-209"><span class="linenos">209</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="BayesianRVFLRegressor.predict-210"><a href="#BayesianRVFLRegressor.predict-210"><span class="linenos">210</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BayesianRVFLRegressor.predict-211"><a href="#BayesianRVFLRegressor.predict-211"><span class="linenos">211</span></a>                <span class="k">return</span> <span class="p">(</span>
</span><span id="BayesianRVFLRegressor.predict-212"><a href="#BayesianRVFLRegressor.predict-212"><span class="linenos">212</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span>
</span><span id="BayesianRVFLRegressor.predict-213"><a href="#BayesianRVFLRegressor.predict-213"><span class="linenos">213</span></a>                    <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="BayesianRVFLRegressor.predict-214"><a href="#BayesianRVFLRegressor.predict-214"><span class="linenos">214</span></a>                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="BayesianRVFLRegressor.predict-215"><a href="#BayesianRVFLRegressor.predict-215"><span class="linenos">215</span></a>                        <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-216"><a href="#BayesianRVFLRegressor.predict-216"><span class="linenos">216</span></a>                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-217"><a href="#BayesianRVFLRegressor.predict-217"><span class="linenos">217</span></a>                    <span class="p">)</span>
</span><span id="BayesianRVFLRegressor.predict-218"><a href="#BayesianRVFLRegressor.predict-218"><span class="linenos">218</span></a>                <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="BayesianRVFLRegressor.predict-219"><a href="#BayesianRVFLRegressor.predict-219"><span class="linenos">219</span></a>
</span><span id="BayesianRVFLRegressor.predict-220"><a href="#BayesianRVFLRegressor.predict-220"><span class="linenos">220</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="BayesianRVFLRegressor.predict-221"><a href="#BayesianRVFLRegressor.predict-221"><span class="linenos">221</span></a>                <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="BayesianRVFLRegressor.predict-222"><a href="#BayesianRVFLRegressor.predict-222"><span class="linenos">222</span></a>                <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-223"><a href="#BayesianRVFLRegressor.predict-223"><span class="linenos">223</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-224"><a href="#BayesianRVFLRegressor.predict-224"><span class="linenos">224</span></a>            <span class="p">)</span>
</span><span id="BayesianRVFLRegressor.predict-225"><a href="#BayesianRVFLRegressor.predict-225"><span class="linenos">225</span></a>
</span><span id="BayesianRVFLRegressor.predict-226"><a href="#BayesianRVFLRegressor.predict-226"><span class="linenos">226</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># confidence interval required for preds?</span>
</span><span id="BayesianRVFLRegressor.predict-227"><a href="#BayesianRVFLRegressor.predict-227"><span class="linenos">227</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BayesianRVFLRegressor.predict-228"><a href="#BayesianRVFLRegressor.predict-228"><span class="linenos">228</span></a>                <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BayesianRVFLRegressor.predict-229"><a href="#BayesianRVFLRegressor.predict-229"><span class="linenos">229</span></a>
</span><span id="BayesianRVFLRegressor.predict-230"><a href="#BayesianRVFLRegressor.predict-230"><span class="linenos">230</span></a>                <span class="n">pred_obj</span> <span class="o">=</span> <span class="n">lmf</span><span class="o">.</span><span class="n">beta_Sigma_hat_rvfl</span><span class="p">(</span>
</span><span id="BayesianRVFLRegressor.predict-231"><a href="#BayesianRVFLRegressor.predict-231"><span class="linenos">231</span></a>                    <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-232"><a href="#BayesianRVFLRegressor.predict-232"><span class="linenos">232</span></a>                    <span class="n">sigma</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-233"><a href="#BayesianRVFLRegressor.predict-233"><span class="linenos">233</span></a>                    <span class="n">X_star</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-234"><a href="#BayesianRVFLRegressor.predict-234"><span class="linenos">234</span></a>                    <span class="n">return_cov</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-235"><a href="#BayesianRVFLRegressor.predict-235"><span class="linenos">235</span></a>                    <span class="n">beta_hat_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-236"><a href="#BayesianRVFLRegressor.predict-236"><span class="linenos">236</span></a>                    <span class="n">Sigma_hat_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sigma_</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-237"><a href="#BayesianRVFLRegressor.predict-237"><span class="linenos">237</span></a>                    <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-238"><a href="#BayesianRVFLRegressor.predict-238"><span class="linenos">238</span></a>                <span class="p">)</span>
</span><span id="BayesianRVFLRegressor.predict-239"><a href="#BayesianRVFLRegressor.predict-239"><span class="linenos">239</span></a>
</span><span id="BayesianRVFLRegressor.predict-240"><a href="#BayesianRVFLRegressor.predict-240"><span class="linenos">240</span></a>                <span class="k">return</span> <span class="p">(</span>
</span><span id="BayesianRVFLRegressor.predict-241"><a href="#BayesianRVFLRegressor.predict-241"><span class="linenos">241</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">pred_obj</span><span class="p">[</span><span class="s2">&quot;preds&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="BayesianRVFLRegressor.predict-242"><a href="#BayesianRVFLRegressor.predict-242"><span class="linenos">242</span></a>                    <span class="n">pred_obj</span><span class="p">[</span><span class="s2">&quot;preds_std&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="BayesianRVFLRegressor.predict-243"><a href="#BayesianRVFLRegressor.predict-243"><span class="linenos">243</span></a>                <span class="p">)</span>
</span><span id="BayesianRVFLRegressor.predict-244"><a href="#BayesianRVFLRegressor.predict-244"><span class="linenos">244</span></a>
</span><span id="BayesianRVFLRegressor.predict-245"><a href="#BayesianRVFLRegressor.predict-245"><span class="linenos">245</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BayesianRVFLRegressor.predict-246"><a href="#BayesianRVFLRegressor.predict-246"><span class="linenos">246</span></a>
</span><span id="BayesianRVFLRegressor.predict-247"><a href="#BayesianRVFLRegressor.predict-247"><span class="linenos">247</span></a>            <span class="n">pred_obj</span> <span class="o">=</span> <span class="n">lmf</span><span class="o">.</span><span class="n">beta_Sigma_hat_rvfl</span><span class="p">(</span>
</span><span id="BayesianRVFLRegressor.predict-248"><a href="#BayesianRVFLRegressor.predict-248"><span class="linenos">248</span></a>                <span class="n">s</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">s</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-249"><a href="#BayesianRVFLRegressor.predict-249"><span class="linenos">249</span></a>                <span class="n">sigma</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-250"><a href="#BayesianRVFLRegressor.predict-250"><span class="linenos">250</span></a>                <span class="n">X_star</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-251"><a href="#BayesianRVFLRegressor.predict-251"><span class="linenos">251</span></a>                <span class="n">return_cov</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-252"><a href="#BayesianRVFLRegressor.predict-252"><span class="linenos">252</span></a>                <span class="n">beta_hat_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-253"><a href="#BayesianRVFLRegressor.predict-253"><span class="linenos">253</span></a>                <span class="n">Sigma_hat_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sigma_</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-254"><a href="#BayesianRVFLRegressor.predict-254"><span class="linenos">254</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFLRegressor.predict-255"><a href="#BayesianRVFLRegressor.predict-255"><span class="linenos">255</span></a>            <span class="p">)</span>
</span><span id="BayesianRVFLRegressor.predict-256"><a href="#BayesianRVFLRegressor.predict-256"><span class="linenos">256</span></a>
</span><span id="BayesianRVFLRegressor.predict-257"><a href="#BayesianRVFLRegressor.predict-257"><span class="linenos">257</span></a>            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">pred_obj</span><span class="p">[</span><span class="s2">&quot;preds&quot;</span><span class="p">],</span> <span class="n">pred_obj</span><span class="p">[</span><span class="s2">&quot;preds_std&quot;</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Predict test data X.</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

return_std: {boolean}, standard dev. is returned or not

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>model predictions: {array-like}
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="BayesianRVFL2Regressor">
                            <input id="BayesianRVFL2Regressor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">BayesianRVFL2Regressor</span><wbr>(<span class="base"><a href="#Base">nnetsauce.Base</a></span>, <span class="base">sklearn.base.RegressorMixin</span>):

                <label class="view-source-button" for="BayesianRVFL2Regressor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BayesianRVFL2Regressor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BayesianRVFL2Regressor-15"><a href="#BayesianRVFL2Regressor-15"><span class="linenos"> 15</span></a><span class="k">class</span> <span class="nc">BayesianRVFL2Regressor</span><span class="p">(</span><span class="n">Base</span><span class="p">,</span> <span class="n">RegressorMixin</span><span class="p">):</span>
</span><span id="BayesianRVFL2Regressor-16"><a href="#BayesianRVFL2Regressor-16"><span class="linenos"> 16</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Bayesian Random Vector Functional Link Network regression with two priors</span>
</span><span id="BayesianRVFL2Regressor-17"><a href="#BayesianRVFL2Regressor-17"><span class="linenos"> 17</span></a>
</span><span id="BayesianRVFL2Regressor-18"><a href="#BayesianRVFL2Regressor-18"><span class="linenos"> 18</span></a><span class="sd">    Parameters:</span>
</span><span id="BayesianRVFL2Regressor-19"><a href="#BayesianRVFL2Regressor-19"><span class="linenos"> 19</span></a>
</span><span id="BayesianRVFL2Regressor-20"><a href="#BayesianRVFL2Regressor-20"><span class="linenos"> 20</span></a><span class="sd">        n_hidden_features: int</span>
</span><span id="BayesianRVFL2Regressor-21"><a href="#BayesianRVFL2Regressor-21"><span class="linenos"> 21</span></a><span class="sd">            number of nodes in the hidden layer</span>
</span><span id="BayesianRVFL2Regressor-22"><a href="#BayesianRVFL2Regressor-22"><span class="linenos"> 22</span></a>
</span><span id="BayesianRVFL2Regressor-23"><a href="#BayesianRVFL2Regressor-23"><span class="linenos"> 23</span></a><span class="sd">        activation_name: str</span>
</span><span id="BayesianRVFL2Regressor-24"><a href="#BayesianRVFL2Regressor-24"><span class="linenos"> 24</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;</span>
</span><span id="BayesianRVFL2Regressor-25"><a href="#BayesianRVFL2Regressor-25"><span class="linenos"> 25</span></a>
</span><span id="BayesianRVFL2Regressor-26"><a href="#BayesianRVFL2Regressor-26"><span class="linenos"> 26</span></a><span class="sd">        a: float</span>
</span><span id="BayesianRVFL2Regressor-27"><a href="#BayesianRVFL2Regressor-27"><span class="linenos"> 27</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function</span>
</span><span id="BayesianRVFL2Regressor-28"><a href="#BayesianRVFL2Regressor-28"><span class="linenos"> 28</span></a>
</span><span id="BayesianRVFL2Regressor-29"><a href="#BayesianRVFL2Regressor-29"><span class="linenos"> 29</span></a><span class="sd">        nodes_sim: str</span>
</span><span id="BayesianRVFL2Regressor-30"><a href="#BayesianRVFL2Regressor-30"><span class="linenos"> 30</span></a><span class="sd">            type of simulation for the nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;, &#39;uniform&#39;</span>
</span><span id="BayesianRVFL2Regressor-31"><a href="#BayesianRVFL2Regressor-31"><span class="linenos"> 31</span></a>
</span><span id="BayesianRVFL2Regressor-32"><a href="#BayesianRVFL2Regressor-32"><span class="linenos"> 32</span></a><span class="sd">        bias: boolean</span>
</span><span id="BayesianRVFL2Regressor-33"><a href="#BayesianRVFL2Regressor-33"><span class="linenos"> 33</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or not (False)</span>
</span><span id="BayesianRVFL2Regressor-34"><a href="#BayesianRVFL2Regressor-34"><span class="linenos"> 34</span></a>
</span><span id="BayesianRVFL2Regressor-35"><a href="#BayesianRVFL2Regressor-35"><span class="linenos"> 35</span></a><span class="sd">        dropout: float</span>
</span><span id="BayesianRVFL2Regressor-36"><a href="#BayesianRVFL2Regressor-36"><span class="linenos"> 36</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="BayesianRVFL2Regressor-37"><a href="#BayesianRVFL2Regressor-37"><span class="linenos"> 37</span></a><span class="sd">            of the training</span>
</span><span id="BayesianRVFL2Regressor-38"><a href="#BayesianRVFL2Regressor-38"><span class="linenos"> 38</span></a>
</span><span id="BayesianRVFL2Regressor-39"><a href="#BayesianRVFL2Regressor-39"><span class="linenos"> 39</span></a><span class="sd">        direct_link: boolean</span>
</span><span id="BayesianRVFL2Regressor-40"><a href="#BayesianRVFL2Regressor-40"><span class="linenos"> 40</span></a><span class="sd">            indicates if the original features are included (True) in model&#39;&#39;s fitting or not (False)</span>
</span><span id="BayesianRVFL2Regressor-41"><a href="#BayesianRVFL2Regressor-41"><span class="linenos"> 41</span></a>
</span><span id="BayesianRVFL2Regressor-42"><a href="#BayesianRVFL2Regressor-42"><span class="linenos"> 42</span></a><span class="sd">        n_clusters: int</span>
</span><span id="BayesianRVFL2Regressor-43"><a href="#BayesianRVFL2Regressor-43"><span class="linenos"> 43</span></a><span class="sd">            number of clusters for &#39;kmeans&#39; or &#39;gmm&#39; clustering (could be 0: no clustering)</span>
</span><span id="BayesianRVFL2Regressor-44"><a href="#BayesianRVFL2Regressor-44"><span class="linenos"> 44</span></a>
</span><span id="BayesianRVFL2Regressor-45"><a href="#BayesianRVFL2Regressor-45"><span class="linenos"> 45</span></a><span class="sd">        cluster_encode: bool</span>
</span><span id="BayesianRVFL2Regressor-46"><a href="#BayesianRVFL2Regressor-46"><span class="linenos"> 46</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot)</span>
</span><span id="BayesianRVFL2Regressor-47"><a href="#BayesianRVFL2Regressor-47"><span class="linenos"> 47</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding</span>
</span><span id="BayesianRVFL2Regressor-48"><a href="#BayesianRVFL2Regressor-48"><span class="linenos"> 48</span></a>
</span><span id="BayesianRVFL2Regressor-49"><a href="#BayesianRVFL2Regressor-49"><span class="linenos"> 49</span></a><span class="sd">        type_clust: str</span>
</span><span id="BayesianRVFL2Regressor-50"><a href="#BayesianRVFL2Regressor-50"><span class="linenos"> 50</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian Mixture Model (&#39;gmm&#39;)</span>
</span><span id="BayesianRVFL2Regressor-51"><a href="#BayesianRVFL2Regressor-51"><span class="linenos"> 51</span></a>
</span><span id="BayesianRVFL2Regressor-52"><a href="#BayesianRVFL2Regressor-52"><span class="linenos"> 52</span></a><span class="sd">        type_scaling: a tuple of 3 strings</span>
</span><span id="BayesianRVFL2Regressor-53"><a href="#BayesianRVFL2Regressor-53"><span class="linenos"> 53</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="BayesianRVFL2Regressor-54"><a href="#BayesianRVFL2Regressor-54"><span class="linenos"> 54</span></a><span class="sd">            (and when relevant).</span>
</span><span id="BayesianRVFL2Regressor-55"><a href="#BayesianRVFL2Regressor-55"><span class="linenos"> 55</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;)</span>
</span><span id="BayesianRVFL2Regressor-56"><a href="#BayesianRVFL2Regressor-56"><span class="linenos"> 56</span></a>
</span><span id="BayesianRVFL2Regressor-57"><a href="#BayesianRVFL2Regressor-57"><span class="linenos"> 57</span></a><span class="sd">        seed: int</span>
</span><span id="BayesianRVFL2Regressor-58"><a href="#BayesianRVFL2Regressor-58"><span class="linenos"> 58</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39;</span>
</span><span id="BayesianRVFL2Regressor-59"><a href="#BayesianRVFL2Regressor-59"><span class="linenos"> 59</span></a>
</span><span id="BayesianRVFL2Regressor-60"><a href="#BayesianRVFL2Regressor-60"><span class="linenos"> 60</span></a><span class="sd">        s1: float</span>
</span><span id="BayesianRVFL2Regressor-61"><a href="#BayesianRVFL2Regressor-61"><span class="linenos"> 61</span></a><span class="sd">            std. dev. of init. regression parameters in Bayesian Ridge Regression</span>
</span><span id="BayesianRVFL2Regressor-62"><a href="#BayesianRVFL2Regressor-62"><span class="linenos"> 62</span></a>
</span><span id="BayesianRVFL2Regressor-63"><a href="#BayesianRVFL2Regressor-63"><span class="linenos"> 63</span></a><span class="sd">        s2: float</span>
</span><span id="BayesianRVFL2Regressor-64"><a href="#BayesianRVFL2Regressor-64"><span class="linenos"> 64</span></a><span class="sd">            std. dev. of augmented regression parameters in Bayesian Ridge Regression</span>
</span><span id="BayesianRVFL2Regressor-65"><a href="#BayesianRVFL2Regressor-65"><span class="linenos"> 65</span></a>
</span><span id="BayesianRVFL2Regressor-66"><a href="#BayesianRVFL2Regressor-66"><span class="linenos"> 66</span></a><span class="sd">        sigma: float</span>
</span><span id="BayesianRVFL2Regressor-67"><a href="#BayesianRVFL2Regressor-67"><span class="linenos"> 67</span></a><span class="sd">            std. dev. of residuals in Bayesian Ridge Regression</span>
</span><span id="BayesianRVFL2Regressor-68"><a href="#BayesianRVFL2Regressor-68"><span class="linenos"> 68</span></a>
</span><span id="BayesianRVFL2Regressor-69"><a href="#BayesianRVFL2Regressor-69"><span class="linenos"> 69</span></a><span class="sd">        return_std: boolean</span>
</span><span id="BayesianRVFL2Regressor-70"><a href="#BayesianRVFL2Regressor-70"><span class="linenos"> 70</span></a><span class="sd">            if True, uncertainty around predictions is evaluated</span>
</span><span id="BayesianRVFL2Regressor-71"><a href="#BayesianRVFL2Regressor-71"><span class="linenos"> 71</span></a>
</span><span id="BayesianRVFL2Regressor-72"><a href="#BayesianRVFL2Regressor-72"><span class="linenos"> 72</span></a><span class="sd">        backend: str</span>
</span><span id="BayesianRVFL2Regressor-73"><a href="#BayesianRVFL2Regressor-73"><span class="linenos"> 73</span></a><span class="sd">            &quot;cpu&quot; or &quot;gpu&quot; or &quot;tpu&quot;</span>
</span><span id="BayesianRVFL2Regressor-74"><a href="#BayesianRVFL2Regressor-74"><span class="linenos"> 74</span></a>
</span><span id="BayesianRVFL2Regressor-75"><a href="#BayesianRVFL2Regressor-75"><span class="linenos"> 75</span></a><span class="sd">    Attributes:</span>
</span><span id="BayesianRVFL2Regressor-76"><a href="#BayesianRVFL2Regressor-76"><span class="linenos"> 76</span></a>
</span><span id="BayesianRVFL2Regressor-77"><a href="#BayesianRVFL2Regressor-77"><span class="linenos"> 77</span></a><span class="sd">        beta_: array-like</span>
</span><span id="BayesianRVFL2Regressor-78"><a href="#BayesianRVFL2Regressor-78"><span class="linenos"> 78</span></a><span class="sd">            regression&#39;&#39;s coefficients</span>
</span><span id="BayesianRVFL2Regressor-79"><a href="#BayesianRVFL2Regressor-79"><span class="linenos"> 79</span></a>
</span><span id="BayesianRVFL2Regressor-80"><a href="#BayesianRVFL2Regressor-80"><span class="linenos"> 80</span></a><span class="sd">        Sigma_: array-like</span>
</span><span id="BayesianRVFL2Regressor-81"><a href="#BayesianRVFL2Regressor-81"><span class="linenos"> 81</span></a><span class="sd">            covariance of the distribution of fitted parameters</span>
</span><span id="BayesianRVFL2Regressor-82"><a href="#BayesianRVFL2Regressor-82"><span class="linenos"> 82</span></a>
</span><span id="BayesianRVFL2Regressor-83"><a href="#BayesianRVFL2Regressor-83"><span class="linenos"> 83</span></a><span class="sd">        GCV_: float</span>
</span><span id="BayesianRVFL2Regressor-84"><a href="#BayesianRVFL2Regressor-84"><span class="linenos"> 84</span></a><span class="sd">            Generalized cross-validation error</span>
</span><span id="BayesianRVFL2Regressor-85"><a href="#BayesianRVFL2Regressor-85"><span class="linenos"> 85</span></a>
</span><span id="BayesianRVFL2Regressor-86"><a href="#BayesianRVFL2Regressor-86"><span class="linenos"> 86</span></a><span class="sd">        y_mean_: float</span>
</span><span id="BayesianRVFL2Regressor-87"><a href="#BayesianRVFL2Regressor-87"><span class="linenos"> 87</span></a><span class="sd">            average response</span>
</span><span id="BayesianRVFL2Regressor-88"><a href="#BayesianRVFL2Regressor-88"><span class="linenos"> 88</span></a>
</span><span id="BayesianRVFL2Regressor-89"><a href="#BayesianRVFL2Regressor-89"><span class="linenos"> 89</span></a><span class="sd">    Examples:</span>
</span><span id="BayesianRVFL2Regressor-90"><a href="#BayesianRVFL2Regressor-90"><span class="linenos"> 90</span></a>
</span><span id="BayesianRVFL2Regressor-91"><a href="#BayesianRVFL2Regressor-91"><span class="linenos"> 91</span></a><span class="sd">    ```python</span>
</span><span id="BayesianRVFL2Regressor-92"><a href="#BayesianRVFL2Regressor-92"><span class="linenos"> 92</span></a><span class="sd">    TBD</span>
</span><span id="BayesianRVFL2Regressor-93"><a href="#BayesianRVFL2Regressor-93"><span class="linenos"> 93</span></a><span class="sd">    ```</span>
</span><span id="BayesianRVFL2Regressor-94"><a href="#BayesianRVFL2Regressor-94"><span class="linenos"> 94</span></a>
</span><span id="BayesianRVFL2Regressor-95"><a href="#BayesianRVFL2Regressor-95"><span class="linenos"> 95</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="BayesianRVFL2Regressor-96"><a href="#BayesianRVFL2Regressor-96"><span class="linenos"> 96</span></a>
</span><span id="BayesianRVFL2Regressor-97"><a href="#BayesianRVFL2Regressor-97"><span class="linenos"> 97</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="BayesianRVFL2Regressor-98"><a href="#BayesianRVFL2Regressor-98"><span class="linenos"> 98</span></a>
</span><span id="BayesianRVFL2Regressor-99"><a href="#BayesianRVFL2Regressor-99"><span class="linenos"> 99</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="BayesianRVFL2Regressor-100"><a href="#BayesianRVFL2Regressor-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-101"><a href="#BayesianRVFL2Regressor-101"><span class="linenos">101</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-102"><a href="#BayesianRVFL2Regressor-102"><span class="linenos">102</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-103"><a href="#BayesianRVFL2Regressor-103"><span class="linenos">103</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-104"><a href="#BayesianRVFL2Regressor-104"><span class="linenos">104</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-105"><a href="#BayesianRVFL2Regressor-105"><span class="linenos">105</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-106"><a href="#BayesianRVFL2Regressor-106"><span class="linenos">106</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-107"><a href="#BayesianRVFL2Regressor-107"><span class="linenos">107</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-108"><a href="#BayesianRVFL2Regressor-108"><span class="linenos">108</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-109"><a href="#BayesianRVFL2Regressor-109"><span class="linenos">109</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-110"><a href="#BayesianRVFL2Regressor-110"><span class="linenos">110</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-111"><a href="#BayesianRVFL2Regressor-111"><span class="linenos">111</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="BayesianRVFL2Regressor-112"><a href="#BayesianRVFL2Regressor-112"><span class="linenos">112</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-113"><a href="#BayesianRVFL2Regressor-113"><span class="linenos">113</span></a>        <span class="n">s1</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-114"><a href="#BayesianRVFL2Regressor-114"><span class="linenos">114</span></a>        <span class="n">s2</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-115"><a href="#BayesianRVFL2Regressor-115"><span class="linenos">115</span></a>        <span class="n">sigma</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-116"><a href="#BayesianRVFL2Regressor-116"><span class="linenos">116</span></a>        <span class="n">return_std</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-117"><a href="#BayesianRVFL2Regressor-117"><span class="linenos">117</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-118"><a href="#BayesianRVFL2Regressor-118"><span class="linenos">118</span></a>    <span class="p">):</span>
</span><span id="BayesianRVFL2Regressor-119"><a href="#BayesianRVFL2Regressor-119"><span class="linenos">119</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="BayesianRVFL2Regressor-120"><a href="#BayesianRVFL2Regressor-120"><span class="linenos">120</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-121"><a href="#BayesianRVFL2Regressor-121"><span class="linenos">121</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-122"><a href="#BayesianRVFL2Regressor-122"><span class="linenos">122</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-123"><a href="#BayesianRVFL2Regressor-123"><span class="linenos">123</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-124"><a href="#BayesianRVFL2Regressor-124"><span class="linenos">124</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-125"><a href="#BayesianRVFL2Regressor-125"><span class="linenos">125</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-126"><a href="#BayesianRVFL2Regressor-126"><span class="linenos">126</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-127"><a href="#BayesianRVFL2Regressor-127"><span class="linenos">127</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-128"><a href="#BayesianRVFL2Regressor-128"><span class="linenos">128</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-129"><a href="#BayesianRVFL2Regressor-129"><span class="linenos">129</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-130"><a href="#BayesianRVFL2Regressor-130"><span class="linenos">130</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-131"><a href="#BayesianRVFL2Regressor-131"><span class="linenos">131</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-132"><a href="#BayesianRVFL2Regressor-132"><span class="linenos">132</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-133"><a href="#BayesianRVFL2Regressor-133"><span class="linenos">133</span></a>        <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor-134"><a href="#BayesianRVFL2Regressor-134"><span class="linenos">134</span></a>
</span><span id="BayesianRVFL2Regressor-135"><a href="#BayesianRVFL2Regressor-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">s1</span> <span class="o">=</span> <span class="n">s1</span>
</span><span id="BayesianRVFL2Regressor-136"><a href="#BayesianRVFL2Regressor-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">s2</span> <span class="o">=</span> <span class="n">s2</span>
</span><span id="BayesianRVFL2Regressor-137"><a href="#BayesianRVFL2Regressor-137"><span class="linenos">137</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span>
</span><span id="BayesianRVFL2Regressor-138"><a href="#BayesianRVFL2Regressor-138"><span class="linenos">138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="BayesianRVFL2Regressor-139"><a href="#BayesianRVFL2Regressor-139"><span class="linenos">139</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Sigma_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="BayesianRVFL2Regressor-140"><a href="#BayesianRVFL2Regressor-140"><span class="linenos">140</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">GCV_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="BayesianRVFL2Regressor-141"><a href="#BayesianRVFL2Regressor-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">=</span> <span class="n">return_std</span>
</span><span id="BayesianRVFL2Regressor-142"><a href="#BayesianRVFL2Regressor-142"><span class="linenos">142</span></a>
</span><span id="BayesianRVFL2Regressor-143"><a href="#BayesianRVFL2Regressor-143"><span class="linenos">143</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BayesianRVFL2Regressor-144"><a href="#BayesianRVFL2Regressor-144"><span class="linenos">144</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit BayesianRVFL2Regressor to training data (X, y)</span>
</span><span id="BayesianRVFL2Regressor-145"><a href="#BayesianRVFL2Regressor-145"><span class="linenos">145</span></a>
</span><span id="BayesianRVFL2Regressor-146"><a href="#BayesianRVFL2Regressor-146"><span class="linenos">146</span></a><span class="sd">        Parameters:</span>
</span><span id="BayesianRVFL2Regressor-147"><a href="#BayesianRVFL2Regressor-147"><span class="linenos">147</span></a>
</span><span id="BayesianRVFL2Regressor-148"><a href="#BayesianRVFL2Regressor-148"><span class="linenos">148</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="BayesianRVFL2Regressor-149"><a href="#BayesianRVFL2Regressor-149"><span class="linenos">149</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="BayesianRVFL2Regressor-150"><a href="#BayesianRVFL2Regressor-150"><span class="linenos">150</span></a><span class="sd">                of samples and n_features is the number of features</span>
</span><span id="BayesianRVFL2Regressor-151"><a href="#BayesianRVFL2Regressor-151"><span class="linenos">151</span></a>
</span><span id="BayesianRVFL2Regressor-152"><a href="#BayesianRVFL2Regressor-152"><span class="linenos">152</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="BayesianRVFL2Regressor-153"><a href="#BayesianRVFL2Regressor-153"><span class="linenos">153</span></a><span class="sd">                Target values</span>
</span><span id="BayesianRVFL2Regressor-154"><a href="#BayesianRVFL2Regressor-154"><span class="linenos">154</span></a>
</span><span id="BayesianRVFL2Regressor-155"><a href="#BayesianRVFL2Regressor-155"><span class="linenos">155</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="BayesianRVFL2Regressor-156"><a href="#BayesianRVFL2Regressor-156"><span class="linenos">156</span></a><span class="sd">                    self.cook_training_set</span>
</span><span id="BayesianRVFL2Regressor-157"><a href="#BayesianRVFL2Regressor-157"><span class="linenos">157</span></a>
</span><span id="BayesianRVFL2Regressor-158"><a href="#BayesianRVFL2Regressor-158"><span class="linenos">158</span></a><span class="sd">        Returns:</span>
</span><span id="BayesianRVFL2Regressor-159"><a href="#BayesianRVFL2Regressor-159"><span class="linenos">159</span></a>
</span><span id="BayesianRVFL2Regressor-160"><a href="#BayesianRVFL2Regressor-160"><span class="linenos">160</span></a><span class="sd">            self: object</span>
</span><span id="BayesianRVFL2Regressor-161"><a href="#BayesianRVFL2Regressor-161"><span class="linenos">161</span></a>
</span><span id="BayesianRVFL2Regressor-162"><a href="#BayesianRVFL2Regressor-162"><span class="linenos">162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BayesianRVFL2Regressor-163"><a href="#BayesianRVFL2Regressor-163"><span class="linenos">163</span></a>
</span><span id="BayesianRVFL2Regressor-164"><a href="#BayesianRVFL2Regressor-164"><span class="linenos">164</span></a>        <span class="n">centered_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BayesianRVFL2Regressor-165"><a href="#BayesianRVFL2Regressor-165"><span class="linenos">165</span></a>
</span><span id="BayesianRVFL2Regressor-166"><a href="#BayesianRVFL2Regressor-166"><span class="linenos">166</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="BayesianRVFL2Regressor-167"><a href="#BayesianRVFL2Regressor-167"><span class="linenos">167</span></a>        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span>
</span><span id="BayesianRVFL2Regressor-168"><a href="#BayesianRVFL2Regressor-168"><span class="linenos">168</span></a>
</span><span id="BayesianRVFL2Regressor-169"><a href="#BayesianRVFL2Regressor-169"><span class="linenos">169</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="BayesianRVFL2Regressor-170"><a href="#BayesianRVFL2Regressor-170"><span class="linenos">170</span></a>            <span class="n">r</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span>
</span><span id="BayesianRVFL2Regressor-171"><a href="#BayesianRVFL2Regressor-171"><span class="linenos">171</span></a>
</span><span id="BayesianRVFL2Regressor-172"><a href="#BayesianRVFL2Regressor-172"><span class="linenos">172</span></a>            <span class="n">block11</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span><span id="BayesianRVFL2Regressor-173"><a href="#BayesianRVFL2Regressor-173"><span class="linenos">173</span></a>            <span class="n">block12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>
</span><span id="BayesianRVFL2Regressor-174"><a href="#BayesianRVFL2Regressor-174"><span class="linenos">174</span></a>            <span class="n">block21</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>
</span><span id="BayesianRVFL2Regressor-175"><a href="#BayesianRVFL2Regressor-175"><span class="linenos">175</span></a>            <span class="n">block22</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</span><span id="BayesianRVFL2Regressor-176"><a href="#BayesianRVFL2Regressor-176"><span class="linenos">176</span></a>
</span><span id="BayesianRVFL2Regressor-177"><a href="#BayesianRVFL2Regressor-177"><span class="linenos">177</span></a>            <span class="n">Sigma_prior</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="BayesianRVFL2Regressor-178"><a href="#BayesianRVFL2Regressor-178"><span class="linenos">178</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">block11</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">block12</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="BayesianRVFL2Regressor-179"><a href="#BayesianRVFL2Regressor-179"><span class="linenos">179</span></a>                <span class="n">y</span><span class="o">=</span><span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">block21</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">block22</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="BayesianRVFL2Regressor-180"><a href="#BayesianRVFL2Regressor-180"><span class="linenos">180</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-181"><a href="#BayesianRVFL2Regressor-181"><span class="linenos">181</span></a>            <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor-182"><a href="#BayesianRVFL2Regressor-182"><span class="linenos">182</span></a>
</span><span id="BayesianRVFL2Regressor-183"><a href="#BayesianRVFL2Regressor-183"><span class="linenos">183</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BayesianRVFL2Regressor-184"><a href="#BayesianRVFL2Regressor-184"><span class="linenos">184</span></a>            <span class="n">Sigma_prior</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</span><span id="BayesianRVFL2Regressor-185"><a href="#BayesianRVFL2Regressor-185"><span class="linenos">185</span></a>
</span><span id="BayesianRVFL2Regressor-186"><a href="#BayesianRVFL2Regressor-186"><span class="linenos">186</span></a>        <span class="n">fit_obj</span> <span class="o">=</span> <span class="n">lmf</span><span class="o">.</span><span class="n">beta_Sigma_hat_rvfl2</span><span class="p">(</span>
</span><span id="BayesianRVFL2Regressor-187"><a href="#BayesianRVFL2Regressor-187"><span class="linenos">187</span></a>            <span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-188"><a href="#BayesianRVFL2Regressor-188"><span class="linenos">188</span></a>            <span class="n">y</span><span class="o">=</span><span class="n">centered_y</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-189"><a href="#BayesianRVFL2Regressor-189"><span class="linenos">189</span></a>            <span class="n">Sigma</span><span class="o">=</span><span class="n">Sigma_prior</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-190"><a href="#BayesianRVFL2Regressor-190"><span class="linenos">190</span></a>            <span class="n">sigma</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-191"><a href="#BayesianRVFL2Regressor-191"><span class="linenos">191</span></a>            <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-192"><a href="#BayesianRVFL2Regressor-192"><span class="linenos">192</span></a>            <span class="n">return_cov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">return_std</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-193"><a href="#BayesianRVFL2Regressor-193"><span class="linenos">193</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-194"><a href="#BayesianRVFL2Regressor-194"><span class="linenos">194</span></a>        <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor-195"><a href="#BayesianRVFL2Regressor-195"><span class="linenos">195</span></a>
</span><span id="BayesianRVFL2Regressor-196"><a href="#BayesianRVFL2Regressor-196"><span class="linenos">196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="p">[</span><span class="s2">&quot;beta_hat&quot;</span><span class="p">]</span>
</span><span id="BayesianRVFL2Regressor-197"><a href="#BayesianRVFL2Regressor-197"><span class="linenos">197</span></a>
</span><span id="BayesianRVFL2Regressor-198"><a href="#BayesianRVFL2Regressor-198"><span class="linenos">198</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="BayesianRVFL2Regressor-199"><a href="#BayesianRVFL2Regressor-199"><span class="linenos">199</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">Sigma_</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="p">[</span><span class="s2">&quot;Sigma_hat&quot;</span><span class="p">]</span>
</span><span id="BayesianRVFL2Regressor-200"><a href="#BayesianRVFL2Regressor-200"><span class="linenos">200</span></a>
</span><span id="BayesianRVFL2Regressor-201"><a href="#BayesianRVFL2Regressor-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">GCV_</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="p">[</span><span class="s2">&quot;GCV&quot;</span><span class="p">]</span>
</span><span id="BayesianRVFL2Regressor-202"><a href="#BayesianRVFL2Regressor-202"><span class="linenos">202</span></a>
</span><span id="BayesianRVFL2Regressor-203"><a href="#BayesianRVFL2Regressor-203"><span class="linenos">203</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="BayesianRVFL2Regressor-204"><a href="#BayesianRVFL2Regressor-204"><span class="linenos">204</span></a>
</span><span id="BayesianRVFL2Regressor-205"><a href="#BayesianRVFL2Regressor-205"><span class="linenos">205</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BayesianRVFL2Regressor-206"><a href="#BayesianRVFL2Regressor-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="BayesianRVFL2Regressor-207"><a href="#BayesianRVFL2Regressor-207"><span class="linenos">207</span></a>
</span><span id="BayesianRVFL2Regressor-208"><a href="#BayesianRVFL2Regressor-208"><span class="linenos">208</span></a><span class="sd">        Parameters:</span>
</span><span id="BayesianRVFL2Regressor-209"><a href="#BayesianRVFL2Regressor-209"><span class="linenos">209</span></a>
</span><span id="BayesianRVFL2Regressor-210"><a href="#BayesianRVFL2Regressor-210"><span class="linenos">210</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="BayesianRVFL2Regressor-211"><a href="#BayesianRVFL2Regressor-211"><span class="linenos">211</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="BayesianRVFL2Regressor-212"><a href="#BayesianRVFL2Regressor-212"><span class="linenos">212</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="BayesianRVFL2Regressor-213"><a href="#BayesianRVFL2Regressor-213"><span class="linenos">213</span></a>
</span><span id="BayesianRVFL2Regressor-214"><a href="#BayesianRVFL2Regressor-214"><span class="linenos">214</span></a><span class="sd">            return_std: {boolean}, standard dev. is returned or not</span>
</span><span id="BayesianRVFL2Regressor-215"><a href="#BayesianRVFL2Regressor-215"><span class="linenos">215</span></a>
</span><span id="BayesianRVFL2Regressor-216"><a href="#BayesianRVFL2Regressor-216"><span class="linenos">216</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="BayesianRVFL2Regressor-217"><a href="#BayesianRVFL2Regressor-217"><span class="linenos">217</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="BayesianRVFL2Regressor-218"><a href="#BayesianRVFL2Regressor-218"><span class="linenos">218</span></a>
</span><span id="BayesianRVFL2Regressor-219"><a href="#BayesianRVFL2Regressor-219"><span class="linenos">219</span></a><span class="sd">        Returns:</span>
</span><span id="BayesianRVFL2Regressor-220"><a href="#BayesianRVFL2Regressor-220"><span class="linenos">220</span></a>
</span><span id="BayesianRVFL2Regressor-221"><a href="#BayesianRVFL2Regressor-221"><span class="linenos">221</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="BayesianRVFL2Regressor-222"><a href="#BayesianRVFL2Regressor-222"><span class="linenos">222</span></a>
</span><span id="BayesianRVFL2Regressor-223"><a href="#BayesianRVFL2Regressor-223"><span class="linenos">223</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BayesianRVFL2Regressor-224"><a href="#BayesianRVFL2Regressor-224"><span class="linenos">224</span></a>
</span><span id="BayesianRVFL2Regressor-225"><a href="#BayesianRVFL2Regressor-225"><span class="linenos">225</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># one observation in the test set only</span>
</span><span id="BayesianRVFL2Regressor-226"><a href="#BayesianRVFL2Regressor-226"><span class="linenos">226</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="BayesianRVFL2Regressor-227"><a href="#BayesianRVFL2Regressor-227"><span class="linenos">227</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="BayesianRVFL2Regressor-228"><a href="#BayesianRVFL2Regressor-228"><span class="linenos">228</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="BayesianRVFL2Regressor-229"><a href="#BayesianRVFL2Regressor-229"><span class="linenos">229</span></a>                <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="BayesianRVFL2Regressor-230"><a href="#BayesianRVFL2Regressor-230"><span class="linenos">230</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-231"><a href="#BayesianRVFL2Regressor-231"><span class="linenos">231</span></a>            <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor-232"><a href="#BayesianRVFL2Regressor-232"><span class="linenos">232</span></a>
</span><span id="BayesianRVFL2Regressor-233"><a href="#BayesianRVFL2Regressor-233"><span class="linenos">233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">=</span> <span class="n">return_std</span>
</span><span id="BayesianRVFL2Regressor-234"><a href="#BayesianRVFL2Regressor-234"><span class="linenos">234</span></a>
</span><span id="BayesianRVFL2Regressor-235"><a href="#BayesianRVFL2Regressor-235"><span class="linenos">235</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="BayesianRVFL2Regressor-236"><a href="#BayesianRVFL2Regressor-236"><span class="linenos">236</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BayesianRVFL2Regressor-237"><a href="#BayesianRVFL2Regressor-237"><span class="linenos">237</span></a>                <span class="k">return</span> <span class="p">(</span>
</span><span id="BayesianRVFL2Regressor-238"><a href="#BayesianRVFL2Regressor-238"><span class="linenos">238</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span>
</span><span id="BayesianRVFL2Regressor-239"><a href="#BayesianRVFL2Regressor-239"><span class="linenos">239</span></a>                    <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="BayesianRVFL2Regressor-240"><a href="#BayesianRVFL2Regressor-240"><span class="linenos">240</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="BayesianRVFL2Regressor-241"><a href="#BayesianRVFL2Regressor-241"><span class="linenos">241</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-242"><a href="#BayesianRVFL2Regressor-242"><span class="linenos">242</span></a>                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-243"><a href="#BayesianRVFL2Regressor-243"><span class="linenos">243</span></a>                    <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor-244"><a href="#BayesianRVFL2Regressor-244"><span class="linenos">244</span></a>                <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="BayesianRVFL2Regressor-245"><a href="#BayesianRVFL2Regressor-245"><span class="linenos">245</span></a>
</span><span id="BayesianRVFL2Regressor-246"><a href="#BayesianRVFL2Regressor-246"><span class="linenos">246</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="BayesianRVFL2Regressor-247"><a href="#BayesianRVFL2Regressor-247"><span class="linenos">247</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="BayesianRVFL2Regressor-248"><a href="#BayesianRVFL2Regressor-248"><span class="linenos">248</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-249"><a href="#BayesianRVFL2Regressor-249"><span class="linenos">249</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-250"><a href="#BayesianRVFL2Regressor-250"><span class="linenos">250</span></a>            <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor-251"><a href="#BayesianRVFL2Regressor-251"><span class="linenos">251</span></a>
</span><span id="BayesianRVFL2Regressor-252"><a href="#BayesianRVFL2Regressor-252"><span class="linenos">252</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># confidence interval required for preds?</span>
</span><span id="BayesianRVFL2Regressor-253"><a href="#BayesianRVFL2Regressor-253"><span class="linenos">253</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BayesianRVFL2Regressor-254"><a href="#BayesianRVFL2Regressor-254"><span class="linenos">254</span></a>                <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BayesianRVFL2Regressor-255"><a href="#BayesianRVFL2Regressor-255"><span class="linenos">255</span></a>
</span><span id="BayesianRVFL2Regressor-256"><a href="#BayesianRVFL2Regressor-256"><span class="linenos">256</span></a>                <span class="n">pred_obj</span> <span class="o">=</span> <span class="n">lmf</span><span class="o">.</span><span class="n">beta_Sigma_hat_rvfl2</span><span class="p">(</span>
</span><span id="BayesianRVFL2Regressor-257"><a href="#BayesianRVFL2Regressor-257"><span class="linenos">257</span></a>                    <span class="n">X_star</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-258"><a href="#BayesianRVFL2Regressor-258"><span class="linenos">258</span></a>                    <span class="n">return_cov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">return_std</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-259"><a href="#BayesianRVFL2Regressor-259"><span class="linenos">259</span></a>                    <span class="n">beta_hat_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-260"><a href="#BayesianRVFL2Regressor-260"><span class="linenos">260</span></a>                    <span class="n">Sigma_hat_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sigma_</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-261"><a href="#BayesianRVFL2Regressor-261"><span class="linenos">261</span></a>                    <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-262"><a href="#BayesianRVFL2Regressor-262"><span class="linenos">262</span></a>                <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor-263"><a href="#BayesianRVFL2Regressor-263"><span class="linenos">263</span></a>
</span><span id="BayesianRVFL2Regressor-264"><a href="#BayesianRVFL2Regressor-264"><span class="linenos">264</span></a>                <span class="k">return</span> <span class="p">(</span>
</span><span id="BayesianRVFL2Regressor-265"><a href="#BayesianRVFL2Regressor-265"><span class="linenos">265</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">pred_obj</span><span class="p">[</span><span class="s2">&quot;preds&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="BayesianRVFL2Regressor-266"><a href="#BayesianRVFL2Regressor-266"><span class="linenos">266</span></a>                    <span class="n">pred_obj</span><span class="p">[</span><span class="s2">&quot;preds_std&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="BayesianRVFL2Regressor-267"><a href="#BayesianRVFL2Regressor-267"><span class="linenos">267</span></a>                <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor-268"><a href="#BayesianRVFL2Regressor-268"><span class="linenos">268</span></a>
</span><span id="BayesianRVFL2Regressor-269"><a href="#BayesianRVFL2Regressor-269"><span class="linenos">269</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BayesianRVFL2Regressor-270"><a href="#BayesianRVFL2Regressor-270"><span class="linenos">270</span></a>
</span><span id="BayesianRVFL2Regressor-271"><a href="#BayesianRVFL2Regressor-271"><span class="linenos">271</span></a>            <span class="n">pred_obj</span> <span class="o">=</span> <span class="n">lmf</span><span class="o">.</span><span class="n">beta_Sigma_hat_rvfl2</span><span class="p">(</span>
</span><span id="BayesianRVFL2Regressor-272"><a href="#BayesianRVFL2Regressor-272"><span class="linenos">272</span></a>                <span class="n">X_star</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-273"><a href="#BayesianRVFL2Regressor-273"><span class="linenos">273</span></a>                <span class="n">return_cov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">return_std</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-274"><a href="#BayesianRVFL2Regressor-274"><span class="linenos">274</span></a>                <span class="n">beta_hat_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-275"><a href="#BayesianRVFL2Regressor-275"><span class="linenos">275</span></a>                <span class="n">Sigma_hat_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sigma_</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-276"><a href="#BayesianRVFL2Regressor-276"><span class="linenos">276</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor-277"><a href="#BayesianRVFL2Regressor-277"><span class="linenos">277</span></a>            <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor-278"><a href="#BayesianRVFL2Regressor-278"><span class="linenos">278</span></a>
</span><span id="BayesianRVFL2Regressor-279"><a href="#BayesianRVFL2Regressor-279"><span class="linenos">279</span></a>            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">pred_obj</span><span class="p">[</span><span class="s2">&quot;preds&quot;</span><span class="p">],</span> <span class="n">pred_obj</span><span class="p">[</span><span class="s2">&quot;preds_std&quot;</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Bayesian Random Vector Functional Link Network regression with two priors</p>

<p>Parameters:</p>

<pre><code>n_hidden_features: int
    number of nodes in the hidden layer

activation_name: str
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'

a: float
    hyperparameter for 'prelu' or 'elu' activation function

nodes_sim: str
    type of simulation for the nodes: 'sobol', 'hammersley', 'halton', 'uniform'

bias: boolean
    indicates if the hidden layer contains a bias term (True) or not (False)

dropout: float
    regularization parameter; (random) percentage of nodes dropped out
    of the training

direct_link: boolean
    indicates if the original features are included (True) in model''s fitting or not (False)

n_clusters: int
    number of clusters for 'kmeans' or 'gmm' clustering (could be 0: no clustering)

cluster_encode: bool
    defines how the variable containing clusters is treated (default is one-hot)
    if `False`, then labels are used, without one-hot encoding

type_clust: str
    type of clustering method: currently k-means ('kmeans') or Gaussian Mixture Model ('gmm')

type_scaling: a tuple of 3 strings
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax')

seed: int
    reproducibility seed for nodes_sim=='uniform'

s1: float
    std. dev. of init. regression parameters in Bayesian Ridge Regression

s2: float
    std. dev. of augmented regression parameters in Bayesian Ridge Regression

sigma: float
    std. dev. of residuals in Bayesian Ridge Regression

return_std: boolean
    if True, uncertainty around predictions is evaluated

backend: str
    "cpu" or "gpu" or "tpu"
</code></pre>

<p>Attributes:</p>

<pre><code>beta_: array-like
    regression''s coefficients

Sigma_: array-like
    covariance of the distribution of fitted parameters

GCV_: float
    Generalized cross-validation error

y_mean_: float
    average response
</code></pre>

<p>Examples:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">TBD</span>
</code></pre>
</div>
</div>


                                <div id="BayesianRVFL2Regressor.fit" class="classattr">
                                            <input id="BayesianRVFL2Regressor.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BayesianRVFL2Regressor.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BayesianRVFL2Regressor.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BayesianRVFL2Regressor.fit-143"><a href="#BayesianRVFL2Regressor.fit-143"><span class="linenos">143</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BayesianRVFL2Regressor.fit-144"><a href="#BayesianRVFL2Regressor.fit-144"><span class="linenos">144</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit BayesianRVFL2Regressor to training data (X, y)</span>
</span><span id="BayesianRVFL2Regressor.fit-145"><a href="#BayesianRVFL2Regressor.fit-145"><span class="linenos">145</span></a>
</span><span id="BayesianRVFL2Regressor.fit-146"><a href="#BayesianRVFL2Regressor.fit-146"><span class="linenos">146</span></a><span class="sd">        Parameters:</span>
</span><span id="BayesianRVFL2Regressor.fit-147"><a href="#BayesianRVFL2Regressor.fit-147"><span class="linenos">147</span></a>
</span><span id="BayesianRVFL2Regressor.fit-148"><a href="#BayesianRVFL2Regressor.fit-148"><span class="linenos">148</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="BayesianRVFL2Regressor.fit-149"><a href="#BayesianRVFL2Regressor.fit-149"><span class="linenos">149</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="BayesianRVFL2Regressor.fit-150"><a href="#BayesianRVFL2Regressor.fit-150"><span class="linenos">150</span></a><span class="sd">                of samples and n_features is the number of features</span>
</span><span id="BayesianRVFL2Regressor.fit-151"><a href="#BayesianRVFL2Regressor.fit-151"><span class="linenos">151</span></a>
</span><span id="BayesianRVFL2Regressor.fit-152"><a href="#BayesianRVFL2Regressor.fit-152"><span class="linenos">152</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="BayesianRVFL2Regressor.fit-153"><a href="#BayesianRVFL2Regressor.fit-153"><span class="linenos">153</span></a><span class="sd">                Target values</span>
</span><span id="BayesianRVFL2Regressor.fit-154"><a href="#BayesianRVFL2Regressor.fit-154"><span class="linenos">154</span></a>
</span><span id="BayesianRVFL2Regressor.fit-155"><a href="#BayesianRVFL2Regressor.fit-155"><span class="linenos">155</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="BayesianRVFL2Regressor.fit-156"><a href="#BayesianRVFL2Regressor.fit-156"><span class="linenos">156</span></a><span class="sd">                    self.cook_training_set</span>
</span><span id="BayesianRVFL2Regressor.fit-157"><a href="#BayesianRVFL2Regressor.fit-157"><span class="linenos">157</span></a>
</span><span id="BayesianRVFL2Regressor.fit-158"><a href="#BayesianRVFL2Regressor.fit-158"><span class="linenos">158</span></a><span class="sd">        Returns:</span>
</span><span id="BayesianRVFL2Regressor.fit-159"><a href="#BayesianRVFL2Regressor.fit-159"><span class="linenos">159</span></a>
</span><span id="BayesianRVFL2Regressor.fit-160"><a href="#BayesianRVFL2Regressor.fit-160"><span class="linenos">160</span></a><span class="sd">            self: object</span>
</span><span id="BayesianRVFL2Regressor.fit-161"><a href="#BayesianRVFL2Regressor.fit-161"><span class="linenos">161</span></a>
</span><span id="BayesianRVFL2Regressor.fit-162"><a href="#BayesianRVFL2Regressor.fit-162"><span class="linenos">162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BayesianRVFL2Regressor.fit-163"><a href="#BayesianRVFL2Regressor.fit-163"><span class="linenos">163</span></a>
</span><span id="BayesianRVFL2Regressor.fit-164"><a href="#BayesianRVFL2Regressor.fit-164"><span class="linenos">164</span></a>        <span class="n">centered_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BayesianRVFL2Regressor.fit-165"><a href="#BayesianRVFL2Regressor.fit-165"><span class="linenos">165</span></a>
</span><span id="BayesianRVFL2Regressor.fit-166"><a href="#BayesianRVFL2Regressor.fit-166"><span class="linenos">166</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="BayesianRVFL2Regressor.fit-167"><a href="#BayesianRVFL2Regressor.fit-167"><span class="linenos">167</span></a>        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span>
</span><span id="BayesianRVFL2Regressor.fit-168"><a href="#BayesianRVFL2Regressor.fit-168"><span class="linenos">168</span></a>
</span><span id="BayesianRVFL2Regressor.fit-169"><a href="#BayesianRVFL2Regressor.fit-169"><span class="linenos">169</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="BayesianRVFL2Regressor.fit-170"><a href="#BayesianRVFL2Regressor.fit-170"><span class="linenos">170</span></a>            <span class="n">r</span> <span class="o">=</span> <span class="n">p</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span>
</span><span id="BayesianRVFL2Regressor.fit-171"><a href="#BayesianRVFL2Regressor.fit-171"><span class="linenos">171</span></a>
</span><span id="BayesianRVFL2Regressor.fit-172"><a href="#BayesianRVFL2Regressor.fit-172"><span class="linenos">172</span></a>            <span class="n">block11</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span><span id="BayesianRVFL2Regressor.fit-173"><a href="#BayesianRVFL2Regressor.fit-173"><span class="linenos">173</span></a>            <span class="n">block12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">r</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>
</span><span id="BayesianRVFL2Regressor.fit-174"><a href="#BayesianRVFL2Regressor.fit-174"><span class="linenos">174</span></a>            <span class="n">block21</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">))</span>
</span><span id="BayesianRVFL2Regressor.fit-175"><a href="#BayesianRVFL2Regressor.fit-175"><span class="linenos">175</span></a>            <span class="n">block22</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</span><span id="BayesianRVFL2Regressor.fit-176"><a href="#BayesianRVFL2Regressor.fit-176"><span class="linenos">176</span></a>
</span><span id="BayesianRVFL2Regressor.fit-177"><a href="#BayesianRVFL2Regressor.fit-177"><span class="linenos">177</span></a>            <span class="n">Sigma_prior</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="BayesianRVFL2Regressor.fit-178"><a href="#BayesianRVFL2Regressor.fit-178"><span class="linenos">178</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">block11</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">block12</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="BayesianRVFL2Regressor.fit-179"><a href="#BayesianRVFL2Regressor.fit-179"><span class="linenos">179</span></a>                <span class="n">y</span><span class="o">=</span><span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">block21</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">block22</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="BayesianRVFL2Regressor.fit-180"><a href="#BayesianRVFL2Regressor.fit-180"><span class="linenos">180</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.fit-181"><a href="#BayesianRVFL2Regressor.fit-181"><span class="linenos">181</span></a>            <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor.fit-182"><a href="#BayesianRVFL2Regressor.fit-182"><span class="linenos">182</span></a>
</span><span id="BayesianRVFL2Regressor.fit-183"><a href="#BayesianRVFL2Regressor.fit-183"><span class="linenos">183</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BayesianRVFL2Regressor.fit-184"><a href="#BayesianRVFL2Regressor.fit-184"><span class="linenos">184</span></a>            <span class="n">Sigma_prior</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</span><span id="BayesianRVFL2Regressor.fit-185"><a href="#BayesianRVFL2Regressor.fit-185"><span class="linenos">185</span></a>
</span><span id="BayesianRVFL2Regressor.fit-186"><a href="#BayesianRVFL2Regressor.fit-186"><span class="linenos">186</span></a>        <span class="n">fit_obj</span> <span class="o">=</span> <span class="n">lmf</span><span class="o">.</span><span class="n">beta_Sigma_hat_rvfl2</span><span class="p">(</span>
</span><span id="BayesianRVFL2Regressor.fit-187"><a href="#BayesianRVFL2Regressor.fit-187"><span class="linenos">187</span></a>            <span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.fit-188"><a href="#BayesianRVFL2Regressor.fit-188"><span class="linenos">188</span></a>            <span class="n">y</span><span class="o">=</span><span class="n">centered_y</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.fit-189"><a href="#BayesianRVFL2Regressor.fit-189"><span class="linenos">189</span></a>            <span class="n">Sigma</span><span class="o">=</span><span class="n">Sigma_prior</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.fit-190"><a href="#BayesianRVFL2Regressor.fit-190"><span class="linenos">190</span></a>            <span class="n">sigma</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.fit-191"><a href="#BayesianRVFL2Regressor.fit-191"><span class="linenos">191</span></a>            <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.fit-192"><a href="#BayesianRVFL2Regressor.fit-192"><span class="linenos">192</span></a>            <span class="n">return_cov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">return_std</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.fit-193"><a href="#BayesianRVFL2Regressor.fit-193"><span class="linenos">193</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.fit-194"><a href="#BayesianRVFL2Regressor.fit-194"><span class="linenos">194</span></a>        <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor.fit-195"><a href="#BayesianRVFL2Regressor.fit-195"><span class="linenos">195</span></a>
</span><span id="BayesianRVFL2Regressor.fit-196"><a href="#BayesianRVFL2Regressor.fit-196"><span class="linenos">196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="p">[</span><span class="s2">&quot;beta_hat&quot;</span><span class="p">]</span>
</span><span id="BayesianRVFL2Regressor.fit-197"><a href="#BayesianRVFL2Regressor.fit-197"><span class="linenos">197</span></a>
</span><span id="BayesianRVFL2Regressor.fit-198"><a href="#BayesianRVFL2Regressor.fit-198"><span class="linenos">198</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="BayesianRVFL2Regressor.fit-199"><a href="#BayesianRVFL2Regressor.fit-199"><span class="linenos">199</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">Sigma_</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="p">[</span><span class="s2">&quot;Sigma_hat&quot;</span><span class="p">]</span>
</span><span id="BayesianRVFL2Regressor.fit-200"><a href="#BayesianRVFL2Regressor.fit-200"><span class="linenos">200</span></a>
</span><span id="BayesianRVFL2Regressor.fit-201"><a href="#BayesianRVFL2Regressor.fit-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">GCV_</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="p">[</span><span class="s2">&quot;GCV&quot;</span><span class="p">]</span>
</span><span id="BayesianRVFL2Regressor.fit-202"><a href="#BayesianRVFL2Regressor.fit-202"><span class="linenos">202</span></a>
</span><span id="BayesianRVFL2Regressor.fit-203"><a href="#BayesianRVFL2Regressor.fit-203"><span class="linenos">203</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit BayesianRVFL2Regressor to training data (X, y)</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features

y: array-like, shape = [n_samples]
    Target values

**kwargs: additional parameters to be passed to
        self.cook_training_set
</code></pre>

<p>Returns:</p>

<pre><code>self: object
</code></pre>
</div>


                                </div>
                                <div id="BayesianRVFL2Regressor.predict" class="classattr">
                                            <input id="BayesianRVFL2Regressor.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">return_std</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BayesianRVFL2Regressor.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BayesianRVFL2Regressor.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BayesianRVFL2Regressor.predict-205"><a href="#BayesianRVFL2Regressor.predict-205"><span class="linenos">205</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BayesianRVFL2Regressor.predict-206"><a href="#BayesianRVFL2Regressor.predict-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="BayesianRVFL2Regressor.predict-207"><a href="#BayesianRVFL2Regressor.predict-207"><span class="linenos">207</span></a>
</span><span id="BayesianRVFL2Regressor.predict-208"><a href="#BayesianRVFL2Regressor.predict-208"><span class="linenos">208</span></a><span class="sd">        Parameters:</span>
</span><span id="BayesianRVFL2Regressor.predict-209"><a href="#BayesianRVFL2Regressor.predict-209"><span class="linenos">209</span></a>
</span><span id="BayesianRVFL2Regressor.predict-210"><a href="#BayesianRVFL2Regressor.predict-210"><span class="linenos">210</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="BayesianRVFL2Regressor.predict-211"><a href="#BayesianRVFL2Regressor.predict-211"><span class="linenos">211</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="BayesianRVFL2Regressor.predict-212"><a href="#BayesianRVFL2Regressor.predict-212"><span class="linenos">212</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="BayesianRVFL2Regressor.predict-213"><a href="#BayesianRVFL2Regressor.predict-213"><span class="linenos">213</span></a>
</span><span id="BayesianRVFL2Regressor.predict-214"><a href="#BayesianRVFL2Regressor.predict-214"><span class="linenos">214</span></a><span class="sd">            return_std: {boolean}, standard dev. is returned or not</span>
</span><span id="BayesianRVFL2Regressor.predict-215"><a href="#BayesianRVFL2Regressor.predict-215"><span class="linenos">215</span></a>
</span><span id="BayesianRVFL2Regressor.predict-216"><a href="#BayesianRVFL2Regressor.predict-216"><span class="linenos">216</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="BayesianRVFL2Regressor.predict-217"><a href="#BayesianRVFL2Regressor.predict-217"><span class="linenos">217</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="BayesianRVFL2Regressor.predict-218"><a href="#BayesianRVFL2Regressor.predict-218"><span class="linenos">218</span></a>
</span><span id="BayesianRVFL2Regressor.predict-219"><a href="#BayesianRVFL2Regressor.predict-219"><span class="linenos">219</span></a><span class="sd">        Returns:</span>
</span><span id="BayesianRVFL2Regressor.predict-220"><a href="#BayesianRVFL2Regressor.predict-220"><span class="linenos">220</span></a>
</span><span id="BayesianRVFL2Regressor.predict-221"><a href="#BayesianRVFL2Regressor.predict-221"><span class="linenos">221</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="BayesianRVFL2Regressor.predict-222"><a href="#BayesianRVFL2Regressor.predict-222"><span class="linenos">222</span></a>
</span><span id="BayesianRVFL2Regressor.predict-223"><a href="#BayesianRVFL2Regressor.predict-223"><span class="linenos">223</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BayesianRVFL2Regressor.predict-224"><a href="#BayesianRVFL2Regressor.predict-224"><span class="linenos">224</span></a>
</span><span id="BayesianRVFL2Regressor.predict-225"><a href="#BayesianRVFL2Regressor.predict-225"><span class="linenos">225</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># one observation in the test set only</span>
</span><span id="BayesianRVFL2Regressor.predict-226"><a href="#BayesianRVFL2Regressor.predict-226"><span class="linenos">226</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="BayesianRVFL2Regressor.predict-227"><a href="#BayesianRVFL2Regressor.predict-227"><span class="linenos">227</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="BayesianRVFL2Regressor.predict-228"><a href="#BayesianRVFL2Regressor.predict-228"><span class="linenos">228</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="BayesianRVFL2Regressor.predict-229"><a href="#BayesianRVFL2Regressor.predict-229"><span class="linenos">229</span></a>                <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="BayesianRVFL2Regressor.predict-230"><a href="#BayesianRVFL2Regressor.predict-230"><span class="linenos">230</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.predict-231"><a href="#BayesianRVFL2Regressor.predict-231"><span class="linenos">231</span></a>            <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor.predict-232"><a href="#BayesianRVFL2Regressor.predict-232"><span class="linenos">232</span></a>
</span><span id="BayesianRVFL2Regressor.predict-233"><a href="#BayesianRVFL2Regressor.predict-233"><span class="linenos">233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">=</span> <span class="n">return_std</span>
</span><span id="BayesianRVFL2Regressor.predict-234"><a href="#BayesianRVFL2Regressor.predict-234"><span class="linenos">234</span></a>
</span><span id="BayesianRVFL2Regressor.predict-235"><a href="#BayesianRVFL2Regressor.predict-235"><span class="linenos">235</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_std</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="BayesianRVFL2Regressor.predict-236"><a href="#BayesianRVFL2Regressor.predict-236"><span class="linenos">236</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BayesianRVFL2Regressor.predict-237"><a href="#BayesianRVFL2Regressor.predict-237"><span class="linenos">237</span></a>                <span class="k">return</span> <span class="p">(</span>
</span><span id="BayesianRVFL2Regressor.predict-238"><a href="#BayesianRVFL2Regressor.predict-238"><span class="linenos">238</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span>
</span><span id="BayesianRVFL2Regressor.predict-239"><a href="#BayesianRVFL2Regressor.predict-239"><span class="linenos">239</span></a>                    <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="BayesianRVFL2Regressor.predict-240"><a href="#BayesianRVFL2Regressor.predict-240"><span class="linenos">240</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="BayesianRVFL2Regressor.predict-241"><a href="#BayesianRVFL2Regressor.predict-241"><span class="linenos">241</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.predict-242"><a href="#BayesianRVFL2Regressor.predict-242"><span class="linenos">242</span></a>                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.predict-243"><a href="#BayesianRVFL2Regressor.predict-243"><span class="linenos">243</span></a>                    <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor.predict-244"><a href="#BayesianRVFL2Regressor.predict-244"><span class="linenos">244</span></a>                <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="BayesianRVFL2Regressor.predict-245"><a href="#BayesianRVFL2Regressor.predict-245"><span class="linenos">245</span></a>
</span><span id="BayesianRVFL2Regressor.predict-246"><a href="#BayesianRVFL2Regressor.predict-246"><span class="linenos">246</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="BayesianRVFL2Regressor.predict-247"><a href="#BayesianRVFL2Regressor.predict-247"><span class="linenos">247</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="BayesianRVFL2Regressor.predict-248"><a href="#BayesianRVFL2Regressor.predict-248"><span class="linenos">248</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.predict-249"><a href="#BayesianRVFL2Regressor.predict-249"><span class="linenos">249</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.predict-250"><a href="#BayesianRVFL2Regressor.predict-250"><span class="linenos">250</span></a>            <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor.predict-251"><a href="#BayesianRVFL2Regressor.predict-251"><span class="linenos">251</span></a>
</span><span id="BayesianRVFL2Regressor.predict-252"><a href="#BayesianRVFL2Regressor.predict-252"><span class="linenos">252</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># confidence interval required for preds?</span>
</span><span id="BayesianRVFL2Regressor.predict-253"><a href="#BayesianRVFL2Regressor.predict-253"><span class="linenos">253</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="BayesianRVFL2Regressor.predict-254"><a href="#BayesianRVFL2Regressor.predict-254"><span class="linenos">254</span></a>                <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BayesianRVFL2Regressor.predict-255"><a href="#BayesianRVFL2Regressor.predict-255"><span class="linenos">255</span></a>
</span><span id="BayesianRVFL2Regressor.predict-256"><a href="#BayesianRVFL2Regressor.predict-256"><span class="linenos">256</span></a>                <span class="n">pred_obj</span> <span class="o">=</span> <span class="n">lmf</span><span class="o">.</span><span class="n">beta_Sigma_hat_rvfl2</span><span class="p">(</span>
</span><span id="BayesianRVFL2Regressor.predict-257"><a href="#BayesianRVFL2Regressor.predict-257"><span class="linenos">257</span></a>                    <span class="n">X_star</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.predict-258"><a href="#BayesianRVFL2Regressor.predict-258"><span class="linenos">258</span></a>                    <span class="n">return_cov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">return_std</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.predict-259"><a href="#BayesianRVFL2Regressor.predict-259"><span class="linenos">259</span></a>                    <span class="n">beta_hat_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.predict-260"><a href="#BayesianRVFL2Regressor.predict-260"><span class="linenos">260</span></a>                    <span class="n">Sigma_hat_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sigma_</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.predict-261"><a href="#BayesianRVFL2Regressor.predict-261"><span class="linenos">261</span></a>                    <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.predict-262"><a href="#BayesianRVFL2Regressor.predict-262"><span class="linenos">262</span></a>                <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor.predict-263"><a href="#BayesianRVFL2Regressor.predict-263"><span class="linenos">263</span></a>
</span><span id="BayesianRVFL2Regressor.predict-264"><a href="#BayesianRVFL2Regressor.predict-264"><span class="linenos">264</span></a>                <span class="k">return</span> <span class="p">(</span>
</span><span id="BayesianRVFL2Regressor.predict-265"><a href="#BayesianRVFL2Regressor.predict-265"><span class="linenos">265</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">pred_obj</span><span class="p">[</span><span class="s2">&quot;preds&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="BayesianRVFL2Regressor.predict-266"><a href="#BayesianRVFL2Regressor.predict-266"><span class="linenos">266</span></a>                    <span class="n">pred_obj</span><span class="p">[</span><span class="s2">&quot;preds_std&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
</span><span id="BayesianRVFL2Regressor.predict-267"><a href="#BayesianRVFL2Regressor.predict-267"><span class="linenos">267</span></a>                <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor.predict-268"><a href="#BayesianRVFL2Regressor.predict-268"><span class="linenos">268</span></a>
</span><span id="BayesianRVFL2Regressor.predict-269"><a href="#BayesianRVFL2Regressor.predict-269"><span class="linenos">269</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BayesianRVFL2Regressor.predict-270"><a href="#BayesianRVFL2Regressor.predict-270"><span class="linenos">270</span></a>
</span><span id="BayesianRVFL2Regressor.predict-271"><a href="#BayesianRVFL2Regressor.predict-271"><span class="linenos">271</span></a>            <span class="n">pred_obj</span> <span class="o">=</span> <span class="n">lmf</span><span class="o">.</span><span class="n">beta_Sigma_hat_rvfl2</span><span class="p">(</span>
</span><span id="BayesianRVFL2Regressor.predict-272"><a href="#BayesianRVFL2Regressor.predict-272"><span class="linenos">272</span></a>                <span class="n">X_star</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.predict-273"><a href="#BayesianRVFL2Regressor.predict-273"><span class="linenos">273</span></a>                <span class="n">return_cov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">return_std</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.predict-274"><a href="#BayesianRVFL2Regressor.predict-274"><span class="linenos">274</span></a>                <span class="n">beta_hat_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.predict-275"><a href="#BayesianRVFL2Regressor.predict-275"><span class="linenos">275</span></a>                <span class="n">Sigma_hat_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Sigma_</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.predict-276"><a href="#BayesianRVFL2Regressor.predict-276"><span class="linenos">276</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="BayesianRVFL2Regressor.predict-277"><a href="#BayesianRVFL2Regressor.predict-277"><span class="linenos">277</span></a>            <span class="p">)</span>
</span><span id="BayesianRVFL2Regressor.predict-278"><a href="#BayesianRVFL2Regressor.predict-278"><span class="linenos">278</span></a>
</span><span id="BayesianRVFL2Regressor.predict-279"><a href="#BayesianRVFL2Regressor.predict-279"><span class="linenos">279</span></a>            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">pred_obj</span><span class="p">[</span><span class="s2">&quot;preds&quot;</span><span class="p">],</span> <span class="n">pred_obj</span><span class="p">[</span><span class="s2">&quot;preds_std&quot;</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Predict test data X.</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

return_std: {boolean}, standard dev. is returned or not

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>model predictions: {array-like}
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="CustomClassifier">
                            <input id="CustomClassifier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CustomClassifier</span><wbr>(<span class="base">nnetsauce.custom.custom.Custom</span>, <span class="base">sklearn.base.ClassifierMixin</span>):

                <label class="view-source-button" for="CustomClassifier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CustomClassifier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CustomClassifier-13"><a href="#CustomClassifier-13"><span class="linenos"> 13</span></a><span class="k">class</span> <span class="nc">CustomClassifier</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">):</span>
</span><span id="CustomClassifier-14"><a href="#CustomClassifier-14"><span class="linenos"> 14</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom Classification model</span>
</span><span id="CustomClassifier-15"><a href="#CustomClassifier-15"><span class="linenos"> 15</span></a>
</span><span id="CustomClassifier-16"><a href="#CustomClassifier-16"><span class="linenos"> 16</span></a><span class="sd">    Attributes:</span>
</span><span id="CustomClassifier-17"><a href="#CustomClassifier-17"><span class="linenos"> 17</span></a>
</span><span id="CustomClassifier-18"><a href="#CustomClassifier-18"><span class="linenos"> 18</span></a><span class="sd">        obj: object</span>
</span><span id="CustomClassifier-19"><a href="#CustomClassifier-19"><span class="linenos"> 19</span></a><span class="sd">            any object containing a method fit (obj.fit()) and a method predict</span>
</span><span id="CustomClassifier-20"><a href="#CustomClassifier-20"><span class="linenos"> 20</span></a><span class="sd">            (obj.predict())</span>
</span><span id="CustomClassifier-21"><a href="#CustomClassifier-21"><span class="linenos"> 21</span></a>
</span><span id="CustomClassifier-22"><a href="#CustomClassifier-22"><span class="linenos"> 22</span></a><span class="sd">        n_hidden_features: int</span>
</span><span id="CustomClassifier-23"><a href="#CustomClassifier-23"><span class="linenos"> 23</span></a><span class="sd">            number of nodes in the hidden layer</span>
</span><span id="CustomClassifier-24"><a href="#CustomClassifier-24"><span class="linenos"> 24</span></a>
</span><span id="CustomClassifier-25"><a href="#CustomClassifier-25"><span class="linenos"> 25</span></a><span class="sd">        activation_name: str</span>
</span><span id="CustomClassifier-26"><a href="#CustomClassifier-26"><span class="linenos"> 26</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;</span>
</span><span id="CustomClassifier-27"><a href="#CustomClassifier-27"><span class="linenos"> 27</span></a>
</span><span id="CustomClassifier-28"><a href="#CustomClassifier-28"><span class="linenos"> 28</span></a><span class="sd">        a: float</span>
</span><span id="CustomClassifier-29"><a href="#CustomClassifier-29"><span class="linenos"> 29</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function</span>
</span><span id="CustomClassifier-30"><a href="#CustomClassifier-30"><span class="linenos"> 30</span></a>
</span><span id="CustomClassifier-31"><a href="#CustomClassifier-31"><span class="linenos"> 31</span></a><span class="sd">        nodes_sim: str</span>
</span><span id="CustomClassifier-32"><a href="#CustomClassifier-32"><span class="linenos"> 32</span></a><span class="sd">            type of simulation for the nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;,</span>
</span><span id="CustomClassifier-33"><a href="#CustomClassifier-33"><span class="linenos"> 33</span></a><span class="sd">            &#39;uniform&#39;</span>
</span><span id="CustomClassifier-34"><a href="#CustomClassifier-34"><span class="linenos"> 34</span></a>
</span><span id="CustomClassifier-35"><a href="#CustomClassifier-35"><span class="linenos"> 35</span></a><span class="sd">        bias: boolean</span>
</span><span id="CustomClassifier-36"><a href="#CustomClassifier-36"><span class="linenos"> 36</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or not</span>
</span><span id="CustomClassifier-37"><a href="#CustomClassifier-37"><span class="linenos"> 37</span></a><span class="sd">            (False)</span>
</span><span id="CustomClassifier-38"><a href="#CustomClassifier-38"><span class="linenos"> 38</span></a>
</span><span id="CustomClassifier-39"><a href="#CustomClassifier-39"><span class="linenos"> 39</span></a><span class="sd">        dropout: float</span>
</span><span id="CustomClassifier-40"><a href="#CustomClassifier-40"><span class="linenos"> 40</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="CustomClassifier-41"><a href="#CustomClassifier-41"><span class="linenos"> 41</span></a><span class="sd">            of the training</span>
</span><span id="CustomClassifier-42"><a href="#CustomClassifier-42"><span class="linenos"> 42</span></a>
</span><span id="CustomClassifier-43"><a href="#CustomClassifier-43"><span class="linenos"> 43</span></a><span class="sd">        direct_link: boolean</span>
</span><span id="CustomClassifier-44"><a href="#CustomClassifier-44"><span class="linenos"> 44</span></a><span class="sd">            indicates if the original predictors are included (True) in model&#39;&#39;s</span>
</span><span id="CustomClassifier-45"><a href="#CustomClassifier-45"><span class="linenos"> 45</span></a><span class="sd">            fitting or not (False)</span>
</span><span id="CustomClassifier-46"><a href="#CustomClassifier-46"><span class="linenos"> 46</span></a>
</span><span id="CustomClassifier-47"><a href="#CustomClassifier-47"><span class="linenos"> 47</span></a><span class="sd">        n_clusters: int</span>
</span><span id="CustomClassifier-48"><a href="#CustomClassifier-48"><span class="linenos"> 48</span></a><span class="sd">            number of clusters for &#39;kmeans&#39; or &#39;gmm&#39; clustering (could be 0:</span>
</span><span id="CustomClassifier-49"><a href="#CustomClassifier-49"><span class="linenos"> 49</span></a><span class="sd">                no clustering)</span>
</span><span id="CustomClassifier-50"><a href="#CustomClassifier-50"><span class="linenos"> 50</span></a>
</span><span id="CustomClassifier-51"><a href="#CustomClassifier-51"><span class="linenos"> 51</span></a><span class="sd">        cluster_encode: bool</span>
</span><span id="CustomClassifier-52"><a href="#CustomClassifier-52"><span class="linenos"> 52</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot)</span>
</span><span id="CustomClassifier-53"><a href="#CustomClassifier-53"><span class="linenos"> 53</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding</span>
</span><span id="CustomClassifier-54"><a href="#CustomClassifier-54"><span class="linenos"> 54</span></a>
</span><span id="CustomClassifier-55"><a href="#CustomClassifier-55"><span class="linenos"> 55</span></a><span class="sd">        type_clust: str</span>
</span><span id="CustomClassifier-56"><a href="#CustomClassifier-56"><span class="linenos"> 56</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian</span>
</span><span id="CustomClassifier-57"><a href="#CustomClassifier-57"><span class="linenos"> 57</span></a><span class="sd">            Mixture Model (&#39;gmm&#39;)</span>
</span><span id="CustomClassifier-58"><a href="#CustomClassifier-58"><span class="linenos"> 58</span></a>
</span><span id="CustomClassifier-59"><a href="#CustomClassifier-59"><span class="linenos"> 59</span></a><span class="sd">        type_scaling: a tuple of 3 strings</span>
</span><span id="CustomClassifier-60"><a href="#CustomClassifier-60"><span class="linenos"> 60</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="CustomClassifier-61"><a href="#CustomClassifier-61"><span class="linenos"> 61</span></a><span class="sd">            (and when relevant).</span>
</span><span id="CustomClassifier-62"><a href="#CustomClassifier-62"><span class="linenos"> 62</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;)</span>
</span><span id="CustomClassifier-63"><a href="#CustomClassifier-63"><span class="linenos"> 63</span></a>
</span><span id="CustomClassifier-64"><a href="#CustomClassifier-64"><span class="linenos"> 64</span></a><span class="sd">        col_sample: float</span>
</span><span id="CustomClassifier-65"><a href="#CustomClassifier-65"><span class="linenos"> 65</span></a><span class="sd">            percentage of covariates randomly chosen for training</span>
</span><span id="CustomClassifier-66"><a href="#CustomClassifier-66"><span class="linenos"> 66</span></a>
</span><span id="CustomClassifier-67"><a href="#CustomClassifier-67"><span class="linenos"> 67</span></a><span class="sd">        row_sample: float</span>
</span><span id="CustomClassifier-68"><a href="#CustomClassifier-68"><span class="linenos"> 68</span></a><span class="sd">            percentage of rows chosen for training, by stratified bootstrapping</span>
</span><span id="CustomClassifier-69"><a href="#CustomClassifier-69"><span class="linenos"> 69</span></a>
</span><span id="CustomClassifier-70"><a href="#CustomClassifier-70"><span class="linenos"> 70</span></a><span class="sd">        seed: int</span>
</span><span id="CustomClassifier-71"><a href="#CustomClassifier-71"><span class="linenos"> 71</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39;</span>
</span><span id="CustomClassifier-72"><a href="#CustomClassifier-72"><span class="linenos"> 72</span></a>
</span><span id="CustomClassifier-73"><a href="#CustomClassifier-73"><span class="linenos"> 73</span></a><span class="sd">        backend: str</span>
</span><span id="CustomClassifier-74"><a href="#CustomClassifier-74"><span class="linenos"> 74</span></a><span class="sd">            &quot;cpu&quot; or &quot;gpu&quot; or &quot;tpu&quot;</span>
</span><span id="CustomClassifier-75"><a href="#CustomClassifier-75"><span class="linenos"> 75</span></a>
</span><span id="CustomClassifier-76"><a href="#CustomClassifier-76"><span class="linenos"> 76</span></a><span class="sd">    Examples:</span>
</span><span id="CustomClassifier-77"><a href="#CustomClassifier-77"><span class="linenos"> 77</span></a>
</span><span id="CustomClassifier-78"><a href="#CustomClassifier-78"><span class="linenos"> 78</span></a><span class="sd">    Note: it&#39;s better to use the `DeepClassifier` or `LazyDeepClassifier` classes directly</span>
</span><span id="CustomClassifier-79"><a href="#CustomClassifier-79"><span class="linenos"> 79</span></a>
</span><span id="CustomClassifier-80"><a href="#CustomClassifier-80"><span class="linenos"> 80</span></a><span class="sd">    ```python</span>
</span><span id="CustomClassifier-81"><a href="#CustomClassifier-81"><span class="linenos"> 81</span></a><span class="sd">    import nnetsauce as ns</span>
</span><span id="CustomClassifier-82"><a href="#CustomClassifier-82"><span class="linenos"> 82</span></a><span class="sd">    from sklearn.ensemble import RandomForestClassifier</span>
</span><span id="CustomClassifier-83"><a href="#CustomClassifier-83"><span class="linenos"> 83</span></a><span class="sd">    from sklearn.model_selection import train_test_split</span>
</span><span id="CustomClassifier-84"><a href="#CustomClassifier-84"><span class="linenos"> 84</span></a><span class="sd">    from sklearn.datasets import load_digits</span>
</span><span id="CustomClassifier-85"><a href="#CustomClassifier-85"><span class="linenos"> 85</span></a><span class="sd">    from time import time</span>
</span><span id="CustomClassifier-86"><a href="#CustomClassifier-86"><span class="linenos"> 86</span></a>
</span><span id="CustomClassifier-87"><a href="#CustomClassifier-87"><span class="linenos"> 87</span></a><span class="sd">    digits = load_digits()</span>
</span><span id="CustomClassifier-88"><a href="#CustomClassifier-88"><span class="linenos"> 88</span></a><span class="sd">    X = digits.data</span>
</span><span id="CustomClassifier-89"><a href="#CustomClassifier-89"><span class="linenos"> 89</span></a><span class="sd">    y = digits.target</span>
</span><span id="CustomClassifier-90"><a href="#CustomClassifier-90"><span class="linenos"> 90</span></a><span class="sd">    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2,</span>
</span><span id="CustomClassifier-91"><a href="#CustomClassifier-91"><span class="linenos"> 91</span></a><span class="sd">                                                        random_state=123)</span>
</span><span id="CustomClassifier-92"><a href="#CustomClassifier-92"><span class="linenos"> 92</span></a>
</span><span id="CustomClassifier-93"><a href="#CustomClassifier-93"><span class="linenos"> 93</span></a><span class="sd">    # layer 1 (base layer) ----</span>
</span><span id="CustomClassifier-94"><a href="#CustomClassifier-94"><span class="linenos"> 94</span></a><span class="sd">    layer1_regr = RandomForestClassifier(n_estimators=10, random_state=123)</span>
</span><span id="CustomClassifier-95"><a href="#CustomClassifier-95"><span class="linenos"> 95</span></a>
</span><span id="CustomClassifier-96"><a href="#CustomClassifier-96"><span class="linenos"> 96</span></a><span class="sd">    start = time()</span>
</span><span id="CustomClassifier-97"><a href="#CustomClassifier-97"><span class="linenos"> 97</span></a>
</span><span id="CustomClassifier-98"><a href="#CustomClassifier-98"><span class="linenos"> 98</span></a><span class="sd">    layer1_regr.fit(X_train, y_train)</span>
</span><span id="CustomClassifier-99"><a href="#CustomClassifier-99"><span class="linenos"> 99</span></a>
</span><span id="CustomClassifier-100"><a href="#CustomClassifier-100"><span class="linenos">100</span></a><span class="sd">    # Accuracy in layer 1</span>
</span><span id="CustomClassifier-101"><a href="#CustomClassifier-101"><span class="linenos">101</span></a><span class="sd">    print(layer1_regr.score(X_test, y_test))</span>
</span><span id="CustomClassifier-102"><a href="#CustomClassifier-102"><span class="linenos">102</span></a>
</span><span id="CustomClassifier-103"><a href="#CustomClassifier-103"><span class="linenos">103</span></a><span class="sd">    # layer 2 using layer 1 ----</span>
</span><span id="CustomClassifier-104"><a href="#CustomClassifier-104"><span class="linenos">104</span></a><span class="sd">    layer2_regr = ns.CustomClassifier(obj = layer1_regr, n_hidden_features=5,</span>
</span><span id="CustomClassifier-105"><a href="#CustomClassifier-105"><span class="linenos">105</span></a><span class="sd">                            direct_link=True, bias=True,</span>
</span><span id="CustomClassifier-106"><a href="#CustomClassifier-106"><span class="linenos">106</span></a><span class="sd">                            nodes_sim=&#39;uniform&#39;, activation_name=&#39;relu&#39;,</span>
</span><span id="CustomClassifier-107"><a href="#CustomClassifier-107"><span class="linenos">107</span></a><span class="sd">                            n_clusters=2, seed=123)</span>
</span><span id="CustomClassifier-108"><a href="#CustomClassifier-108"><span class="linenos">108</span></a><span class="sd">    layer2_regr.fit(X_train, y_train)</span>
</span><span id="CustomClassifier-109"><a href="#CustomClassifier-109"><span class="linenos">109</span></a>
</span><span id="CustomClassifier-110"><a href="#CustomClassifier-110"><span class="linenos">110</span></a><span class="sd">    # Accuracy in layer 2</span>
</span><span id="CustomClassifier-111"><a href="#CustomClassifier-111"><span class="linenos">111</span></a><span class="sd">    print(layer2_regr.score(X_test, y_test))</span>
</span><span id="CustomClassifier-112"><a href="#CustomClassifier-112"><span class="linenos">112</span></a>
</span><span id="CustomClassifier-113"><a href="#CustomClassifier-113"><span class="linenos">113</span></a><span class="sd">    # layer 3 using layer 2 ----</span>
</span><span id="CustomClassifier-114"><a href="#CustomClassifier-114"><span class="linenos">114</span></a><span class="sd">    layer3_regr = ns.CustomClassifier(obj = layer2_regr, n_hidden_features=10,</span>
</span><span id="CustomClassifier-115"><a href="#CustomClassifier-115"><span class="linenos">115</span></a><span class="sd">                            direct_link=True, bias=True, dropout=0.7,</span>
</span><span id="CustomClassifier-116"><a href="#CustomClassifier-116"><span class="linenos">116</span></a><span class="sd">                            nodes_sim=&#39;uniform&#39;, activation_name=&#39;relu&#39;,</span>
</span><span id="CustomClassifier-117"><a href="#CustomClassifier-117"><span class="linenos">117</span></a><span class="sd">                            n_clusters=2, seed=123)</span>
</span><span id="CustomClassifier-118"><a href="#CustomClassifier-118"><span class="linenos">118</span></a><span class="sd">    layer3_regr.fit(X_train, y_train)</span>
</span><span id="CustomClassifier-119"><a href="#CustomClassifier-119"><span class="linenos">119</span></a>
</span><span id="CustomClassifier-120"><a href="#CustomClassifier-120"><span class="linenos">120</span></a><span class="sd">    # Accuracy in layer 3</span>
</span><span id="CustomClassifier-121"><a href="#CustomClassifier-121"><span class="linenos">121</span></a><span class="sd">    print(layer3_regr.score(X_test, y_test))</span>
</span><span id="CustomClassifier-122"><a href="#CustomClassifier-122"><span class="linenos">122</span></a>
</span><span id="CustomClassifier-123"><a href="#CustomClassifier-123"><span class="linenos">123</span></a><span class="sd">    print(f&quot;Elapsed {time() - start}&quot;)</span>
</span><span id="CustomClassifier-124"><a href="#CustomClassifier-124"><span class="linenos">124</span></a><span class="sd">    ```</span>
</span><span id="CustomClassifier-125"><a href="#CustomClassifier-125"><span class="linenos">125</span></a>
</span><span id="CustomClassifier-126"><a href="#CustomClassifier-126"><span class="linenos">126</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CustomClassifier-127"><a href="#CustomClassifier-127"><span class="linenos">127</span></a>
</span><span id="CustomClassifier-128"><a href="#CustomClassifier-128"><span class="linenos">128</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="CustomClassifier-129"><a href="#CustomClassifier-129"><span class="linenos">129</span></a>
</span><span id="CustomClassifier-130"><a href="#CustomClassifier-130"><span class="linenos">130</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="CustomClassifier-131"><a href="#CustomClassifier-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CustomClassifier-132"><a href="#CustomClassifier-132"><span class="linenos">132</span></a>        <span class="n">obj</span><span class="p">,</span>
</span><span id="CustomClassifier-133"><a href="#CustomClassifier-133"><span class="linenos">133</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="CustomClassifier-134"><a href="#CustomClassifier-134"><span class="linenos">134</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="CustomClassifier-135"><a href="#CustomClassifier-135"><span class="linenos">135</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="CustomClassifier-136"><a href="#CustomClassifier-136"><span class="linenos">136</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="CustomClassifier-137"><a href="#CustomClassifier-137"><span class="linenos">137</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CustomClassifier-138"><a href="#CustomClassifier-138"><span class="linenos">138</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="CustomClassifier-139"><a href="#CustomClassifier-139"><span class="linenos">139</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CustomClassifier-140"><a href="#CustomClassifier-140"><span class="linenos">140</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="CustomClassifier-141"><a href="#CustomClassifier-141"><span class="linenos">141</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CustomClassifier-142"><a href="#CustomClassifier-142"><span class="linenos">142</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="CustomClassifier-143"><a href="#CustomClassifier-143"><span class="linenos">143</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="CustomClassifier-144"><a href="#CustomClassifier-144"><span class="linenos">144</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="CustomClassifier-145"><a href="#CustomClassifier-145"><span class="linenos">145</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="CustomClassifier-146"><a href="#CustomClassifier-146"><span class="linenos">146</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="CustomClassifier-147"><a href="#CustomClassifier-147"><span class="linenos">147</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="CustomClassifier-148"><a href="#CustomClassifier-148"><span class="linenos">148</span></a>    <span class="p">):</span>
</span><span id="CustomClassifier-149"><a href="#CustomClassifier-149"><span class="linenos">149</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="CustomClassifier-150"><a href="#CustomClassifier-150"><span class="linenos">150</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="CustomClassifier-151"><a href="#CustomClassifier-151"><span class="linenos">151</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="CustomClassifier-152"><a href="#CustomClassifier-152"><span class="linenos">152</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="CustomClassifier-153"><a href="#CustomClassifier-153"><span class="linenos">153</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="CustomClassifier-154"><a href="#CustomClassifier-154"><span class="linenos">154</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="CustomClassifier-155"><a href="#CustomClassifier-155"><span class="linenos">155</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="CustomClassifier-156"><a href="#CustomClassifier-156"><span class="linenos">156</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="CustomClassifier-157"><a href="#CustomClassifier-157"><span class="linenos">157</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="CustomClassifier-158"><a href="#CustomClassifier-158"><span class="linenos">158</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="CustomClassifier-159"><a href="#CustomClassifier-159"><span class="linenos">159</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="CustomClassifier-160"><a href="#CustomClassifier-160"><span class="linenos">160</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="CustomClassifier-161"><a href="#CustomClassifier-161"><span class="linenos">161</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="CustomClassifier-162"><a href="#CustomClassifier-162"><span class="linenos">162</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="CustomClassifier-163"><a href="#CustomClassifier-163"><span class="linenos">163</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="CustomClassifier-164"><a href="#CustomClassifier-164"><span class="linenos">164</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="CustomClassifier-165"><a href="#CustomClassifier-165"><span class="linenos">165</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="CustomClassifier-166"><a href="#CustomClassifier-166"><span class="linenos">166</span></a>        <span class="p">)</span>
</span><span id="CustomClassifier-167"><a href="#CustomClassifier-167"><span class="linenos">167</span></a>
</span><span id="CustomClassifier-168"><a href="#CustomClassifier-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_fit</span> <span class="o">=</span> <span class="s2">&quot;classification&quot;</span>
</span><span id="CustomClassifier-169"><a href="#CustomClassifier-169"><span class="linenos">169</span></a>
</span><span id="CustomClassifier-170"><a href="#CustomClassifier-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="CustomClassifier-171"><a href="#CustomClassifier-171"><span class="linenos">171</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit custom model to training data (X, y).</span>
</span><span id="CustomClassifier-172"><a href="#CustomClassifier-172"><span class="linenos">172</span></a>
</span><span id="CustomClassifier-173"><a href="#CustomClassifier-173"><span class="linenos">173</span></a><span class="sd">        Parameters:</span>
</span><span id="CustomClassifier-174"><a href="#CustomClassifier-174"><span class="linenos">174</span></a>
</span><span id="CustomClassifier-175"><a href="#CustomClassifier-175"><span class="linenos">175</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="CustomClassifier-176"><a href="#CustomClassifier-176"><span class="linenos">176</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="CustomClassifier-177"><a href="#CustomClassifier-177"><span class="linenos">177</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="CustomClassifier-178"><a href="#CustomClassifier-178"><span class="linenos">178</span></a>
</span><span id="CustomClassifier-179"><a href="#CustomClassifier-179"><span class="linenos">179</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="CustomClassifier-180"><a href="#CustomClassifier-180"><span class="linenos">180</span></a><span class="sd">                Target values.</span>
</span><span id="CustomClassifier-181"><a href="#CustomClassifier-181"><span class="linenos">181</span></a>
</span><span id="CustomClassifier-182"><a href="#CustomClassifier-182"><span class="linenos">182</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="CustomClassifier-183"><a href="#CustomClassifier-183"><span class="linenos">183</span></a><span class="sd">                        self.cook_training_set or self.obj.fit</span>
</span><span id="CustomClassifier-184"><a href="#CustomClassifier-184"><span class="linenos">184</span></a>
</span><span id="CustomClassifier-185"><a href="#CustomClassifier-185"><span class="linenos">185</span></a><span class="sd">        Returns:</span>
</span><span id="CustomClassifier-186"><a href="#CustomClassifier-186"><span class="linenos">186</span></a>
</span><span id="CustomClassifier-187"><a href="#CustomClassifier-187"><span class="linenos">187</span></a><span class="sd">            self: object</span>
</span><span id="CustomClassifier-188"><a href="#CustomClassifier-188"><span class="linenos">188</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CustomClassifier-189"><a href="#CustomClassifier-189"><span class="linenos">189</span></a>
</span><span id="CustomClassifier-190"><a href="#CustomClassifier-190"><span class="linenos">190</span></a>        <span class="n">output_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="CustomClassifier-191"><a href="#CustomClassifier-191"><span class="linenos">191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="CustomClassifier-192"><a href="#CustomClassifier-192"><span class="linenos">192</span></a>
</span><span id="CustomClassifier-193"><a href="#CustomClassifier-193"><span class="linenos">193</span></a>        <span class="c1"># if sample_weights, else: (must use self.row_index)</span>
</span><span id="CustomClassifier-194"><a href="#CustomClassifier-194"><span class="linenos">194</span></a>        <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CustomClassifier-195"><a href="#CustomClassifier-195"><span class="linenos">195</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="CustomClassifier-196"><a href="#CustomClassifier-196"><span class="linenos">196</span></a>                <span class="n">scaled_Z</span><span class="p">,</span>
</span><span id="CustomClassifier-197"><a href="#CustomClassifier-197"><span class="linenos">197</span></a>                <span class="n">output_y</span><span class="p">,</span>
</span><span id="CustomClassifier-198"><a href="#CustomClassifier-198"><span class="linenos">198</span></a>                <span class="n">sample_weight</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)[</span>
</span><span id="CustomClassifier-199"><a href="#CustomClassifier-199"><span class="linenos">199</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span>
</span><span id="CustomClassifier-200"><a href="#CustomClassifier-200"><span class="linenos">200</span></a>                <span class="p">],</span>
</span><span id="CustomClassifier-201"><a href="#CustomClassifier-201"><span class="linenos">201</span></a>                <span class="c1"># **kwargs</span>
</span><span id="CustomClassifier-202"><a href="#CustomClassifier-202"><span class="linenos">202</span></a>            <span class="p">)</span>
</span><span id="CustomClassifier-203"><a href="#CustomClassifier-203"><span class="linenos">203</span></a>
</span><span id="CustomClassifier-204"><a href="#CustomClassifier-204"><span class="linenos">204</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="CustomClassifier-205"><a href="#CustomClassifier-205"><span class="linenos">205</span></a>
</span><span id="CustomClassifier-206"><a href="#CustomClassifier-206"><span class="linenos">206</span></a>        <span class="c1"># if sample_weight is None:</span>
</span><span id="CustomClassifier-207"><a href="#CustomClassifier-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">output_y</span><span class="p">)</span>
</span><span id="CustomClassifier-208"><a href="#CustomClassifier-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="CustomClassifier-209"><a href="#CustomClassifier-209"><span class="linenos">209</span></a>
</span><span id="CustomClassifier-210"><a href="#CustomClassifier-210"><span class="linenos">210</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="CustomClassifier-211"><a href="#CustomClassifier-211"><span class="linenos">211</span></a>
</span><span id="CustomClassifier-212"><a href="#CustomClassifier-212"><span class="linenos">212</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="CustomClassifier-213"><a href="#CustomClassifier-213"><span class="linenos">213</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="CustomClassifier-214"><a href="#CustomClassifier-214"><span class="linenos">214</span></a>
</span><span id="CustomClassifier-215"><a href="#CustomClassifier-215"><span class="linenos">215</span></a><span class="sd">        Parameters:</span>
</span><span id="CustomClassifier-216"><a href="#CustomClassifier-216"><span class="linenos">216</span></a>
</span><span id="CustomClassifier-217"><a href="#CustomClassifier-217"><span class="linenos">217</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="CustomClassifier-218"><a href="#CustomClassifier-218"><span class="linenos">218</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="CustomClassifier-219"><a href="#CustomClassifier-219"><span class="linenos">219</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="CustomClassifier-220"><a href="#CustomClassifier-220"><span class="linenos">220</span></a>
</span><span id="CustomClassifier-221"><a href="#CustomClassifier-221"><span class="linenos">221</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="CustomClassifier-222"><a href="#CustomClassifier-222"><span class="linenos">222</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="CustomClassifier-223"><a href="#CustomClassifier-223"><span class="linenos">223</span></a>
</span><span id="CustomClassifier-224"><a href="#CustomClassifier-224"><span class="linenos">224</span></a><span class="sd">        Returns:</span>
</span><span id="CustomClassifier-225"><a href="#CustomClassifier-225"><span class="linenos">225</span></a>
</span><span id="CustomClassifier-226"><a href="#CustomClassifier-226"><span class="linenos">226</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="CustomClassifier-227"><a href="#CustomClassifier-227"><span class="linenos">227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CustomClassifier-228"><a href="#CustomClassifier-228"><span class="linenos">228</span></a>
</span><span id="CustomClassifier-229"><a href="#CustomClassifier-229"><span class="linenos">229</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="CustomClassifier-230"><a href="#CustomClassifier-230"><span class="linenos">230</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CustomClassifier-231"><a href="#CustomClassifier-231"><span class="linenos">231</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="CustomClassifier-232"><a href="#CustomClassifier-232"><span class="linenos">232</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="CustomClassifier-233"><a href="#CustomClassifier-233"><span class="linenos">233</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="CustomClassifier-234"><a href="#CustomClassifier-234"><span class="linenos">234</span></a>            <span class="p">)</span>
</span><span id="CustomClassifier-235"><a href="#CustomClassifier-235"><span class="linenos">235</span></a>
</span><span id="CustomClassifier-236"><a href="#CustomClassifier-236"><span class="linenos">236</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="CustomClassifier-237"><a href="#CustomClassifier-237"><span class="linenos">237</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="CustomClassifier-238"><a href="#CustomClassifier-238"><span class="linenos">238</span></a>            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CustomClassifier-239"><a href="#CustomClassifier-239"><span class="linenos">239</span></a>
</span><span id="CustomClassifier-240"><a href="#CustomClassifier-240"><span class="linenos">240</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="CustomClassifier-241"><a href="#CustomClassifier-241"><span class="linenos">241</span></a>
</span><span id="CustomClassifier-242"><a href="#CustomClassifier-242"><span class="linenos">242</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="CustomClassifier-243"><a href="#CustomClassifier-243"><span class="linenos">243</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probabilities for test data X.</span>
</span><span id="CustomClassifier-244"><a href="#CustomClassifier-244"><span class="linenos">244</span></a>
</span><span id="CustomClassifier-245"><a href="#CustomClassifier-245"><span class="linenos">245</span></a><span class="sd">        Args:</span>
</span><span id="CustomClassifier-246"><a href="#CustomClassifier-246"><span class="linenos">246</span></a>
</span><span id="CustomClassifier-247"><a href="#CustomClassifier-247"><span class="linenos">247</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="CustomClassifier-248"><a href="#CustomClassifier-248"><span class="linenos">248</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="CustomClassifier-249"><a href="#CustomClassifier-249"><span class="linenos">249</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="CustomClassifier-250"><a href="#CustomClassifier-250"><span class="linenos">250</span></a>
</span><span id="CustomClassifier-251"><a href="#CustomClassifier-251"><span class="linenos">251</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="CustomClassifier-252"><a href="#CustomClassifier-252"><span class="linenos">252</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="CustomClassifier-253"><a href="#CustomClassifier-253"><span class="linenos">253</span></a>
</span><span id="CustomClassifier-254"><a href="#CustomClassifier-254"><span class="linenos">254</span></a><span class="sd">        Returns:</span>
</span><span id="CustomClassifier-255"><a href="#CustomClassifier-255"><span class="linenos">255</span></a>
</span><span id="CustomClassifier-256"><a href="#CustomClassifier-256"><span class="linenos">256</span></a><span class="sd">            probability estimates for test data: {array-like}</span>
</span><span id="CustomClassifier-257"><a href="#CustomClassifier-257"><span class="linenos">257</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CustomClassifier-258"><a href="#CustomClassifier-258"><span class="linenos">258</span></a>
</span><span id="CustomClassifier-259"><a href="#CustomClassifier-259"><span class="linenos">259</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="CustomClassifier-260"><a href="#CustomClassifier-260"><span class="linenos">260</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CustomClassifier-261"><a href="#CustomClassifier-261"><span class="linenos">261</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="CustomClassifier-262"><a href="#CustomClassifier-262"><span class="linenos">262</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="CustomClassifier-263"><a href="#CustomClassifier-263"><span class="linenos">263</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="CustomClassifier-264"><a href="#CustomClassifier-264"><span class="linenos">264</span></a>            <span class="p">)</span>
</span><span id="CustomClassifier-265"><a href="#CustomClassifier-265"><span class="linenos">265</span></a>
</span><span id="CustomClassifier-266"><a href="#CustomClassifier-266"><span class="linenos">266</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="CustomClassifier-267"><a href="#CustomClassifier-267"><span class="linenos">267</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span>
</span><span id="CustomClassifier-268"><a href="#CustomClassifier-268"><span class="linenos">268</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="CustomClassifier-269"><a href="#CustomClassifier-269"><span class="linenos">269</span></a>                <span class="p">)</span>
</span><span id="CustomClassifier-270"><a href="#CustomClassifier-270"><span class="linenos">270</span></a>            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CustomClassifier-271"><a href="#CustomClassifier-271"><span class="linenos">271</span></a>
</span><span id="CustomClassifier-272"><a href="#CustomClassifier-272"><span class="linenos">272</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Custom Classification model</p>

<p>Attributes:</p>

<pre><code>obj: object
    any object containing a method fit (obj.fit()) and a method predict
    (obj.predict())

n_hidden_features: int
    number of nodes in the hidden layer

activation_name: str
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'

a: float
    hyperparameter for 'prelu' or 'elu' activation function

nodes_sim: str
    type of simulation for the nodes: 'sobol', 'hammersley', 'halton',
    'uniform'

bias: boolean
    indicates if the hidden layer contains a bias term (True) or not
    (False)

dropout: float
    regularization parameter; (random) percentage of nodes dropped out
    of the training

direct_link: boolean
    indicates if the original predictors are included (True) in model''s
    fitting or not (False)

n_clusters: int
    number of clusters for 'kmeans' or 'gmm' clustering (could be 0:
        no clustering)

cluster_encode: bool
    defines how the variable containing clusters is treated (default is one-hot)
    if `False`, then labels are used, without one-hot encoding

type_clust: str
    type of clustering method: currently k-means ('kmeans') or Gaussian
    Mixture Model ('gmm')

type_scaling: a tuple of 3 strings
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax')

col_sample: float
    percentage of covariates randomly chosen for training

row_sample: float
    percentage of rows chosen for training, by stratified bootstrapping

seed: int
    reproducibility seed for nodes_sim=='uniform'

backend: str
    "cpu" or "gpu" or "tpu"
</code></pre>

<p>Examples:</p>

<p>Note: it's better to use the <code><a href="#DeepClassifier">DeepClassifier</a></code> or <code><a href="#LazyDeepClassifier">LazyDeepClassifier</a></code> classes directly</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_digits</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>

<span class="n">digits</span> <span class="o">=</span> <span class="n">load_digits</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">target</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                                                    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>

<span class="c1"># layer 1 (base layer) ----</span>
<span class="n">layer1_regr</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>

<span class="n">layer1_regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Accuracy in layer 1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">layer1_regr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>

<span class="c1"># layer 2 using layer 1 ----</span>
<span class="n">layer2_regr</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">CustomClassifier</span><span class="p">(</span><span class="n">obj</span> <span class="o">=</span> <span class="n">layer1_regr</span><span class="p">,</span> <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">nodes_sim</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="n">activation_name</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
                        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">layer2_regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Accuracy in layer 2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">layer2_regr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>

<span class="c1"># layer 3 using layer 2 ----</span>
<span class="n">layer3_regr</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">CustomClassifier</span><span class="p">(</span><span class="n">obj</span> <span class="o">=</span> <span class="n">layer2_regr</span><span class="p">,</span> <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dropout</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                        <span class="n">nodes_sim</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="n">activation_name</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span>
                        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">layer3_regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Accuracy in layer 3</span>
<span class="nb">print</span><span class="p">(</span><span class="n">layer3_regr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Elapsed </span><span class="si">{</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre>
</div>
</div>


                                <div id="CustomClassifier.fit" class="classattr">
                                            <input id="CustomClassifier.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CustomClassifier.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CustomClassifier.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CustomClassifier.fit-170"><a href="#CustomClassifier.fit-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="CustomClassifier.fit-171"><a href="#CustomClassifier.fit-171"><span class="linenos">171</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit custom model to training data (X, y).</span>
</span><span id="CustomClassifier.fit-172"><a href="#CustomClassifier.fit-172"><span class="linenos">172</span></a>
</span><span id="CustomClassifier.fit-173"><a href="#CustomClassifier.fit-173"><span class="linenos">173</span></a><span class="sd">        Parameters:</span>
</span><span id="CustomClassifier.fit-174"><a href="#CustomClassifier.fit-174"><span class="linenos">174</span></a>
</span><span id="CustomClassifier.fit-175"><a href="#CustomClassifier.fit-175"><span class="linenos">175</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="CustomClassifier.fit-176"><a href="#CustomClassifier.fit-176"><span class="linenos">176</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="CustomClassifier.fit-177"><a href="#CustomClassifier.fit-177"><span class="linenos">177</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="CustomClassifier.fit-178"><a href="#CustomClassifier.fit-178"><span class="linenos">178</span></a>
</span><span id="CustomClassifier.fit-179"><a href="#CustomClassifier.fit-179"><span class="linenos">179</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="CustomClassifier.fit-180"><a href="#CustomClassifier.fit-180"><span class="linenos">180</span></a><span class="sd">                Target values.</span>
</span><span id="CustomClassifier.fit-181"><a href="#CustomClassifier.fit-181"><span class="linenos">181</span></a>
</span><span id="CustomClassifier.fit-182"><a href="#CustomClassifier.fit-182"><span class="linenos">182</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="CustomClassifier.fit-183"><a href="#CustomClassifier.fit-183"><span class="linenos">183</span></a><span class="sd">                        self.cook_training_set or self.obj.fit</span>
</span><span id="CustomClassifier.fit-184"><a href="#CustomClassifier.fit-184"><span class="linenos">184</span></a>
</span><span id="CustomClassifier.fit-185"><a href="#CustomClassifier.fit-185"><span class="linenos">185</span></a><span class="sd">        Returns:</span>
</span><span id="CustomClassifier.fit-186"><a href="#CustomClassifier.fit-186"><span class="linenos">186</span></a>
</span><span id="CustomClassifier.fit-187"><a href="#CustomClassifier.fit-187"><span class="linenos">187</span></a><span class="sd">            self: object</span>
</span><span id="CustomClassifier.fit-188"><a href="#CustomClassifier.fit-188"><span class="linenos">188</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CustomClassifier.fit-189"><a href="#CustomClassifier.fit-189"><span class="linenos">189</span></a>
</span><span id="CustomClassifier.fit-190"><a href="#CustomClassifier.fit-190"><span class="linenos">190</span></a>        <span class="n">output_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="CustomClassifier.fit-191"><a href="#CustomClassifier.fit-191"><span class="linenos">191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="CustomClassifier.fit-192"><a href="#CustomClassifier.fit-192"><span class="linenos">192</span></a>
</span><span id="CustomClassifier.fit-193"><a href="#CustomClassifier.fit-193"><span class="linenos">193</span></a>        <span class="c1"># if sample_weights, else: (must use self.row_index)</span>
</span><span id="CustomClassifier.fit-194"><a href="#CustomClassifier.fit-194"><span class="linenos">194</span></a>        <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CustomClassifier.fit-195"><a href="#CustomClassifier.fit-195"><span class="linenos">195</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="CustomClassifier.fit-196"><a href="#CustomClassifier.fit-196"><span class="linenos">196</span></a>                <span class="n">scaled_Z</span><span class="p">,</span>
</span><span id="CustomClassifier.fit-197"><a href="#CustomClassifier.fit-197"><span class="linenos">197</span></a>                <span class="n">output_y</span><span class="p">,</span>
</span><span id="CustomClassifier.fit-198"><a href="#CustomClassifier.fit-198"><span class="linenos">198</span></a>                <span class="n">sample_weight</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)[</span>
</span><span id="CustomClassifier.fit-199"><a href="#CustomClassifier.fit-199"><span class="linenos">199</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">index_row_</span>
</span><span id="CustomClassifier.fit-200"><a href="#CustomClassifier.fit-200"><span class="linenos">200</span></a>                <span class="p">],</span>
</span><span id="CustomClassifier.fit-201"><a href="#CustomClassifier.fit-201"><span class="linenos">201</span></a>                <span class="c1"># **kwargs</span>
</span><span id="CustomClassifier.fit-202"><a href="#CustomClassifier.fit-202"><span class="linenos">202</span></a>            <span class="p">)</span>
</span><span id="CustomClassifier.fit-203"><a href="#CustomClassifier.fit-203"><span class="linenos">203</span></a>
</span><span id="CustomClassifier.fit-204"><a href="#CustomClassifier.fit-204"><span class="linenos">204</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="CustomClassifier.fit-205"><a href="#CustomClassifier.fit-205"><span class="linenos">205</span></a>
</span><span id="CustomClassifier.fit-206"><a href="#CustomClassifier.fit-206"><span class="linenos">206</span></a>        <span class="c1"># if sample_weight is None:</span>
</span><span id="CustomClassifier.fit-207"><a href="#CustomClassifier.fit-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">output_y</span><span class="p">)</span>
</span><span id="CustomClassifier.fit-208"><a href="#CustomClassifier.fit-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="CustomClassifier.fit-209"><a href="#CustomClassifier.fit-209"><span class="linenos">209</span></a>
</span><span id="CustomClassifier.fit-210"><a href="#CustomClassifier.fit-210"><span class="linenos">210</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit custom model to training data (X, y).</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

y: array-like, shape = [n_samples]
    Target values.

**kwargs: additional parameters to be passed to
            self.cook_training_set or self.obj.fit
</code></pre>

<p>Returns:</p>

<pre><code>self: object
</code></pre>
</div>


                                </div>
                                <div id="CustomClassifier.predict" class="classattr">
                                            <input id="CustomClassifier.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CustomClassifier.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CustomClassifier.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CustomClassifier.predict-212"><a href="#CustomClassifier.predict-212"><span class="linenos">212</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="CustomClassifier.predict-213"><a href="#CustomClassifier.predict-213"><span class="linenos">213</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="CustomClassifier.predict-214"><a href="#CustomClassifier.predict-214"><span class="linenos">214</span></a>
</span><span id="CustomClassifier.predict-215"><a href="#CustomClassifier.predict-215"><span class="linenos">215</span></a><span class="sd">        Parameters:</span>
</span><span id="CustomClassifier.predict-216"><a href="#CustomClassifier.predict-216"><span class="linenos">216</span></a>
</span><span id="CustomClassifier.predict-217"><a href="#CustomClassifier.predict-217"><span class="linenos">217</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="CustomClassifier.predict-218"><a href="#CustomClassifier.predict-218"><span class="linenos">218</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="CustomClassifier.predict-219"><a href="#CustomClassifier.predict-219"><span class="linenos">219</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="CustomClassifier.predict-220"><a href="#CustomClassifier.predict-220"><span class="linenos">220</span></a>
</span><span id="CustomClassifier.predict-221"><a href="#CustomClassifier.predict-221"><span class="linenos">221</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="CustomClassifier.predict-222"><a href="#CustomClassifier.predict-222"><span class="linenos">222</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="CustomClassifier.predict-223"><a href="#CustomClassifier.predict-223"><span class="linenos">223</span></a>
</span><span id="CustomClassifier.predict-224"><a href="#CustomClassifier.predict-224"><span class="linenos">224</span></a><span class="sd">        Returns:</span>
</span><span id="CustomClassifier.predict-225"><a href="#CustomClassifier.predict-225"><span class="linenos">225</span></a>
</span><span id="CustomClassifier.predict-226"><a href="#CustomClassifier.predict-226"><span class="linenos">226</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="CustomClassifier.predict-227"><a href="#CustomClassifier.predict-227"><span class="linenos">227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CustomClassifier.predict-228"><a href="#CustomClassifier.predict-228"><span class="linenos">228</span></a>
</span><span id="CustomClassifier.predict-229"><a href="#CustomClassifier.predict-229"><span class="linenos">229</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="CustomClassifier.predict-230"><a href="#CustomClassifier.predict-230"><span class="linenos">230</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CustomClassifier.predict-231"><a href="#CustomClassifier.predict-231"><span class="linenos">231</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="CustomClassifier.predict-232"><a href="#CustomClassifier.predict-232"><span class="linenos">232</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="CustomClassifier.predict-233"><a href="#CustomClassifier.predict-233"><span class="linenos">233</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="CustomClassifier.predict-234"><a href="#CustomClassifier.predict-234"><span class="linenos">234</span></a>            <span class="p">)</span>
</span><span id="CustomClassifier.predict-235"><a href="#CustomClassifier.predict-235"><span class="linenos">235</span></a>
</span><span id="CustomClassifier.predict-236"><a href="#CustomClassifier.predict-236"><span class="linenos">236</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="CustomClassifier.predict-237"><a href="#CustomClassifier.predict-237"><span class="linenos">237</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="CustomClassifier.predict-238"><a href="#CustomClassifier.predict-238"><span class="linenos">238</span></a>            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CustomClassifier.predict-239"><a href="#CustomClassifier.predict-239"><span class="linenos">239</span></a>
</span><span id="CustomClassifier.predict-240"><a href="#CustomClassifier.predict-240"><span class="linenos">240</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict test data X.</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>model predictions: {array-like}
</code></pre>
</div>


                                </div>
                                <div id="CustomClassifier.predict_proba" class="classattr">
                                            <input id="CustomClassifier.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CustomClassifier.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CustomClassifier.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CustomClassifier.predict_proba-242"><a href="#CustomClassifier.predict_proba-242"><span class="linenos">242</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="CustomClassifier.predict_proba-243"><a href="#CustomClassifier.predict_proba-243"><span class="linenos">243</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probabilities for test data X.</span>
</span><span id="CustomClassifier.predict_proba-244"><a href="#CustomClassifier.predict_proba-244"><span class="linenos">244</span></a>
</span><span id="CustomClassifier.predict_proba-245"><a href="#CustomClassifier.predict_proba-245"><span class="linenos">245</span></a><span class="sd">        Args:</span>
</span><span id="CustomClassifier.predict_proba-246"><a href="#CustomClassifier.predict_proba-246"><span class="linenos">246</span></a>
</span><span id="CustomClassifier.predict_proba-247"><a href="#CustomClassifier.predict_proba-247"><span class="linenos">247</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="CustomClassifier.predict_proba-248"><a href="#CustomClassifier.predict_proba-248"><span class="linenos">248</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="CustomClassifier.predict_proba-249"><a href="#CustomClassifier.predict_proba-249"><span class="linenos">249</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="CustomClassifier.predict_proba-250"><a href="#CustomClassifier.predict_proba-250"><span class="linenos">250</span></a>
</span><span id="CustomClassifier.predict_proba-251"><a href="#CustomClassifier.predict_proba-251"><span class="linenos">251</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="CustomClassifier.predict_proba-252"><a href="#CustomClassifier.predict_proba-252"><span class="linenos">252</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="CustomClassifier.predict_proba-253"><a href="#CustomClassifier.predict_proba-253"><span class="linenos">253</span></a>
</span><span id="CustomClassifier.predict_proba-254"><a href="#CustomClassifier.predict_proba-254"><span class="linenos">254</span></a><span class="sd">        Returns:</span>
</span><span id="CustomClassifier.predict_proba-255"><a href="#CustomClassifier.predict_proba-255"><span class="linenos">255</span></a>
</span><span id="CustomClassifier.predict_proba-256"><a href="#CustomClassifier.predict_proba-256"><span class="linenos">256</span></a><span class="sd">            probability estimates for test data: {array-like}</span>
</span><span id="CustomClassifier.predict_proba-257"><a href="#CustomClassifier.predict_proba-257"><span class="linenos">257</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CustomClassifier.predict_proba-258"><a href="#CustomClassifier.predict_proba-258"><span class="linenos">258</span></a>
</span><span id="CustomClassifier.predict_proba-259"><a href="#CustomClassifier.predict_proba-259"><span class="linenos">259</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="CustomClassifier.predict_proba-260"><a href="#CustomClassifier.predict_proba-260"><span class="linenos">260</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CustomClassifier.predict_proba-261"><a href="#CustomClassifier.predict_proba-261"><span class="linenos">261</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="CustomClassifier.predict_proba-262"><a href="#CustomClassifier.predict_proba-262"><span class="linenos">262</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="CustomClassifier.predict_proba-263"><a href="#CustomClassifier.predict_proba-263"><span class="linenos">263</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="CustomClassifier.predict_proba-264"><a href="#CustomClassifier.predict_proba-264"><span class="linenos">264</span></a>            <span class="p">)</span>
</span><span id="CustomClassifier.predict_proba-265"><a href="#CustomClassifier.predict_proba-265"><span class="linenos">265</span></a>
</span><span id="CustomClassifier.predict_proba-266"><a href="#CustomClassifier.predict_proba-266"><span class="linenos">266</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="CustomClassifier.predict_proba-267"><a href="#CustomClassifier.predict_proba-267"><span class="linenos">267</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span>
</span><span id="CustomClassifier.predict_proba-268"><a href="#CustomClassifier.predict_proba-268"><span class="linenos">268</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="CustomClassifier.predict_proba-269"><a href="#CustomClassifier.predict_proba-269"><span class="linenos">269</span></a>                <span class="p">)</span>
</span><span id="CustomClassifier.predict_proba-270"><a href="#CustomClassifier.predict_proba-270"><span class="linenos">270</span></a>            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CustomClassifier.predict_proba-271"><a href="#CustomClassifier.predict_proba-271"><span class="linenos">271</span></a>
</span><span id="CustomClassifier.predict_proba-272"><a href="#CustomClassifier.predict_proba-272"><span class="linenos">272</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict probabilities for test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>probability estimates for test data: {array-like}
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="CustomRegressor">
                            <input id="CustomRegressor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">CustomRegressor</span><wbr>(<span class="base">nnetsauce.custom.custom.Custom</span>, <span class="base">sklearn.base.RegressorMixin</span>):

                <label class="view-source-button" for="CustomRegressor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CustomRegressor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CustomRegressor-16"><a href="#CustomRegressor-16"><span class="linenos"> 16</span></a><span class="k">class</span> <span class="nc">CustomRegressor</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">RegressorMixin</span><span class="p">):</span>
</span><span id="CustomRegressor-17"><a href="#CustomRegressor-17"><span class="linenos"> 17</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom Regression model</span>
</span><span id="CustomRegressor-18"><a href="#CustomRegressor-18"><span class="linenos"> 18</span></a>
</span><span id="CustomRegressor-19"><a href="#CustomRegressor-19"><span class="linenos"> 19</span></a><span class="sd">    This class is used to &#39;augment&#39; any regression model with transformed features.</span>
</span><span id="CustomRegressor-20"><a href="#CustomRegressor-20"><span class="linenos"> 20</span></a>
</span><span id="CustomRegressor-21"><a href="#CustomRegressor-21"><span class="linenos"> 21</span></a><span class="sd">    Parameters:</span>
</span><span id="CustomRegressor-22"><a href="#CustomRegressor-22"><span class="linenos"> 22</span></a>
</span><span id="CustomRegressor-23"><a href="#CustomRegressor-23"><span class="linenos"> 23</span></a><span class="sd">        obj: object</span>
</span><span id="CustomRegressor-24"><a href="#CustomRegressor-24"><span class="linenos"> 24</span></a><span class="sd">            any object containing a method fit (obj.fit()) and a method predict</span>
</span><span id="CustomRegressor-25"><a href="#CustomRegressor-25"><span class="linenos"> 25</span></a><span class="sd">            (obj.predict())</span>
</span><span id="CustomRegressor-26"><a href="#CustomRegressor-26"><span class="linenos"> 26</span></a>
</span><span id="CustomRegressor-27"><a href="#CustomRegressor-27"><span class="linenos"> 27</span></a><span class="sd">        n_hidden_features: int</span>
</span><span id="CustomRegressor-28"><a href="#CustomRegressor-28"><span class="linenos"> 28</span></a><span class="sd">            number of nodes in the hidden layer</span>
</span><span id="CustomRegressor-29"><a href="#CustomRegressor-29"><span class="linenos"> 29</span></a>
</span><span id="CustomRegressor-30"><a href="#CustomRegressor-30"><span class="linenos"> 30</span></a><span class="sd">        activation_name: str</span>
</span><span id="CustomRegressor-31"><a href="#CustomRegressor-31"><span class="linenos"> 31</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;</span>
</span><span id="CustomRegressor-32"><a href="#CustomRegressor-32"><span class="linenos"> 32</span></a>
</span><span id="CustomRegressor-33"><a href="#CustomRegressor-33"><span class="linenos"> 33</span></a><span class="sd">        a: float</span>
</span><span id="CustomRegressor-34"><a href="#CustomRegressor-34"><span class="linenos"> 34</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function</span>
</span><span id="CustomRegressor-35"><a href="#CustomRegressor-35"><span class="linenos"> 35</span></a>
</span><span id="CustomRegressor-36"><a href="#CustomRegressor-36"><span class="linenos"> 36</span></a><span class="sd">        nodes_sim: str</span>
</span><span id="CustomRegressor-37"><a href="#CustomRegressor-37"><span class="linenos"> 37</span></a><span class="sd">            type of simulation for the nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;,</span>
</span><span id="CustomRegressor-38"><a href="#CustomRegressor-38"><span class="linenos"> 38</span></a><span class="sd">            &#39;uniform&#39;</span>
</span><span id="CustomRegressor-39"><a href="#CustomRegressor-39"><span class="linenos"> 39</span></a>
</span><span id="CustomRegressor-40"><a href="#CustomRegressor-40"><span class="linenos"> 40</span></a><span class="sd">        bias: boolean</span>
</span><span id="CustomRegressor-41"><a href="#CustomRegressor-41"><span class="linenos"> 41</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or not</span>
</span><span id="CustomRegressor-42"><a href="#CustomRegressor-42"><span class="linenos"> 42</span></a><span class="sd">            (False)</span>
</span><span id="CustomRegressor-43"><a href="#CustomRegressor-43"><span class="linenos"> 43</span></a>
</span><span id="CustomRegressor-44"><a href="#CustomRegressor-44"><span class="linenos"> 44</span></a><span class="sd">        dropout: float</span>
</span><span id="CustomRegressor-45"><a href="#CustomRegressor-45"><span class="linenos"> 45</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="CustomRegressor-46"><a href="#CustomRegressor-46"><span class="linenos"> 46</span></a><span class="sd">            of the training</span>
</span><span id="CustomRegressor-47"><a href="#CustomRegressor-47"><span class="linenos"> 47</span></a>
</span><span id="CustomRegressor-48"><a href="#CustomRegressor-48"><span class="linenos"> 48</span></a><span class="sd">        direct_link: boolean</span>
</span><span id="CustomRegressor-49"><a href="#CustomRegressor-49"><span class="linenos"> 49</span></a><span class="sd">            indicates if the original predictors are included (True) in model&#39;s</span>
</span><span id="CustomRegressor-50"><a href="#CustomRegressor-50"><span class="linenos"> 50</span></a><span class="sd">            fitting or not (False)</span>
</span><span id="CustomRegressor-51"><a href="#CustomRegressor-51"><span class="linenos"> 51</span></a>
</span><span id="CustomRegressor-52"><a href="#CustomRegressor-52"><span class="linenos"> 52</span></a><span class="sd">        n_clusters: int</span>
</span><span id="CustomRegressor-53"><a href="#CustomRegressor-53"><span class="linenos"> 53</span></a><span class="sd">            number of clusters for &#39;kmeans&#39; or &#39;gmm&#39; clustering (could be 0:</span>
</span><span id="CustomRegressor-54"><a href="#CustomRegressor-54"><span class="linenos"> 54</span></a><span class="sd">                no clustering)</span>
</span><span id="CustomRegressor-55"><a href="#CustomRegressor-55"><span class="linenos"> 55</span></a>
</span><span id="CustomRegressor-56"><a href="#CustomRegressor-56"><span class="linenos"> 56</span></a><span class="sd">        cluster_encode: bool</span>
</span><span id="CustomRegressor-57"><a href="#CustomRegressor-57"><span class="linenos"> 57</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot)</span>
</span><span id="CustomRegressor-58"><a href="#CustomRegressor-58"><span class="linenos"> 58</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding</span>
</span><span id="CustomRegressor-59"><a href="#CustomRegressor-59"><span class="linenos"> 59</span></a>
</span><span id="CustomRegressor-60"><a href="#CustomRegressor-60"><span class="linenos"> 60</span></a><span class="sd">        type_clust: str</span>
</span><span id="CustomRegressor-61"><a href="#CustomRegressor-61"><span class="linenos"> 61</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian</span>
</span><span id="CustomRegressor-62"><a href="#CustomRegressor-62"><span class="linenos"> 62</span></a><span class="sd">            Mixture Model (&#39;gmm&#39;)</span>
</span><span id="CustomRegressor-63"><a href="#CustomRegressor-63"><span class="linenos"> 63</span></a>
</span><span id="CustomRegressor-64"><a href="#CustomRegressor-64"><span class="linenos"> 64</span></a><span class="sd">        type_scaling: a tuple of 3 strings</span>
</span><span id="CustomRegressor-65"><a href="#CustomRegressor-65"><span class="linenos"> 65</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="CustomRegressor-66"><a href="#CustomRegressor-66"><span class="linenos"> 66</span></a><span class="sd">            (and when relevant).</span>
</span><span id="CustomRegressor-67"><a href="#CustomRegressor-67"><span class="linenos"> 67</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;)</span>
</span><span id="CustomRegressor-68"><a href="#CustomRegressor-68"><span class="linenos"> 68</span></a>
</span><span id="CustomRegressor-69"><a href="#CustomRegressor-69"><span class="linenos"> 69</span></a><span class="sd">        type_pi: str.</span>
</span><span id="CustomRegressor-70"><a href="#CustomRegressor-70"><span class="linenos"> 70</span></a><span class="sd">            type of prediction interval; currently &quot;kde&quot; (default) or &quot;bootstrap&quot;.</span>
</span><span id="CustomRegressor-71"><a href="#CustomRegressor-71"><span class="linenos"> 71</span></a><span class="sd">            Used only in `self.predict`, for `self.replications` &gt; 0 and `self.kernel`</span>
</span><span id="CustomRegressor-72"><a href="#CustomRegressor-72"><span class="linenos"> 72</span></a><span class="sd">            in (&#39;gaussian&#39;, &#39;tophat&#39;). Default is `None`.</span>
</span><span id="CustomRegressor-73"><a href="#CustomRegressor-73"><span class="linenos"> 73</span></a>
</span><span id="CustomRegressor-74"><a href="#CustomRegressor-74"><span class="linenos"> 74</span></a><span class="sd">        replications: int.</span>
</span><span id="CustomRegressor-75"><a href="#CustomRegressor-75"><span class="linenos"> 75</span></a><span class="sd">            number of replications (if needed) for predictive simulation.</span>
</span><span id="CustomRegressor-76"><a href="#CustomRegressor-76"><span class="linenos"> 76</span></a><span class="sd">            Used only in `self.predict`, for `self.kernel` in (&#39;gaussian&#39;,</span>
</span><span id="CustomRegressor-77"><a href="#CustomRegressor-77"><span class="linenos"> 77</span></a><span class="sd">            &#39;tophat&#39;) and `self.type_pi = &#39;kde&#39;`. Default is `None`.</span>
</span><span id="CustomRegressor-78"><a href="#CustomRegressor-78"><span class="linenos"> 78</span></a>
</span><span id="CustomRegressor-79"><a href="#CustomRegressor-79"><span class="linenos"> 79</span></a><span class="sd">        kernel: str.</span>
</span><span id="CustomRegressor-80"><a href="#CustomRegressor-80"><span class="linenos"> 80</span></a><span class="sd">            the kernel to use for kernel density estimation (used for predictive</span>
</span><span id="CustomRegressor-81"><a href="#CustomRegressor-81"><span class="linenos"> 81</span></a><span class="sd">            simulation in `self.predict`, with `method=&#39;splitconformal&#39;` and</span>
</span><span id="CustomRegressor-82"><a href="#CustomRegressor-82"><span class="linenos"> 82</span></a><span class="sd">            `type_pi = &#39;kde&#39;`). Currently, either &#39;gaussian&#39; or &#39;tophat&#39;.</span>
</span><span id="CustomRegressor-83"><a href="#CustomRegressor-83"><span class="linenos"> 83</span></a>
</span><span id="CustomRegressor-84"><a href="#CustomRegressor-84"><span class="linenos"> 84</span></a><span class="sd">        type_split: str.</span>
</span><span id="CustomRegressor-85"><a href="#CustomRegressor-85"><span class="linenos"> 85</span></a><span class="sd">            Type of splitting for conformal prediction. None (default), or</span>
</span><span id="CustomRegressor-86"><a href="#CustomRegressor-86"><span class="linenos"> 86</span></a><span class="sd">            &quot;random&quot; (random split of data) or &quot;sequential&quot; (sequential split of data)</span>
</span><span id="CustomRegressor-87"><a href="#CustomRegressor-87"><span class="linenos"> 87</span></a>
</span><span id="CustomRegressor-88"><a href="#CustomRegressor-88"><span class="linenos"> 88</span></a><span class="sd">        col_sample: float</span>
</span><span id="CustomRegressor-89"><a href="#CustomRegressor-89"><span class="linenos"> 89</span></a><span class="sd">            percentage of covariates randomly chosen for training</span>
</span><span id="CustomRegressor-90"><a href="#CustomRegressor-90"><span class="linenos"> 90</span></a>
</span><span id="CustomRegressor-91"><a href="#CustomRegressor-91"><span class="linenos"> 91</span></a><span class="sd">        row_sample: float</span>
</span><span id="CustomRegressor-92"><a href="#CustomRegressor-92"><span class="linenos"> 92</span></a><span class="sd">            percentage of rows chosen for training, by stratified bootstrapping</span>
</span><span id="CustomRegressor-93"><a href="#CustomRegressor-93"><span class="linenos"> 93</span></a>
</span><span id="CustomRegressor-94"><a href="#CustomRegressor-94"><span class="linenos"> 94</span></a><span class="sd">        seed: int</span>
</span><span id="CustomRegressor-95"><a href="#CustomRegressor-95"><span class="linenos"> 95</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39;</span>
</span><span id="CustomRegressor-96"><a href="#CustomRegressor-96"><span class="linenos"> 96</span></a>
</span><span id="CustomRegressor-97"><a href="#CustomRegressor-97"><span class="linenos"> 97</span></a><span class="sd">        type_fit: str</span>
</span><span id="CustomRegressor-98"><a href="#CustomRegressor-98"><span class="linenos"> 98</span></a><span class="sd">            &#39;regression&#39;</span>
</span><span id="CustomRegressor-99"><a href="#CustomRegressor-99"><span class="linenos"> 99</span></a>
</span><span id="CustomRegressor-100"><a href="#CustomRegressor-100"><span class="linenos">100</span></a><span class="sd">        backend: str</span>
</span><span id="CustomRegressor-101"><a href="#CustomRegressor-101"><span class="linenos">101</span></a><span class="sd">            &quot;cpu&quot; or &quot;gpu&quot; or &quot;tpu&quot;</span>
</span><span id="CustomRegressor-102"><a href="#CustomRegressor-102"><span class="linenos">102</span></a>
</span><span id="CustomRegressor-103"><a href="#CustomRegressor-103"><span class="linenos">103</span></a><span class="sd">    Examples:</span>
</span><span id="CustomRegressor-104"><a href="#CustomRegressor-104"><span class="linenos">104</span></a>
</span><span id="CustomRegressor-105"><a href="#CustomRegressor-105"><span class="linenos">105</span></a><span class="sd">    See [https://thierrymoudiki.github.io/blog/2024/03/18/python/conformal-and-bayesian-regression](https://thierrymoudiki.github.io/blog/2024/03/18/python/conformal-and-bayesian-regression)</span>
</span><span id="CustomRegressor-106"><a href="#CustomRegressor-106"><span class="linenos">106</span></a>
</span><span id="CustomRegressor-107"><a href="#CustomRegressor-107"><span class="linenos">107</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="CustomRegressor-108"><a href="#CustomRegressor-108"><span class="linenos">108</span></a>
</span><span id="CustomRegressor-109"><a href="#CustomRegressor-109"><span class="linenos">109</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="CustomRegressor-110"><a href="#CustomRegressor-110"><span class="linenos">110</span></a>
</span><span id="CustomRegressor-111"><a href="#CustomRegressor-111"><span class="linenos">111</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="CustomRegressor-112"><a href="#CustomRegressor-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="CustomRegressor-113"><a href="#CustomRegressor-113"><span class="linenos">113</span></a>        <span class="n">obj</span><span class="p">,</span>
</span><span id="CustomRegressor-114"><a href="#CustomRegressor-114"><span class="linenos">114</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="CustomRegressor-115"><a href="#CustomRegressor-115"><span class="linenos">115</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="CustomRegressor-116"><a href="#CustomRegressor-116"><span class="linenos">116</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="CustomRegressor-117"><a href="#CustomRegressor-117"><span class="linenos">117</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="CustomRegressor-118"><a href="#CustomRegressor-118"><span class="linenos">118</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CustomRegressor-119"><a href="#CustomRegressor-119"><span class="linenos">119</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="CustomRegressor-120"><a href="#CustomRegressor-120"><span class="linenos">120</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CustomRegressor-121"><a href="#CustomRegressor-121"><span class="linenos">121</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="CustomRegressor-122"><a href="#CustomRegressor-122"><span class="linenos">122</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="CustomRegressor-123"><a href="#CustomRegressor-123"><span class="linenos">123</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="CustomRegressor-124"><a href="#CustomRegressor-124"><span class="linenos">124</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="CustomRegressor-125"><a href="#CustomRegressor-125"><span class="linenos">125</span></a>        <span class="n">type_pi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CustomRegressor-126"><a href="#CustomRegressor-126"><span class="linenos">126</span></a>        <span class="n">replications</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CustomRegressor-127"><a href="#CustomRegressor-127"><span class="linenos">127</span></a>        <span class="n">kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CustomRegressor-128"><a href="#CustomRegressor-128"><span class="linenos">128</span></a>        <span class="n">type_split</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="CustomRegressor-129"><a href="#CustomRegressor-129"><span class="linenos">129</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="CustomRegressor-130"><a href="#CustomRegressor-130"><span class="linenos">130</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="CustomRegressor-131"><a href="#CustomRegressor-131"><span class="linenos">131</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="CustomRegressor-132"><a href="#CustomRegressor-132"><span class="linenos">132</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="CustomRegressor-133"><a href="#CustomRegressor-133"><span class="linenos">133</span></a>    <span class="p">):</span>
</span><span id="CustomRegressor-134"><a href="#CustomRegressor-134"><span class="linenos">134</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="CustomRegressor-135"><a href="#CustomRegressor-135"><span class="linenos">135</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="CustomRegressor-136"><a href="#CustomRegressor-136"><span class="linenos">136</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="CustomRegressor-137"><a href="#CustomRegressor-137"><span class="linenos">137</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="CustomRegressor-138"><a href="#CustomRegressor-138"><span class="linenos">138</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="CustomRegressor-139"><a href="#CustomRegressor-139"><span class="linenos">139</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="CustomRegressor-140"><a href="#CustomRegressor-140"><span class="linenos">140</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="CustomRegressor-141"><a href="#CustomRegressor-141"><span class="linenos">141</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="CustomRegressor-142"><a href="#CustomRegressor-142"><span class="linenos">142</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="CustomRegressor-143"><a href="#CustomRegressor-143"><span class="linenos">143</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="CustomRegressor-144"><a href="#CustomRegressor-144"><span class="linenos">144</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="CustomRegressor-145"><a href="#CustomRegressor-145"><span class="linenos">145</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="CustomRegressor-146"><a href="#CustomRegressor-146"><span class="linenos">146</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="CustomRegressor-147"><a href="#CustomRegressor-147"><span class="linenos">147</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="CustomRegressor-148"><a href="#CustomRegressor-148"><span class="linenos">148</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="CustomRegressor-149"><a href="#CustomRegressor-149"><span class="linenos">149</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="CustomRegressor-150"><a href="#CustomRegressor-150"><span class="linenos">150</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="CustomRegressor-151"><a href="#CustomRegressor-151"><span class="linenos">151</span></a>        <span class="p">)</span>
</span><span id="CustomRegressor-152"><a href="#CustomRegressor-152"><span class="linenos">152</span></a>
</span><span id="CustomRegressor-153"><a href="#CustomRegressor-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_fit</span> <span class="o">=</span> <span class="s2">&quot;regression&quot;</span>
</span><span id="CustomRegressor-154"><a href="#CustomRegressor-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">=</span> <span class="n">type_pi</span>
</span><span id="CustomRegressor-155"><a href="#CustomRegressor-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="o">=</span> <span class="n">replications</span>
</span><span id="CustomRegressor-156"><a href="#CustomRegressor-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="o">=</span> <span class="n">kernel</span>
</span><span id="CustomRegressor-157"><a href="#CustomRegressor-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_split</span> <span class="o">=</span> <span class="n">type_split</span>
</span><span id="CustomRegressor-158"><a href="#CustomRegressor-158"><span class="linenos">158</span></a>
</span><span id="CustomRegressor-159"><a href="#CustomRegressor-159"><span class="linenos">159</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="CustomRegressor-160"><a href="#CustomRegressor-160"><span class="linenos">160</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit custom model to training data (X, y).</span>
</span><span id="CustomRegressor-161"><a href="#CustomRegressor-161"><span class="linenos">161</span></a>
</span><span id="CustomRegressor-162"><a href="#CustomRegressor-162"><span class="linenos">162</span></a><span class="sd">        Parameters:</span>
</span><span id="CustomRegressor-163"><a href="#CustomRegressor-163"><span class="linenos">163</span></a>
</span><span id="CustomRegressor-164"><a href="#CustomRegressor-164"><span class="linenos">164</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="CustomRegressor-165"><a href="#CustomRegressor-165"><span class="linenos">165</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="CustomRegressor-166"><a href="#CustomRegressor-166"><span class="linenos">166</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="CustomRegressor-167"><a href="#CustomRegressor-167"><span class="linenos">167</span></a>
</span><span id="CustomRegressor-168"><a href="#CustomRegressor-168"><span class="linenos">168</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="CustomRegressor-169"><a href="#CustomRegressor-169"><span class="linenos">169</span></a><span class="sd">                Target values.</span>
</span><span id="CustomRegressor-170"><a href="#CustomRegressor-170"><span class="linenos">170</span></a>
</span><span id="CustomRegressor-171"><a href="#CustomRegressor-171"><span class="linenos">171</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="CustomRegressor-172"><a href="#CustomRegressor-172"><span class="linenos">172</span></a><span class="sd">                self.cook_training_set or self.obj.fit</span>
</span><span id="CustomRegressor-173"><a href="#CustomRegressor-173"><span class="linenos">173</span></a>
</span><span id="CustomRegressor-174"><a href="#CustomRegressor-174"><span class="linenos">174</span></a><span class="sd">        Returns:</span>
</span><span id="CustomRegressor-175"><a href="#CustomRegressor-175"><span class="linenos">175</span></a>
</span><span id="CustomRegressor-176"><a href="#CustomRegressor-176"><span class="linenos">176</span></a><span class="sd">            self: object</span>
</span><span id="CustomRegressor-177"><a href="#CustomRegressor-177"><span class="linenos">177</span></a>
</span><span id="CustomRegressor-178"><a href="#CustomRegressor-178"><span class="linenos">178</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CustomRegressor-179"><a href="#CustomRegressor-179"><span class="linenos">179</span></a>
</span><span id="CustomRegressor-180"><a href="#CustomRegressor-180"><span class="linenos">180</span></a>        <span class="n">centered_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="CustomRegressor-181"><a href="#CustomRegressor-181"><span class="linenos">181</span></a>
</span><span id="CustomRegressor-182"><a href="#CustomRegressor-182"><span class="linenos">182</span></a>        <span class="c1"># if sample_weights, else: (must use self.row_index)</span>
</span><span id="CustomRegressor-183"><a href="#CustomRegressor-183"><span class="linenos">183</span></a>        <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CustomRegressor-184"><a href="#CustomRegressor-184"><span class="linenos">184</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="CustomRegressor-185"><a href="#CustomRegressor-185"><span class="linenos">185</span></a>                <span class="n">scaled_Z</span><span class="p">,</span>
</span><span id="CustomRegressor-186"><a href="#CustomRegressor-186"><span class="linenos">186</span></a>                <span class="n">centered_y</span><span class="p">,</span>
</span><span id="CustomRegressor-187"><a href="#CustomRegressor-187"><span class="linenos">187</span></a>                <span class="n">sample_weight</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)[</span>
</span><span id="CustomRegressor-188"><a href="#CustomRegressor-188"><span class="linenos">188</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">index_row</span>
</span><span id="CustomRegressor-189"><a href="#CustomRegressor-189"><span class="linenos">189</span></a>                <span class="p">],</span>
</span><span id="CustomRegressor-190"><a href="#CustomRegressor-190"><span class="linenos">190</span></a>                <span class="o">**</span><span class="n">kwargs</span>
</span><span id="CustomRegressor-191"><a href="#CustomRegressor-191"><span class="linenos">191</span></a>            <span class="p">)</span>
</span><span id="CustomRegressor-192"><a href="#CustomRegressor-192"><span class="linenos">192</span></a>
</span><span id="CustomRegressor-193"><a href="#CustomRegressor-193"><span class="linenos">193</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="CustomRegressor-194"><a href="#CustomRegressor-194"><span class="linenos">194</span></a>
</span><span id="CustomRegressor-195"><a href="#CustomRegressor-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">centered_y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="CustomRegressor-196"><a href="#CustomRegressor-196"><span class="linenos">196</span></a>
</span><span id="CustomRegressor-197"><a href="#CustomRegressor-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="n">X</span>
</span><span id="CustomRegressor-198"><a href="#CustomRegressor-198"><span class="linenos">198</span></a>
</span><span id="CustomRegressor-199"><a href="#CustomRegressor-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="CustomRegressor-200"><a href="#CustomRegressor-200"><span class="linenos">200</span></a>
</span><span id="CustomRegressor-201"><a href="#CustomRegressor-201"><span class="linenos">201</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="CustomRegressor-202"><a href="#CustomRegressor-202"><span class="linenos">202</span></a>
</span><span id="CustomRegressor-203"><a href="#CustomRegressor-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="CustomRegressor-204"><a href="#CustomRegressor-204"><span class="linenos">204</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="CustomRegressor-205"><a href="#CustomRegressor-205"><span class="linenos">205</span></a>
</span><span id="CustomRegressor-206"><a href="#CustomRegressor-206"><span class="linenos">206</span></a><span class="sd">        Parameters:</span>
</span><span id="CustomRegressor-207"><a href="#CustomRegressor-207"><span class="linenos">207</span></a>
</span><span id="CustomRegressor-208"><a href="#CustomRegressor-208"><span class="linenos">208</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="CustomRegressor-209"><a href="#CustomRegressor-209"><span class="linenos">209</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="CustomRegressor-210"><a href="#CustomRegressor-210"><span class="linenos">210</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="CustomRegressor-211"><a href="#CustomRegressor-211"><span class="linenos">211</span></a>
</span><span id="CustomRegressor-212"><a href="#CustomRegressor-212"><span class="linenos">212</span></a><span class="sd">            level: int</span>
</span><span id="CustomRegressor-213"><a href="#CustomRegressor-213"><span class="linenos">213</span></a><span class="sd">                Level of confidence (default = 95)</span>
</span><span id="CustomRegressor-214"><a href="#CustomRegressor-214"><span class="linenos">214</span></a>
</span><span id="CustomRegressor-215"><a href="#CustomRegressor-215"><span class="linenos">215</span></a><span class="sd">            method: str</span>
</span><span id="CustomRegressor-216"><a href="#CustomRegressor-216"><span class="linenos">216</span></a><span class="sd">                `None`, or &#39;splitconformal&#39;, &#39;localconformal&#39;</span>
</span><span id="CustomRegressor-217"><a href="#CustomRegressor-217"><span class="linenos">217</span></a><span class="sd">                prediction (if you specify `return_pi = True`)</span>
</span><span id="CustomRegressor-218"><a href="#CustomRegressor-218"><span class="linenos">218</span></a>
</span><span id="CustomRegressor-219"><a href="#CustomRegressor-219"><span class="linenos">219</span></a><span class="sd">            **kwargs: additional parameters</span>
</span><span id="CustomRegressor-220"><a href="#CustomRegressor-220"><span class="linenos">220</span></a><span class="sd">                    `return_pi = True` for conformal prediction,</span>
</span><span id="CustomRegressor-221"><a href="#CustomRegressor-221"><span class="linenos">221</span></a><span class="sd">                    with `method` in (&#39;splitconformal&#39;, &#39;localconformal&#39;)</span>
</span><span id="CustomRegressor-222"><a href="#CustomRegressor-222"><span class="linenos">222</span></a><span class="sd">                    or `return_std = True` for `self.obj` in</span>
</span><span id="CustomRegressor-223"><a href="#CustomRegressor-223"><span class="linenos">223</span></a><span class="sd">                    (`sklearn.linear_model.BayesianRidge`,</span>
</span><span id="CustomRegressor-224"><a href="#CustomRegressor-224"><span class="linenos">224</span></a><span class="sd">                    `sklearn.linear_model.ARDRegressor`,</span>
</span><span id="CustomRegressor-225"><a href="#CustomRegressor-225"><span class="linenos">225</span></a><span class="sd">                    `sklearn.gaussian_process.GaussianProcessRegressor`)`</span>
</span><span id="CustomRegressor-226"><a href="#CustomRegressor-226"><span class="linenos">226</span></a>
</span><span id="CustomRegressor-227"><a href="#CustomRegressor-227"><span class="linenos">227</span></a><span class="sd">        Returns:</span>
</span><span id="CustomRegressor-228"><a href="#CustomRegressor-228"><span class="linenos">228</span></a>
</span><span id="CustomRegressor-229"><a href="#CustomRegressor-229"><span class="linenos">229</span></a><span class="sd">            model predictions:</span>
</span><span id="CustomRegressor-230"><a href="#CustomRegressor-230"><span class="linenos">230</span></a><span class="sd">                an array if uncertainty quantification is not requested,</span>
</span><span id="CustomRegressor-231"><a href="#CustomRegressor-231"><span class="linenos">231</span></a><span class="sd">                  or a tuple if with prediction intervals and simulations</span>
</span><span id="CustomRegressor-232"><a href="#CustomRegressor-232"><span class="linenos">232</span></a><span class="sd">                  if `return_std = True` (mean, standard deviation,</span>
</span><span id="CustomRegressor-233"><a href="#CustomRegressor-233"><span class="linenos">233</span></a><span class="sd">                  lower and upper prediction interval) or `return_pi = True`</span>
</span><span id="CustomRegressor-234"><a href="#CustomRegressor-234"><span class="linenos">234</span></a><span class="sd">                  ()</span>
</span><span id="CustomRegressor-235"><a href="#CustomRegressor-235"><span class="linenos">235</span></a>
</span><span id="CustomRegressor-236"><a href="#CustomRegressor-236"><span class="linenos">236</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CustomRegressor-237"><a href="#CustomRegressor-237"><span class="linenos">237</span></a>
</span><span id="CustomRegressor-238"><a href="#CustomRegressor-238"><span class="linenos">238</span></a>        <span class="k">if</span> <span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="CustomRegressor-239"><a href="#CustomRegressor-239"><span class="linenos">239</span></a>
</span><span id="CustomRegressor-240"><a href="#CustomRegressor-240"><span class="linenos">240</span></a>            <span class="n">alpha</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">level</span>
</span><span id="CustomRegressor-241"><a href="#CustomRegressor-241"><span class="linenos">241</span></a>            <span class="n">pi_multiplier</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">200</span><span class="p">)</span>
</span><span id="CustomRegressor-242"><a href="#CustomRegressor-242"><span class="linenos">242</span></a>
</span><span id="CustomRegressor-243"><a href="#CustomRegressor-243"><span class="linenos">243</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="CustomRegressor-244"><a href="#CustomRegressor-244"><span class="linenos">244</span></a>
</span><span id="CustomRegressor-245"><a href="#CustomRegressor-245"><span class="linenos">245</span></a>                <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CustomRegressor-246"><a href="#CustomRegressor-246"><span class="linenos">246</span></a>                <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="CustomRegressor-247"><a href="#CustomRegressor-247"><span class="linenos">247</span></a>                    <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="CustomRegressor-248"><a href="#CustomRegressor-248"><span class="linenos">248</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="CustomRegressor-249"><a href="#CustomRegressor-249"><span class="linenos">249</span></a>                <span class="p">)</span>
</span><span id="CustomRegressor-250"><a href="#CustomRegressor-250"><span class="linenos">250</span></a>
</span><span id="CustomRegressor-251"><a href="#CustomRegressor-251"><span class="linenos">251</span></a>                <span class="n">mean_</span><span class="p">,</span> <span class="n">std_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="CustomRegressor-252"><a href="#CustomRegressor-252"><span class="linenos">252</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">True</span>
</span><span id="CustomRegressor-253"><a href="#CustomRegressor-253"><span class="linenos">253</span></a>                <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CustomRegressor-254"><a href="#CustomRegressor-254"><span class="linenos">254</span></a>
</span><span id="CustomRegressor-255"><a href="#CustomRegressor-255"><span class="linenos">255</span></a>                <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">mean_</span>
</span><span id="CustomRegressor-256"><a href="#CustomRegressor-256"><span class="linenos">256</span></a>                <span class="n">lower</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="p">(</span><span class="n">mean_</span> <span class="o">-</span> <span class="n">pi_multiplier</span> <span class="o">*</span> <span class="n">std_</span><span class="p">)</span>
</span><span id="CustomRegressor-257"><a href="#CustomRegressor-257"><span class="linenos">257</span></a>                <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="p">(</span><span class="n">mean_</span> <span class="o">+</span> <span class="n">pi_multiplier</span> <span class="o">*</span> <span class="n">std_</span><span class="p">)</span>
</span><span id="CustomRegressor-258"><a href="#CustomRegressor-258"><span class="linenos">258</span></a>
</span><span id="CustomRegressor-259"><a href="#CustomRegressor-259"><span class="linenos">259</span></a>                <span class="k">return</span> <span class="n">preds</span><span class="p">,</span> <span class="n">std_</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>
</span><span id="CustomRegressor-260"><a href="#CustomRegressor-260"><span class="linenos">260</span></a>
</span><span id="CustomRegressor-261"><a href="#CustomRegressor-261"><span class="linenos">261</span></a>            <span class="c1"># len(X.shape) &gt; 1</span>
</span><span id="CustomRegressor-262"><a href="#CustomRegressor-262"><span class="linenos">262</span></a>            <span class="n">mean_</span><span class="p">,</span> <span class="n">std_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="CustomRegressor-263"><a href="#CustomRegressor-263"><span class="linenos">263</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">True</span>
</span><span id="CustomRegressor-264"><a href="#CustomRegressor-264"><span class="linenos">264</span></a>            <span class="p">)</span>
</span><span id="CustomRegressor-265"><a href="#CustomRegressor-265"><span class="linenos">265</span></a>
</span><span id="CustomRegressor-266"><a href="#CustomRegressor-266"><span class="linenos">266</span></a>            <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">mean_</span>
</span><span id="CustomRegressor-267"><a href="#CustomRegressor-267"><span class="linenos">267</span></a>            <span class="n">lower</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="p">(</span><span class="n">mean_</span> <span class="o">-</span> <span class="n">pi_multiplier</span> <span class="o">*</span> <span class="n">std_</span><span class="p">)</span>
</span><span id="CustomRegressor-268"><a href="#CustomRegressor-268"><span class="linenos">268</span></a>            <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="p">(</span><span class="n">mean_</span> <span class="o">+</span> <span class="n">pi_multiplier</span> <span class="o">*</span> <span class="n">std_</span><span class="p">)</span>
</span><span id="CustomRegressor-269"><a href="#CustomRegressor-269"><span class="linenos">269</span></a>
</span><span id="CustomRegressor-270"><a href="#CustomRegressor-270"><span class="linenos">270</span></a>            <span class="k">return</span> <span class="n">preds</span><span class="p">,</span> <span class="n">std_</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>
</span><span id="CustomRegressor-271"><a href="#CustomRegressor-271"><span class="linenos">271</span></a>
</span><span id="CustomRegressor-272"><a href="#CustomRegressor-272"><span class="linenos">272</span></a>        <span class="k">if</span> <span class="s2">&quot;return_pi&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="CustomRegressor-273"><a href="#CustomRegressor-273"><span class="linenos">273</span></a>            <span class="k">assert</span> <span class="n">method</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="CustomRegressor-274"><a href="#CustomRegressor-274"><span class="linenos">274</span></a>                <span class="s2">&quot;splitconformal&quot;</span><span class="p">,</span>
</span><span id="CustomRegressor-275"><a href="#CustomRegressor-275"><span class="linenos">275</span></a>                <span class="s2">&quot;localconformal&quot;</span><span class="p">,</span>
</span><span id="CustomRegressor-276"><a href="#CustomRegressor-276"><span class="linenos">276</span></a>            <span class="p">),</span> <span class="s2">&quot;method must be in (&#39;splitconformal&#39;, &#39;localconformal&#39;)&quot;</span>
</span><span id="CustomRegressor-277"><a href="#CustomRegressor-277"><span class="linenos">277</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pi</span> <span class="o">=</span> <span class="n">PredictionInterval</span><span class="p">(</span>
</span><span id="CustomRegressor-278"><a href="#CustomRegressor-278"><span class="linenos">278</span></a>                <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="CustomRegressor-279"><a href="#CustomRegressor-279"><span class="linenos">279</span></a>                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
</span><span id="CustomRegressor-280"><a href="#CustomRegressor-280"><span class="linenos">280</span></a>                <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span>
</span><span id="CustomRegressor-281"><a href="#CustomRegressor-281"><span class="linenos">281</span></a>                <span class="n">type_pi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span><span class="p">,</span>
</span><span id="CustomRegressor-282"><a href="#CustomRegressor-282"><span class="linenos">282</span></a>                <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="CustomRegressor-283"><a href="#CustomRegressor-283"><span class="linenos">283</span></a>                <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="CustomRegressor-284"><a href="#CustomRegressor-284"><span class="linenos">284</span></a>            <span class="p">)</span>
</span><span id="CustomRegressor-285"><a href="#CustomRegressor-285"><span class="linenos">285</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pi</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">)</span>
</span><span id="CustomRegressor-286"><a href="#CustomRegressor-286"><span class="linenos">286</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CustomRegressor-287"><a href="#CustomRegressor-287"><span class="linenos">287</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">y_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CustomRegressor-288"><a href="#CustomRegressor-288"><span class="linenos">288</span></a>            <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pi</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">return_pi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CustomRegressor-289"><a href="#CustomRegressor-289"><span class="linenos">289</span></a>            <span class="k">return</span> <span class="n">preds</span>
</span><span id="CustomRegressor-290"><a href="#CustomRegressor-290"><span class="linenos">290</span></a>
</span><span id="CustomRegressor-291"><a href="#CustomRegressor-291"><span class="linenos">291</span></a>        <span class="c1"># &quot;return_std&quot; not in kwargs</span>
</span><span id="CustomRegressor-292"><a href="#CustomRegressor-292"><span class="linenos">292</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="CustomRegressor-293"><a href="#CustomRegressor-293"><span class="linenos">293</span></a>
</span><span id="CustomRegressor-294"><a href="#CustomRegressor-294"><span class="linenos">294</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CustomRegressor-295"><a href="#CustomRegressor-295"><span class="linenos">295</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="CustomRegressor-296"><a href="#CustomRegressor-296"><span class="linenos">296</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="CustomRegressor-297"><a href="#CustomRegressor-297"><span class="linenos">297</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="CustomRegressor-298"><a href="#CustomRegressor-298"><span class="linenos">298</span></a>            <span class="p">)</span>
</span><span id="CustomRegressor-299"><a href="#CustomRegressor-299"><span class="linenos">299</span></a>
</span><span id="CustomRegressor-300"><a href="#CustomRegressor-300"><span class="linenos">300</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="CustomRegressor-301"><a href="#CustomRegressor-301"><span class="linenos">301</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span>
</span><span id="CustomRegressor-302"><a href="#CustomRegressor-302"><span class="linenos">302</span></a>                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="CustomRegressor-303"><a href="#CustomRegressor-303"><span class="linenos">303</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="CustomRegressor-304"><a href="#CustomRegressor-304"><span class="linenos">304</span></a>                <span class="p">)</span>
</span><span id="CustomRegressor-305"><a href="#CustomRegressor-305"><span class="linenos">305</span></a>            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CustomRegressor-306"><a href="#CustomRegressor-306"><span class="linenos">306</span></a>
</span><span id="CustomRegressor-307"><a href="#CustomRegressor-307"><span class="linenos">307</span></a>        <span class="c1"># len(X.shape) &gt; 1</span>
</span><span id="CustomRegressor-308"><a href="#CustomRegressor-308"><span class="linenos">308</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="CustomRegressor-309"><a href="#CustomRegressor-309"><span class="linenos">309</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="CustomRegressor-310"><a href="#CustomRegressor-310"><span class="linenos">310</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Custom Regression model</p>

<p>This class is used to 'augment' any regression model with transformed features.</p>

<p>Parameters:</p>

<pre><code>obj: object
    any object containing a method fit (obj.fit()) and a method predict
    (obj.predict())

n_hidden_features: int
    number of nodes in the hidden layer

activation_name: str
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'

a: float
    hyperparameter for 'prelu' or 'elu' activation function

nodes_sim: str
    type of simulation for the nodes: 'sobol', 'hammersley', 'halton',
    'uniform'

bias: boolean
    indicates if the hidden layer contains a bias term (True) or not
    (False)

dropout: float
    regularization parameter; (random) percentage of nodes dropped out
    of the training

direct_link: boolean
    indicates if the original predictors are included (True) in model's
    fitting or not (False)

n_clusters: int
    number of clusters for 'kmeans' or 'gmm' clustering (could be 0:
        no clustering)

cluster_encode: bool
    defines how the variable containing clusters is treated (default is one-hot)
    if `False`, then labels are used, without one-hot encoding

type_clust: str
    type of clustering method: currently k-means ('kmeans') or Gaussian
    Mixture Model ('gmm')

type_scaling: a tuple of 3 strings
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax')

type_pi: str.
    type of prediction interval; currently "kde" (default) or "bootstrap".
    Used only in `self.predict`, for `self.replications` &gt; 0 and `self.kernel`
    in ('gaussian', 'tophat'). Default is `None`.

replications: int.
    number of replications (if needed) for predictive simulation.
    Used only in `self.predict`, for `self.kernel` in ('gaussian',
    'tophat') and `self.type_pi = 'kde'`. Default is `None`.

kernel: str.
    the kernel to use for kernel density estimation (used for predictive
    simulation in `self.predict`, with `method='splitconformal'` and
    `type_pi = 'kde'`). Currently, either 'gaussian' or 'tophat'.

type_split: str.
    Type of splitting for conformal prediction. None (default), or
    "random" (random split of data) or "sequential" (sequential split of data)

col_sample: float
    percentage of covariates randomly chosen for training

row_sample: float
    percentage of rows chosen for training, by stratified bootstrapping

seed: int
    reproducibility seed for nodes_sim=='uniform'

type_fit: str
    'regression'

backend: str
    "cpu" or "gpu" or "tpu"
</code></pre>

<p>Examples:</p>

<p>See <a href="https://thierrymoudiki.github.io/blog/2024/03/18/python/conformal-and-bayesian-regression">https://thierrymoudiki.github.io/blog/2024/03/18/python/conformal-and-bayesian-regression</a></p>
</div>


                                <div id="CustomRegressor.fit" class="classattr">
                                            <input id="CustomRegressor.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CustomRegressor.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CustomRegressor.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CustomRegressor.fit-159"><a href="#CustomRegressor.fit-159"><span class="linenos">159</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="CustomRegressor.fit-160"><a href="#CustomRegressor.fit-160"><span class="linenos">160</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit custom model to training data (X, y).</span>
</span><span id="CustomRegressor.fit-161"><a href="#CustomRegressor.fit-161"><span class="linenos">161</span></a>
</span><span id="CustomRegressor.fit-162"><a href="#CustomRegressor.fit-162"><span class="linenos">162</span></a><span class="sd">        Parameters:</span>
</span><span id="CustomRegressor.fit-163"><a href="#CustomRegressor.fit-163"><span class="linenos">163</span></a>
</span><span id="CustomRegressor.fit-164"><a href="#CustomRegressor.fit-164"><span class="linenos">164</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="CustomRegressor.fit-165"><a href="#CustomRegressor.fit-165"><span class="linenos">165</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="CustomRegressor.fit-166"><a href="#CustomRegressor.fit-166"><span class="linenos">166</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="CustomRegressor.fit-167"><a href="#CustomRegressor.fit-167"><span class="linenos">167</span></a>
</span><span id="CustomRegressor.fit-168"><a href="#CustomRegressor.fit-168"><span class="linenos">168</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="CustomRegressor.fit-169"><a href="#CustomRegressor.fit-169"><span class="linenos">169</span></a><span class="sd">                Target values.</span>
</span><span id="CustomRegressor.fit-170"><a href="#CustomRegressor.fit-170"><span class="linenos">170</span></a>
</span><span id="CustomRegressor.fit-171"><a href="#CustomRegressor.fit-171"><span class="linenos">171</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="CustomRegressor.fit-172"><a href="#CustomRegressor.fit-172"><span class="linenos">172</span></a><span class="sd">                self.cook_training_set or self.obj.fit</span>
</span><span id="CustomRegressor.fit-173"><a href="#CustomRegressor.fit-173"><span class="linenos">173</span></a>
</span><span id="CustomRegressor.fit-174"><a href="#CustomRegressor.fit-174"><span class="linenos">174</span></a><span class="sd">        Returns:</span>
</span><span id="CustomRegressor.fit-175"><a href="#CustomRegressor.fit-175"><span class="linenos">175</span></a>
</span><span id="CustomRegressor.fit-176"><a href="#CustomRegressor.fit-176"><span class="linenos">176</span></a><span class="sd">            self: object</span>
</span><span id="CustomRegressor.fit-177"><a href="#CustomRegressor.fit-177"><span class="linenos">177</span></a>
</span><span id="CustomRegressor.fit-178"><a href="#CustomRegressor.fit-178"><span class="linenos">178</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CustomRegressor.fit-179"><a href="#CustomRegressor.fit-179"><span class="linenos">179</span></a>
</span><span id="CustomRegressor.fit-180"><a href="#CustomRegressor.fit-180"><span class="linenos">180</span></a>        <span class="n">centered_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="CustomRegressor.fit-181"><a href="#CustomRegressor.fit-181"><span class="linenos">181</span></a>
</span><span id="CustomRegressor.fit-182"><a href="#CustomRegressor.fit-182"><span class="linenos">182</span></a>        <span class="c1"># if sample_weights, else: (must use self.row_index)</span>
</span><span id="CustomRegressor.fit-183"><a href="#CustomRegressor.fit-183"><span class="linenos">183</span></a>        <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="CustomRegressor.fit-184"><a href="#CustomRegressor.fit-184"><span class="linenos">184</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="CustomRegressor.fit-185"><a href="#CustomRegressor.fit-185"><span class="linenos">185</span></a>                <span class="n">scaled_Z</span><span class="p">,</span>
</span><span id="CustomRegressor.fit-186"><a href="#CustomRegressor.fit-186"><span class="linenos">186</span></a>                <span class="n">centered_y</span><span class="p">,</span>
</span><span id="CustomRegressor.fit-187"><a href="#CustomRegressor.fit-187"><span class="linenos">187</span></a>                <span class="n">sample_weight</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)[</span>
</span><span id="CustomRegressor.fit-188"><a href="#CustomRegressor.fit-188"><span class="linenos">188</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">index_row</span>
</span><span id="CustomRegressor.fit-189"><a href="#CustomRegressor.fit-189"><span class="linenos">189</span></a>                <span class="p">],</span>
</span><span id="CustomRegressor.fit-190"><a href="#CustomRegressor.fit-190"><span class="linenos">190</span></a>                <span class="o">**</span><span class="n">kwargs</span>
</span><span id="CustomRegressor.fit-191"><a href="#CustomRegressor.fit-191"><span class="linenos">191</span></a>            <span class="p">)</span>
</span><span id="CustomRegressor.fit-192"><a href="#CustomRegressor.fit-192"><span class="linenos">192</span></a>
</span><span id="CustomRegressor.fit-193"><a href="#CustomRegressor.fit-193"><span class="linenos">193</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="CustomRegressor.fit-194"><a href="#CustomRegressor.fit-194"><span class="linenos">194</span></a>
</span><span id="CustomRegressor.fit-195"><a href="#CustomRegressor.fit-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">centered_y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="CustomRegressor.fit-196"><a href="#CustomRegressor.fit-196"><span class="linenos">196</span></a>
</span><span id="CustomRegressor.fit-197"><a href="#CustomRegressor.fit-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="n">X</span>
</span><span id="CustomRegressor.fit-198"><a href="#CustomRegressor.fit-198"><span class="linenos">198</span></a>
</span><span id="CustomRegressor.fit-199"><a href="#CustomRegressor.fit-199"><span class="linenos">199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="CustomRegressor.fit-200"><a href="#CustomRegressor.fit-200"><span class="linenos">200</span></a>
</span><span id="CustomRegressor.fit-201"><a href="#CustomRegressor.fit-201"><span class="linenos">201</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit custom model to training data (X, y).</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

y: array-like, shape = [n_samples]
    Target values.

**kwargs: additional parameters to be passed to
    self.cook_training_set or self.obj.fit
</code></pre>

<p>Returns:</p>

<pre><code>self: object
</code></pre>
</div>


                                </div>
                                <div id="CustomRegressor.predict" class="classattr">
                                            <input id="CustomRegressor.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">level</span><span class="o">=</span><span class="mi">95</span>, </span><span class="param"><span class="n">method</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="CustomRegressor.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#CustomRegressor.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="CustomRegressor.predict-203"><a href="#CustomRegressor.predict-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="CustomRegressor.predict-204"><a href="#CustomRegressor.predict-204"><span class="linenos">204</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="CustomRegressor.predict-205"><a href="#CustomRegressor.predict-205"><span class="linenos">205</span></a>
</span><span id="CustomRegressor.predict-206"><a href="#CustomRegressor.predict-206"><span class="linenos">206</span></a><span class="sd">        Parameters:</span>
</span><span id="CustomRegressor.predict-207"><a href="#CustomRegressor.predict-207"><span class="linenos">207</span></a>
</span><span id="CustomRegressor.predict-208"><a href="#CustomRegressor.predict-208"><span class="linenos">208</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="CustomRegressor.predict-209"><a href="#CustomRegressor.predict-209"><span class="linenos">209</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="CustomRegressor.predict-210"><a href="#CustomRegressor.predict-210"><span class="linenos">210</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="CustomRegressor.predict-211"><a href="#CustomRegressor.predict-211"><span class="linenos">211</span></a>
</span><span id="CustomRegressor.predict-212"><a href="#CustomRegressor.predict-212"><span class="linenos">212</span></a><span class="sd">            level: int</span>
</span><span id="CustomRegressor.predict-213"><a href="#CustomRegressor.predict-213"><span class="linenos">213</span></a><span class="sd">                Level of confidence (default = 95)</span>
</span><span id="CustomRegressor.predict-214"><a href="#CustomRegressor.predict-214"><span class="linenos">214</span></a>
</span><span id="CustomRegressor.predict-215"><a href="#CustomRegressor.predict-215"><span class="linenos">215</span></a><span class="sd">            method: str</span>
</span><span id="CustomRegressor.predict-216"><a href="#CustomRegressor.predict-216"><span class="linenos">216</span></a><span class="sd">                `None`, or &#39;splitconformal&#39;, &#39;localconformal&#39;</span>
</span><span id="CustomRegressor.predict-217"><a href="#CustomRegressor.predict-217"><span class="linenos">217</span></a><span class="sd">                prediction (if you specify `return_pi = True`)</span>
</span><span id="CustomRegressor.predict-218"><a href="#CustomRegressor.predict-218"><span class="linenos">218</span></a>
</span><span id="CustomRegressor.predict-219"><a href="#CustomRegressor.predict-219"><span class="linenos">219</span></a><span class="sd">            **kwargs: additional parameters</span>
</span><span id="CustomRegressor.predict-220"><a href="#CustomRegressor.predict-220"><span class="linenos">220</span></a><span class="sd">                    `return_pi = True` for conformal prediction,</span>
</span><span id="CustomRegressor.predict-221"><a href="#CustomRegressor.predict-221"><span class="linenos">221</span></a><span class="sd">                    with `method` in (&#39;splitconformal&#39;, &#39;localconformal&#39;)</span>
</span><span id="CustomRegressor.predict-222"><a href="#CustomRegressor.predict-222"><span class="linenos">222</span></a><span class="sd">                    or `return_std = True` for `self.obj` in</span>
</span><span id="CustomRegressor.predict-223"><a href="#CustomRegressor.predict-223"><span class="linenos">223</span></a><span class="sd">                    (`sklearn.linear_model.BayesianRidge`,</span>
</span><span id="CustomRegressor.predict-224"><a href="#CustomRegressor.predict-224"><span class="linenos">224</span></a><span class="sd">                    `sklearn.linear_model.ARDRegressor`,</span>
</span><span id="CustomRegressor.predict-225"><a href="#CustomRegressor.predict-225"><span class="linenos">225</span></a><span class="sd">                    `sklearn.gaussian_process.GaussianProcessRegressor`)`</span>
</span><span id="CustomRegressor.predict-226"><a href="#CustomRegressor.predict-226"><span class="linenos">226</span></a>
</span><span id="CustomRegressor.predict-227"><a href="#CustomRegressor.predict-227"><span class="linenos">227</span></a><span class="sd">        Returns:</span>
</span><span id="CustomRegressor.predict-228"><a href="#CustomRegressor.predict-228"><span class="linenos">228</span></a>
</span><span id="CustomRegressor.predict-229"><a href="#CustomRegressor.predict-229"><span class="linenos">229</span></a><span class="sd">            model predictions:</span>
</span><span id="CustomRegressor.predict-230"><a href="#CustomRegressor.predict-230"><span class="linenos">230</span></a><span class="sd">                an array if uncertainty quantification is not requested,</span>
</span><span id="CustomRegressor.predict-231"><a href="#CustomRegressor.predict-231"><span class="linenos">231</span></a><span class="sd">                  or a tuple if with prediction intervals and simulations</span>
</span><span id="CustomRegressor.predict-232"><a href="#CustomRegressor.predict-232"><span class="linenos">232</span></a><span class="sd">                  if `return_std = True` (mean, standard deviation,</span>
</span><span id="CustomRegressor.predict-233"><a href="#CustomRegressor.predict-233"><span class="linenos">233</span></a><span class="sd">                  lower and upper prediction interval) or `return_pi = True`</span>
</span><span id="CustomRegressor.predict-234"><a href="#CustomRegressor.predict-234"><span class="linenos">234</span></a><span class="sd">                  ()</span>
</span><span id="CustomRegressor.predict-235"><a href="#CustomRegressor.predict-235"><span class="linenos">235</span></a>
</span><span id="CustomRegressor.predict-236"><a href="#CustomRegressor.predict-236"><span class="linenos">236</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="CustomRegressor.predict-237"><a href="#CustomRegressor.predict-237"><span class="linenos">237</span></a>
</span><span id="CustomRegressor.predict-238"><a href="#CustomRegressor.predict-238"><span class="linenos">238</span></a>        <span class="k">if</span> <span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="CustomRegressor.predict-239"><a href="#CustomRegressor.predict-239"><span class="linenos">239</span></a>
</span><span id="CustomRegressor.predict-240"><a href="#CustomRegressor.predict-240"><span class="linenos">240</span></a>            <span class="n">alpha</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">level</span>
</span><span id="CustomRegressor.predict-241"><a href="#CustomRegressor.predict-241"><span class="linenos">241</span></a>            <span class="n">pi_multiplier</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">200</span><span class="p">)</span>
</span><span id="CustomRegressor.predict-242"><a href="#CustomRegressor.predict-242"><span class="linenos">242</span></a>
</span><span id="CustomRegressor.predict-243"><a href="#CustomRegressor.predict-243"><span class="linenos">243</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="CustomRegressor.predict-244"><a href="#CustomRegressor.predict-244"><span class="linenos">244</span></a>
</span><span id="CustomRegressor.predict-245"><a href="#CustomRegressor.predict-245"><span class="linenos">245</span></a>                <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CustomRegressor.predict-246"><a href="#CustomRegressor.predict-246"><span class="linenos">246</span></a>                <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="CustomRegressor.predict-247"><a href="#CustomRegressor.predict-247"><span class="linenos">247</span></a>                    <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="CustomRegressor.predict-248"><a href="#CustomRegressor.predict-248"><span class="linenos">248</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="CustomRegressor.predict-249"><a href="#CustomRegressor.predict-249"><span class="linenos">249</span></a>                <span class="p">)</span>
</span><span id="CustomRegressor.predict-250"><a href="#CustomRegressor.predict-250"><span class="linenos">250</span></a>
</span><span id="CustomRegressor.predict-251"><a href="#CustomRegressor.predict-251"><span class="linenos">251</span></a>                <span class="n">mean_</span><span class="p">,</span> <span class="n">std_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="CustomRegressor.predict-252"><a href="#CustomRegressor.predict-252"><span class="linenos">252</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">True</span>
</span><span id="CustomRegressor.predict-253"><a href="#CustomRegressor.predict-253"><span class="linenos">253</span></a>                <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CustomRegressor.predict-254"><a href="#CustomRegressor.predict-254"><span class="linenos">254</span></a>
</span><span id="CustomRegressor.predict-255"><a href="#CustomRegressor.predict-255"><span class="linenos">255</span></a>                <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">mean_</span>
</span><span id="CustomRegressor.predict-256"><a href="#CustomRegressor.predict-256"><span class="linenos">256</span></a>                <span class="n">lower</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="p">(</span><span class="n">mean_</span> <span class="o">-</span> <span class="n">pi_multiplier</span> <span class="o">*</span> <span class="n">std_</span><span class="p">)</span>
</span><span id="CustomRegressor.predict-257"><a href="#CustomRegressor.predict-257"><span class="linenos">257</span></a>                <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="p">(</span><span class="n">mean_</span> <span class="o">+</span> <span class="n">pi_multiplier</span> <span class="o">*</span> <span class="n">std_</span><span class="p">)</span>
</span><span id="CustomRegressor.predict-258"><a href="#CustomRegressor.predict-258"><span class="linenos">258</span></a>
</span><span id="CustomRegressor.predict-259"><a href="#CustomRegressor.predict-259"><span class="linenos">259</span></a>                <span class="k">return</span> <span class="n">preds</span><span class="p">,</span> <span class="n">std_</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>
</span><span id="CustomRegressor.predict-260"><a href="#CustomRegressor.predict-260"><span class="linenos">260</span></a>
</span><span id="CustomRegressor.predict-261"><a href="#CustomRegressor.predict-261"><span class="linenos">261</span></a>            <span class="c1"># len(X.shape) &gt; 1</span>
</span><span id="CustomRegressor.predict-262"><a href="#CustomRegressor.predict-262"><span class="linenos">262</span></a>            <span class="n">mean_</span><span class="p">,</span> <span class="n">std_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="CustomRegressor.predict-263"><a href="#CustomRegressor.predict-263"><span class="linenos">263</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">True</span>
</span><span id="CustomRegressor.predict-264"><a href="#CustomRegressor.predict-264"><span class="linenos">264</span></a>            <span class="p">)</span>
</span><span id="CustomRegressor.predict-265"><a href="#CustomRegressor.predict-265"><span class="linenos">265</span></a>
</span><span id="CustomRegressor.predict-266"><a href="#CustomRegressor.predict-266"><span class="linenos">266</span></a>            <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">mean_</span>
</span><span id="CustomRegressor.predict-267"><a href="#CustomRegressor.predict-267"><span class="linenos">267</span></a>            <span class="n">lower</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="p">(</span><span class="n">mean_</span> <span class="o">-</span> <span class="n">pi_multiplier</span> <span class="o">*</span> <span class="n">std_</span><span class="p">)</span>
</span><span id="CustomRegressor.predict-268"><a href="#CustomRegressor.predict-268"><span class="linenos">268</span></a>            <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="p">(</span><span class="n">mean_</span> <span class="o">+</span> <span class="n">pi_multiplier</span> <span class="o">*</span> <span class="n">std_</span><span class="p">)</span>
</span><span id="CustomRegressor.predict-269"><a href="#CustomRegressor.predict-269"><span class="linenos">269</span></a>
</span><span id="CustomRegressor.predict-270"><a href="#CustomRegressor.predict-270"><span class="linenos">270</span></a>            <span class="k">return</span> <span class="n">preds</span><span class="p">,</span> <span class="n">std_</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>
</span><span id="CustomRegressor.predict-271"><a href="#CustomRegressor.predict-271"><span class="linenos">271</span></a>
</span><span id="CustomRegressor.predict-272"><a href="#CustomRegressor.predict-272"><span class="linenos">272</span></a>        <span class="k">if</span> <span class="s2">&quot;return_pi&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="CustomRegressor.predict-273"><a href="#CustomRegressor.predict-273"><span class="linenos">273</span></a>            <span class="k">assert</span> <span class="n">method</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="CustomRegressor.predict-274"><a href="#CustomRegressor.predict-274"><span class="linenos">274</span></a>                <span class="s2">&quot;splitconformal&quot;</span><span class="p">,</span>
</span><span id="CustomRegressor.predict-275"><a href="#CustomRegressor.predict-275"><span class="linenos">275</span></a>                <span class="s2">&quot;localconformal&quot;</span><span class="p">,</span>
</span><span id="CustomRegressor.predict-276"><a href="#CustomRegressor.predict-276"><span class="linenos">276</span></a>            <span class="p">),</span> <span class="s2">&quot;method must be in (&#39;splitconformal&#39;, &#39;localconformal&#39;)&quot;</span>
</span><span id="CustomRegressor.predict-277"><a href="#CustomRegressor.predict-277"><span class="linenos">277</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pi</span> <span class="o">=</span> <span class="n">PredictionInterval</span><span class="p">(</span>
</span><span id="CustomRegressor.predict-278"><a href="#CustomRegressor.predict-278"><span class="linenos">278</span></a>                <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="CustomRegressor.predict-279"><a href="#CustomRegressor.predict-279"><span class="linenos">279</span></a>                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
</span><span id="CustomRegressor.predict-280"><a href="#CustomRegressor.predict-280"><span class="linenos">280</span></a>                <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span>
</span><span id="CustomRegressor.predict-281"><a href="#CustomRegressor.predict-281"><span class="linenos">281</span></a>                <span class="n">type_pi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span><span class="p">,</span>
</span><span id="CustomRegressor.predict-282"><a href="#CustomRegressor.predict-282"><span class="linenos">282</span></a>                <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="CustomRegressor.predict-283"><a href="#CustomRegressor.predict-283"><span class="linenos">283</span></a>                <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="CustomRegressor.predict-284"><a href="#CustomRegressor.predict-284"><span class="linenos">284</span></a>            <span class="p">)</span>
</span><span id="CustomRegressor.predict-285"><a href="#CustomRegressor.predict-285"><span class="linenos">285</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pi</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">)</span>
</span><span id="CustomRegressor.predict-286"><a href="#CustomRegressor.predict-286"><span class="linenos">286</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CustomRegressor.predict-287"><a href="#CustomRegressor.predict-287"><span class="linenos">287</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">y_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="CustomRegressor.predict-288"><a href="#CustomRegressor.predict-288"><span class="linenos">288</span></a>            <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pi</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">return_pi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="CustomRegressor.predict-289"><a href="#CustomRegressor.predict-289"><span class="linenos">289</span></a>            <span class="k">return</span> <span class="n">preds</span>
</span><span id="CustomRegressor.predict-290"><a href="#CustomRegressor.predict-290"><span class="linenos">290</span></a>
</span><span id="CustomRegressor.predict-291"><a href="#CustomRegressor.predict-291"><span class="linenos">291</span></a>        <span class="c1"># &quot;return_std&quot; not in kwargs</span>
</span><span id="CustomRegressor.predict-292"><a href="#CustomRegressor.predict-292"><span class="linenos">292</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="CustomRegressor.predict-293"><a href="#CustomRegressor.predict-293"><span class="linenos">293</span></a>
</span><span id="CustomRegressor.predict-294"><a href="#CustomRegressor.predict-294"><span class="linenos">294</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CustomRegressor.predict-295"><a href="#CustomRegressor.predict-295"><span class="linenos">295</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="CustomRegressor.predict-296"><a href="#CustomRegressor.predict-296"><span class="linenos">296</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="CustomRegressor.predict-297"><a href="#CustomRegressor.predict-297"><span class="linenos">297</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="CustomRegressor.predict-298"><a href="#CustomRegressor.predict-298"><span class="linenos">298</span></a>            <span class="p">)</span>
</span><span id="CustomRegressor.predict-299"><a href="#CustomRegressor.predict-299"><span class="linenos">299</span></a>
</span><span id="CustomRegressor.predict-300"><a href="#CustomRegressor.predict-300"><span class="linenos">300</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="CustomRegressor.predict-301"><a href="#CustomRegressor.predict-301"><span class="linenos">301</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span>
</span><span id="CustomRegressor.predict-302"><a href="#CustomRegressor.predict-302"><span class="linenos">302</span></a>                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="CustomRegressor.predict-303"><a href="#CustomRegressor.predict-303"><span class="linenos">303</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="CustomRegressor.predict-304"><a href="#CustomRegressor.predict-304"><span class="linenos">304</span></a>                <span class="p">)</span>
</span><span id="CustomRegressor.predict-305"><a href="#CustomRegressor.predict-305"><span class="linenos">305</span></a>            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="CustomRegressor.predict-306"><a href="#CustomRegressor.predict-306"><span class="linenos">306</span></a>
</span><span id="CustomRegressor.predict-307"><a href="#CustomRegressor.predict-307"><span class="linenos">307</span></a>        <span class="c1"># len(X.shape) &gt; 1</span>
</span><span id="CustomRegressor.predict-308"><a href="#CustomRegressor.predict-308"><span class="linenos">308</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="CustomRegressor.predict-309"><a href="#CustomRegressor.predict-309"><span class="linenos">309</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="CustomRegressor.predict-310"><a href="#CustomRegressor.predict-310"><span class="linenos">310</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict test data X.</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

level: int
    Level of confidence (default = 95)

method: str
    `None`, or 'splitconformal', 'localconformal'
    prediction (if you specify `return_pi = True`)

**kwargs: additional parameters
        `return_pi = True` for conformal prediction,
        with `method` in ('splitconformal', 'localconformal')
        or `return_std = True` for `self.obj` in
        (`sklearn.linear_model.BayesianRidge`,
        `sklearn.linear_model.ARDRegressor`,
        `sklearn.gaussian_process.GaussianProcessRegressor`)`
</code></pre>

<p>Returns:</p>

<pre><code>model predictions:
    an array if uncertainty quantification is not requested,
      or a tuple if with prediction intervals and simulations
      if `return_std = True` (mean, standard deviation,
      lower and upper prediction interval) or `return_pi = True`
      ()
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="DeepClassifier">
                            <input id="DeepClassifier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DeepClassifier</span><wbr>(<span class="base"><a href="#CustomClassifier">nnetsauce.CustomClassifier</a></span>, <span class="base">sklearn.base.ClassifierMixin</span>):

                <label class="view-source-button" for="DeepClassifier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DeepClassifier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DeepClassifier-12"><a href="#DeepClassifier-12"><span class="linenos"> 12</span></a><span class="k">class</span> <span class="nc">DeepClassifier</span><span class="p">(</span><span class="n">CustomClassifier</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">):</span>
</span><span id="DeepClassifier-13"><a href="#DeepClassifier-13"><span class="linenos"> 13</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DeepClassifier-14"><a href="#DeepClassifier-14"><span class="linenos"> 14</span></a><span class="sd">    Deep Classifier</span>
</span><span id="DeepClassifier-15"><a href="#DeepClassifier-15"><span class="linenos"> 15</span></a>
</span><span id="DeepClassifier-16"><a href="#DeepClassifier-16"><span class="linenos"> 16</span></a><span class="sd">    Parameters:</span>
</span><span id="DeepClassifier-17"><a href="#DeepClassifier-17"><span class="linenos"> 17</span></a>
</span><span id="DeepClassifier-18"><a href="#DeepClassifier-18"><span class="linenos"> 18</span></a><span class="sd">        verbose : int, optional (default=0)</span>
</span><span id="DeepClassifier-19"><a href="#DeepClassifier-19"><span class="linenos"> 19</span></a><span class="sd">            Monitor progress when fitting.</span>
</span><span id="DeepClassifier-20"><a href="#DeepClassifier-20"><span class="linenos"> 20</span></a>
</span><span id="DeepClassifier-21"><a href="#DeepClassifier-21"><span class="linenos"> 21</span></a><span class="sd">    Examples:</span>
</span><span id="DeepClassifier-22"><a href="#DeepClassifier-22"><span class="linenos"> 22</span></a>
</span><span id="DeepClassifier-23"><a href="#DeepClassifier-23"><span class="linenos"> 23</span></a><span class="sd">        ```python</span>
</span><span id="DeepClassifier-24"><a href="#DeepClassifier-24"><span class="linenos"> 24</span></a><span class="sd">        import nnetsauce as ns</span>
</span><span id="DeepClassifier-25"><a href="#DeepClassifier-25"><span class="linenos"> 25</span></a><span class="sd">        from sklearn.datasets import load_breast_cancer</span>
</span><span id="DeepClassifier-26"><a href="#DeepClassifier-26"><span class="linenos"> 26</span></a><span class="sd">        from sklearn.model_selection import train_test_split</span>
</span><span id="DeepClassifier-27"><a href="#DeepClassifier-27"><span class="linenos"> 27</span></a><span class="sd">        from sklearn.linear_model import LogisticRegressionCV</span>
</span><span id="DeepClassifier-28"><a href="#DeepClassifier-28"><span class="linenos"> 28</span></a><span class="sd">        data = load_breast_cancer()</span>
</span><span id="DeepClassifier-29"><a href="#DeepClassifier-29"><span class="linenos"> 29</span></a><span class="sd">        X = data.data</span>
</span><span id="DeepClassifier-30"><a href="#DeepClassifier-30"><span class="linenos"> 30</span></a><span class="sd">        y= data.target</span>
</span><span id="DeepClassifier-31"><a href="#DeepClassifier-31"><span class="linenos"> 31</span></a><span class="sd">        X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=.2, random_state=123)</span>
</span><span id="DeepClassifier-32"><a href="#DeepClassifier-32"><span class="linenos"> 32</span></a><span class="sd">        obj = LogisticRegressionCV()</span>
</span><span id="DeepClassifier-33"><a href="#DeepClassifier-33"><span class="linenos"> 33</span></a><span class="sd">        clf = ns.DeepClassifier(obj)</span>
</span><span id="DeepClassifier-34"><a href="#DeepClassifier-34"><span class="linenos"> 34</span></a><span class="sd">        clf.fit(X_train, y_train)</span>
</span><span id="DeepClassifier-35"><a href="#DeepClassifier-35"><span class="linenos"> 35</span></a><span class="sd">        print(clf.score(clf.predict(X_test), y_test))</span>
</span><span id="DeepClassifier-36"><a href="#DeepClassifier-36"><span class="linenos"> 36</span></a><span class="sd">        ```</span>
</span><span id="DeepClassifier-37"><a href="#DeepClassifier-37"><span class="linenos"> 37</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DeepClassifier-38"><a href="#DeepClassifier-38"><span class="linenos"> 38</span></a>
</span><span id="DeepClassifier-39"><a href="#DeepClassifier-39"><span class="linenos"> 39</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="DeepClassifier-40"><a href="#DeepClassifier-40"><span class="linenos"> 40</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DeepClassifier-41"><a href="#DeepClassifier-41"><span class="linenos"> 41</span></a>        <span class="n">obj</span><span class="p">,</span>
</span><span id="DeepClassifier-42"><a href="#DeepClassifier-42"><span class="linenos"> 42</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="DeepClassifier-43"><a href="#DeepClassifier-43"><span class="linenos"> 43</span></a>        <span class="c1"># Defining depth</span>
</span><span id="DeepClassifier-44"><a href="#DeepClassifier-44"><span class="linenos"> 44</span></a>        <span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="DeepClassifier-45"><a href="#DeepClassifier-45"><span class="linenos"> 45</span></a>        <span class="c1"># CustomClassifier attributes</span>
</span><span id="DeepClassifier-46"><a href="#DeepClassifier-46"><span class="linenos"> 46</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="DeepClassifier-47"><a href="#DeepClassifier-47"><span class="linenos"> 47</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="DeepClassifier-48"><a href="#DeepClassifier-48"><span class="linenos"> 48</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="DeepClassifier-49"><a href="#DeepClassifier-49"><span class="linenos"> 49</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="DeepClassifier-50"><a href="#DeepClassifier-50"><span class="linenos"> 50</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DeepClassifier-51"><a href="#DeepClassifier-51"><span class="linenos"> 51</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="DeepClassifier-52"><a href="#DeepClassifier-52"><span class="linenos"> 52</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DeepClassifier-53"><a href="#DeepClassifier-53"><span class="linenos"> 53</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="DeepClassifier-54"><a href="#DeepClassifier-54"><span class="linenos"> 54</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DeepClassifier-55"><a href="#DeepClassifier-55"><span class="linenos"> 55</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="DeepClassifier-56"><a href="#DeepClassifier-56"><span class="linenos"> 56</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="DeepClassifier-57"><a href="#DeepClassifier-57"><span class="linenos"> 57</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="DeepClassifier-58"><a href="#DeepClassifier-58"><span class="linenos"> 58</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="DeepClassifier-59"><a href="#DeepClassifier-59"><span class="linenos"> 59</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="DeepClassifier-60"><a href="#DeepClassifier-60"><span class="linenos"> 60</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="DeepClassifier-61"><a href="#DeepClassifier-61"><span class="linenos"> 61</span></a>    <span class="p">):</span>
</span><span id="DeepClassifier-62"><a href="#DeepClassifier-62"><span class="linenos"> 62</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="DeepClassifier-63"><a href="#DeepClassifier-63"><span class="linenos"> 63</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="DeepClassifier-64"><a href="#DeepClassifier-64"><span class="linenos"> 64</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="DeepClassifier-65"><a href="#DeepClassifier-65"><span class="linenos"> 65</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="DeepClassifier-66"><a href="#DeepClassifier-66"><span class="linenos"> 66</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="DeepClassifier-67"><a href="#DeepClassifier-67"><span class="linenos"> 67</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="DeepClassifier-68"><a href="#DeepClassifier-68"><span class="linenos"> 68</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="DeepClassifier-69"><a href="#DeepClassifier-69"><span class="linenos"> 69</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="DeepClassifier-70"><a href="#DeepClassifier-70"><span class="linenos"> 70</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="DeepClassifier-71"><a href="#DeepClassifier-71"><span class="linenos"> 71</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="DeepClassifier-72"><a href="#DeepClassifier-72"><span class="linenos"> 72</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="DeepClassifier-73"><a href="#DeepClassifier-73"><span class="linenos"> 73</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="DeepClassifier-74"><a href="#DeepClassifier-74"><span class="linenos"> 74</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="DeepClassifier-75"><a href="#DeepClassifier-75"><span class="linenos"> 75</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="DeepClassifier-76"><a href="#DeepClassifier-76"><span class="linenos"> 76</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="DeepClassifier-77"><a href="#DeepClassifier-77"><span class="linenos"> 77</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="DeepClassifier-78"><a href="#DeepClassifier-78"><span class="linenos"> 78</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="DeepClassifier-79"><a href="#DeepClassifier-79"><span class="linenos"> 79</span></a>        <span class="p">)</span>
</span><span id="DeepClassifier-80"><a href="#DeepClassifier-80"><span class="linenos"> 80</span></a>
</span><span id="DeepClassifier-81"><a href="#DeepClassifier-81"><span class="linenos"> 81</span></a>        <span class="k">assert</span> <span class="n">n_layers</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;must have n_layers &gt;= 2&quot;</span>
</span><span id="DeepClassifier-82"><a href="#DeepClassifier-82"><span class="linenos"> 82</span></a>
</span><span id="DeepClassifier-83"><a href="#DeepClassifier-83"><span class="linenos"> 83</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span> <span class="o">=</span> <span class="n">obj</span>
</span><span id="DeepClassifier-84"><a href="#DeepClassifier-84"><span class="linenos"> 84</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="DeepClassifier-85"><a href="#DeepClassifier-85"><span class="linenos"> 85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">=</span> <span class="n">n_layers</span>
</span><span id="DeepClassifier-86"><a href="#DeepClassifier-86"><span class="linenos"> 86</span></a>
</span><span id="DeepClassifier-87"><a href="#DeepClassifier-87"><span class="linenos"> 87</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="DeepClassifier-88"><a href="#DeepClassifier-88"><span class="linenos"> 88</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Classification algorithms to X and y.</span>
</span><span id="DeepClassifier-89"><a href="#DeepClassifier-89"><span class="linenos"> 89</span></a><span class="sd">        Parameters</span>
</span><span id="DeepClassifier-90"><a href="#DeepClassifier-90"><span class="linenos"> 90</span></a><span class="sd">        ----------</span>
</span><span id="DeepClassifier-91"><a href="#DeepClassifier-91"><span class="linenos"> 91</span></a><span class="sd">        X : array-like,</span>
</span><span id="DeepClassifier-92"><a href="#DeepClassifier-92"><span class="linenos"> 92</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="DeepClassifier-93"><a href="#DeepClassifier-93"><span class="linenos"> 93</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="DeepClassifier-94"><a href="#DeepClassifier-94"><span class="linenos"> 94</span></a><span class="sd">        y : array-like,</span>
</span><span id="DeepClassifier-95"><a href="#DeepClassifier-95"><span class="linenos"> 95</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="DeepClassifier-96"><a href="#DeepClassifier-96"><span class="linenos"> 96</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="DeepClassifier-97"><a href="#DeepClassifier-97"><span class="linenos"> 97</span></a><span class="sd">        Returns</span>
</span><span id="DeepClassifier-98"><a href="#DeepClassifier-98"><span class="linenos"> 98</span></a><span class="sd">        -------</span>
</span><span id="DeepClassifier-99"><a href="#DeepClassifier-99"><span class="linenos"> 99</span></a><span class="sd">        A fitted object</span>
</span><span id="DeepClassifier-100"><a href="#DeepClassifier-100"><span class="linenos">100</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DeepClassifier-101"><a href="#DeepClassifier-101"><span class="linenos">101</span></a>
</span><span id="DeepClassifier-102"><a href="#DeepClassifier-102"><span class="linenos">102</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="DeepClassifier-103"><a href="#DeepClassifier-103"><span class="linenos">103</span></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="DeepClassifier-104"><a href="#DeepClassifier-104"><span class="linenos">104</span></a>
</span><span id="DeepClassifier-105"><a href="#DeepClassifier-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="DeepClassifier-106"><a href="#DeepClassifier-106"><span class="linenos">106</span></a>
</span><span id="DeepClassifier-107"><a href="#DeepClassifier-107"><span class="linenos">107</span></a>        <span class="c1"># init layer</span>
</span><span id="DeepClassifier-108"><a href="#DeepClassifier-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="DeepClassifier-109"><a href="#DeepClassifier-109"><span class="linenos">109</span></a>            <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="p">,</span>
</span><span id="DeepClassifier-110"><a href="#DeepClassifier-110"><span class="linenos">110</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="DeepClassifier-111"><a href="#DeepClassifier-111"><span class="linenos">111</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="DeepClassifier-112"><a href="#DeepClassifier-112"><span class="linenos">112</span></a>            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="DeepClassifier-113"><a href="#DeepClassifier-113"><span class="linenos">113</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="DeepClassifier-114"><a href="#DeepClassifier-114"><span class="linenos">114</span></a>            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="DeepClassifier-115"><a href="#DeepClassifier-115"><span class="linenos">115</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="DeepClassifier-116"><a href="#DeepClassifier-116"><span class="linenos">116</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="DeepClassifier-117"><a href="#DeepClassifier-117"><span class="linenos">117</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="DeepClassifier-118"><a href="#DeepClassifier-118"><span class="linenos">118</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="DeepClassifier-119"><a href="#DeepClassifier-119"><span class="linenos">119</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="DeepClassifier-120"><a href="#DeepClassifier-120"><span class="linenos">120</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="DeepClassifier-121"><a href="#DeepClassifier-121"><span class="linenos">121</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="DeepClassifier-122"><a href="#DeepClassifier-122"><span class="linenos">122</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="DeepClassifier-123"><a href="#DeepClassifier-123"><span class="linenos">123</span></a>            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="DeepClassifier-124"><a href="#DeepClassifier-124"><span class="linenos">124</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="DeepClassifier-125"><a href="#DeepClassifier-125"><span class="linenos">125</span></a>        <span class="p">)</span>
</span><span id="DeepClassifier-126"><a href="#DeepClassifier-126"><span class="linenos">126</span></a>
</span><span id="DeepClassifier-127"><a href="#DeepClassifier-127"><span class="linenos">127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="DeepClassifier-128"><a href="#DeepClassifier-128"><span class="linenos">128</span></a>
</span><span id="DeepClassifier-129"><a href="#DeepClassifier-129"><span class="linenos">129</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DeepClassifier-130"><a href="#DeepClassifier-130"><span class="linenos">130</span></a>            <span class="n">iterator</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="DeepClassifier-131"><a href="#DeepClassifier-131"><span class="linenos">131</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DeepClassifier-132"><a href="#DeepClassifier-132"><span class="linenos">132</span></a>            <span class="n">iterator</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="DeepClassifier-133"><a href="#DeepClassifier-133"><span class="linenos">133</span></a>
</span><span id="DeepClassifier-134"><a href="#DeepClassifier-134"><span class="linenos">134</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
</span><span id="DeepClassifier-135"><a href="#DeepClassifier-135"><span class="linenos">135</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="DeepClassifier-136"><a href="#DeepClassifier-136"><span class="linenos">136</span></a>                <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="DeepClassifier-137"><a href="#DeepClassifier-137"><span class="linenos">137</span></a>                    <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="p">,</span>
</span><span id="DeepClassifier-138"><a href="#DeepClassifier-138"><span class="linenos">138</span></a>                    <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="DeepClassifier-139"><a href="#DeepClassifier-139"><span class="linenos">139</span></a>                    <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="DeepClassifier-140"><a href="#DeepClassifier-140"><span class="linenos">140</span></a>                    <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="DeepClassifier-141"><a href="#DeepClassifier-141"><span class="linenos">141</span></a>                    <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="DeepClassifier-142"><a href="#DeepClassifier-142"><span class="linenos">142</span></a>                    <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="DeepClassifier-143"><a href="#DeepClassifier-143"><span class="linenos">143</span></a>                    <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="DeepClassifier-144"><a href="#DeepClassifier-144"><span class="linenos">144</span></a>                    <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="DeepClassifier-145"><a href="#DeepClassifier-145"><span class="linenos">145</span></a>                    <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="DeepClassifier-146"><a href="#DeepClassifier-146"><span class="linenos">146</span></a>                    <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="DeepClassifier-147"><a href="#DeepClassifier-147"><span class="linenos">147</span></a>                    <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="DeepClassifier-148"><a href="#DeepClassifier-148"><span class="linenos">148</span></a>                    <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="DeepClassifier-149"><a href="#DeepClassifier-149"><span class="linenos">149</span></a>                    <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="DeepClassifier-150"><a href="#DeepClassifier-150"><span class="linenos">150</span></a>                    <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="DeepClassifier-151"><a href="#DeepClassifier-151"><span class="linenos">151</span></a>                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="DeepClassifier-152"><a href="#DeepClassifier-152"><span class="linenos">152</span></a>                    <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="DeepClassifier-153"><a href="#DeepClassifier-153"><span class="linenos">153</span></a>                <span class="p">)</span>
</span><span id="DeepClassifier-154"><a href="#DeepClassifier-154"><span class="linenos">154</span></a>            <span class="p">)</span>
</span><span id="DeepClassifier-155"><a href="#DeepClassifier-155"><span class="linenos">155</span></a>
</span><span id="DeepClassifier-156"><a href="#DeepClassifier-156"><span class="linenos">156</span></a>            <span class="c1"># self.stacked_obj.fit(X, y)</span>
</span><span id="DeepClassifier-157"><a href="#DeepClassifier-157"><span class="linenos">157</span></a>
</span><span id="DeepClassifier-158"><a href="#DeepClassifier-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="DeepClassifier-159"><a href="#DeepClassifier-159"><span class="linenos">159</span></a>
</span><span id="DeepClassifier-160"><a href="#DeepClassifier-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="p">)</span>
</span><span id="DeepClassifier-161"><a href="#DeepClassifier-161"><span class="linenos">161</span></a>
</span><span id="DeepClassifier-162"><a href="#DeepClassifier-162"><span class="linenos">162</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span>
</span><span id="DeepClassifier-163"><a href="#DeepClassifier-163"><span class="linenos">163</span></a>
</span><span id="DeepClassifier-164"><a href="#DeepClassifier-164"><span class="linenos">164</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="DeepClassifier-165"><a href="#DeepClassifier-165"><span class="linenos">165</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="DeepClassifier-166"><a href="#DeepClassifier-166"><span class="linenos">166</span></a>
</span><span id="DeepClassifier-167"><a href="#DeepClassifier-167"><span class="linenos">167</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="DeepClassifier-168"><a href="#DeepClassifier-168"><span class="linenos">168</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="DeepClassifier-169"><a href="#DeepClassifier-169"><span class="linenos">169</span></a>
</span><span id="DeepClassifier-170"><a href="#DeepClassifier-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DeepClassifier-171"><a href="#DeepClassifier-171"><span class="linenos">171</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scoring</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Deep Classifier</p>

<p>Parameters:</p>

<pre><code>verbose : int, optional (default=0)
    Monitor progress when fitting.
</code></pre>

<p>Examples:
    <div class="pdoc-code codehilite">
    <pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
    <span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
    <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
    <span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegressionCV</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>
    <span class="n">y</span><span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">target</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">LogisticRegressionCV</span><span class="p">()</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">DeepClassifier</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">y_test</span><span class="p">))</span>
    </code></pre>
    </div></p>
</div>


                                <div id="DeepClassifier.fit" class="classattr">
                                            <input id="DeepClassifier.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DeepClassifier.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DeepClassifier.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DeepClassifier.fit-87"><a href="#DeepClassifier.fit-87"><span class="linenos"> 87</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="DeepClassifier.fit-88"><a href="#DeepClassifier.fit-88"><span class="linenos"> 88</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Classification algorithms to X and y.</span>
</span><span id="DeepClassifier.fit-89"><a href="#DeepClassifier.fit-89"><span class="linenos"> 89</span></a><span class="sd">        Parameters</span>
</span><span id="DeepClassifier.fit-90"><a href="#DeepClassifier.fit-90"><span class="linenos"> 90</span></a><span class="sd">        ----------</span>
</span><span id="DeepClassifier.fit-91"><a href="#DeepClassifier.fit-91"><span class="linenos"> 91</span></a><span class="sd">        X : array-like,</span>
</span><span id="DeepClassifier.fit-92"><a href="#DeepClassifier.fit-92"><span class="linenos"> 92</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="DeepClassifier.fit-93"><a href="#DeepClassifier.fit-93"><span class="linenos"> 93</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="DeepClassifier.fit-94"><a href="#DeepClassifier.fit-94"><span class="linenos"> 94</span></a><span class="sd">        y : array-like,</span>
</span><span id="DeepClassifier.fit-95"><a href="#DeepClassifier.fit-95"><span class="linenos"> 95</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="DeepClassifier.fit-96"><a href="#DeepClassifier.fit-96"><span class="linenos"> 96</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="DeepClassifier.fit-97"><a href="#DeepClassifier.fit-97"><span class="linenos"> 97</span></a><span class="sd">        Returns</span>
</span><span id="DeepClassifier.fit-98"><a href="#DeepClassifier.fit-98"><span class="linenos"> 98</span></a><span class="sd">        -------</span>
</span><span id="DeepClassifier.fit-99"><a href="#DeepClassifier.fit-99"><span class="linenos"> 99</span></a><span class="sd">        A fitted object</span>
</span><span id="DeepClassifier.fit-100"><a href="#DeepClassifier.fit-100"><span class="linenos">100</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DeepClassifier.fit-101"><a href="#DeepClassifier.fit-101"><span class="linenos">101</span></a>
</span><span id="DeepClassifier.fit-102"><a href="#DeepClassifier.fit-102"><span class="linenos">102</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="DeepClassifier.fit-103"><a href="#DeepClassifier.fit-103"><span class="linenos">103</span></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="DeepClassifier.fit-104"><a href="#DeepClassifier.fit-104"><span class="linenos">104</span></a>
</span><span id="DeepClassifier.fit-105"><a href="#DeepClassifier.fit-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="DeepClassifier.fit-106"><a href="#DeepClassifier.fit-106"><span class="linenos">106</span></a>
</span><span id="DeepClassifier.fit-107"><a href="#DeepClassifier.fit-107"><span class="linenos">107</span></a>        <span class="c1"># init layer</span>
</span><span id="DeepClassifier.fit-108"><a href="#DeepClassifier.fit-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="DeepClassifier.fit-109"><a href="#DeepClassifier.fit-109"><span class="linenos">109</span></a>            <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-110"><a href="#DeepClassifier.fit-110"><span class="linenos">110</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-111"><a href="#DeepClassifier.fit-111"><span class="linenos">111</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-112"><a href="#DeepClassifier.fit-112"><span class="linenos">112</span></a>            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-113"><a href="#DeepClassifier.fit-113"><span class="linenos">113</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-114"><a href="#DeepClassifier.fit-114"><span class="linenos">114</span></a>            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-115"><a href="#DeepClassifier.fit-115"><span class="linenos">115</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-116"><a href="#DeepClassifier.fit-116"><span class="linenos">116</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-117"><a href="#DeepClassifier.fit-117"><span class="linenos">117</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-118"><a href="#DeepClassifier.fit-118"><span class="linenos">118</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-119"><a href="#DeepClassifier.fit-119"><span class="linenos">119</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-120"><a href="#DeepClassifier.fit-120"><span class="linenos">120</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-121"><a href="#DeepClassifier.fit-121"><span class="linenos">121</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-122"><a href="#DeepClassifier.fit-122"><span class="linenos">122</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-123"><a href="#DeepClassifier.fit-123"><span class="linenos">123</span></a>            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-124"><a href="#DeepClassifier.fit-124"><span class="linenos">124</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-125"><a href="#DeepClassifier.fit-125"><span class="linenos">125</span></a>        <span class="p">)</span>
</span><span id="DeepClassifier.fit-126"><a href="#DeepClassifier.fit-126"><span class="linenos">126</span></a>
</span><span id="DeepClassifier.fit-127"><a href="#DeepClassifier.fit-127"><span class="linenos">127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="DeepClassifier.fit-128"><a href="#DeepClassifier.fit-128"><span class="linenos">128</span></a>
</span><span id="DeepClassifier.fit-129"><a href="#DeepClassifier.fit-129"><span class="linenos">129</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DeepClassifier.fit-130"><a href="#DeepClassifier.fit-130"><span class="linenos">130</span></a>            <span class="n">iterator</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="DeepClassifier.fit-131"><a href="#DeepClassifier.fit-131"><span class="linenos">131</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DeepClassifier.fit-132"><a href="#DeepClassifier.fit-132"><span class="linenos">132</span></a>            <span class="n">iterator</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="DeepClassifier.fit-133"><a href="#DeepClassifier.fit-133"><span class="linenos">133</span></a>
</span><span id="DeepClassifier.fit-134"><a href="#DeepClassifier.fit-134"><span class="linenos">134</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
</span><span id="DeepClassifier.fit-135"><a href="#DeepClassifier.fit-135"><span class="linenos">135</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="DeepClassifier.fit-136"><a href="#DeepClassifier.fit-136"><span class="linenos">136</span></a>                <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="DeepClassifier.fit-137"><a href="#DeepClassifier.fit-137"><span class="linenos">137</span></a>                    <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-138"><a href="#DeepClassifier.fit-138"><span class="linenos">138</span></a>                    <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-139"><a href="#DeepClassifier.fit-139"><span class="linenos">139</span></a>                    <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-140"><a href="#DeepClassifier.fit-140"><span class="linenos">140</span></a>                    <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-141"><a href="#DeepClassifier.fit-141"><span class="linenos">141</span></a>                    <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-142"><a href="#DeepClassifier.fit-142"><span class="linenos">142</span></a>                    <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-143"><a href="#DeepClassifier.fit-143"><span class="linenos">143</span></a>                    <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-144"><a href="#DeepClassifier.fit-144"><span class="linenos">144</span></a>                    <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-145"><a href="#DeepClassifier.fit-145"><span class="linenos">145</span></a>                    <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-146"><a href="#DeepClassifier.fit-146"><span class="linenos">146</span></a>                    <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-147"><a href="#DeepClassifier.fit-147"><span class="linenos">147</span></a>                    <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-148"><a href="#DeepClassifier.fit-148"><span class="linenos">148</span></a>                    <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-149"><a href="#DeepClassifier.fit-149"><span class="linenos">149</span></a>                    <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-150"><a href="#DeepClassifier.fit-150"><span class="linenos">150</span></a>                    <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-151"><a href="#DeepClassifier.fit-151"><span class="linenos">151</span></a>                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-152"><a href="#DeepClassifier.fit-152"><span class="linenos">152</span></a>                    <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="DeepClassifier.fit-153"><a href="#DeepClassifier.fit-153"><span class="linenos">153</span></a>                <span class="p">)</span>
</span><span id="DeepClassifier.fit-154"><a href="#DeepClassifier.fit-154"><span class="linenos">154</span></a>            <span class="p">)</span>
</span><span id="DeepClassifier.fit-155"><a href="#DeepClassifier.fit-155"><span class="linenos">155</span></a>
</span><span id="DeepClassifier.fit-156"><a href="#DeepClassifier.fit-156"><span class="linenos">156</span></a>            <span class="c1"># self.stacked_obj.fit(X, y)</span>
</span><span id="DeepClassifier.fit-157"><a href="#DeepClassifier.fit-157"><span class="linenos">157</span></a>
</span><span id="DeepClassifier.fit-158"><a href="#DeepClassifier.fit-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="DeepClassifier.fit-159"><a href="#DeepClassifier.fit-159"><span class="linenos">159</span></a>
</span><span id="DeepClassifier.fit-160"><a href="#DeepClassifier.fit-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="p">)</span>
</span><span id="DeepClassifier.fit-161"><a href="#DeepClassifier.fit-161"><span class="linenos">161</span></a>
</span><span id="DeepClassifier.fit-162"><a href="#DeepClassifier.fit-162"><span class="linenos">162</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span>
</span></pre></div>


            <div class="docstring"><p>Fit Classification algorithms to X and y.</p>

<h2 id="parameters">Parameters</h2>

<p>X : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.
y : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.</p>

<h2 id="returns">Returns</h2>

<p>A fitted object</p>
</div>


                                </div>
                                <div id="DeepClassifier.predict" class="classattr">
                                            <input id="DeepClassifier.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DeepClassifier.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DeepClassifier.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DeepClassifier.predict-164"><a href="#DeepClassifier.predict-164"><span class="linenos">164</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="DeepClassifier.predict-165"><a href="#DeepClassifier.predict-165"><span class="linenos">165</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict test data X.</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>model predictions: {array-like}
</code></pre>
</div>


                                </div>
                                <div id="DeepClassifier.predict_proba" class="classattr">
                                            <input id="DeepClassifier.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DeepClassifier.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DeepClassifier.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DeepClassifier.predict_proba-167"><a href="#DeepClassifier.predict_proba-167"><span class="linenos">167</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
</span><span id="DeepClassifier.predict_proba-168"><a href="#DeepClassifier.predict_proba-168"><span class="linenos">168</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict probabilities for test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>probability estimates for test data: {array-like}
</code></pre>
</div>


                                </div>
                                <div id="DeepClassifier.score" class="classattr">
                                            <input id="DeepClassifier.score-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">score</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">scoring</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DeepClassifier.score-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DeepClassifier.score"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DeepClassifier.score-170"><a href="#DeepClassifier.score-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DeepClassifier.score-171"><a href="#DeepClassifier.score-171"><span class="linenos">171</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scoring</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Score the model on test set features X and response y.</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features

y: array-like, shape = [n_samples]
    Target values

scoring: str
    must be in ('explained_variance', 'neg_mean_absolute_error',
                'neg_mean_squared_error', 'neg_mean_squared_log_error',
                'neg_median_absolute_error', 'r2')

**kwargs: additional parameters to be passed to scoring functions
</code></pre>

<p>Returns:</p>

<p>model scores: {array-like}</p>
</div>


                                </div>
                        
                </section>
                <section id="DeepRegressor">
                            <input id="DeepRegressor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DeepRegressor</span><wbr>(<span class="base"><a href="#CustomRegressor">nnetsauce.CustomRegressor</a></span>, <span class="base">sklearn.base.RegressorMixin</span>):

                <label class="view-source-button" for="DeepRegressor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DeepRegressor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DeepRegressor-12"><a href="#DeepRegressor-12"><span class="linenos"> 12</span></a><span class="k">class</span> <span class="nc">DeepRegressor</span><span class="p">(</span><span class="n">CustomRegressor</span><span class="p">,</span> <span class="n">RegressorMixin</span><span class="p">):</span>
</span><span id="DeepRegressor-13"><a href="#DeepRegressor-13"><span class="linenos"> 13</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DeepRegressor-14"><a href="#DeepRegressor-14"><span class="linenos"> 14</span></a><span class="sd">    Deep Regressor</span>
</span><span id="DeepRegressor-15"><a href="#DeepRegressor-15"><span class="linenos"> 15</span></a>
</span><span id="DeepRegressor-16"><a href="#DeepRegressor-16"><span class="linenos"> 16</span></a><span class="sd">    Parameters:</span>
</span><span id="DeepRegressor-17"><a href="#DeepRegressor-17"><span class="linenos"> 17</span></a>
</span><span id="DeepRegressor-18"><a href="#DeepRegressor-18"><span class="linenos"> 18</span></a><span class="sd">        verbose : int, optional (default=0)</span>
</span><span id="DeepRegressor-19"><a href="#DeepRegressor-19"><span class="linenos"> 19</span></a><span class="sd">            Monitor progress when fitting.</span>
</span><span id="DeepRegressor-20"><a href="#DeepRegressor-20"><span class="linenos"> 20</span></a>
</span><span id="DeepRegressor-21"><a href="#DeepRegressor-21"><span class="linenos"> 21</span></a><span class="sd">    Examples:</span>
</span><span id="DeepRegressor-22"><a href="#DeepRegressor-22"><span class="linenos"> 22</span></a>
</span><span id="DeepRegressor-23"><a href="#DeepRegressor-23"><span class="linenos"> 23</span></a><span class="sd">        ```python</span>
</span><span id="DeepRegressor-24"><a href="#DeepRegressor-24"><span class="linenos"> 24</span></a><span class="sd">        import nnetsauce as ns</span>
</span><span id="DeepRegressor-25"><a href="#DeepRegressor-25"><span class="linenos"> 25</span></a><span class="sd">        from sklearn.datasets import load_diabetes</span>
</span><span id="DeepRegressor-26"><a href="#DeepRegressor-26"><span class="linenos"> 26</span></a><span class="sd">        from sklearn.model_selection import train_test_split</span>
</span><span id="DeepRegressor-27"><a href="#DeepRegressor-27"><span class="linenos"> 27</span></a><span class="sd">        from sklearn.linear_model import RidgeCV</span>
</span><span id="DeepRegressor-28"><a href="#DeepRegressor-28"><span class="linenos"> 28</span></a><span class="sd">        data = load_diabetes()</span>
</span><span id="DeepRegressor-29"><a href="#DeepRegressor-29"><span class="linenos"> 29</span></a><span class="sd">        X = data.data</span>
</span><span id="DeepRegressor-30"><a href="#DeepRegressor-30"><span class="linenos"> 30</span></a><span class="sd">        y= data.target</span>
</span><span id="DeepRegressor-31"><a href="#DeepRegressor-31"><span class="linenos"> 31</span></a><span class="sd">        X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=.2, random_state=123)</span>
</span><span id="DeepRegressor-32"><a href="#DeepRegressor-32"><span class="linenos"> 32</span></a><span class="sd">        obj = RidgeCV()</span>
</span><span id="DeepRegressor-33"><a href="#DeepRegressor-33"><span class="linenos"> 33</span></a><span class="sd">        clf = ns.DeepRegressor(obj)</span>
</span><span id="DeepRegressor-34"><a href="#DeepRegressor-34"><span class="linenos"> 34</span></a><span class="sd">        clf.fit(X_train, y_train)</span>
</span><span id="DeepRegressor-35"><a href="#DeepRegressor-35"><span class="linenos"> 35</span></a><span class="sd">        print(clf.score(clf.predict(X_test), y_test))</span>
</span><span id="DeepRegressor-36"><a href="#DeepRegressor-36"><span class="linenos"> 36</span></a><span class="sd">        ```</span>
</span><span id="DeepRegressor-37"><a href="#DeepRegressor-37"><span class="linenos"> 37</span></a>
</span><span id="DeepRegressor-38"><a href="#DeepRegressor-38"><span class="linenos"> 38</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DeepRegressor-39"><a href="#DeepRegressor-39"><span class="linenos"> 39</span></a>
</span><span id="DeepRegressor-40"><a href="#DeepRegressor-40"><span class="linenos"> 40</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="DeepRegressor-41"><a href="#DeepRegressor-41"><span class="linenos"> 41</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DeepRegressor-42"><a href="#DeepRegressor-42"><span class="linenos"> 42</span></a>        <span class="n">obj</span><span class="p">,</span>
</span><span id="DeepRegressor-43"><a href="#DeepRegressor-43"><span class="linenos"> 43</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="DeepRegressor-44"><a href="#DeepRegressor-44"><span class="linenos"> 44</span></a>        <span class="c1"># Defining depth</span>
</span><span id="DeepRegressor-45"><a href="#DeepRegressor-45"><span class="linenos"> 45</span></a>        <span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="DeepRegressor-46"><a href="#DeepRegressor-46"><span class="linenos"> 46</span></a>        <span class="c1"># CustomRegressor attributes</span>
</span><span id="DeepRegressor-47"><a href="#DeepRegressor-47"><span class="linenos"> 47</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="DeepRegressor-48"><a href="#DeepRegressor-48"><span class="linenos"> 48</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="DeepRegressor-49"><a href="#DeepRegressor-49"><span class="linenos"> 49</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="DeepRegressor-50"><a href="#DeepRegressor-50"><span class="linenos"> 50</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="DeepRegressor-51"><a href="#DeepRegressor-51"><span class="linenos"> 51</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DeepRegressor-52"><a href="#DeepRegressor-52"><span class="linenos"> 52</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="DeepRegressor-53"><a href="#DeepRegressor-53"><span class="linenos"> 53</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DeepRegressor-54"><a href="#DeepRegressor-54"><span class="linenos"> 54</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="DeepRegressor-55"><a href="#DeepRegressor-55"><span class="linenos"> 55</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DeepRegressor-56"><a href="#DeepRegressor-56"><span class="linenos"> 56</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="DeepRegressor-57"><a href="#DeepRegressor-57"><span class="linenos"> 57</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="DeepRegressor-58"><a href="#DeepRegressor-58"><span class="linenos"> 58</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="DeepRegressor-59"><a href="#DeepRegressor-59"><span class="linenos"> 59</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="DeepRegressor-60"><a href="#DeepRegressor-60"><span class="linenos"> 60</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="DeepRegressor-61"><a href="#DeepRegressor-61"><span class="linenos"> 61</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="DeepRegressor-62"><a href="#DeepRegressor-62"><span class="linenos"> 62</span></a>    <span class="p">):</span>
</span><span id="DeepRegressor-63"><a href="#DeepRegressor-63"><span class="linenos"> 63</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="DeepRegressor-64"><a href="#DeepRegressor-64"><span class="linenos"> 64</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="DeepRegressor-65"><a href="#DeepRegressor-65"><span class="linenos"> 65</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="DeepRegressor-66"><a href="#DeepRegressor-66"><span class="linenos"> 66</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="DeepRegressor-67"><a href="#DeepRegressor-67"><span class="linenos"> 67</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="DeepRegressor-68"><a href="#DeepRegressor-68"><span class="linenos"> 68</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="DeepRegressor-69"><a href="#DeepRegressor-69"><span class="linenos"> 69</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="DeepRegressor-70"><a href="#DeepRegressor-70"><span class="linenos"> 70</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="DeepRegressor-71"><a href="#DeepRegressor-71"><span class="linenos"> 71</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="DeepRegressor-72"><a href="#DeepRegressor-72"><span class="linenos"> 72</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="DeepRegressor-73"><a href="#DeepRegressor-73"><span class="linenos"> 73</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="DeepRegressor-74"><a href="#DeepRegressor-74"><span class="linenos"> 74</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="DeepRegressor-75"><a href="#DeepRegressor-75"><span class="linenos"> 75</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="DeepRegressor-76"><a href="#DeepRegressor-76"><span class="linenos"> 76</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="DeepRegressor-77"><a href="#DeepRegressor-77"><span class="linenos"> 77</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="DeepRegressor-78"><a href="#DeepRegressor-78"><span class="linenos"> 78</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="DeepRegressor-79"><a href="#DeepRegressor-79"><span class="linenos"> 79</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="DeepRegressor-80"><a href="#DeepRegressor-80"><span class="linenos"> 80</span></a>        <span class="p">)</span>
</span><span id="DeepRegressor-81"><a href="#DeepRegressor-81"><span class="linenos"> 81</span></a>
</span><span id="DeepRegressor-82"><a href="#DeepRegressor-82"><span class="linenos"> 82</span></a>        <span class="k">assert</span> <span class="n">n_layers</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;must have n_layers &gt;= 2&quot;</span>
</span><span id="DeepRegressor-83"><a href="#DeepRegressor-83"><span class="linenos"> 83</span></a>
</span><span id="DeepRegressor-84"><a href="#DeepRegressor-84"><span class="linenos"> 84</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span> <span class="o">=</span> <span class="n">obj</span>
</span><span id="DeepRegressor-85"><a href="#DeepRegressor-85"><span class="linenos"> 85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="DeepRegressor-86"><a href="#DeepRegressor-86"><span class="linenos"> 86</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">=</span> <span class="n">n_layers</span>
</span><span id="DeepRegressor-87"><a href="#DeepRegressor-87"><span class="linenos"> 87</span></a>
</span><span id="DeepRegressor-88"><a href="#DeepRegressor-88"><span class="linenos"> 88</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="DeepRegressor-89"><a href="#DeepRegressor-89"><span class="linenos"> 89</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X and y.</span>
</span><span id="DeepRegressor-90"><a href="#DeepRegressor-90"><span class="linenos"> 90</span></a><span class="sd">        Parameters</span>
</span><span id="DeepRegressor-91"><a href="#DeepRegressor-91"><span class="linenos"> 91</span></a><span class="sd">        ----------</span>
</span><span id="DeepRegressor-92"><a href="#DeepRegressor-92"><span class="linenos"> 92</span></a><span class="sd">        X : array-like,</span>
</span><span id="DeepRegressor-93"><a href="#DeepRegressor-93"><span class="linenos"> 93</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="DeepRegressor-94"><a href="#DeepRegressor-94"><span class="linenos"> 94</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="DeepRegressor-95"><a href="#DeepRegressor-95"><span class="linenos"> 95</span></a><span class="sd">        y : array-like,</span>
</span><span id="DeepRegressor-96"><a href="#DeepRegressor-96"><span class="linenos"> 96</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="DeepRegressor-97"><a href="#DeepRegressor-97"><span class="linenos"> 97</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="DeepRegressor-98"><a href="#DeepRegressor-98"><span class="linenos"> 98</span></a><span class="sd">        Returns</span>
</span><span id="DeepRegressor-99"><a href="#DeepRegressor-99"><span class="linenos"> 99</span></a><span class="sd">        -------</span>
</span><span id="DeepRegressor-100"><a href="#DeepRegressor-100"><span class="linenos">100</span></a><span class="sd">        A fitted object</span>
</span><span id="DeepRegressor-101"><a href="#DeepRegressor-101"><span class="linenos">101</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DeepRegressor-102"><a href="#DeepRegressor-102"><span class="linenos">102</span></a>
</span><span id="DeepRegressor-103"><a href="#DeepRegressor-103"><span class="linenos">103</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="DeepRegressor-104"><a href="#DeepRegressor-104"><span class="linenos">104</span></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="DeepRegressor-105"><a href="#DeepRegressor-105"><span class="linenos">105</span></a>
</span><span id="DeepRegressor-106"><a href="#DeepRegressor-106"><span class="linenos">106</span></a>        <span class="c1"># init layer</span>
</span><span id="DeepRegressor-107"><a href="#DeepRegressor-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="DeepRegressor-108"><a href="#DeepRegressor-108"><span class="linenos">108</span></a>            <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="p">,</span>
</span><span id="DeepRegressor-109"><a href="#DeepRegressor-109"><span class="linenos">109</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="DeepRegressor-110"><a href="#DeepRegressor-110"><span class="linenos">110</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="DeepRegressor-111"><a href="#DeepRegressor-111"><span class="linenos">111</span></a>            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="DeepRegressor-112"><a href="#DeepRegressor-112"><span class="linenos">112</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="DeepRegressor-113"><a href="#DeepRegressor-113"><span class="linenos">113</span></a>            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="DeepRegressor-114"><a href="#DeepRegressor-114"><span class="linenos">114</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="DeepRegressor-115"><a href="#DeepRegressor-115"><span class="linenos">115</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="DeepRegressor-116"><a href="#DeepRegressor-116"><span class="linenos">116</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="DeepRegressor-117"><a href="#DeepRegressor-117"><span class="linenos">117</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="DeepRegressor-118"><a href="#DeepRegressor-118"><span class="linenos">118</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="DeepRegressor-119"><a href="#DeepRegressor-119"><span class="linenos">119</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="DeepRegressor-120"><a href="#DeepRegressor-120"><span class="linenos">120</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="DeepRegressor-121"><a href="#DeepRegressor-121"><span class="linenos">121</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="DeepRegressor-122"><a href="#DeepRegressor-122"><span class="linenos">122</span></a>            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="DeepRegressor-123"><a href="#DeepRegressor-123"><span class="linenos">123</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="DeepRegressor-124"><a href="#DeepRegressor-124"><span class="linenos">124</span></a>        <span class="p">)</span>
</span><span id="DeepRegressor-125"><a href="#DeepRegressor-125"><span class="linenos">125</span></a>
</span><span id="DeepRegressor-126"><a href="#DeepRegressor-126"><span class="linenos">126</span></a>        <span class="c1"># self.stacked_obj.fit(X, y)</span>
</span><span id="DeepRegressor-127"><a href="#DeepRegressor-127"><span class="linenos">127</span></a>
</span><span id="DeepRegressor-128"><a href="#DeepRegressor-128"><span class="linenos">128</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DeepRegressor-129"><a href="#DeepRegressor-129"><span class="linenos">129</span></a>            <span class="n">iterator</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="DeepRegressor-130"><a href="#DeepRegressor-130"><span class="linenos">130</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DeepRegressor-131"><a href="#DeepRegressor-131"><span class="linenos">131</span></a>            <span class="n">iterator</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="DeepRegressor-132"><a href="#DeepRegressor-132"><span class="linenos">132</span></a>
</span><span id="DeepRegressor-133"><a href="#DeepRegressor-133"><span class="linenos">133</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
</span><span id="DeepRegressor-134"><a href="#DeepRegressor-134"><span class="linenos">134</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="DeepRegressor-135"><a href="#DeepRegressor-135"><span class="linenos">135</span></a>                <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="DeepRegressor-136"><a href="#DeepRegressor-136"><span class="linenos">136</span></a>                    <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="p">,</span>
</span><span id="DeepRegressor-137"><a href="#DeepRegressor-137"><span class="linenos">137</span></a>                    <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="DeepRegressor-138"><a href="#DeepRegressor-138"><span class="linenos">138</span></a>                    <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="DeepRegressor-139"><a href="#DeepRegressor-139"><span class="linenos">139</span></a>                    <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="DeepRegressor-140"><a href="#DeepRegressor-140"><span class="linenos">140</span></a>                    <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="DeepRegressor-141"><a href="#DeepRegressor-141"><span class="linenos">141</span></a>                    <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="DeepRegressor-142"><a href="#DeepRegressor-142"><span class="linenos">142</span></a>                    <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="DeepRegressor-143"><a href="#DeepRegressor-143"><span class="linenos">143</span></a>                    <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="DeepRegressor-144"><a href="#DeepRegressor-144"><span class="linenos">144</span></a>                    <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="DeepRegressor-145"><a href="#DeepRegressor-145"><span class="linenos">145</span></a>                    <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="DeepRegressor-146"><a href="#DeepRegressor-146"><span class="linenos">146</span></a>                    <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="DeepRegressor-147"><a href="#DeepRegressor-147"><span class="linenos">147</span></a>                    <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="DeepRegressor-148"><a href="#DeepRegressor-148"><span class="linenos">148</span></a>                    <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="DeepRegressor-149"><a href="#DeepRegressor-149"><span class="linenos">149</span></a>                    <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="DeepRegressor-150"><a href="#DeepRegressor-150"><span class="linenos">150</span></a>                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="DeepRegressor-151"><a href="#DeepRegressor-151"><span class="linenos">151</span></a>                    <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="DeepRegressor-152"><a href="#DeepRegressor-152"><span class="linenos">152</span></a>                <span class="p">)</span>
</span><span id="DeepRegressor-153"><a href="#DeepRegressor-153"><span class="linenos">153</span></a>            <span class="p">)</span>
</span><span id="DeepRegressor-154"><a href="#DeepRegressor-154"><span class="linenos">154</span></a>
</span><span id="DeepRegressor-155"><a href="#DeepRegressor-155"><span class="linenos">155</span></a>            <span class="c1"># self.stacked_obj.fit(X, y)</span>
</span><span id="DeepRegressor-156"><a href="#DeepRegressor-156"><span class="linenos">156</span></a>
</span><span id="DeepRegressor-157"><a href="#DeepRegressor-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="DeepRegressor-158"><a href="#DeepRegressor-158"><span class="linenos">158</span></a>
</span><span id="DeepRegressor-159"><a href="#DeepRegressor-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="p">)</span>
</span><span id="DeepRegressor-160"><a href="#DeepRegressor-160"><span class="linenos">160</span></a>
</span><span id="DeepRegressor-161"><a href="#DeepRegressor-161"><span class="linenos">161</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span>
</span><span id="DeepRegressor-162"><a href="#DeepRegressor-162"><span class="linenos">162</span></a>
</span><span id="DeepRegressor-163"><a href="#DeepRegressor-163"><span class="linenos">163</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="DeepRegressor-164"><a href="#DeepRegressor-164"><span class="linenos">164</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="DeepRegressor-165"><a href="#DeepRegressor-165"><span class="linenos">165</span></a>
</span><span id="DeepRegressor-166"><a href="#DeepRegressor-166"><span class="linenos">166</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DeepRegressor-167"><a href="#DeepRegressor-167"><span class="linenos">167</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scoring</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Deep Regressor</p>

<p>Parameters:</p>

<pre><code>verbose : int, optional (default=0)
    Monitor progress when fitting.
</code></pre>

<p>Examples:
    <div class="pdoc-code codehilite">
    <pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
    <span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_diabetes</span>
    <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
    <span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">RidgeCV</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_diabetes</span><span class="p">()</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>
    <span class="n">y</span><span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">target</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">RidgeCV</span><span class="p">()</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">DeepRegressor</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">y_test</span><span class="p">))</span>
    </code></pre>
    </div></p>
</div>


                                <div id="DeepRegressor.fit" class="classattr">
                                            <input id="DeepRegressor.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DeepRegressor.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DeepRegressor.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DeepRegressor.fit-88"><a href="#DeepRegressor.fit-88"><span class="linenos"> 88</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="DeepRegressor.fit-89"><a href="#DeepRegressor.fit-89"><span class="linenos"> 89</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X and y.</span>
</span><span id="DeepRegressor.fit-90"><a href="#DeepRegressor.fit-90"><span class="linenos"> 90</span></a><span class="sd">        Parameters</span>
</span><span id="DeepRegressor.fit-91"><a href="#DeepRegressor.fit-91"><span class="linenos"> 91</span></a><span class="sd">        ----------</span>
</span><span id="DeepRegressor.fit-92"><a href="#DeepRegressor.fit-92"><span class="linenos"> 92</span></a><span class="sd">        X : array-like,</span>
</span><span id="DeepRegressor.fit-93"><a href="#DeepRegressor.fit-93"><span class="linenos"> 93</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="DeepRegressor.fit-94"><a href="#DeepRegressor.fit-94"><span class="linenos"> 94</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="DeepRegressor.fit-95"><a href="#DeepRegressor.fit-95"><span class="linenos"> 95</span></a><span class="sd">        y : array-like,</span>
</span><span id="DeepRegressor.fit-96"><a href="#DeepRegressor.fit-96"><span class="linenos"> 96</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="DeepRegressor.fit-97"><a href="#DeepRegressor.fit-97"><span class="linenos"> 97</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="DeepRegressor.fit-98"><a href="#DeepRegressor.fit-98"><span class="linenos"> 98</span></a><span class="sd">        Returns</span>
</span><span id="DeepRegressor.fit-99"><a href="#DeepRegressor.fit-99"><span class="linenos"> 99</span></a><span class="sd">        -------</span>
</span><span id="DeepRegressor.fit-100"><a href="#DeepRegressor.fit-100"><span class="linenos">100</span></a><span class="sd">        A fitted object</span>
</span><span id="DeepRegressor.fit-101"><a href="#DeepRegressor.fit-101"><span class="linenos">101</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DeepRegressor.fit-102"><a href="#DeepRegressor.fit-102"><span class="linenos">102</span></a>
</span><span id="DeepRegressor.fit-103"><a href="#DeepRegressor.fit-103"><span class="linenos">103</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="DeepRegressor.fit-104"><a href="#DeepRegressor.fit-104"><span class="linenos">104</span></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="DeepRegressor.fit-105"><a href="#DeepRegressor.fit-105"><span class="linenos">105</span></a>
</span><span id="DeepRegressor.fit-106"><a href="#DeepRegressor.fit-106"><span class="linenos">106</span></a>        <span class="c1"># init layer</span>
</span><span id="DeepRegressor.fit-107"><a href="#DeepRegressor.fit-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="DeepRegressor.fit-108"><a href="#DeepRegressor.fit-108"><span class="linenos">108</span></a>            <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-109"><a href="#DeepRegressor.fit-109"><span class="linenos">109</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-110"><a href="#DeepRegressor.fit-110"><span class="linenos">110</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-111"><a href="#DeepRegressor.fit-111"><span class="linenos">111</span></a>            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-112"><a href="#DeepRegressor.fit-112"><span class="linenos">112</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-113"><a href="#DeepRegressor.fit-113"><span class="linenos">113</span></a>            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-114"><a href="#DeepRegressor.fit-114"><span class="linenos">114</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-115"><a href="#DeepRegressor.fit-115"><span class="linenos">115</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-116"><a href="#DeepRegressor.fit-116"><span class="linenos">116</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-117"><a href="#DeepRegressor.fit-117"><span class="linenos">117</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-118"><a href="#DeepRegressor.fit-118"><span class="linenos">118</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-119"><a href="#DeepRegressor.fit-119"><span class="linenos">119</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-120"><a href="#DeepRegressor.fit-120"><span class="linenos">120</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-121"><a href="#DeepRegressor.fit-121"><span class="linenos">121</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-122"><a href="#DeepRegressor.fit-122"><span class="linenos">122</span></a>            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-123"><a href="#DeepRegressor.fit-123"><span class="linenos">123</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-124"><a href="#DeepRegressor.fit-124"><span class="linenos">124</span></a>        <span class="p">)</span>
</span><span id="DeepRegressor.fit-125"><a href="#DeepRegressor.fit-125"><span class="linenos">125</span></a>
</span><span id="DeepRegressor.fit-126"><a href="#DeepRegressor.fit-126"><span class="linenos">126</span></a>        <span class="c1"># self.stacked_obj.fit(X, y)</span>
</span><span id="DeepRegressor.fit-127"><a href="#DeepRegressor.fit-127"><span class="linenos">127</span></a>
</span><span id="DeepRegressor.fit-128"><a href="#DeepRegressor.fit-128"><span class="linenos">128</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DeepRegressor.fit-129"><a href="#DeepRegressor.fit-129"><span class="linenos">129</span></a>            <span class="n">iterator</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="DeepRegressor.fit-130"><a href="#DeepRegressor.fit-130"><span class="linenos">130</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DeepRegressor.fit-131"><a href="#DeepRegressor.fit-131"><span class="linenos">131</span></a>            <span class="n">iterator</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="DeepRegressor.fit-132"><a href="#DeepRegressor.fit-132"><span class="linenos">132</span></a>
</span><span id="DeepRegressor.fit-133"><a href="#DeepRegressor.fit-133"><span class="linenos">133</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
</span><span id="DeepRegressor.fit-134"><a href="#DeepRegressor.fit-134"><span class="linenos">134</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="DeepRegressor.fit-135"><a href="#DeepRegressor.fit-135"><span class="linenos">135</span></a>                <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="DeepRegressor.fit-136"><a href="#DeepRegressor.fit-136"><span class="linenos">136</span></a>                    <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-137"><a href="#DeepRegressor.fit-137"><span class="linenos">137</span></a>                    <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-138"><a href="#DeepRegressor.fit-138"><span class="linenos">138</span></a>                    <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-139"><a href="#DeepRegressor.fit-139"><span class="linenos">139</span></a>                    <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-140"><a href="#DeepRegressor.fit-140"><span class="linenos">140</span></a>                    <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-141"><a href="#DeepRegressor.fit-141"><span class="linenos">141</span></a>                    <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-142"><a href="#DeepRegressor.fit-142"><span class="linenos">142</span></a>                    <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-143"><a href="#DeepRegressor.fit-143"><span class="linenos">143</span></a>                    <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-144"><a href="#DeepRegressor.fit-144"><span class="linenos">144</span></a>                    <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-145"><a href="#DeepRegressor.fit-145"><span class="linenos">145</span></a>                    <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-146"><a href="#DeepRegressor.fit-146"><span class="linenos">146</span></a>                    <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-147"><a href="#DeepRegressor.fit-147"><span class="linenos">147</span></a>                    <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-148"><a href="#DeepRegressor.fit-148"><span class="linenos">148</span></a>                    <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-149"><a href="#DeepRegressor.fit-149"><span class="linenos">149</span></a>                    <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-150"><a href="#DeepRegressor.fit-150"><span class="linenos">150</span></a>                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-151"><a href="#DeepRegressor.fit-151"><span class="linenos">151</span></a>                    <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="DeepRegressor.fit-152"><a href="#DeepRegressor.fit-152"><span class="linenos">152</span></a>                <span class="p">)</span>
</span><span id="DeepRegressor.fit-153"><a href="#DeepRegressor.fit-153"><span class="linenos">153</span></a>            <span class="p">)</span>
</span><span id="DeepRegressor.fit-154"><a href="#DeepRegressor.fit-154"><span class="linenos">154</span></a>
</span><span id="DeepRegressor.fit-155"><a href="#DeepRegressor.fit-155"><span class="linenos">155</span></a>            <span class="c1"># self.stacked_obj.fit(X, y)</span>
</span><span id="DeepRegressor.fit-156"><a href="#DeepRegressor.fit-156"><span class="linenos">156</span></a>
</span><span id="DeepRegressor.fit-157"><a href="#DeepRegressor.fit-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="DeepRegressor.fit-158"><a href="#DeepRegressor.fit-158"><span class="linenos">158</span></a>
</span><span id="DeepRegressor.fit-159"><a href="#DeepRegressor.fit-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stacked_obj</span><span class="p">)</span>
</span><span id="DeepRegressor.fit-160"><a href="#DeepRegressor.fit-160"><span class="linenos">160</span></a>
</span><span id="DeepRegressor.fit-161"><a href="#DeepRegressor.fit-161"><span class="linenos">161</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span>
</span></pre></div>


            <div class="docstring"><p>Fit Regression algorithms to X and y.</p>

<h2 id="parameters">Parameters</h2>

<p>X : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.
y : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.</p>

<h2 id="returns">Returns</h2>

<p>A fitted object</p>
</div>


                                </div>
                                <div id="DeepRegressor.predict" class="classattr">
                                            <input id="DeepRegressor.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DeepRegressor.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DeepRegressor.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DeepRegressor.predict-163"><a href="#DeepRegressor.predict-163"><span class="linenos">163</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="DeepRegressor.predict-164"><a href="#DeepRegressor.predict-164"><span class="linenos">164</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict test data X.</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

level: int
    Level of confidence (default = 95)

method: str
    `None`, or 'splitconformal', 'localconformal'
    prediction (if you specify `return_pi = True`)

**kwargs: additional parameters
        `return_pi = True` for conformal prediction,
        with `method` in ('splitconformal', 'localconformal')
        or `return_std = True` for `self.obj` in
        (`sklearn.linear_model.BayesianRidge`,
        `sklearn.linear_model.ARDRegressor`,
        `sklearn.gaussian_process.GaussianProcessRegressor`)`
</code></pre>

<p>Returns:</p>

<pre><code>model predictions:
    an array if uncertainty quantification is not requested,
      or a tuple if with prediction intervals and simulations
      if `return_std = True` (mean, standard deviation,
      lower and upper prediction interval) or `return_pi = True`
      ()
</code></pre>
</div>


                                </div>
                                <div id="DeepRegressor.score" class="classattr">
                                            <input id="DeepRegressor.score-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">score</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">scoring</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DeepRegressor.score-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DeepRegressor.score"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DeepRegressor.score-166"><a href="#DeepRegressor.score-166"><span class="linenos">166</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DeepRegressor.score-167"><a href="#DeepRegressor.score-167"><span class="linenos">167</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">scoring</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Score the model on test set features X and response y.</p>

<p>Parameters:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features

y: array-like, shape = [n_samples]
    Target values

scoring: str
    must be in ('explained_variance', 'neg_mean_absolute_error',
                'neg_mean_squared_error', 'neg_mean_squared_log_error',
                'neg_median_absolute_error', 'r2')

**kwargs: additional parameters to be passed to scoring functions
</code></pre>

<p>Returns:</p>

<p>model scores: {array-like}</p>
</div>


                                </div>
                        
                </section>
                <section id="DeepMTS">
                            <input id="DeepMTS-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DeepMTS</span><wbr>(<span class="base"><a href="#MTS">nnetsauce.MTS</a></span>):

                <label class="view-source-button" for="DeepMTS-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DeepMTS"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DeepMTS-10"><a href="#DeepMTS-10"><span class="linenos"> 10</span></a><span class="k">class</span> <span class="nc">DeepMTS</span><span class="p">(</span><span class="n">MTS</span><span class="p">):</span>
</span><span id="DeepMTS-11"><a href="#DeepMTS-11"><span class="linenos"> 11</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Univariate and multivariate time series (DeepMTS) forecasting with Quasi-Randomized networks (Work in progress /!\)</span>
</span><span id="DeepMTS-12"><a href="#DeepMTS-12"><span class="linenos"> 12</span></a>
</span><span id="DeepMTS-13"><a href="#DeepMTS-13"><span class="linenos"> 13</span></a><span class="sd">    Parameters:</span>
</span><span id="DeepMTS-14"><a href="#DeepMTS-14"><span class="linenos"> 14</span></a>
</span><span id="DeepMTS-15"><a href="#DeepMTS-15"><span class="linenos"> 15</span></a><span class="sd">        obj: object.</span>
</span><span id="DeepMTS-16"><a href="#DeepMTS-16"><span class="linenos"> 16</span></a><span class="sd">            any object containing a method fit (obj.fit()) and a method predict</span>
</span><span id="DeepMTS-17"><a href="#DeepMTS-17"><span class="linenos"> 17</span></a><span class="sd">            (obj.predict()).</span>
</span><span id="DeepMTS-18"><a href="#DeepMTS-18"><span class="linenos"> 18</span></a>
</span><span id="DeepMTS-19"><a href="#DeepMTS-19"><span class="linenos"> 19</span></a><span class="sd">        n_layers: int.</span>
</span><span id="DeepMTS-20"><a href="#DeepMTS-20"><span class="linenos"> 20</span></a><span class="sd">            number of layers in the neural network.</span>
</span><span id="DeepMTS-21"><a href="#DeepMTS-21"><span class="linenos"> 21</span></a>
</span><span id="DeepMTS-22"><a href="#DeepMTS-22"><span class="linenos"> 22</span></a><span class="sd">        n_hidden_features: int.</span>
</span><span id="DeepMTS-23"><a href="#DeepMTS-23"><span class="linenos"> 23</span></a><span class="sd">            number of nodes in the hidden layer.</span>
</span><span id="DeepMTS-24"><a href="#DeepMTS-24"><span class="linenos"> 24</span></a>
</span><span id="DeepMTS-25"><a href="#DeepMTS-25"><span class="linenos"> 25</span></a><span class="sd">        activation_name: str.</span>
</span><span id="DeepMTS-26"><a href="#DeepMTS-26"><span class="linenos"> 26</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;.</span>
</span><span id="DeepMTS-27"><a href="#DeepMTS-27"><span class="linenos"> 27</span></a>
</span><span id="DeepMTS-28"><a href="#DeepMTS-28"><span class="linenos"> 28</span></a><span class="sd">        a: float.</span>
</span><span id="DeepMTS-29"><a href="#DeepMTS-29"><span class="linenos"> 29</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function.</span>
</span><span id="DeepMTS-30"><a href="#DeepMTS-30"><span class="linenos"> 30</span></a>
</span><span id="DeepMTS-31"><a href="#DeepMTS-31"><span class="linenos"> 31</span></a><span class="sd">        nodes_sim: str.</span>
</span><span id="DeepMTS-32"><a href="#DeepMTS-32"><span class="linenos"> 32</span></a><span class="sd">            type of simulation for the nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;,</span>
</span><span id="DeepMTS-33"><a href="#DeepMTS-33"><span class="linenos"> 33</span></a><span class="sd">            &#39;uniform&#39;.</span>
</span><span id="DeepMTS-34"><a href="#DeepMTS-34"><span class="linenos"> 34</span></a>
</span><span id="DeepMTS-35"><a href="#DeepMTS-35"><span class="linenos"> 35</span></a><span class="sd">        bias: boolean.</span>
</span><span id="DeepMTS-36"><a href="#DeepMTS-36"><span class="linenos"> 36</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or not</span>
</span><span id="DeepMTS-37"><a href="#DeepMTS-37"><span class="linenos"> 37</span></a><span class="sd">            (False).</span>
</span><span id="DeepMTS-38"><a href="#DeepMTS-38"><span class="linenos"> 38</span></a>
</span><span id="DeepMTS-39"><a href="#DeepMTS-39"><span class="linenos"> 39</span></a><span class="sd">        dropout: float.</span>
</span><span id="DeepMTS-40"><a href="#DeepMTS-40"><span class="linenos"> 40</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="DeepMTS-41"><a href="#DeepMTS-41"><span class="linenos"> 41</span></a><span class="sd">            of the training.</span>
</span><span id="DeepMTS-42"><a href="#DeepMTS-42"><span class="linenos"> 42</span></a>
</span><span id="DeepMTS-43"><a href="#DeepMTS-43"><span class="linenos"> 43</span></a><span class="sd">        direct_link: boolean.</span>
</span><span id="DeepMTS-44"><a href="#DeepMTS-44"><span class="linenos"> 44</span></a><span class="sd">            indicates if the original predictors are included (True) in model&#39;s fitting or not (False).</span>
</span><span id="DeepMTS-45"><a href="#DeepMTS-45"><span class="linenos"> 45</span></a>
</span><span id="DeepMTS-46"><a href="#DeepMTS-46"><span class="linenos"> 46</span></a><span class="sd">        n_clusters: int.</span>
</span><span id="DeepMTS-47"><a href="#DeepMTS-47"><span class="linenos"> 47</span></a><span class="sd">            number of clusters for &#39;kmeans&#39; or &#39;gmm&#39; clustering (could be 0: no clustering).</span>
</span><span id="DeepMTS-48"><a href="#DeepMTS-48"><span class="linenos"> 48</span></a>
</span><span id="DeepMTS-49"><a href="#DeepMTS-49"><span class="linenos"> 49</span></a><span class="sd">        cluster_encode: bool.</span>
</span><span id="DeepMTS-50"><a href="#DeepMTS-50"><span class="linenos"> 50</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot)</span>
</span><span id="DeepMTS-51"><a href="#DeepMTS-51"><span class="linenos"> 51</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding.</span>
</span><span id="DeepMTS-52"><a href="#DeepMTS-52"><span class="linenos"> 52</span></a>
</span><span id="DeepMTS-53"><a href="#DeepMTS-53"><span class="linenos"> 53</span></a><span class="sd">        type_clust: str.</span>
</span><span id="DeepMTS-54"><a href="#DeepMTS-54"><span class="linenos"> 54</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian</span>
</span><span id="DeepMTS-55"><a href="#DeepMTS-55"><span class="linenos"> 55</span></a><span class="sd">            Mixture Model (&#39;gmm&#39;).</span>
</span><span id="DeepMTS-56"><a href="#DeepMTS-56"><span class="linenos"> 56</span></a>
</span><span id="DeepMTS-57"><a href="#DeepMTS-57"><span class="linenos"> 57</span></a><span class="sd">        type_scaling: a tuple of 3 strings.</span>
</span><span id="DeepMTS-58"><a href="#DeepMTS-58"><span class="linenos"> 58</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="DeepMTS-59"><a href="#DeepMTS-59"><span class="linenos"> 59</span></a><span class="sd">            (and when relevant).</span>
</span><span id="DeepMTS-60"><a href="#DeepMTS-60"><span class="linenos"> 60</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;).</span>
</span><span id="DeepMTS-61"><a href="#DeepMTS-61"><span class="linenos"> 61</span></a>
</span><span id="DeepMTS-62"><a href="#DeepMTS-62"><span class="linenos"> 62</span></a><span class="sd">        lags: int.</span>
</span><span id="DeepMTS-63"><a href="#DeepMTS-63"><span class="linenos"> 63</span></a><span class="sd">            number of lags used for each time series.</span>
</span><span id="DeepMTS-64"><a href="#DeepMTS-64"><span class="linenos"> 64</span></a>
</span><span id="DeepMTS-65"><a href="#DeepMTS-65"><span class="linenos"> 65</span></a><span class="sd">        replications: int.</span>
</span><span id="DeepMTS-66"><a href="#DeepMTS-66"><span class="linenos"> 66</span></a><span class="sd">            number of replications (if needed, for predictive simulation). Default is &#39;None&#39;.</span>
</span><span id="DeepMTS-67"><a href="#DeepMTS-67"><span class="linenos"> 67</span></a>
</span><span id="DeepMTS-68"><a href="#DeepMTS-68"><span class="linenos"> 68</span></a><span class="sd">        kernel: str.</span>
</span><span id="DeepMTS-69"><a href="#DeepMTS-69"><span class="linenos"> 69</span></a><span class="sd">            the kernel to use for residuals density estimation (used for predictive simulation). Currently, either &#39;gaussian&#39; or &#39;tophat&#39;.</span>
</span><span id="DeepMTS-70"><a href="#DeepMTS-70"><span class="linenos"> 70</span></a>
</span><span id="DeepMTS-71"><a href="#DeepMTS-71"><span class="linenos"> 71</span></a><span class="sd">        agg: str.</span>
</span><span id="DeepMTS-72"><a href="#DeepMTS-72"><span class="linenos"> 72</span></a><span class="sd">            either &quot;mean&quot; or &quot;median&quot; for simulation of bootstrap aggregating</span>
</span><span id="DeepMTS-73"><a href="#DeepMTS-73"><span class="linenos"> 73</span></a>
</span><span id="DeepMTS-74"><a href="#DeepMTS-74"><span class="linenos"> 74</span></a><span class="sd">        seed: int.</span>
</span><span id="DeepMTS-75"><a href="#DeepMTS-75"><span class="linenos"> 75</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39; or predictive simulation.</span>
</span><span id="DeepMTS-76"><a href="#DeepMTS-76"><span class="linenos"> 76</span></a>
</span><span id="DeepMTS-77"><a href="#DeepMTS-77"><span class="linenos"> 77</span></a><span class="sd">        backend: str.</span>
</span><span id="DeepMTS-78"><a href="#DeepMTS-78"><span class="linenos"> 78</span></a><span class="sd">            &quot;cpu&quot; or &quot;gpu&quot; or &quot;tpu&quot;.</span>
</span><span id="DeepMTS-79"><a href="#DeepMTS-79"><span class="linenos"> 79</span></a>
</span><span id="DeepMTS-80"><a href="#DeepMTS-80"><span class="linenos"> 80</span></a><span class="sd">        verbose: int.</span>
</span><span id="DeepMTS-81"><a href="#DeepMTS-81"><span class="linenos"> 81</span></a><span class="sd">            0: not printing; 1: printing</span>
</span><span id="DeepMTS-82"><a href="#DeepMTS-82"><span class="linenos"> 82</span></a>
</span><span id="DeepMTS-83"><a href="#DeepMTS-83"><span class="linenos"> 83</span></a><span class="sd">        show_progress: bool.</span>
</span><span id="DeepMTS-84"><a href="#DeepMTS-84"><span class="linenos"> 84</span></a><span class="sd">            True: progress bar when fitting each series; False: no progress bar when fitting each series</span>
</span><span id="DeepMTS-85"><a href="#DeepMTS-85"><span class="linenos"> 85</span></a>
</span><span id="DeepMTS-86"><a href="#DeepMTS-86"><span class="linenos"> 86</span></a><span class="sd">    Attributes:</span>
</span><span id="DeepMTS-87"><a href="#DeepMTS-87"><span class="linenos"> 87</span></a>
</span><span id="DeepMTS-88"><a href="#DeepMTS-88"><span class="linenos"> 88</span></a><span class="sd">        fit_objs_: dict</span>
</span><span id="DeepMTS-89"><a href="#DeepMTS-89"><span class="linenos"> 89</span></a><span class="sd">            objects adjusted to each individual time series</span>
</span><span id="DeepMTS-90"><a href="#DeepMTS-90"><span class="linenos"> 90</span></a>
</span><span id="DeepMTS-91"><a href="#DeepMTS-91"><span class="linenos"> 91</span></a><span class="sd">        y_: {array-like}</span>
</span><span id="DeepMTS-92"><a href="#DeepMTS-92"><span class="linenos"> 92</span></a><span class="sd">            DeepMTS responses (most recent observations first)</span>
</span><span id="DeepMTS-93"><a href="#DeepMTS-93"><span class="linenos"> 93</span></a>
</span><span id="DeepMTS-94"><a href="#DeepMTS-94"><span class="linenos"> 94</span></a><span class="sd">        X_: {array-like}</span>
</span><span id="DeepMTS-95"><a href="#DeepMTS-95"><span class="linenos"> 95</span></a><span class="sd">            DeepMTS lags</span>
</span><span id="DeepMTS-96"><a href="#DeepMTS-96"><span class="linenos"> 96</span></a>
</span><span id="DeepMTS-97"><a href="#DeepMTS-97"><span class="linenos"> 97</span></a><span class="sd">        xreg_: {array-like}</span>
</span><span id="DeepMTS-98"><a href="#DeepMTS-98"><span class="linenos"> 98</span></a><span class="sd">            external regressors</span>
</span><span id="DeepMTS-99"><a href="#DeepMTS-99"><span class="linenos"> 99</span></a>
</span><span id="DeepMTS-100"><a href="#DeepMTS-100"><span class="linenos">100</span></a><span class="sd">        y_means_: dict</span>
</span><span id="DeepMTS-101"><a href="#DeepMTS-101"><span class="linenos">101</span></a><span class="sd">            a dictionary of each series mean values</span>
</span><span id="DeepMTS-102"><a href="#DeepMTS-102"><span class="linenos">102</span></a>
</span><span id="DeepMTS-103"><a href="#DeepMTS-103"><span class="linenos">103</span></a><span class="sd">        preds_: {array-like}</span>
</span><span id="DeepMTS-104"><a href="#DeepMTS-104"><span class="linenos">104</span></a><span class="sd">            successive model predictions</span>
</span><span id="DeepMTS-105"><a href="#DeepMTS-105"><span class="linenos">105</span></a>
</span><span id="DeepMTS-106"><a href="#DeepMTS-106"><span class="linenos">106</span></a><span class="sd">        preds_std_: {array-like}</span>
</span><span id="DeepMTS-107"><a href="#DeepMTS-107"><span class="linenos">107</span></a><span class="sd">            standard deviation around the predictions</span>
</span><span id="DeepMTS-108"><a href="#DeepMTS-108"><span class="linenos">108</span></a>
</span><span id="DeepMTS-109"><a href="#DeepMTS-109"><span class="linenos">109</span></a><span class="sd">        return_std_: boolean</span>
</span><span id="DeepMTS-110"><a href="#DeepMTS-110"><span class="linenos">110</span></a><span class="sd">            return uncertainty or not (set in predict)</span>
</span><span id="DeepMTS-111"><a href="#DeepMTS-111"><span class="linenos">111</span></a>
</span><span id="DeepMTS-112"><a href="#DeepMTS-112"><span class="linenos">112</span></a><span class="sd">        df_: data frame</span>
</span><span id="DeepMTS-113"><a href="#DeepMTS-113"><span class="linenos">113</span></a><span class="sd">            the input data frame, in case a data.frame is provided to `fit`</span>
</span><span id="DeepMTS-114"><a href="#DeepMTS-114"><span class="linenos">114</span></a>
</span><span id="DeepMTS-115"><a href="#DeepMTS-115"><span class="linenos">115</span></a><span class="sd">    Examples:</span>
</span><span id="DeepMTS-116"><a href="#DeepMTS-116"><span class="linenos">116</span></a>
</span><span id="DeepMTS-117"><a href="#DeepMTS-117"><span class="linenos">117</span></a><span class="sd">    Example 1:</span>
</span><span id="DeepMTS-118"><a href="#DeepMTS-118"><span class="linenos">118</span></a>
</span><span id="DeepMTS-119"><a href="#DeepMTS-119"><span class="linenos">119</span></a><span class="sd">        ```python</span>
</span><span id="DeepMTS-120"><a href="#DeepMTS-120"><span class="linenos">120</span></a><span class="sd">        import nnetsauce as ns</span>
</span><span id="DeepMTS-121"><a href="#DeepMTS-121"><span class="linenos">121</span></a><span class="sd">        import numpy as np</span>
</span><span id="DeepMTS-122"><a href="#DeepMTS-122"><span class="linenos">122</span></a><span class="sd">        from sklearn import linear_model</span>
</span><span id="DeepMTS-123"><a href="#DeepMTS-123"><span class="linenos">123</span></a><span class="sd">        np.random.seed(123)</span>
</span><span id="DeepMTS-124"><a href="#DeepMTS-124"><span class="linenos">124</span></a>
</span><span id="DeepMTS-125"><a href="#DeepMTS-125"><span class="linenos">125</span></a><span class="sd">        M = np.random.rand(10, 3)</span>
</span><span id="DeepMTS-126"><a href="#DeepMTS-126"><span class="linenos">126</span></a><span class="sd">        M[:,0] = 10*M[:,0]</span>
</span><span id="DeepMTS-127"><a href="#DeepMTS-127"><span class="linenos">127</span></a><span class="sd">        M[:,2] = 25*M[:,2]</span>
</span><span id="DeepMTS-128"><a href="#DeepMTS-128"><span class="linenos">128</span></a><span class="sd">        print(M)</span>
</span><span id="DeepMTS-129"><a href="#DeepMTS-129"><span class="linenos">129</span></a>
</span><span id="DeepMTS-130"><a href="#DeepMTS-130"><span class="linenos">130</span></a><span class="sd">        # Adjust Bayesian Ridge</span>
</span><span id="DeepMTS-131"><a href="#DeepMTS-131"><span class="linenos">131</span></a><span class="sd">        regr4 = linear_model.BayesianRidge()</span>
</span><span id="DeepMTS-132"><a href="#DeepMTS-132"><span class="linenos">132</span></a><span class="sd">        obj_DeepMTS = ns.DeepMTS(regr4, lags = 1, n_hidden_features=5)</span>
</span><span id="DeepMTS-133"><a href="#DeepMTS-133"><span class="linenos">133</span></a><span class="sd">        obj_DeepMTS.fit(M)</span>
</span><span id="DeepMTS-134"><a href="#DeepMTS-134"><span class="linenos">134</span></a><span class="sd">        print(obj_DeepMTS.predict())</span>
</span><span id="DeepMTS-135"><a href="#DeepMTS-135"><span class="linenos">135</span></a>
</span><span id="DeepMTS-136"><a href="#DeepMTS-136"><span class="linenos">136</span></a><span class="sd">        # with credible intervals</span>
</span><span id="DeepMTS-137"><a href="#DeepMTS-137"><span class="linenos">137</span></a><span class="sd">        print(obj_DeepMTS.predict(return_std=True, level=80))</span>
</span><span id="DeepMTS-138"><a href="#DeepMTS-138"><span class="linenos">138</span></a>
</span><span id="DeepMTS-139"><a href="#DeepMTS-139"><span class="linenos">139</span></a><span class="sd">        print(obj_DeepMTS.predict(return_std=True, level=95))</span>
</span><span id="DeepMTS-140"><a href="#DeepMTS-140"><span class="linenos">140</span></a><span class="sd">        ```</span>
</span><span id="DeepMTS-141"><a href="#DeepMTS-141"><span class="linenos">141</span></a>
</span><span id="DeepMTS-142"><a href="#DeepMTS-142"><span class="linenos">142</span></a><span class="sd">    Example 2:</span>
</span><span id="DeepMTS-143"><a href="#DeepMTS-143"><span class="linenos">143</span></a>
</span><span id="DeepMTS-144"><a href="#DeepMTS-144"><span class="linenos">144</span></a><span class="sd">        ```python</span>
</span><span id="DeepMTS-145"><a href="#DeepMTS-145"><span class="linenos">145</span></a><span class="sd">        import nnetsauce as ns</span>
</span><span id="DeepMTS-146"><a href="#DeepMTS-146"><span class="linenos">146</span></a><span class="sd">        import numpy as np</span>
</span><span id="DeepMTS-147"><a href="#DeepMTS-147"><span class="linenos">147</span></a><span class="sd">        from sklearn import linear_model</span>
</span><span id="DeepMTS-148"><a href="#DeepMTS-148"><span class="linenos">148</span></a>
</span><span id="DeepMTS-149"><a href="#DeepMTS-149"><span class="linenos">149</span></a><span class="sd">        dataset = {</span>
</span><span id="DeepMTS-150"><a href="#DeepMTS-150"><span class="linenos">150</span></a><span class="sd">        &#39;date&#39; : [&#39;2001-01-01&#39;, &#39;2002-01-01&#39;, &#39;2003-01-01&#39;, &#39;2004-01-01&#39;, &#39;2005-01-01&#39;],</span>
</span><span id="DeepMTS-151"><a href="#DeepMTS-151"><span class="linenos">151</span></a><span class="sd">        &#39;series1&#39; : [34, 30, 35.6, 33.3, 38.1],</span>
</span><span id="DeepMTS-152"><a href="#DeepMTS-152"><span class="linenos">152</span></a><span class="sd">        &#39;series2&#39; : [4, 5.5, 5.6, 6.3, 5.1],</span>
</span><span id="DeepMTS-153"><a href="#DeepMTS-153"><span class="linenos">153</span></a><span class="sd">        &#39;series3&#39; : [100, 100.5, 100.6, 100.2, 100.1]}</span>
</span><span id="DeepMTS-154"><a href="#DeepMTS-154"><span class="linenos">154</span></a><span class="sd">        df = pd.DataFrame(dataset).set_index(&#39;date&#39;)</span>
</span><span id="DeepMTS-155"><a href="#DeepMTS-155"><span class="linenos">155</span></a><span class="sd">        print(df)</span>
</span><span id="DeepMTS-156"><a href="#DeepMTS-156"><span class="linenos">156</span></a>
</span><span id="DeepMTS-157"><a href="#DeepMTS-157"><span class="linenos">157</span></a><span class="sd">        # Adjust Bayesian Ridge</span>
</span><span id="DeepMTS-158"><a href="#DeepMTS-158"><span class="linenos">158</span></a><span class="sd">        regr5 = linear_model.BayesianRidge()</span>
</span><span id="DeepMTS-159"><a href="#DeepMTS-159"><span class="linenos">159</span></a><span class="sd">        obj_DeepMTS = ns.DeepMTS(regr5, lags = 1, n_hidden_features=5)</span>
</span><span id="DeepMTS-160"><a href="#DeepMTS-160"><span class="linenos">160</span></a><span class="sd">        obj_DeepMTS.fit(df)</span>
</span><span id="DeepMTS-161"><a href="#DeepMTS-161"><span class="linenos">161</span></a><span class="sd">        print(obj_DeepMTS.predict())</span>
</span><span id="DeepMTS-162"><a href="#DeepMTS-162"><span class="linenos">162</span></a>
</span><span id="DeepMTS-163"><a href="#DeepMTS-163"><span class="linenos">163</span></a><span class="sd">        # with credible intervals</span>
</span><span id="DeepMTS-164"><a href="#DeepMTS-164"><span class="linenos">164</span></a><span class="sd">        print(obj_DeepMTS.predict(return_std=True, level=80))</span>
</span><span id="DeepMTS-165"><a href="#DeepMTS-165"><span class="linenos">165</span></a>
</span><span id="DeepMTS-166"><a href="#DeepMTS-166"><span class="linenos">166</span></a><span class="sd">        print(obj_DeepMTS.predict(return_std=True, level=95))</span>
</span><span id="DeepMTS-167"><a href="#DeepMTS-167"><span class="linenos">167</span></a><span class="sd">        ```</span>
</span><span id="DeepMTS-168"><a href="#DeepMTS-168"><span class="linenos">168</span></a>
</span><span id="DeepMTS-169"><a href="#DeepMTS-169"><span class="linenos">169</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DeepMTS-170"><a href="#DeepMTS-170"><span class="linenos">170</span></a>
</span><span id="DeepMTS-171"><a href="#DeepMTS-171"><span class="linenos">171</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="DeepMTS-172"><a href="#DeepMTS-172"><span class="linenos">172</span></a>
</span><span id="DeepMTS-173"><a href="#DeepMTS-173"><span class="linenos">173</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="DeepMTS-174"><a href="#DeepMTS-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DeepMTS-175"><a href="#DeepMTS-175"><span class="linenos">175</span></a>        <span class="n">obj</span><span class="p">,</span>
</span><span id="DeepMTS-176"><a href="#DeepMTS-176"><span class="linenos">176</span></a>        <span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="DeepMTS-177"><a href="#DeepMTS-177"><span class="linenos">177</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="DeepMTS-178"><a href="#DeepMTS-178"><span class="linenos">178</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="DeepMTS-179"><a href="#DeepMTS-179"><span class="linenos">179</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="DeepMTS-180"><a href="#DeepMTS-180"><span class="linenos">180</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="DeepMTS-181"><a href="#DeepMTS-181"><span class="linenos">181</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DeepMTS-182"><a href="#DeepMTS-182"><span class="linenos">182</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="DeepMTS-183"><a href="#DeepMTS-183"><span class="linenos">183</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DeepMTS-184"><a href="#DeepMTS-184"><span class="linenos">184</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="DeepMTS-185"><a href="#DeepMTS-185"><span class="linenos">185</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DeepMTS-186"><a href="#DeepMTS-186"><span class="linenos">186</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="DeepMTS-187"><a href="#DeepMTS-187"><span class="linenos">187</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="DeepMTS-188"><a href="#DeepMTS-188"><span class="linenos">188</span></a>        <span class="n">lags</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="DeepMTS-189"><a href="#DeepMTS-189"><span class="linenos">189</span></a>        <span class="n">type_pi</span><span class="o">=</span><span class="s2">&quot;kde&quot;</span><span class="p">,</span>
</span><span id="DeepMTS-190"><a href="#DeepMTS-190"><span class="linenos">190</span></a>        <span class="n">replications</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DeepMTS-191"><a href="#DeepMTS-191"><span class="linenos">191</span></a>        <span class="n">kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DeepMTS-192"><a href="#DeepMTS-192"><span class="linenos">192</span></a>        <span class="n">agg</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
</span><span id="DeepMTS-193"><a href="#DeepMTS-193"><span class="linenos">193</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="DeepMTS-194"><a href="#DeepMTS-194"><span class="linenos">194</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="DeepMTS-195"><a href="#DeepMTS-195"><span class="linenos">195</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="DeepMTS-196"><a href="#DeepMTS-196"><span class="linenos">196</span></a>        <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="DeepMTS-197"><a href="#DeepMTS-197"><span class="linenos">197</span></a>    <span class="p">):</span>
</span><span id="DeepMTS-198"><a href="#DeepMTS-198"><span class="linenos">198</span></a>        <span class="k">assert</span> <span class="nb">int</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span> <span class="o">==</span> <span class="n">lags</span><span class="p">,</span> <span class="s2">&quot;parameter &#39;lags&#39; should be an integer&quot;</span>
</span><span id="DeepMTS-199"><a href="#DeepMTS-199"><span class="linenos">199</span></a>        <span class="k">assert</span> <span class="n">n_layers</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;must have n_layers &gt;= 2&quot;</span>
</span><span id="DeepMTS-200"><a href="#DeepMTS-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_layers</span><span class="p">)</span>
</span><span id="DeepMTS-201"><a href="#DeepMTS-201"><span class="linenos">201</span></a>
</span><span id="DeepMTS-202"><a href="#DeepMTS-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">DeepRegressor</span><span class="p">(</span>
</span><span id="DeepMTS-203"><a href="#DeepMTS-203"><span class="linenos">203</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="DeepMTS-204"><a href="#DeepMTS-204"><span class="linenos">204</span></a>            <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="DeepMTS-205"><a href="#DeepMTS-205"><span class="linenos">205</span></a>            <span class="n">n_layers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">,</span>
</span><span id="DeepMTS-206"><a href="#DeepMTS-206"><span class="linenos">206</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="DeepMTS-207"><a href="#DeepMTS-207"><span class="linenos">207</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="DeepMTS-208"><a href="#DeepMTS-208"><span class="linenos">208</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="DeepMTS-209"><a href="#DeepMTS-209"><span class="linenos">209</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="DeepMTS-210"><a href="#DeepMTS-210"><span class="linenos">210</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="DeepMTS-211"><a href="#DeepMTS-211"><span class="linenos">211</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="DeepMTS-212"><a href="#DeepMTS-212"><span class="linenos">212</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="DeepMTS-213"><a href="#DeepMTS-213"><span class="linenos">213</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="DeepMTS-214"><a href="#DeepMTS-214"><span class="linenos">214</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="DeepMTS-215"><a href="#DeepMTS-215"><span class="linenos">215</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="DeepMTS-216"><a href="#DeepMTS-216"><span class="linenos">216</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="DeepMTS-217"><a href="#DeepMTS-217"><span class="linenos">217</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="DeepMTS-218"><a href="#DeepMTS-218"><span class="linenos">218</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="DeepMTS-219"><a href="#DeepMTS-219"><span class="linenos">219</span></a>        <span class="p">)</span>
</span><span id="DeepMTS-220"><a href="#DeepMTS-220"><span class="linenos">220</span></a>
</span><span id="DeepMTS-221"><a href="#DeepMTS-221"><span class="linenos">221</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="DeepMTS-222"><a href="#DeepMTS-222"><span class="linenos">222</span></a>            <span class="n">obj</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span>
</span><span id="DeepMTS-223"><a href="#DeepMTS-223"><span class="linenos">223</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="DeepMTS-224"><a href="#DeepMTS-224"><span class="linenos">224</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="DeepMTS-225"><a href="#DeepMTS-225"><span class="linenos">225</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="DeepMTS-226"><a href="#DeepMTS-226"><span class="linenos">226</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="DeepMTS-227"><a href="#DeepMTS-227"><span class="linenos">227</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="DeepMTS-228"><a href="#DeepMTS-228"><span class="linenos">228</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="DeepMTS-229"><a href="#DeepMTS-229"><span class="linenos">229</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="DeepMTS-230"><a href="#DeepMTS-230"><span class="linenos">230</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="DeepMTS-231"><a href="#DeepMTS-231"><span class="linenos">231</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="DeepMTS-232"><a href="#DeepMTS-232"><span class="linenos">232</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="DeepMTS-233"><a href="#DeepMTS-233"><span class="linenos">233</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="DeepMTS-234"><a href="#DeepMTS-234"><span class="linenos">234</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="DeepMTS-235"><a href="#DeepMTS-235"><span class="linenos">235</span></a>            <span class="n">type_pi</span><span class="o">=</span><span class="n">type_pi</span><span class="p">,</span>
</span><span id="DeepMTS-236"><a href="#DeepMTS-236"><span class="linenos">236</span></a>            <span class="n">replications</span><span class="o">=</span><span class="n">replications</span><span class="p">,</span>
</span><span id="DeepMTS-237"><a href="#DeepMTS-237"><span class="linenos">237</span></a>            <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="DeepMTS-238"><a href="#DeepMTS-238"><span class="linenos">238</span></a>            <span class="n">agg</span><span class="o">=</span><span class="n">agg</span><span class="p">,</span>
</span><span id="DeepMTS-239"><a href="#DeepMTS-239"><span class="linenos">239</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="DeepMTS-240"><a href="#DeepMTS-240"><span class="linenos">240</span></a>            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="DeepMTS-241"><a href="#DeepMTS-241"><span class="linenos">241</span></a>            <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="DeepMTS-242"><a href="#DeepMTS-242"><span class="linenos">242</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Univariate and multivariate time series (DeepMTS) forecasting with Quasi-Randomized networks (Work in progress /!)</p>

<p>Parameters:</p>

<pre><code>obj: object.
    any object containing a method fit (obj.fit()) and a method predict
    (obj.predict()).

n_layers: int.
    number of layers in the neural network.

n_hidden_features: int.
    number of nodes in the hidden layer.

activation_name: str.
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'.

a: float.
    hyperparameter for 'prelu' or 'elu' activation function.

nodes_sim: str.
    type of simulation for the nodes: 'sobol', 'hammersley', 'halton',
    'uniform'.

bias: boolean.
    indicates if the hidden layer contains a bias term (True) or not
    (False).

dropout: float.
    regularization parameter; (random) percentage of nodes dropped out
    of the training.

direct_link: boolean.
    indicates if the original predictors are included (True) in model's fitting or not (False).

n_clusters: int.
    number of clusters for 'kmeans' or 'gmm' clustering (could be 0: no clustering).

cluster_encode: bool.
    defines how the variable containing clusters is treated (default is one-hot)
    if `False`, then labels are used, without one-hot encoding.

type_clust: str.
    type of clustering method: currently k-means ('kmeans') or Gaussian
    Mixture Model ('gmm').

type_scaling: a tuple of 3 strings.
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax').

lags: int.
    number of lags used for each time series.

replications: int.
    number of replications (if needed, for predictive simulation). Default is 'None'.

kernel: str.
    the kernel to use for residuals density estimation (used for predictive simulation). Currently, either 'gaussian' or 'tophat'.

agg: str.
    either "mean" or "median" for simulation of bootstrap aggregating

seed: int.
    reproducibility seed for nodes_sim=='uniform' or predictive simulation.

backend: str.
    "cpu" or "gpu" or "tpu".

verbose: int.
    0: not printing; 1: printing

show_progress: bool.
    True: progress bar when fitting each series; False: no progress bar when fitting each series
</code></pre>

<p>Attributes:</p>

<pre><code>fit_objs_: dict
    objects adjusted to each individual time series

y_: {array-like}
    DeepMTS responses (most recent observations first)

X_: {array-like}
    DeepMTS lags

xreg_: {array-like}
    external regressors

y_means_: dict
    a dictionary of each series mean values

preds_: {array-like}
    successive model predictions

preds_std_: {array-like}
    standard deviation around the predictions

return_std_: boolean
    return uncertainty or not (set in predict)

df_: data frame
    the input data frame, in case a data.frame is provided to `fit`
</code></pre>

<p>Examples:</p>

<p>Example 1:
    <div class="pdoc-code codehilite">
    <pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
 <br />
    <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">M</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="o"><em></span><span class="n">M</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">M</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">25</span><span class="o"></em></span><span class="n">M</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
 <br />
    <span class="c1"># Adjust Bayesian Ridge</span>
    <span class="n">regr4</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">BayesianRidge</span><span class="p">()</span>
    <span class="n">obj_DeepMTS</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">DeepMTS</span><span class="p">(</span><span class="n">regr4</span><span class="p">,</span> <span class="n">lags</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">obj_DeepMTS</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">obj_DeepMTS</span><span class="o">.</span><span class="n">predict</span><span class="p">())</span>
 <br />
    <span class="c1"># with credible intervals</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">obj_DeepMTS</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">return_std</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">80</span><span class="p">))</span>
 <br />
    <span class="nb">print</span><span class="p">(</span><span class="n">obj_DeepMTS</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">return_std</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">))</span>
    </code></pre>
    </div></p>

<p>Example 2:
    <div class="pdoc-code codehilite">
    <pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
 <br />
    <span class="n">dataset</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;date&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2001-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2002-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2003-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-01-01&#39;</span><span class="p">],</span>
    <span class="s1">&#39;series1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">34</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mf">35.6</span><span class="p">,</span> <span class="mf">33.3</span><span class="p">,</span> <span class="mf">38.1</span><span class="p">],</span>
    <span class="s1">&#39;series2&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.6</span><span class="p">,</span> <span class="mf">6.3</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">],</span>
    <span class="s1">&#39;series3&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mf">100.5</span><span class="p">,</span> <span class="mf">100.6</span><span class="p">,</span> <span class="mf">100.2</span><span class="p">,</span> <span class="mf">100.1</span><span class="p">]}</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
 <br />
    <span class="c1"># Adjust Bayesian Ridge</span>
    <span class="n">regr5</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">BayesianRidge</span><span class="p">()</span>
    <span class="n">obj_DeepMTS</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">DeepMTS</span><span class="p">(</span><span class="n">regr5</span><span class="p">,</span> <span class="n">lags</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">obj_DeepMTS</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">obj_DeepMTS</span><span class="o">.</span><span class="n">predict</span><span class="p">())</span>
 <br />
    <span class="c1"># with credible intervals</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">obj_DeepMTS</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">return_std</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">80</span><span class="p">))</span>
 <br />
    <span class="nb">print</span><span class="p">(</span><span class="n">obj_DeepMTS</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">return_std</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">))</span>
    </code></pre>
    </div></p>
</div>


                        
                </section>
                <section id="Downloader">
                            <input id="Downloader-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Downloader</span>:

                <label class="view-source-button" for="Downloader-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Downloader"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Downloader-6"><a href="#Downloader-6"><span class="linenos"> 6</span></a><span class="k">class</span> <span class="nc">Downloader</span><span class="p">:</span>
</span><span id="Downloader-7"><a href="#Downloader-7"><span class="linenos"> 7</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Download datasets from data sources (R-universe for now)&quot;&quot;&quot;</span>
</span><span id="Downloader-8"><a href="#Downloader-8"><span class="linenos"> 8</span></a>
</span><span id="Downloader-9"><a href="#Downloader-9"><span class="linenos"> 9</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Downloader-10"><a href="#Downloader-10"><span class="linenos">10</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pkgname</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Downloader-11"><a href="#Downloader-11"><span class="linenos">11</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Downloader-12"><a href="#Downloader-12"><span class="linenos">12</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Downloader-13"><a href="#Downloader-13"><span class="linenos">13</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Downloader-14"><a href="#Downloader-14"><span class="linenos">14</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">request</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Downloader-15"><a href="#Downloader-15"><span class="linenos">15</span></a>
</span><span id="Downloader-16"><a href="#Downloader-16"><span class="linenos">16</span></a>    <span class="k">def</span> <span class="nf">download</span><span class="p">(</span>
</span><span id="Downloader-17"><a href="#Downloader-17"><span class="linenos">17</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Downloader-18"><a href="#Downloader-18"><span class="linenos">18</span></a>        <span class="n">pkgname</span><span class="o">=</span><span class="s2">&quot;MASS&quot;</span><span class="p">,</span>
</span><span id="Downloader-19"><a href="#Downloader-19"><span class="linenos">19</span></a>        <span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;Boston&quot;</span><span class="p">,</span>
</span><span id="Downloader-20"><a href="#Downloader-20"><span class="linenos">20</span></a>        <span class="n">source</span><span class="o">=</span><span class="s2">&quot;https://cran.r-universe.dev/&quot;</span><span class="p">,</span>
</span><span id="Downloader-21"><a href="#Downloader-21"><span class="linenos">21</span></a>        <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Downloader-22"><a href="#Downloader-22"><span class="linenos">22</span></a>    <span class="p">):</span>
</span><span id="Downloader-23"><a href="#Downloader-23"><span class="linenos">23</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Download datasets from data sources (R-universe for now)</span>
</span><span id="Downloader-24"><a href="#Downloader-24"><span class="linenos">24</span></a>
</span><span id="Downloader-25"><a href="#Downloader-25"><span class="linenos">25</span></a><span class="sd">        Examples:</span>
</span><span id="Downloader-26"><a href="#Downloader-26"><span class="linenos">26</span></a>
</span><span id="Downloader-27"><a href="#Downloader-27"><span class="linenos">27</span></a><span class="sd">        ```python</span>
</span><span id="Downloader-28"><a href="#Downloader-28"><span class="linenos">28</span></a><span class="sd">        import nnetsauce as ns</span>
</span><span id="Downloader-29"><a href="#Downloader-29"><span class="linenos">29</span></a>
</span><span id="Downloader-30"><a href="#Downloader-30"><span class="linenos">30</span></a><span class="sd">        downloader = ns.Downloader()</span>
</span><span id="Downloader-31"><a href="#Downloader-31"><span class="linenos">31</span></a><span class="sd">        df = downloader.download(pkgname=&quot;MASS&quot;, dataset=&quot;Boston&quot;)</span>
</span><span id="Downloader-32"><a href="#Downloader-32"><span class="linenos">32</span></a><span class="sd">        ```</span>
</span><span id="Downloader-33"><a href="#Downloader-33"><span class="linenos">33</span></a>
</span><span id="Downloader-34"><a href="#Downloader-34"><span class="linenos">34</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Downloader-35"><a href="#Downloader-35"><span class="linenos">35</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pkgname</span> <span class="o">=</span> <span class="n">pkgname</span>
</span><span id="Downloader-36"><a href="#Downloader-36"><span class="linenos">36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span>
</span><span id="Downloader-37"><a href="#Downloader-37"><span class="linenos">37</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">source</span>
</span><span id="Downloader-38"><a href="#Downloader-38"><span class="linenos">38</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">source</span> <span class="o">+</span> <span class="n">pkgname</span> <span class="o">+</span> <span class="s2">&quot;/data/&quot;</span> <span class="o">+</span> <span class="n">dataset</span> <span class="o">+</span> <span class="s2">&quot;/json&quot;</span>
</span><span id="Downloader-39"><a href="#Downloader-39"><span class="linenos">39</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
</span><span id="Downloader-40"><a href="#Downloader-40"><span class="linenos">40</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Download datasets from data sources (R-universe for now)</p>
</div>


                                <div id="Downloader.download" class="classattr">
                                            <input id="Downloader.download-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">download</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">pkgname</span><span class="o">=</span><span class="s1">&#39;MASS&#39;</span>,</span><span class="param">	<span class="n">dataset</span><span class="o">=</span><span class="s1">&#39;Boston&#39;</span>,</span><span class="param">	<span class="n">source</span><span class="o">=</span><span class="s1">&#39;https://cran.r-universe.dev/&#39;</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Downloader.download-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Downloader.download"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Downloader.download-16"><a href="#Downloader.download-16"><span class="linenos">16</span></a>    <span class="k">def</span> <span class="nf">download</span><span class="p">(</span>
</span><span id="Downloader.download-17"><a href="#Downloader.download-17"><span class="linenos">17</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Downloader.download-18"><a href="#Downloader.download-18"><span class="linenos">18</span></a>        <span class="n">pkgname</span><span class="o">=</span><span class="s2">&quot;MASS&quot;</span><span class="p">,</span>
</span><span id="Downloader.download-19"><a href="#Downloader.download-19"><span class="linenos">19</span></a>        <span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;Boston&quot;</span><span class="p">,</span>
</span><span id="Downloader.download-20"><a href="#Downloader.download-20"><span class="linenos">20</span></a>        <span class="n">source</span><span class="o">=</span><span class="s2">&quot;https://cran.r-universe.dev/&quot;</span><span class="p">,</span>
</span><span id="Downloader.download-21"><a href="#Downloader.download-21"><span class="linenos">21</span></a>        <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Downloader.download-22"><a href="#Downloader.download-22"><span class="linenos">22</span></a>    <span class="p">):</span>
</span><span id="Downloader.download-23"><a href="#Downloader.download-23"><span class="linenos">23</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Download datasets from data sources (R-universe for now)</span>
</span><span id="Downloader.download-24"><a href="#Downloader.download-24"><span class="linenos">24</span></a>
</span><span id="Downloader.download-25"><a href="#Downloader.download-25"><span class="linenos">25</span></a><span class="sd">        Examples:</span>
</span><span id="Downloader.download-26"><a href="#Downloader.download-26"><span class="linenos">26</span></a>
</span><span id="Downloader.download-27"><a href="#Downloader.download-27"><span class="linenos">27</span></a><span class="sd">        ```python</span>
</span><span id="Downloader.download-28"><a href="#Downloader.download-28"><span class="linenos">28</span></a><span class="sd">        import nnetsauce as ns</span>
</span><span id="Downloader.download-29"><a href="#Downloader.download-29"><span class="linenos">29</span></a>
</span><span id="Downloader.download-30"><a href="#Downloader.download-30"><span class="linenos">30</span></a><span class="sd">        downloader = ns.Downloader()</span>
</span><span id="Downloader.download-31"><a href="#Downloader.download-31"><span class="linenos">31</span></a><span class="sd">        df = downloader.download(pkgname=&quot;MASS&quot;, dataset=&quot;Boston&quot;)</span>
</span><span id="Downloader.download-32"><a href="#Downloader.download-32"><span class="linenos">32</span></a><span class="sd">        ```</span>
</span><span id="Downloader.download-33"><a href="#Downloader.download-33"><span class="linenos">33</span></a>
</span><span id="Downloader.download-34"><a href="#Downloader.download-34"><span class="linenos">34</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Downloader.download-35"><a href="#Downloader.download-35"><span class="linenos">35</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pkgname</span> <span class="o">=</span> <span class="n">pkgname</span>
</span><span id="Downloader.download-36"><a href="#Downloader.download-36"><span class="linenos">36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span>
</span><span id="Downloader.download-37"><a href="#Downloader.download-37"><span class="linenos">37</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">source</span>
</span><span id="Downloader.download-38"><a href="#Downloader.download-38"><span class="linenos">38</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">source</span> <span class="o">+</span> <span class="n">pkgname</span> <span class="o">+</span> <span class="s2">&quot;/data/&quot;</span> <span class="o">+</span> <span class="n">dataset</span> <span class="o">+</span> <span class="s2">&quot;/json&quot;</span>
</span><span id="Downloader.download-39"><a href="#Downloader.download-39"><span class="linenos">39</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">request</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
</span><span id="Downloader.download-40"><a href="#Downloader.download-40"><span class="linenos">40</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Download datasets from data sources (R-universe for now)</p>

<p>Examples:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>

<span class="n">downloader</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">Downloader</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">downloader</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">pkgname</span><span class="o">=</span><span class="s2">&quot;MASS&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="s2">&quot;Boston&quot;</span><span class="p">)</span>
</code></pre>
</div>
</div>


                                </div>
                        
                </section>
                <section id="GLMClassifier">
                            <input id="GLMClassifier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">GLMClassifier</span><wbr>(<span class="base">nnetsauce.glm.glm.GLM</span>, <span class="base">sklearn.base.ClassifierMixin</span>):

                <label class="view-source-button" for="GLMClassifier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GLMClassifier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GLMClassifier-16"><a href="#GLMClassifier-16"><span class="linenos"> 16</span></a><span class="k">class</span> <span class="nc">GLMClassifier</span><span class="p">(</span><span class="n">GLM</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">):</span>
</span><span id="GLMClassifier-17"><a href="#GLMClassifier-17"><span class="linenos"> 17</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generalized &#39;linear&#39; models using quasi-randomized networks (classification)</span>
</span><span id="GLMClassifier-18"><a href="#GLMClassifier-18"><span class="linenos"> 18</span></a>
</span><span id="GLMClassifier-19"><a href="#GLMClassifier-19"><span class="linenos"> 19</span></a><span class="sd">    Parameters:</span>
</span><span id="GLMClassifier-20"><a href="#GLMClassifier-20"><span class="linenos"> 20</span></a>
</span><span id="GLMClassifier-21"><a href="#GLMClassifier-21"><span class="linenos"> 21</span></a><span class="sd">        n_hidden_features: int</span>
</span><span id="GLMClassifier-22"><a href="#GLMClassifier-22"><span class="linenos"> 22</span></a><span class="sd">            number of nodes in the hidden layer</span>
</span><span id="GLMClassifier-23"><a href="#GLMClassifier-23"><span class="linenos"> 23</span></a>
</span><span id="GLMClassifier-24"><a href="#GLMClassifier-24"><span class="linenos"> 24</span></a><span class="sd">        lambda1: float</span>
</span><span id="GLMClassifier-25"><a href="#GLMClassifier-25"><span class="linenos"> 25</span></a><span class="sd">            regularization parameter for GLM coefficients on original features</span>
</span><span id="GLMClassifier-26"><a href="#GLMClassifier-26"><span class="linenos"> 26</span></a>
</span><span id="GLMClassifier-27"><a href="#GLMClassifier-27"><span class="linenos"> 27</span></a><span class="sd">        alpha1: float</span>
</span><span id="GLMClassifier-28"><a href="#GLMClassifier-28"><span class="linenos"> 28</span></a><span class="sd">            controls compromize between l1 and l2 norm of GLM coefficients on original features</span>
</span><span id="GLMClassifier-29"><a href="#GLMClassifier-29"><span class="linenos"> 29</span></a>
</span><span id="GLMClassifier-30"><a href="#GLMClassifier-30"><span class="linenos"> 30</span></a><span class="sd">        lambda2: float</span>
</span><span id="GLMClassifier-31"><a href="#GLMClassifier-31"><span class="linenos"> 31</span></a><span class="sd">            regularization parameter for GLM coefficients on nonlinear features</span>
</span><span id="GLMClassifier-32"><a href="#GLMClassifier-32"><span class="linenos"> 32</span></a>
</span><span id="GLMClassifier-33"><a href="#GLMClassifier-33"><span class="linenos"> 33</span></a><span class="sd">        alpha2: float</span>
</span><span id="GLMClassifier-34"><a href="#GLMClassifier-34"><span class="linenos"> 34</span></a><span class="sd">            controls compromize between l1 and l2 norm of GLM coefficients on nonlinear features</span>
</span><span id="GLMClassifier-35"><a href="#GLMClassifier-35"><span class="linenos"> 35</span></a>
</span><span id="GLMClassifier-36"><a href="#GLMClassifier-36"><span class="linenos"> 36</span></a><span class="sd">        activation_name: str</span>
</span><span id="GLMClassifier-37"><a href="#GLMClassifier-37"><span class="linenos"> 37</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;</span>
</span><span id="GLMClassifier-38"><a href="#GLMClassifier-38"><span class="linenos"> 38</span></a>
</span><span id="GLMClassifier-39"><a href="#GLMClassifier-39"><span class="linenos"> 39</span></a><span class="sd">        a: float</span>
</span><span id="GLMClassifier-40"><a href="#GLMClassifier-40"><span class="linenos"> 40</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function</span>
</span><span id="GLMClassifier-41"><a href="#GLMClassifier-41"><span class="linenos"> 41</span></a>
</span><span id="GLMClassifier-42"><a href="#GLMClassifier-42"><span class="linenos"> 42</span></a><span class="sd">        nodes_sim: str</span>
</span><span id="GLMClassifier-43"><a href="#GLMClassifier-43"><span class="linenos"> 43</span></a><span class="sd">            type of simulation for the nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;,</span>
</span><span id="GLMClassifier-44"><a href="#GLMClassifier-44"><span class="linenos"> 44</span></a><span class="sd">            &#39;uniform&#39;</span>
</span><span id="GLMClassifier-45"><a href="#GLMClassifier-45"><span class="linenos"> 45</span></a>
</span><span id="GLMClassifier-46"><a href="#GLMClassifier-46"><span class="linenos"> 46</span></a><span class="sd">        bias: boolean</span>
</span><span id="GLMClassifier-47"><a href="#GLMClassifier-47"><span class="linenos"> 47</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or not</span>
</span><span id="GLMClassifier-48"><a href="#GLMClassifier-48"><span class="linenos"> 48</span></a><span class="sd">            (False)</span>
</span><span id="GLMClassifier-49"><a href="#GLMClassifier-49"><span class="linenos"> 49</span></a>
</span><span id="GLMClassifier-50"><a href="#GLMClassifier-50"><span class="linenos"> 50</span></a><span class="sd">        dropout: float</span>
</span><span id="GLMClassifier-51"><a href="#GLMClassifier-51"><span class="linenos"> 51</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="GLMClassifier-52"><a href="#GLMClassifier-52"><span class="linenos"> 52</span></a><span class="sd">            of the training</span>
</span><span id="GLMClassifier-53"><a href="#GLMClassifier-53"><span class="linenos"> 53</span></a>
</span><span id="GLMClassifier-54"><a href="#GLMClassifier-54"><span class="linenos"> 54</span></a><span class="sd">        direct_link: boolean</span>
</span><span id="GLMClassifier-55"><a href="#GLMClassifier-55"><span class="linenos"> 55</span></a><span class="sd">            indicates if the original predictors are included (True) in model&#39;s</span>
</span><span id="GLMClassifier-56"><a href="#GLMClassifier-56"><span class="linenos"> 56</span></a><span class="sd">            fitting or not (False)</span>
</span><span id="GLMClassifier-57"><a href="#GLMClassifier-57"><span class="linenos"> 57</span></a>
</span><span id="GLMClassifier-58"><a href="#GLMClassifier-58"><span class="linenos"> 58</span></a><span class="sd">        n_clusters: int</span>
</span><span id="GLMClassifier-59"><a href="#GLMClassifier-59"><span class="linenos"> 59</span></a><span class="sd">            number of clusters for &#39;kmeans&#39; or &#39;gmm&#39; clustering (could be 0:</span>
</span><span id="GLMClassifier-60"><a href="#GLMClassifier-60"><span class="linenos"> 60</span></a><span class="sd">                no clustering)</span>
</span><span id="GLMClassifier-61"><a href="#GLMClassifier-61"><span class="linenos"> 61</span></a>
</span><span id="GLMClassifier-62"><a href="#GLMClassifier-62"><span class="linenos"> 62</span></a><span class="sd">        cluster_encode: bool</span>
</span><span id="GLMClassifier-63"><a href="#GLMClassifier-63"><span class="linenos"> 63</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot)</span>
</span><span id="GLMClassifier-64"><a href="#GLMClassifier-64"><span class="linenos"> 64</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding</span>
</span><span id="GLMClassifier-65"><a href="#GLMClassifier-65"><span class="linenos"> 65</span></a>
</span><span id="GLMClassifier-66"><a href="#GLMClassifier-66"><span class="linenos"> 66</span></a><span class="sd">        type_clust: str</span>
</span><span id="GLMClassifier-67"><a href="#GLMClassifier-67"><span class="linenos"> 67</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian</span>
</span><span id="GLMClassifier-68"><a href="#GLMClassifier-68"><span class="linenos"> 68</span></a><span class="sd">            Mixture Model (&#39;gmm&#39;)</span>
</span><span id="GLMClassifier-69"><a href="#GLMClassifier-69"><span class="linenos"> 69</span></a>
</span><span id="GLMClassifier-70"><a href="#GLMClassifier-70"><span class="linenos"> 70</span></a><span class="sd">        type_scaling: a tuple of 3 strings</span>
</span><span id="GLMClassifier-71"><a href="#GLMClassifier-71"><span class="linenos"> 71</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="GLMClassifier-72"><a href="#GLMClassifier-72"><span class="linenos"> 72</span></a><span class="sd">            (and when relevant).</span>
</span><span id="GLMClassifier-73"><a href="#GLMClassifier-73"><span class="linenos"> 73</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;)</span>
</span><span id="GLMClassifier-74"><a href="#GLMClassifier-74"><span class="linenos"> 74</span></a>
</span><span id="GLMClassifier-75"><a href="#GLMClassifier-75"><span class="linenos"> 75</span></a><span class="sd">        optimizer: object</span>
</span><span id="GLMClassifier-76"><a href="#GLMClassifier-76"><span class="linenos"> 76</span></a><span class="sd">            optimizer, from class nnetsauce.Optimizer</span>
</span><span id="GLMClassifier-77"><a href="#GLMClassifier-77"><span class="linenos"> 77</span></a>
</span><span id="GLMClassifier-78"><a href="#GLMClassifier-78"><span class="linenos"> 78</span></a><span class="sd">        seed: int</span>
</span><span id="GLMClassifier-79"><a href="#GLMClassifier-79"><span class="linenos"> 79</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39;</span>
</span><span id="GLMClassifier-80"><a href="#GLMClassifier-80"><span class="linenos"> 80</span></a>
</span><span id="GLMClassifier-81"><a href="#GLMClassifier-81"><span class="linenos"> 81</span></a><span class="sd">    Attributes:</span>
</span><span id="GLMClassifier-82"><a href="#GLMClassifier-82"><span class="linenos"> 82</span></a>
</span><span id="GLMClassifier-83"><a href="#GLMClassifier-83"><span class="linenos"> 83</span></a><span class="sd">        beta_: vector</span>
</span><span id="GLMClassifier-84"><a href="#GLMClassifier-84"><span class="linenos"> 84</span></a><span class="sd">            regression coefficients</span>
</span><span id="GLMClassifier-85"><a href="#GLMClassifier-85"><span class="linenos"> 85</span></a>
</span><span id="GLMClassifier-86"><a href="#GLMClassifier-86"><span class="linenos"> 86</span></a><span class="sd">    Examples:</span>
</span><span id="GLMClassifier-87"><a href="#GLMClassifier-87"><span class="linenos"> 87</span></a>
</span><span id="GLMClassifier-88"><a href="#GLMClassifier-88"><span class="linenos"> 88</span></a><span class="sd">    See [https://github.com/Techtonique/nnetsauce/blob/master/examples/glm_classification.py](https://github.com/Techtonique/nnetsauce/blob/master/examples/glm_classification.py)</span>
</span><span id="GLMClassifier-89"><a href="#GLMClassifier-89"><span class="linenos"> 89</span></a>
</span><span id="GLMClassifier-90"><a href="#GLMClassifier-90"><span class="linenos"> 90</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="GLMClassifier-91"><a href="#GLMClassifier-91"><span class="linenos"> 91</span></a>
</span><span id="GLMClassifier-92"><a href="#GLMClassifier-92"><span class="linenos"> 92</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="GLMClassifier-93"><a href="#GLMClassifier-93"><span class="linenos"> 93</span></a>
</span><span id="GLMClassifier-94"><a href="#GLMClassifier-94"><span class="linenos"> 94</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="GLMClassifier-95"><a href="#GLMClassifier-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="GLMClassifier-96"><a href="#GLMClassifier-96"><span class="linenos"> 96</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="GLMClassifier-97"><a href="#GLMClassifier-97"><span class="linenos"> 97</span></a>        <span class="n">lambda1</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="GLMClassifier-98"><a href="#GLMClassifier-98"><span class="linenos"> 98</span></a>        <span class="n">alpha1</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="GLMClassifier-99"><a href="#GLMClassifier-99"><span class="linenos"> 99</span></a>        <span class="n">lambda2</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="GLMClassifier-100"><a href="#GLMClassifier-100"><span class="linenos">100</span></a>        <span class="n">alpha2</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="GLMClassifier-101"><a href="#GLMClassifier-101"><span class="linenos">101</span></a>        <span class="n">family</span><span class="o">=</span><span class="s2">&quot;expit&quot;</span><span class="p">,</span>
</span><span id="GLMClassifier-102"><a href="#GLMClassifier-102"><span class="linenos">102</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="GLMClassifier-103"><a href="#GLMClassifier-103"><span class="linenos">103</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="GLMClassifier-104"><a href="#GLMClassifier-104"><span class="linenos">104</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="GLMClassifier-105"><a href="#GLMClassifier-105"><span class="linenos">105</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="GLMClassifier-106"><a href="#GLMClassifier-106"><span class="linenos">106</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="GLMClassifier-107"><a href="#GLMClassifier-107"><span class="linenos">107</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="GLMClassifier-108"><a href="#GLMClassifier-108"><span class="linenos">108</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="GLMClassifier-109"><a href="#GLMClassifier-109"><span class="linenos">109</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="GLMClassifier-110"><a href="#GLMClassifier-110"><span class="linenos">110</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="GLMClassifier-111"><a href="#GLMClassifier-111"><span class="linenos">111</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="GLMClassifier-112"><a href="#GLMClassifier-112"><span class="linenos">112</span></a>        <span class="n">optimizer</span><span class="o">=</span><span class="n">Optimizer</span><span class="p">(),</span>
</span><span id="GLMClassifier-113"><a href="#GLMClassifier-113"><span class="linenos">113</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="GLMClassifier-114"><a href="#GLMClassifier-114"><span class="linenos">114</span></a>    <span class="p">):</span>
</span><span id="GLMClassifier-115"><a href="#GLMClassifier-115"><span class="linenos">115</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="GLMClassifier-116"><a href="#GLMClassifier-116"><span class="linenos">116</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="GLMClassifier-117"><a href="#GLMClassifier-117"><span class="linenos">117</span></a>            <span class="n">lambda1</span><span class="o">=</span><span class="n">lambda1</span><span class="p">,</span>
</span><span id="GLMClassifier-118"><a href="#GLMClassifier-118"><span class="linenos">118</span></a>            <span class="n">alpha1</span><span class="o">=</span><span class="n">alpha1</span><span class="p">,</span>
</span><span id="GLMClassifier-119"><a href="#GLMClassifier-119"><span class="linenos">119</span></a>            <span class="n">lambda2</span><span class="o">=</span><span class="n">lambda2</span><span class="p">,</span>
</span><span id="GLMClassifier-120"><a href="#GLMClassifier-120"><span class="linenos">120</span></a>            <span class="n">alpha2</span><span class="o">=</span><span class="n">alpha2</span><span class="p">,</span>
</span><span id="GLMClassifier-121"><a href="#GLMClassifier-121"><span class="linenos">121</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="GLMClassifier-122"><a href="#GLMClassifier-122"><span class="linenos">122</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="GLMClassifier-123"><a href="#GLMClassifier-123"><span class="linenos">123</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="GLMClassifier-124"><a href="#GLMClassifier-124"><span class="linenos">124</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="GLMClassifier-125"><a href="#GLMClassifier-125"><span class="linenos">125</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="GLMClassifier-126"><a href="#GLMClassifier-126"><span class="linenos">126</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="GLMClassifier-127"><a href="#GLMClassifier-127"><span class="linenos">127</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="GLMClassifier-128"><a href="#GLMClassifier-128"><span class="linenos">128</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="GLMClassifier-129"><a href="#GLMClassifier-129"><span class="linenos">129</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="GLMClassifier-130"><a href="#GLMClassifier-130"><span class="linenos">130</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="GLMClassifier-131"><a href="#GLMClassifier-131"><span class="linenos">131</span></a>            <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
</span><span id="GLMClassifier-132"><a href="#GLMClassifier-132"><span class="linenos">132</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="GLMClassifier-133"><a href="#GLMClassifier-133"><span class="linenos">133</span></a>        <span class="p">)</span>
</span><span id="GLMClassifier-134"><a href="#GLMClassifier-134"><span class="linenos">134</span></a>
</span><span id="GLMClassifier-135"><a href="#GLMClassifier-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">family</span> <span class="o">=</span> <span class="n">family</span>
</span><span id="GLMClassifier-136"><a href="#GLMClassifier-136"><span class="linenos">136</span></a>
</span><span id="GLMClassifier-137"><a href="#GLMClassifier-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">logit_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">row_index</span><span class="p">,</span> <span class="n">XB</span><span class="p">):</span>
</span><span id="GLMClassifier-138"><a href="#GLMClassifier-138"><span class="linenos">138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># len(np.unique(y))</span>
</span><span id="GLMClassifier-139"><a href="#GLMClassifier-139"><span class="linenos">139</span></a>        <span class="c1"># Y = mo.one_hot_encode2(y, self.n_classes)</span>
</span><span id="GLMClassifier-140"><a href="#GLMClassifier-140"><span class="linenos">140</span></a>        <span class="c1"># Y = self.optimizer.one_hot_encode(y, self.n_classes)</span>
</span><span id="GLMClassifier-141"><a href="#GLMClassifier-141"><span class="linenos">141</span></a>
</span><span id="GLMClassifier-142"><a href="#GLMClassifier-142"><span class="linenos">142</span></a>        <span class="c1"># max_double = 709.0 # only if softmax</span>
</span><span id="GLMClassifier-143"><a href="#GLMClassifier-143"><span class="linenos">143</span></a>        <span class="c1"># XB[XB &gt; max_double] = max_double</span>
</span><span id="GLMClassifier-144"><a href="#GLMClassifier-144"><span class="linenos">144</span></a>        <span class="n">XB</span><span class="p">[</span><span class="n">XB</span> <span class="o">&gt;</span> <span class="mf">709.0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">709.0</span>
</span><span id="GLMClassifier-145"><a href="#GLMClassifier-145"><span class="linenos">145</span></a>
</span><span id="GLMClassifier-146"><a href="#GLMClassifier-146"><span class="linenos">146</span></a>        <span class="k">if</span> <span class="n">row_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GLMClassifier-147"><a href="#GLMClassifier-147"><span class="linenos">147</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Y</span> <span class="o">*</span> <span class="n">XB</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">logsumexp</span><span class="p">(</span><span class="n">XB</span><span class="p">))</span>
</span><span id="GLMClassifier-148"><a href="#GLMClassifier-148"><span class="linenos">148</span></a>
</span><span id="GLMClassifier-149"><a href="#GLMClassifier-149"><span class="linenos">149</span></a>        <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">row_index</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">XB</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">logsumexp</span><span class="p">(</span><span class="n">XB</span><span class="p">))</span>
</span><span id="GLMClassifier-150"><a href="#GLMClassifier-150"><span class="linenos">150</span></a>
</span><span id="GLMClassifier-151"><a href="#GLMClassifier-151"><span class="linenos">151</span></a>    <span class="k">def</span> <span class="nf">expit_erf_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">row_index</span><span class="p">,</span> <span class="n">XB</span><span class="p">):</span>
</span><span id="GLMClassifier-152"><a href="#GLMClassifier-152"><span class="linenos">152</span></a>        <span class="c1"># self.n_classes = len(np.unique(y))</span>
</span><span id="GLMClassifier-153"><a href="#GLMClassifier-153"><span class="linenos">153</span></a>        <span class="c1"># Y = mo.one_hot_encode2(y, self.n_classes)</span>
</span><span id="GLMClassifier-154"><a href="#GLMClassifier-154"><span class="linenos">154</span></a>        <span class="c1"># Y = self.optimizer.one_hot_encode(y, self.n_classes)</span>
</span><span id="GLMClassifier-155"><a href="#GLMClassifier-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="GLMClassifier-156"><a href="#GLMClassifier-156"><span class="linenos">156</span></a>
</span><span id="GLMClassifier-157"><a href="#GLMClassifier-157"><span class="linenos">157</span></a>        <span class="k">if</span> <span class="n">row_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GLMClassifier-158"><a href="#GLMClassifier-158"><span class="linenos">158</span></a>            <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Y</span> <span class="o">*</span> <span class="n">XB</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">logsumexp</span><span class="p">(</span><span class="n">XB</span><span class="p">))</span>
</span><span id="GLMClassifier-159"><a href="#GLMClassifier-159"><span class="linenos">159</span></a>
</span><span id="GLMClassifier-160"><a href="#GLMClassifier-160"><span class="linenos">160</span></a>        <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">row_index</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">XB</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">logsumexp</span><span class="p">(</span><span class="n">XB</span><span class="p">))</span>
</span><span id="GLMClassifier-161"><a href="#GLMClassifier-161"><span class="linenos">161</span></a>
</span><span id="GLMClassifier-162"><a href="#GLMClassifier-162"><span class="linenos">162</span></a>    <span class="k">def</span> <span class="nf">loss_func</span><span class="p">(</span>
</span><span id="GLMClassifier-163"><a href="#GLMClassifier-163"><span class="linenos">163</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="GLMClassifier-164"><a href="#GLMClassifier-164"><span class="linenos">164</span></a>        <span class="n">beta</span><span class="p">,</span>
</span><span id="GLMClassifier-165"><a href="#GLMClassifier-165"><span class="linenos">165</span></a>        <span class="n">group_index</span><span class="p">,</span>
</span><span id="GLMClassifier-166"><a href="#GLMClassifier-166"><span class="linenos">166</span></a>        <span class="n">X</span><span class="p">,</span>
</span><span id="GLMClassifier-167"><a href="#GLMClassifier-167"><span class="linenos">167</span></a>        <span class="n">Y</span><span class="p">,</span>
</span><span id="GLMClassifier-168"><a href="#GLMClassifier-168"><span class="linenos">168</span></a>        <span class="n">y</span><span class="p">,</span>
</span><span id="GLMClassifier-169"><a href="#GLMClassifier-169"><span class="linenos">169</span></a>        <span class="n">row_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="GLMClassifier-170"><a href="#GLMClassifier-170"><span class="linenos">170</span></a>        <span class="n">type_loss</span><span class="o">=</span><span class="s2">&quot;logit&quot;</span><span class="p">,</span>
</span><span id="GLMClassifier-171"><a href="#GLMClassifier-171"><span class="linenos">171</span></a>        <span class="o">**</span><span class="n">kwargs</span>
</span><span id="GLMClassifier-172"><a href="#GLMClassifier-172"><span class="linenos">172</span></a>    <span class="p">):</span>
</span><span id="GLMClassifier-173"><a href="#GLMClassifier-173"><span class="linenos">173</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="GLMClassifier-174"><a href="#GLMClassifier-174"><span class="linenos">174</span></a>            <span class="s2">&quot;logit&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">logit_loss</span><span class="p">,</span>
</span><span id="GLMClassifier-175"><a href="#GLMClassifier-175"><span class="linenos">175</span></a>            <span class="s2">&quot;expit&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">expit_erf_loss</span><span class="p">,</span>
</span><span id="GLMClassifier-176"><a href="#GLMClassifier-176"><span class="linenos">176</span></a>            <span class="s2">&quot;erf&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">expit_erf_loss</span><span class="p">,</span>
</span><span id="GLMClassifier-177"><a href="#GLMClassifier-177"><span class="linenos">177</span></a>        <span class="p">}</span>
</span><span id="GLMClassifier-178"><a href="#GLMClassifier-178"><span class="linenos">178</span></a>
</span><span id="GLMClassifier-179"><a href="#GLMClassifier-179"><span class="linenos">179</span></a>        <span class="k">if</span> <span class="n">row_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GLMClassifier-180"><a href="#GLMClassifier-180"><span class="linenos">180</span></a>            <span class="n">row_index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="GLMClassifier-181"><a href="#GLMClassifier-181"><span class="linenos">181</span></a>            <span class="n">XB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_XB</span><span class="p">(</span>
</span><span id="GLMClassifier-182"><a href="#GLMClassifier-182"><span class="linenos">182</span></a>                <span class="n">X</span><span class="p">,</span>
</span><span id="GLMClassifier-183"><a href="#GLMClassifier-183"><span class="linenos">183</span></a>                <span class="n">beta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">),</span>
</span><span id="GLMClassifier-184"><a href="#GLMClassifier-184"><span class="linenos">184</span></a>            <span class="p">)</span>
</span><span id="GLMClassifier-185"><a href="#GLMClassifier-185"><span class="linenos">185</span></a>
</span><span id="GLMClassifier-186"><a href="#GLMClassifier-186"><span class="linenos">186</span></a>            <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="n">type_loss</span><span class="p">](</span><span class="n">Y</span><span class="p">,</span> <span class="n">row_index</span><span class="p">,</span> <span class="n">XB</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_penalty</span><span class="p">(</span>
</span><span id="GLMClassifier-187"><a href="#GLMClassifier-187"><span class="linenos">187</span></a>                <span class="n">group_index</span><span class="o">=</span><span class="n">group_index</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span>
</span><span id="GLMClassifier-188"><a href="#GLMClassifier-188"><span class="linenos">188</span></a>            <span class="p">)</span>
</span><span id="GLMClassifier-189"><a href="#GLMClassifier-189"><span class="linenos">189</span></a>
</span><span id="GLMClassifier-190"><a href="#GLMClassifier-190"><span class="linenos">190</span></a>        <span class="n">XB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_XB</span><span class="p">(</span>
</span><span id="GLMClassifier-191"><a href="#GLMClassifier-191"><span class="linenos">191</span></a>            <span class="n">X</span><span class="p">,</span>
</span><span id="GLMClassifier-192"><a href="#GLMClassifier-192"><span class="linenos">192</span></a>            <span class="n">beta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">),</span>
</span><span id="GLMClassifier-193"><a href="#GLMClassifier-193"><span class="linenos">193</span></a>            <span class="n">row_index</span><span class="o">=</span><span class="n">row_index</span><span class="p">,</span>
</span><span id="GLMClassifier-194"><a href="#GLMClassifier-194"><span class="linenos">194</span></a>        <span class="p">)</span>
</span><span id="GLMClassifier-195"><a href="#GLMClassifier-195"><span class="linenos">195</span></a>
</span><span id="GLMClassifier-196"><a href="#GLMClassifier-196"><span class="linenos">196</span></a>        <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="n">type_loss</span><span class="p">](</span><span class="n">Y</span><span class="p">,</span> <span class="n">row_index</span><span class="p">,</span> <span class="n">XB</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_penalty</span><span class="p">(</span>
</span><span id="GLMClassifier-197"><a href="#GLMClassifier-197"><span class="linenos">197</span></a>            <span class="n">group_index</span><span class="o">=</span><span class="n">group_index</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span>
</span><span id="GLMClassifier-198"><a href="#GLMClassifier-198"><span class="linenos">198</span></a>        <span class="p">)</span>
</span><span id="GLMClassifier-199"><a href="#GLMClassifier-199"><span class="linenos">199</span></a>
</span><span id="GLMClassifier-200"><a href="#GLMClassifier-200"><span class="linenos">200</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GLMClassifier-201"><a href="#GLMClassifier-201"><span class="linenos">201</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit GLM model to training data (X, y).</span>
</span><span id="GLMClassifier-202"><a href="#GLMClassifier-202"><span class="linenos">202</span></a>
</span><span id="GLMClassifier-203"><a href="#GLMClassifier-203"><span class="linenos">203</span></a><span class="sd">        Args:</span>
</span><span id="GLMClassifier-204"><a href="#GLMClassifier-204"><span class="linenos">204</span></a>
</span><span id="GLMClassifier-205"><a href="#GLMClassifier-205"><span class="linenos">205</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="GLMClassifier-206"><a href="#GLMClassifier-206"><span class="linenos">206</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="GLMClassifier-207"><a href="#GLMClassifier-207"><span class="linenos">207</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="GLMClassifier-208"><a href="#GLMClassifier-208"><span class="linenos">208</span></a>
</span><span id="GLMClassifier-209"><a href="#GLMClassifier-209"><span class="linenos">209</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="GLMClassifier-210"><a href="#GLMClassifier-210"><span class="linenos">210</span></a><span class="sd">                Target values.</span>
</span><span id="GLMClassifier-211"><a href="#GLMClassifier-211"><span class="linenos">211</span></a>
</span><span id="GLMClassifier-212"><a href="#GLMClassifier-212"><span class="linenos">212</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="GLMClassifier-213"><a href="#GLMClassifier-213"><span class="linenos">213</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="GLMClassifier-214"><a href="#GLMClassifier-214"><span class="linenos">214</span></a>
</span><span id="GLMClassifier-215"><a href="#GLMClassifier-215"><span class="linenos">215</span></a><span class="sd">        Returns:</span>
</span><span id="GLMClassifier-216"><a href="#GLMClassifier-216"><span class="linenos">216</span></a>
</span><span id="GLMClassifier-217"><a href="#GLMClassifier-217"><span class="linenos">217</span></a><span class="sd">            self: object</span>
</span><span id="GLMClassifier-218"><a href="#GLMClassifier-218"><span class="linenos">218</span></a>
</span><span id="GLMClassifier-219"><a href="#GLMClassifier-219"><span class="linenos">219</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GLMClassifier-220"><a href="#GLMClassifier-220"><span class="linenos">220</span></a>
</span><span id="GLMClassifier-221"><a href="#GLMClassifier-221"><span class="linenos">221</span></a>        <span class="k">assert</span> <span class="n">mx</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span>
</span><span id="GLMClassifier-222"><a href="#GLMClassifier-222"><span class="linenos">222</span></a>            <span class="n">y</span>
</span><span id="GLMClassifier-223"><a href="#GLMClassifier-223"><span class="linenos">223</span></a>        <span class="p">),</span> <span class="s2">&quot;y must contain only integers&quot;</span>  <span class="c1"># change is_factor and subsampling everywhere</span>
</span><span id="GLMClassifier-224"><a href="#GLMClassifier-224"><span class="linenos">224</span></a>
</span><span id="GLMClassifier-225"><a href="#GLMClassifier-225"><span class="linenos">225</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="GLMClassifier-226"><a href="#GLMClassifier-226"><span class="linenos">226</span></a>
</span><span id="GLMClassifier-227"><a href="#GLMClassifier-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="GLMClassifier-228"><a href="#GLMClassifier-228"><span class="linenos">228</span></a>
</span><span id="GLMClassifier-229"><a href="#GLMClassifier-229"><span class="linenos">229</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="GLMClassifier-230"><a href="#GLMClassifier-230"><span class="linenos">230</span></a>
</span><span id="GLMClassifier-231"><a href="#GLMClassifier-231"><span class="linenos">231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">group_index</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="GLMClassifier-232"><a href="#GLMClassifier-232"><span class="linenos">232</span></a>
</span><span id="GLMClassifier-233"><a href="#GLMClassifier-233"><span class="linenos">233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="GLMClassifier-234"><a href="#GLMClassifier-234"><span class="linenos">234</span></a>
</span><span id="GLMClassifier-235"><a href="#GLMClassifier-235"><span class="linenos">235</span></a>        <span class="n">output_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GLMClassifier-236"><a href="#GLMClassifier-236"><span class="linenos">236</span></a>
</span><span id="GLMClassifier-237"><a href="#GLMClassifier-237"><span class="linenos">237</span></a>        <span class="c1"># Y = mo.one_hot_encode2(output_y, self.n_classes)</span>
</span><span id="GLMClassifier-238"><a href="#GLMClassifier-238"><span class="linenos">238</span></a>        <span class="n">Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">one_hot_encode</span><span class="p">(</span><span class="n">output_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">)</span>
</span><span id="GLMClassifier-239"><a href="#GLMClassifier-239"><span class="linenos">239</span></a>
</span><span id="GLMClassifier-240"><a href="#GLMClassifier-240"><span class="linenos">240</span></a>        <span class="c1"># initialization</span>
</span><span id="GLMClassifier-241"><a href="#GLMClassifier-241"><span class="linenos">241</span></a>        <span class="n">beta_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GLMClassifier-242"><a href="#GLMClassifier-242"><span class="linenos">242</span></a>
</span><span id="GLMClassifier-243"><a href="#GLMClassifier-243"><span class="linenos">243</span></a>        <span class="c1"># optimization</span>
</span><span id="GLMClassifier-244"><a href="#GLMClassifier-244"><span class="linenos">244</span></a>        <span class="c1"># fit(self, loss_func, response, x0, **kwargs):</span>
</span><span id="GLMClassifier-245"><a href="#GLMClassifier-245"><span class="linenos">245</span></a>        <span class="c1"># loss_func(self, beta, group_index, X, y,</span>
</span><span id="GLMClassifier-246"><a href="#GLMClassifier-246"><span class="linenos">246</span></a>        <span class="c1">#          row_index=None, type_loss=&quot;gaussian&quot;,</span>
</span><span id="GLMClassifier-247"><a href="#GLMClassifier-247"><span class="linenos">247</span></a>        <span class="c1">#          **kwargs)</span>
</span><span id="GLMClassifier-248"><a href="#GLMClassifier-248"><span class="linenos">248</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="GLMClassifier-249"><a href="#GLMClassifier-249"><span class="linenos">249</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">loss_func</span><span class="p">,</span>
</span><span id="GLMClassifier-250"><a href="#GLMClassifier-250"><span class="linenos">250</span></a>            <span class="n">response</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
</span><span id="GLMClassifier-251"><a href="#GLMClassifier-251"><span class="linenos">251</span></a>            <span class="n">x0</span><span class="o">=</span><span class="n">beta_</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">),</span>
</span><span id="GLMClassifier-252"><a href="#GLMClassifier-252"><span class="linenos">252</span></a>            <span class="n">group_index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">group_index</span><span class="p">,</span>
</span><span id="GLMClassifier-253"><a href="#GLMClassifier-253"><span class="linenos">253</span></a>            <span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span>
</span><span id="GLMClassifier-254"><a href="#GLMClassifier-254"><span class="linenos">254</span></a>            <span class="n">Y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
</span><span id="GLMClassifier-255"><a href="#GLMClassifier-255"><span class="linenos">255</span></a>            <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
</span><span id="GLMClassifier-256"><a href="#GLMClassifier-256"><span class="linenos">256</span></a>            <span class="n">type_loss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">family</span><span class="p">,</span>
</span><span id="GLMClassifier-257"><a href="#GLMClassifier-257"><span class="linenos">257</span></a>        <span class="p">)</span>
</span><span id="GLMClassifier-258"><a href="#GLMClassifier-258"><span class="linenos">258</span></a>
</span><span id="GLMClassifier-259"><a href="#GLMClassifier-259"><span class="linenos">259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GLMClassifier-260"><a href="#GLMClassifier-260"><span class="linenos">260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="GLMClassifier-261"><a href="#GLMClassifier-261"><span class="linenos">261</span></a>
</span><span id="GLMClassifier-262"><a href="#GLMClassifier-262"><span class="linenos">262</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="GLMClassifier-263"><a href="#GLMClassifier-263"><span class="linenos">263</span></a>
</span><span id="GLMClassifier-264"><a href="#GLMClassifier-264"><span class="linenos">264</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GLMClassifier-265"><a href="#GLMClassifier-265"><span class="linenos">265</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="GLMClassifier-266"><a href="#GLMClassifier-266"><span class="linenos">266</span></a>
</span><span id="GLMClassifier-267"><a href="#GLMClassifier-267"><span class="linenos">267</span></a><span class="sd">        Args:</span>
</span><span id="GLMClassifier-268"><a href="#GLMClassifier-268"><span class="linenos">268</span></a>
</span><span id="GLMClassifier-269"><a href="#GLMClassifier-269"><span class="linenos">269</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="GLMClassifier-270"><a href="#GLMClassifier-270"><span class="linenos">270</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="GLMClassifier-271"><a href="#GLMClassifier-271"><span class="linenos">271</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="GLMClassifier-272"><a href="#GLMClassifier-272"><span class="linenos">272</span></a>
</span><span id="GLMClassifier-273"><a href="#GLMClassifier-273"><span class="linenos">273</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="GLMClassifier-274"><a href="#GLMClassifier-274"><span class="linenos">274</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="GLMClassifier-275"><a href="#GLMClassifier-275"><span class="linenos">275</span></a>
</span><span id="GLMClassifier-276"><a href="#GLMClassifier-276"><span class="linenos">276</span></a><span class="sd">        Returns:</span>
</span><span id="GLMClassifier-277"><a href="#GLMClassifier-277"><span class="linenos">277</span></a>
</span><span id="GLMClassifier-278"><a href="#GLMClassifier-278"><span class="linenos">278</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="GLMClassifier-279"><a href="#GLMClassifier-279"><span class="linenos">279</span></a>
</span><span id="GLMClassifier-280"><a href="#GLMClassifier-280"><span class="linenos">280</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GLMClassifier-281"><a href="#GLMClassifier-281"><span class="linenos">281</span></a>
</span><span id="GLMClassifier-282"><a href="#GLMClassifier-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="GLMClassifier-283"><a href="#GLMClassifier-283"><span class="linenos">283</span></a>
</span><span id="GLMClassifier-284"><a href="#GLMClassifier-284"><span class="linenos">284</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GLMClassifier-285"><a href="#GLMClassifier-285"><span class="linenos">285</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probabilities for test data X.</span>
</span><span id="GLMClassifier-286"><a href="#GLMClassifier-286"><span class="linenos">286</span></a>
</span><span id="GLMClassifier-287"><a href="#GLMClassifier-287"><span class="linenos">287</span></a><span class="sd">        Args:</span>
</span><span id="GLMClassifier-288"><a href="#GLMClassifier-288"><span class="linenos">288</span></a>
</span><span id="GLMClassifier-289"><a href="#GLMClassifier-289"><span class="linenos">289</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="GLMClassifier-290"><a href="#GLMClassifier-290"><span class="linenos">290</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="GLMClassifier-291"><a href="#GLMClassifier-291"><span class="linenos">291</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="GLMClassifier-292"><a href="#GLMClassifier-292"><span class="linenos">292</span></a>
</span><span id="GLMClassifier-293"><a href="#GLMClassifier-293"><span class="linenos">293</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="GLMClassifier-294"><a href="#GLMClassifier-294"><span class="linenos">294</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="GLMClassifier-295"><a href="#GLMClassifier-295"><span class="linenos">295</span></a>
</span><span id="GLMClassifier-296"><a href="#GLMClassifier-296"><span class="linenos">296</span></a><span class="sd">        Returns:</span>
</span><span id="GLMClassifier-297"><a href="#GLMClassifier-297"><span class="linenos">297</span></a>
</span><span id="GLMClassifier-298"><a href="#GLMClassifier-298"><span class="linenos">298</span></a><span class="sd">            probability estimates for test data: {array-like}</span>
</span><span id="GLMClassifier-299"><a href="#GLMClassifier-299"><span class="linenos">299</span></a>
</span><span id="GLMClassifier-300"><a href="#GLMClassifier-300"><span class="linenos">300</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GLMClassifier-301"><a href="#GLMClassifier-301"><span class="linenos">301</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="GLMClassifier-302"><a href="#GLMClassifier-302"><span class="linenos">302</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GLMClassifier-303"><a href="#GLMClassifier-303"><span class="linenos">303</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="GLMClassifier-304"><a href="#GLMClassifier-304"><span class="linenos">304</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="GLMClassifier-305"><a href="#GLMClassifier-305"><span class="linenos">305</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="GLMClassifier-306"><a href="#GLMClassifier-306"><span class="linenos">306</span></a>            <span class="p">)</span>
</span><span id="GLMClassifier-307"><a href="#GLMClassifier-307"><span class="linenos">307</span></a>
</span><span id="GLMClassifier-308"><a href="#GLMClassifier-308"><span class="linenos">308</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GLMClassifier-309"><a href="#GLMClassifier-309"><span class="linenos">309</span></a>
</span><span id="GLMClassifier-310"><a href="#GLMClassifier-310"><span class="linenos">310</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="GLMClassifier-311"><a href="#GLMClassifier-311"><span class="linenos">311</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GLMClassifier-312"><a href="#GLMClassifier-312"><span class="linenos">312</span></a>
</span><span id="GLMClassifier-313"><a href="#GLMClassifier-313"><span class="linenos">313</span></a>        <span class="n">ZB</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="GLMClassifier-314"><a href="#GLMClassifier-314"><span class="linenos">314</span></a>            <span class="n">Z</span><span class="p">,</span>
</span><span id="GLMClassifier-315"><a href="#GLMClassifier-315"><span class="linenos">315</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="GLMClassifier-316"><a href="#GLMClassifier-316"><span class="linenos">316</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">,</span>
</span><span id="GLMClassifier-317"><a href="#GLMClassifier-317"><span class="linenos">317</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="GLMClassifier-318"><a href="#GLMClassifier-318"><span class="linenos">318</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="GLMClassifier-319"><a href="#GLMClassifier-319"><span class="linenos">319</span></a>        <span class="p">)</span>
</span><span id="GLMClassifier-320"><a href="#GLMClassifier-320"><span class="linenos">320</span></a>
</span><span id="GLMClassifier-321"><a href="#GLMClassifier-321"><span class="linenos">321</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">family</span> <span class="o">==</span> <span class="s2">&quot;logit&quot;</span><span class="p">:</span>
</span><span id="GLMClassifier-322"><a href="#GLMClassifier-322"><span class="linenos">322</span></a>            <span class="n">exp_ZB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ZB</span><span class="p">)</span>
</span><span id="GLMClassifier-323"><a href="#GLMClassifier-323"><span class="linenos">323</span></a>
</span><span id="GLMClassifier-324"><a href="#GLMClassifier-324"><span class="linenos">324</span></a>            <span class="k">return</span> <span class="n">exp_ZB</span> <span class="o">/</span> <span class="n">exp_ZB</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="GLMClassifier-325"><a href="#GLMClassifier-325"><span class="linenos">325</span></a>
</span><span id="GLMClassifier-326"><a href="#GLMClassifier-326"><span class="linenos">326</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">family</span> <span class="o">==</span> <span class="s2">&quot;expit&quot;</span><span class="p">:</span>
</span><span id="GLMClassifier-327"><a href="#GLMClassifier-327"><span class="linenos">327</span></a>            <span class="n">exp_ZB</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">ZB</span><span class="p">)</span>
</span><span id="GLMClassifier-328"><a href="#GLMClassifier-328"><span class="linenos">328</span></a>
</span><span id="GLMClassifier-329"><a href="#GLMClassifier-329"><span class="linenos">329</span></a>            <span class="k">return</span> <span class="n">exp_ZB</span> <span class="o">/</span> <span class="n">exp_ZB</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="GLMClassifier-330"><a href="#GLMClassifier-330"><span class="linenos">330</span></a>
</span><span id="GLMClassifier-331"><a href="#GLMClassifier-331"><span class="linenos">331</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">family</span> <span class="o">==</span> <span class="s2">&quot;erf&quot;</span><span class="p">:</span>
</span><span id="GLMClassifier-332"><a href="#GLMClassifier-332"><span class="linenos">332</span></a>            <span class="n">exp_ZB</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">erf</span><span class="p">(</span><span class="n">ZB</span><span class="p">))</span>
</span><span id="GLMClassifier-333"><a href="#GLMClassifier-333"><span class="linenos">333</span></a>
</span><span id="GLMClassifier-334"><a href="#GLMClassifier-334"><span class="linenos">334</span></a>            <span class="k">return</span> <span class="n">exp_ZB</span> <span class="o">/</span> <span class="n">exp_ZB</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Generalized 'linear' models using quasi-randomized networks (classification)</p>

<p>Parameters:</p>

<pre><code>n_hidden_features: int
    number of nodes in the hidden layer

lambda1: float
    regularization parameter for GLM coefficients on original features

alpha1: float
    controls compromize between l1 and l2 norm of GLM coefficients on original features

lambda2: float
    regularization parameter for GLM coefficients on nonlinear features

alpha2: float
    controls compromize between l1 and l2 norm of GLM coefficients on nonlinear features

activation_name: str
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'

a: float
    hyperparameter for 'prelu' or 'elu' activation function

nodes_sim: str
    type of simulation for the nodes: 'sobol', 'hammersley', 'halton',
    'uniform'

bias: boolean
    indicates if the hidden layer contains a bias term (True) or not
    (False)

dropout: float
    regularization parameter; (random) percentage of nodes dropped out
    of the training

direct_link: boolean
    indicates if the original predictors are included (True) in model's
    fitting or not (False)

n_clusters: int
    number of clusters for 'kmeans' or 'gmm' clustering (could be 0:
        no clustering)

cluster_encode: bool
    defines how the variable containing clusters is treated (default is one-hot)
    if `False`, then labels are used, without one-hot encoding

type_clust: str
    type of clustering method: currently k-means ('kmeans') or Gaussian
    Mixture Model ('gmm')

type_scaling: a tuple of 3 strings
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax')

optimizer: object
    optimizer, from class <a href="#Optimizer">nnetsauce.Optimizer</a>

seed: int
    reproducibility seed for nodes_sim=='uniform'
</code></pre>

<p>Attributes:</p>

<pre><code>beta_: vector
    regression coefficients
</code></pre>

<p>Examples:</p>

<p>See <a href="https://github.com/Techtonique/nnetsauce/blob/master/examples/glm_classification.py">https://github.com/Techtonique/nnetsauce/blob/master/examples/glm_classification.py</a></p>
</div>


                                <div id="GLMClassifier.fit" class="classattr">
                                            <input id="GLMClassifier.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GLMClassifier.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GLMClassifier.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GLMClassifier.fit-200"><a href="#GLMClassifier.fit-200"><span class="linenos">200</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GLMClassifier.fit-201"><a href="#GLMClassifier.fit-201"><span class="linenos">201</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit GLM model to training data (X, y).</span>
</span><span id="GLMClassifier.fit-202"><a href="#GLMClassifier.fit-202"><span class="linenos">202</span></a>
</span><span id="GLMClassifier.fit-203"><a href="#GLMClassifier.fit-203"><span class="linenos">203</span></a><span class="sd">        Args:</span>
</span><span id="GLMClassifier.fit-204"><a href="#GLMClassifier.fit-204"><span class="linenos">204</span></a>
</span><span id="GLMClassifier.fit-205"><a href="#GLMClassifier.fit-205"><span class="linenos">205</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="GLMClassifier.fit-206"><a href="#GLMClassifier.fit-206"><span class="linenos">206</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="GLMClassifier.fit-207"><a href="#GLMClassifier.fit-207"><span class="linenos">207</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="GLMClassifier.fit-208"><a href="#GLMClassifier.fit-208"><span class="linenos">208</span></a>
</span><span id="GLMClassifier.fit-209"><a href="#GLMClassifier.fit-209"><span class="linenos">209</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="GLMClassifier.fit-210"><a href="#GLMClassifier.fit-210"><span class="linenos">210</span></a><span class="sd">                Target values.</span>
</span><span id="GLMClassifier.fit-211"><a href="#GLMClassifier.fit-211"><span class="linenos">211</span></a>
</span><span id="GLMClassifier.fit-212"><a href="#GLMClassifier.fit-212"><span class="linenos">212</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="GLMClassifier.fit-213"><a href="#GLMClassifier.fit-213"><span class="linenos">213</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="GLMClassifier.fit-214"><a href="#GLMClassifier.fit-214"><span class="linenos">214</span></a>
</span><span id="GLMClassifier.fit-215"><a href="#GLMClassifier.fit-215"><span class="linenos">215</span></a><span class="sd">        Returns:</span>
</span><span id="GLMClassifier.fit-216"><a href="#GLMClassifier.fit-216"><span class="linenos">216</span></a>
</span><span id="GLMClassifier.fit-217"><a href="#GLMClassifier.fit-217"><span class="linenos">217</span></a><span class="sd">            self: object</span>
</span><span id="GLMClassifier.fit-218"><a href="#GLMClassifier.fit-218"><span class="linenos">218</span></a>
</span><span id="GLMClassifier.fit-219"><a href="#GLMClassifier.fit-219"><span class="linenos">219</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GLMClassifier.fit-220"><a href="#GLMClassifier.fit-220"><span class="linenos">220</span></a>
</span><span id="GLMClassifier.fit-221"><a href="#GLMClassifier.fit-221"><span class="linenos">221</span></a>        <span class="k">assert</span> <span class="n">mx</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span>
</span><span id="GLMClassifier.fit-222"><a href="#GLMClassifier.fit-222"><span class="linenos">222</span></a>            <span class="n">y</span>
</span><span id="GLMClassifier.fit-223"><a href="#GLMClassifier.fit-223"><span class="linenos">223</span></a>        <span class="p">),</span> <span class="s2">&quot;y must contain only integers&quot;</span>  <span class="c1"># change is_factor and subsampling everywhere</span>
</span><span id="GLMClassifier.fit-224"><a href="#GLMClassifier.fit-224"><span class="linenos">224</span></a>
</span><span id="GLMClassifier.fit-225"><a href="#GLMClassifier.fit-225"><span class="linenos">225</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="GLMClassifier.fit-226"><a href="#GLMClassifier.fit-226"><span class="linenos">226</span></a>
</span><span id="GLMClassifier.fit-227"><a href="#GLMClassifier.fit-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="GLMClassifier.fit-228"><a href="#GLMClassifier.fit-228"><span class="linenos">228</span></a>
</span><span id="GLMClassifier.fit-229"><a href="#GLMClassifier.fit-229"><span class="linenos">229</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="GLMClassifier.fit-230"><a href="#GLMClassifier.fit-230"><span class="linenos">230</span></a>
</span><span id="GLMClassifier.fit-231"><a href="#GLMClassifier.fit-231"><span class="linenos">231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">group_index</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="GLMClassifier.fit-232"><a href="#GLMClassifier.fit-232"><span class="linenos">232</span></a>
</span><span id="GLMClassifier.fit-233"><a href="#GLMClassifier.fit-233"><span class="linenos">233</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="GLMClassifier.fit-234"><a href="#GLMClassifier.fit-234"><span class="linenos">234</span></a>
</span><span id="GLMClassifier.fit-235"><a href="#GLMClassifier.fit-235"><span class="linenos">235</span></a>        <span class="n">output_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GLMClassifier.fit-236"><a href="#GLMClassifier.fit-236"><span class="linenos">236</span></a>
</span><span id="GLMClassifier.fit-237"><a href="#GLMClassifier.fit-237"><span class="linenos">237</span></a>        <span class="c1"># Y = mo.one_hot_encode2(output_y, self.n_classes)</span>
</span><span id="GLMClassifier.fit-238"><a href="#GLMClassifier.fit-238"><span class="linenos">238</span></a>        <span class="n">Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">one_hot_encode</span><span class="p">(</span><span class="n">output_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">)</span>
</span><span id="GLMClassifier.fit-239"><a href="#GLMClassifier.fit-239"><span class="linenos">239</span></a>
</span><span id="GLMClassifier.fit-240"><a href="#GLMClassifier.fit-240"><span class="linenos">240</span></a>        <span class="c1"># initialization</span>
</span><span id="GLMClassifier.fit-241"><a href="#GLMClassifier.fit-241"><span class="linenos">241</span></a>        <span class="n">beta_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GLMClassifier.fit-242"><a href="#GLMClassifier.fit-242"><span class="linenos">242</span></a>
</span><span id="GLMClassifier.fit-243"><a href="#GLMClassifier.fit-243"><span class="linenos">243</span></a>        <span class="c1"># optimization</span>
</span><span id="GLMClassifier.fit-244"><a href="#GLMClassifier.fit-244"><span class="linenos">244</span></a>        <span class="c1"># fit(self, loss_func, response, x0, **kwargs):</span>
</span><span id="GLMClassifier.fit-245"><a href="#GLMClassifier.fit-245"><span class="linenos">245</span></a>        <span class="c1"># loss_func(self, beta, group_index, X, y,</span>
</span><span id="GLMClassifier.fit-246"><a href="#GLMClassifier.fit-246"><span class="linenos">246</span></a>        <span class="c1">#          row_index=None, type_loss=&quot;gaussian&quot;,</span>
</span><span id="GLMClassifier.fit-247"><a href="#GLMClassifier.fit-247"><span class="linenos">247</span></a>        <span class="c1">#          **kwargs)</span>
</span><span id="GLMClassifier.fit-248"><a href="#GLMClassifier.fit-248"><span class="linenos">248</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="GLMClassifier.fit-249"><a href="#GLMClassifier.fit-249"><span class="linenos">249</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">loss_func</span><span class="p">,</span>
</span><span id="GLMClassifier.fit-250"><a href="#GLMClassifier.fit-250"><span class="linenos">250</span></a>            <span class="n">response</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
</span><span id="GLMClassifier.fit-251"><a href="#GLMClassifier.fit-251"><span class="linenos">251</span></a>            <span class="n">x0</span><span class="o">=</span><span class="n">beta_</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">),</span>
</span><span id="GLMClassifier.fit-252"><a href="#GLMClassifier.fit-252"><span class="linenos">252</span></a>            <span class="n">group_index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">group_index</span><span class="p">,</span>
</span><span id="GLMClassifier.fit-253"><a href="#GLMClassifier.fit-253"><span class="linenos">253</span></a>            <span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span>
</span><span id="GLMClassifier.fit-254"><a href="#GLMClassifier.fit-254"><span class="linenos">254</span></a>            <span class="n">Y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
</span><span id="GLMClassifier.fit-255"><a href="#GLMClassifier.fit-255"><span class="linenos">255</span></a>            <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
</span><span id="GLMClassifier.fit-256"><a href="#GLMClassifier.fit-256"><span class="linenos">256</span></a>            <span class="n">type_loss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">family</span><span class="p">,</span>
</span><span id="GLMClassifier.fit-257"><a href="#GLMClassifier.fit-257"><span class="linenos">257</span></a>        <span class="p">)</span>
</span><span id="GLMClassifier.fit-258"><a href="#GLMClassifier.fit-258"><span class="linenos">258</span></a>
</span><span id="GLMClassifier.fit-259"><a href="#GLMClassifier.fit-259"><span class="linenos">259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GLMClassifier.fit-260"><a href="#GLMClassifier.fit-260"><span class="linenos">260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="GLMClassifier.fit-261"><a href="#GLMClassifier.fit-261"><span class="linenos">261</span></a>
</span><span id="GLMClassifier.fit-262"><a href="#GLMClassifier.fit-262"><span class="linenos">262</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit GLM model to training data (X, y).</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

y: array-like, shape = [n_samples]
    Target values.

**kwargs: additional parameters to be passed to
        self.cook_training_set or self.obj.fit
</code></pre>

<p>Returns:</p>

<pre><code>self: object
</code></pre>
</div>


                                </div>
                                <div id="GLMClassifier.predict" class="classattr">
                                            <input id="GLMClassifier.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GLMClassifier.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GLMClassifier.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GLMClassifier.predict-264"><a href="#GLMClassifier.predict-264"><span class="linenos">264</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GLMClassifier.predict-265"><a href="#GLMClassifier.predict-265"><span class="linenos">265</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="GLMClassifier.predict-266"><a href="#GLMClassifier.predict-266"><span class="linenos">266</span></a>
</span><span id="GLMClassifier.predict-267"><a href="#GLMClassifier.predict-267"><span class="linenos">267</span></a><span class="sd">        Args:</span>
</span><span id="GLMClassifier.predict-268"><a href="#GLMClassifier.predict-268"><span class="linenos">268</span></a>
</span><span id="GLMClassifier.predict-269"><a href="#GLMClassifier.predict-269"><span class="linenos">269</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="GLMClassifier.predict-270"><a href="#GLMClassifier.predict-270"><span class="linenos">270</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="GLMClassifier.predict-271"><a href="#GLMClassifier.predict-271"><span class="linenos">271</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="GLMClassifier.predict-272"><a href="#GLMClassifier.predict-272"><span class="linenos">272</span></a>
</span><span id="GLMClassifier.predict-273"><a href="#GLMClassifier.predict-273"><span class="linenos">273</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="GLMClassifier.predict-274"><a href="#GLMClassifier.predict-274"><span class="linenos">274</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="GLMClassifier.predict-275"><a href="#GLMClassifier.predict-275"><span class="linenos">275</span></a>
</span><span id="GLMClassifier.predict-276"><a href="#GLMClassifier.predict-276"><span class="linenos">276</span></a><span class="sd">        Returns:</span>
</span><span id="GLMClassifier.predict-277"><a href="#GLMClassifier.predict-277"><span class="linenos">277</span></a>
</span><span id="GLMClassifier.predict-278"><a href="#GLMClassifier.predict-278"><span class="linenos">278</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="GLMClassifier.predict-279"><a href="#GLMClassifier.predict-279"><span class="linenos">279</span></a>
</span><span id="GLMClassifier.predict-280"><a href="#GLMClassifier.predict-280"><span class="linenos">280</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GLMClassifier.predict-281"><a href="#GLMClassifier.predict-281"><span class="linenos">281</span></a>
</span><span id="GLMClassifier.predict-282"><a href="#GLMClassifier.predict-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>model predictions: {array-like}
</code></pre>
</div>


                                </div>
                                <div id="GLMClassifier.predict_proba" class="classattr">
                                            <input id="GLMClassifier.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GLMClassifier.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GLMClassifier.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GLMClassifier.predict_proba-284"><a href="#GLMClassifier.predict_proba-284"><span class="linenos">284</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GLMClassifier.predict_proba-285"><a href="#GLMClassifier.predict_proba-285"><span class="linenos">285</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probabilities for test data X.</span>
</span><span id="GLMClassifier.predict_proba-286"><a href="#GLMClassifier.predict_proba-286"><span class="linenos">286</span></a>
</span><span id="GLMClassifier.predict_proba-287"><a href="#GLMClassifier.predict_proba-287"><span class="linenos">287</span></a><span class="sd">        Args:</span>
</span><span id="GLMClassifier.predict_proba-288"><a href="#GLMClassifier.predict_proba-288"><span class="linenos">288</span></a>
</span><span id="GLMClassifier.predict_proba-289"><a href="#GLMClassifier.predict_proba-289"><span class="linenos">289</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="GLMClassifier.predict_proba-290"><a href="#GLMClassifier.predict_proba-290"><span class="linenos">290</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="GLMClassifier.predict_proba-291"><a href="#GLMClassifier.predict_proba-291"><span class="linenos">291</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="GLMClassifier.predict_proba-292"><a href="#GLMClassifier.predict_proba-292"><span class="linenos">292</span></a>
</span><span id="GLMClassifier.predict_proba-293"><a href="#GLMClassifier.predict_proba-293"><span class="linenos">293</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="GLMClassifier.predict_proba-294"><a href="#GLMClassifier.predict_proba-294"><span class="linenos">294</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="GLMClassifier.predict_proba-295"><a href="#GLMClassifier.predict_proba-295"><span class="linenos">295</span></a>
</span><span id="GLMClassifier.predict_proba-296"><a href="#GLMClassifier.predict_proba-296"><span class="linenos">296</span></a><span class="sd">        Returns:</span>
</span><span id="GLMClassifier.predict_proba-297"><a href="#GLMClassifier.predict_proba-297"><span class="linenos">297</span></a>
</span><span id="GLMClassifier.predict_proba-298"><a href="#GLMClassifier.predict_proba-298"><span class="linenos">298</span></a><span class="sd">            probability estimates for test data: {array-like}</span>
</span><span id="GLMClassifier.predict_proba-299"><a href="#GLMClassifier.predict_proba-299"><span class="linenos">299</span></a>
</span><span id="GLMClassifier.predict_proba-300"><a href="#GLMClassifier.predict_proba-300"><span class="linenos">300</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GLMClassifier.predict_proba-301"><a href="#GLMClassifier.predict_proba-301"><span class="linenos">301</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="GLMClassifier.predict_proba-302"><a href="#GLMClassifier.predict_proba-302"><span class="linenos">302</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GLMClassifier.predict_proba-303"><a href="#GLMClassifier.predict_proba-303"><span class="linenos">303</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="GLMClassifier.predict_proba-304"><a href="#GLMClassifier.predict_proba-304"><span class="linenos">304</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="GLMClassifier.predict_proba-305"><a href="#GLMClassifier.predict_proba-305"><span class="linenos">305</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="GLMClassifier.predict_proba-306"><a href="#GLMClassifier.predict_proba-306"><span class="linenos">306</span></a>            <span class="p">)</span>
</span><span id="GLMClassifier.predict_proba-307"><a href="#GLMClassifier.predict_proba-307"><span class="linenos">307</span></a>
</span><span id="GLMClassifier.predict_proba-308"><a href="#GLMClassifier.predict_proba-308"><span class="linenos">308</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GLMClassifier.predict_proba-309"><a href="#GLMClassifier.predict_proba-309"><span class="linenos">309</span></a>
</span><span id="GLMClassifier.predict_proba-310"><a href="#GLMClassifier.predict_proba-310"><span class="linenos">310</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="GLMClassifier.predict_proba-311"><a href="#GLMClassifier.predict_proba-311"><span class="linenos">311</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GLMClassifier.predict_proba-312"><a href="#GLMClassifier.predict_proba-312"><span class="linenos">312</span></a>
</span><span id="GLMClassifier.predict_proba-313"><a href="#GLMClassifier.predict_proba-313"><span class="linenos">313</span></a>        <span class="n">ZB</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="GLMClassifier.predict_proba-314"><a href="#GLMClassifier.predict_proba-314"><span class="linenos">314</span></a>            <span class="n">Z</span><span class="p">,</span>
</span><span id="GLMClassifier.predict_proba-315"><a href="#GLMClassifier.predict_proba-315"><span class="linenos">315</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="GLMClassifier.predict_proba-316"><a href="#GLMClassifier.predict_proba-316"><span class="linenos">316</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">,</span>
</span><span id="GLMClassifier.predict_proba-317"><a href="#GLMClassifier.predict_proba-317"><span class="linenos">317</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="GLMClassifier.predict_proba-318"><a href="#GLMClassifier.predict_proba-318"><span class="linenos">318</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="GLMClassifier.predict_proba-319"><a href="#GLMClassifier.predict_proba-319"><span class="linenos">319</span></a>        <span class="p">)</span>
</span><span id="GLMClassifier.predict_proba-320"><a href="#GLMClassifier.predict_proba-320"><span class="linenos">320</span></a>
</span><span id="GLMClassifier.predict_proba-321"><a href="#GLMClassifier.predict_proba-321"><span class="linenos">321</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">family</span> <span class="o">==</span> <span class="s2">&quot;logit&quot;</span><span class="p">:</span>
</span><span id="GLMClassifier.predict_proba-322"><a href="#GLMClassifier.predict_proba-322"><span class="linenos">322</span></a>            <span class="n">exp_ZB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ZB</span><span class="p">)</span>
</span><span id="GLMClassifier.predict_proba-323"><a href="#GLMClassifier.predict_proba-323"><span class="linenos">323</span></a>
</span><span id="GLMClassifier.predict_proba-324"><a href="#GLMClassifier.predict_proba-324"><span class="linenos">324</span></a>            <span class="k">return</span> <span class="n">exp_ZB</span> <span class="o">/</span> <span class="n">exp_ZB</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="GLMClassifier.predict_proba-325"><a href="#GLMClassifier.predict_proba-325"><span class="linenos">325</span></a>
</span><span id="GLMClassifier.predict_proba-326"><a href="#GLMClassifier.predict_proba-326"><span class="linenos">326</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">family</span> <span class="o">==</span> <span class="s2">&quot;expit&quot;</span><span class="p">:</span>
</span><span id="GLMClassifier.predict_proba-327"><a href="#GLMClassifier.predict_proba-327"><span class="linenos">327</span></a>            <span class="n">exp_ZB</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">ZB</span><span class="p">)</span>
</span><span id="GLMClassifier.predict_proba-328"><a href="#GLMClassifier.predict_proba-328"><span class="linenos">328</span></a>
</span><span id="GLMClassifier.predict_proba-329"><a href="#GLMClassifier.predict_proba-329"><span class="linenos">329</span></a>            <span class="k">return</span> <span class="n">exp_ZB</span> <span class="o">/</span> <span class="n">exp_ZB</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="GLMClassifier.predict_proba-330"><a href="#GLMClassifier.predict_proba-330"><span class="linenos">330</span></a>
</span><span id="GLMClassifier.predict_proba-331"><a href="#GLMClassifier.predict_proba-331"><span class="linenos">331</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">family</span> <span class="o">==</span> <span class="s2">&quot;erf&quot;</span><span class="p">:</span>
</span><span id="GLMClassifier.predict_proba-332"><a href="#GLMClassifier.predict_proba-332"><span class="linenos">332</span></a>            <span class="n">exp_ZB</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">erf</span><span class="p">(</span><span class="n">ZB</span><span class="p">))</span>
</span><span id="GLMClassifier.predict_proba-333"><a href="#GLMClassifier.predict_proba-333"><span class="linenos">333</span></a>
</span><span id="GLMClassifier.predict_proba-334"><a href="#GLMClassifier.predict_proba-334"><span class="linenos">334</span></a>            <span class="k">return</span> <span class="n">exp_ZB</span> <span class="o">/</span> <span class="n">exp_ZB</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Predict probabilities for test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>probability estimates for test data: {array-like}
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="GLMRegressor">
                            <input id="GLMRegressor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">GLMRegressor</span><wbr>(<span class="base">nnetsauce.glm.glm.GLM</span>, <span class="base">sklearn.base.RegressorMixin</span>):

                <label class="view-source-button" for="GLMRegressor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GLMRegressor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GLMRegressor-14"><a href="#GLMRegressor-14"><span class="linenos"> 14</span></a><span class="k">class</span> <span class="nc">GLMRegressor</span><span class="p">(</span><span class="n">GLM</span><span class="p">,</span> <span class="n">RegressorMixin</span><span class="p">):</span>
</span><span id="GLMRegressor-15"><a href="#GLMRegressor-15"><span class="linenos"> 15</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generalized &#39;linear&#39; models using quasi-randomized networks (regression)</span>
</span><span id="GLMRegressor-16"><a href="#GLMRegressor-16"><span class="linenos"> 16</span></a>
</span><span id="GLMRegressor-17"><a href="#GLMRegressor-17"><span class="linenos"> 17</span></a><span class="sd">    Attributes:</span>
</span><span id="GLMRegressor-18"><a href="#GLMRegressor-18"><span class="linenos"> 18</span></a>
</span><span id="GLMRegressor-19"><a href="#GLMRegressor-19"><span class="linenos"> 19</span></a><span class="sd">        n_hidden_features: int</span>
</span><span id="GLMRegressor-20"><a href="#GLMRegressor-20"><span class="linenos"> 20</span></a><span class="sd">            number of nodes in the hidden layer</span>
</span><span id="GLMRegressor-21"><a href="#GLMRegressor-21"><span class="linenos"> 21</span></a>
</span><span id="GLMRegressor-22"><a href="#GLMRegressor-22"><span class="linenos"> 22</span></a><span class="sd">        lambda1: float</span>
</span><span id="GLMRegressor-23"><a href="#GLMRegressor-23"><span class="linenos"> 23</span></a><span class="sd">            regularization parameter for GLM coefficients on original features</span>
</span><span id="GLMRegressor-24"><a href="#GLMRegressor-24"><span class="linenos"> 24</span></a>
</span><span id="GLMRegressor-25"><a href="#GLMRegressor-25"><span class="linenos"> 25</span></a><span class="sd">        alpha1: float</span>
</span><span id="GLMRegressor-26"><a href="#GLMRegressor-26"><span class="linenos"> 26</span></a><span class="sd">            controls compromize between l1 and l2 norm of GLM coefficients on original features</span>
</span><span id="GLMRegressor-27"><a href="#GLMRegressor-27"><span class="linenos"> 27</span></a>
</span><span id="GLMRegressor-28"><a href="#GLMRegressor-28"><span class="linenos"> 28</span></a><span class="sd">        lambda2: float</span>
</span><span id="GLMRegressor-29"><a href="#GLMRegressor-29"><span class="linenos"> 29</span></a><span class="sd">            regularization parameter for GLM coefficients on nonlinear features</span>
</span><span id="GLMRegressor-30"><a href="#GLMRegressor-30"><span class="linenos"> 30</span></a>
</span><span id="GLMRegressor-31"><a href="#GLMRegressor-31"><span class="linenos"> 31</span></a><span class="sd">        alpha2: float</span>
</span><span id="GLMRegressor-32"><a href="#GLMRegressor-32"><span class="linenos"> 32</span></a><span class="sd">            controls compromize between l1 and l2 norm of GLM coefficients on nonlinear features</span>
</span><span id="GLMRegressor-33"><a href="#GLMRegressor-33"><span class="linenos"> 33</span></a>
</span><span id="GLMRegressor-34"><a href="#GLMRegressor-34"><span class="linenos"> 34</span></a><span class="sd">        family: str</span>
</span><span id="GLMRegressor-35"><a href="#GLMRegressor-35"><span class="linenos"> 35</span></a><span class="sd">            &quot;gaussian&quot;, &quot;laplace&quot; or &quot;poisson&quot; (for now)</span>
</span><span id="GLMRegressor-36"><a href="#GLMRegressor-36"><span class="linenos"> 36</span></a>
</span><span id="GLMRegressor-37"><a href="#GLMRegressor-37"><span class="linenos"> 37</span></a><span class="sd">        activation_name: str</span>
</span><span id="GLMRegressor-38"><a href="#GLMRegressor-38"><span class="linenos"> 38</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;</span>
</span><span id="GLMRegressor-39"><a href="#GLMRegressor-39"><span class="linenos"> 39</span></a>
</span><span id="GLMRegressor-40"><a href="#GLMRegressor-40"><span class="linenos"> 40</span></a><span class="sd">        a: float</span>
</span><span id="GLMRegressor-41"><a href="#GLMRegressor-41"><span class="linenos"> 41</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function</span>
</span><span id="GLMRegressor-42"><a href="#GLMRegressor-42"><span class="linenos"> 42</span></a>
</span><span id="GLMRegressor-43"><a href="#GLMRegressor-43"><span class="linenos"> 43</span></a><span class="sd">        nodes_sim: str</span>
</span><span id="GLMRegressor-44"><a href="#GLMRegressor-44"><span class="linenos"> 44</span></a><span class="sd">            type of simulation for the nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;,</span>
</span><span id="GLMRegressor-45"><a href="#GLMRegressor-45"><span class="linenos"> 45</span></a><span class="sd">            &#39;uniform&#39;</span>
</span><span id="GLMRegressor-46"><a href="#GLMRegressor-46"><span class="linenos"> 46</span></a>
</span><span id="GLMRegressor-47"><a href="#GLMRegressor-47"><span class="linenos"> 47</span></a><span class="sd">        bias: boolean</span>
</span><span id="GLMRegressor-48"><a href="#GLMRegressor-48"><span class="linenos"> 48</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or not</span>
</span><span id="GLMRegressor-49"><a href="#GLMRegressor-49"><span class="linenos"> 49</span></a><span class="sd">            (False)</span>
</span><span id="GLMRegressor-50"><a href="#GLMRegressor-50"><span class="linenos"> 50</span></a>
</span><span id="GLMRegressor-51"><a href="#GLMRegressor-51"><span class="linenos"> 51</span></a><span class="sd">        dropout: float</span>
</span><span id="GLMRegressor-52"><a href="#GLMRegressor-52"><span class="linenos"> 52</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="GLMRegressor-53"><a href="#GLMRegressor-53"><span class="linenos"> 53</span></a><span class="sd">            of the training</span>
</span><span id="GLMRegressor-54"><a href="#GLMRegressor-54"><span class="linenos"> 54</span></a>
</span><span id="GLMRegressor-55"><a href="#GLMRegressor-55"><span class="linenos"> 55</span></a><span class="sd">        direct_link: boolean</span>
</span><span id="GLMRegressor-56"><a href="#GLMRegressor-56"><span class="linenos"> 56</span></a><span class="sd">            indicates if the original predictors are included (True) in model&#39;s</span>
</span><span id="GLMRegressor-57"><a href="#GLMRegressor-57"><span class="linenos"> 57</span></a><span class="sd">            fitting or not (False)</span>
</span><span id="GLMRegressor-58"><a href="#GLMRegressor-58"><span class="linenos"> 58</span></a>
</span><span id="GLMRegressor-59"><a href="#GLMRegressor-59"><span class="linenos"> 59</span></a><span class="sd">        n_clusters: int</span>
</span><span id="GLMRegressor-60"><a href="#GLMRegressor-60"><span class="linenos"> 60</span></a><span class="sd">            number of clusters for &#39;kmeans&#39; or &#39;gmm&#39; clustering (could be 0:</span>
</span><span id="GLMRegressor-61"><a href="#GLMRegressor-61"><span class="linenos"> 61</span></a><span class="sd">                no clustering)</span>
</span><span id="GLMRegressor-62"><a href="#GLMRegressor-62"><span class="linenos"> 62</span></a>
</span><span id="GLMRegressor-63"><a href="#GLMRegressor-63"><span class="linenos"> 63</span></a><span class="sd">        cluster_encode: bool</span>
</span><span id="GLMRegressor-64"><a href="#GLMRegressor-64"><span class="linenos"> 64</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot)</span>
</span><span id="GLMRegressor-65"><a href="#GLMRegressor-65"><span class="linenos"> 65</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding</span>
</span><span id="GLMRegressor-66"><a href="#GLMRegressor-66"><span class="linenos"> 66</span></a>
</span><span id="GLMRegressor-67"><a href="#GLMRegressor-67"><span class="linenos"> 67</span></a><span class="sd">        type_clust: str</span>
</span><span id="GLMRegressor-68"><a href="#GLMRegressor-68"><span class="linenos"> 68</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian</span>
</span><span id="GLMRegressor-69"><a href="#GLMRegressor-69"><span class="linenos"> 69</span></a><span class="sd">            Mixture Model (&#39;gmm&#39;)</span>
</span><span id="GLMRegressor-70"><a href="#GLMRegressor-70"><span class="linenos"> 70</span></a>
</span><span id="GLMRegressor-71"><a href="#GLMRegressor-71"><span class="linenos"> 71</span></a><span class="sd">        type_scaling: a tuple of 3 strings</span>
</span><span id="GLMRegressor-72"><a href="#GLMRegressor-72"><span class="linenos"> 72</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="GLMRegressor-73"><a href="#GLMRegressor-73"><span class="linenos"> 73</span></a><span class="sd">            (and when relevant).</span>
</span><span id="GLMRegressor-74"><a href="#GLMRegressor-74"><span class="linenos"> 74</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;)</span>
</span><span id="GLMRegressor-75"><a href="#GLMRegressor-75"><span class="linenos"> 75</span></a>
</span><span id="GLMRegressor-76"><a href="#GLMRegressor-76"><span class="linenos"> 76</span></a><span class="sd">        optimizer: object</span>
</span><span id="GLMRegressor-77"><a href="#GLMRegressor-77"><span class="linenos"> 77</span></a><span class="sd">            optimizer, from class nnetsauce.utils.Optimizer</span>
</span><span id="GLMRegressor-78"><a href="#GLMRegressor-78"><span class="linenos"> 78</span></a>
</span><span id="GLMRegressor-79"><a href="#GLMRegressor-79"><span class="linenos"> 79</span></a><span class="sd">        seed: int</span>
</span><span id="GLMRegressor-80"><a href="#GLMRegressor-80"><span class="linenos"> 80</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39;</span>
</span><span id="GLMRegressor-81"><a href="#GLMRegressor-81"><span class="linenos"> 81</span></a>
</span><span id="GLMRegressor-82"><a href="#GLMRegressor-82"><span class="linenos"> 82</span></a><span class="sd">    Attributes:</span>
</span><span id="GLMRegressor-83"><a href="#GLMRegressor-83"><span class="linenos"> 83</span></a>
</span><span id="GLMRegressor-84"><a href="#GLMRegressor-84"><span class="linenos"> 84</span></a><span class="sd">        beta_: vector</span>
</span><span id="GLMRegressor-85"><a href="#GLMRegressor-85"><span class="linenos"> 85</span></a><span class="sd">            regression coefficients</span>
</span><span id="GLMRegressor-86"><a href="#GLMRegressor-86"><span class="linenos"> 86</span></a>
</span><span id="GLMRegressor-87"><a href="#GLMRegressor-87"><span class="linenos"> 87</span></a><span class="sd">    Examples:</span>
</span><span id="GLMRegressor-88"><a href="#GLMRegressor-88"><span class="linenos"> 88</span></a>
</span><span id="GLMRegressor-89"><a href="#GLMRegressor-89"><span class="linenos"> 89</span></a><span class="sd">    See [https://github.com/Techtonique/nnetsauce/blob/master/examples/glm_regression.py](https://github.com/Techtonique/nnetsauce/blob/master/examples/glm_regression.py)</span>
</span><span id="GLMRegressor-90"><a href="#GLMRegressor-90"><span class="linenos"> 90</span></a>
</span><span id="GLMRegressor-91"><a href="#GLMRegressor-91"><span class="linenos"> 91</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="GLMRegressor-92"><a href="#GLMRegressor-92"><span class="linenos"> 92</span></a>
</span><span id="GLMRegressor-93"><a href="#GLMRegressor-93"><span class="linenos"> 93</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="GLMRegressor-94"><a href="#GLMRegressor-94"><span class="linenos"> 94</span></a>
</span><span id="GLMRegressor-95"><a href="#GLMRegressor-95"><span class="linenos"> 95</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="GLMRegressor-96"><a href="#GLMRegressor-96"><span class="linenos"> 96</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="GLMRegressor-97"><a href="#GLMRegressor-97"><span class="linenos"> 97</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="GLMRegressor-98"><a href="#GLMRegressor-98"><span class="linenos"> 98</span></a>        <span class="n">lambda1</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="GLMRegressor-99"><a href="#GLMRegressor-99"><span class="linenos"> 99</span></a>        <span class="n">alpha1</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="GLMRegressor-100"><a href="#GLMRegressor-100"><span class="linenos">100</span></a>        <span class="n">lambda2</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="GLMRegressor-101"><a href="#GLMRegressor-101"><span class="linenos">101</span></a>        <span class="n">alpha2</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="GLMRegressor-102"><a href="#GLMRegressor-102"><span class="linenos">102</span></a>        <span class="n">family</span><span class="o">=</span><span class="s2">&quot;gaussian&quot;</span><span class="p">,</span>
</span><span id="GLMRegressor-103"><a href="#GLMRegressor-103"><span class="linenos">103</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="GLMRegressor-104"><a href="#GLMRegressor-104"><span class="linenos">104</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="GLMRegressor-105"><a href="#GLMRegressor-105"><span class="linenos">105</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="GLMRegressor-106"><a href="#GLMRegressor-106"><span class="linenos">106</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="GLMRegressor-107"><a href="#GLMRegressor-107"><span class="linenos">107</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="GLMRegressor-108"><a href="#GLMRegressor-108"><span class="linenos">108</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="GLMRegressor-109"><a href="#GLMRegressor-109"><span class="linenos">109</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="GLMRegressor-110"><a href="#GLMRegressor-110"><span class="linenos">110</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="GLMRegressor-111"><a href="#GLMRegressor-111"><span class="linenos">111</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="GLMRegressor-112"><a href="#GLMRegressor-112"><span class="linenos">112</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="GLMRegressor-113"><a href="#GLMRegressor-113"><span class="linenos">113</span></a>        <span class="n">optimizer</span><span class="o">=</span><span class="n">Optimizer</span><span class="p">(),</span>
</span><span id="GLMRegressor-114"><a href="#GLMRegressor-114"><span class="linenos">114</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="GLMRegressor-115"><a href="#GLMRegressor-115"><span class="linenos">115</span></a>    <span class="p">):</span>
</span><span id="GLMRegressor-116"><a href="#GLMRegressor-116"><span class="linenos">116</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="GLMRegressor-117"><a href="#GLMRegressor-117"><span class="linenos">117</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="GLMRegressor-118"><a href="#GLMRegressor-118"><span class="linenos">118</span></a>            <span class="n">lambda1</span><span class="o">=</span><span class="n">lambda1</span><span class="p">,</span>
</span><span id="GLMRegressor-119"><a href="#GLMRegressor-119"><span class="linenos">119</span></a>            <span class="n">alpha1</span><span class="o">=</span><span class="n">alpha1</span><span class="p">,</span>
</span><span id="GLMRegressor-120"><a href="#GLMRegressor-120"><span class="linenos">120</span></a>            <span class="n">lambda2</span><span class="o">=</span><span class="n">lambda2</span><span class="p">,</span>
</span><span id="GLMRegressor-121"><a href="#GLMRegressor-121"><span class="linenos">121</span></a>            <span class="n">alpha2</span><span class="o">=</span><span class="n">alpha2</span><span class="p">,</span>
</span><span id="GLMRegressor-122"><a href="#GLMRegressor-122"><span class="linenos">122</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="GLMRegressor-123"><a href="#GLMRegressor-123"><span class="linenos">123</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="GLMRegressor-124"><a href="#GLMRegressor-124"><span class="linenos">124</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="GLMRegressor-125"><a href="#GLMRegressor-125"><span class="linenos">125</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="GLMRegressor-126"><a href="#GLMRegressor-126"><span class="linenos">126</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="GLMRegressor-127"><a href="#GLMRegressor-127"><span class="linenos">127</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="GLMRegressor-128"><a href="#GLMRegressor-128"><span class="linenos">128</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="GLMRegressor-129"><a href="#GLMRegressor-129"><span class="linenos">129</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="GLMRegressor-130"><a href="#GLMRegressor-130"><span class="linenos">130</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="GLMRegressor-131"><a href="#GLMRegressor-131"><span class="linenos">131</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="GLMRegressor-132"><a href="#GLMRegressor-132"><span class="linenos">132</span></a>            <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
</span><span id="GLMRegressor-133"><a href="#GLMRegressor-133"><span class="linenos">133</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="GLMRegressor-134"><a href="#GLMRegressor-134"><span class="linenos">134</span></a>        <span class="p">)</span>
</span><span id="GLMRegressor-135"><a href="#GLMRegressor-135"><span class="linenos">135</span></a>
</span><span id="GLMRegressor-136"><a href="#GLMRegressor-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">family</span> <span class="o">=</span> <span class="n">family</span>
</span><span id="GLMRegressor-137"><a href="#GLMRegressor-137"><span class="linenos">137</span></a>
</span><span id="GLMRegressor-138"><a href="#GLMRegressor-138"><span class="linenos">138</span></a>    <span class="k">def</span> <span class="nf">gaussian_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">row_index</span><span class="p">,</span> <span class="n">XB</span><span class="p">):</span>
</span><span id="GLMRegressor-139"><a href="#GLMRegressor-139"><span class="linenos">139</span></a>        <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">row_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">XB</span><span class="p">))</span>
</span><span id="GLMRegressor-140"><a href="#GLMRegressor-140"><span class="linenos">140</span></a>
</span><span id="GLMRegressor-141"><a href="#GLMRegressor-141"><span class="linenos">141</span></a>    <span class="k">def</span> <span class="nf">laplace_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">row_index</span><span class="p">,</span> <span class="n">XB</span><span class="p">):</span>
</span><span id="GLMRegressor-142"><a href="#GLMRegressor-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">row_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">XB</span><span class="p">))</span>
</span><span id="GLMRegressor-143"><a href="#GLMRegressor-143"><span class="linenos">143</span></a>
</span><span id="GLMRegressor-144"><a href="#GLMRegressor-144"><span class="linenos">144</span></a>    <span class="k">def</span> <span class="nf">poisson_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">row_index</span><span class="p">,</span> <span class="n">XB</span><span class="p">):</span>
</span><span id="GLMRegressor-145"><a href="#GLMRegressor-145"><span class="linenos">145</span></a>        <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">row_index</span><span class="p">]</span> <span class="o">*</span> <span class="n">XB</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">XB</span><span class="p">))</span>
</span><span id="GLMRegressor-146"><a href="#GLMRegressor-146"><span class="linenos">146</span></a>
</span><span id="GLMRegressor-147"><a href="#GLMRegressor-147"><span class="linenos">147</span></a>    <span class="k">def</span> <span class="nf">loss_func</span><span class="p">(</span>
</span><span id="GLMRegressor-148"><a href="#GLMRegressor-148"><span class="linenos">148</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="GLMRegressor-149"><a href="#GLMRegressor-149"><span class="linenos">149</span></a>        <span class="n">beta</span><span class="p">,</span>
</span><span id="GLMRegressor-150"><a href="#GLMRegressor-150"><span class="linenos">150</span></a>        <span class="n">group_index</span><span class="p">,</span>
</span><span id="GLMRegressor-151"><a href="#GLMRegressor-151"><span class="linenos">151</span></a>        <span class="n">X</span><span class="p">,</span>
</span><span id="GLMRegressor-152"><a href="#GLMRegressor-152"><span class="linenos">152</span></a>        <span class="n">y</span><span class="p">,</span>
</span><span id="GLMRegressor-153"><a href="#GLMRegressor-153"><span class="linenos">153</span></a>        <span class="n">row_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="GLMRegressor-154"><a href="#GLMRegressor-154"><span class="linenos">154</span></a>        <span class="n">type_loss</span><span class="o">=</span><span class="s2">&quot;gaussian&quot;</span><span class="p">,</span>
</span><span id="GLMRegressor-155"><a href="#GLMRegressor-155"><span class="linenos">155</span></a>        <span class="o">**</span><span class="n">kwargs</span>
</span><span id="GLMRegressor-156"><a href="#GLMRegressor-156"><span class="linenos">156</span></a>    <span class="p">):</span>
</span><span id="GLMRegressor-157"><a href="#GLMRegressor-157"><span class="linenos">157</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="GLMRegressor-158"><a href="#GLMRegressor-158"><span class="linenos">158</span></a>            <span class="s2">&quot;gaussian&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_loss</span><span class="p">,</span>
</span><span id="GLMRegressor-159"><a href="#GLMRegressor-159"><span class="linenos">159</span></a>            <span class="s2">&quot;laplace&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">laplace_loss</span><span class="p">,</span>
</span><span id="GLMRegressor-160"><a href="#GLMRegressor-160"><span class="linenos">160</span></a>            <span class="s2">&quot;poisson&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poisson_loss</span><span class="p">,</span>
</span><span id="GLMRegressor-161"><a href="#GLMRegressor-161"><span class="linenos">161</span></a>        <span class="p">}</span>
</span><span id="GLMRegressor-162"><a href="#GLMRegressor-162"><span class="linenos">162</span></a>
</span><span id="GLMRegressor-163"><a href="#GLMRegressor-163"><span class="linenos">163</span></a>        <span class="k">if</span> <span class="n">row_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="GLMRegressor-164"><a href="#GLMRegressor-164"><span class="linenos">164</span></a>            <span class="n">row_index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="GLMRegressor-165"><a href="#GLMRegressor-165"><span class="linenos">165</span></a>            <span class="n">XB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_XB</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">)</span>
</span><span id="GLMRegressor-166"><a href="#GLMRegressor-166"><span class="linenos">166</span></a>
</span><span id="GLMRegressor-167"><a href="#GLMRegressor-167"><span class="linenos">167</span></a>            <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="n">type_loss</span><span class="p">](</span><span class="n">y</span><span class="p">,</span> <span class="n">row_index</span><span class="p">,</span> <span class="n">XB</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_penalty</span><span class="p">(</span>
</span><span id="GLMRegressor-168"><a href="#GLMRegressor-168"><span class="linenos">168</span></a>                <span class="n">group_index</span><span class="o">=</span><span class="n">group_index</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span>
</span><span id="GLMRegressor-169"><a href="#GLMRegressor-169"><span class="linenos">169</span></a>            <span class="p">)</span>
</span><span id="GLMRegressor-170"><a href="#GLMRegressor-170"><span class="linenos">170</span></a>
</span><span id="GLMRegressor-171"><a href="#GLMRegressor-171"><span class="linenos">171</span></a>        <span class="n">XB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_XB</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> <span class="n">row_index</span><span class="o">=</span><span class="n">row_index</span><span class="p">)</span>
</span><span id="GLMRegressor-172"><a href="#GLMRegressor-172"><span class="linenos">172</span></a>
</span><span id="GLMRegressor-173"><a href="#GLMRegressor-173"><span class="linenos">173</span></a>        <span class="k">return</span> <span class="n">res</span><span class="p">[</span><span class="n">type_loss</span><span class="p">](</span><span class="n">y</span><span class="p">,</span> <span class="n">row_index</span><span class="p">,</span> <span class="n">XB</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_penalty</span><span class="p">(</span>
</span><span id="GLMRegressor-174"><a href="#GLMRegressor-174"><span class="linenos">174</span></a>            <span class="n">group_index</span><span class="o">=</span><span class="n">group_index</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span>
</span><span id="GLMRegressor-175"><a href="#GLMRegressor-175"><span class="linenos">175</span></a>        <span class="p">)</span>
</span><span id="GLMRegressor-176"><a href="#GLMRegressor-176"><span class="linenos">176</span></a>
</span><span id="GLMRegressor-177"><a href="#GLMRegressor-177"><span class="linenos">177</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GLMRegressor-178"><a href="#GLMRegressor-178"><span class="linenos">178</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit GLM model to training data (X, y).</span>
</span><span id="GLMRegressor-179"><a href="#GLMRegressor-179"><span class="linenos">179</span></a>
</span><span id="GLMRegressor-180"><a href="#GLMRegressor-180"><span class="linenos">180</span></a><span class="sd">        Args:</span>
</span><span id="GLMRegressor-181"><a href="#GLMRegressor-181"><span class="linenos">181</span></a>
</span><span id="GLMRegressor-182"><a href="#GLMRegressor-182"><span class="linenos">182</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="GLMRegressor-183"><a href="#GLMRegressor-183"><span class="linenos">183</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="GLMRegressor-184"><a href="#GLMRegressor-184"><span class="linenos">184</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="GLMRegressor-185"><a href="#GLMRegressor-185"><span class="linenos">185</span></a>
</span><span id="GLMRegressor-186"><a href="#GLMRegressor-186"><span class="linenos">186</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="GLMRegressor-187"><a href="#GLMRegressor-187"><span class="linenos">187</span></a><span class="sd">                Target values.</span>
</span><span id="GLMRegressor-188"><a href="#GLMRegressor-188"><span class="linenos">188</span></a>
</span><span id="GLMRegressor-189"><a href="#GLMRegressor-189"><span class="linenos">189</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="GLMRegressor-190"><a href="#GLMRegressor-190"><span class="linenos">190</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="GLMRegressor-191"><a href="#GLMRegressor-191"><span class="linenos">191</span></a>
</span><span id="GLMRegressor-192"><a href="#GLMRegressor-192"><span class="linenos">192</span></a><span class="sd">        Returns:</span>
</span><span id="GLMRegressor-193"><a href="#GLMRegressor-193"><span class="linenos">193</span></a>
</span><span id="GLMRegressor-194"><a href="#GLMRegressor-194"><span class="linenos">194</span></a><span class="sd">            self: object</span>
</span><span id="GLMRegressor-195"><a href="#GLMRegressor-195"><span class="linenos">195</span></a>
</span><span id="GLMRegressor-196"><a href="#GLMRegressor-196"><span class="linenos">196</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GLMRegressor-197"><a href="#GLMRegressor-197"><span class="linenos">197</span></a>
</span><span id="GLMRegressor-198"><a href="#GLMRegressor-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="GLMRegressor-199"><a href="#GLMRegressor-199"><span class="linenos">199</span></a>
</span><span id="GLMRegressor-200"><a href="#GLMRegressor-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_iter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="GLMRegressor-201"><a href="#GLMRegressor-201"><span class="linenos">201</span></a>
</span><span id="GLMRegressor-202"><a href="#GLMRegressor-202"><span class="linenos">202</span></a>        <span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_index</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="GLMRegressor-203"><a href="#GLMRegressor-203"><span class="linenos">203</span></a>
</span><span id="GLMRegressor-204"><a href="#GLMRegressor-204"><span class="linenos">204</span></a>        <span class="n">centered_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GLMRegressor-205"><a href="#GLMRegressor-205"><span class="linenos">205</span></a>
</span><span id="GLMRegressor-206"><a href="#GLMRegressor-206"><span class="linenos">206</span></a>        <span class="n">n_Z</span> <span class="o">=</span> <span class="n">scaled_Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GLMRegressor-207"><a href="#GLMRegressor-207"><span class="linenos">207</span></a>
</span><span id="GLMRegressor-208"><a href="#GLMRegressor-208"><span class="linenos">208</span></a>        <span class="c1"># initialization</span>
</span><span id="GLMRegressor-209"><a href="#GLMRegressor-209"><span class="linenos">209</span></a>        <span class="n">beta_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">centered_y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GLMRegressor-210"><a href="#GLMRegressor-210"><span class="linenos">210</span></a>
</span><span id="GLMRegressor-211"><a href="#GLMRegressor-211"><span class="linenos">211</span></a>        <span class="c1"># optimization</span>
</span><span id="GLMRegressor-212"><a href="#GLMRegressor-212"><span class="linenos">212</span></a>        <span class="c1"># fit(self, loss_func, response, x0, **kwargs):</span>
</span><span id="GLMRegressor-213"><a href="#GLMRegressor-213"><span class="linenos">213</span></a>        <span class="c1"># loss_func(self, beta, group_index, X, y,</span>
</span><span id="GLMRegressor-214"><a href="#GLMRegressor-214"><span class="linenos">214</span></a>        <span class="c1">#          row_index=None, type_loss=&quot;gaussian&quot;,</span>
</span><span id="GLMRegressor-215"><a href="#GLMRegressor-215"><span class="linenos">215</span></a>        <span class="c1">#          **kwargs)</span>
</span><span id="GLMRegressor-216"><a href="#GLMRegressor-216"><span class="linenos">216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="GLMRegressor-217"><a href="#GLMRegressor-217"><span class="linenos">217</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">loss_func</span><span class="p">,</span>
</span><span id="GLMRegressor-218"><a href="#GLMRegressor-218"><span class="linenos">218</span></a>            <span class="n">response</span><span class="o">=</span><span class="n">centered_y</span><span class="p">,</span>
</span><span id="GLMRegressor-219"><a href="#GLMRegressor-219"><span class="linenos">219</span></a>            <span class="n">x0</span><span class="o">=</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="GLMRegressor-220"><a href="#GLMRegressor-220"><span class="linenos">220</span></a>            <span class="n">group_index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">group_index</span><span class="p">,</span>
</span><span id="GLMRegressor-221"><a href="#GLMRegressor-221"><span class="linenos">221</span></a>            <span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span>
</span><span id="GLMRegressor-222"><a href="#GLMRegressor-222"><span class="linenos">222</span></a>            <span class="n">y</span><span class="o">=</span><span class="n">centered_y</span><span class="p">,</span>
</span><span id="GLMRegressor-223"><a href="#GLMRegressor-223"><span class="linenos">223</span></a>            <span class="n">type_loss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">family</span><span class="p">,</span>
</span><span id="GLMRegressor-224"><a href="#GLMRegressor-224"><span class="linenos">224</span></a>            <span class="o">**</span><span class="n">kwargs</span>
</span><span id="GLMRegressor-225"><a href="#GLMRegressor-225"><span class="linenos">225</span></a>        <span class="p">)</span>
</span><span id="GLMRegressor-226"><a href="#GLMRegressor-226"><span class="linenos">226</span></a>
</span><span id="GLMRegressor-227"><a href="#GLMRegressor-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GLMRegressor-228"><a href="#GLMRegressor-228"><span class="linenos">228</span></a>
</span><span id="GLMRegressor-229"><a href="#GLMRegressor-229"><span class="linenos">229</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="GLMRegressor-230"><a href="#GLMRegressor-230"><span class="linenos">230</span></a>
</span><span id="GLMRegressor-231"><a href="#GLMRegressor-231"><span class="linenos">231</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GLMRegressor-232"><a href="#GLMRegressor-232"><span class="linenos">232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="GLMRegressor-233"><a href="#GLMRegressor-233"><span class="linenos">233</span></a>
</span><span id="GLMRegressor-234"><a href="#GLMRegressor-234"><span class="linenos">234</span></a><span class="sd">        Args:</span>
</span><span id="GLMRegressor-235"><a href="#GLMRegressor-235"><span class="linenos">235</span></a>
</span><span id="GLMRegressor-236"><a href="#GLMRegressor-236"><span class="linenos">236</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="GLMRegressor-237"><a href="#GLMRegressor-237"><span class="linenos">237</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="GLMRegressor-238"><a href="#GLMRegressor-238"><span class="linenos">238</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="GLMRegressor-239"><a href="#GLMRegressor-239"><span class="linenos">239</span></a>
</span><span id="GLMRegressor-240"><a href="#GLMRegressor-240"><span class="linenos">240</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="GLMRegressor-241"><a href="#GLMRegressor-241"><span class="linenos">241</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="GLMRegressor-242"><a href="#GLMRegressor-242"><span class="linenos">242</span></a>
</span><span id="GLMRegressor-243"><a href="#GLMRegressor-243"><span class="linenos">243</span></a><span class="sd">        Returns:</span>
</span><span id="GLMRegressor-244"><a href="#GLMRegressor-244"><span class="linenos">244</span></a>
</span><span id="GLMRegressor-245"><a href="#GLMRegressor-245"><span class="linenos">245</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="GLMRegressor-246"><a href="#GLMRegressor-246"><span class="linenos">246</span></a>
</span><span id="GLMRegressor-247"><a href="#GLMRegressor-247"><span class="linenos">247</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GLMRegressor-248"><a href="#GLMRegressor-248"><span class="linenos">248</span></a>
</span><span id="GLMRegressor-249"><a href="#GLMRegressor-249"><span class="linenos">249</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="GLMRegressor-250"><a href="#GLMRegressor-250"><span class="linenos">250</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GLMRegressor-251"><a href="#GLMRegressor-251"><span class="linenos">251</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="GLMRegressor-252"><a href="#GLMRegressor-252"><span class="linenos">252</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="GLMRegressor-253"><a href="#GLMRegressor-253"><span class="linenos">253</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="GLMRegressor-254"><a href="#GLMRegressor-254"><span class="linenos">254</span></a>            <span class="p">)</span>
</span><span id="GLMRegressor-255"><a href="#GLMRegressor-255"><span class="linenos">255</span></a>
</span><span id="GLMRegressor-256"><a href="#GLMRegressor-256"><span class="linenos">256</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="GLMRegressor-257"><a href="#GLMRegressor-257"><span class="linenos">257</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span>
</span><span id="GLMRegressor-258"><a href="#GLMRegressor-258"><span class="linenos">258</span></a>                <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">)</span>
</span><span id="GLMRegressor-259"><a href="#GLMRegressor-259"><span class="linenos">259</span></a>            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GLMRegressor-260"><a href="#GLMRegressor-260"><span class="linenos">260</span></a>
</span><span id="GLMRegressor-261"><a href="#GLMRegressor-261"><span class="linenos">261</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
</span><span id="GLMRegressor-262"><a href="#GLMRegressor-262"><span class="linenos">262</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span>
</span><span id="GLMRegressor-263"><a href="#GLMRegressor-263"><span class="linenos">263</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generalized 'linear' models using quasi-randomized networks (regression)</p>

<p>Attributes:</p>

<pre><code>n_hidden_features: int
    number of nodes in the hidden layer

lambda1: float
    regularization parameter for GLM coefficients on original features

alpha1: float
    controls compromize between l1 and l2 norm of GLM coefficients on original features

lambda2: float
    regularization parameter for GLM coefficients on nonlinear features

alpha2: float
    controls compromize between l1 and l2 norm of GLM coefficients on nonlinear features

family: str
    "gaussian", "laplace" or "poisson" (for now)

activation_name: str
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'

a: float
    hyperparameter for 'prelu' or 'elu' activation function

nodes_sim: str
    type of simulation for the nodes: 'sobol', 'hammersley', 'halton',
    'uniform'

bias: boolean
    indicates if the hidden layer contains a bias term (True) or not
    (False)

dropout: float
    regularization parameter; (random) percentage of nodes dropped out
    of the training

direct_link: boolean
    indicates if the original predictors are included (True) in model's
    fitting or not (False)

n_clusters: int
    number of clusters for 'kmeans' or 'gmm' clustering (could be 0:
        no clustering)

cluster_encode: bool
    defines how the variable containing clusters is treated (default is one-hot)
    if `False`, then labels are used, without one-hot encoding

type_clust: str
    type of clustering method: currently k-means ('kmeans') or Gaussian
    Mixture Model ('gmm')

type_scaling: a tuple of 3 strings
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax')

optimizer: object
    optimizer, from class nnetsauce.utils.Optimizer

seed: int
    reproducibility seed for nodes_sim=='uniform'
</code></pre>

<p>Attributes:</p>

<pre><code>beta_: vector
    regression coefficients
</code></pre>

<p>Examples:</p>

<p>See <a href="https://github.com/Techtonique/nnetsauce/blob/master/examples/glm_regression.py">https://github.com/Techtonique/nnetsauce/blob/master/examples/glm_regression.py</a></p>
</div>


                                <div id="GLMRegressor.fit" class="classattr">
                                            <input id="GLMRegressor.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GLMRegressor.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GLMRegressor.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GLMRegressor.fit-177"><a href="#GLMRegressor.fit-177"><span class="linenos">177</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GLMRegressor.fit-178"><a href="#GLMRegressor.fit-178"><span class="linenos">178</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit GLM model to training data (X, y).</span>
</span><span id="GLMRegressor.fit-179"><a href="#GLMRegressor.fit-179"><span class="linenos">179</span></a>
</span><span id="GLMRegressor.fit-180"><a href="#GLMRegressor.fit-180"><span class="linenos">180</span></a><span class="sd">        Args:</span>
</span><span id="GLMRegressor.fit-181"><a href="#GLMRegressor.fit-181"><span class="linenos">181</span></a>
</span><span id="GLMRegressor.fit-182"><a href="#GLMRegressor.fit-182"><span class="linenos">182</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="GLMRegressor.fit-183"><a href="#GLMRegressor.fit-183"><span class="linenos">183</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="GLMRegressor.fit-184"><a href="#GLMRegressor.fit-184"><span class="linenos">184</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="GLMRegressor.fit-185"><a href="#GLMRegressor.fit-185"><span class="linenos">185</span></a>
</span><span id="GLMRegressor.fit-186"><a href="#GLMRegressor.fit-186"><span class="linenos">186</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="GLMRegressor.fit-187"><a href="#GLMRegressor.fit-187"><span class="linenos">187</span></a><span class="sd">                Target values.</span>
</span><span id="GLMRegressor.fit-188"><a href="#GLMRegressor.fit-188"><span class="linenos">188</span></a>
</span><span id="GLMRegressor.fit-189"><a href="#GLMRegressor.fit-189"><span class="linenos">189</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="GLMRegressor.fit-190"><a href="#GLMRegressor.fit-190"><span class="linenos">190</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="GLMRegressor.fit-191"><a href="#GLMRegressor.fit-191"><span class="linenos">191</span></a>
</span><span id="GLMRegressor.fit-192"><a href="#GLMRegressor.fit-192"><span class="linenos">192</span></a><span class="sd">        Returns:</span>
</span><span id="GLMRegressor.fit-193"><a href="#GLMRegressor.fit-193"><span class="linenos">193</span></a>
</span><span id="GLMRegressor.fit-194"><a href="#GLMRegressor.fit-194"><span class="linenos">194</span></a><span class="sd">            self: object</span>
</span><span id="GLMRegressor.fit-195"><a href="#GLMRegressor.fit-195"><span class="linenos">195</span></a>
</span><span id="GLMRegressor.fit-196"><a href="#GLMRegressor.fit-196"><span class="linenos">196</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GLMRegressor.fit-197"><a href="#GLMRegressor.fit-197"><span class="linenos">197</span></a>
</span><span id="GLMRegressor.fit-198"><a href="#GLMRegressor.fit-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="GLMRegressor.fit-199"><a href="#GLMRegressor.fit-199"><span class="linenos">199</span></a>
</span><span id="GLMRegressor.fit-200"><a href="#GLMRegressor.fit-200"><span class="linenos">200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_iter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="GLMRegressor.fit-201"><a href="#GLMRegressor.fit-201"><span class="linenos">201</span></a>
</span><span id="GLMRegressor.fit-202"><a href="#GLMRegressor.fit-202"><span class="linenos">202</span></a>        <span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_index</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="GLMRegressor.fit-203"><a href="#GLMRegressor.fit-203"><span class="linenos">203</span></a>
</span><span id="GLMRegressor.fit-204"><a href="#GLMRegressor.fit-204"><span class="linenos">204</span></a>        <span class="n">centered_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GLMRegressor.fit-205"><a href="#GLMRegressor.fit-205"><span class="linenos">205</span></a>
</span><span id="GLMRegressor.fit-206"><a href="#GLMRegressor.fit-206"><span class="linenos">206</span></a>        <span class="n">n_Z</span> <span class="o">=</span> <span class="n">scaled_Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GLMRegressor.fit-207"><a href="#GLMRegressor.fit-207"><span class="linenos">207</span></a>
</span><span id="GLMRegressor.fit-208"><a href="#GLMRegressor.fit-208"><span class="linenos">208</span></a>        <span class="c1"># initialization</span>
</span><span id="GLMRegressor.fit-209"><a href="#GLMRegressor.fit-209"><span class="linenos">209</span></a>        <span class="n">beta_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">centered_y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GLMRegressor.fit-210"><a href="#GLMRegressor.fit-210"><span class="linenos">210</span></a>
</span><span id="GLMRegressor.fit-211"><a href="#GLMRegressor.fit-211"><span class="linenos">211</span></a>        <span class="c1"># optimization</span>
</span><span id="GLMRegressor.fit-212"><a href="#GLMRegressor.fit-212"><span class="linenos">212</span></a>        <span class="c1"># fit(self, loss_func, response, x0, **kwargs):</span>
</span><span id="GLMRegressor.fit-213"><a href="#GLMRegressor.fit-213"><span class="linenos">213</span></a>        <span class="c1"># loss_func(self, beta, group_index, X, y,</span>
</span><span id="GLMRegressor.fit-214"><a href="#GLMRegressor.fit-214"><span class="linenos">214</span></a>        <span class="c1">#          row_index=None, type_loss=&quot;gaussian&quot;,</span>
</span><span id="GLMRegressor.fit-215"><a href="#GLMRegressor.fit-215"><span class="linenos">215</span></a>        <span class="c1">#          **kwargs)</span>
</span><span id="GLMRegressor.fit-216"><a href="#GLMRegressor.fit-216"><span class="linenos">216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span id="GLMRegressor.fit-217"><a href="#GLMRegressor.fit-217"><span class="linenos">217</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">loss_func</span><span class="p">,</span>
</span><span id="GLMRegressor.fit-218"><a href="#GLMRegressor.fit-218"><span class="linenos">218</span></a>            <span class="n">response</span><span class="o">=</span><span class="n">centered_y</span><span class="p">,</span>
</span><span id="GLMRegressor.fit-219"><a href="#GLMRegressor.fit-219"><span class="linenos">219</span></a>            <span class="n">x0</span><span class="o">=</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="GLMRegressor.fit-220"><a href="#GLMRegressor.fit-220"><span class="linenos">220</span></a>            <span class="n">group_index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">group_index</span><span class="p">,</span>
</span><span id="GLMRegressor.fit-221"><a href="#GLMRegressor.fit-221"><span class="linenos">221</span></a>            <span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span>
</span><span id="GLMRegressor.fit-222"><a href="#GLMRegressor.fit-222"><span class="linenos">222</span></a>            <span class="n">y</span><span class="o">=</span><span class="n">centered_y</span><span class="p">,</span>
</span><span id="GLMRegressor.fit-223"><a href="#GLMRegressor.fit-223"><span class="linenos">223</span></a>            <span class="n">type_loss</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">family</span><span class="p">,</span>
</span><span id="GLMRegressor.fit-224"><a href="#GLMRegressor.fit-224"><span class="linenos">224</span></a>            <span class="o">**</span><span class="n">kwargs</span>
</span><span id="GLMRegressor.fit-225"><a href="#GLMRegressor.fit-225"><span class="linenos">225</span></a>        <span class="p">)</span>
</span><span id="GLMRegressor.fit-226"><a href="#GLMRegressor.fit-226"><span class="linenos">226</span></a>
</span><span id="GLMRegressor.fit-227"><a href="#GLMRegressor.fit-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GLMRegressor.fit-228"><a href="#GLMRegressor.fit-228"><span class="linenos">228</span></a>
</span><span id="GLMRegressor.fit-229"><a href="#GLMRegressor.fit-229"><span class="linenos">229</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit GLM model to training data (X, y).</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

y: array-like, shape = [n_samples]
    Target values.

**kwargs: additional parameters to be passed to
        self.cook_training_set or self.obj.fit
</code></pre>

<p>Returns:</p>

<pre><code>self: object
</code></pre>
</div>


                                </div>
                                <div id="GLMRegressor.predict" class="classattr">
                                            <input id="GLMRegressor.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GLMRegressor.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GLMRegressor.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GLMRegressor.predict-231"><a href="#GLMRegressor.predict-231"><span class="linenos">231</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GLMRegressor.predict-232"><a href="#GLMRegressor.predict-232"><span class="linenos">232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="GLMRegressor.predict-233"><a href="#GLMRegressor.predict-233"><span class="linenos">233</span></a>
</span><span id="GLMRegressor.predict-234"><a href="#GLMRegressor.predict-234"><span class="linenos">234</span></a><span class="sd">        Args:</span>
</span><span id="GLMRegressor.predict-235"><a href="#GLMRegressor.predict-235"><span class="linenos">235</span></a>
</span><span id="GLMRegressor.predict-236"><a href="#GLMRegressor.predict-236"><span class="linenos">236</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="GLMRegressor.predict-237"><a href="#GLMRegressor.predict-237"><span class="linenos">237</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="GLMRegressor.predict-238"><a href="#GLMRegressor.predict-238"><span class="linenos">238</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="GLMRegressor.predict-239"><a href="#GLMRegressor.predict-239"><span class="linenos">239</span></a>
</span><span id="GLMRegressor.predict-240"><a href="#GLMRegressor.predict-240"><span class="linenos">240</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="GLMRegressor.predict-241"><a href="#GLMRegressor.predict-241"><span class="linenos">241</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="GLMRegressor.predict-242"><a href="#GLMRegressor.predict-242"><span class="linenos">242</span></a>
</span><span id="GLMRegressor.predict-243"><a href="#GLMRegressor.predict-243"><span class="linenos">243</span></a><span class="sd">        Returns:</span>
</span><span id="GLMRegressor.predict-244"><a href="#GLMRegressor.predict-244"><span class="linenos">244</span></a>
</span><span id="GLMRegressor.predict-245"><a href="#GLMRegressor.predict-245"><span class="linenos">245</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="GLMRegressor.predict-246"><a href="#GLMRegressor.predict-246"><span class="linenos">246</span></a>
</span><span id="GLMRegressor.predict-247"><a href="#GLMRegressor.predict-247"><span class="linenos">247</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GLMRegressor.predict-248"><a href="#GLMRegressor.predict-248"><span class="linenos">248</span></a>
</span><span id="GLMRegressor.predict-249"><a href="#GLMRegressor.predict-249"><span class="linenos">249</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="GLMRegressor.predict-250"><a href="#GLMRegressor.predict-250"><span class="linenos">250</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GLMRegressor.predict-251"><a href="#GLMRegressor.predict-251"><span class="linenos">251</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="GLMRegressor.predict-252"><a href="#GLMRegressor.predict-252"><span class="linenos">252</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="GLMRegressor.predict-253"><a href="#GLMRegressor.predict-253"><span class="linenos">253</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="GLMRegressor.predict-254"><a href="#GLMRegressor.predict-254"><span class="linenos">254</span></a>            <span class="p">)</span>
</span><span id="GLMRegressor.predict-255"><a href="#GLMRegressor.predict-255"><span class="linenos">255</span></a>
</span><span id="GLMRegressor.predict-256"><a href="#GLMRegressor.predict-256"><span class="linenos">256</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="GLMRegressor.predict-257"><a href="#GLMRegressor.predict-257"><span class="linenos">257</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span>
</span><span id="GLMRegressor.predict-258"><a href="#GLMRegressor.predict-258"><span class="linenos">258</span></a>                <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">)</span>
</span><span id="GLMRegressor.predict-259"><a href="#GLMRegressor.predict-259"><span class="linenos">259</span></a>            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GLMRegressor.predict-260"><a href="#GLMRegressor.predict-260"><span class="linenos">260</span></a>
</span><span id="GLMRegressor.predict-261"><a href="#GLMRegressor.predict-261"><span class="linenos">261</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
</span><span id="GLMRegressor.predict-262"><a href="#GLMRegressor.predict-262"><span class="linenos">262</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span>
</span><span id="GLMRegressor.predict-263"><a href="#GLMRegressor.predict-263"><span class="linenos">263</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>model predictions: {array-like}
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="LazyClassifier">
                            <input id="LazyClassifier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LazyClassifier</span><wbr>(<span class="base">nnetsauce.custom.custom.Custom</span>, <span class="base">sklearn.base.ClassifierMixin</span>):

                <label class="view-source-button" for="LazyClassifier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyClassifier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyClassifier-84"><a href="#LazyClassifier-84"><span class="linenos"> 84</span></a><span class="k">class</span> <span class="nc">LazyClassifier</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">):</span>
</span><span id="LazyClassifier-85"><a href="#LazyClassifier-85"><span class="linenos"> 85</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyClassifier-86"><a href="#LazyClassifier-86"><span class="linenos"> 86</span></a>
</span><span id="LazyClassifier-87"><a href="#LazyClassifier-87"><span class="linenos"> 87</span></a><span class="sd">        Fitting -- almost -- all the classification algorithms with nnetsauce&#39;s</span>
</span><span id="LazyClassifier-88"><a href="#LazyClassifier-88"><span class="linenos"> 88</span></a><span class="sd">        CustomClassifier and returning their scores.</span>
</span><span id="LazyClassifier-89"><a href="#LazyClassifier-89"><span class="linenos"> 89</span></a>
</span><span id="LazyClassifier-90"><a href="#LazyClassifier-90"><span class="linenos"> 90</span></a><span class="sd">    Parameters:</span>
</span><span id="LazyClassifier-91"><a href="#LazyClassifier-91"><span class="linenos"> 91</span></a>
</span><span id="LazyClassifier-92"><a href="#LazyClassifier-92"><span class="linenos"> 92</span></a><span class="sd">        verbose: int, optional (default=0)</span>
</span><span id="LazyClassifier-93"><a href="#LazyClassifier-93"><span class="linenos"> 93</span></a><span class="sd">            Any positive number for verbosity.</span>
</span><span id="LazyClassifier-94"><a href="#LazyClassifier-94"><span class="linenos"> 94</span></a>
</span><span id="LazyClassifier-95"><a href="#LazyClassifier-95"><span class="linenos"> 95</span></a><span class="sd">        ignore_warnings: bool, optional (default=True)</span>
</span><span id="LazyClassifier-96"><a href="#LazyClassifier-96"><span class="linenos"> 96</span></a><span class="sd">            When set to True, warnings related to algorithms that were not</span>
</span><span id="LazyClassifier-97"><a href="#LazyClassifier-97"><span class="linenos"> 97</span></a><span class="sd">            run are ignored.</span>
</span><span id="LazyClassifier-98"><a href="#LazyClassifier-98"><span class="linenos"> 98</span></a>
</span><span id="LazyClassifier-99"><a href="#LazyClassifier-99"><span class="linenos"> 99</span></a><span class="sd">        custom_metric: function, optional (default=None)</span>
</span><span id="LazyClassifier-100"><a href="#LazyClassifier-100"><span class="linenos">100</span></a><span class="sd">            When function is provided, models are evaluated based on the</span>
</span><span id="LazyClassifier-101"><a href="#LazyClassifier-101"><span class="linenos">101</span></a><span class="sd">            custom evaluation metric provided.</span>
</span><span id="LazyClassifier-102"><a href="#LazyClassifier-102"><span class="linenos">102</span></a>
</span><span id="LazyClassifier-103"><a href="#LazyClassifier-103"><span class="linenos">103</span></a><span class="sd">        predictions: bool, optional (default=False)</span>
</span><span id="LazyClassifier-104"><a href="#LazyClassifier-104"><span class="linenos">104</span></a><span class="sd">            When set to True, the predictions of all the models models are</span>
</span><span id="LazyClassifier-105"><a href="#LazyClassifier-105"><span class="linenos">105</span></a><span class="sd">            returned as data frame.</span>
</span><span id="LazyClassifier-106"><a href="#LazyClassifier-106"><span class="linenos">106</span></a>
</span><span id="LazyClassifier-107"><a href="#LazyClassifier-107"><span class="linenos">107</span></a><span class="sd">        sort_by: string, optional (default=&#39;Accuracy&#39;)</span>
</span><span id="LazyClassifier-108"><a href="#LazyClassifier-108"><span class="linenos">108</span></a><span class="sd">            Sort models by a metric. Available options are &#39;Accuracy&#39;,</span>
</span><span id="LazyClassifier-109"><a href="#LazyClassifier-109"><span class="linenos">109</span></a><span class="sd">            &#39;Balanced Accuracy&#39;, &#39;ROC AUC&#39;, &#39;F1 Score&#39; or a custom metric</span>
</span><span id="LazyClassifier-110"><a href="#LazyClassifier-110"><span class="linenos">110</span></a><span class="sd">            identified by its name and provided by custom_metric.</span>
</span><span id="LazyClassifier-111"><a href="#LazyClassifier-111"><span class="linenos">111</span></a>
</span><span id="LazyClassifier-112"><a href="#LazyClassifier-112"><span class="linenos">112</span></a><span class="sd">        random_state: int, optional (default=42)</span>
</span><span id="LazyClassifier-113"><a href="#LazyClassifier-113"><span class="linenos">113</span></a><span class="sd">            Reproducibiility seed.</span>
</span><span id="LazyClassifier-114"><a href="#LazyClassifier-114"><span class="linenos">114</span></a>
</span><span id="LazyClassifier-115"><a href="#LazyClassifier-115"><span class="linenos">115</span></a><span class="sd">        estimators: list, optional (default=&#39;all&#39;)</span>
</span><span id="LazyClassifier-116"><a href="#LazyClassifier-116"><span class="linenos">116</span></a><span class="sd">            list of Estimators names or just &#39;all&#39; for &gt; 90</span>
</span><span id="LazyClassifier-117"><a href="#LazyClassifier-117"><span class="linenos">117</span></a><span class="sd">            classifiers (default=&#39;all&#39;)</span>
</span><span id="LazyClassifier-118"><a href="#LazyClassifier-118"><span class="linenos">118</span></a>
</span><span id="LazyClassifier-119"><a href="#LazyClassifier-119"><span class="linenos">119</span></a><span class="sd">        preprocess: bool, preprocessing is done when set to True</span>
</span><span id="LazyClassifier-120"><a href="#LazyClassifier-120"><span class="linenos">120</span></a>
</span><span id="LazyClassifier-121"><a href="#LazyClassifier-121"><span class="linenos">121</span></a><span class="sd">        n_jobs: int, when possible, run in parallel</span>
</span><span id="LazyClassifier-122"><a href="#LazyClassifier-122"><span class="linenos">122</span></a><span class="sd">            For now, only used by individual models that support it.</span>
</span><span id="LazyClassifier-123"><a href="#LazyClassifier-123"><span class="linenos">123</span></a>
</span><span id="LazyClassifier-124"><a href="#LazyClassifier-124"><span class="linenos">124</span></a><span class="sd">        All the other parameters are the same as CustomClassifier&#39;s.</span>
</span><span id="LazyClassifier-125"><a href="#LazyClassifier-125"><span class="linenos">125</span></a>
</span><span id="LazyClassifier-126"><a href="#LazyClassifier-126"><span class="linenos">126</span></a><span class="sd">    Examples:</span>
</span><span id="LazyClassifier-127"><a href="#LazyClassifier-127"><span class="linenos">127</span></a>
</span><span id="LazyClassifier-128"><a href="#LazyClassifier-128"><span class="linenos">128</span></a><span class="sd">        ```python</span>
</span><span id="LazyClassifier-129"><a href="#LazyClassifier-129"><span class="linenos">129</span></a><span class="sd">        import nnetsauce as ns</span>
</span><span id="LazyClassifier-130"><a href="#LazyClassifier-130"><span class="linenos">130</span></a><span class="sd">        from sklearn.datasets import load_breast_cancer</span>
</span><span id="LazyClassifier-131"><a href="#LazyClassifier-131"><span class="linenos">131</span></a><span class="sd">        from sklearn.model_selection import train_test_split</span>
</span><span id="LazyClassifier-132"><a href="#LazyClassifier-132"><span class="linenos">132</span></a><span class="sd">        data = load_breast_cancer()</span>
</span><span id="LazyClassifier-133"><a href="#LazyClassifier-133"><span class="linenos">133</span></a><span class="sd">        X = data.data</span>
</span><span id="LazyClassifier-134"><a href="#LazyClassifier-134"><span class="linenos">134</span></a><span class="sd">        y= data.target</span>
</span><span id="LazyClassifier-135"><a href="#LazyClassifier-135"><span class="linenos">135</span></a><span class="sd">        X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=.2,</span>
</span><span id="LazyClassifier-136"><a href="#LazyClassifier-136"><span class="linenos">136</span></a><span class="sd">        random_state=123)</span>
</span><span id="LazyClassifier-137"><a href="#LazyClassifier-137"><span class="linenos">137</span></a><span class="sd">        clf = ns.LazyClassifier(verbose=0, ignore_warnings=True)</span>
</span><span id="LazyClassifier-138"><a href="#LazyClassifier-138"><span class="linenos">138</span></a><span class="sd">        models, predictions = clf.fit(X_train, X_test, y_train, y_test)</span>
</span><span id="LazyClassifier-139"><a href="#LazyClassifier-139"><span class="linenos">139</span></a><span class="sd">        model_dictionary = clf.provide_models(X_train,X_test,y_train,y_test)</span>
</span><span id="LazyClassifier-140"><a href="#LazyClassifier-140"><span class="linenos">140</span></a><span class="sd">        print(models)</span>
</span><span id="LazyClassifier-141"><a href="#LazyClassifier-141"><span class="linenos">141</span></a><span class="sd">        ```</span>
</span><span id="LazyClassifier-142"><a href="#LazyClassifier-142"><span class="linenos">142</span></a>
</span><span id="LazyClassifier-143"><a href="#LazyClassifier-143"><span class="linenos">143</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LazyClassifier-144"><a href="#LazyClassifier-144"><span class="linenos">144</span></a>
</span><span id="LazyClassifier-145"><a href="#LazyClassifier-145"><span class="linenos">145</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyClassifier-146"><a href="#LazyClassifier-146"><span class="linenos">146</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="LazyClassifier-147"><a href="#LazyClassifier-147"><span class="linenos">147</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyClassifier-148"><a href="#LazyClassifier-148"><span class="linenos">148</span></a>        <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyClassifier-149"><a href="#LazyClassifier-149"><span class="linenos">149</span></a>        <span class="n">custom_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyClassifier-150"><a href="#LazyClassifier-150"><span class="linenos">150</span></a>        <span class="n">predictions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyClassifier-151"><a href="#LazyClassifier-151"><span class="linenos">151</span></a>        <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-152"><a href="#LazyClassifier-152"><span class="linenos">152</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="LazyClassifier-153"><a href="#LazyClassifier-153"><span class="linenos">153</span></a>        <span class="n">estimators</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-154"><a href="#LazyClassifier-154"><span class="linenos">154</span></a>        <span class="n">preprocess</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyClassifier-155"><a href="#LazyClassifier-155"><span class="linenos">155</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyClassifier-156"><a href="#LazyClassifier-156"><span class="linenos">156</span></a>        <span class="c1"># CustomClassifier attributes</span>
</span><span id="LazyClassifier-157"><a href="#LazyClassifier-157"><span class="linenos">157</span></a>        <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyClassifier-158"><a href="#LazyClassifier-158"><span class="linenos">158</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="LazyClassifier-159"><a href="#LazyClassifier-159"><span class="linenos">159</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-160"><a href="#LazyClassifier-160"><span class="linenos">160</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="LazyClassifier-161"><a href="#LazyClassifier-161"><span class="linenos">161</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-162"><a href="#LazyClassifier-162"><span class="linenos">162</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyClassifier-163"><a href="#LazyClassifier-163"><span class="linenos">163</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyClassifier-164"><a href="#LazyClassifier-164"><span class="linenos">164</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyClassifier-165"><a href="#LazyClassifier-165"><span class="linenos">165</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="LazyClassifier-166"><a href="#LazyClassifier-166"><span class="linenos">166</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyClassifier-167"><a href="#LazyClassifier-167"><span class="linenos">167</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-168"><a href="#LazyClassifier-168"><span class="linenos">168</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="LazyClassifier-169"><a href="#LazyClassifier-169"><span class="linenos">169</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyClassifier-170"><a href="#LazyClassifier-170"><span class="linenos">170</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyClassifier-171"><a href="#LazyClassifier-171"><span class="linenos">171</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="LazyClassifier-172"><a href="#LazyClassifier-172"><span class="linenos">172</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-173"><a href="#LazyClassifier-173"><span class="linenos">173</span></a>    <span class="p">):</span>
</span><span id="LazyClassifier-174"><a href="#LazyClassifier-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="LazyClassifier-175"><a href="#LazyClassifier-175"><span class="linenos">175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="o">=</span> <span class="n">ignore_warnings</span>
</span><span id="LazyClassifier-176"><a href="#LazyClassifier-176"><span class="linenos">176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="o">=</span> <span class="n">custom_metric</span>
</span><span id="LazyClassifier-177"><a href="#LazyClassifier-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span>
</span><span id="LazyClassifier-178"><a href="#LazyClassifier-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sort_by</span> <span class="o">=</span> <span class="n">sort_by</span>
</span><span id="LazyClassifier-179"><a href="#LazyClassifier-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyClassifier-180"><a href="#LazyClassifier-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="LazyClassifier-181"><a href="#LazyClassifier-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">=</span> <span class="n">estimators</span>
</span><span id="LazyClassifier-182"><a href="#LazyClassifier-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="o">=</span> <span class="n">preprocess</span>
</span><span id="LazyClassifier-183"><a href="#LazyClassifier-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="LazyClassifier-184"><a href="#LazyClassifier-184"><span class="linenos">184</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyClassifier-185"><a href="#LazyClassifier-185"><span class="linenos">185</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="LazyClassifier-186"><a href="#LazyClassifier-186"><span class="linenos">186</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier-187"><a href="#LazyClassifier-187"><span class="linenos">187</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier-188"><a href="#LazyClassifier-188"><span class="linenos">188</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier-189"><a href="#LazyClassifier-189"><span class="linenos">189</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier-190"><a href="#LazyClassifier-190"><span class="linenos">190</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier-191"><a href="#LazyClassifier-191"><span class="linenos">191</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier-192"><a href="#LazyClassifier-192"><span class="linenos">192</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier-193"><a href="#LazyClassifier-193"><span class="linenos">193</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier-194"><a href="#LazyClassifier-194"><span class="linenos">194</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier-195"><a href="#LazyClassifier-195"><span class="linenos">195</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier-196"><a href="#LazyClassifier-196"><span class="linenos">196</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier-197"><a href="#LazyClassifier-197"><span class="linenos">197</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-198"><a href="#LazyClassifier-198"><span class="linenos">198</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-199"><a href="#LazyClassifier-199"><span class="linenos">199</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier-200"><a href="#LazyClassifier-200"><span class="linenos">200</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier-201"><a href="#LazyClassifier-201"><span class="linenos">201</span></a>        <span class="p">)</span>
</span><span id="LazyClassifier-202"><a href="#LazyClassifier-202"><span class="linenos">202</span></a>
</span><span id="LazyClassifier-203"><a href="#LazyClassifier-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyClassifier-204"><a href="#LazyClassifier-204"><span class="linenos">204</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit classifiers to X_train and y_train, predict and score on X_test,</span>
</span><span id="LazyClassifier-205"><a href="#LazyClassifier-205"><span class="linenos">205</span></a><span class="sd">        y_test.</span>
</span><span id="LazyClassifier-206"><a href="#LazyClassifier-206"><span class="linenos">206</span></a>
</span><span id="LazyClassifier-207"><a href="#LazyClassifier-207"><span class="linenos">207</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyClassifier-208"><a href="#LazyClassifier-208"><span class="linenos">208</span></a>
</span><span id="LazyClassifier-209"><a href="#LazyClassifier-209"><span class="linenos">209</span></a><span class="sd">            X_train: array-like,</span>
</span><span id="LazyClassifier-210"><a href="#LazyClassifier-210"><span class="linenos">210</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier-211"><a href="#LazyClassifier-211"><span class="linenos">211</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyClassifier-212"><a href="#LazyClassifier-212"><span class="linenos">212</span></a>
</span><span id="LazyClassifier-213"><a href="#LazyClassifier-213"><span class="linenos">213</span></a><span class="sd">            X_test: array-like,</span>
</span><span id="LazyClassifier-214"><a href="#LazyClassifier-214"><span class="linenos">214</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier-215"><a href="#LazyClassifier-215"><span class="linenos">215</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyClassifier-216"><a href="#LazyClassifier-216"><span class="linenos">216</span></a>
</span><span id="LazyClassifier-217"><a href="#LazyClassifier-217"><span class="linenos">217</span></a><span class="sd">            y_train: array-like,</span>
</span><span id="LazyClassifier-218"><a href="#LazyClassifier-218"><span class="linenos">218</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier-219"><a href="#LazyClassifier-219"><span class="linenos">219</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyClassifier-220"><a href="#LazyClassifier-220"><span class="linenos">220</span></a>
</span><span id="LazyClassifier-221"><a href="#LazyClassifier-221"><span class="linenos">221</span></a><span class="sd">            y_test: array-like,</span>
</span><span id="LazyClassifier-222"><a href="#LazyClassifier-222"><span class="linenos">222</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier-223"><a href="#LazyClassifier-223"><span class="linenos">223</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyClassifier-224"><a href="#LazyClassifier-224"><span class="linenos">224</span></a>
</span><span id="LazyClassifier-225"><a href="#LazyClassifier-225"><span class="linenos">225</span></a><span class="sd">        Returns:</span>
</span><span id="LazyClassifier-226"><a href="#LazyClassifier-226"><span class="linenos">226</span></a>
</span><span id="LazyClassifier-227"><a href="#LazyClassifier-227"><span class="linenos">227</span></a><span class="sd">            scores: Pandas DataFrame</span>
</span><span id="LazyClassifier-228"><a href="#LazyClassifier-228"><span class="linenos">228</span></a><span class="sd">                Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyClassifier-229"><a href="#LazyClassifier-229"><span class="linenos">229</span></a>
</span><span id="LazyClassifier-230"><a href="#LazyClassifier-230"><span class="linenos">230</span></a><span class="sd">            predictions: Pandas DataFrame</span>
</span><span id="LazyClassifier-231"><a href="#LazyClassifier-231"><span class="linenos">231</span></a><span class="sd">                Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyClassifier-232"><a href="#LazyClassifier-232"><span class="linenos">232</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyClassifier-233"><a href="#LazyClassifier-233"><span class="linenos">233</span></a>        <span class="n">Accuracy</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier-234"><a href="#LazyClassifier-234"><span class="linenos">234</span></a>        <span class="n">B_Accuracy</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier-235"><a href="#LazyClassifier-235"><span class="linenos">235</span></a>        <span class="n">ROC_AUC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier-236"><a href="#LazyClassifier-236"><span class="linenos">236</span></a>        <span class="n">F1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier-237"><a href="#LazyClassifier-237"><span class="linenos">237</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier-238"><a href="#LazyClassifier-238"><span class="linenos">238</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier-239"><a href="#LazyClassifier-239"><span class="linenos">239</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyClassifier-240"><a href="#LazyClassifier-240"><span class="linenos">240</span></a>
</span><span id="LazyClassifier-241"><a href="#LazyClassifier-241"><span class="linenos">241</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier-242"><a href="#LazyClassifier-242"><span class="linenos">242</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier-243"><a href="#LazyClassifier-243"><span class="linenos">243</span></a>
</span><span id="LazyClassifier-244"><a href="#LazyClassifier-244"><span class="linenos">244</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyClassifier-245"><a href="#LazyClassifier-245"><span class="linenos">245</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyClassifier-246"><a href="#LazyClassifier-246"><span class="linenos">246</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyClassifier-247"><a href="#LazyClassifier-247"><span class="linenos">247</span></a>
</span><span id="LazyClassifier-248"><a href="#LazyClassifier-248"><span class="linenos">248</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyClassifier-249"><a href="#LazyClassifier-249"><span class="linenos">249</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyClassifier-250"><a href="#LazyClassifier-250"><span class="linenos">250</span></a>
</span><span id="LazyClassifier-251"><a href="#LazyClassifier-251"><span class="linenos">251</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyClassifier-252"><a href="#LazyClassifier-252"><span class="linenos">252</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyClassifier-253"><a href="#LazyClassifier-253"><span class="linenos">253</span></a>        <span class="p">)</span>
</span><span id="LazyClassifier-254"><a href="#LazyClassifier-254"><span class="linenos">254</span></a>
</span><span id="LazyClassifier-255"><a href="#LazyClassifier-255"><span class="linenos">255</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyClassifier-256"><a href="#LazyClassifier-256"><span class="linenos">256</span></a>
</span><span id="LazyClassifier-257"><a href="#LazyClassifier-257"><span class="linenos">257</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyClassifier-258"><a href="#LazyClassifier-258"><span class="linenos">258</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyClassifier-259"><a href="#LazyClassifier-259"><span class="linenos">259</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyClassifier-260"><a href="#LazyClassifier-260"><span class="linenos">260</span></a>                    <span class="p">(</span>
</span><span id="LazyClassifier-261"><a href="#LazyClassifier-261"><span class="linenos">261</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-262"><a href="#LazyClassifier-262"><span class="linenos">262</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyClassifier-263"><a href="#LazyClassifier-263"><span class="linenos">263</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyClassifier-264"><a href="#LazyClassifier-264"><span class="linenos">264</span></a>                    <span class="p">),</span>
</span><span id="LazyClassifier-265"><a href="#LazyClassifier-265"><span class="linenos">265</span></a>                    <span class="p">(</span>
</span><span id="LazyClassifier-266"><a href="#LazyClassifier-266"><span class="linenos">266</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-267"><a href="#LazyClassifier-267"><span class="linenos">267</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyClassifier-268"><a href="#LazyClassifier-268"><span class="linenos">268</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyClassifier-269"><a href="#LazyClassifier-269"><span class="linenos">269</span></a>                    <span class="p">),</span>
</span><span id="LazyClassifier-270"><a href="#LazyClassifier-270"><span class="linenos">270</span></a>                <span class="p">]</span>
</span><span id="LazyClassifier-271"><a href="#LazyClassifier-271"><span class="linenos">271</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier-272"><a href="#LazyClassifier-272"><span class="linenos">272</span></a>
</span><span id="LazyClassifier-273"><a href="#LazyClassifier-273"><span class="linenos">273</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyClassifier-274"><a href="#LazyClassifier-274"><span class="linenos">274</span></a>
</span><span id="LazyClassifier-275"><a href="#LazyClassifier-275"><span class="linenos">275</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyClassifier-276"><a href="#LazyClassifier-276"><span class="linenos">276</span></a>                <span class="n">CLASSIFIERS</span> <span class="o">+</span> <span class="n">MULTITASKCLASSIFIERS</span> <span class="o">+</span> <span class="n">SIMPLEMULTITASKCLASSIFIERS</span>
</span><span id="LazyClassifier-277"><a href="#LazyClassifier-277"><span class="linenos">277</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier-278"><a href="#LazyClassifier-278"><span class="linenos">278</span></a>
</span><span id="LazyClassifier-279"><a href="#LazyClassifier-279"><span class="linenos">279</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># list custom estimators, by their names</span>
</span><span id="LazyClassifier-280"><a href="#LazyClassifier-280"><span class="linenos">280</span></a>
</span><span id="LazyClassifier-281"><a href="#LazyClassifier-281"><span class="linenos">281</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyClassifier-282"><a href="#LazyClassifier-282"><span class="linenos">282</span></a>                <span class="p">[</span>
</span><span id="LazyClassifier-283"><a href="#LazyClassifier-283"><span class="linenos">283</span></a>                    <span class="p">(</span><span class="s2">&quot;CustomClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyClassifier-284"><a href="#LazyClassifier-284"><span class="linenos">284</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyClassifier-285"><a href="#LazyClassifier-285"><span class="linenos">285</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier-286"><a href="#LazyClassifier-286"><span class="linenos">286</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ClassifierMixin</span><span class="p">)</span>
</span><span id="LazyClassifier-287"><a href="#LazyClassifier-287"><span class="linenos">287</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyClassifier-288"><a href="#LazyClassifier-288"><span class="linenos">288</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier-289"><a href="#LazyClassifier-289"><span class="linenos">289</span></a>                <span class="p">]</span>
</span><span id="LazyClassifier-290"><a href="#LazyClassifier-290"><span class="linenos">290</span></a>                <span class="o">+</span> <span class="p">[</span>
</span><span id="LazyClassifier-291"><a href="#LazyClassifier-291"><span class="linenos">291</span></a>                    <span class="p">(</span>
</span><span id="LazyClassifier-292"><a href="#LazyClassifier-292"><span class="linenos">292</span></a>                        <span class="s2">&quot;MultitaskClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-293"><a href="#LazyClassifier-293"><span class="linenos">293</span></a>                        <span class="n">partial</span><span class="p">(</span><span class="n">MultitaskClassifier</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">]()),</span>
</span><span id="LazyClassifier-294"><a href="#LazyClassifier-294"><span class="linenos">294</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier-295"><a href="#LazyClassifier-295"><span class="linenos">295</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyClassifier-296"><a href="#LazyClassifier-296"><span class="linenos">296</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier-297"><a href="#LazyClassifier-297"><span class="linenos">297</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyClassifier-298"><a href="#LazyClassifier-298"><span class="linenos">298</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyClassifier-299"><a href="#LazyClassifier-299"><span class="linenos">299</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier-300"><a href="#LazyClassifier-300"><span class="linenos">300</span></a>                <span class="p">]</span>
</span><span id="LazyClassifier-301"><a href="#LazyClassifier-301"><span class="linenos">301</span></a>                <span class="o">+</span> <span class="p">[</span>
</span><span id="LazyClassifier-302"><a href="#LazyClassifier-302"><span class="linenos">302</span></a>                    <span class="p">(</span>
</span><span id="LazyClassifier-303"><a href="#LazyClassifier-303"><span class="linenos">303</span></a>                        <span class="s2">&quot;SimpleMultitaskClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-304"><a href="#LazyClassifier-304"><span class="linenos">304</span></a>                        <span class="n">partial</span><span class="p">(</span><span class="n">SimpleMultitaskClassifier</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">]()),</span>
</span><span id="LazyClassifier-305"><a href="#LazyClassifier-305"><span class="linenos">305</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier-306"><a href="#LazyClassifier-306"><span class="linenos">306</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyClassifier-307"><a href="#LazyClassifier-307"><span class="linenos">307</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier-308"><a href="#LazyClassifier-308"><span class="linenos">308</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyClassifier-309"><a href="#LazyClassifier-309"><span class="linenos">309</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyClassifier-310"><a href="#LazyClassifier-310"><span class="linenos">310</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier-311"><a href="#LazyClassifier-311"><span class="linenos">311</span></a>                <span class="p">]</span>
</span><span id="LazyClassifier-312"><a href="#LazyClassifier-312"><span class="linenos">312</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier-313"><a href="#LazyClassifier-313"><span class="linenos">313</span></a>
</span><span id="LazyClassifier-314"><a href="#LazyClassifier-314"><span class="linenos">314</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyClassifier-315"><a href="#LazyClassifier-315"><span class="linenos">315</span></a>
</span><span id="LazyClassifier-316"><a href="#LazyClassifier-316"><span class="linenos">316</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyClassifier-317"><a href="#LazyClassifier-317"><span class="linenos">317</span></a>
</span><span id="LazyClassifier-318"><a href="#LazyClassifier-318"><span class="linenos">318</span></a>                <span class="n">other_args</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyClassifier-319"><a href="#LazyClassifier-319"><span class="linenos">319</span></a>                    <span class="p">{}</span>
</span><span id="LazyClassifier-320"><a href="#LazyClassifier-320"><span class="linenos">320</span></a>                <span class="p">)</span>  <span class="c1"># use this trick for `random_state` too --&gt; refactor</span>
</span><span id="LazyClassifier-321"><a href="#LazyClassifier-321"><span class="linenos">321</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier-322"><a href="#LazyClassifier-322"><span class="linenos">322</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier-323"><a href="#LazyClassifier-323"><span class="linenos">323</span></a>                        <span class="s2">&quot;n_jobs&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="LazyClassifier-324"><a href="#LazyClassifier-324"><span class="linenos">324</span></a>                        <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;LogisticRegression&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="LazyClassifier-325"><a href="#LazyClassifier-325"><span class="linenos">325</span></a>                    <span class="p">):</span>
</span><span id="LazyClassifier-326"><a href="#LazyClassifier-326"><span class="linenos">326</span></a>                        <span class="n">other_args</span><span class="p">[</span><span class="s2">&quot;n_jobs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span>
</span><span id="LazyClassifier-327"><a href="#LazyClassifier-327"><span class="linenos">327</span></a>                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="LazyClassifier-328"><a href="#LazyClassifier-328"><span class="linenos">328</span></a>                    <span class="k">pass</span>
</span><span id="LazyClassifier-329"><a href="#LazyClassifier-329"><span class="linenos">329</span></a>
</span><span id="LazyClassifier-330"><a href="#LazyClassifier-330"><span class="linenos">330</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyClassifier-331"><a href="#LazyClassifier-331"><span class="linenos">331</span></a>
</span><span id="LazyClassifier-332"><a href="#LazyClassifier-332"><span class="linenos">332</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier-333"><a href="#LazyClassifier-333"><span class="linenos">333</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyClassifier-334"><a href="#LazyClassifier-334"><span class="linenos">334</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyClassifier-335"><a href="#LazyClassifier-335"><span class="linenos">335</span></a>                            <span class="p">[</span>
</span><span id="LazyClassifier-336"><a href="#LazyClassifier-336"><span class="linenos">336</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyClassifier-337"><a href="#LazyClassifier-337"><span class="linenos">337</span></a>                                <span class="p">(</span>
</span><span id="LazyClassifier-338"><a href="#LazyClassifier-338"><span class="linenos">338</span></a>                                    <span class="s2">&quot;classifier&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-339"><a href="#LazyClassifier-339"><span class="linenos">339</span></a>                                    <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyClassifier-340"><a href="#LazyClassifier-340"><span class="linenos">340</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyClassifier-341"><a href="#LazyClassifier-341"><span class="linenos">341</span></a>                                            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="LazyClassifier-342"><a href="#LazyClassifier-342"><span class="linenos">342</span></a>                                            <span class="o">**</span><span class="n">other_args</span>
</span><span id="LazyClassifier-343"><a href="#LazyClassifier-343"><span class="linenos">343</span></a>                                        <span class="p">),</span>
</span><span id="LazyClassifier-344"><a href="#LazyClassifier-344"><span class="linenos">344</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier-345"><a href="#LazyClassifier-345"><span class="linenos">345</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier-346"><a href="#LazyClassifier-346"><span class="linenos">346</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier-347"><a href="#LazyClassifier-347"><span class="linenos">347</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier-348"><a href="#LazyClassifier-348"><span class="linenos">348</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier-349"><a href="#LazyClassifier-349"><span class="linenos">349</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier-350"><a href="#LazyClassifier-350"><span class="linenos">350</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier-351"><a href="#LazyClassifier-351"><span class="linenos">351</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier-352"><a href="#LazyClassifier-352"><span class="linenos">352</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier-353"><a href="#LazyClassifier-353"><span class="linenos">353</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier-354"><a href="#LazyClassifier-354"><span class="linenos">354</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier-355"><a href="#LazyClassifier-355"><span class="linenos">355</span></a>                                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-356"><a href="#LazyClassifier-356"><span class="linenos">356</span></a>                                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-357"><a href="#LazyClassifier-357"><span class="linenos">357</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier-358"><a href="#LazyClassifier-358"><span class="linenos">358</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier-359"><a href="#LazyClassifier-359"><span class="linenos">359</span></a>                                    <span class="p">),</span>
</span><span id="LazyClassifier-360"><a href="#LazyClassifier-360"><span class="linenos">360</span></a>                                <span class="p">),</span>
</span><span id="LazyClassifier-361"><a href="#LazyClassifier-361"><span class="linenos">361</span></a>                            <span class="p">]</span>
</span><span id="LazyClassifier-362"><a href="#LazyClassifier-362"><span class="linenos">362</span></a>                        <span class="p">)</span>
</span><span id="LazyClassifier-363"><a href="#LazyClassifier-363"><span class="linenos">363</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier-364"><a href="#LazyClassifier-364"><span class="linenos">364</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyClassifier-365"><a href="#LazyClassifier-365"><span class="linenos">365</span></a>                            <span class="p">[</span>
</span><span id="LazyClassifier-366"><a href="#LazyClassifier-366"><span class="linenos">366</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyClassifier-367"><a href="#LazyClassifier-367"><span class="linenos">367</span></a>                                <span class="p">(</span>
</span><span id="LazyClassifier-368"><a href="#LazyClassifier-368"><span class="linenos">368</span></a>                                    <span class="s2">&quot;classifier&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-369"><a href="#LazyClassifier-369"><span class="linenos">369</span></a>                                    <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyClassifier-370"><a href="#LazyClassifier-370"><span class="linenos">370</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">other_args</span><span class="p">),</span>
</span><span id="LazyClassifier-371"><a href="#LazyClassifier-371"><span class="linenos">371</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier-372"><a href="#LazyClassifier-372"><span class="linenos">372</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier-373"><a href="#LazyClassifier-373"><span class="linenos">373</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier-374"><a href="#LazyClassifier-374"><span class="linenos">374</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier-375"><a href="#LazyClassifier-375"><span class="linenos">375</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier-376"><a href="#LazyClassifier-376"><span class="linenos">376</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier-377"><a href="#LazyClassifier-377"><span class="linenos">377</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier-378"><a href="#LazyClassifier-378"><span class="linenos">378</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier-379"><a href="#LazyClassifier-379"><span class="linenos">379</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier-380"><a href="#LazyClassifier-380"><span class="linenos">380</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier-381"><a href="#LazyClassifier-381"><span class="linenos">381</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier-382"><a href="#LazyClassifier-382"><span class="linenos">382</span></a>                                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-383"><a href="#LazyClassifier-383"><span class="linenos">383</span></a>                                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-384"><a href="#LazyClassifier-384"><span class="linenos">384</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier-385"><a href="#LazyClassifier-385"><span class="linenos">385</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier-386"><a href="#LazyClassifier-386"><span class="linenos">386</span></a>                                    <span class="p">),</span>
</span><span id="LazyClassifier-387"><a href="#LazyClassifier-387"><span class="linenos">387</span></a>                                <span class="p">),</span>
</span><span id="LazyClassifier-388"><a href="#LazyClassifier-388"><span class="linenos">388</span></a>                            <span class="p">]</span>
</span><span id="LazyClassifier-389"><a href="#LazyClassifier-389"><span class="linenos">389</span></a>                        <span class="p">)</span>
</span><span id="LazyClassifier-390"><a href="#LazyClassifier-390"><span class="linenos">390</span></a>
</span><span id="LazyClassifier-391"><a href="#LazyClassifier-391"><span class="linenos">391</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyClassifier-392"><a href="#LazyClassifier-392"><span class="linenos">392</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyClassifier-393"><a href="#LazyClassifier-393"><span class="linenos">393</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyClassifier-394"><a href="#LazyClassifier-394"><span class="linenos">394</span></a>                    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="LazyClassifier-395"><a href="#LazyClassifier-395"><span class="linenos">395</span></a>                    <span class="n">b_accuracy</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier-396"><a href="#LazyClassifier-396"><span class="linenos">396</span></a>                    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
</span><span id="LazyClassifier-397"><a href="#LazyClassifier-397"><span class="linenos">397</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier-398"><a href="#LazyClassifier-398"><span class="linenos">398</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier-399"><a href="#LazyClassifier-399"><span class="linenos">399</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier-400"><a href="#LazyClassifier-400"><span class="linenos">400</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LazyClassifier-401"><a href="#LazyClassifier-401"><span class="linenos">401</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyClassifier-402"><a href="#LazyClassifier-402"><span class="linenos">402</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROC AUC couldn&#39;t be calculated for &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
</span><span id="LazyClassifier-403"><a href="#LazyClassifier-403"><span class="linenos">403</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyClassifier-404"><a href="#LazyClassifier-404"><span class="linenos">404</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyClassifier-405"><a href="#LazyClassifier-405"><span class="linenos">405</span></a>                    <span class="n">Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</span><span id="LazyClassifier-406"><a href="#LazyClassifier-406"><span class="linenos">406</span></a>                    <span class="n">B_Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_accuracy</span><span class="p">)</span>
</span><span id="LazyClassifier-407"><a href="#LazyClassifier-407"><span class="linenos">407</span></a>                    <span class="n">ROC_AUC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">)</span>
</span><span id="LazyClassifier-408"><a href="#LazyClassifier-408"><span class="linenos">408</span></a>                    <span class="n">F1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="LazyClassifier-409"><a href="#LazyClassifier-409"><span class="linenos">409</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyClassifier-410"><a href="#LazyClassifier-410"><span class="linenos">410</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier-411"><a href="#LazyClassifier-411"><span class="linenos">411</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier-412"><a href="#LazyClassifier-412"><span class="linenos">412</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyClassifier-413"><a href="#LazyClassifier-413"><span class="linenos">413</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyClassifier-414"><a href="#LazyClassifier-414"><span class="linenos">414</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier-415"><a href="#LazyClassifier-415"><span class="linenos">415</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyClassifier-416"><a href="#LazyClassifier-416"><span class="linenos">416</span></a>                                <span class="p">{</span>
</span><span id="LazyClassifier-417"><a href="#LazyClassifier-417"><span class="linenos">417</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyClassifier-418"><a href="#LazyClassifier-418"><span class="linenos">418</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-419"><a href="#LazyClassifier-419"><span class="linenos">419</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-420"><a href="#LazyClassifier-420"><span class="linenos">420</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyClassifier-421"><a href="#LazyClassifier-421"><span class="linenos">421</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyClassifier-422"><a href="#LazyClassifier-422"><span class="linenos">422</span></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">custom_metric</span><span class="p">,</span>
</span><span id="LazyClassifier-423"><a href="#LazyClassifier-423"><span class="linenos">423</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyClassifier-424"><a href="#LazyClassifier-424"><span class="linenos">424</span></a>                                <span class="p">}</span>
</span><span id="LazyClassifier-425"><a href="#LazyClassifier-425"><span class="linenos">425</span></a>                            <span class="p">)</span>
</span><span id="LazyClassifier-426"><a href="#LazyClassifier-426"><span class="linenos">426</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier-427"><a href="#LazyClassifier-427"><span class="linenos">427</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyClassifier-428"><a href="#LazyClassifier-428"><span class="linenos">428</span></a>                                <span class="p">{</span>
</span><span id="LazyClassifier-429"><a href="#LazyClassifier-429"><span class="linenos">429</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyClassifier-430"><a href="#LazyClassifier-430"><span class="linenos">430</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-431"><a href="#LazyClassifier-431"><span class="linenos">431</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-432"><a href="#LazyClassifier-432"><span class="linenos">432</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyClassifier-433"><a href="#LazyClassifier-433"><span class="linenos">433</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyClassifier-434"><a href="#LazyClassifier-434"><span class="linenos">434</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyClassifier-435"><a href="#LazyClassifier-435"><span class="linenos">435</span></a>                                <span class="p">}</span>
</span><span id="LazyClassifier-436"><a href="#LazyClassifier-436"><span class="linenos">436</span></a>                            <span class="p">)</span>
</span><span id="LazyClassifier-437"><a href="#LazyClassifier-437"><span class="linenos">437</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyClassifier-438"><a href="#LazyClassifier-438"><span class="linenos">438</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyClassifier-439"><a href="#LazyClassifier-439"><span class="linenos">439</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier-440"><a href="#LazyClassifier-440"><span class="linenos">440</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier-441"><a href="#LazyClassifier-441"><span class="linenos">441</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyClassifier-442"><a href="#LazyClassifier-442"><span class="linenos">442</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyClassifier-443"><a href="#LazyClassifier-443"><span class="linenos">443</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyClassifier-444"><a href="#LazyClassifier-444"><span class="linenos">444</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier-445"><a href="#LazyClassifier-445"><span class="linenos">445</span></a>                        <span class="k">pass</span>
</span><span id="LazyClassifier-446"><a href="#LazyClassifier-446"><span class="linenos">446</span></a>
</span><span id="LazyClassifier-447"><a href="#LazyClassifier-447"><span class="linenos">447</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if self.preprocess is False:</span>
</span><span id="LazyClassifier-448"><a href="#LazyClassifier-448"><span class="linenos">448</span></a>
</span><span id="LazyClassifier-449"><a href="#LazyClassifier-449"><span class="linenos">449</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyClassifier-450"><a href="#LazyClassifier-450"><span class="linenos">450</span></a>                <span class="n">other_args</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyClassifier-451"><a href="#LazyClassifier-451"><span class="linenos">451</span></a>                    <span class="p">{}</span>
</span><span id="LazyClassifier-452"><a href="#LazyClassifier-452"><span class="linenos">452</span></a>                <span class="p">)</span>  <span class="c1"># use this trick for `random_state` too --&gt; refactor</span>
</span><span id="LazyClassifier-453"><a href="#LazyClassifier-453"><span class="linenos">453</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier-454"><a href="#LazyClassifier-454"><span class="linenos">454</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier-455"><a href="#LazyClassifier-455"><span class="linenos">455</span></a>                        <span class="s2">&quot;n_jobs&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="LazyClassifier-456"><a href="#LazyClassifier-456"><span class="linenos">456</span></a>                        <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;LogisticRegression&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="LazyClassifier-457"><a href="#LazyClassifier-457"><span class="linenos">457</span></a>                    <span class="p">):</span>
</span><span id="LazyClassifier-458"><a href="#LazyClassifier-458"><span class="linenos">458</span></a>                        <span class="n">other_args</span><span class="p">[</span><span class="s2">&quot;n_jobs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span>
</span><span id="LazyClassifier-459"><a href="#LazyClassifier-459"><span class="linenos">459</span></a>                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="LazyClassifier-460"><a href="#LazyClassifier-460"><span class="linenos">460</span></a>                    <span class="k">pass</span>
</span><span id="LazyClassifier-461"><a href="#LazyClassifier-461"><span class="linenos">461</span></a>
</span><span id="LazyClassifier-462"><a href="#LazyClassifier-462"><span class="linenos">462</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyClassifier-463"><a href="#LazyClassifier-463"><span class="linenos">463</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier-464"><a href="#LazyClassifier-464"><span class="linenos">464</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyClassifier-465"><a href="#LazyClassifier-465"><span class="linenos">465</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyClassifier-466"><a href="#LazyClassifier-466"><span class="linenos">466</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyClassifier-467"><a href="#LazyClassifier-467"><span class="linenos">467</span></a>                                <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span> <span class="o">**</span><span class="n">other_args</span>
</span><span id="LazyClassifier-468"><a href="#LazyClassifier-468"><span class="linenos">468</span></a>                            <span class="p">),</span>
</span><span id="LazyClassifier-469"><a href="#LazyClassifier-469"><span class="linenos">469</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier-470"><a href="#LazyClassifier-470"><span class="linenos">470</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier-471"><a href="#LazyClassifier-471"><span class="linenos">471</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier-472"><a href="#LazyClassifier-472"><span class="linenos">472</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier-473"><a href="#LazyClassifier-473"><span class="linenos">473</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier-474"><a href="#LazyClassifier-474"><span class="linenos">474</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier-475"><a href="#LazyClassifier-475"><span class="linenos">475</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier-476"><a href="#LazyClassifier-476"><span class="linenos">476</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier-477"><a href="#LazyClassifier-477"><span class="linenos">477</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier-478"><a href="#LazyClassifier-478"><span class="linenos">478</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier-479"><a href="#LazyClassifier-479"><span class="linenos">479</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier-480"><a href="#LazyClassifier-480"><span class="linenos">480</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-481"><a href="#LazyClassifier-481"><span class="linenos">481</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-482"><a href="#LazyClassifier-482"><span class="linenos">482</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier-483"><a href="#LazyClassifier-483"><span class="linenos">483</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier-484"><a href="#LazyClassifier-484"><span class="linenos">484</span></a>                        <span class="p">)</span>
</span><span id="LazyClassifier-485"><a href="#LazyClassifier-485"><span class="linenos">485</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier-486"><a href="#LazyClassifier-486"><span class="linenos">486</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyClassifier-487"><a href="#LazyClassifier-487"><span class="linenos">487</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">other_args</span><span class="p">),</span>
</span><span id="LazyClassifier-488"><a href="#LazyClassifier-488"><span class="linenos">488</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier-489"><a href="#LazyClassifier-489"><span class="linenos">489</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier-490"><a href="#LazyClassifier-490"><span class="linenos">490</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier-491"><a href="#LazyClassifier-491"><span class="linenos">491</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier-492"><a href="#LazyClassifier-492"><span class="linenos">492</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier-493"><a href="#LazyClassifier-493"><span class="linenos">493</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier-494"><a href="#LazyClassifier-494"><span class="linenos">494</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier-495"><a href="#LazyClassifier-495"><span class="linenos">495</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier-496"><a href="#LazyClassifier-496"><span class="linenos">496</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier-497"><a href="#LazyClassifier-497"><span class="linenos">497</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier-498"><a href="#LazyClassifier-498"><span class="linenos">498</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier-499"><a href="#LazyClassifier-499"><span class="linenos">499</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-500"><a href="#LazyClassifier-500"><span class="linenos">500</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-501"><a href="#LazyClassifier-501"><span class="linenos">501</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier-502"><a href="#LazyClassifier-502"><span class="linenos">502</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier-503"><a href="#LazyClassifier-503"><span class="linenos">503</span></a>                        <span class="p">)</span>
</span><span id="LazyClassifier-504"><a href="#LazyClassifier-504"><span class="linenos">504</span></a>
</span><span id="LazyClassifier-505"><a href="#LazyClassifier-505"><span class="linenos">505</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyClassifier-506"><a href="#LazyClassifier-506"><span class="linenos">506</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyClassifier-507"><a href="#LazyClassifier-507"><span class="linenos">507</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyClassifier-508"><a href="#LazyClassifier-508"><span class="linenos">508</span></a>                    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="LazyClassifier-509"><a href="#LazyClassifier-509"><span class="linenos">509</span></a>                    <span class="n">b_accuracy</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier-510"><a href="#LazyClassifier-510"><span class="linenos">510</span></a>                    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
</span><span id="LazyClassifier-511"><a href="#LazyClassifier-511"><span class="linenos">511</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier-512"><a href="#LazyClassifier-512"><span class="linenos">512</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier-513"><a href="#LazyClassifier-513"><span class="linenos">513</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier-514"><a href="#LazyClassifier-514"><span class="linenos">514</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LazyClassifier-515"><a href="#LazyClassifier-515"><span class="linenos">515</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyClassifier-516"><a href="#LazyClassifier-516"><span class="linenos">516</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROC AUC couldn&#39;t be calculated for &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
</span><span id="LazyClassifier-517"><a href="#LazyClassifier-517"><span class="linenos">517</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyClassifier-518"><a href="#LazyClassifier-518"><span class="linenos">518</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyClassifier-519"><a href="#LazyClassifier-519"><span class="linenos">519</span></a>                    <span class="n">Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</span><span id="LazyClassifier-520"><a href="#LazyClassifier-520"><span class="linenos">520</span></a>                    <span class="n">B_Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_accuracy</span><span class="p">)</span>
</span><span id="LazyClassifier-521"><a href="#LazyClassifier-521"><span class="linenos">521</span></a>                    <span class="n">ROC_AUC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">)</span>
</span><span id="LazyClassifier-522"><a href="#LazyClassifier-522"><span class="linenos">522</span></a>                    <span class="n">F1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="LazyClassifier-523"><a href="#LazyClassifier-523"><span class="linenos">523</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyClassifier-524"><a href="#LazyClassifier-524"><span class="linenos">524</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier-525"><a href="#LazyClassifier-525"><span class="linenos">525</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier-526"><a href="#LazyClassifier-526"><span class="linenos">526</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyClassifier-527"><a href="#LazyClassifier-527"><span class="linenos">527</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyClassifier-528"><a href="#LazyClassifier-528"><span class="linenos">528</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier-529"><a href="#LazyClassifier-529"><span class="linenos">529</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyClassifier-530"><a href="#LazyClassifier-530"><span class="linenos">530</span></a>                                <span class="p">{</span>
</span><span id="LazyClassifier-531"><a href="#LazyClassifier-531"><span class="linenos">531</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyClassifier-532"><a href="#LazyClassifier-532"><span class="linenos">532</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-533"><a href="#LazyClassifier-533"><span class="linenos">533</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-534"><a href="#LazyClassifier-534"><span class="linenos">534</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyClassifier-535"><a href="#LazyClassifier-535"><span class="linenos">535</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyClassifier-536"><a href="#LazyClassifier-536"><span class="linenos">536</span></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">custom_metric</span><span class="p">,</span>
</span><span id="LazyClassifier-537"><a href="#LazyClassifier-537"><span class="linenos">537</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyClassifier-538"><a href="#LazyClassifier-538"><span class="linenos">538</span></a>                                <span class="p">}</span>
</span><span id="LazyClassifier-539"><a href="#LazyClassifier-539"><span class="linenos">539</span></a>                            <span class="p">)</span>
</span><span id="LazyClassifier-540"><a href="#LazyClassifier-540"><span class="linenos">540</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier-541"><a href="#LazyClassifier-541"><span class="linenos">541</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyClassifier-542"><a href="#LazyClassifier-542"><span class="linenos">542</span></a>                                <span class="p">{</span>
</span><span id="LazyClassifier-543"><a href="#LazyClassifier-543"><span class="linenos">543</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyClassifier-544"><a href="#LazyClassifier-544"><span class="linenos">544</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-545"><a href="#LazyClassifier-545"><span class="linenos">545</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-546"><a href="#LazyClassifier-546"><span class="linenos">546</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyClassifier-547"><a href="#LazyClassifier-547"><span class="linenos">547</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyClassifier-548"><a href="#LazyClassifier-548"><span class="linenos">548</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyClassifier-549"><a href="#LazyClassifier-549"><span class="linenos">549</span></a>                                <span class="p">}</span>
</span><span id="LazyClassifier-550"><a href="#LazyClassifier-550"><span class="linenos">550</span></a>                            <span class="p">)</span>
</span><span id="LazyClassifier-551"><a href="#LazyClassifier-551"><span class="linenos">551</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyClassifier-552"><a href="#LazyClassifier-552"><span class="linenos">552</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyClassifier-553"><a href="#LazyClassifier-553"><span class="linenos">553</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier-554"><a href="#LazyClassifier-554"><span class="linenos">554</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier-555"><a href="#LazyClassifier-555"><span class="linenos">555</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyClassifier-556"><a href="#LazyClassifier-556"><span class="linenos">556</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyClassifier-557"><a href="#LazyClassifier-557"><span class="linenos">557</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyClassifier-558"><a href="#LazyClassifier-558"><span class="linenos">558</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier-559"><a href="#LazyClassifier-559"><span class="linenos">559</span></a>                        <span class="k">pass</span>
</span><span id="LazyClassifier-560"><a href="#LazyClassifier-560"><span class="linenos">560</span></a>
</span><span id="LazyClassifier-561"><a href="#LazyClassifier-561"><span class="linenos">561</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier-562"><a href="#LazyClassifier-562"><span class="linenos">562</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="LazyClassifier-563"><a href="#LazyClassifier-563"><span class="linenos">563</span></a>                <span class="p">{</span>
</span><span id="LazyClassifier-564"><a href="#LazyClassifier-564"><span class="linenos">564</span></a>                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyClassifier-565"><a href="#LazyClassifier-565"><span class="linenos">565</span></a>                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-566"><a href="#LazyClassifier-566"><span class="linenos">566</span></a>                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">B_Accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-567"><a href="#LazyClassifier-567"><span class="linenos">567</span></a>                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">ROC_AUC</span><span class="p">,</span>
</span><span id="LazyClassifier-568"><a href="#LazyClassifier-568"><span class="linenos">568</span></a>                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span>
</span><span id="LazyClassifier-569"><a href="#LazyClassifier-569"><span class="linenos">569</span></a>                    <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyClassifier-570"><a href="#LazyClassifier-570"><span class="linenos">570</span></a>                <span class="p">}</span>
</span><span id="LazyClassifier-571"><a href="#LazyClassifier-571"><span class="linenos">571</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier-572"><a href="#LazyClassifier-572"><span class="linenos">572</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier-573"><a href="#LazyClassifier-573"><span class="linenos">573</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="LazyClassifier-574"><a href="#LazyClassifier-574"><span class="linenos">574</span></a>                <span class="p">{</span>
</span><span id="LazyClassifier-575"><a href="#LazyClassifier-575"><span class="linenos">575</span></a>                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyClassifier-576"><a href="#LazyClassifier-576"><span class="linenos">576</span></a>                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-577"><a href="#LazyClassifier-577"><span class="linenos">577</span></a>                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">B_Accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-578"><a href="#LazyClassifier-578"><span class="linenos">578</span></a>                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">ROC_AUC</span><span class="p">,</span>
</span><span id="LazyClassifier-579"><a href="#LazyClassifier-579"><span class="linenos">579</span></a>                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span>
</span><span id="LazyClassifier-580"><a href="#LazyClassifier-580"><span class="linenos">580</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">CUSTOM_METRIC</span><span class="p">,</span>
</span><span id="LazyClassifier-581"><a href="#LazyClassifier-581"><span class="linenos">581</span></a>                    <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyClassifier-582"><a href="#LazyClassifier-582"><span class="linenos">582</span></a>                <span class="p">}</span>
</span><span id="LazyClassifier-583"><a href="#LazyClassifier-583"><span class="linenos">583</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier-584"><a href="#LazyClassifier-584"><span class="linenos">584</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_by</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyClassifier-585"><a href="#LazyClassifier-585"><span class="linenos">585</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyClassifier-586"><a href="#LazyClassifier-586"><span class="linenos">586</span></a>        <span class="p">)</span>
</span><span id="LazyClassifier-587"><a href="#LazyClassifier-587"><span class="linenos">587</span></a>
</span><span id="LazyClassifier-588"><a href="#LazyClassifier-588"><span class="linenos">588</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyClassifier-589"><a href="#LazyClassifier-589"><span class="linenos">589</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyClassifier-590"><a href="#LazyClassifier-590"><span class="linenos">590</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span><span id="LazyClassifier-591"><a href="#LazyClassifier-591"><span class="linenos">591</span></a>
</span><span id="LazyClassifier-592"><a href="#LazyClassifier-592"><span class="linenos">592</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyClassifier-593"><a href="#LazyClassifier-593"><span class="linenos">593</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all the model objects trained. If fit hasn&#39;t been called yet,</span>
</span><span id="LazyClassifier-594"><a href="#LazyClassifier-594"><span class="linenos">594</span></a><span class="sd">        then it&#39;s called to return the models.</span>
</span><span id="LazyClassifier-595"><a href="#LazyClassifier-595"><span class="linenos">595</span></a>
</span><span id="LazyClassifier-596"><a href="#LazyClassifier-596"><span class="linenos">596</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyClassifier-597"><a href="#LazyClassifier-597"><span class="linenos">597</span></a>
</span><span id="LazyClassifier-598"><a href="#LazyClassifier-598"><span class="linenos">598</span></a><span class="sd">        X_train: array-like,</span>
</span><span id="LazyClassifier-599"><a href="#LazyClassifier-599"><span class="linenos">599</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier-600"><a href="#LazyClassifier-600"><span class="linenos">600</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyClassifier-601"><a href="#LazyClassifier-601"><span class="linenos">601</span></a>
</span><span id="LazyClassifier-602"><a href="#LazyClassifier-602"><span class="linenos">602</span></a><span class="sd">        X_test: array-like,</span>
</span><span id="LazyClassifier-603"><a href="#LazyClassifier-603"><span class="linenos">603</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier-604"><a href="#LazyClassifier-604"><span class="linenos">604</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyClassifier-605"><a href="#LazyClassifier-605"><span class="linenos">605</span></a>
</span><span id="LazyClassifier-606"><a href="#LazyClassifier-606"><span class="linenos">606</span></a><span class="sd">        y_train: array-like,</span>
</span><span id="LazyClassifier-607"><a href="#LazyClassifier-607"><span class="linenos">607</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier-608"><a href="#LazyClassifier-608"><span class="linenos">608</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyClassifier-609"><a href="#LazyClassifier-609"><span class="linenos">609</span></a>
</span><span id="LazyClassifier-610"><a href="#LazyClassifier-610"><span class="linenos">610</span></a><span class="sd">        y_test: array-like,</span>
</span><span id="LazyClassifier-611"><a href="#LazyClassifier-611"><span class="linenos">611</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier-612"><a href="#LazyClassifier-612"><span class="linenos">612</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyClassifier-613"><a href="#LazyClassifier-613"><span class="linenos">613</span></a>
</span><span id="LazyClassifier-614"><a href="#LazyClassifier-614"><span class="linenos">614</span></a><span class="sd">        Returns:</span>
</span><span id="LazyClassifier-615"><a href="#LazyClassifier-615"><span class="linenos">615</span></a>
</span><span id="LazyClassifier-616"><a href="#LazyClassifier-616"><span class="linenos">616</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyClassifier-617"><a href="#LazyClassifier-617"><span class="linenos">617</span></a><span class="sd">                Returns a dictionary with each model&#39;s pipeline as value</span>
</span><span id="LazyClassifier-618"><a href="#LazyClassifier-618"><span class="linenos">618</span></a><span class="sd">                and key = name of the model.</span>
</span><span id="LazyClassifier-619"><a href="#LazyClassifier-619"><span class="linenos">619</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyClassifier-620"><a href="#LazyClassifier-620"><span class="linenos">620</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyClassifier-621"><a href="#LazyClassifier-621"><span class="linenos">621</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span><span id="LazyClassifier-622"><a href="#LazyClassifier-622"><span class="linenos">622</span></a>
</span><span id="LazyClassifier-623"><a href="#LazyClassifier-623"><span class="linenos">623</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>Fitting -- almost -- all the classification algorithms with nnetsauce's
    CustomClassifier and returning their scores.</p>

<p>Parameters:</p>

<pre><code>verbose: int, optional (default=0)
    Any positive number for verbosity.

ignore_warnings: bool, optional (default=True)
    When set to True, warnings related to algorithms that were not
    run are ignored.

custom_metric: function, optional (default=None)
    When function is provided, models are evaluated based on the
    custom evaluation metric provided.

predictions: bool, optional (default=False)
    When set to True, the predictions of all the models models are
    returned as data frame.

sort_by: string, optional (default='Accuracy')
    Sort models by a metric. Available options are 'Accuracy',
    'Balanced Accuracy', 'ROC AUC', 'F1 Score' or a custom metric
    identified by its name and provided by custom_metric.

random_state: int, optional (default=42)
    Reproducibiility seed.

estimators: list, optional (default='all')
    list of Estimators names or just 'all' for &gt; 90
    classifiers (default='all')

preprocess: bool, preprocessing is done when set to True

n_jobs: int, when possible, run in parallel
    For now, only used by individual models that support it.

All the other parameters are the same as CustomClassifier's.
</code></pre>

<p>Examples:
    <div class="pdoc-code codehilite">
    <pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
    <span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
    <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>
    <span class="n">y</span><span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">target</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">LazyClassifier</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">models</span><span class="p">,</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="n">model_dictionary</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">provide_models</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">models</span><span class="p">)</span>
    </code></pre>
    </div></p>
</div>


                                <div id="LazyClassifier.fit" class="classattr">
                                            <input id="LazyClassifier.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">y_train</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyClassifier.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyClassifier.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyClassifier.fit-203"><a href="#LazyClassifier.fit-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyClassifier.fit-204"><a href="#LazyClassifier.fit-204"><span class="linenos">204</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit classifiers to X_train and y_train, predict and score on X_test,</span>
</span><span id="LazyClassifier.fit-205"><a href="#LazyClassifier.fit-205"><span class="linenos">205</span></a><span class="sd">        y_test.</span>
</span><span id="LazyClassifier.fit-206"><a href="#LazyClassifier.fit-206"><span class="linenos">206</span></a>
</span><span id="LazyClassifier.fit-207"><a href="#LazyClassifier.fit-207"><span class="linenos">207</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyClassifier.fit-208"><a href="#LazyClassifier.fit-208"><span class="linenos">208</span></a>
</span><span id="LazyClassifier.fit-209"><a href="#LazyClassifier.fit-209"><span class="linenos">209</span></a><span class="sd">            X_train: array-like,</span>
</span><span id="LazyClassifier.fit-210"><a href="#LazyClassifier.fit-210"><span class="linenos">210</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier.fit-211"><a href="#LazyClassifier.fit-211"><span class="linenos">211</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyClassifier.fit-212"><a href="#LazyClassifier.fit-212"><span class="linenos">212</span></a>
</span><span id="LazyClassifier.fit-213"><a href="#LazyClassifier.fit-213"><span class="linenos">213</span></a><span class="sd">            X_test: array-like,</span>
</span><span id="LazyClassifier.fit-214"><a href="#LazyClassifier.fit-214"><span class="linenos">214</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier.fit-215"><a href="#LazyClassifier.fit-215"><span class="linenos">215</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyClassifier.fit-216"><a href="#LazyClassifier.fit-216"><span class="linenos">216</span></a>
</span><span id="LazyClassifier.fit-217"><a href="#LazyClassifier.fit-217"><span class="linenos">217</span></a><span class="sd">            y_train: array-like,</span>
</span><span id="LazyClassifier.fit-218"><a href="#LazyClassifier.fit-218"><span class="linenos">218</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier.fit-219"><a href="#LazyClassifier.fit-219"><span class="linenos">219</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyClassifier.fit-220"><a href="#LazyClassifier.fit-220"><span class="linenos">220</span></a>
</span><span id="LazyClassifier.fit-221"><a href="#LazyClassifier.fit-221"><span class="linenos">221</span></a><span class="sd">            y_test: array-like,</span>
</span><span id="LazyClassifier.fit-222"><a href="#LazyClassifier.fit-222"><span class="linenos">222</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier.fit-223"><a href="#LazyClassifier.fit-223"><span class="linenos">223</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyClassifier.fit-224"><a href="#LazyClassifier.fit-224"><span class="linenos">224</span></a>
</span><span id="LazyClassifier.fit-225"><a href="#LazyClassifier.fit-225"><span class="linenos">225</span></a><span class="sd">        Returns:</span>
</span><span id="LazyClassifier.fit-226"><a href="#LazyClassifier.fit-226"><span class="linenos">226</span></a>
</span><span id="LazyClassifier.fit-227"><a href="#LazyClassifier.fit-227"><span class="linenos">227</span></a><span class="sd">            scores: Pandas DataFrame</span>
</span><span id="LazyClassifier.fit-228"><a href="#LazyClassifier.fit-228"><span class="linenos">228</span></a><span class="sd">                Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyClassifier.fit-229"><a href="#LazyClassifier.fit-229"><span class="linenos">229</span></a>
</span><span id="LazyClassifier.fit-230"><a href="#LazyClassifier.fit-230"><span class="linenos">230</span></a><span class="sd">            predictions: Pandas DataFrame</span>
</span><span id="LazyClassifier.fit-231"><a href="#LazyClassifier.fit-231"><span class="linenos">231</span></a><span class="sd">                Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyClassifier.fit-232"><a href="#LazyClassifier.fit-232"><span class="linenos">232</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyClassifier.fit-233"><a href="#LazyClassifier.fit-233"><span class="linenos">233</span></a>        <span class="n">Accuracy</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier.fit-234"><a href="#LazyClassifier.fit-234"><span class="linenos">234</span></a>        <span class="n">B_Accuracy</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier.fit-235"><a href="#LazyClassifier.fit-235"><span class="linenos">235</span></a>        <span class="n">ROC_AUC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier.fit-236"><a href="#LazyClassifier.fit-236"><span class="linenos">236</span></a>        <span class="n">F1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier.fit-237"><a href="#LazyClassifier.fit-237"><span class="linenos">237</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier.fit-238"><a href="#LazyClassifier.fit-238"><span class="linenos">238</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier.fit-239"><a href="#LazyClassifier.fit-239"><span class="linenos">239</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyClassifier.fit-240"><a href="#LazyClassifier.fit-240"><span class="linenos">240</span></a>
</span><span id="LazyClassifier.fit-241"><a href="#LazyClassifier.fit-241"><span class="linenos">241</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-242"><a href="#LazyClassifier.fit-242"><span class="linenos">242</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier.fit-243"><a href="#LazyClassifier.fit-243"><span class="linenos">243</span></a>
</span><span id="LazyClassifier.fit-244"><a href="#LazyClassifier.fit-244"><span class="linenos">244</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyClassifier.fit-245"><a href="#LazyClassifier.fit-245"><span class="linenos">245</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-246"><a href="#LazyClassifier.fit-246"><span class="linenos">246</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-247"><a href="#LazyClassifier.fit-247"><span class="linenos">247</span></a>
</span><span id="LazyClassifier.fit-248"><a href="#LazyClassifier.fit-248"><span class="linenos">248</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyClassifier.fit-249"><a href="#LazyClassifier.fit-249"><span class="linenos">249</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyClassifier.fit-250"><a href="#LazyClassifier.fit-250"><span class="linenos">250</span></a>
</span><span id="LazyClassifier.fit-251"><a href="#LazyClassifier.fit-251"><span class="linenos">251</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-252"><a href="#LazyClassifier.fit-252"><span class="linenos">252</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyClassifier.fit-253"><a href="#LazyClassifier.fit-253"><span class="linenos">253</span></a>        <span class="p">)</span>
</span><span id="LazyClassifier.fit-254"><a href="#LazyClassifier.fit-254"><span class="linenos">254</span></a>
</span><span id="LazyClassifier.fit-255"><a href="#LazyClassifier.fit-255"><span class="linenos">255</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-256"><a href="#LazyClassifier.fit-256"><span class="linenos">256</span></a>
</span><span id="LazyClassifier.fit-257"><a href="#LazyClassifier.fit-257"><span class="linenos">257</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-258"><a href="#LazyClassifier.fit-258"><span class="linenos">258</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyClassifier.fit-259"><a href="#LazyClassifier.fit-259"><span class="linenos">259</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyClassifier.fit-260"><a href="#LazyClassifier.fit-260"><span class="linenos">260</span></a>                    <span class="p">(</span>
</span><span id="LazyClassifier.fit-261"><a href="#LazyClassifier.fit-261"><span class="linenos">261</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-262"><a href="#LazyClassifier.fit-262"><span class="linenos">262</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-263"><a href="#LazyClassifier.fit-263"><span class="linenos">263</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-264"><a href="#LazyClassifier.fit-264"><span class="linenos">264</span></a>                    <span class="p">),</span>
</span><span id="LazyClassifier.fit-265"><a href="#LazyClassifier.fit-265"><span class="linenos">265</span></a>                    <span class="p">(</span>
</span><span id="LazyClassifier.fit-266"><a href="#LazyClassifier.fit-266"><span class="linenos">266</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-267"><a href="#LazyClassifier.fit-267"><span class="linenos">267</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-268"><a href="#LazyClassifier.fit-268"><span class="linenos">268</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-269"><a href="#LazyClassifier.fit-269"><span class="linenos">269</span></a>                    <span class="p">),</span>
</span><span id="LazyClassifier.fit-270"><a href="#LazyClassifier.fit-270"><span class="linenos">270</span></a>                <span class="p">]</span>
</span><span id="LazyClassifier.fit-271"><a href="#LazyClassifier.fit-271"><span class="linenos">271</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier.fit-272"><a href="#LazyClassifier.fit-272"><span class="linenos">272</span></a>
</span><span id="LazyClassifier.fit-273"><a href="#LazyClassifier.fit-273"><span class="linenos">273</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-274"><a href="#LazyClassifier.fit-274"><span class="linenos">274</span></a>
</span><span id="LazyClassifier.fit-275"><a href="#LazyClassifier.fit-275"><span class="linenos">275</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-276"><a href="#LazyClassifier.fit-276"><span class="linenos">276</span></a>                <span class="n">CLASSIFIERS</span> <span class="o">+</span> <span class="n">MULTITASKCLASSIFIERS</span> <span class="o">+</span> <span class="n">SIMPLEMULTITASKCLASSIFIERS</span>
</span><span id="LazyClassifier.fit-277"><a href="#LazyClassifier.fit-277"><span class="linenos">277</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier.fit-278"><a href="#LazyClassifier.fit-278"><span class="linenos">278</span></a>
</span><span id="LazyClassifier.fit-279"><a href="#LazyClassifier.fit-279"><span class="linenos">279</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># list custom estimators, by their names</span>
</span><span id="LazyClassifier.fit-280"><a href="#LazyClassifier.fit-280"><span class="linenos">280</span></a>
</span><span id="LazyClassifier.fit-281"><a href="#LazyClassifier.fit-281"><span class="linenos">281</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-282"><a href="#LazyClassifier.fit-282"><span class="linenos">282</span></a>                <span class="p">[</span>
</span><span id="LazyClassifier.fit-283"><a href="#LazyClassifier.fit-283"><span class="linenos">283</span></a>                    <span class="p">(</span><span class="s2">&quot;CustomClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyClassifier.fit-284"><a href="#LazyClassifier.fit-284"><span class="linenos">284</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyClassifier.fit-285"><a href="#LazyClassifier.fit-285"><span class="linenos">285</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-286"><a href="#LazyClassifier.fit-286"><span class="linenos">286</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ClassifierMixin</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-287"><a href="#LazyClassifier.fit-287"><span class="linenos">287</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-288"><a href="#LazyClassifier.fit-288"><span class="linenos">288</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier.fit-289"><a href="#LazyClassifier.fit-289"><span class="linenos">289</span></a>                <span class="p">]</span>
</span><span id="LazyClassifier.fit-290"><a href="#LazyClassifier.fit-290"><span class="linenos">290</span></a>                <span class="o">+</span> <span class="p">[</span>
</span><span id="LazyClassifier.fit-291"><a href="#LazyClassifier.fit-291"><span class="linenos">291</span></a>                    <span class="p">(</span>
</span><span id="LazyClassifier.fit-292"><a href="#LazyClassifier.fit-292"><span class="linenos">292</span></a>                        <span class="s2">&quot;MultitaskClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-293"><a href="#LazyClassifier.fit-293"><span class="linenos">293</span></a>                        <span class="n">partial</span><span class="p">(</span><span class="n">MultitaskClassifier</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">]()),</span>
</span><span id="LazyClassifier.fit-294"><a href="#LazyClassifier.fit-294"><span class="linenos">294</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier.fit-295"><a href="#LazyClassifier.fit-295"><span class="linenos">295</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyClassifier.fit-296"><a href="#LazyClassifier.fit-296"><span class="linenos">296</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-297"><a href="#LazyClassifier.fit-297"><span class="linenos">297</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-298"><a href="#LazyClassifier.fit-298"><span class="linenos">298</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-299"><a href="#LazyClassifier.fit-299"><span class="linenos">299</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier.fit-300"><a href="#LazyClassifier.fit-300"><span class="linenos">300</span></a>                <span class="p">]</span>
</span><span id="LazyClassifier.fit-301"><a href="#LazyClassifier.fit-301"><span class="linenos">301</span></a>                <span class="o">+</span> <span class="p">[</span>
</span><span id="LazyClassifier.fit-302"><a href="#LazyClassifier.fit-302"><span class="linenos">302</span></a>                    <span class="p">(</span>
</span><span id="LazyClassifier.fit-303"><a href="#LazyClassifier.fit-303"><span class="linenos">303</span></a>                        <span class="s2">&quot;SimpleMultitaskClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-304"><a href="#LazyClassifier.fit-304"><span class="linenos">304</span></a>                        <span class="n">partial</span><span class="p">(</span><span class="n">SimpleMultitaskClassifier</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">]()),</span>
</span><span id="LazyClassifier.fit-305"><a href="#LazyClassifier.fit-305"><span class="linenos">305</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier.fit-306"><a href="#LazyClassifier.fit-306"><span class="linenos">306</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyClassifier.fit-307"><a href="#LazyClassifier.fit-307"><span class="linenos">307</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-308"><a href="#LazyClassifier.fit-308"><span class="linenos">308</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-309"><a href="#LazyClassifier.fit-309"><span class="linenos">309</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-310"><a href="#LazyClassifier.fit-310"><span class="linenos">310</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier.fit-311"><a href="#LazyClassifier.fit-311"><span class="linenos">311</span></a>                <span class="p">]</span>
</span><span id="LazyClassifier.fit-312"><a href="#LazyClassifier.fit-312"><span class="linenos">312</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier.fit-313"><a href="#LazyClassifier.fit-313"><span class="linenos">313</span></a>
</span><span id="LazyClassifier.fit-314"><a href="#LazyClassifier.fit-314"><span class="linenos">314</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-315"><a href="#LazyClassifier.fit-315"><span class="linenos">315</span></a>
</span><span id="LazyClassifier.fit-316"><a href="#LazyClassifier.fit-316"><span class="linenos">316</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyClassifier.fit-317"><a href="#LazyClassifier.fit-317"><span class="linenos">317</span></a>
</span><span id="LazyClassifier.fit-318"><a href="#LazyClassifier.fit-318"><span class="linenos">318</span></a>                <span class="n">other_args</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-319"><a href="#LazyClassifier.fit-319"><span class="linenos">319</span></a>                    <span class="p">{}</span>
</span><span id="LazyClassifier.fit-320"><a href="#LazyClassifier.fit-320"><span class="linenos">320</span></a>                <span class="p">)</span>  <span class="c1"># use this trick for `random_state` too --&gt; refactor</span>
</span><span id="LazyClassifier.fit-321"><a href="#LazyClassifier.fit-321"><span class="linenos">321</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-322"><a href="#LazyClassifier.fit-322"><span class="linenos">322</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-323"><a href="#LazyClassifier.fit-323"><span class="linenos">323</span></a>                        <span class="s2">&quot;n_jobs&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="LazyClassifier.fit-324"><a href="#LazyClassifier.fit-324"><span class="linenos">324</span></a>                        <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;LogisticRegression&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="LazyClassifier.fit-325"><a href="#LazyClassifier.fit-325"><span class="linenos">325</span></a>                    <span class="p">):</span>
</span><span id="LazyClassifier.fit-326"><a href="#LazyClassifier.fit-326"><span class="linenos">326</span></a>                        <span class="n">other_args</span><span class="p">[</span><span class="s2">&quot;n_jobs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span>
</span><span id="LazyClassifier.fit-327"><a href="#LazyClassifier.fit-327"><span class="linenos">327</span></a>                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-328"><a href="#LazyClassifier.fit-328"><span class="linenos">328</span></a>                    <span class="k">pass</span>
</span><span id="LazyClassifier.fit-329"><a href="#LazyClassifier.fit-329"><span class="linenos">329</span></a>
</span><span id="LazyClassifier.fit-330"><a href="#LazyClassifier.fit-330"><span class="linenos">330</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyClassifier.fit-331"><a href="#LazyClassifier.fit-331"><span class="linenos">331</span></a>
</span><span id="LazyClassifier.fit-332"><a href="#LazyClassifier.fit-332"><span class="linenos">332</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-333"><a href="#LazyClassifier.fit-333"><span class="linenos">333</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyClassifier.fit-334"><a href="#LazyClassifier.fit-334"><span class="linenos">334</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-335"><a href="#LazyClassifier.fit-335"><span class="linenos">335</span></a>                            <span class="p">[</span>
</span><span id="LazyClassifier.fit-336"><a href="#LazyClassifier.fit-336"><span class="linenos">336</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyClassifier.fit-337"><a href="#LazyClassifier.fit-337"><span class="linenos">337</span></a>                                <span class="p">(</span>
</span><span id="LazyClassifier.fit-338"><a href="#LazyClassifier.fit-338"><span class="linenos">338</span></a>                                    <span class="s2">&quot;classifier&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-339"><a href="#LazyClassifier.fit-339"><span class="linenos">339</span></a>                                    <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-340"><a href="#LazyClassifier.fit-340"><span class="linenos">340</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-341"><a href="#LazyClassifier.fit-341"><span class="linenos">341</span></a>                                            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-342"><a href="#LazyClassifier.fit-342"><span class="linenos">342</span></a>                                            <span class="o">**</span><span class="n">other_args</span>
</span><span id="LazyClassifier.fit-343"><a href="#LazyClassifier.fit-343"><span class="linenos">343</span></a>                                        <span class="p">),</span>
</span><span id="LazyClassifier.fit-344"><a href="#LazyClassifier.fit-344"><span class="linenos">344</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-345"><a href="#LazyClassifier.fit-345"><span class="linenos">345</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-346"><a href="#LazyClassifier.fit-346"><span class="linenos">346</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-347"><a href="#LazyClassifier.fit-347"><span class="linenos">347</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-348"><a href="#LazyClassifier.fit-348"><span class="linenos">348</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-349"><a href="#LazyClassifier.fit-349"><span class="linenos">349</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-350"><a href="#LazyClassifier.fit-350"><span class="linenos">350</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-351"><a href="#LazyClassifier.fit-351"><span class="linenos">351</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-352"><a href="#LazyClassifier.fit-352"><span class="linenos">352</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-353"><a href="#LazyClassifier.fit-353"><span class="linenos">353</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-354"><a href="#LazyClassifier.fit-354"><span class="linenos">354</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-355"><a href="#LazyClassifier.fit-355"><span class="linenos">355</span></a>                                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-356"><a href="#LazyClassifier.fit-356"><span class="linenos">356</span></a>                                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-357"><a href="#LazyClassifier.fit-357"><span class="linenos">357</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-358"><a href="#LazyClassifier.fit-358"><span class="linenos">358</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-359"><a href="#LazyClassifier.fit-359"><span class="linenos">359</span></a>                                    <span class="p">),</span>
</span><span id="LazyClassifier.fit-360"><a href="#LazyClassifier.fit-360"><span class="linenos">360</span></a>                                <span class="p">),</span>
</span><span id="LazyClassifier.fit-361"><a href="#LazyClassifier.fit-361"><span class="linenos">361</span></a>                            <span class="p">]</span>
</span><span id="LazyClassifier.fit-362"><a href="#LazyClassifier.fit-362"><span class="linenos">362</span></a>                        <span class="p">)</span>
</span><span id="LazyClassifier.fit-363"><a href="#LazyClassifier.fit-363"><span class="linenos">363</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-364"><a href="#LazyClassifier.fit-364"><span class="linenos">364</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-365"><a href="#LazyClassifier.fit-365"><span class="linenos">365</span></a>                            <span class="p">[</span>
</span><span id="LazyClassifier.fit-366"><a href="#LazyClassifier.fit-366"><span class="linenos">366</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyClassifier.fit-367"><a href="#LazyClassifier.fit-367"><span class="linenos">367</span></a>                                <span class="p">(</span>
</span><span id="LazyClassifier.fit-368"><a href="#LazyClassifier.fit-368"><span class="linenos">368</span></a>                                    <span class="s2">&quot;classifier&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-369"><a href="#LazyClassifier.fit-369"><span class="linenos">369</span></a>                                    <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-370"><a href="#LazyClassifier.fit-370"><span class="linenos">370</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">other_args</span><span class="p">),</span>
</span><span id="LazyClassifier.fit-371"><a href="#LazyClassifier.fit-371"><span class="linenos">371</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-372"><a href="#LazyClassifier.fit-372"><span class="linenos">372</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-373"><a href="#LazyClassifier.fit-373"><span class="linenos">373</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-374"><a href="#LazyClassifier.fit-374"><span class="linenos">374</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-375"><a href="#LazyClassifier.fit-375"><span class="linenos">375</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-376"><a href="#LazyClassifier.fit-376"><span class="linenos">376</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-377"><a href="#LazyClassifier.fit-377"><span class="linenos">377</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-378"><a href="#LazyClassifier.fit-378"><span class="linenos">378</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-379"><a href="#LazyClassifier.fit-379"><span class="linenos">379</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-380"><a href="#LazyClassifier.fit-380"><span class="linenos">380</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-381"><a href="#LazyClassifier.fit-381"><span class="linenos">381</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-382"><a href="#LazyClassifier.fit-382"><span class="linenos">382</span></a>                                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-383"><a href="#LazyClassifier.fit-383"><span class="linenos">383</span></a>                                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-384"><a href="#LazyClassifier.fit-384"><span class="linenos">384</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-385"><a href="#LazyClassifier.fit-385"><span class="linenos">385</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-386"><a href="#LazyClassifier.fit-386"><span class="linenos">386</span></a>                                    <span class="p">),</span>
</span><span id="LazyClassifier.fit-387"><a href="#LazyClassifier.fit-387"><span class="linenos">387</span></a>                                <span class="p">),</span>
</span><span id="LazyClassifier.fit-388"><a href="#LazyClassifier.fit-388"><span class="linenos">388</span></a>                            <span class="p">]</span>
</span><span id="LazyClassifier.fit-389"><a href="#LazyClassifier.fit-389"><span class="linenos">389</span></a>                        <span class="p">)</span>
</span><span id="LazyClassifier.fit-390"><a href="#LazyClassifier.fit-390"><span class="linenos">390</span></a>
</span><span id="LazyClassifier.fit-391"><a href="#LazyClassifier.fit-391"><span class="linenos">391</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-392"><a href="#LazyClassifier.fit-392"><span class="linenos">392</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyClassifier.fit-393"><a href="#LazyClassifier.fit-393"><span class="linenos">393</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-394"><a href="#LazyClassifier.fit-394"><span class="linenos">394</span></a>                    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-395"><a href="#LazyClassifier.fit-395"><span class="linenos">395</span></a>                    <span class="n">b_accuracy</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-396"><a href="#LazyClassifier.fit-396"><span class="linenos">396</span></a>                    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-397"><a href="#LazyClassifier.fit-397"><span class="linenos">397</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-398"><a href="#LazyClassifier.fit-398"><span class="linenos">398</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-399"><a href="#LazyClassifier.fit-399"><span class="linenos">399</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-400"><a href="#LazyClassifier.fit-400"><span class="linenos">400</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LazyClassifier.fit-401"><a href="#LazyClassifier.fit-401"><span class="linenos">401</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-402"><a href="#LazyClassifier.fit-402"><span class="linenos">402</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROC AUC couldn&#39;t be calculated for &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-403"><a href="#LazyClassifier.fit-403"><span class="linenos">403</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-404"><a href="#LazyClassifier.fit-404"><span class="linenos">404</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-405"><a href="#LazyClassifier.fit-405"><span class="linenos">405</span></a>                    <span class="n">Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-406"><a href="#LazyClassifier.fit-406"><span class="linenos">406</span></a>                    <span class="n">B_Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_accuracy</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-407"><a href="#LazyClassifier.fit-407"><span class="linenos">407</span></a>                    <span class="n">ROC_AUC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-408"><a href="#LazyClassifier.fit-408"><span class="linenos">408</span></a>                    <span class="n">F1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-409"><a href="#LazyClassifier.fit-409"><span class="linenos">409</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-410"><a href="#LazyClassifier.fit-410"><span class="linenos">410</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-411"><a href="#LazyClassifier.fit-411"><span class="linenos">411</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-412"><a href="#LazyClassifier.fit-412"><span class="linenos">412</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-413"><a href="#LazyClassifier.fit-413"><span class="linenos">413</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-414"><a href="#LazyClassifier.fit-414"><span class="linenos">414</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-415"><a href="#LazyClassifier.fit-415"><span class="linenos">415</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-416"><a href="#LazyClassifier.fit-416"><span class="linenos">416</span></a>                                <span class="p">{</span>
</span><span id="LazyClassifier.fit-417"><a href="#LazyClassifier.fit-417"><span class="linenos">417</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-418"><a href="#LazyClassifier.fit-418"><span class="linenos">418</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-419"><a href="#LazyClassifier.fit-419"><span class="linenos">419</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-420"><a href="#LazyClassifier.fit-420"><span class="linenos">420</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-421"><a href="#LazyClassifier.fit-421"><span class="linenos">421</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-422"><a href="#LazyClassifier.fit-422"><span class="linenos">422</span></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">custom_metric</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-423"><a href="#LazyClassifier.fit-423"><span class="linenos">423</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-424"><a href="#LazyClassifier.fit-424"><span class="linenos">424</span></a>                                <span class="p">}</span>
</span><span id="LazyClassifier.fit-425"><a href="#LazyClassifier.fit-425"><span class="linenos">425</span></a>                            <span class="p">)</span>
</span><span id="LazyClassifier.fit-426"><a href="#LazyClassifier.fit-426"><span class="linenos">426</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-427"><a href="#LazyClassifier.fit-427"><span class="linenos">427</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-428"><a href="#LazyClassifier.fit-428"><span class="linenos">428</span></a>                                <span class="p">{</span>
</span><span id="LazyClassifier.fit-429"><a href="#LazyClassifier.fit-429"><span class="linenos">429</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-430"><a href="#LazyClassifier.fit-430"><span class="linenos">430</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-431"><a href="#LazyClassifier.fit-431"><span class="linenos">431</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-432"><a href="#LazyClassifier.fit-432"><span class="linenos">432</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-433"><a href="#LazyClassifier.fit-433"><span class="linenos">433</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-434"><a href="#LazyClassifier.fit-434"><span class="linenos">434</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-435"><a href="#LazyClassifier.fit-435"><span class="linenos">435</span></a>                                <span class="p">}</span>
</span><span id="LazyClassifier.fit-436"><a href="#LazyClassifier.fit-436"><span class="linenos">436</span></a>                            <span class="p">)</span>
</span><span id="LazyClassifier.fit-437"><a href="#LazyClassifier.fit-437"><span class="linenos">437</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-438"><a href="#LazyClassifier.fit-438"><span class="linenos">438</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyClassifier.fit-439"><a href="#LazyClassifier.fit-439"><span class="linenos">439</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-440"><a href="#LazyClassifier.fit-440"><span class="linenos">440</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-441"><a href="#LazyClassifier.fit-441"><span class="linenos">441</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-442"><a href="#LazyClassifier.fit-442"><span class="linenos">442</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-443"><a href="#LazyClassifier.fit-443"><span class="linenos">443</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-444"><a href="#LazyClassifier.fit-444"><span class="linenos">444</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-445"><a href="#LazyClassifier.fit-445"><span class="linenos">445</span></a>                        <span class="k">pass</span>
</span><span id="LazyClassifier.fit-446"><a href="#LazyClassifier.fit-446"><span class="linenos">446</span></a>
</span><span id="LazyClassifier.fit-447"><a href="#LazyClassifier.fit-447"><span class="linenos">447</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if self.preprocess is False:</span>
</span><span id="LazyClassifier.fit-448"><a href="#LazyClassifier.fit-448"><span class="linenos">448</span></a>
</span><span id="LazyClassifier.fit-449"><a href="#LazyClassifier.fit-449"><span class="linenos">449</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyClassifier.fit-450"><a href="#LazyClassifier.fit-450"><span class="linenos">450</span></a>                <span class="n">other_args</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-451"><a href="#LazyClassifier.fit-451"><span class="linenos">451</span></a>                    <span class="p">{}</span>
</span><span id="LazyClassifier.fit-452"><a href="#LazyClassifier.fit-452"><span class="linenos">452</span></a>                <span class="p">)</span>  <span class="c1"># use this trick for `random_state` too --&gt; refactor</span>
</span><span id="LazyClassifier.fit-453"><a href="#LazyClassifier.fit-453"><span class="linenos">453</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-454"><a href="#LazyClassifier.fit-454"><span class="linenos">454</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-455"><a href="#LazyClassifier.fit-455"><span class="linenos">455</span></a>                        <span class="s2">&quot;n_jobs&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="LazyClassifier.fit-456"><a href="#LazyClassifier.fit-456"><span class="linenos">456</span></a>                        <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;LogisticRegression&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="LazyClassifier.fit-457"><a href="#LazyClassifier.fit-457"><span class="linenos">457</span></a>                    <span class="p">):</span>
</span><span id="LazyClassifier.fit-458"><a href="#LazyClassifier.fit-458"><span class="linenos">458</span></a>                        <span class="n">other_args</span><span class="p">[</span><span class="s2">&quot;n_jobs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span>
</span><span id="LazyClassifier.fit-459"><a href="#LazyClassifier.fit-459"><span class="linenos">459</span></a>                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-460"><a href="#LazyClassifier.fit-460"><span class="linenos">460</span></a>                    <span class="k">pass</span>
</span><span id="LazyClassifier.fit-461"><a href="#LazyClassifier.fit-461"><span class="linenos">461</span></a>
</span><span id="LazyClassifier.fit-462"><a href="#LazyClassifier.fit-462"><span class="linenos">462</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyClassifier.fit-463"><a href="#LazyClassifier.fit-463"><span class="linenos">463</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-464"><a href="#LazyClassifier.fit-464"><span class="linenos">464</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyClassifier.fit-465"><a href="#LazyClassifier.fit-465"><span class="linenos">465</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-466"><a href="#LazyClassifier.fit-466"><span class="linenos">466</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-467"><a href="#LazyClassifier.fit-467"><span class="linenos">467</span></a>                                <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span> <span class="o">**</span><span class="n">other_args</span>
</span><span id="LazyClassifier.fit-468"><a href="#LazyClassifier.fit-468"><span class="linenos">468</span></a>                            <span class="p">),</span>
</span><span id="LazyClassifier.fit-469"><a href="#LazyClassifier.fit-469"><span class="linenos">469</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-470"><a href="#LazyClassifier.fit-470"><span class="linenos">470</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-471"><a href="#LazyClassifier.fit-471"><span class="linenos">471</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-472"><a href="#LazyClassifier.fit-472"><span class="linenos">472</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-473"><a href="#LazyClassifier.fit-473"><span class="linenos">473</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-474"><a href="#LazyClassifier.fit-474"><span class="linenos">474</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-475"><a href="#LazyClassifier.fit-475"><span class="linenos">475</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-476"><a href="#LazyClassifier.fit-476"><span class="linenos">476</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-477"><a href="#LazyClassifier.fit-477"><span class="linenos">477</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-478"><a href="#LazyClassifier.fit-478"><span class="linenos">478</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-479"><a href="#LazyClassifier.fit-479"><span class="linenos">479</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-480"><a href="#LazyClassifier.fit-480"><span class="linenos">480</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-481"><a href="#LazyClassifier.fit-481"><span class="linenos">481</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-482"><a href="#LazyClassifier.fit-482"><span class="linenos">482</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-483"><a href="#LazyClassifier.fit-483"><span class="linenos">483</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-484"><a href="#LazyClassifier.fit-484"><span class="linenos">484</span></a>                        <span class="p">)</span>
</span><span id="LazyClassifier.fit-485"><a href="#LazyClassifier.fit-485"><span class="linenos">485</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-486"><a href="#LazyClassifier.fit-486"><span class="linenos">486</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-487"><a href="#LazyClassifier.fit-487"><span class="linenos">487</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">other_args</span><span class="p">),</span>
</span><span id="LazyClassifier.fit-488"><a href="#LazyClassifier.fit-488"><span class="linenos">488</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-489"><a href="#LazyClassifier.fit-489"><span class="linenos">489</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-490"><a href="#LazyClassifier.fit-490"><span class="linenos">490</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-491"><a href="#LazyClassifier.fit-491"><span class="linenos">491</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-492"><a href="#LazyClassifier.fit-492"><span class="linenos">492</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-493"><a href="#LazyClassifier.fit-493"><span class="linenos">493</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-494"><a href="#LazyClassifier.fit-494"><span class="linenos">494</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-495"><a href="#LazyClassifier.fit-495"><span class="linenos">495</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-496"><a href="#LazyClassifier.fit-496"><span class="linenos">496</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-497"><a href="#LazyClassifier.fit-497"><span class="linenos">497</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-498"><a href="#LazyClassifier.fit-498"><span class="linenos">498</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-499"><a href="#LazyClassifier.fit-499"><span class="linenos">499</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-500"><a href="#LazyClassifier.fit-500"><span class="linenos">500</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-501"><a href="#LazyClassifier.fit-501"><span class="linenos">501</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-502"><a href="#LazyClassifier.fit-502"><span class="linenos">502</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-503"><a href="#LazyClassifier.fit-503"><span class="linenos">503</span></a>                        <span class="p">)</span>
</span><span id="LazyClassifier.fit-504"><a href="#LazyClassifier.fit-504"><span class="linenos">504</span></a>
</span><span id="LazyClassifier.fit-505"><a href="#LazyClassifier.fit-505"><span class="linenos">505</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-506"><a href="#LazyClassifier.fit-506"><span class="linenos">506</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyClassifier.fit-507"><a href="#LazyClassifier.fit-507"><span class="linenos">507</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-508"><a href="#LazyClassifier.fit-508"><span class="linenos">508</span></a>                    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-509"><a href="#LazyClassifier.fit-509"><span class="linenos">509</span></a>                    <span class="n">b_accuracy</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-510"><a href="#LazyClassifier.fit-510"><span class="linenos">510</span></a>                    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-511"><a href="#LazyClassifier.fit-511"><span class="linenos">511</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-512"><a href="#LazyClassifier.fit-512"><span class="linenos">512</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-513"><a href="#LazyClassifier.fit-513"><span class="linenos">513</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-514"><a href="#LazyClassifier.fit-514"><span class="linenos">514</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LazyClassifier.fit-515"><a href="#LazyClassifier.fit-515"><span class="linenos">515</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-516"><a href="#LazyClassifier.fit-516"><span class="linenos">516</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROC AUC couldn&#39;t be calculated for &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-517"><a href="#LazyClassifier.fit-517"><span class="linenos">517</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-518"><a href="#LazyClassifier.fit-518"><span class="linenos">518</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-519"><a href="#LazyClassifier.fit-519"><span class="linenos">519</span></a>                    <span class="n">Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-520"><a href="#LazyClassifier.fit-520"><span class="linenos">520</span></a>                    <span class="n">B_Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_accuracy</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-521"><a href="#LazyClassifier.fit-521"><span class="linenos">521</span></a>                    <span class="n">ROC_AUC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-522"><a href="#LazyClassifier.fit-522"><span class="linenos">522</span></a>                    <span class="n">F1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-523"><a href="#LazyClassifier.fit-523"><span class="linenos">523</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-524"><a href="#LazyClassifier.fit-524"><span class="linenos">524</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-525"><a href="#LazyClassifier.fit-525"><span class="linenos">525</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-526"><a href="#LazyClassifier.fit-526"><span class="linenos">526</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-527"><a href="#LazyClassifier.fit-527"><span class="linenos">527</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-528"><a href="#LazyClassifier.fit-528"><span class="linenos">528</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-529"><a href="#LazyClassifier.fit-529"><span class="linenos">529</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-530"><a href="#LazyClassifier.fit-530"><span class="linenos">530</span></a>                                <span class="p">{</span>
</span><span id="LazyClassifier.fit-531"><a href="#LazyClassifier.fit-531"><span class="linenos">531</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-532"><a href="#LazyClassifier.fit-532"><span class="linenos">532</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-533"><a href="#LazyClassifier.fit-533"><span class="linenos">533</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-534"><a href="#LazyClassifier.fit-534"><span class="linenos">534</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-535"><a href="#LazyClassifier.fit-535"><span class="linenos">535</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-536"><a href="#LazyClassifier.fit-536"><span class="linenos">536</span></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">custom_metric</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-537"><a href="#LazyClassifier.fit-537"><span class="linenos">537</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-538"><a href="#LazyClassifier.fit-538"><span class="linenos">538</span></a>                                <span class="p">}</span>
</span><span id="LazyClassifier.fit-539"><a href="#LazyClassifier.fit-539"><span class="linenos">539</span></a>                            <span class="p">)</span>
</span><span id="LazyClassifier.fit-540"><a href="#LazyClassifier.fit-540"><span class="linenos">540</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-541"><a href="#LazyClassifier.fit-541"><span class="linenos">541</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-542"><a href="#LazyClassifier.fit-542"><span class="linenos">542</span></a>                                <span class="p">{</span>
</span><span id="LazyClassifier.fit-543"><a href="#LazyClassifier.fit-543"><span class="linenos">543</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-544"><a href="#LazyClassifier.fit-544"><span class="linenos">544</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-545"><a href="#LazyClassifier.fit-545"><span class="linenos">545</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-546"><a href="#LazyClassifier.fit-546"><span class="linenos">546</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-547"><a href="#LazyClassifier.fit-547"><span class="linenos">547</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-548"><a href="#LazyClassifier.fit-548"><span class="linenos">548</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-549"><a href="#LazyClassifier.fit-549"><span class="linenos">549</span></a>                                <span class="p">}</span>
</span><span id="LazyClassifier.fit-550"><a href="#LazyClassifier.fit-550"><span class="linenos">550</span></a>                            <span class="p">)</span>
</span><span id="LazyClassifier.fit-551"><a href="#LazyClassifier.fit-551"><span class="linenos">551</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-552"><a href="#LazyClassifier.fit-552"><span class="linenos">552</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyClassifier.fit-553"><a href="#LazyClassifier.fit-553"><span class="linenos">553</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-554"><a href="#LazyClassifier.fit-554"><span class="linenos">554</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-555"><a href="#LazyClassifier.fit-555"><span class="linenos">555</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-556"><a href="#LazyClassifier.fit-556"><span class="linenos">556</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-557"><a href="#LazyClassifier.fit-557"><span class="linenos">557</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-558"><a href="#LazyClassifier.fit-558"><span class="linenos">558</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-559"><a href="#LazyClassifier.fit-559"><span class="linenos">559</span></a>                        <span class="k">pass</span>
</span><span id="LazyClassifier.fit-560"><a href="#LazyClassifier.fit-560"><span class="linenos">560</span></a>
</span><span id="LazyClassifier.fit-561"><a href="#LazyClassifier.fit-561"><span class="linenos">561</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-562"><a href="#LazyClassifier.fit-562"><span class="linenos">562</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-563"><a href="#LazyClassifier.fit-563"><span class="linenos">563</span></a>                <span class="p">{</span>
</span><span id="LazyClassifier.fit-564"><a href="#LazyClassifier.fit-564"><span class="linenos">564</span></a>                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-565"><a href="#LazyClassifier.fit-565"><span class="linenos">565</span></a>                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-566"><a href="#LazyClassifier.fit-566"><span class="linenos">566</span></a>                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">B_Accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-567"><a href="#LazyClassifier.fit-567"><span class="linenos">567</span></a>                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">ROC_AUC</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-568"><a href="#LazyClassifier.fit-568"><span class="linenos">568</span></a>                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-569"><a href="#LazyClassifier.fit-569"><span class="linenos">569</span></a>                    <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-570"><a href="#LazyClassifier.fit-570"><span class="linenos">570</span></a>                <span class="p">}</span>
</span><span id="LazyClassifier.fit-571"><a href="#LazyClassifier.fit-571"><span class="linenos">571</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier.fit-572"><a href="#LazyClassifier.fit-572"><span class="linenos">572</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-573"><a href="#LazyClassifier.fit-573"><span class="linenos">573</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-574"><a href="#LazyClassifier.fit-574"><span class="linenos">574</span></a>                <span class="p">{</span>
</span><span id="LazyClassifier.fit-575"><a href="#LazyClassifier.fit-575"><span class="linenos">575</span></a>                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-576"><a href="#LazyClassifier.fit-576"><span class="linenos">576</span></a>                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-577"><a href="#LazyClassifier.fit-577"><span class="linenos">577</span></a>                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">B_Accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-578"><a href="#LazyClassifier.fit-578"><span class="linenos">578</span></a>                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">ROC_AUC</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-579"><a href="#LazyClassifier.fit-579"><span class="linenos">579</span></a>                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-580"><a href="#LazyClassifier.fit-580"><span class="linenos">580</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">CUSTOM_METRIC</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-581"><a href="#LazyClassifier.fit-581"><span class="linenos">581</span></a>                    <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-582"><a href="#LazyClassifier.fit-582"><span class="linenos">582</span></a>                <span class="p">}</span>
</span><span id="LazyClassifier.fit-583"><a href="#LazyClassifier.fit-583"><span class="linenos">583</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier.fit-584"><a href="#LazyClassifier.fit-584"><span class="linenos">584</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_by</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-585"><a href="#LazyClassifier.fit-585"><span class="linenos">585</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyClassifier.fit-586"><a href="#LazyClassifier.fit-586"><span class="linenos">586</span></a>        <span class="p">)</span>
</span><span id="LazyClassifier.fit-587"><a href="#LazyClassifier.fit-587"><span class="linenos">587</span></a>
</span><span id="LazyClassifier.fit-588"><a href="#LazyClassifier.fit-588"><span class="linenos">588</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-589"><a href="#LazyClassifier.fit-589"><span class="linenos">589</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-590"><a href="#LazyClassifier.fit-590"><span class="linenos">590</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span></pre></div>


            <div class="docstring"><p>Fit classifiers to X_train and y_train, predict and score on X_test,
y_test.</p>

<p>Parameters:</p>

<pre><code>X_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.

y_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

y_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.
</code></pre>

<p>Returns:</p>

<pre><code>scores: Pandas DataFrame
    Returns metrics of all the models in a Pandas DataFrame.

predictions: Pandas DataFrame
    Returns predictions of all the models in a Pandas DataFrame.
</code></pre>
</div>


                                </div>
                                <div id="LazyClassifier.provide_models" class="classattr">
                                            <input id="LazyClassifier.provide_models-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">provide_models</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">y_train</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyClassifier.provide_models-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyClassifier.provide_models"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyClassifier.provide_models-592"><a href="#LazyClassifier.provide_models-592"><span class="linenos">592</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyClassifier.provide_models-593"><a href="#LazyClassifier.provide_models-593"><span class="linenos">593</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all the model objects trained. If fit hasn&#39;t been called yet,</span>
</span><span id="LazyClassifier.provide_models-594"><a href="#LazyClassifier.provide_models-594"><span class="linenos">594</span></a><span class="sd">        then it&#39;s called to return the models.</span>
</span><span id="LazyClassifier.provide_models-595"><a href="#LazyClassifier.provide_models-595"><span class="linenos">595</span></a>
</span><span id="LazyClassifier.provide_models-596"><a href="#LazyClassifier.provide_models-596"><span class="linenos">596</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyClassifier.provide_models-597"><a href="#LazyClassifier.provide_models-597"><span class="linenos">597</span></a>
</span><span id="LazyClassifier.provide_models-598"><a href="#LazyClassifier.provide_models-598"><span class="linenos">598</span></a><span class="sd">        X_train: array-like,</span>
</span><span id="LazyClassifier.provide_models-599"><a href="#LazyClassifier.provide_models-599"><span class="linenos">599</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier.provide_models-600"><a href="#LazyClassifier.provide_models-600"><span class="linenos">600</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyClassifier.provide_models-601"><a href="#LazyClassifier.provide_models-601"><span class="linenos">601</span></a>
</span><span id="LazyClassifier.provide_models-602"><a href="#LazyClassifier.provide_models-602"><span class="linenos">602</span></a><span class="sd">        X_test: array-like,</span>
</span><span id="LazyClassifier.provide_models-603"><a href="#LazyClassifier.provide_models-603"><span class="linenos">603</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier.provide_models-604"><a href="#LazyClassifier.provide_models-604"><span class="linenos">604</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyClassifier.provide_models-605"><a href="#LazyClassifier.provide_models-605"><span class="linenos">605</span></a>
</span><span id="LazyClassifier.provide_models-606"><a href="#LazyClassifier.provide_models-606"><span class="linenos">606</span></a><span class="sd">        y_train: array-like,</span>
</span><span id="LazyClassifier.provide_models-607"><a href="#LazyClassifier.provide_models-607"><span class="linenos">607</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier.provide_models-608"><a href="#LazyClassifier.provide_models-608"><span class="linenos">608</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyClassifier.provide_models-609"><a href="#LazyClassifier.provide_models-609"><span class="linenos">609</span></a>
</span><span id="LazyClassifier.provide_models-610"><a href="#LazyClassifier.provide_models-610"><span class="linenos">610</span></a><span class="sd">        y_test: array-like,</span>
</span><span id="LazyClassifier.provide_models-611"><a href="#LazyClassifier.provide_models-611"><span class="linenos">611</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier.provide_models-612"><a href="#LazyClassifier.provide_models-612"><span class="linenos">612</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyClassifier.provide_models-613"><a href="#LazyClassifier.provide_models-613"><span class="linenos">613</span></a>
</span><span id="LazyClassifier.provide_models-614"><a href="#LazyClassifier.provide_models-614"><span class="linenos">614</span></a><span class="sd">        Returns:</span>
</span><span id="LazyClassifier.provide_models-615"><a href="#LazyClassifier.provide_models-615"><span class="linenos">615</span></a>
</span><span id="LazyClassifier.provide_models-616"><a href="#LazyClassifier.provide_models-616"><span class="linenos">616</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyClassifier.provide_models-617"><a href="#LazyClassifier.provide_models-617"><span class="linenos">617</span></a><span class="sd">                Returns a dictionary with each model&#39;s pipeline as value</span>
</span><span id="LazyClassifier.provide_models-618"><a href="#LazyClassifier.provide_models-618"><span class="linenos">618</span></a><span class="sd">                and key = name of the model.</span>
</span><span id="LazyClassifier.provide_models-619"><a href="#LazyClassifier.provide_models-619"><span class="linenos">619</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyClassifier.provide_models-620"><a href="#LazyClassifier.provide_models-620"><span class="linenos">620</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyClassifier.provide_models-621"><a href="#LazyClassifier.provide_models-621"><span class="linenos">621</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span><span id="LazyClassifier.provide_models-622"><a href="#LazyClassifier.provide_models-622"><span class="linenos">622</span></a>
</span><span id="LazyClassifier.provide_models-623"><a href="#LazyClassifier.provide_models-623"><span class="linenos">623</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>Returns all the model objects trained. If fit hasn't been called yet,
then it's called to return the models.</p>

<p>Parameters:</p>

<p>X_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.</p>

<p>X_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.</p>

<p>y_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.</p>

<p>y_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.</p>

<p>Returns:</p>

<pre><code>models: dict-object,
    Returns a dictionary with each model's pipeline as value
    and key = name of the model.
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="LazyRegressor">
                            <input id="LazyRegressor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LazyRegressor</span><wbr>(<span class="base">nnetsauce.custom.custom.Custom</span>, <span class="base">sklearn.base.RegressorMixin</span>):

                <label class="view-source-button" for="LazyRegressor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyRegressor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyRegressor-85"><a href="#LazyRegressor-85"><span class="linenos"> 85</span></a><span class="k">class</span> <span class="nc">LazyRegressor</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">RegressorMixin</span><span class="p">):</span>
</span><span id="LazyRegressor-86"><a href="#LazyRegressor-86"><span class="linenos"> 86</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyRegressor-87"><a href="#LazyRegressor-87"><span class="linenos"> 87</span></a>
</span><span id="LazyRegressor-88"><a href="#LazyRegressor-88"><span class="linenos"> 88</span></a><span class="sd">    Fitting a collection of regression models using nnetsauce&#39;s CustomRegressor</span>
</span><span id="LazyRegressor-89"><a href="#LazyRegressor-89"><span class="linenos"> 89</span></a>
</span><span id="LazyRegressor-90"><a href="#LazyRegressor-90"><span class="linenos"> 90</span></a><span class="sd">    Parameters:</span>
</span><span id="LazyRegressor-91"><a href="#LazyRegressor-91"><span class="linenos"> 91</span></a>
</span><span id="LazyRegressor-92"><a href="#LazyRegressor-92"><span class="linenos"> 92</span></a><span class="sd">        verbose: int, optional (default=0)</span>
</span><span id="LazyRegressor-93"><a href="#LazyRegressor-93"><span class="linenos"> 93</span></a><span class="sd">            Any positive number for verbosity.</span>
</span><span id="LazyRegressor-94"><a href="#LazyRegressor-94"><span class="linenos"> 94</span></a>
</span><span id="LazyRegressor-95"><a href="#LazyRegressor-95"><span class="linenos"> 95</span></a><span class="sd">        ignore_warnings: bool, optional (default=True)</span>
</span><span id="LazyRegressor-96"><a href="#LazyRegressor-96"><span class="linenos"> 96</span></a><span class="sd">            When set to True, the warning related to algorigms that are not able to run are ignored.</span>
</span><span id="LazyRegressor-97"><a href="#LazyRegressor-97"><span class="linenos"> 97</span></a>
</span><span id="LazyRegressor-98"><a href="#LazyRegressor-98"><span class="linenos"> 98</span></a><span class="sd">        custom_metric: function, optional (default=None)</span>
</span><span id="LazyRegressor-99"><a href="#LazyRegressor-99"><span class="linenos"> 99</span></a><span class="sd">            When function is provided, models are evaluated based on the custom evaluation metric provided.</span>
</span><span id="LazyRegressor-100"><a href="#LazyRegressor-100"><span class="linenos">100</span></a>
</span><span id="LazyRegressor-101"><a href="#LazyRegressor-101"><span class="linenos">101</span></a><span class="sd">        predictions: bool, optional (default=False)</span>
</span><span id="LazyRegressor-102"><a href="#LazyRegressor-102"><span class="linenos">102</span></a><span class="sd">            When set to True, the predictions of all the models models are returned as dataframe.</span>
</span><span id="LazyRegressor-103"><a href="#LazyRegressor-103"><span class="linenos">103</span></a>
</span><span id="LazyRegressor-104"><a href="#LazyRegressor-104"><span class="linenos">104</span></a><span class="sd">        sort_by: string, optional (default=&#39;Accuracy&#39;)</span>
</span><span id="LazyRegressor-105"><a href="#LazyRegressor-105"><span class="linenos">105</span></a><span class="sd">            Sort models by a metric. Available options are &#39;Accuracy&#39;, &#39;Balanced Accuracy&#39;, &#39;ROC AUC&#39;, &#39;F1 Score&#39;</span>
</span><span id="LazyRegressor-106"><a href="#LazyRegressor-106"><span class="linenos">106</span></a><span class="sd">            or a custom metric identified by its name and provided by custom_metric.</span>
</span><span id="LazyRegressor-107"><a href="#LazyRegressor-107"><span class="linenos">107</span></a>
</span><span id="LazyRegressor-108"><a href="#LazyRegressor-108"><span class="linenos">108</span></a><span class="sd">        random_state: int, optional (default=42)</span>
</span><span id="LazyRegressor-109"><a href="#LazyRegressor-109"><span class="linenos">109</span></a><span class="sd">            Reproducibiility seed.</span>
</span><span id="LazyRegressor-110"><a href="#LazyRegressor-110"><span class="linenos">110</span></a>
</span><span id="LazyRegressor-111"><a href="#LazyRegressor-111"><span class="linenos">111</span></a><span class="sd">        estimators: list, optional (default=&#39;all&#39;)</span>
</span><span id="LazyRegressor-112"><a href="#LazyRegressor-112"><span class="linenos">112</span></a><span class="sd">            a list of Estimators names or just &#39;all&#39; (default=&#39;all&#39;)</span>
</span><span id="LazyRegressor-113"><a href="#LazyRegressor-113"><span class="linenos">113</span></a>
</span><span id="LazyRegressor-114"><a href="#LazyRegressor-114"><span class="linenos">114</span></a><span class="sd">        preprocess: bool</span>
</span><span id="LazyRegressor-115"><a href="#LazyRegressor-115"><span class="linenos">115</span></a><span class="sd">            preprocessing is done when set to True</span>
</span><span id="LazyRegressor-116"><a href="#LazyRegressor-116"><span class="linenos">116</span></a>
</span><span id="LazyRegressor-117"><a href="#LazyRegressor-117"><span class="linenos">117</span></a><span class="sd">        n_jobs : int, when possible, run in parallel</span>
</span><span id="LazyRegressor-118"><a href="#LazyRegressor-118"><span class="linenos">118</span></a><span class="sd">            For now, only used by individual models that support it.</span>
</span><span id="LazyRegressor-119"><a href="#LazyRegressor-119"><span class="linenos">119</span></a>
</span><span id="LazyRegressor-120"><a href="#LazyRegressor-120"><span class="linenos">120</span></a><span class="sd">        n_layers: int, optional (default=3)</span>
</span><span id="LazyRegressor-121"><a href="#LazyRegressor-121"><span class="linenos">121</span></a><span class="sd">            Number of layers of CustomRegressors to be used.</span>
</span><span id="LazyRegressor-122"><a href="#LazyRegressor-122"><span class="linenos">122</span></a>
</span><span id="LazyRegressor-123"><a href="#LazyRegressor-123"><span class="linenos">123</span></a><span class="sd">        All the other parameters are the same as CustomRegressor&#39;s.</span>
</span><span id="LazyRegressor-124"><a href="#LazyRegressor-124"><span class="linenos">124</span></a>
</span><span id="LazyRegressor-125"><a href="#LazyRegressor-125"><span class="linenos">125</span></a><span class="sd">    Examples:</span>
</span><span id="LazyRegressor-126"><a href="#LazyRegressor-126"><span class="linenos">126</span></a><span class="sd">        ```python</span>
</span><span id="LazyRegressor-127"><a href="#LazyRegressor-127"><span class="linenos">127</span></a><span class="sd">        import nnetsauce as ns</span>
</span><span id="LazyRegressor-128"><a href="#LazyRegressor-128"><span class="linenos">128</span></a><span class="sd">        from sklearn.datasets import load_diabetes</span>
</span><span id="LazyRegressor-129"><a href="#LazyRegressor-129"><span class="linenos">129</span></a><span class="sd">        from sklearn.model_selection import train_test_split</span>
</span><span id="LazyRegressor-130"><a href="#LazyRegressor-130"><span class="linenos">130</span></a><span class="sd">        data = load_diabetes()</span>
</span><span id="LazyRegressor-131"><a href="#LazyRegressor-131"><span class="linenos">131</span></a><span class="sd">        X = data.data</span>
</span><span id="LazyRegressor-132"><a href="#LazyRegressor-132"><span class="linenos">132</span></a><span class="sd">        y= data.target</span>
</span><span id="LazyRegressor-133"><a href="#LazyRegressor-133"><span class="linenos">133</span></a><span class="sd">        X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=.2, random_state=123)</span>
</span><span id="LazyRegressor-134"><a href="#LazyRegressor-134"><span class="linenos">134</span></a><span class="sd">        regr = ns.LazyRegressor(verbose=0, ignore_warnings=True)</span>
</span><span id="LazyRegressor-135"><a href="#LazyRegressor-135"><span class="linenos">135</span></a><span class="sd">        models, predictions = clf.fit(X_train, X_test, y_train, y_test)</span>
</span><span id="LazyRegressor-136"><a href="#LazyRegressor-136"><span class="linenos">136</span></a><span class="sd">        model_dictionary = clf.provide_models(X_train,X_test,y_train,y_test)</span>
</span><span id="LazyRegressor-137"><a href="#LazyRegressor-137"><span class="linenos">137</span></a><span class="sd">        print(models)</span>
</span><span id="LazyRegressor-138"><a href="#LazyRegressor-138"><span class="linenos">138</span></a><span class="sd">        ```</span>
</span><span id="LazyRegressor-139"><a href="#LazyRegressor-139"><span class="linenos">139</span></a>
</span><span id="LazyRegressor-140"><a href="#LazyRegressor-140"><span class="linenos">140</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LazyRegressor-141"><a href="#LazyRegressor-141"><span class="linenos">141</span></a>
</span><span id="LazyRegressor-142"><a href="#LazyRegressor-142"><span class="linenos">142</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyRegressor-143"><a href="#LazyRegressor-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="LazyRegressor-144"><a href="#LazyRegressor-144"><span class="linenos">144</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyRegressor-145"><a href="#LazyRegressor-145"><span class="linenos">145</span></a>        <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyRegressor-146"><a href="#LazyRegressor-146"><span class="linenos">146</span></a>        <span class="n">custom_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyRegressor-147"><a href="#LazyRegressor-147"><span class="linenos">147</span></a>        <span class="n">predictions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyRegressor-148"><a href="#LazyRegressor-148"><span class="linenos">148</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="LazyRegressor-149"><a href="#LazyRegressor-149"><span class="linenos">149</span></a>        <span class="n">estimators</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-150"><a href="#LazyRegressor-150"><span class="linenos">150</span></a>        <span class="n">preprocess</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyRegressor-151"><a href="#LazyRegressor-151"><span class="linenos">151</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyRegressor-152"><a href="#LazyRegressor-152"><span class="linenos">152</span></a>        <span class="c1"># CustomRegressor attributes</span>
</span><span id="LazyRegressor-153"><a href="#LazyRegressor-153"><span class="linenos">153</span></a>        <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyRegressor-154"><a href="#LazyRegressor-154"><span class="linenos">154</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="LazyRegressor-155"><a href="#LazyRegressor-155"><span class="linenos">155</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-156"><a href="#LazyRegressor-156"><span class="linenos">156</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="LazyRegressor-157"><a href="#LazyRegressor-157"><span class="linenos">157</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-158"><a href="#LazyRegressor-158"><span class="linenos">158</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyRegressor-159"><a href="#LazyRegressor-159"><span class="linenos">159</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyRegressor-160"><a href="#LazyRegressor-160"><span class="linenos">160</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyRegressor-161"><a href="#LazyRegressor-161"><span class="linenos">161</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="LazyRegressor-162"><a href="#LazyRegressor-162"><span class="linenos">162</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyRegressor-163"><a href="#LazyRegressor-163"><span class="linenos">163</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-164"><a href="#LazyRegressor-164"><span class="linenos">164</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="LazyRegressor-165"><a href="#LazyRegressor-165"><span class="linenos">165</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyRegressor-166"><a href="#LazyRegressor-166"><span class="linenos">166</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyRegressor-167"><a href="#LazyRegressor-167"><span class="linenos">167</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="LazyRegressor-168"><a href="#LazyRegressor-168"><span class="linenos">168</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-169"><a href="#LazyRegressor-169"><span class="linenos">169</span></a>    <span class="p">):</span>
</span><span id="LazyRegressor-170"><a href="#LazyRegressor-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="LazyRegressor-171"><a href="#LazyRegressor-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="o">=</span> <span class="n">ignore_warnings</span>
</span><span id="LazyRegressor-172"><a href="#LazyRegressor-172"><span class="linenos">172</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="o">=</span> <span class="n">custom_metric</span>
</span><span id="LazyRegressor-173"><a href="#LazyRegressor-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span>
</span><span id="LazyRegressor-174"><a href="#LazyRegressor-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyRegressor-175"><a href="#LazyRegressor-175"><span class="linenos">175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="LazyRegressor-176"><a href="#LazyRegressor-176"><span class="linenos">176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">=</span> <span class="n">estimators</span>
</span><span id="LazyRegressor-177"><a href="#LazyRegressor-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="o">=</span> <span class="n">preprocess</span>
</span><span id="LazyRegressor-178"><a href="#LazyRegressor-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="LazyRegressor-179"><a href="#LazyRegressor-179"><span class="linenos">179</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyRegressor-180"><a href="#LazyRegressor-180"><span class="linenos">180</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="LazyRegressor-181"><a href="#LazyRegressor-181"><span class="linenos">181</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor-182"><a href="#LazyRegressor-182"><span class="linenos">182</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor-183"><a href="#LazyRegressor-183"><span class="linenos">183</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor-184"><a href="#LazyRegressor-184"><span class="linenos">184</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor-185"><a href="#LazyRegressor-185"><span class="linenos">185</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor-186"><a href="#LazyRegressor-186"><span class="linenos">186</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor-187"><a href="#LazyRegressor-187"><span class="linenos">187</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor-188"><a href="#LazyRegressor-188"><span class="linenos">188</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor-189"><a href="#LazyRegressor-189"><span class="linenos">189</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor-190"><a href="#LazyRegressor-190"><span class="linenos">190</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor-191"><a href="#LazyRegressor-191"><span class="linenos">191</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor-192"><a href="#LazyRegressor-192"><span class="linenos">192</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-193"><a href="#LazyRegressor-193"><span class="linenos">193</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-194"><a href="#LazyRegressor-194"><span class="linenos">194</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor-195"><a href="#LazyRegressor-195"><span class="linenos">195</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor-196"><a href="#LazyRegressor-196"><span class="linenos">196</span></a>        <span class="p">)</span>
</span><span id="LazyRegressor-197"><a href="#LazyRegressor-197"><span class="linenos">197</span></a>
</span><span id="LazyRegressor-198"><a href="#LazyRegressor-198"><span class="linenos">198</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyRegressor-199"><a href="#LazyRegressor-199"><span class="linenos">199</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X_train and y_train, predict and score on X_test, y_test.</span>
</span><span id="LazyRegressor-200"><a href="#LazyRegressor-200"><span class="linenos">200</span></a>
</span><span id="LazyRegressor-201"><a href="#LazyRegressor-201"><span class="linenos">201</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyRegressor-202"><a href="#LazyRegressor-202"><span class="linenos">202</span></a>
</span><span id="LazyRegressor-203"><a href="#LazyRegressor-203"><span class="linenos">203</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyRegressor-204"><a href="#LazyRegressor-204"><span class="linenos">204</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor-205"><a href="#LazyRegressor-205"><span class="linenos">205</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyRegressor-206"><a href="#LazyRegressor-206"><span class="linenos">206</span></a>
</span><span id="LazyRegressor-207"><a href="#LazyRegressor-207"><span class="linenos">207</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyRegressor-208"><a href="#LazyRegressor-208"><span class="linenos">208</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor-209"><a href="#LazyRegressor-209"><span class="linenos">209</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyRegressor-210"><a href="#LazyRegressor-210"><span class="linenos">210</span></a>
</span><span id="LazyRegressor-211"><a href="#LazyRegressor-211"><span class="linenos">211</span></a><span class="sd">            y_train : array-like,</span>
</span><span id="LazyRegressor-212"><a href="#LazyRegressor-212"><span class="linenos">212</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor-213"><a href="#LazyRegressor-213"><span class="linenos">213</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyRegressor-214"><a href="#LazyRegressor-214"><span class="linenos">214</span></a>
</span><span id="LazyRegressor-215"><a href="#LazyRegressor-215"><span class="linenos">215</span></a><span class="sd">            y_test : array-like,</span>
</span><span id="LazyRegressor-216"><a href="#LazyRegressor-216"><span class="linenos">216</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor-217"><a href="#LazyRegressor-217"><span class="linenos">217</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyRegressor-218"><a href="#LazyRegressor-218"><span class="linenos">218</span></a>
</span><span id="LazyRegressor-219"><a href="#LazyRegressor-219"><span class="linenos">219</span></a><span class="sd">        Returns:</span>
</span><span id="LazyRegressor-220"><a href="#LazyRegressor-220"><span class="linenos">220</span></a>
</span><span id="LazyRegressor-221"><a href="#LazyRegressor-221"><span class="linenos">221</span></a><span class="sd">        scores : Pandas DataFrame</span>
</span><span id="LazyRegressor-222"><a href="#LazyRegressor-222"><span class="linenos">222</span></a><span class="sd">            Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyRegressor-223"><a href="#LazyRegressor-223"><span class="linenos">223</span></a>
</span><span id="LazyRegressor-224"><a href="#LazyRegressor-224"><span class="linenos">224</span></a><span class="sd">        predictions : Pandas DataFrame</span>
</span><span id="LazyRegressor-225"><a href="#LazyRegressor-225"><span class="linenos">225</span></a><span class="sd">            Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyRegressor-226"><a href="#LazyRegressor-226"><span class="linenos">226</span></a>
</span><span id="LazyRegressor-227"><a href="#LazyRegressor-227"><span class="linenos">227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyRegressor-228"><a href="#LazyRegressor-228"><span class="linenos">228</span></a>        <span class="n">R2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor-229"><a href="#LazyRegressor-229"><span class="linenos">229</span></a>        <span class="n">ADJR2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor-230"><a href="#LazyRegressor-230"><span class="linenos">230</span></a>        <span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor-231"><a href="#LazyRegressor-231"><span class="linenos">231</span></a>        <span class="c1"># WIN = []</span>
</span><span id="LazyRegressor-232"><a href="#LazyRegressor-232"><span class="linenos">232</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor-233"><a href="#LazyRegressor-233"><span class="linenos">233</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor-234"><a href="#LazyRegressor-234"><span class="linenos">234</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyRegressor-235"><a href="#LazyRegressor-235"><span class="linenos">235</span></a>
</span><span id="LazyRegressor-236"><a href="#LazyRegressor-236"><span class="linenos">236</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor-237"><a href="#LazyRegressor-237"><span class="linenos">237</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor-238"><a href="#LazyRegressor-238"><span class="linenos">238</span></a>
</span><span id="LazyRegressor-239"><a href="#LazyRegressor-239"><span class="linenos">239</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyRegressor-240"><a href="#LazyRegressor-240"><span class="linenos">240</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyRegressor-241"><a href="#LazyRegressor-241"><span class="linenos">241</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyRegressor-242"><a href="#LazyRegressor-242"><span class="linenos">242</span></a>
</span><span id="LazyRegressor-243"><a href="#LazyRegressor-243"><span class="linenos">243</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyRegressor-244"><a href="#LazyRegressor-244"><span class="linenos">244</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyRegressor-245"><a href="#LazyRegressor-245"><span class="linenos">245</span></a>
</span><span id="LazyRegressor-246"><a href="#LazyRegressor-246"><span class="linenos">246</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyRegressor-247"><a href="#LazyRegressor-247"><span class="linenos">247</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyRegressor-248"><a href="#LazyRegressor-248"><span class="linenos">248</span></a>        <span class="p">)</span>
</span><span id="LazyRegressor-249"><a href="#LazyRegressor-249"><span class="linenos">249</span></a>
</span><span id="LazyRegressor-250"><a href="#LazyRegressor-250"><span class="linenos">250</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyRegressor-251"><a href="#LazyRegressor-251"><span class="linenos">251</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyRegressor-252"><a href="#LazyRegressor-252"><span class="linenos">252</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyRegressor-253"><a href="#LazyRegressor-253"><span class="linenos">253</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyRegressor-254"><a href="#LazyRegressor-254"><span class="linenos">254</span></a>                    <span class="p">(</span>
</span><span id="LazyRegressor-255"><a href="#LazyRegressor-255"><span class="linenos">255</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-256"><a href="#LazyRegressor-256"><span class="linenos">256</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyRegressor-257"><a href="#LazyRegressor-257"><span class="linenos">257</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyRegressor-258"><a href="#LazyRegressor-258"><span class="linenos">258</span></a>                    <span class="p">),</span>
</span><span id="LazyRegressor-259"><a href="#LazyRegressor-259"><span class="linenos">259</span></a>                    <span class="p">(</span>
</span><span id="LazyRegressor-260"><a href="#LazyRegressor-260"><span class="linenos">260</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-261"><a href="#LazyRegressor-261"><span class="linenos">261</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyRegressor-262"><a href="#LazyRegressor-262"><span class="linenos">262</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyRegressor-263"><a href="#LazyRegressor-263"><span class="linenos">263</span></a>                    <span class="p">),</span>
</span><span id="LazyRegressor-264"><a href="#LazyRegressor-264"><span class="linenos">264</span></a>                <span class="p">]</span>
</span><span id="LazyRegressor-265"><a href="#LazyRegressor-265"><span class="linenos">265</span></a>            <span class="p">)</span>
</span><span id="LazyRegressor-266"><a href="#LazyRegressor-266"><span class="linenos">266</span></a>
</span><span id="LazyRegressor-267"><a href="#LazyRegressor-267"><span class="linenos">267</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyRegressor-268"><a href="#LazyRegressor-268"><span class="linenos">268</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="n">REGRESSORS</span>
</span><span id="LazyRegressor-269"><a href="#LazyRegressor-269"><span class="linenos">269</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyRegressor-270"><a href="#LazyRegressor-270"><span class="linenos">270</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyRegressor-271"><a href="#LazyRegressor-271"><span class="linenos">271</span></a>                <span class="p">(</span><span class="s2">&quot;CustomRegressor(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyRegressor-272"><a href="#LazyRegressor-272"><span class="linenos">272</span></a>                <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyRegressor-273"><a href="#LazyRegressor-273"><span class="linenos">273</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyRegressor-274"><a href="#LazyRegressor-274"><span class="linenos">274</span></a>                    <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyRegressor-275"><a href="#LazyRegressor-275"><span class="linenos">275</span></a>                    <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyRegressor-276"><a href="#LazyRegressor-276"><span class="linenos">276</span></a>                <span class="p">)</span>
</span><span id="LazyRegressor-277"><a href="#LazyRegressor-277"><span class="linenos">277</span></a>            <span class="p">]</span>
</span><span id="LazyRegressor-278"><a href="#LazyRegressor-278"><span class="linenos">278</span></a>
</span><span id="LazyRegressor-279"><a href="#LazyRegressor-279"><span class="linenos">279</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyRegressor-280"><a href="#LazyRegressor-280"><span class="linenos">280</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyRegressor-281"><a href="#LazyRegressor-281"><span class="linenos">281</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyRegressor-282"><a href="#LazyRegressor-282"><span class="linenos">282</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyRegressor-283"><a href="#LazyRegressor-283"><span class="linenos">283</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyRegressor-284"><a href="#LazyRegressor-284"><span class="linenos">284</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyRegressor-285"><a href="#LazyRegressor-285"><span class="linenos">285</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyRegressor-286"><a href="#LazyRegressor-286"><span class="linenos">286</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyRegressor-287"><a href="#LazyRegressor-287"><span class="linenos">287</span></a>                                <span class="p">(</span>
</span><span id="LazyRegressor-288"><a href="#LazyRegressor-288"><span class="linenos">288</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-289"><a href="#LazyRegressor-289"><span class="linenos">289</span></a>                                    <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyRegressor-290"><a href="#LazyRegressor-290"><span class="linenos">290</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyRegressor-291"><a href="#LazyRegressor-291"><span class="linenos">291</span></a>                                            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span>
</span><span id="LazyRegressor-292"><a href="#LazyRegressor-292"><span class="linenos">292</span></a>                                        <span class="p">),</span>
</span><span id="LazyRegressor-293"><a href="#LazyRegressor-293"><span class="linenos">293</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor-294"><a href="#LazyRegressor-294"><span class="linenos">294</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor-295"><a href="#LazyRegressor-295"><span class="linenos">295</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor-296"><a href="#LazyRegressor-296"><span class="linenos">296</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor-297"><a href="#LazyRegressor-297"><span class="linenos">297</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor-298"><a href="#LazyRegressor-298"><span class="linenos">298</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor-299"><a href="#LazyRegressor-299"><span class="linenos">299</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor-300"><a href="#LazyRegressor-300"><span class="linenos">300</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor-301"><a href="#LazyRegressor-301"><span class="linenos">301</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor-302"><a href="#LazyRegressor-302"><span class="linenos">302</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor-303"><a href="#LazyRegressor-303"><span class="linenos">303</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor-304"><a href="#LazyRegressor-304"><span class="linenos">304</span></a>                                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-305"><a href="#LazyRegressor-305"><span class="linenos">305</span></a>                                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-306"><a href="#LazyRegressor-306"><span class="linenos">306</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor-307"><a href="#LazyRegressor-307"><span class="linenos">307</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor-308"><a href="#LazyRegressor-308"><span class="linenos">308</span></a>                                    <span class="p">),</span>
</span><span id="LazyRegressor-309"><a href="#LazyRegressor-309"><span class="linenos">309</span></a>                                <span class="p">),</span>
</span><span id="LazyRegressor-310"><a href="#LazyRegressor-310"><span class="linenos">310</span></a>                            <span class="p">]</span>
</span><span id="LazyRegressor-311"><a href="#LazyRegressor-311"><span class="linenos">311</span></a>                        <span class="p">)</span>
</span><span id="LazyRegressor-312"><a href="#LazyRegressor-312"><span class="linenos">312</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyRegressor-313"><a href="#LazyRegressor-313"><span class="linenos">313</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyRegressor-314"><a href="#LazyRegressor-314"><span class="linenos">314</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyRegressor-315"><a href="#LazyRegressor-315"><span class="linenos">315</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyRegressor-316"><a href="#LazyRegressor-316"><span class="linenos">316</span></a>                                <span class="p">(</span>
</span><span id="LazyRegressor-317"><a href="#LazyRegressor-317"><span class="linenos">317</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-318"><a href="#LazyRegressor-318"><span class="linenos">318</span></a>                                    <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyRegressor-319"><a href="#LazyRegressor-319"><span class="linenos">319</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyRegressor-320"><a href="#LazyRegressor-320"><span class="linenos">320</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor-321"><a href="#LazyRegressor-321"><span class="linenos">321</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor-322"><a href="#LazyRegressor-322"><span class="linenos">322</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor-323"><a href="#LazyRegressor-323"><span class="linenos">323</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor-324"><a href="#LazyRegressor-324"><span class="linenos">324</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor-325"><a href="#LazyRegressor-325"><span class="linenos">325</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor-326"><a href="#LazyRegressor-326"><span class="linenos">326</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor-327"><a href="#LazyRegressor-327"><span class="linenos">327</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor-328"><a href="#LazyRegressor-328"><span class="linenos">328</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor-329"><a href="#LazyRegressor-329"><span class="linenos">329</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor-330"><a href="#LazyRegressor-330"><span class="linenos">330</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor-331"><a href="#LazyRegressor-331"><span class="linenos">331</span></a>                                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-332"><a href="#LazyRegressor-332"><span class="linenos">332</span></a>                                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-333"><a href="#LazyRegressor-333"><span class="linenos">333</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor-334"><a href="#LazyRegressor-334"><span class="linenos">334</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor-335"><a href="#LazyRegressor-335"><span class="linenos">335</span></a>                                    <span class="p">),</span>
</span><span id="LazyRegressor-336"><a href="#LazyRegressor-336"><span class="linenos">336</span></a>                                <span class="p">),</span>
</span><span id="LazyRegressor-337"><a href="#LazyRegressor-337"><span class="linenos">337</span></a>                            <span class="p">]</span>
</span><span id="LazyRegressor-338"><a href="#LazyRegressor-338"><span class="linenos">338</span></a>                        <span class="p">)</span>
</span><span id="LazyRegressor-339"><a href="#LazyRegressor-339"><span class="linenos">339</span></a>
</span><span id="LazyRegressor-340"><a href="#LazyRegressor-340"><span class="linenos">340</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyRegressor-341"><a href="#LazyRegressor-341"><span class="linenos">341</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyRegressor-342"><a href="#LazyRegressor-342"><span class="linenos">342</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyRegressor-343"><a href="#LazyRegressor-343"><span class="linenos">343</span></a>
</span><span id="LazyRegressor-344"><a href="#LazyRegressor-344"><span class="linenos">344</span></a>                    <span class="n">r_squared</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyRegressor-345"><a href="#LazyRegressor-345"><span class="linenos">345</span></a>                    <span class="n">adj_rsquared</span> <span class="o">=</span> <span class="n">adjusted_rsquared</span><span class="p">(</span>
</span><span id="LazyRegressor-346"><a href="#LazyRegressor-346"><span class="linenos">346</span></a>                        <span class="n">r_squared</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LazyRegressor-347"><a href="#LazyRegressor-347"><span class="linenos">347</span></a>                    <span class="p">)</span>
</span><span id="LazyRegressor-348"><a href="#LazyRegressor-348"><span class="linenos">348</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyRegressor-349"><a href="#LazyRegressor-349"><span class="linenos">349</span></a>
</span><span id="LazyRegressor-350"><a href="#LazyRegressor-350"><span class="linenos">350</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyRegressor-351"><a href="#LazyRegressor-351"><span class="linenos">351</span></a>                    <span class="n">R2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_squared</span><span class="p">)</span>
</span><span id="LazyRegressor-352"><a href="#LazyRegressor-352"><span class="linenos">352</span></a>                    <span class="n">ADJR2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_rsquared</span><span class="p">)</span>
</span><span id="LazyRegressor-353"><a href="#LazyRegressor-353"><span class="linenos">353</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyRegressor-354"><a href="#LazyRegressor-354"><span class="linenos">354</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyRegressor-355"><a href="#LazyRegressor-355"><span class="linenos">355</span></a>
</span><span id="LazyRegressor-356"><a href="#LazyRegressor-356"><span class="linenos">356</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor-357"><a href="#LazyRegressor-357"><span class="linenos">357</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyRegressor-358"><a href="#LazyRegressor-358"><span class="linenos">358</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyRegressor-359"><a href="#LazyRegressor-359"><span class="linenos">359</span></a>
</span><span id="LazyRegressor-360"><a href="#LazyRegressor-360"><span class="linenos">360</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyRegressor-361"><a href="#LazyRegressor-361"><span class="linenos">361</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyRegressor-362"><a href="#LazyRegressor-362"><span class="linenos">362</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyRegressor-363"><a href="#LazyRegressor-363"><span class="linenos">363</span></a>                            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">r_squared</span><span class="p">,</span>
</span><span id="LazyRegressor-364"><a href="#LazyRegressor-364"><span class="linenos">364</span></a>                            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">adj_rsquared</span><span class="p">,</span>
</span><span id="LazyRegressor-365"><a href="#LazyRegressor-365"><span class="linenos">365</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyRegressor-366"><a href="#LazyRegressor-366"><span class="linenos">366</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyRegressor-367"><a href="#LazyRegressor-367"><span class="linenos">367</span></a>                        <span class="p">}</span>
</span><span id="LazyRegressor-368"><a href="#LazyRegressor-368"><span class="linenos">368</span></a>
</span><span id="LazyRegressor-369"><a href="#LazyRegressor-369"><span class="linenos">369</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor-370"><a href="#LazyRegressor-370"><span class="linenos">370</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyRegressor-371"><a href="#LazyRegressor-371"><span class="linenos">371</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyRegressor-372"><a href="#LazyRegressor-372"><span class="linenos">372</span></a>                            <span class="p">)</span>
</span><span id="LazyRegressor-373"><a href="#LazyRegressor-373"><span class="linenos">373</span></a>
</span><span id="LazyRegressor-374"><a href="#LazyRegressor-374"><span class="linenos">374</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyRegressor-375"><a href="#LazyRegressor-375"><span class="linenos">375</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyRegressor-376"><a href="#LazyRegressor-376"><span class="linenos">376</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyRegressor-377"><a href="#LazyRegressor-377"><span class="linenos">377</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyRegressor-378"><a href="#LazyRegressor-378"><span class="linenos">378</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyRegressor-379"><a href="#LazyRegressor-379"><span class="linenos">379</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyRegressor-380"><a href="#LazyRegressor-380"><span class="linenos">380</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyRegressor-381"><a href="#LazyRegressor-381"><span class="linenos">381</span></a>
</span><span id="LazyRegressor-382"><a href="#LazyRegressor-382"><span class="linenos">382</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyRegressor-383"><a href="#LazyRegressor-383"><span class="linenos">383</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyRegressor-384"><a href="#LazyRegressor-384"><span class="linenos">384</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyRegressor-385"><a href="#LazyRegressor-385"><span class="linenos">385</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyRegressor-386"><a href="#LazyRegressor-386"><span class="linenos">386</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyRegressor-387"><a href="#LazyRegressor-387"><span class="linenos">387</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyRegressor-388"><a href="#LazyRegressor-388"><span class="linenos">388</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">),</span>
</span><span id="LazyRegressor-389"><a href="#LazyRegressor-389"><span class="linenos">389</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor-390"><a href="#LazyRegressor-390"><span class="linenos">390</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor-391"><a href="#LazyRegressor-391"><span class="linenos">391</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor-392"><a href="#LazyRegressor-392"><span class="linenos">392</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor-393"><a href="#LazyRegressor-393"><span class="linenos">393</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor-394"><a href="#LazyRegressor-394"><span class="linenos">394</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor-395"><a href="#LazyRegressor-395"><span class="linenos">395</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor-396"><a href="#LazyRegressor-396"><span class="linenos">396</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor-397"><a href="#LazyRegressor-397"><span class="linenos">397</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor-398"><a href="#LazyRegressor-398"><span class="linenos">398</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor-399"><a href="#LazyRegressor-399"><span class="linenos">399</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor-400"><a href="#LazyRegressor-400"><span class="linenos">400</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-401"><a href="#LazyRegressor-401"><span class="linenos">401</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-402"><a href="#LazyRegressor-402"><span class="linenos">402</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor-403"><a href="#LazyRegressor-403"><span class="linenos">403</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor-404"><a href="#LazyRegressor-404"><span class="linenos">404</span></a>                        <span class="p">)</span>
</span><span id="LazyRegressor-405"><a href="#LazyRegressor-405"><span class="linenos">405</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyRegressor-406"><a href="#LazyRegressor-406"><span class="linenos">406</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyRegressor-407"><a href="#LazyRegressor-407"><span class="linenos">407</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyRegressor-408"><a href="#LazyRegressor-408"><span class="linenos">408</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor-409"><a href="#LazyRegressor-409"><span class="linenos">409</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor-410"><a href="#LazyRegressor-410"><span class="linenos">410</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor-411"><a href="#LazyRegressor-411"><span class="linenos">411</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor-412"><a href="#LazyRegressor-412"><span class="linenos">412</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor-413"><a href="#LazyRegressor-413"><span class="linenos">413</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor-414"><a href="#LazyRegressor-414"><span class="linenos">414</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor-415"><a href="#LazyRegressor-415"><span class="linenos">415</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor-416"><a href="#LazyRegressor-416"><span class="linenos">416</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor-417"><a href="#LazyRegressor-417"><span class="linenos">417</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor-418"><a href="#LazyRegressor-418"><span class="linenos">418</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor-419"><a href="#LazyRegressor-419"><span class="linenos">419</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-420"><a href="#LazyRegressor-420"><span class="linenos">420</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-421"><a href="#LazyRegressor-421"><span class="linenos">421</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor-422"><a href="#LazyRegressor-422"><span class="linenos">422</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor-423"><a href="#LazyRegressor-423"><span class="linenos">423</span></a>                        <span class="p">)</span>
</span><span id="LazyRegressor-424"><a href="#LazyRegressor-424"><span class="linenos">424</span></a>
</span><span id="LazyRegressor-425"><a href="#LazyRegressor-425"><span class="linenos">425</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyRegressor-426"><a href="#LazyRegressor-426"><span class="linenos">426</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyRegressor-427"><a href="#LazyRegressor-427"><span class="linenos">427</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyRegressor-428"><a href="#LazyRegressor-428"><span class="linenos">428</span></a>
</span><span id="LazyRegressor-429"><a href="#LazyRegressor-429"><span class="linenos">429</span></a>                    <span class="n">r_squared</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyRegressor-430"><a href="#LazyRegressor-430"><span class="linenos">430</span></a>                    <span class="n">adj_rsquared</span> <span class="o">=</span> <span class="n">adjusted_rsquared</span><span class="p">(</span>
</span><span id="LazyRegressor-431"><a href="#LazyRegressor-431"><span class="linenos">431</span></a>                        <span class="n">r_squared</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LazyRegressor-432"><a href="#LazyRegressor-432"><span class="linenos">432</span></a>                    <span class="p">)</span>
</span><span id="LazyRegressor-433"><a href="#LazyRegressor-433"><span class="linenos">433</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyRegressor-434"><a href="#LazyRegressor-434"><span class="linenos">434</span></a>
</span><span id="LazyRegressor-435"><a href="#LazyRegressor-435"><span class="linenos">435</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyRegressor-436"><a href="#LazyRegressor-436"><span class="linenos">436</span></a>                    <span class="n">R2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_squared</span><span class="p">)</span>
</span><span id="LazyRegressor-437"><a href="#LazyRegressor-437"><span class="linenos">437</span></a>                    <span class="n">ADJR2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_rsquared</span><span class="p">)</span>
</span><span id="LazyRegressor-438"><a href="#LazyRegressor-438"><span class="linenos">438</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyRegressor-439"><a href="#LazyRegressor-439"><span class="linenos">439</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyRegressor-440"><a href="#LazyRegressor-440"><span class="linenos">440</span></a>
</span><span id="LazyRegressor-441"><a href="#LazyRegressor-441"><span class="linenos">441</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor-442"><a href="#LazyRegressor-442"><span class="linenos">442</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyRegressor-443"><a href="#LazyRegressor-443"><span class="linenos">443</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyRegressor-444"><a href="#LazyRegressor-444"><span class="linenos">444</span></a>
</span><span id="LazyRegressor-445"><a href="#LazyRegressor-445"><span class="linenos">445</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyRegressor-446"><a href="#LazyRegressor-446"><span class="linenos">446</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyRegressor-447"><a href="#LazyRegressor-447"><span class="linenos">447</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyRegressor-448"><a href="#LazyRegressor-448"><span class="linenos">448</span></a>                            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">r_squared</span><span class="p">,</span>
</span><span id="LazyRegressor-449"><a href="#LazyRegressor-449"><span class="linenos">449</span></a>                            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">adj_rsquared</span><span class="p">,</span>
</span><span id="LazyRegressor-450"><a href="#LazyRegressor-450"><span class="linenos">450</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyRegressor-451"><a href="#LazyRegressor-451"><span class="linenos">451</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyRegressor-452"><a href="#LazyRegressor-452"><span class="linenos">452</span></a>                        <span class="p">}</span>
</span><span id="LazyRegressor-453"><a href="#LazyRegressor-453"><span class="linenos">453</span></a>
</span><span id="LazyRegressor-454"><a href="#LazyRegressor-454"><span class="linenos">454</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor-455"><a href="#LazyRegressor-455"><span class="linenos">455</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyRegressor-456"><a href="#LazyRegressor-456"><span class="linenos">456</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyRegressor-457"><a href="#LazyRegressor-457"><span class="linenos">457</span></a>                            <span class="p">)</span>
</span><span id="LazyRegressor-458"><a href="#LazyRegressor-458"><span class="linenos">458</span></a>
</span><span id="LazyRegressor-459"><a href="#LazyRegressor-459"><span class="linenos">459</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyRegressor-460"><a href="#LazyRegressor-460"><span class="linenos">460</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyRegressor-461"><a href="#LazyRegressor-461"><span class="linenos">461</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyRegressor-462"><a href="#LazyRegressor-462"><span class="linenos">462</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyRegressor-463"><a href="#LazyRegressor-463"><span class="linenos">463</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyRegressor-464"><a href="#LazyRegressor-464"><span class="linenos">464</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyRegressor-465"><a href="#LazyRegressor-465"><span class="linenos">465</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyRegressor-466"><a href="#LazyRegressor-466"><span class="linenos">466</span></a>
</span><span id="LazyRegressor-467"><a href="#LazyRegressor-467"><span class="linenos">467</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyRegressor-468"><a href="#LazyRegressor-468"><span class="linenos">468</span></a>            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyRegressor-469"><a href="#LazyRegressor-469"><span class="linenos">469</span></a>            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">ADJR2</span><span class="p">,</span>
</span><span id="LazyRegressor-470"><a href="#LazyRegressor-470"><span class="linenos">470</span></a>            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">R2</span><span class="p">,</span>
</span><span id="LazyRegressor-471"><a href="#LazyRegressor-471"><span class="linenos">471</span></a>            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyRegressor-472"><a href="#LazyRegressor-472"><span class="linenos">472</span></a>            <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyRegressor-473"><a href="#LazyRegressor-473"><span class="linenos">473</span></a>        <span class="p">}</span>
</span><span id="LazyRegressor-474"><a href="#LazyRegressor-474"><span class="linenos">474</span></a>
</span><span id="LazyRegressor-475"><a href="#LazyRegressor-475"><span class="linenos">475</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor-476"><a href="#LazyRegressor-476"><span class="linenos">476</span></a>            <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">CUSTOM_METRIC</span>
</span><span id="LazyRegressor-477"><a href="#LazyRegressor-477"><span class="linenos">477</span></a>
</span><span id="LazyRegressor-478"><a href="#LazyRegressor-478"><span class="linenos">478</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LazyRegressor-479"><a href="#LazyRegressor-479"><span class="linenos">479</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyRegressor-480"><a href="#LazyRegressor-480"><span class="linenos">480</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyRegressor-481"><a href="#LazyRegressor-481"><span class="linenos">481</span></a>        <span class="p">)</span>
</span><span id="LazyRegressor-482"><a href="#LazyRegressor-482"><span class="linenos">482</span></a>
</span><span id="LazyRegressor-483"><a href="#LazyRegressor-483"><span class="linenos">483</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyRegressor-484"><a href="#LazyRegressor-484"><span class="linenos">484</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyRegressor-485"><a href="#LazyRegressor-485"><span class="linenos">485</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span><span id="LazyRegressor-486"><a href="#LazyRegressor-486"><span class="linenos">486</span></a>
</span><span id="LazyRegressor-487"><a href="#LazyRegressor-487"><span class="linenos">487</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyRegressor-488"><a href="#LazyRegressor-488"><span class="linenos">488</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyRegressor-489"><a href="#LazyRegressor-489"><span class="linenos">489</span></a><span class="sd">        This function returns all the model objects trained in fit function.</span>
</span><span id="LazyRegressor-490"><a href="#LazyRegressor-490"><span class="linenos">490</span></a><span class="sd">        If fit is not called already, then we call fit and then return the models.</span>
</span><span id="LazyRegressor-491"><a href="#LazyRegressor-491"><span class="linenos">491</span></a><span class="sd">        Parameters</span>
</span><span id="LazyRegressor-492"><a href="#LazyRegressor-492"><span class="linenos">492</span></a><span class="sd">        ----------</span>
</span><span id="LazyRegressor-493"><a href="#LazyRegressor-493"><span class="linenos">493</span></a><span class="sd">        X_train : array-like,</span>
</span><span id="LazyRegressor-494"><a href="#LazyRegressor-494"><span class="linenos">494</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor-495"><a href="#LazyRegressor-495"><span class="linenos">495</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyRegressor-496"><a href="#LazyRegressor-496"><span class="linenos">496</span></a><span class="sd">        X_test : array-like,</span>
</span><span id="LazyRegressor-497"><a href="#LazyRegressor-497"><span class="linenos">497</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor-498"><a href="#LazyRegressor-498"><span class="linenos">498</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyRegressor-499"><a href="#LazyRegressor-499"><span class="linenos">499</span></a><span class="sd">        y_train : array-like,</span>
</span><span id="LazyRegressor-500"><a href="#LazyRegressor-500"><span class="linenos">500</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor-501"><a href="#LazyRegressor-501"><span class="linenos">501</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyRegressor-502"><a href="#LazyRegressor-502"><span class="linenos">502</span></a><span class="sd">        y_test : array-like,</span>
</span><span id="LazyRegressor-503"><a href="#LazyRegressor-503"><span class="linenos">503</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor-504"><a href="#LazyRegressor-504"><span class="linenos">504</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyRegressor-505"><a href="#LazyRegressor-505"><span class="linenos">505</span></a><span class="sd">        Returns</span>
</span><span id="LazyRegressor-506"><a href="#LazyRegressor-506"><span class="linenos">506</span></a><span class="sd">        -------</span>
</span><span id="LazyRegressor-507"><a href="#LazyRegressor-507"><span class="linenos">507</span></a><span class="sd">        models: dict-object,</span>
</span><span id="LazyRegressor-508"><a href="#LazyRegressor-508"><span class="linenos">508</span></a><span class="sd">            Returns a dictionary with each model pipeline as value</span>
</span><span id="LazyRegressor-509"><a href="#LazyRegressor-509"><span class="linenos">509</span></a><span class="sd">            with key as name of models.</span>
</span><span id="LazyRegressor-510"><a href="#LazyRegressor-510"><span class="linenos">510</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyRegressor-511"><a href="#LazyRegressor-511"><span class="linenos">511</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyRegressor-512"><a href="#LazyRegressor-512"><span class="linenos">512</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span><span id="LazyRegressor-513"><a href="#LazyRegressor-513"><span class="linenos">513</span></a>
</span><span id="LazyRegressor-514"><a href="#LazyRegressor-514"><span class="linenos">514</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>Fitting a collection of regression models using nnetsauce's CustomRegressor</p>

<p>Parameters:</p>

<pre><code>verbose: int, optional (default=0)
    Any positive number for verbosity.

ignore_warnings: bool, optional (default=True)
    When set to True, the warning related to algorigms that are not able to run are ignored.

custom_metric: function, optional (default=None)
    When function is provided, models are evaluated based on the custom evaluation metric provided.

predictions: bool, optional (default=False)
    When set to True, the predictions of all the models models are returned as dataframe.

sort_by: string, optional (default='Accuracy')
    Sort models by a metric. Available options are 'Accuracy', 'Balanced Accuracy', 'ROC AUC', 'F1 Score'
    or a custom metric identified by its name and provided by custom_metric.

random_state: int, optional (default=42)
    Reproducibiility seed.

estimators: list, optional (default='all')
    a list of Estimators names or just 'all' (default='all')

preprocess: bool
    preprocessing is done when set to True

n_jobs : int, when possible, run in parallel
    For now, only used by individual models that support it.

n_layers: int, optional (default=3)
    Number of layers of CustomRegressors to be used.

All the other parameters are the same as CustomRegressor's.
</code></pre>

<p>Examples:
    <div class="pdoc-code codehilite">
    <pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
    <span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_diabetes</span>
    <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_diabetes</span><span class="p">()</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>
    <span class="n">y</span><span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">target</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
    <span class="n">regr</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">LazyRegressor</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">models</span><span class="p">,</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="n">model_dictionary</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">provide_models</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">models</span><span class="p">)</span>
    </code></pre>
    </div></p>
</div>


                                <div id="LazyRegressor.fit" class="classattr">
                                            <input id="LazyRegressor.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">y_train</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyRegressor.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyRegressor.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyRegressor.fit-198"><a href="#LazyRegressor.fit-198"><span class="linenos">198</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyRegressor.fit-199"><a href="#LazyRegressor.fit-199"><span class="linenos">199</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X_train and y_train, predict and score on X_test, y_test.</span>
</span><span id="LazyRegressor.fit-200"><a href="#LazyRegressor.fit-200"><span class="linenos">200</span></a>
</span><span id="LazyRegressor.fit-201"><a href="#LazyRegressor.fit-201"><span class="linenos">201</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyRegressor.fit-202"><a href="#LazyRegressor.fit-202"><span class="linenos">202</span></a>
</span><span id="LazyRegressor.fit-203"><a href="#LazyRegressor.fit-203"><span class="linenos">203</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyRegressor.fit-204"><a href="#LazyRegressor.fit-204"><span class="linenos">204</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor.fit-205"><a href="#LazyRegressor.fit-205"><span class="linenos">205</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyRegressor.fit-206"><a href="#LazyRegressor.fit-206"><span class="linenos">206</span></a>
</span><span id="LazyRegressor.fit-207"><a href="#LazyRegressor.fit-207"><span class="linenos">207</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyRegressor.fit-208"><a href="#LazyRegressor.fit-208"><span class="linenos">208</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor.fit-209"><a href="#LazyRegressor.fit-209"><span class="linenos">209</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyRegressor.fit-210"><a href="#LazyRegressor.fit-210"><span class="linenos">210</span></a>
</span><span id="LazyRegressor.fit-211"><a href="#LazyRegressor.fit-211"><span class="linenos">211</span></a><span class="sd">            y_train : array-like,</span>
</span><span id="LazyRegressor.fit-212"><a href="#LazyRegressor.fit-212"><span class="linenos">212</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor.fit-213"><a href="#LazyRegressor.fit-213"><span class="linenos">213</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyRegressor.fit-214"><a href="#LazyRegressor.fit-214"><span class="linenos">214</span></a>
</span><span id="LazyRegressor.fit-215"><a href="#LazyRegressor.fit-215"><span class="linenos">215</span></a><span class="sd">            y_test : array-like,</span>
</span><span id="LazyRegressor.fit-216"><a href="#LazyRegressor.fit-216"><span class="linenos">216</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor.fit-217"><a href="#LazyRegressor.fit-217"><span class="linenos">217</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyRegressor.fit-218"><a href="#LazyRegressor.fit-218"><span class="linenos">218</span></a>
</span><span id="LazyRegressor.fit-219"><a href="#LazyRegressor.fit-219"><span class="linenos">219</span></a><span class="sd">        Returns:</span>
</span><span id="LazyRegressor.fit-220"><a href="#LazyRegressor.fit-220"><span class="linenos">220</span></a>
</span><span id="LazyRegressor.fit-221"><a href="#LazyRegressor.fit-221"><span class="linenos">221</span></a><span class="sd">        scores : Pandas DataFrame</span>
</span><span id="LazyRegressor.fit-222"><a href="#LazyRegressor.fit-222"><span class="linenos">222</span></a><span class="sd">            Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyRegressor.fit-223"><a href="#LazyRegressor.fit-223"><span class="linenos">223</span></a>
</span><span id="LazyRegressor.fit-224"><a href="#LazyRegressor.fit-224"><span class="linenos">224</span></a><span class="sd">        predictions : Pandas DataFrame</span>
</span><span id="LazyRegressor.fit-225"><a href="#LazyRegressor.fit-225"><span class="linenos">225</span></a><span class="sd">            Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyRegressor.fit-226"><a href="#LazyRegressor.fit-226"><span class="linenos">226</span></a>
</span><span id="LazyRegressor.fit-227"><a href="#LazyRegressor.fit-227"><span class="linenos">227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyRegressor.fit-228"><a href="#LazyRegressor.fit-228"><span class="linenos">228</span></a>        <span class="n">R2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor.fit-229"><a href="#LazyRegressor.fit-229"><span class="linenos">229</span></a>        <span class="n">ADJR2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor.fit-230"><a href="#LazyRegressor.fit-230"><span class="linenos">230</span></a>        <span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor.fit-231"><a href="#LazyRegressor.fit-231"><span class="linenos">231</span></a>        <span class="c1"># WIN = []</span>
</span><span id="LazyRegressor.fit-232"><a href="#LazyRegressor.fit-232"><span class="linenos">232</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor.fit-233"><a href="#LazyRegressor.fit-233"><span class="linenos">233</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor.fit-234"><a href="#LazyRegressor.fit-234"><span class="linenos">234</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyRegressor.fit-235"><a href="#LazyRegressor.fit-235"><span class="linenos">235</span></a>
</span><span id="LazyRegressor.fit-236"><a href="#LazyRegressor.fit-236"><span class="linenos">236</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-237"><a href="#LazyRegressor.fit-237"><span class="linenos">237</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor.fit-238"><a href="#LazyRegressor.fit-238"><span class="linenos">238</span></a>
</span><span id="LazyRegressor.fit-239"><a href="#LazyRegressor.fit-239"><span class="linenos">239</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyRegressor.fit-240"><a href="#LazyRegressor.fit-240"><span class="linenos">240</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-241"><a href="#LazyRegressor.fit-241"><span class="linenos">241</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-242"><a href="#LazyRegressor.fit-242"><span class="linenos">242</span></a>
</span><span id="LazyRegressor.fit-243"><a href="#LazyRegressor.fit-243"><span class="linenos">243</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyRegressor.fit-244"><a href="#LazyRegressor.fit-244"><span class="linenos">244</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyRegressor.fit-245"><a href="#LazyRegressor.fit-245"><span class="linenos">245</span></a>
</span><span id="LazyRegressor.fit-246"><a href="#LazyRegressor.fit-246"><span class="linenos">246</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-247"><a href="#LazyRegressor.fit-247"><span class="linenos">247</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyRegressor.fit-248"><a href="#LazyRegressor.fit-248"><span class="linenos">248</span></a>        <span class="p">)</span>
</span><span id="LazyRegressor.fit-249"><a href="#LazyRegressor.fit-249"><span class="linenos">249</span></a>
</span><span id="LazyRegressor.fit-250"><a href="#LazyRegressor.fit-250"><span class="linenos">250</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-251"><a href="#LazyRegressor.fit-251"><span class="linenos">251</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-252"><a href="#LazyRegressor.fit-252"><span class="linenos">252</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyRegressor.fit-253"><a href="#LazyRegressor.fit-253"><span class="linenos">253</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyRegressor.fit-254"><a href="#LazyRegressor.fit-254"><span class="linenos">254</span></a>                    <span class="p">(</span>
</span><span id="LazyRegressor.fit-255"><a href="#LazyRegressor.fit-255"><span class="linenos">255</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-256"><a href="#LazyRegressor.fit-256"><span class="linenos">256</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-257"><a href="#LazyRegressor.fit-257"><span class="linenos">257</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-258"><a href="#LazyRegressor.fit-258"><span class="linenos">258</span></a>                    <span class="p">),</span>
</span><span id="LazyRegressor.fit-259"><a href="#LazyRegressor.fit-259"><span class="linenos">259</span></a>                    <span class="p">(</span>
</span><span id="LazyRegressor.fit-260"><a href="#LazyRegressor.fit-260"><span class="linenos">260</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-261"><a href="#LazyRegressor.fit-261"><span class="linenos">261</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-262"><a href="#LazyRegressor.fit-262"><span class="linenos">262</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-263"><a href="#LazyRegressor.fit-263"><span class="linenos">263</span></a>                    <span class="p">),</span>
</span><span id="LazyRegressor.fit-264"><a href="#LazyRegressor.fit-264"><span class="linenos">264</span></a>                <span class="p">]</span>
</span><span id="LazyRegressor.fit-265"><a href="#LazyRegressor.fit-265"><span class="linenos">265</span></a>            <span class="p">)</span>
</span><span id="LazyRegressor.fit-266"><a href="#LazyRegressor.fit-266"><span class="linenos">266</span></a>
</span><span id="LazyRegressor.fit-267"><a href="#LazyRegressor.fit-267"><span class="linenos">267</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-268"><a href="#LazyRegressor.fit-268"><span class="linenos">268</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="n">REGRESSORS</span>
</span><span id="LazyRegressor.fit-269"><a href="#LazyRegressor.fit-269"><span class="linenos">269</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-270"><a href="#LazyRegressor.fit-270"><span class="linenos">270</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyRegressor.fit-271"><a href="#LazyRegressor.fit-271"><span class="linenos">271</span></a>                <span class="p">(</span><span class="s2">&quot;CustomRegressor(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyRegressor.fit-272"><a href="#LazyRegressor.fit-272"><span class="linenos">272</span></a>                <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyRegressor.fit-273"><a href="#LazyRegressor.fit-273"><span class="linenos">273</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyRegressor.fit-274"><a href="#LazyRegressor.fit-274"><span class="linenos">274</span></a>                    <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-275"><a href="#LazyRegressor.fit-275"><span class="linenos">275</span></a>                    <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-276"><a href="#LazyRegressor.fit-276"><span class="linenos">276</span></a>                <span class="p">)</span>
</span><span id="LazyRegressor.fit-277"><a href="#LazyRegressor.fit-277"><span class="linenos">277</span></a>            <span class="p">]</span>
</span><span id="LazyRegressor.fit-278"><a href="#LazyRegressor.fit-278"><span class="linenos">278</span></a>
</span><span id="LazyRegressor.fit-279"><a href="#LazyRegressor.fit-279"><span class="linenos">279</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-280"><a href="#LazyRegressor.fit-280"><span class="linenos">280</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyRegressor.fit-281"><a href="#LazyRegressor.fit-281"><span class="linenos">281</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyRegressor.fit-282"><a href="#LazyRegressor.fit-282"><span class="linenos">282</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-283"><a href="#LazyRegressor.fit-283"><span class="linenos">283</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyRegressor.fit-284"><a href="#LazyRegressor.fit-284"><span class="linenos">284</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-285"><a href="#LazyRegressor.fit-285"><span class="linenos">285</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyRegressor.fit-286"><a href="#LazyRegressor.fit-286"><span class="linenos">286</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyRegressor.fit-287"><a href="#LazyRegressor.fit-287"><span class="linenos">287</span></a>                                <span class="p">(</span>
</span><span id="LazyRegressor.fit-288"><a href="#LazyRegressor.fit-288"><span class="linenos">288</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-289"><a href="#LazyRegressor.fit-289"><span class="linenos">289</span></a>                                    <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-290"><a href="#LazyRegressor.fit-290"><span class="linenos">290</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-291"><a href="#LazyRegressor.fit-291"><span class="linenos">291</span></a>                                            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span>
</span><span id="LazyRegressor.fit-292"><a href="#LazyRegressor.fit-292"><span class="linenos">292</span></a>                                        <span class="p">),</span>
</span><span id="LazyRegressor.fit-293"><a href="#LazyRegressor.fit-293"><span class="linenos">293</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-294"><a href="#LazyRegressor.fit-294"><span class="linenos">294</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-295"><a href="#LazyRegressor.fit-295"><span class="linenos">295</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-296"><a href="#LazyRegressor.fit-296"><span class="linenos">296</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-297"><a href="#LazyRegressor.fit-297"><span class="linenos">297</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-298"><a href="#LazyRegressor.fit-298"><span class="linenos">298</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-299"><a href="#LazyRegressor.fit-299"><span class="linenos">299</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-300"><a href="#LazyRegressor.fit-300"><span class="linenos">300</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-301"><a href="#LazyRegressor.fit-301"><span class="linenos">301</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-302"><a href="#LazyRegressor.fit-302"><span class="linenos">302</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-303"><a href="#LazyRegressor.fit-303"><span class="linenos">303</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-304"><a href="#LazyRegressor.fit-304"><span class="linenos">304</span></a>                                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-305"><a href="#LazyRegressor.fit-305"><span class="linenos">305</span></a>                                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-306"><a href="#LazyRegressor.fit-306"><span class="linenos">306</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-307"><a href="#LazyRegressor.fit-307"><span class="linenos">307</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-308"><a href="#LazyRegressor.fit-308"><span class="linenos">308</span></a>                                    <span class="p">),</span>
</span><span id="LazyRegressor.fit-309"><a href="#LazyRegressor.fit-309"><span class="linenos">309</span></a>                                <span class="p">),</span>
</span><span id="LazyRegressor.fit-310"><a href="#LazyRegressor.fit-310"><span class="linenos">310</span></a>                            <span class="p">]</span>
</span><span id="LazyRegressor.fit-311"><a href="#LazyRegressor.fit-311"><span class="linenos">311</span></a>                        <span class="p">)</span>
</span><span id="LazyRegressor.fit-312"><a href="#LazyRegressor.fit-312"><span class="linenos">312</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-313"><a href="#LazyRegressor.fit-313"><span class="linenos">313</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-314"><a href="#LazyRegressor.fit-314"><span class="linenos">314</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyRegressor.fit-315"><a href="#LazyRegressor.fit-315"><span class="linenos">315</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyRegressor.fit-316"><a href="#LazyRegressor.fit-316"><span class="linenos">316</span></a>                                <span class="p">(</span>
</span><span id="LazyRegressor.fit-317"><a href="#LazyRegressor.fit-317"><span class="linenos">317</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-318"><a href="#LazyRegressor.fit-318"><span class="linenos">318</span></a>                                    <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-319"><a href="#LazyRegressor.fit-319"><span class="linenos">319</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyRegressor.fit-320"><a href="#LazyRegressor.fit-320"><span class="linenos">320</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-321"><a href="#LazyRegressor.fit-321"><span class="linenos">321</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-322"><a href="#LazyRegressor.fit-322"><span class="linenos">322</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-323"><a href="#LazyRegressor.fit-323"><span class="linenos">323</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-324"><a href="#LazyRegressor.fit-324"><span class="linenos">324</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-325"><a href="#LazyRegressor.fit-325"><span class="linenos">325</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-326"><a href="#LazyRegressor.fit-326"><span class="linenos">326</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-327"><a href="#LazyRegressor.fit-327"><span class="linenos">327</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-328"><a href="#LazyRegressor.fit-328"><span class="linenos">328</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-329"><a href="#LazyRegressor.fit-329"><span class="linenos">329</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-330"><a href="#LazyRegressor.fit-330"><span class="linenos">330</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-331"><a href="#LazyRegressor.fit-331"><span class="linenos">331</span></a>                                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-332"><a href="#LazyRegressor.fit-332"><span class="linenos">332</span></a>                                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-333"><a href="#LazyRegressor.fit-333"><span class="linenos">333</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-334"><a href="#LazyRegressor.fit-334"><span class="linenos">334</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-335"><a href="#LazyRegressor.fit-335"><span class="linenos">335</span></a>                                    <span class="p">),</span>
</span><span id="LazyRegressor.fit-336"><a href="#LazyRegressor.fit-336"><span class="linenos">336</span></a>                                <span class="p">),</span>
</span><span id="LazyRegressor.fit-337"><a href="#LazyRegressor.fit-337"><span class="linenos">337</span></a>                            <span class="p">]</span>
</span><span id="LazyRegressor.fit-338"><a href="#LazyRegressor.fit-338"><span class="linenos">338</span></a>                        <span class="p">)</span>
</span><span id="LazyRegressor.fit-339"><a href="#LazyRegressor.fit-339"><span class="linenos">339</span></a>
</span><span id="LazyRegressor.fit-340"><a href="#LazyRegressor.fit-340"><span class="linenos">340</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-341"><a href="#LazyRegressor.fit-341"><span class="linenos">341</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyRegressor.fit-342"><a href="#LazyRegressor.fit-342"><span class="linenos">342</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-343"><a href="#LazyRegressor.fit-343"><span class="linenos">343</span></a>
</span><span id="LazyRegressor.fit-344"><a href="#LazyRegressor.fit-344"><span class="linenos">344</span></a>                    <span class="n">r_squared</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-345"><a href="#LazyRegressor.fit-345"><span class="linenos">345</span></a>                    <span class="n">adj_rsquared</span> <span class="o">=</span> <span class="n">adjusted_rsquared</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-346"><a href="#LazyRegressor.fit-346"><span class="linenos">346</span></a>                        <span class="n">r_squared</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LazyRegressor.fit-347"><a href="#LazyRegressor.fit-347"><span class="linenos">347</span></a>                    <span class="p">)</span>
</span><span id="LazyRegressor.fit-348"><a href="#LazyRegressor.fit-348"><span class="linenos">348</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-349"><a href="#LazyRegressor.fit-349"><span class="linenos">349</span></a>
</span><span id="LazyRegressor.fit-350"><a href="#LazyRegressor.fit-350"><span class="linenos">350</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-351"><a href="#LazyRegressor.fit-351"><span class="linenos">351</span></a>                    <span class="n">R2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_squared</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-352"><a href="#LazyRegressor.fit-352"><span class="linenos">352</span></a>                    <span class="n">ADJR2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_rsquared</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-353"><a href="#LazyRegressor.fit-353"><span class="linenos">353</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-354"><a href="#LazyRegressor.fit-354"><span class="linenos">354</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-355"><a href="#LazyRegressor.fit-355"><span class="linenos">355</span></a>
</span><span id="LazyRegressor.fit-356"><a href="#LazyRegressor.fit-356"><span class="linenos">356</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-357"><a href="#LazyRegressor.fit-357"><span class="linenos">357</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-358"><a href="#LazyRegressor.fit-358"><span class="linenos">358</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-359"><a href="#LazyRegressor.fit-359"><span class="linenos">359</span></a>
</span><span id="LazyRegressor.fit-360"><a href="#LazyRegressor.fit-360"><span class="linenos">360</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-361"><a href="#LazyRegressor.fit-361"><span class="linenos">361</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyRegressor.fit-362"><a href="#LazyRegressor.fit-362"><span class="linenos">362</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-363"><a href="#LazyRegressor.fit-363"><span class="linenos">363</span></a>                            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">r_squared</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-364"><a href="#LazyRegressor.fit-364"><span class="linenos">364</span></a>                            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">adj_rsquared</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-365"><a href="#LazyRegressor.fit-365"><span class="linenos">365</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-366"><a href="#LazyRegressor.fit-366"><span class="linenos">366</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-367"><a href="#LazyRegressor.fit-367"><span class="linenos">367</span></a>                        <span class="p">}</span>
</span><span id="LazyRegressor.fit-368"><a href="#LazyRegressor.fit-368"><span class="linenos">368</span></a>
</span><span id="LazyRegressor.fit-369"><a href="#LazyRegressor.fit-369"><span class="linenos">369</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-370"><a href="#LazyRegressor.fit-370"><span class="linenos">370</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyRegressor.fit-371"><a href="#LazyRegressor.fit-371"><span class="linenos">371</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyRegressor.fit-372"><a href="#LazyRegressor.fit-372"><span class="linenos">372</span></a>                            <span class="p">)</span>
</span><span id="LazyRegressor.fit-373"><a href="#LazyRegressor.fit-373"><span class="linenos">373</span></a>
</span><span id="LazyRegressor.fit-374"><a href="#LazyRegressor.fit-374"><span class="linenos">374</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-375"><a href="#LazyRegressor.fit-375"><span class="linenos">375</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-376"><a href="#LazyRegressor.fit-376"><span class="linenos">376</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyRegressor.fit-377"><a href="#LazyRegressor.fit-377"><span class="linenos">377</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-378"><a href="#LazyRegressor.fit-378"><span class="linenos">378</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-379"><a href="#LazyRegressor.fit-379"><span class="linenos">379</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-380"><a href="#LazyRegressor.fit-380"><span class="linenos">380</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-381"><a href="#LazyRegressor.fit-381"><span class="linenos">381</span></a>
</span><span id="LazyRegressor.fit-382"><a href="#LazyRegressor.fit-382"><span class="linenos">382</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-383"><a href="#LazyRegressor.fit-383"><span class="linenos">383</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyRegressor.fit-384"><a href="#LazyRegressor.fit-384"><span class="linenos">384</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyRegressor.fit-385"><a href="#LazyRegressor.fit-385"><span class="linenos">385</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-386"><a href="#LazyRegressor.fit-386"><span class="linenos">386</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyRegressor.fit-387"><a href="#LazyRegressor.fit-387"><span class="linenos">387</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-388"><a href="#LazyRegressor.fit-388"><span class="linenos">388</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">),</span>
</span><span id="LazyRegressor.fit-389"><a href="#LazyRegressor.fit-389"><span class="linenos">389</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-390"><a href="#LazyRegressor.fit-390"><span class="linenos">390</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-391"><a href="#LazyRegressor.fit-391"><span class="linenos">391</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-392"><a href="#LazyRegressor.fit-392"><span class="linenos">392</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-393"><a href="#LazyRegressor.fit-393"><span class="linenos">393</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-394"><a href="#LazyRegressor.fit-394"><span class="linenos">394</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-395"><a href="#LazyRegressor.fit-395"><span class="linenos">395</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-396"><a href="#LazyRegressor.fit-396"><span class="linenos">396</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-397"><a href="#LazyRegressor.fit-397"><span class="linenos">397</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-398"><a href="#LazyRegressor.fit-398"><span class="linenos">398</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-399"><a href="#LazyRegressor.fit-399"><span class="linenos">399</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-400"><a href="#LazyRegressor.fit-400"><span class="linenos">400</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-401"><a href="#LazyRegressor.fit-401"><span class="linenos">401</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-402"><a href="#LazyRegressor.fit-402"><span class="linenos">402</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-403"><a href="#LazyRegressor.fit-403"><span class="linenos">403</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-404"><a href="#LazyRegressor.fit-404"><span class="linenos">404</span></a>                        <span class="p">)</span>
</span><span id="LazyRegressor.fit-405"><a href="#LazyRegressor.fit-405"><span class="linenos">405</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-406"><a href="#LazyRegressor.fit-406"><span class="linenos">406</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-407"><a href="#LazyRegressor.fit-407"><span class="linenos">407</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyRegressor.fit-408"><a href="#LazyRegressor.fit-408"><span class="linenos">408</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-409"><a href="#LazyRegressor.fit-409"><span class="linenos">409</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-410"><a href="#LazyRegressor.fit-410"><span class="linenos">410</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-411"><a href="#LazyRegressor.fit-411"><span class="linenos">411</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-412"><a href="#LazyRegressor.fit-412"><span class="linenos">412</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-413"><a href="#LazyRegressor.fit-413"><span class="linenos">413</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-414"><a href="#LazyRegressor.fit-414"><span class="linenos">414</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-415"><a href="#LazyRegressor.fit-415"><span class="linenos">415</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-416"><a href="#LazyRegressor.fit-416"><span class="linenos">416</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-417"><a href="#LazyRegressor.fit-417"><span class="linenos">417</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-418"><a href="#LazyRegressor.fit-418"><span class="linenos">418</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-419"><a href="#LazyRegressor.fit-419"><span class="linenos">419</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-420"><a href="#LazyRegressor.fit-420"><span class="linenos">420</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-421"><a href="#LazyRegressor.fit-421"><span class="linenos">421</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-422"><a href="#LazyRegressor.fit-422"><span class="linenos">422</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-423"><a href="#LazyRegressor.fit-423"><span class="linenos">423</span></a>                        <span class="p">)</span>
</span><span id="LazyRegressor.fit-424"><a href="#LazyRegressor.fit-424"><span class="linenos">424</span></a>
</span><span id="LazyRegressor.fit-425"><a href="#LazyRegressor.fit-425"><span class="linenos">425</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-426"><a href="#LazyRegressor.fit-426"><span class="linenos">426</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyRegressor.fit-427"><a href="#LazyRegressor.fit-427"><span class="linenos">427</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-428"><a href="#LazyRegressor.fit-428"><span class="linenos">428</span></a>
</span><span id="LazyRegressor.fit-429"><a href="#LazyRegressor.fit-429"><span class="linenos">429</span></a>                    <span class="n">r_squared</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-430"><a href="#LazyRegressor.fit-430"><span class="linenos">430</span></a>                    <span class="n">adj_rsquared</span> <span class="o">=</span> <span class="n">adjusted_rsquared</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-431"><a href="#LazyRegressor.fit-431"><span class="linenos">431</span></a>                        <span class="n">r_squared</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LazyRegressor.fit-432"><a href="#LazyRegressor.fit-432"><span class="linenos">432</span></a>                    <span class="p">)</span>
</span><span id="LazyRegressor.fit-433"><a href="#LazyRegressor.fit-433"><span class="linenos">433</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-434"><a href="#LazyRegressor.fit-434"><span class="linenos">434</span></a>
</span><span id="LazyRegressor.fit-435"><a href="#LazyRegressor.fit-435"><span class="linenos">435</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-436"><a href="#LazyRegressor.fit-436"><span class="linenos">436</span></a>                    <span class="n">R2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_squared</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-437"><a href="#LazyRegressor.fit-437"><span class="linenos">437</span></a>                    <span class="n">ADJR2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_rsquared</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-438"><a href="#LazyRegressor.fit-438"><span class="linenos">438</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-439"><a href="#LazyRegressor.fit-439"><span class="linenos">439</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-440"><a href="#LazyRegressor.fit-440"><span class="linenos">440</span></a>
</span><span id="LazyRegressor.fit-441"><a href="#LazyRegressor.fit-441"><span class="linenos">441</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-442"><a href="#LazyRegressor.fit-442"><span class="linenos">442</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-443"><a href="#LazyRegressor.fit-443"><span class="linenos">443</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-444"><a href="#LazyRegressor.fit-444"><span class="linenos">444</span></a>
</span><span id="LazyRegressor.fit-445"><a href="#LazyRegressor.fit-445"><span class="linenos">445</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-446"><a href="#LazyRegressor.fit-446"><span class="linenos">446</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyRegressor.fit-447"><a href="#LazyRegressor.fit-447"><span class="linenos">447</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-448"><a href="#LazyRegressor.fit-448"><span class="linenos">448</span></a>                            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">r_squared</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-449"><a href="#LazyRegressor.fit-449"><span class="linenos">449</span></a>                            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">adj_rsquared</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-450"><a href="#LazyRegressor.fit-450"><span class="linenos">450</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-451"><a href="#LazyRegressor.fit-451"><span class="linenos">451</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-452"><a href="#LazyRegressor.fit-452"><span class="linenos">452</span></a>                        <span class="p">}</span>
</span><span id="LazyRegressor.fit-453"><a href="#LazyRegressor.fit-453"><span class="linenos">453</span></a>
</span><span id="LazyRegressor.fit-454"><a href="#LazyRegressor.fit-454"><span class="linenos">454</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-455"><a href="#LazyRegressor.fit-455"><span class="linenos">455</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyRegressor.fit-456"><a href="#LazyRegressor.fit-456"><span class="linenos">456</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyRegressor.fit-457"><a href="#LazyRegressor.fit-457"><span class="linenos">457</span></a>                            <span class="p">)</span>
</span><span id="LazyRegressor.fit-458"><a href="#LazyRegressor.fit-458"><span class="linenos">458</span></a>
</span><span id="LazyRegressor.fit-459"><a href="#LazyRegressor.fit-459"><span class="linenos">459</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-460"><a href="#LazyRegressor.fit-460"><span class="linenos">460</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-461"><a href="#LazyRegressor.fit-461"><span class="linenos">461</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyRegressor.fit-462"><a href="#LazyRegressor.fit-462"><span class="linenos">462</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-463"><a href="#LazyRegressor.fit-463"><span class="linenos">463</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-464"><a href="#LazyRegressor.fit-464"><span class="linenos">464</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-465"><a href="#LazyRegressor.fit-465"><span class="linenos">465</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-466"><a href="#LazyRegressor.fit-466"><span class="linenos">466</span></a>
</span><span id="LazyRegressor.fit-467"><a href="#LazyRegressor.fit-467"><span class="linenos">467</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyRegressor.fit-468"><a href="#LazyRegressor.fit-468"><span class="linenos">468</span></a>            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-469"><a href="#LazyRegressor.fit-469"><span class="linenos">469</span></a>            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">ADJR2</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-470"><a href="#LazyRegressor.fit-470"><span class="linenos">470</span></a>            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">R2</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-471"><a href="#LazyRegressor.fit-471"><span class="linenos">471</span></a>            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-472"><a href="#LazyRegressor.fit-472"><span class="linenos">472</span></a>            <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-473"><a href="#LazyRegressor.fit-473"><span class="linenos">473</span></a>        <span class="p">}</span>
</span><span id="LazyRegressor.fit-474"><a href="#LazyRegressor.fit-474"><span class="linenos">474</span></a>
</span><span id="LazyRegressor.fit-475"><a href="#LazyRegressor.fit-475"><span class="linenos">475</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-476"><a href="#LazyRegressor.fit-476"><span class="linenos">476</span></a>            <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">CUSTOM_METRIC</span>
</span><span id="LazyRegressor.fit-477"><a href="#LazyRegressor.fit-477"><span class="linenos">477</span></a>
</span><span id="LazyRegressor.fit-478"><a href="#LazyRegressor.fit-478"><span class="linenos">478</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-479"><a href="#LazyRegressor.fit-479"><span class="linenos">479</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-480"><a href="#LazyRegressor.fit-480"><span class="linenos">480</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyRegressor.fit-481"><a href="#LazyRegressor.fit-481"><span class="linenos">481</span></a>        <span class="p">)</span>
</span><span id="LazyRegressor.fit-482"><a href="#LazyRegressor.fit-482"><span class="linenos">482</span></a>
</span><span id="LazyRegressor.fit-483"><a href="#LazyRegressor.fit-483"><span class="linenos">483</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-484"><a href="#LazyRegressor.fit-484"><span class="linenos">484</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-485"><a href="#LazyRegressor.fit-485"><span class="linenos">485</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span></pre></div>


            <div class="docstring"><p>Fit Regression algorithms to X_train and y_train, predict and score on X_test, y_test.</p>

<p>Parameters:</p>

<pre><code>X_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.

y_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

y_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.
</code></pre>

<p>Returns:</p>

<p>scores : Pandas DataFrame
    Returns metrics of all the models in a Pandas DataFrame.</p>

<p>predictions : Pandas DataFrame
    Returns predictions of all the models in a Pandas DataFrame.</p>
</div>


                                </div>
                                <div id="LazyRegressor.provide_models" class="classattr">
                                            <input id="LazyRegressor.provide_models-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">provide_models</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">y_train</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyRegressor.provide_models-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyRegressor.provide_models"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyRegressor.provide_models-487"><a href="#LazyRegressor.provide_models-487"><span class="linenos">487</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyRegressor.provide_models-488"><a href="#LazyRegressor.provide_models-488"><span class="linenos">488</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyRegressor.provide_models-489"><a href="#LazyRegressor.provide_models-489"><span class="linenos">489</span></a><span class="sd">        This function returns all the model objects trained in fit function.</span>
</span><span id="LazyRegressor.provide_models-490"><a href="#LazyRegressor.provide_models-490"><span class="linenos">490</span></a><span class="sd">        If fit is not called already, then we call fit and then return the models.</span>
</span><span id="LazyRegressor.provide_models-491"><a href="#LazyRegressor.provide_models-491"><span class="linenos">491</span></a><span class="sd">        Parameters</span>
</span><span id="LazyRegressor.provide_models-492"><a href="#LazyRegressor.provide_models-492"><span class="linenos">492</span></a><span class="sd">        ----------</span>
</span><span id="LazyRegressor.provide_models-493"><a href="#LazyRegressor.provide_models-493"><span class="linenos">493</span></a><span class="sd">        X_train : array-like,</span>
</span><span id="LazyRegressor.provide_models-494"><a href="#LazyRegressor.provide_models-494"><span class="linenos">494</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor.provide_models-495"><a href="#LazyRegressor.provide_models-495"><span class="linenos">495</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyRegressor.provide_models-496"><a href="#LazyRegressor.provide_models-496"><span class="linenos">496</span></a><span class="sd">        X_test : array-like,</span>
</span><span id="LazyRegressor.provide_models-497"><a href="#LazyRegressor.provide_models-497"><span class="linenos">497</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor.provide_models-498"><a href="#LazyRegressor.provide_models-498"><span class="linenos">498</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyRegressor.provide_models-499"><a href="#LazyRegressor.provide_models-499"><span class="linenos">499</span></a><span class="sd">        y_train : array-like,</span>
</span><span id="LazyRegressor.provide_models-500"><a href="#LazyRegressor.provide_models-500"><span class="linenos">500</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor.provide_models-501"><a href="#LazyRegressor.provide_models-501"><span class="linenos">501</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyRegressor.provide_models-502"><a href="#LazyRegressor.provide_models-502"><span class="linenos">502</span></a><span class="sd">        y_test : array-like,</span>
</span><span id="LazyRegressor.provide_models-503"><a href="#LazyRegressor.provide_models-503"><span class="linenos">503</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor.provide_models-504"><a href="#LazyRegressor.provide_models-504"><span class="linenos">504</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyRegressor.provide_models-505"><a href="#LazyRegressor.provide_models-505"><span class="linenos">505</span></a><span class="sd">        Returns</span>
</span><span id="LazyRegressor.provide_models-506"><a href="#LazyRegressor.provide_models-506"><span class="linenos">506</span></a><span class="sd">        -------</span>
</span><span id="LazyRegressor.provide_models-507"><a href="#LazyRegressor.provide_models-507"><span class="linenos">507</span></a><span class="sd">        models: dict-object,</span>
</span><span id="LazyRegressor.provide_models-508"><a href="#LazyRegressor.provide_models-508"><span class="linenos">508</span></a><span class="sd">            Returns a dictionary with each model pipeline as value</span>
</span><span id="LazyRegressor.provide_models-509"><a href="#LazyRegressor.provide_models-509"><span class="linenos">509</span></a><span class="sd">            with key as name of models.</span>
</span><span id="LazyRegressor.provide_models-510"><a href="#LazyRegressor.provide_models-510"><span class="linenos">510</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyRegressor.provide_models-511"><a href="#LazyRegressor.provide_models-511"><span class="linenos">511</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyRegressor.provide_models-512"><a href="#LazyRegressor.provide_models-512"><span class="linenos">512</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span><span id="LazyRegressor.provide_models-513"><a href="#LazyRegressor.provide_models-513"><span class="linenos">513</span></a>
</span><span id="LazyRegressor.provide_models-514"><a href="#LazyRegressor.provide_models-514"><span class="linenos">514</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>This function returns all the model objects trained in fit function.
If fit is not called already, then we call fit and then return the models.</p>

<h2 id="parameters">Parameters</h2>

<p>X_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.
X_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.
y_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.
y_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.</p>

<h2 id="returns">Returns</h2>

<p>models: dict-object,
    Returns a dictionary with each model pipeline as value
    with key as name of models.</p>
</div>


                                </div>
                        
                </section>
                <section id="LazyMTS">
                            <input id="LazyMTS-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LazyMTS</span><wbr>(<span class="base"><a href="#MTS">nnetsauce.MTS</a></span>):

                <label class="view-source-button" for="LazyMTS-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyMTS"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyMTS-92"><a href="#LazyMTS-92"><span class="linenos"> 92</span></a><span class="k">class</span> <span class="nc">LazyMTS</span><span class="p">(</span><span class="n">MTS</span><span class="p">):</span>
</span><span id="LazyMTS-93"><a href="#LazyMTS-93"><span class="linenos"> 93</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyMTS-94"><a href="#LazyMTS-94"><span class="linenos"> 94</span></a>
</span><span id="LazyMTS-95"><a href="#LazyMTS-95"><span class="linenos"> 95</span></a><span class="sd">    Fitting -- almost -- all the regression algorithms with layers of</span>
</span><span id="LazyMTS-96"><a href="#LazyMTS-96"><span class="linenos"> 96</span></a><span class="sd">    nnetsauce&#39;s CustomRegressor to multivariate time series</span>
</span><span id="LazyMTS-97"><a href="#LazyMTS-97"><span class="linenos"> 97</span></a><span class="sd">    and returning their scores.</span>
</span><span id="LazyMTS-98"><a href="#LazyMTS-98"><span class="linenos"> 98</span></a>
</span><span id="LazyMTS-99"><a href="#LazyMTS-99"><span class="linenos"> 99</span></a><span class="sd">    Parameters:</span>
</span><span id="LazyMTS-100"><a href="#LazyMTS-100"><span class="linenos">100</span></a>
</span><span id="LazyMTS-101"><a href="#LazyMTS-101"><span class="linenos">101</span></a><span class="sd">        verbose: int, optional (default=0)</span>
</span><span id="LazyMTS-102"><a href="#LazyMTS-102"><span class="linenos">102</span></a><span class="sd">            Any positive number for verbosity.</span>
</span><span id="LazyMTS-103"><a href="#LazyMTS-103"><span class="linenos">103</span></a>
</span><span id="LazyMTS-104"><a href="#LazyMTS-104"><span class="linenos">104</span></a><span class="sd">        ignore_warnings: bool, optional (default=True)</span>
</span><span id="LazyMTS-105"><a href="#LazyMTS-105"><span class="linenos">105</span></a><span class="sd">            When set to True, the warning related to algorigms that are not</span>
</span><span id="LazyMTS-106"><a href="#LazyMTS-106"><span class="linenos">106</span></a><span class="sd">            able to run are ignored.</span>
</span><span id="LazyMTS-107"><a href="#LazyMTS-107"><span class="linenos">107</span></a>
</span><span id="LazyMTS-108"><a href="#LazyMTS-108"><span class="linenos">108</span></a><span class="sd">        custom_metric: function, optional (default=None)</span>
</span><span id="LazyMTS-109"><a href="#LazyMTS-109"><span class="linenos">109</span></a><span class="sd">            When function is provided, models are evaluated based on the custom</span>
</span><span id="LazyMTS-110"><a href="#LazyMTS-110"><span class="linenos">110</span></a><span class="sd">              evaluation metric provided.</span>
</span><span id="LazyMTS-111"><a href="#LazyMTS-111"><span class="linenos">111</span></a>
</span><span id="LazyMTS-112"><a href="#LazyMTS-112"><span class="linenos">112</span></a><span class="sd">        predictions: bool, optional (default=False)</span>
</span><span id="LazyMTS-113"><a href="#LazyMTS-113"><span class="linenos">113</span></a><span class="sd">            When set to True, the predictions of all the models models are returned as dataframe.</span>
</span><span id="LazyMTS-114"><a href="#LazyMTS-114"><span class="linenos">114</span></a>
</span><span id="LazyMTS-115"><a href="#LazyMTS-115"><span class="linenos">115</span></a><span class="sd">        sort_by: string, optional (default=&#39;RMSE&#39;)</span>
</span><span id="LazyMTS-116"><a href="#LazyMTS-116"><span class="linenos">116</span></a><span class="sd">            Sort models by a metric. Available options are &#39;RMSE&#39;, &#39;MAE&#39;, &#39;MPL&#39;, &#39;MPE&#39;, &#39;MAPE&#39;,</span>
</span><span id="LazyMTS-117"><a href="#LazyMTS-117"><span class="linenos">117</span></a><span class="sd">            &#39;R-Squared&#39;, &#39;Adjusted R-Squared&#39; or a custom metric identified by its name and</span>
</span><span id="LazyMTS-118"><a href="#LazyMTS-118"><span class="linenos">118</span></a><span class="sd">            provided by custom_metric.</span>
</span><span id="LazyMTS-119"><a href="#LazyMTS-119"><span class="linenos">119</span></a>
</span><span id="LazyMTS-120"><a href="#LazyMTS-120"><span class="linenos">120</span></a><span class="sd">        random_state: int, optional (default=42)</span>
</span><span id="LazyMTS-121"><a href="#LazyMTS-121"><span class="linenos">121</span></a><span class="sd">            Reproducibiility seed.</span>
</span><span id="LazyMTS-122"><a href="#LazyMTS-122"><span class="linenos">122</span></a>
</span><span id="LazyMTS-123"><a href="#LazyMTS-123"><span class="linenos">123</span></a><span class="sd">        estimators: list, optional (default=&#39;all&#39;)</span>
</span><span id="LazyMTS-124"><a href="#LazyMTS-124"><span class="linenos">124</span></a><span class="sd">            list of Estimators (regression algorithms) names or just &#39;all&#39; (default=&#39;all&#39;)</span>
</span><span id="LazyMTS-125"><a href="#LazyMTS-125"><span class="linenos">125</span></a>
</span><span id="LazyMTS-126"><a href="#LazyMTS-126"><span class="linenos">126</span></a><span class="sd">        preprocess: bool, preprocessing is done when set to True</span>
</span><span id="LazyMTS-127"><a href="#LazyMTS-127"><span class="linenos">127</span></a>
</span><span id="LazyMTS-128"><a href="#LazyMTS-128"><span class="linenos">128</span></a><span class="sd">        n_jobs : int, when possible, run in parallel</span>
</span><span id="LazyMTS-129"><a href="#LazyMTS-129"><span class="linenos">129</span></a><span class="sd">            For now, only used by individual models that support it.</span>
</span><span id="LazyMTS-130"><a href="#LazyMTS-130"><span class="linenos">130</span></a>
</span><span id="LazyMTS-131"><a href="#LazyMTS-131"><span class="linenos">131</span></a><span class="sd">        n_layers: int, optional (default=3)</span>
</span><span id="LazyMTS-132"><a href="#LazyMTS-132"><span class="linenos">132</span></a><span class="sd">            Number of layers of CustomRegressors to be used.</span>
</span><span id="LazyMTS-133"><a href="#LazyMTS-133"><span class="linenos">133</span></a>
</span><span id="LazyMTS-134"><a href="#LazyMTS-134"><span class="linenos">134</span></a><span class="sd">        All the other parameters are the same as MTS&#39;s.</span>
</span><span id="LazyMTS-135"><a href="#LazyMTS-135"><span class="linenos">135</span></a>
</span><span id="LazyMTS-136"><a href="#LazyMTS-136"><span class="linenos">136</span></a><span class="sd">    Examples:</span>
</span><span id="LazyMTS-137"><a href="#LazyMTS-137"><span class="linenos">137</span></a>
</span><span id="LazyMTS-138"><a href="#LazyMTS-138"><span class="linenos">138</span></a><span class="sd">        See https://thierrymoudiki.github.io/blog/2023/10/29/python/quasirandomizednn/MTS-LazyPredict</span>
</span><span id="LazyMTS-139"><a href="#LazyMTS-139"><span class="linenos">139</span></a>
</span><span id="LazyMTS-140"><a href="#LazyMTS-140"><span class="linenos">140</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LazyMTS-141"><a href="#LazyMTS-141"><span class="linenos">141</span></a>
</span><span id="LazyMTS-142"><a href="#LazyMTS-142"><span class="linenos">142</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyMTS-143"><a href="#LazyMTS-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="LazyMTS-144"><a href="#LazyMTS-144"><span class="linenos">144</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyMTS-145"><a href="#LazyMTS-145"><span class="linenos">145</span></a>        <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyMTS-146"><a href="#LazyMTS-146"><span class="linenos">146</span></a>        <span class="n">custom_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyMTS-147"><a href="#LazyMTS-147"><span class="linenos">147</span></a>        <span class="n">predictions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyMTS-148"><a href="#LazyMTS-148"><span class="linenos">148</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="LazyMTS-149"><a href="#LazyMTS-149"><span class="linenos">149</span></a>        <span class="n">estimators</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-150"><a href="#LazyMTS-150"><span class="linenos">150</span></a>        <span class="n">preprocess</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyMTS-151"><a href="#LazyMTS-151"><span class="linenos">151</span></a>        <span class="c1"># MTS attributes</span>
</span><span id="LazyMTS-152"><a href="#LazyMTS-152"><span class="linenos">152</span></a>        <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyMTS-153"><a href="#LazyMTS-153"><span class="linenos">153</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="LazyMTS-154"><a href="#LazyMTS-154"><span class="linenos">154</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-155"><a href="#LazyMTS-155"><span class="linenos">155</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="LazyMTS-156"><a href="#LazyMTS-156"><span class="linenos">156</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-157"><a href="#LazyMTS-157"><span class="linenos">157</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyMTS-158"><a href="#LazyMTS-158"><span class="linenos">158</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyMTS-159"><a href="#LazyMTS-159"><span class="linenos">159</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyMTS-160"><a href="#LazyMTS-160"><span class="linenos">160</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="LazyMTS-161"><a href="#LazyMTS-161"><span class="linenos">161</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyMTS-162"><a href="#LazyMTS-162"><span class="linenos">162</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-163"><a href="#LazyMTS-163"><span class="linenos">163</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="LazyMTS-164"><a href="#LazyMTS-164"><span class="linenos">164</span></a>        <span class="n">lags</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyMTS-165"><a href="#LazyMTS-165"><span class="linenos">165</span></a>        <span class="n">type_pi</span><span class="o">=</span><span class="s2">&quot;kde&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-166"><a href="#LazyMTS-166"><span class="linenos">166</span></a>        <span class="n">replications</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyMTS-167"><a href="#LazyMTS-167"><span class="linenos">167</span></a>        <span class="n">kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyMTS-168"><a href="#LazyMTS-168"><span class="linenos">168</span></a>        <span class="n">agg</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-169"><a href="#LazyMTS-169"><span class="linenos">169</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="LazyMTS-170"><a href="#LazyMTS-170"><span class="linenos">170</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-171"><a href="#LazyMTS-171"><span class="linenos">171</span></a>        <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyMTS-172"><a href="#LazyMTS-172"><span class="linenos">172</span></a>    <span class="p">):</span>
</span><span id="LazyMTS-173"><a href="#LazyMTS-173"><span class="linenos">173</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="LazyMTS-174"><a href="#LazyMTS-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="o">=</span> <span class="n">ignore_warnings</span>
</span><span id="LazyMTS-175"><a href="#LazyMTS-175"><span class="linenos">175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="o">=</span> <span class="n">custom_metric</span>
</span><span id="LazyMTS-176"><a href="#LazyMTS-176"><span class="linenos">176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span>
</span><span id="LazyMTS-177"><a href="#LazyMTS-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyMTS-178"><a href="#LazyMTS-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="LazyMTS-179"><a href="#LazyMTS-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">=</span> <span class="n">estimators</span>
</span><span id="LazyMTS-180"><a href="#LazyMTS-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="o">=</span> <span class="n">preprocess</span>
</span><span id="LazyMTS-181"><a href="#LazyMTS-181"><span class="linenos">181</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyMTS-182"><a href="#LazyMTS-182"><span class="linenos">182</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="LazyMTS-183"><a href="#LazyMTS-183"><span class="linenos">183</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS-184"><a href="#LazyMTS-184"><span class="linenos">184</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS-185"><a href="#LazyMTS-185"><span class="linenos">185</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS-186"><a href="#LazyMTS-186"><span class="linenos">186</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS-187"><a href="#LazyMTS-187"><span class="linenos">187</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS-188"><a href="#LazyMTS-188"><span class="linenos">188</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS-189"><a href="#LazyMTS-189"><span class="linenos">189</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS-190"><a href="#LazyMTS-190"><span class="linenos">190</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS-191"><a href="#LazyMTS-191"><span class="linenos">191</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS-192"><a href="#LazyMTS-192"><span class="linenos">192</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS-193"><a href="#LazyMTS-193"><span class="linenos">193</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS-194"><a href="#LazyMTS-194"><span class="linenos">194</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS-195"><a href="#LazyMTS-195"><span class="linenos">195</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS-196"><a href="#LazyMTS-196"><span class="linenos">196</span></a>            <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS-197"><a href="#LazyMTS-197"><span class="linenos">197</span></a>            <span class="n">type_pi</span><span class="o">=</span><span class="n">type_pi</span><span class="p">,</span>
</span><span id="LazyMTS-198"><a href="#LazyMTS-198"><span class="linenos">198</span></a>            <span class="n">replications</span><span class="o">=</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS-199"><a href="#LazyMTS-199"><span class="linenos">199</span></a>            <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS-200"><a href="#LazyMTS-200"><span class="linenos">200</span></a>            <span class="n">agg</span><span class="o">=</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS-201"><a href="#LazyMTS-201"><span class="linenos">201</span></a>            <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS-202"><a href="#LazyMTS-202"><span class="linenos">202</span></a>        <span class="p">)</span>
</span><span id="LazyMTS-203"><a href="#LazyMTS-203"><span class="linenos">203</span></a>
</span><span id="LazyMTS-204"><a href="#LazyMTS-204"><span class="linenos">204</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">xreg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="LazyMTS-205"><a href="#LazyMTS-205"><span class="linenos">205</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X_train, predict and score on X_test.</span>
</span><span id="LazyMTS-206"><a href="#LazyMTS-206"><span class="linenos">206</span></a>
</span><span id="LazyMTS-207"><a href="#LazyMTS-207"><span class="linenos">207</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyMTS-208"><a href="#LazyMTS-208"><span class="linenos">208</span></a>
</span><span id="LazyMTS-209"><a href="#LazyMTS-209"><span class="linenos">209</span></a><span class="sd">            X_train: array-like,</span>
</span><span id="LazyMTS-210"><a href="#LazyMTS-210"><span class="linenos">210</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyMTS-211"><a href="#LazyMTS-211"><span class="linenos">211</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyMTS-212"><a href="#LazyMTS-212"><span class="linenos">212</span></a>
</span><span id="LazyMTS-213"><a href="#LazyMTS-213"><span class="linenos">213</span></a><span class="sd">            X_test: array-like,</span>
</span><span id="LazyMTS-214"><a href="#LazyMTS-214"><span class="linenos">214</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyMTS-215"><a href="#LazyMTS-215"><span class="linenos">215</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyMTS-216"><a href="#LazyMTS-216"><span class="linenos">216</span></a>
</span><span id="LazyMTS-217"><a href="#LazyMTS-217"><span class="linenos">217</span></a><span class="sd">            xreg: array-like, optional (default=None)</span>
</span><span id="LazyMTS-218"><a href="#LazyMTS-218"><span class="linenos">218</span></a><span class="sd">                Additional (external) regressors to be passed to self.obj</span>
</span><span id="LazyMTS-219"><a href="#LazyMTS-219"><span class="linenos">219</span></a><span class="sd">                xreg must be in &#39;increasing&#39; order (most recent observations last)</span>
</span><span id="LazyMTS-220"><a href="#LazyMTS-220"><span class="linenos">220</span></a>
</span><span id="LazyMTS-221"><a href="#LazyMTS-221"><span class="linenos">221</span></a><span class="sd">        Returns:</span>
</span><span id="LazyMTS-222"><a href="#LazyMTS-222"><span class="linenos">222</span></a>
</span><span id="LazyMTS-223"><a href="#LazyMTS-223"><span class="linenos">223</span></a><span class="sd">            scores: Pandas DataFrame</span>
</span><span id="LazyMTS-224"><a href="#LazyMTS-224"><span class="linenos">224</span></a><span class="sd">                Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyMTS-225"><a href="#LazyMTS-225"><span class="linenos">225</span></a>
</span><span id="LazyMTS-226"><a href="#LazyMTS-226"><span class="linenos">226</span></a><span class="sd">            predictions: Pandas DataFrame</span>
</span><span id="LazyMTS-227"><a href="#LazyMTS-227"><span class="linenos">227</span></a><span class="sd">                Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyMTS-228"><a href="#LazyMTS-228"><span class="linenos">228</span></a>
</span><span id="LazyMTS-229"><a href="#LazyMTS-229"><span class="linenos">229</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyMTS-230"><a href="#LazyMTS-230"><span class="linenos">230</span></a>        <span class="n">R2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-231"><a href="#LazyMTS-231"><span class="linenos">231</span></a>        <span class="n">ADJR2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-232"><a href="#LazyMTS-232"><span class="linenos">232</span></a>        <span class="n">ME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-233"><a href="#LazyMTS-233"><span class="linenos">233</span></a>        <span class="n">MPL</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-234"><a href="#LazyMTS-234"><span class="linenos">234</span></a>        <span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-235"><a href="#LazyMTS-235"><span class="linenos">235</span></a>        <span class="n">MAE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-236"><a href="#LazyMTS-236"><span class="linenos">236</span></a>        <span class="n">MPE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-237"><a href="#LazyMTS-237"><span class="linenos">237</span></a>        <span class="n">MAPE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-238"><a href="#LazyMTS-238"><span class="linenos">238</span></a>        <span class="n">WINKLERSCORE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-239"><a href="#LazyMTS-239"><span class="linenos">239</span></a>        <span class="n">COVERAGE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-240"><a href="#LazyMTS-240"><span class="linenos">240</span></a>
</span><span id="LazyMTS-241"><a href="#LazyMTS-241"><span class="linenos">241</span></a>        <span class="c1"># WIN = []</span>
</span><span id="LazyMTS-242"><a href="#LazyMTS-242"><span class="linenos">242</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-243"><a href="#LazyMTS-243"><span class="linenos">243</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-244"><a href="#LazyMTS-244"><span class="linenos">244</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyMTS-245"><a href="#LazyMTS-245"><span class="linenos">245</span></a>
</span><span id="LazyMTS-246"><a href="#LazyMTS-246"><span class="linenos">246</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS-247"><a href="#LazyMTS-247"><span class="linenos">247</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-248"><a href="#LazyMTS-248"><span class="linenos">248</span></a>
</span><span id="LazyMTS-249"><a href="#LazyMTS-249"><span class="linenos">249</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyMTS-250"><a href="#LazyMTS-250"><span class="linenos">250</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyMTS-251"><a href="#LazyMTS-251"><span class="linenos">251</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyMTS-252"><a href="#LazyMTS-252"><span class="linenos">252</span></a>
</span><span id="LazyMTS-253"><a href="#LazyMTS-253"><span class="linenos">253</span></a>        <span class="n">X_train</span> <span class="o">=</span> <span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyMTS-254"><a href="#LazyMTS-254"><span class="linenos">254</span></a>        <span class="n">X_test</span> <span class="o">=</span> <span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyMTS-255"><a href="#LazyMTS-255"><span class="linenos">255</span></a>
</span><span id="LazyMTS-256"><a href="#LazyMTS-256"><span class="linenos">256</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyMTS-257"><a href="#LazyMTS-257"><span class="linenos">257</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyMTS-258"><a href="#LazyMTS-258"><span class="linenos">258</span></a>
</span><span id="LazyMTS-259"><a href="#LazyMTS-259"><span class="linenos">259</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyMTS-260"><a href="#LazyMTS-260"><span class="linenos">260</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyMTS-261"><a href="#LazyMTS-261"><span class="linenos">261</span></a>        <span class="p">)</span>
</span><span id="LazyMTS-262"><a href="#LazyMTS-262"><span class="linenos">262</span></a>
</span><span id="LazyMTS-263"><a href="#LazyMTS-263"><span class="linenos">263</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span><span class="p">:</span>
</span><span id="LazyMTS-264"><a href="#LazyMTS-264"><span class="linenos">264</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyMTS-265"><a href="#LazyMTS-265"><span class="linenos">265</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyMTS-266"><a href="#LazyMTS-266"><span class="linenos">266</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyMTS-267"><a href="#LazyMTS-267"><span class="linenos">267</span></a>                    <span class="p">(</span>
</span><span id="LazyMTS-268"><a href="#LazyMTS-268"><span class="linenos">268</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-269"><a href="#LazyMTS-269"><span class="linenos">269</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyMTS-270"><a href="#LazyMTS-270"><span class="linenos">270</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyMTS-271"><a href="#LazyMTS-271"><span class="linenos">271</span></a>                    <span class="p">),</span>
</span><span id="LazyMTS-272"><a href="#LazyMTS-272"><span class="linenos">272</span></a>                    <span class="p">(</span>
</span><span id="LazyMTS-273"><a href="#LazyMTS-273"><span class="linenos">273</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-274"><a href="#LazyMTS-274"><span class="linenos">274</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyMTS-275"><a href="#LazyMTS-275"><span class="linenos">275</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyMTS-276"><a href="#LazyMTS-276"><span class="linenos">276</span></a>                    <span class="p">),</span>
</span><span id="LazyMTS-277"><a href="#LazyMTS-277"><span class="linenos">277</span></a>                <span class="p">]</span>
</span><span id="LazyMTS-278"><a href="#LazyMTS-278"><span class="linenos">278</span></a>            <span class="p">)</span>
</span><span id="LazyMTS-279"><a href="#LazyMTS-279"><span class="linenos">279</span></a>
</span><span id="LazyMTS-280"><a href="#LazyMTS-280"><span class="linenos">280</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyMTS-281"><a href="#LazyMTS-281"><span class="linenos">281</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="n">REGRESSORSMTS</span>
</span><span id="LazyMTS-282"><a href="#LazyMTS-282"><span class="linenos">282</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS-283"><a href="#LazyMTS-283"><span class="linenos">283</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyMTS-284"><a href="#LazyMTS-284"><span class="linenos">284</span></a>                <span class="p">(</span><span class="s2">&quot;MTS(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyMTS-285"><a href="#LazyMTS-285"><span class="linenos">285</span></a>                <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyMTS-286"><a href="#LazyMTS-286"><span class="linenos">286</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyMTS-287"><a href="#LazyMTS-287"><span class="linenos">287</span></a>                    <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyMTS-288"><a href="#LazyMTS-288"><span class="linenos">288</span></a>                    <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyMTS-289"><a href="#LazyMTS-289"><span class="linenos">289</span></a>                <span class="p">)</span>
</span><span id="LazyMTS-290"><a href="#LazyMTS-290"><span class="linenos">290</span></a>            <span class="p">]</span>
</span><span id="LazyMTS-291"><a href="#LazyMTS-291"><span class="linenos">291</span></a>
</span><span id="LazyMTS-292"><a href="#LazyMTS-292"><span class="linenos">292</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyMTS-293"><a href="#LazyMTS-293"><span class="linenos">293</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyMTS-294"><a href="#LazyMTS-294"><span class="linenos">294</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyMTS-295"><a href="#LazyMTS-295"><span class="linenos">295</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyMTS-296"><a href="#LazyMTS-296"><span class="linenos">296</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyMTS-297"><a href="#LazyMTS-297"><span class="linenos">297</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyMTS-298"><a href="#LazyMTS-298"><span class="linenos">298</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyMTS-299"><a href="#LazyMTS-299"><span class="linenos">299</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyMTS-300"><a href="#LazyMTS-300"><span class="linenos">300</span></a>                                <span class="p">(</span>
</span><span id="LazyMTS-301"><a href="#LazyMTS-301"><span class="linenos">301</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-302"><a href="#LazyMTS-302"><span class="linenos">302</span></a>                                    <span class="n">MTS</span><span class="p">(</span>
</span><span id="LazyMTS-303"><a href="#LazyMTS-303"><span class="linenos">303</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyMTS-304"><a href="#LazyMTS-304"><span class="linenos">304</span></a>                                            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="LazyMTS-305"><a href="#LazyMTS-305"><span class="linenos">305</span></a>                                            <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyMTS-306"><a href="#LazyMTS-306"><span class="linenos">306</span></a>                                        <span class="p">),</span>
</span><span id="LazyMTS-307"><a href="#LazyMTS-307"><span class="linenos">307</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS-308"><a href="#LazyMTS-308"><span class="linenos">308</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS-309"><a href="#LazyMTS-309"><span class="linenos">309</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS-310"><a href="#LazyMTS-310"><span class="linenos">310</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS-311"><a href="#LazyMTS-311"><span class="linenos">311</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS-312"><a href="#LazyMTS-312"><span class="linenos">312</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS-313"><a href="#LazyMTS-313"><span class="linenos">313</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS-314"><a href="#LazyMTS-314"><span class="linenos">314</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS-315"><a href="#LazyMTS-315"><span class="linenos">315</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS-316"><a href="#LazyMTS-316"><span class="linenos">316</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS-317"><a href="#LazyMTS-317"><span class="linenos">317</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS-318"><a href="#LazyMTS-318"><span class="linenos">318</span></a>                                        <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS-319"><a href="#LazyMTS-319"><span class="linenos">319</span></a>                                        <span class="n">type_pi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span><span class="p">,</span>
</span><span id="LazyMTS-320"><a href="#LazyMTS-320"><span class="linenos">320</span></a>                                        <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS-321"><a href="#LazyMTS-321"><span class="linenos">321</span></a>                                        <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS-322"><a href="#LazyMTS-322"><span class="linenos">322</span></a>                                        <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS-323"><a href="#LazyMTS-323"><span class="linenos">323</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS-324"><a href="#LazyMTS-324"><span class="linenos">324</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS-325"><a href="#LazyMTS-325"><span class="linenos">325</span></a>                                        <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS-326"><a href="#LazyMTS-326"><span class="linenos">326</span></a>                                    <span class="p">),</span>
</span><span id="LazyMTS-327"><a href="#LazyMTS-327"><span class="linenos">327</span></a>                                <span class="p">),</span>
</span><span id="LazyMTS-328"><a href="#LazyMTS-328"><span class="linenos">328</span></a>                            <span class="p">]</span>
</span><span id="LazyMTS-329"><a href="#LazyMTS-329"><span class="linenos">329</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS-330"><a href="#LazyMTS-330"><span class="linenos">330</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS-331"><a href="#LazyMTS-331"><span class="linenos">331</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyMTS-332"><a href="#LazyMTS-332"><span class="linenos">332</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyMTS-333"><a href="#LazyMTS-333"><span class="linenos">333</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyMTS-334"><a href="#LazyMTS-334"><span class="linenos">334</span></a>                                <span class="p">(</span>
</span><span id="LazyMTS-335"><a href="#LazyMTS-335"><span class="linenos">335</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-336"><a href="#LazyMTS-336"><span class="linenos">336</span></a>                                    <span class="n">MTS</span><span class="p">(</span>
</span><span id="LazyMTS-337"><a href="#LazyMTS-337"><span class="linenos">337</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyMTS-338"><a href="#LazyMTS-338"><span class="linenos">338</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS-339"><a href="#LazyMTS-339"><span class="linenos">339</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS-340"><a href="#LazyMTS-340"><span class="linenos">340</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS-341"><a href="#LazyMTS-341"><span class="linenos">341</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS-342"><a href="#LazyMTS-342"><span class="linenos">342</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS-343"><a href="#LazyMTS-343"><span class="linenos">343</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS-344"><a href="#LazyMTS-344"><span class="linenos">344</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS-345"><a href="#LazyMTS-345"><span class="linenos">345</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS-346"><a href="#LazyMTS-346"><span class="linenos">346</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS-347"><a href="#LazyMTS-347"><span class="linenos">347</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS-348"><a href="#LazyMTS-348"><span class="linenos">348</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS-349"><a href="#LazyMTS-349"><span class="linenos">349</span></a>                                        <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS-350"><a href="#LazyMTS-350"><span class="linenos">350</span></a>                                        <span class="n">type_pi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span><span class="p">,</span>
</span><span id="LazyMTS-351"><a href="#LazyMTS-351"><span class="linenos">351</span></a>                                        <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS-352"><a href="#LazyMTS-352"><span class="linenos">352</span></a>                                        <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS-353"><a href="#LazyMTS-353"><span class="linenos">353</span></a>                                        <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS-354"><a href="#LazyMTS-354"><span class="linenos">354</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS-355"><a href="#LazyMTS-355"><span class="linenos">355</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS-356"><a href="#LazyMTS-356"><span class="linenos">356</span></a>                                        <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS-357"><a href="#LazyMTS-357"><span class="linenos">357</span></a>                                    <span class="p">),</span>
</span><span id="LazyMTS-358"><a href="#LazyMTS-358"><span class="linenos">358</span></a>                                <span class="p">),</span>
</span><span id="LazyMTS-359"><a href="#LazyMTS-359"><span class="linenos">359</span></a>                            <span class="p">]</span>
</span><span id="LazyMTS-360"><a href="#LazyMTS-360"><span class="linenos">360</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS-361"><a href="#LazyMTS-361"><span class="linenos">361</span></a>
</span><span id="LazyMTS-362"><a href="#LazyMTS-362"><span class="linenos">362</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="LazyMTS-363"><a href="#LazyMTS-363"><span class="linenos">363</span></a>                    <span class="c1"># pipe.fit(X_train, xreg=xreg)</span>
</span><span id="LazyMTS-364"><a href="#LazyMTS-364"><span class="linenos">364</span></a>
</span><span id="LazyMTS-365"><a href="#LazyMTS-365"><span class="linenos">365</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyMTS-366"><a href="#LazyMTS-366"><span class="linenos">366</span></a>
</span><span id="LazyMTS-367"><a href="#LazyMTS-367"><span class="linenos">367</span></a>                    <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">[</span><span class="s2">&quot;regressor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyMTS-368"><a href="#LazyMTS-368"><span class="linenos">368</span></a>                        <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyMTS-369"><a href="#LazyMTS-369"><span class="linenos">369</span></a>                    <span class="p">)</span>
</span><span id="LazyMTS-370"><a href="#LazyMTS-370"><span class="linenos">370</span></a>
</span><span id="LazyMTS-371"><a href="#LazyMTS-371"><span class="linenos">371</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyMTS-372"><a href="#LazyMTS-372"><span class="linenos">372</span></a>                        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span>
</span><span id="LazyMTS-373"><a href="#LazyMTS-373"><span class="linenos">373</span></a>                            <span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span>
</span><span id="LazyMTS-374"><a href="#LazyMTS-374"><span class="linenos">374</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS-375"><a href="#LazyMTS-375"><span class="linenos">375</span></a>                        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span><span id="LazyMTS-376"><a href="#LazyMTS-376"><span class="linenos">376</span></a>                        <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span><span id="LazyMTS-377"><a href="#LazyMTS-377"><span class="linenos">377</span></a>                        <span class="n">winklerscore</span> <span class="o">=</span> <span class="n">winkler_score</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
</span><span id="LazyMTS-378"><a href="#LazyMTS-378"><span class="linenos">378</span></a>                        <span class="n">coveragecalc</span> <span class="o">=</span> <span class="n">coverage</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
</span><span id="LazyMTS-379"><a href="#LazyMTS-379"><span class="linenos">379</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS-380"><a href="#LazyMTS-380"><span class="linenos">380</span></a>                        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyMTS-381"><a href="#LazyMTS-381"><span class="linenos">381</span></a>                        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS-382"><a href="#LazyMTS-382"><span class="linenos">382</span></a>                        <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS-383"><a href="#LazyMTS-383"><span class="linenos">383</span></a>
</span><span id="LazyMTS-384"><a href="#LazyMTS-384"><span class="linenos">384</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyMTS-385"><a href="#LazyMTS-385"><span class="linenos">385</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyMTS-386"><a href="#LazyMTS-386"><span class="linenos">386</span></a>                    <span class="n">MAE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</span><span id="LazyMTS-387"><a href="#LazyMTS-387"><span class="linenos">387</span></a>                    <span class="n">MPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpl</span><span class="p">)</span>
</span><span id="LazyMTS-388"><a href="#LazyMTS-388"><span class="linenos">388</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyMTS-389"><a href="#LazyMTS-389"><span class="linenos">389</span></a>                        <span class="n">WINKLERSCORE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">winklerscore</span><span class="p">)</span>
</span><span id="LazyMTS-390"><a href="#LazyMTS-390"><span class="linenos">390</span></a>                        <span class="n">COVERAGE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coveragecalc</span><span class="p">)</span>
</span><span id="LazyMTS-391"><a href="#LazyMTS-391"><span class="linenos">391</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyMTS-392"><a href="#LazyMTS-392"><span class="linenos">392</span></a>
</span><span id="LazyMTS-393"><a href="#LazyMTS-393"><span class="linenos">393</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS-394"><a href="#LazyMTS-394"><span class="linenos">394</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS-395"><a href="#LazyMTS-395"><span class="linenos">395</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyMTS-396"><a href="#LazyMTS-396"><span class="linenos">396</span></a>
</span><span id="LazyMTS-397"><a href="#LazyMTS-397"><span class="linenos">397</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyMTS-398"><a href="#LazyMTS-398"><span class="linenos">398</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyMTS-399"><a href="#LazyMTS-399"><span class="linenos">399</span></a>                            <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS-400"><a href="#LazyMTS-400"><span class="linenos">400</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyMTS-401"><a href="#LazyMTS-401"><span class="linenos">401</span></a>                                <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyMTS-402"><a href="#LazyMTS-402"><span class="linenos">402</span></a>                                <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyMTS-403"><a href="#LazyMTS-403"><span class="linenos">403</span></a>                                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyMTS-404"><a href="#LazyMTS-404"><span class="linenos">404</span></a>                                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyMTS-405"><a href="#LazyMTS-405"><span class="linenos">405</span></a>                                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyMTS-406"><a href="#LazyMTS-406"><span class="linenos">406</span></a>                                <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyMTS-407"><a href="#LazyMTS-407"><span class="linenos">407</span></a>                                <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyMTS-408"><a href="#LazyMTS-408"><span class="linenos">408</span></a>                                <span class="s2">&quot;WINKLERSCORE&quot;</span><span class="p">:</span> <span class="n">winklerscore</span><span class="p">,</span>
</span><span id="LazyMTS-409"><a href="#LazyMTS-409"><span class="linenos">409</span></a>                                <span class="s2">&quot;COVERAGE&quot;</span><span class="p">:</span> <span class="n">coveragecalc</span><span class="p">,</span>
</span><span id="LazyMTS-410"><a href="#LazyMTS-410"><span class="linenos">410</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyMTS-411"><a href="#LazyMTS-411"><span class="linenos">411</span></a>                            <span class="p">}</span>
</span><span id="LazyMTS-412"><a href="#LazyMTS-412"><span class="linenos">412</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS-413"><a href="#LazyMTS-413"><span class="linenos">413</span></a>                            <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS-414"><a href="#LazyMTS-414"><span class="linenos">414</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyMTS-415"><a href="#LazyMTS-415"><span class="linenos">415</span></a>                                <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyMTS-416"><a href="#LazyMTS-416"><span class="linenos">416</span></a>                                <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyMTS-417"><a href="#LazyMTS-417"><span class="linenos">417</span></a>                                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyMTS-418"><a href="#LazyMTS-418"><span class="linenos">418</span></a>                                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyMTS-419"><a href="#LazyMTS-419"><span class="linenos">419</span></a>                                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyMTS-420"><a href="#LazyMTS-420"><span class="linenos">420</span></a>                                <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyMTS-421"><a href="#LazyMTS-421"><span class="linenos">421</span></a>                                <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyMTS-422"><a href="#LazyMTS-422"><span class="linenos">422</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyMTS-423"><a href="#LazyMTS-423"><span class="linenos">423</span></a>                            <span class="p">}</span>
</span><span id="LazyMTS-424"><a href="#LazyMTS-424"><span class="linenos">424</span></a>
</span><span id="LazyMTS-425"><a href="#LazyMTS-425"><span class="linenos">425</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS-426"><a href="#LazyMTS-426"><span class="linenos">426</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyMTS-427"><a href="#LazyMTS-427"><span class="linenos">427</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyMTS-428"><a href="#LazyMTS-428"><span class="linenos">428</span></a>                            <span class="p">)</span>
</span><span id="LazyMTS-429"><a href="#LazyMTS-429"><span class="linenos">429</span></a>
</span><span id="LazyMTS-430"><a href="#LazyMTS-430"><span class="linenos">430</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyMTS-431"><a href="#LazyMTS-431"><span class="linenos">431</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyMTS-432"><a href="#LazyMTS-432"><span class="linenos">432</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_pred</span>
</span><span id="LazyMTS-433"><a href="#LazyMTS-433"><span class="linenos">433</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyMTS-434"><a href="#LazyMTS-434"><span class="linenos">434</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyMTS-435"><a href="#LazyMTS-435"><span class="linenos">435</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyMTS-436"><a href="#LazyMTS-436"><span class="linenos">436</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyMTS-437"><a href="#LazyMTS-437"><span class="linenos">437</span></a>
</span><span id="LazyMTS-438"><a href="#LazyMTS-438"><span class="linenos">438</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># no preprocessing</span>
</span><span id="LazyMTS-439"><a href="#LazyMTS-439"><span class="linenos">439</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyMTS-440"><a href="#LazyMTS-440"><span class="linenos">440</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyMTS-441"><a href="#LazyMTS-441"><span class="linenos">441</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyMTS-442"><a href="#LazyMTS-442"><span class="linenos">442</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyMTS-443"><a href="#LazyMTS-443"><span class="linenos">443</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">MTS</span><span class="p">(</span>
</span><span id="LazyMTS-444"><a href="#LazyMTS-444"><span class="linenos">444</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyMTS-445"><a href="#LazyMTS-445"><span class="linenos">445</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS-446"><a href="#LazyMTS-446"><span class="linenos">446</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS-447"><a href="#LazyMTS-447"><span class="linenos">447</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS-448"><a href="#LazyMTS-448"><span class="linenos">448</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS-449"><a href="#LazyMTS-449"><span class="linenos">449</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS-450"><a href="#LazyMTS-450"><span class="linenos">450</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS-451"><a href="#LazyMTS-451"><span class="linenos">451</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS-452"><a href="#LazyMTS-452"><span class="linenos">452</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS-453"><a href="#LazyMTS-453"><span class="linenos">453</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS-454"><a href="#LazyMTS-454"><span class="linenos">454</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS-455"><a href="#LazyMTS-455"><span class="linenos">455</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS-456"><a href="#LazyMTS-456"><span class="linenos">456</span></a>                            <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS-457"><a href="#LazyMTS-457"><span class="linenos">457</span></a>                            <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS-458"><a href="#LazyMTS-458"><span class="linenos">458</span></a>                            <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS-459"><a href="#LazyMTS-459"><span class="linenos">459</span></a>                            <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS-460"><a href="#LazyMTS-460"><span class="linenos">460</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS-461"><a href="#LazyMTS-461"><span class="linenos">461</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS-462"><a href="#LazyMTS-462"><span class="linenos">462</span></a>                            <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS-463"><a href="#LazyMTS-463"><span class="linenos">463</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS-464"><a href="#LazyMTS-464"><span class="linenos">464</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS-465"><a href="#LazyMTS-465"><span class="linenos">465</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">MTS</span><span class="p">(</span>
</span><span id="LazyMTS-466"><a href="#LazyMTS-466"><span class="linenos">466</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyMTS-467"><a href="#LazyMTS-467"><span class="linenos">467</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS-468"><a href="#LazyMTS-468"><span class="linenos">468</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS-469"><a href="#LazyMTS-469"><span class="linenos">469</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS-470"><a href="#LazyMTS-470"><span class="linenos">470</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS-471"><a href="#LazyMTS-471"><span class="linenos">471</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS-472"><a href="#LazyMTS-472"><span class="linenos">472</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS-473"><a href="#LazyMTS-473"><span class="linenos">473</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS-474"><a href="#LazyMTS-474"><span class="linenos">474</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS-475"><a href="#LazyMTS-475"><span class="linenos">475</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS-476"><a href="#LazyMTS-476"><span class="linenos">476</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS-477"><a href="#LazyMTS-477"><span class="linenos">477</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS-478"><a href="#LazyMTS-478"><span class="linenos">478</span></a>                            <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS-479"><a href="#LazyMTS-479"><span class="linenos">479</span></a>                            <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS-480"><a href="#LazyMTS-480"><span class="linenos">480</span></a>                            <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS-481"><a href="#LazyMTS-481"><span class="linenos">481</span></a>                            <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS-482"><a href="#LazyMTS-482"><span class="linenos">482</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS-483"><a href="#LazyMTS-483"><span class="linenos">483</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS-484"><a href="#LazyMTS-484"><span class="linenos">484</span></a>                            <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS-485"><a href="#LazyMTS-485"><span class="linenos">485</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS-486"><a href="#LazyMTS-486"><span class="linenos">486</span></a>
</span><span id="LazyMTS-487"><a href="#LazyMTS-487"><span class="linenos">487</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">xreg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="LazyMTS-488"><a href="#LazyMTS-488"><span class="linenos">488</span></a>                    <span class="c1"># pipe.fit(X_train, xreg=xreg) # DO xreg like in `ahead`</span>
</span><span id="LazyMTS-489"><a href="#LazyMTS-489"><span class="linenos">489</span></a>
</span><span id="LazyMTS-490"><a href="#LazyMTS-490"><span class="linenos">490</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyMTS-491"><a href="#LazyMTS-491"><span class="linenos">491</span></a>
</span><span id="LazyMTS-492"><a href="#LazyMTS-492"><span class="linenos">492</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyMTS-493"><a href="#LazyMTS-493"><span class="linenos">493</span></a>                        <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">[</span><span class="s2">&quot;regressor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyMTS-494"><a href="#LazyMTS-494"><span class="linenos">494</span></a>                            <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyMTS-495"><a href="#LazyMTS-495"><span class="linenos">495</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS-496"><a href="#LazyMTS-496"><span class="linenos">496</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS-497"><a href="#LazyMTS-497"><span class="linenos">497</span></a>                        <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyMTS-498"><a href="#LazyMTS-498"><span class="linenos">498</span></a>                            <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyMTS-499"><a href="#LazyMTS-499"><span class="linenos">499</span></a>                        <span class="p">)</span>  <span class="c1"># X_pred = pipe.predict(h=X_test.shape[0], new_xreg=new_xreg) ## DO xreg like in `ahead`</span>
</span><span id="LazyMTS-500"><a href="#LazyMTS-500"><span class="linenos">500</span></a>
</span><span id="LazyMTS-501"><a href="#LazyMTS-501"><span class="linenos">501</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyMTS-502"><a href="#LazyMTS-502"><span class="linenos">502</span></a>                        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span>
</span><span id="LazyMTS-503"><a href="#LazyMTS-503"><span class="linenos">503</span></a>                            <span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span>
</span><span id="LazyMTS-504"><a href="#LazyMTS-504"><span class="linenos">504</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS-505"><a href="#LazyMTS-505"><span class="linenos">505</span></a>                        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span><span id="LazyMTS-506"><a href="#LazyMTS-506"><span class="linenos">506</span></a>                        <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span><span id="LazyMTS-507"><a href="#LazyMTS-507"><span class="linenos">507</span></a>                        <span class="n">winklerscore</span> <span class="o">=</span> <span class="n">winkler_score</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
</span><span id="LazyMTS-508"><a href="#LazyMTS-508"><span class="linenos">508</span></a>                        <span class="n">coveragecalc</span> <span class="o">=</span> <span class="n">coverage</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
</span><span id="LazyMTS-509"><a href="#LazyMTS-509"><span class="linenos">509</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS-510"><a href="#LazyMTS-510"><span class="linenos">510</span></a>                        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyMTS-511"><a href="#LazyMTS-511"><span class="linenos">511</span></a>                        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS-512"><a href="#LazyMTS-512"><span class="linenos">512</span></a>                        <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS-513"><a href="#LazyMTS-513"><span class="linenos">513</span></a>
</span><span id="LazyMTS-514"><a href="#LazyMTS-514"><span class="linenos">514</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyMTS-515"><a href="#LazyMTS-515"><span class="linenos">515</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyMTS-516"><a href="#LazyMTS-516"><span class="linenos">516</span></a>                    <span class="n">MAE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</span><span id="LazyMTS-517"><a href="#LazyMTS-517"><span class="linenos">517</span></a>                    <span class="n">MPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpl</span><span class="p">)</span>
</span><span id="LazyMTS-518"><a href="#LazyMTS-518"><span class="linenos">518</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyMTS-519"><a href="#LazyMTS-519"><span class="linenos">519</span></a>                        <span class="n">WINKLERSCORE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">winklerscore</span><span class="p">)</span>
</span><span id="LazyMTS-520"><a href="#LazyMTS-520"><span class="linenos">520</span></a>                        <span class="n">COVERAGE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coveragecalc</span><span class="p">)</span>
</span><span id="LazyMTS-521"><a href="#LazyMTS-521"><span class="linenos">521</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyMTS-522"><a href="#LazyMTS-522"><span class="linenos">522</span></a>
</span><span id="LazyMTS-523"><a href="#LazyMTS-523"><span class="linenos">523</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS-524"><a href="#LazyMTS-524"><span class="linenos">524</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS-525"><a href="#LazyMTS-525"><span class="linenos">525</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyMTS-526"><a href="#LazyMTS-526"><span class="linenos">526</span></a>
</span><span id="LazyMTS-527"><a href="#LazyMTS-527"><span class="linenos">527</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyMTS-528"><a href="#LazyMTS-528"><span class="linenos">528</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyMTS-529"><a href="#LazyMTS-529"><span class="linenos">529</span></a>                            <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS-530"><a href="#LazyMTS-530"><span class="linenos">530</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyMTS-531"><a href="#LazyMTS-531"><span class="linenos">531</span></a>                                <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyMTS-532"><a href="#LazyMTS-532"><span class="linenos">532</span></a>                                <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyMTS-533"><a href="#LazyMTS-533"><span class="linenos">533</span></a>                                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyMTS-534"><a href="#LazyMTS-534"><span class="linenos">534</span></a>                                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyMTS-535"><a href="#LazyMTS-535"><span class="linenos">535</span></a>                                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyMTS-536"><a href="#LazyMTS-536"><span class="linenos">536</span></a>                                <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyMTS-537"><a href="#LazyMTS-537"><span class="linenos">537</span></a>                                <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyMTS-538"><a href="#LazyMTS-538"><span class="linenos">538</span></a>                                <span class="s2">&quot;WINKLERSCORE&quot;</span><span class="p">:</span> <span class="n">winklerscore</span><span class="p">,</span>
</span><span id="LazyMTS-539"><a href="#LazyMTS-539"><span class="linenos">539</span></a>                                <span class="s2">&quot;COVERAGE&quot;</span><span class="p">:</span> <span class="n">coveragecalc</span><span class="p">,</span>
</span><span id="LazyMTS-540"><a href="#LazyMTS-540"><span class="linenos">540</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyMTS-541"><a href="#LazyMTS-541"><span class="linenos">541</span></a>                            <span class="p">}</span>
</span><span id="LazyMTS-542"><a href="#LazyMTS-542"><span class="linenos">542</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS-543"><a href="#LazyMTS-543"><span class="linenos">543</span></a>                            <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS-544"><a href="#LazyMTS-544"><span class="linenos">544</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyMTS-545"><a href="#LazyMTS-545"><span class="linenos">545</span></a>                                <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyMTS-546"><a href="#LazyMTS-546"><span class="linenos">546</span></a>                                <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyMTS-547"><a href="#LazyMTS-547"><span class="linenos">547</span></a>                                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyMTS-548"><a href="#LazyMTS-548"><span class="linenos">548</span></a>                                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyMTS-549"><a href="#LazyMTS-549"><span class="linenos">549</span></a>                                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyMTS-550"><a href="#LazyMTS-550"><span class="linenos">550</span></a>                                <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyMTS-551"><a href="#LazyMTS-551"><span class="linenos">551</span></a>                                <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyMTS-552"><a href="#LazyMTS-552"><span class="linenos">552</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyMTS-553"><a href="#LazyMTS-553"><span class="linenos">553</span></a>                            <span class="p">}</span>
</span><span id="LazyMTS-554"><a href="#LazyMTS-554"><span class="linenos">554</span></a>
</span><span id="LazyMTS-555"><a href="#LazyMTS-555"><span class="linenos">555</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS-556"><a href="#LazyMTS-556"><span class="linenos">556</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyMTS-557"><a href="#LazyMTS-557"><span class="linenos">557</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyMTS-558"><a href="#LazyMTS-558"><span class="linenos">558</span></a>                            <span class="p">)</span>
</span><span id="LazyMTS-559"><a href="#LazyMTS-559"><span class="linenos">559</span></a>
</span><span id="LazyMTS-560"><a href="#LazyMTS-560"><span class="linenos">560</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyMTS-561"><a href="#LazyMTS-561"><span class="linenos">561</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyMTS-562"><a href="#LazyMTS-562"><span class="linenos">562</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_pred</span>
</span><span id="LazyMTS-563"><a href="#LazyMTS-563"><span class="linenos">563</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyMTS-564"><a href="#LazyMTS-564"><span class="linenos">564</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyMTS-565"><a href="#LazyMTS-565"><span class="linenos">565</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyMTS-566"><a href="#LazyMTS-566"><span class="linenos">566</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyMTS-567"><a href="#LazyMTS-567"><span class="linenos">567</span></a>
</span><span id="LazyMTS-568"><a href="#LazyMTS-568"><span class="linenos">568</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyMTS-569"><a href="#LazyMTS-569"><span class="linenos">569</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS-570"><a href="#LazyMTS-570"><span class="linenos">570</span></a>                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyMTS-571"><a href="#LazyMTS-571"><span class="linenos">571</span></a>                <span class="c1"># &quot;Adjusted R-Squared&quot;: ADJR2,</span>
</span><span id="LazyMTS-572"><a href="#LazyMTS-572"><span class="linenos">572</span></a>                <span class="c1"># &quot;R-Squared&quot;: R2,</span>
</span><span id="LazyMTS-573"><a href="#LazyMTS-573"><span class="linenos">573</span></a>                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyMTS-574"><a href="#LazyMTS-574"><span class="linenos">574</span></a>                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">MAE</span><span class="p">,</span>
</span><span id="LazyMTS-575"><a href="#LazyMTS-575"><span class="linenos">575</span></a>                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">MPL</span><span class="p">,</span>
</span><span id="LazyMTS-576"><a href="#LazyMTS-576"><span class="linenos">576</span></a>                <span class="c1"># &quot;MPE&quot;: MPE,</span>
</span><span id="LazyMTS-577"><a href="#LazyMTS-577"><span class="linenos">577</span></a>                <span class="c1"># &quot;MAPE&quot;: MAPE,</span>
</span><span id="LazyMTS-578"><a href="#LazyMTS-578"><span class="linenos">578</span></a>                <span class="s2">&quot;WINKLERSCORE&quot;</span><span class="p">:</span> <span class="n">WINKLERSCORE</span><span class="p">,</span>
</span><span id="LazyMTS-579"><a href="#LazyMTS-579"><span class="linenos">579</span></a>                <span class="s2">&quot;COVERAGE&quot;</span><span class="p">:</span> <span class="n">COVERAGE</span><span class="p">,</span>
</span><span id="LazyMTS-580"><a href="#LazyMTS-580"><span class="linenos">580</span></a>                <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyMTS-581"><a href="#LazyMTS-581"><span class="linenos">581</span></a>            <span class="p">}</span>
</span><span id="LazyMTS-582"><a href="#LazyMTS-582"><span class="linenos">582</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS-583"><a href="#LazyMTS-583"><span class="linenos">583</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS-584"><a href="#LazyMTS-584"><span class="linenos">584</span></a>                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyMTS-585"><a href="#LazyMTS-585"><span class="linenos">585</span></a>                <span class="c1"># &quot;Adjusted R-Squared&quot;: ADJR2,</span>
</span><span id="LazyMTS-586"><a href="#LazyMTS-586"><span class="linenos">586</span></a>                <span class="c1"># &quot;R-Squared&quot;: R2,</span>
</span><span id="LazyMTS-587"><a href="#LazyMTS-587"><span class="linenos">587</span></a>                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyMTS-588"><a href="#LazyMTS-588"><span class="linenos">588</span></a>                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">MAE</span><span class="p">,</span>
</span><span id="LazyMTS-589"><a href="#LazyMTS-589"><span class="linenos">589</span></a>                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">MPL</span><span class="p">,</span>
</span><span id="LazyMTS-590"><a href="#LazyMTS-590"><span class="linenos">590</span></a>                <span class="c1"># &quot;MPE&quot;: MPE,</span>
</span><span id="LazyMTS-591"><a href="#LazyMTS-591"><span class="linenos">591</span></a>                <span class="c1"># &quot;MAPE&quot;: MAPE,</span>
</span><span id="LazyMTS-592"><a href="#LazyMTS-592"><span class="linenos">592</span></a>                <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyMTS-593"><a href="#LazyMTS-593"><span class="linenos">593</span></a>            <span class="p">}</span>
</span><span id="LazyMTS-594"><a href="#LazyMTS-594"><span class="linenos">594</span></a>
</span><span id="LazyMTS-595"><a href="#LazyMTS-595"><span class="linenos">595</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS-596"><a href="#LazyMTS-596"><span class="linenos">596</span></a>            <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">CUSTOM_METRIC</span>
</span><span id="LazyMTS-597"><a href="#LazyMTS-597"><span class="linenos">597</span></a>
</span><span id="LazyMTS-598"><a href="#LazyMTS-598"><span class="linenos">598</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LazyMTS-599"><a href="#LazyMTS-599"><span class="linenos">599</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyMTS-600"><a href="#LazyMTS-600"><span class="linenos">600</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyMTS-601"><a href="#LazyMTS-601"><span class="linenos">601</span></a>        <span class="p">)</span>
</span><span id="LazyMTS-602"><a href="#LazyMTS-602"><span class="linenos">602</span></a>
</span><span id="LazyMTS-603"><a href="#LazyMTS-603"><span class="linenos">603</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyMTS-604"><a href="#LazyMTS-604"><span class="linenos">604</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyMTS-605"><a href="#LazyMTS-605"><span class="linenos">605</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span><span id="LazyMTS-606"><a href="#LazyMTS-606"><span class="linenos">606</span></a>
</span><span id="LazyMTS-607"><a href="#LazyMTS-607"><span class="linenos">607</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">):</span>
</span><span id="LazyMTS-608"><a href="#LazyMTS-608"><span class="linenos">608</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyMTS-609"><a href="#LazyMTS-609"><span class="linenos">609</span></a><span class="sd">        This function returns all the model objects trained in fit function.</span>
</span><span id="LazyMTS-610"><a href="#LazyMTS-610"><span class="linenos">610</span></a><span class="sd">        If fit is not called already, then we call fit and then return the models.</span>
</span><span id="LazyMTS-611"><a href="#LazyMTS-611"><span class="linenos">611</span></a>
</span><span id="LazyMTS-612"><a href="#LazyMTS-612"><span class="linenos">612</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyMTS-613"><a href="#LazyMTS-613"><span class="linenos">613</span></a>
</span><span id="LazyMTS-614"><a href="#LazyMTS-614"><span class="linenos">614</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyMTS-615"><a href="#LazyMTS-615"><span class="linenos">615</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyMTS-616"><a href="#LazyMTS-616"><span class="linenos">616</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyMTS-617"><a href="#LazyMTS-617"><span class="linenos">617</span></a>
</span><span id="LazyMTS-618"><a href="#LazyMTS-618"><span class="linenos">618</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyMTS-619"><a href="#LazyMTS-619"><span class="linenos">619</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyMTS-620"><a href="#LazyMTS-620"><span class="linenos">620</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyMTS-621"><a href="#LazyMTS-621"><span class="linenos">621</span></a>
</span><span id="LazyMTS-622"><a href="#LazyMTS-622"><span class="linenos">622</span></a><span class="sd">        Returns:</span>
</span><span id="LazyMTS-623"><a href="#LazyMTS-623"><span class="linenos">623</span></a>
</span><span id="LazyMTS-624"><a href="#LazyMTS-624"><span class="linenos">624</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyMTS-625"><a href="#LazyMTS-625"><span class="linenos">625</span></a><span class="sd">                Returns a dictionary with each model pipeline as value</span>
</span><span id="LazyMTS-626"><a href="#LazyMTS-626"><span class="linenos">626</span></a><span class="sd">                with key as name of models.</span>
</span><span id="LazyMTS-627"><a href="#LazyMTS-627"><span class="linenos">627</span></a>
</span><span id="LazyMTS-628"><a href="#LazyMTS-628"><span class="linenos">628</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyMTS-629"><a href="#LazyMTS-629"><span class="linenos">629</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyMTS-630"><a href="#LazyMTS-630"><span class="linenos">630</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyMTS-631"><a href="#LazyMTS-631"><span class="linenos">631</span></a>
</span><span id="LazyMTS-632"><a href="#LazyMTS-632"><span class="linenos">632</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>Fitting -- almost -- all the regression algorithms with layers of
nnetsauce's CustomRegressor to multivariate time series
and returning their scores.</p>

<p>Parameters:</p>

<pre><code>verbose: int, optional (default=0)
    Any positive number for verbosity.

ignore_warnings: bool, optional (default=True)
    When set to True, the warning related to algorigms that are not
    able to run are ignored.

custom_metric: function, optional (default=None)
    When function is provided, models are evaluated based on the custom
      evaluation metric provided.

predictions: bool, optional (default=False)
    When set to True, the predictions of all the models models are returned as dataframe.

sort_by: string, optional (default='RMSE')
    Sort models by a metric. Available options are 'RMSE', 'MAE', 'MPL', 'MPE', 'MAPE',
    'R-Squared', 'Adjusted R-Squared' or a custom metric identified by its name and
    provided by custom_metric.

random_state: int, optional (default=42)
    Reproducibiility seed.

estimators: list, optional (default='all')
    list of Estimators (regression algorithms) names or just 'all' (default='all')

preprocess: bool, preprocessing is done when set to True

n_jobs : int, when possible, run in parallel
    For now, only used by individual models that support it.

n_layers: int, optional (default=3)
    Number of layers of CustomRegressors to be used.

All the other parameters are the same as MTS's.
</code></pre>

<p>Examples:</p>

<pre><code>See https://thierrymoudiki.github.io/blog/2023/10/29/python/quasirandomizednn/MTS-LazyPredict
</code></pre>
</div>


                                <div id="LazyMTS.fit" class="classattr">
                                            <input id="LazyMTS.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">xreg</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyMTS.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyMTS.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyMTS.fit-204"><a href="#LazyMTS.fit-204"><span class="linenos">204</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">xreg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="LazyMTS.fit-205"><a href="#LazyMTS.fit-205"><span class="linenos">205</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X_train, predict and score on X_test.</span>
</span><span id="LazyMTS.fit-206"><a href="#LazyMTS.fit-206"><span class="linenos">206</span></a>
</span><span id="LazyMTS.fit-207"><a href="#LazyMTS.fit-207"><span class="linenos">207</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyMTS.fit-208"><a href="#LazyMTS.fit-208"><span class="linenos">208</span></a>
</span><span id="LazyMTS.fit-209"><a href="#LazyMTS.fit-209"><span class="linenos">209</span></a><span class="sd">            X_train: array-like,</span>
</span><span id="LazyMTS.fit-210"><a href="#LazyMTS.fit-210"><span class="linenos">210</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyMTS.fit-211"><a href="#LazyMTS.fit-211"><span class="linenos">211</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyMTS.fit-212"><a href="#LazyMTS.fit-212"><span class="linenos">212</span></a>
</span><span id="LazyMTS.fit-213"><a href="#LazyMTS.fit-213"><span class="linenos">213</span></a><span class="sd">            X_test: array-like,</span>
</span><span id="LazyMTS.fit-214"><a href="#LazyMTS.fit-214"><span class="linenos">214</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyMTS.fit-215"><a href="#LazyMTS.fit-215"><span class="linenos">215</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyMTS.fit-216"><a href="#LazyMTS.fit-216"><span class="linenos">216</span></a>
</span><span id="LazyMTS.fit-217"><a href="#LazyMTS.fit-217"><span class="linenos">217</span></a><span class="sd">            xreg: array-like, optional (default=None)</span>
</span><span id="LazyMTS.fit-218"><a href="#LazyMTS.fit-218"><span class="linenos">218</span></a><span class="sd">                Additional (external) regressors to be passed to self.obj</span>
</span><span id="LazyMTS.fit-219"><a href="#LazyMTS.fit-219"><span class="linenos">219</span></a><span class="sd">                xreg must be in &#39;increasing&#39; order (most recent observations last)</span>
</span><span id="LazyMTS.fit-220"><a href="#LazyMTS.fit-220"><span class="linenos">220</span></a>
</span><span id="LazyMTS.fit-221"><a href="#LazyMTS.fit-221"><span class="linenos">221</span></a><span class="sd">        Returns:</span>
</span><span id="LazyMTS.fit-222"><a href="#LazyMTS.fit-222"><span class="linenos">222</span></a>
</span><span id="LazyMTS.fit-223"><a href="#LazyMTS.fit-223"><span class="linenos">223</span></a><span class="sd">            scores: Pandas DataFrame</span>
</span><span id="LazyMTS.fit-224"><a href="#LazyMTS.fit-224"><span class="linenos">224</span></a><span class="sd">                Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyMTS.fit-225"><a href="#LazyMTS.fit-225"><span class="linenos">225</span></a>
</span><span id="LazyMTS.fit-226"><a href="#LazyMTS.fit-226"><span class="linenos">226</span></a><span class="sd">            predictions: Pandas DataFrame</span>
</span><span id="LazyMTS.fit-227"><a href="#LazyMTS.fit-227"><span class="linenos">227</span></a><span class="sd">                Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyMTS.fit-228"><a href="#LazyMTS.fit-228"><span class="linenos">228</span></a>
</span><span id="LazyMTS.fit-229"><a href="#LazyMTS.fit-229"><span class="linenos">229</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyMTS.fit-230"><a href="#LazyMTS.fit-230"><span class="linenos">230</span></a>        <span class="n">R2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-231"><a href="#LazyMTS.fit-231"><span class="linenos">231</span></a>        <span class="n">ADJR2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-232"><a href="#LazyMTS.fit-232"><span class="linenos">232</span></a>        <span class="n">ME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-233"><a href="#LazyMTS.fit-233"><span class="linenos">233</span></a>        <span class="n">MPL</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-234"><a href="#LazyMTS.fit-234"><span class="linenos">234</span></a>        <span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-235"><a href="#LazyMTS.fit-235"><span class="linenos">235</span></a>        <span class="n">MAE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-236"><a href="#LazyMTS.fit-236"><span class="linenos">236</span></a>        <span class="n">MPE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-237"><a href="#LazyMTS.fit-237"><span class="linenos">237</span></a>        <span class="n">MAPE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-238"><a href="#LazyMTS.fit-238"><span class="linenos">238</span></a>        <span class="n">WINKLERSCORE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-239"><a href="#LazyMTS.fit-239"><span class="linenos">239</span></a>        <span class="n">COVERAGE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-240"><a href="#LazyMTS.fit-240"><span class="linenos">240</span></a>
</span><span id="LazyMTS.fit-241"><a href="#LazyMTS.fit-241"><span class="linenos">241</span></a>        <span class="c1"># WIN = []</span>
</span><span id="LazyMTS.fit-242"><a href="#LazyMTS.fit-242"><span class="linenos">242</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-243"><a href="#LazyMTS.fit-243"><span class="linenos">243</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-244"><a href="#LazyMTS.fit-244"><span class="linenos">244</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyMTS.fit-245"><a href="#LazyMTS.fit-245"><span class="linenos">245</span></a>
</span><span id="LazyMTS.fit-246"><a href="#LazyMTS.fit-246"><span class="linenos">246</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS.fit-247"><a href="#LazyMTS.fit-247"><span class="linenos">247</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-248"><a href="#LazyMTS.fit-248"><span class="linenos">248</span></a>
</span><span id="LazyMTS.fit-249"><a href="#LazyMTS.fit-249"><span class="linenos">249</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyMTS.fit-250"><a href="#LazyMTS.fit-250"><span class="linenos">250</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyMTS.fit-251"><a href="#LazyMTS.fit-251"><span class="linenos">251</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyMTS.fit-252"><a href="#LazyMTS.fit-252"><span class="linenos">252</span></a>
</span><span id="LazyMTS.fit-253"><a href="#LazyMTS.fit-253"><span class="linenos">253</span></a>        <span class="n">X_train</span> <span class="o">=</span> <span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyMTS.fit-254"><a href="#LazyMTS.fit-254"><span class="linenos">254</span></a>        <span class="n">X_test</span> <span class="o">=</span> <span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyMTS.fit-255"><a href="#LazyMTS.fit-255"><span class="linenos">255</span></a>
</span><span id="LazyMTS.fit-256"><a href="#LazyMTS.fit-256"><span class="linenos">256</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyMTS.fit-257"><a href="#LazyMTS.fit-257"><span class="linenos">257</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyMTS.fit-258"><a href="#LazyMTS.fit-258"><span class="linenos">258</span></a>
</span><span id="LazyMTS.fit-259"><a href="#LazyMTS.fit-259"><span class="linenos">259</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyMTS.fit-260"><a href="#LazyMTS.fit-260"><span class="linenos">260</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyMTS.fit-261"><a href="#LazyMTS.fit-261"><span class="linenos">261</span></a>        <span class="p">)</span>
</span><span id="LazyMTS.fit-262"><a href="#LazyMTS.fit-262"><span class="linenos">262</span></a>
</span><span id="LazyMTS.fit-263"><a href="#LazyMTS.fit-263"><span class="linenos">263</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span><span class="p">:</span>
</span><span id="LazyMTS.fit-264"><a href="#LazyMTS.fit-264"><span class="linenos">264</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyMTS.fit-265"><a href="#LazyMTS.fit-265"><span class="linenos">265</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyMTS.fit-266"><a href="#LazyMTS.fit-266"><span class="linenos">266</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyMTS.fit-267"><a href="#LazyMTS.fit-267"><span class="linenos">267</span></a>                    <span class="p">(</span>
</span><span id="LazyMTS.fit-268"><a href="#LazyMTS.fit-268"><span class="linenos">268</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyMTS.fit-269"><a href="#LazyMTS.fit-269"><span class="linenos">269</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyMTS.fit-270"><a href="#LazyMTS.fit-270"><span class="linenos">270</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyMTS.fit-271"><a href="#LazyMTS.fit-271"><span class="linenos">271</span></a>                    <span class="p">),</span>
</span><span id="LazyMTS.fit-272"><a href="#LazyMTS.fit-272"><span class="linenos">272</span></a>                    <span class="p">(</span>
</span><span id="LazyMTS.fit-273"><a href="#LazyMTS.fit-273"><span class="linenos">273</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyMTS.fit-274"><a href="#LazyMTS.fit-274"><span class="linenos">274</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyMTS.fit-275"><a href="#LazyMTS.fit-275"><span class="linenos">275</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyMTS.fit-276"><a href="#LazyMTS.fit-276"><span class="linenos">276</span></a>                    <span class="p">),</span>
</span><span id="LazyMTS.fit-277"><a href="#LazyMTS.fit-277"><span class="linenos">277</span></a>                <span class="p">]</span>
</span><span id="LazyMTS.fit-278"><a href="#LazyMTS.fit-278"><span class="linenos">278</span></a>            <span class="p">)</span>
</span><span id="LazyMTS.fit-279"><a href="#LazyMTS.fit-279"><span class="linenos">279</span></a>
</span><span id="LazyMTS.fit-280"><a href="#LazyMTS.fit-280"><span class="linenos">280</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyMTS.fit-281"><a href="#LazyMTS.fit-281"><span class="linenos">281</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="n">REGRESSORSMTS</span>
</span><span id="LazyMTS.fit-282"><a href="#LazyMTS.fit-282"><span class="linenos">282</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS.fit-283"><a href="#LazyMTS.fit-283"><span class="linenos">283</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyMTS.fit-284"><a href="#LazyMTS.fit-284"><span class="linenos">284</span></a>                <span class="p">(</span><span class="s2">&quot;MTS(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyMTS.fit-285"><a href="#LazyMTS.fit-285"><span class="linenos">285</span></a>                <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyMTS.fit-286"><a href="#LazyMTS.fit-286"><span class="linenos">286</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyMTS.fit-287"><a href="#LazyMTS.fit-287"><span class="linenos">287</span></a>                    <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyMTS.fit-288"><a href="#LazyMTS.fit-288"><span class="linenos">288</span></a>                    <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyMTS.fit-289"><a href="#LazyMTS.fit-289"><span class="linenos">289</span></a>                <span class="p">)</span>
</span><span id="LazyMTS.fit-290"><a href="#LazyMTS.fit-290"><span class="linenos">290</span></a>            <span class="p">]</span>
</span><span id="LazyMTS.fit-291"><a href="#LazyMTS.fit-291"><span class="linenos">291</span></a>
</span><span id="LazyMTS.fit-292"><a href="#LazyMTS.fit-292"><span class="linenos">292</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyMTS.fit-293"><a href="#LazyMTS.fit-293"><span class="linenos">293</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyMTS.fit-294"><a href="#LazyMTS.fit-294"><span class="linenos">294</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyMTS.fit-295"><a href="#LazyMTS.fit-295"><span class="linenos">295</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyMTS.fit-296"><a href="#LazyMTS.fit-296"><span class="linenos">296</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyMTS.fit-297"><a href="#LazyMTS.fit-297"><span class="linenos">297</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyMTS.fit-298"><a href="#LazyMTS.fit-298"><span class="linenos">298</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyMTS.fit-299"><a href="#LazyMTS.fit-299"><span class="linenos">299</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyMTS.fit-300"><a href="#LazyMTS.fit-300"><span class="linenos">300</span></a>                                <span class="p">(</span>
</span><span id="LazyMTS.fit-301"><a href="#LazyMTS.fit-301"><span class="linenos">301</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyMTS.fit-302"><a href="#LazyMTS.fit-302"><span class="linenos">302</span></a>                                    <span class="n">MTS</span><span class="p">(</span>
</span><span id="LazyMTS.fit-303"><a href="#LazyMTS.fit-303"><span class="linenos">303</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyMTS.fit-304"><a href="#LazyMTS.fit-304"><span class="linenos">304</span></a>                                            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="LazyMTS.fit-305"><a href="#LazyMTS.fit-305"><span class="linenos">305</span></a>                                            <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyMTS.fit-306"><a href="#LazyMTS.fit-306"><span class="linenos">306</span></a>                                        <span class="p">),</span>
</span><span id="LazyMTS.fit-307"><a href="#LazyMTS.fit-307"><span class="linenos">307</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS.fit-308"><a href="#LazyMTS.fit-308"><span class="linenos">308</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS.fit-309"><a href="#LazyMTS.fit-309"><span class="linenos">309</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS.fit-310"><a href="#LazyMTS.fit-310"><span class="linenos">310</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS.fit-311"><a href="#LazyMTS.fit-311"><span class="linenos">311</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS.fit-312"><a href="#LazyMTS.fit-312"><span class="linenos">312</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS.fit-313"><a href="#LazyMTS.fit-313"><span class="linenos">313</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS.fit-314"><a href="#LazyMTS.fit-314"><span class="linenos">314</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS.fit-315"><a href="#LazyMTS.fit-315"><span class="linenos">315</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS.fit-316"><a href="#LazyMTS.fit-316"><span class="linenos">316</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS.fit-317"><a href="#LazyMTS.fit-317"><span class="linenos">317</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS.fit-318"><a href="#LazyMTS.fit-318"><span class="linenos">318</span></a>                                        <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS.fit-319"><a href="#LazyMTS.fit-319"><span class="linenos">319</span></a>                                        <span class="n">type_pi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span><span class="p">,</span>
</span><span id="LazyMTS.fit-320"><a href="#LazyMTS.fit-320"><span class="linenos">320</span></a>                                        <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS.fit-321"><a href="#LazyMTS.fit-321"><span class="linenos">321</span></a>                                        <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS.fit-322"><a href="#LazyMTS.fit-322"><span class="linenos">322</span></a>                                        <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS.fit-323"><a href="#LazyMTS.fit-323"><span class="linenos">323</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS.fit-324"><a href="#LazyMTS.fit-324"><span class="linenos">324</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS.fit-325"><a href="#LazyMTS.fit-325"><span class="linenos">325</span></a>                                        <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS.fit-326"><a href="#LazyMTS.fit-326"><span class="linenos">326</span></a>                                    <span class="p">),</span>
</span><span id="LazyMTS.fit-327"><a href="#LazyMTS.fit-327"><span class="linenos">327</span></a>                                <span class="p">),</span>
</span><span id="LazyMTS.fit-328"><a href="#LazyMTS.fit-328"><span class="linenos">328</span></a>                            <span class="p">]</span>
</span><span id="LazyMTS.fit-329"><a href="#LazyMTS.fit-329"><span class="linenos">329</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS.fit-330"><a href="#LazyMTS.fit-330"><span class="linenos">330</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS.fit-331"><a href="#LazyMTS.fit-331"><span class="linenos">331</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyMTS.fit-332"><a href="#LazyMTS.fit-332"><span class="linenos">332</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyMTS.fit-333"><a href="#LazyMTS.fit-333"><span class="linenos">333</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyMTS.fit-334"><a href="#LazyMTS.fit-334"><span class="linenos">334</span></a>                                <span class="p">(</span>
</span><span id="LazyMTS.fit-335"><a href="#LazyMTS.fit-335"><span class="linenos">335</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyMTS.fit-336"><a href="#LazyMTS.fit-336"><span class="linenos">336</span></a>                                    <span class="n">MTS</span><span class="p">(</span>
</span><span id="LazyMTS.fit-337"><a href="#LazyMTS.fit-337"><span class="linenos">337</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyMTS.fit-338"><a href="#LazyMTS.fit-338"><span class="linenos">338</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS.fit-339"><a href="#LazyMTS.fit-339"><span class="linenos">339</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS.fit-340"><a href="#LazyMTS.fit-340"><span class="linenos">340</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS.fit-341"><a href="#LazyMTS.fit-341"><span class="linenos">341</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS.fit-342"><a href="#LazyMTS.fit-342"><span class="linenos">342</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS.fit-343"><a href="#LazyMTS.fit-343"><span class="linenos">343</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS.fit-344"><a href="#LazyMTS.fit-344"><span class="linenos">344</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS.fit-345"><a href="#LazyMTS.fit-345"><span class="linenos">345</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS.fit-346"><a href="#LazyMTS.fit-346"><span class="linenos">346</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS.fit-347"><a href="#LazyMTS.fit-347"><span class="linenos">347</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS.fit-348"><a href="#LazyMTS.fit-348"><span class="linenos">348</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS.fit-349"><a href="#LazyMTS.fit-349"><span class="linenos">349</span></a>                                        <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS.fit-350"><a href="#LazyMTS.fit-350"><span class="linenos">350</span></a>                                        <span class="n">type_pi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span><span class="p">,</span>
</span><span id="LazyMTS.fit-351"><a href="#LazyMTS.fit-351"><span class="linenos">351</span></a>                                        <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS.fit-352"><a href="#LazyMTS.fit-352"><span class="linenos">352</span></a>                                        <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS.fit-353"><a href="#LazyMTS.fit-353"><span class="linenos">353</span></a>                                        <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS.fit-354"><a href="#LazyMTS.fit-354"><span class="linenos">354</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS.fit-355"><a href="#LazyMTS.fit-355"><span class="linenos">355</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS.fit-356"><a href="#LazyMTS.fit-356"><span class="linenos">356</span></a>                                        <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS.fit-357"><a href="#LazyMTS.fit-357"><span class="linenos">357</span></a>                                    <span class="p">),</span>
</span><span id="LazyMTS.fit-358"><a href="#LazyMTS.fit-358"><span class="linenos">358</span></a>                                <span class="p">),</span>
</span><span id="LazyMTS.fit-359"><a href="#LazyMTS.fit-359"><span class="linenos">359</span></a>                            <span class="p">]</span>
</span><span id="LazyMTS.fit-360"><a href="#LazyMTS.fit-360"><span class="linenos">360</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS.fit-361"><a href="#LazyMTS.fit-361"><span class="linenos">361</span></a>
</span><span id="LazyMTS.fit-362"><a href="#LazyMTS.fit-362"><span class="linenos">362</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="LazyMTS.fit-363"><a href="#LazyMTS.fit-363"><span class="linenos">363</span></a>                    <span class="c1"># pipe.fit(X_train, xreg=xreg)</span>
</span><span id="LazyMTS.fit-364"><a href="#LazyMTS.fit-364"><span class="linenos">364</span></a>
</span><span id="LazyMTS.fit-365"><a href="#LazyMTS.fit-365"><span class="linenos">365</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyMTS.fit-366"><a href="#LazyMTS.fit-366"><span class="linenos">366</span></a>
</span><span id="LazyMTS.fit-367"><a href="#LazyMTS.fit-367"><span class="linenos">367</span></a>                    <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">[</span><span class="s2">&quot;regressor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyMTS.fit-368"><a href="#LazyMTS.fit-368"><span class="linenos">368</span></a>                        <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyMTS.fit-369"><a href="#LazyMTS.fit-369"><span class="linenos">369</span></a>                    <span class="p">)</span>
</span><span id="LazyMTS.fit-370"><a href="#LazyMTS.fit-370"><span class="linenos">370</span></a>
</span><span id="LazyMTS.fit-371"><a href="#LazyMTS.fit-371"><span class="linenos">371</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyMTS.fit-372"><a href="#LazyMTS.fit-372"><span class="linenos">372</span></a>                        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span>
</span><span id="LazyMTS.fit-373"><a href="#LazyMTS.fit-373"><span class="linenos">373</span></a>                            <span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span>
</span><span id="LazyMTS.fit-374"><a href="#LazyMTS.fit-374"><span class="linenos">374</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS.fit-375"><a href="#LazyMTS.fit-375"><span class="linenos">375</span></a>                        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span><span id="LazyMTS.fit-376"><a href="#LazyMTS.fit-376"><span class="linenos">376</span></a>                        <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span><span id="LazyMTS.fit-377"><a href="#LazyMTS.fit-377"><span class="linenos">377</span></a>                        <span class="n">winklerscore</span> <span class="o">=</span> <span class="n">winkler_score</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
</span><span id="LazyMTS.fit-378"><a href="#LazyMTS.fit-378"><span class="linenos">378</span></a>                        <span class="n">coveragecalc</span> <span class="o">=</span> <span class="n">coverage</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
</span><span id="LazyMTS.fit-379"><a href="#LazyMTS.fit-379"><span class="linenos">379</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS.fit-380"><a href="#LazyMTS.fit-380"><span class="linenos">380</span></a>                        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyMTS.fit-381"><a href="#LazyMTS.fit-381"><span class="linenos">381</span></a>                        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS.fit-382"><a href="#LazyMTS.fit-382"><span class="linenos">382</span></a>                        <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS.fit-383"><a href="#LazyMTS.fit-383"><span class="linenos">383</span></a>
</span><span id="LazyMTS.fit-384"><a href="#LazyMTS.fit-384"><span class="linenos">384</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyMTS.fit-385"><a href="#LazyMTS.fit-385"><span class="linenos">385</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyMTS.fit-386"><a href="#LazyMTS.fit-386"><span class="linenos">386</span></a>                    <span class="n">MAE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</span><span id="LazyMTS.fit-387"><a href="#LazyMTS.fit-387"><span class="linenos">387</span></a>                    <span class="n">MPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpl</span><span class="p">)</span>
</span><span id="LazyMTS.fit-388"><a href="#LazyMTS.fit-388"><span class="linenos">388</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyMTS.fit-389"><a href="#LazyMTS.fit-389"><span class="linenos">389</span></a>                        <span class="n">WINKLERSCORE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">winklerscore</span><span class="p">)</span>
</span><span id="LazyMTS.fit-390"><a href="#LazyMTS.fit-390"><span class="linenos">390</span></a>                        <span class="n">COVERAGE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coveragecalc</span><span class="p">)</span>
</span><span id="LazyMTS.fit-391"><a href="#LazyMTS.fit-391"><span class="linenos">391</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyMTS.fit-392"><a href="#LazyMTS.fit-392"><span class="linenos">392</span></a>
</span><span id="LazyMTS.fit-393"><a href="#LazyMTS.fit-393"><span class="linenos">393</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS.fit-394"><a href="#LazyMTS.fit-394"><span class="linenos">394</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS.fit-395"><a href="#LazyMTS.fit-395"><span class="linenos">395</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyMTS.fit-396"><a href="#LazyMTS.fit-396"><span class="linenos">396</span></a>
</span><span id="LazyMTS.fit-397"><a href="#LazyMTS.fit-397"><span class="linenos">397</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyMTS.fit-398"><a href="#LazyMTS.fit-398"><span class="linenos">398</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyMTS.fit-399"><a href="#LazyMTS.fit-399"><span class="linenos">399</span></a>                            <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS.fit-400"><a href="#LazyMTS.fit-400"><span class="linenos">400</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyMTS.fit-401"><a href="#LazyMTS.fit-401"><span class="linenos">401</span></a>                                <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyMTS.fit-402"><a href="#LazyMTS.fit-402"><span class="linenos">402</span></a>                                <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyMTS.fit-403"><a href="#LazyMTS.fit-403"><span class="linenos">403</span></a>                                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyMTS.fit-404"><a href="#LazyMTS.fit-404"><span class="linenos">404</span></a>                                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyMTS.fit-405"><a href="#LazyMTS.fit-405"><span class="linenos">405</span></a>                                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyMTS.fit-406"><a href="#LazyMTS.fit-406"><span class="linenos">406</span></a>                                <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyMTS.fit-407"><a href="#LazyMTS.fit-407"><span class="linenos">407</span></a>                                <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyMTS.fit-408"><a href="#LazyMTS.fit-408"><span class="linenos">408</span></a>                                <span class="s2">&quot;WINKLERSCORE&quot;</span><span class="p">:</span> <span class="n">winklerscore</span><span class="p">,</span>
</span><span id="LazyMTS.fit-409"><a href="#LazyMTS.fit-409"><span class="linenos">409</span></a>                                <span class="s2">&quot;COVERAGE&quot;</span><span class="p">:</span> <span class="n">coveragecalc</span><span class="p">,</span>
</span><span id="LazyMTS.fit-410"><a href="#LazyMTS.fit-410"><span class="linenos">410</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyMTS.fit-411"><a href="#LazyMTS.fit-411"><span class="linenos">411</span></a>                            <span class="p">}</span>
</span><span id="LazyMTS.fit-412"><a href="#LazyMTS.fit-412"><span class="linenos">412</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS.fit-413"><a href="#LazyMTS.fit-413"><span class="linenos">413</span></a>                            <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS.fit-414"><a href="#LazyMTS.fit-414"><span class="linenos">414</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyMTS.fit-415"><a href="#LazyMTS.fit-415"><span class="linenos">415</span></a>                                <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyMTS.fit-416"><a href="#LazyMTS.fit-416"><span class="linenos">416</span></a>                                <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyMTS.fit-417"><a href="#LazyMTS.fit-417"><span class="linenos">417</span></a>                                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyMTS.fit-418"><a href="#LazyMTS.fit-418"><span class="linenos">418</span></a>                                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyMTS.fit-419"><a href="#LazyMTS.fit-419"><span class="linenos">419</span></a>                                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyMTS.fit-420"><a href="#LazyMTS.fit-420"><span class="linenos">420</span></a>                                <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyMTS.fit-421"><a href="#LazyMTS.fit-421"><span class="linenos">421</span></a>                                <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyMTS.fit-422"><a href="#LazyMTS.fit-422"><span class="linenos">422</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyMTS.fit-423"><a href="#LazyMTS.fit-423"><span class="linenos">423</span></a>                            <span class="p">}</span>
</span><span id="LazyMTS.fit-424"><a href="#LazyMTS.fit-424"><span class="linenos">424</span></a>
</span><span id="LazyMTS.fit-425"><a href="#LazyMTS.fit-425"><span class="linenos">425</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS.fit-426"><a href="#LazyMTS.fit-426"><span class="linenos">426</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyMTS.fit-427"><a href="#LazyMTS.fit-427"><span class="linenos">427</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyMTS.fit-428"><a href="#LazyMTS.fit-428"><span class="linenos">428</span></a>                            <span class="p">)</span>
</span><span id="LazyMTS.fit-429"><a href="#LazyMTS.fit-429"><span class="linenos">429</span></a>
</span><span id="LazyMTS.fit-430"><a href="#LazyMTS.fit-430"><span class="linenos">430</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyMTS.fit-431"><a href="#LazyMTS.fit-431"><span class="linenos">431</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyMTS.fit-432"><a href="#LazyMTS.fit-432"><span class="linenos">432</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_pred</span>
</span><span id="LazyMTS.fit-433"><a href="#LazyMTS.fit-433"><span class="linenos">433</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyMTS.fit-434"><a href="#LazyMTS.fit-434"><span class="linenos">434</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyMTS.fit-435"><a href="#LazyMTS.fit-435"><span class="linenos">435</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyMTS.fit-436"><a href="#LazyMTS.fit-436"><span class="linenos">436</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyMTS.fit-437"><a href="#LazyMTS.fit-437"><span class="linenos">437</span></a>
</span><span id="LazyMTS.fit-438"><a href="#LazyMTS.fit-438"><span class="linenos">438</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># no preprocessing</span>
</span><span id="LazyMTS.fit-439"><a href="#LazyMTS.fit-439"><span class="linenos">439</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyMTS.fit-440"><a href="#LazyMTS.fit-440"><span class="linenos">440</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyMTS.fit-441"><a href="#LazyMTS.fit-441"><span class="linenos">441</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyMTS.fit-442"><a href="#LazyMTS.fit-442"><span class="linenos">442</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyMTS.fit-443"><a href="#LazyMTS.fit-443"><span class="linenos">443</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">MTS</span><span class="p">(</span>
</span><span id="LazyMTS.fit-444"><a href="#LazyMTS.fit-444"><span class="linenos">444</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyMTS.fit-445"><a href="#LazyMTS.fit-445"><span class="linenos">445</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS.fit-446"><a href="#LazyMTS.fit-446"><span class="linenos">446</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS.fit-447"><a href="#LazyMTS.fit-447"><span class="linenos">447</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS.fit-448"><a href="#LazyMTS.fit-448"><span class="linenos">448</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS.fit-449"><a href="#LazyMTS.fit-449"><span class="linenos">449</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS.fit-450"><a href="#LazyMTS.fit-450"><span class="linenos">450</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS.fit-451"><a href="#LazyMTS.fit-451"><span class="linenos">451</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS.fit-452"><a href="#LazyMTS.fit-452"><span class="linenos">452</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS.fit-453"><a href="#LazyMTS.fit-453"><span class="linenos">453</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS.fit-454"><a href="#LazyMTS.fit-454"><span class="linenos">454</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS.fit-455"><a href="#LazyMTS.fit-455"><span class="linenos">455</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS.fit-456"><a href="#LazyMTS.fit-456"><span class="linenos">456</span></a>                            <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS.fit-457"><a href="#LazyMTS.fit-457"><span class="linenos">457</span></a>                            <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS.fit-458"><a href="#LazyMTS.fit-458"><span class="linenos">458</span></a>                            <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS.fit-459"><a href="#LazyMTS.fit-459"><span class="linenos">459</span></a>                            <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS.fit-460"><a href="#LazyMTS.fit-460"><span class="linenos">460</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS.fit-461"><a href="#LazyMTS.fit-461"><span class="linenos">461</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS.fit-462"><a href="#LazyMTS.fit-462"><span class="linenos">462</span></a>                            <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS.fit-463"><a href="#LazyMTS.fit-463"><span class="linenos">463</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS.fit-464"><a href="#LazyMTS.fit-464"><span class="linenos">464</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS.fit-465"><a href="#LazyMTS.fit-465"><span class="linenos">465</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">MTS</span><span class="p">(</span>
</span><span id="LazyMTS.fit-466"><a href="#LazyMTS.fit-466"><span class="linenos">466</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyMTS.fit-467"><a href="#LazyMTS.fit-467"><span class="linenos">467</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS.fit-468"><a href="#LazyMTS.fit-468"><span class="linenos">468</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS.fit-469"><a href="#LazyMTS.fit-469"><span class="linenos">469</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS.fit-470"><a href="#LazyMTS.fit-470"><span class="linenos">470</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS.fit-471"><a href="#LazyMTS.fit-471"><span class="linenos">471</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS.fit-472"><a href="#LazyMTS.fit-472"><span class="linenos">472</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS.fit-473"><a href="#LazyMTS.fit-473"><span class="linenos">473</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS.fit-474"><a href="#LazyMTS.fit-474"><span class="linenos">474</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS.fit-475"><a href="#LazyMTS.fit-475"><span class="linenos">475</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS.fit-476"><a href="#LazyMTS.fit-476"><span class="linenos">476</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS.fit-477"><a href="#LazyMTS.fit-477"><span class="linenos">477</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS.fit-478"><a href="#LazyMTS.fit-478"><span class="linenos">478</span></a>                            <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS.fit-479"><a href="#LazyMTS.fit-479"><span class="linenos">479</span></a>                            <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS.fit-480"><a href="#LazyMTS.fit-480"><span class="linenos">480</span></a>                            <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS.fit-481"><a href="#LazyMTS.fit-481"><span class="linenos">481</span></a>                            <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS.fit-482"><a href="#LazyMTS.fit-482"><span class="linenos">482</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS.fit-483"><a href="#LazyMTS.fit-483"><span class="linenos">483</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS.fit-484"><a href="#LazyMTS.fit-484"><span class="linenos">484</span></a>                            <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS.fit-485"><a href="#LazyMTS.fit-485"><span class="linenos">485</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS.fit-486"><a href="#LazyMTS.fit-486"><span class="linenos">486</span></a>
</span><span id="LazyMTS.fit-487"><a href="#LazyMTS.fit-487"><span class="linenos">487</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">xreg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="LazyMTS.fit-488"><a href="#LazyMTS.fit-488"><span class="linenos">488</span></a>                    <span class="c1"># pipe.fit(X_train, xreg=xreg) # DO xreg like in `ahead`</span>
</span><span id="LazyMTS.fit-489"><a href="#LazyMTS.fit-489"><span class="linenos">489</span></a>
</span><span id="LazyMTS.fit-490"><a href="#LazyMTS.fit-490"><span class="linenos">490</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyMTS.fit-491"><a href="#LazyMTS.fit-491"><span class="linenos">491</span></a>
</span><span id="LazyMTS.fit-492"><a href="#LazyMTS.fit-492"><span class="linenos">492</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyMTS.fit-493"><a href="#LazyMTS.fit-493"><span class="linenos">493</span></a>                        <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">[</span><span class="s2">&quot;regressor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyMTS.fit-494"><a href="#LazyMTS.fit-494"><span class="linenos">494</span></a>                            <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyMTS.fit-495"><a href="#LazyMTS.fit-495"><span class="linenos">495</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS.fit-496"><a href="#LazyMTS.fit-496"><span class="linenos">496</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS.fit-497"><a href="#LazyMTS.fit-497"><span class="linenos">497</span></a>                        <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyMTS.fit-498"><a href="#LazyMTS.fit-498"><span class="linenos">498</span></a>                            <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyMTS.fit-499"><a href="#LazyMTS.fit-499"><span class="linenos">499</span></a>                        <span class="p">)</span>  <span class="c1"># X_pred = pipe.predict(h=X_test.shape[0], new_xreg=new_xreg) ## DO xreg like in `ahead`</span>
</span><span id="LazyMTS.fit-500"><a href="#LazyMTS.fit-500"><span class="linenos">500</span></a>
</span><span id="LazyMTS.fit-501"><a href="#LazyMTS.fit-501"><span class="linenos">501</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyMTS.fit-502"><a href="#LazyMTS.fit-502"><span class="linenos">502</span></a>                        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span>
</span><span id="LazyMTS.fit-503"><a href="#LazyMTS.fit-503"><span class="linenos">503</span></a>                            <span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span>
</span><span id="LazyMTS.fit-504"><a href="#LazyMTS.fit-504"><span class="linenos">504</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS.fit-505"><a href="#LazyMTS.fit-505"><span class="linenos">505</span></a>                        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span><span id="LazyMTS.fit-506"><a href="#LazyMTS.fit-506"><span class="linenos">506</span></a>                        <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span><span id="LazyMTS.fit-507"><a href="#LazyMTS.fit-507"><span class="linenos">507</span></a>                        <span class="n">winklerscore</span> <span class="o">=</span> <span class="n">winkler_score</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
</span><span id="LazyMTS.fit-508"><a href="#LazyMTS.fit-508"><span class="linenos">508</span></a>                        <span class="n">coveragecalc</span> <span class="o">=</span> <span class="n">coverage</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
</span><span id="LazyMTS.fit-509"><a href="#LazyMTS.fit-509"><span class="linenos">509</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS.fit-510"><a href="#LazyMTS.fit-510"><span class="linenos">510</span></a>                        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyMTS.fit-511"><a href="#LazyMTS.fit-511"><span class="linenos">511</span></a>                        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS.fit-512"><a href="#LazyMTS.fit-512"><span class="linenos">512</span></a>                        <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS.fit-513"><a href="#LazyMTS.fit-513"><span class="linenos">513</span></a>
</span><span id="LazyMTS.fit-514"><a href="#LazyMTS.fit-514"><span class="linenos">514</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyMTS.fit-515"><a href="#LazyMTS.fit-515"><span class="linenos">515</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyMTS.fit-516"><a href="#LazyMTS.fit-516"><span class="linenos">516</span></a>                    <span class="n">MAE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</span><span id="LazyMTS.fit-517"><a href="#LazyMTS.fit-517"><span class="linenos">517</span></a>                    <span class="n">MPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpl</span><span class="p">)</span>
</span><span id="LazyMTS.fit-518"><a href="#LazyMTS.fit-518"><span class="linenos">518</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyMTS.fit-519"><a href="#LazyMTS.fit-519"><span class="linenos">519</span></a>                        <span class="n">WINKLERSCORE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">winklerscore</span><span class="p">)</span>
</span><span id="LazyMTS.fit-520"><a href="#LazyMTS.fit-520"><span class="linenos">520</span></a>                        <span class="n">COVERAGE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coveragecalc</span><span class="p">)</span>
</span><span id="LazyMTS.fit-521"><a href="#LazyMTS.fit-521"><span class="linenos">521</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyMTS.fit-522"><a href="#LazyMTS.fit-522"><span class="linenos">522</span></a>
</span><span id="LazyMTS.fit-523"><a href="#LazyMTS.fit-523"><span class="linenos">523</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS.fit-524"><a href="#LazyMTS.fit-524"><span class="linenos">524</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS.fit-525"><a href="#LazyMTS.fit-525"><span class="linenos">525</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyMTS.fit-526"><a href="#LazyMTS.fit-526"><span class="linenos">526</span></a>
</span><span id="LazyMTS.fit-527"><a href="#LazyMTS.fit-527"><span class="linenos">527</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyMTS.fit-528"><a href="#LazyMTS.fit-528"><span class="linenos">528</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyMTS.fit-529"><a href="#LazyMTS.fit-529"><span class="linenos">529</span></a>                            <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS.fit-530"><a href="#LazyMTS.fit-530"><span class="linenos">530</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyMTS.fit-531"><a href="#LazyMTS.fit-531"><span class="linenos">531</span></a>                                <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyMTS.fit-532"><a href="#LazyMTS.fit-532"><span class="linenos">532</span></a>                                <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyMTS.fit-533"><a href="#LazyMTS.fit-533"><span class="linenos">533</span></a>                                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyMTS.fit-534"><a href="#LazyMTS.fit-534"><span class="linenos">534</span></a>                                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyMTS.fit-535"><a href="#LazyMTS.fit-535"><span class="linenos">535</span></a>                                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyMTS.fit-536"><a href="#LazyMTS.fit-536"><span class="linenos">536</span></a>                                <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyMTS.fit-537"><a href="#LazyMTS.fit-537"><span class="linenos">537</span></a>                                <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyMTS.fit-538"><a href="#LazyMTS.fit-538"><span class="linenos">538</span></a>                                <span class="s2">&quot;WINKLERSCORE&quot;</span><span class="p">:</span> <span class="n">winklerscore</span><span class="p">,</span>
</span><span id="LazyMTS.fit-539"><a href="#LazyMTS.fit-539"><span class="linenos">539</span></a>                                <span class="s2">&quot;COVERAGE&quot;</span><span class="p">:</span> <span class="n">coveragecalc</span><span class="p">,</span>
</span><span id="LazyMTS.fit-540"><a href="#LazyMTS.fit-540"><span class="linenos">540</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyMTS.fit-541"><a href="#LazyMTS.fit-541"><span class="linenos">541</span></a>                            <span class="p">}</span>
</span><span id="LazyMTS.fit-542"><a href="#LazyMTS.fit-542"><span class="linenos">542</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS.fit-543"><a href="#LazyMTS.fit-543"><span class="linenos">543</span></a>                            <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS.fit-544"><a href="#LazyMTS.fit-544"><span class="linenos">544</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyMTS.fit-545"><a href="#LazyMTS.fit-545"><span class="linenos">545</span></a>                                <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyMTS.fit-546"><a href="#LazyMTS.fit-546"><span class="linenos">546</span></a>                                <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyMTS.fit-547"><a href="#LazyMTS.fit-547"><span class="linenos">547</span></a>                                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyMTS.fit-548"><a href="#LazyMTS.fit-548"><span class="linenos">548</span></a>                                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyMTS.fit-549"><a href="#LazyMTS.fit-549"><span class="linenos">549</span></a>                                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyMTS.fit-550"><a href="#LazyMTS.fit-550"><span class="linenos">550</span></a>                                <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyMTS.fit-551"><a href="#LazyMTS.fit-551"><span class="linenos">551</span></a>                                <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyMTS.fit-552"><a href="#LazyMTS.fit-552"><span class="linenos">552</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyMTS.fit-553"><a href="#LazyMTS.fit-553"><span class="linenos">553</span></a>                            <span class="p">}</span>
</span><span id="LazyMTS.fit-554"><a href="#LazyMTS.fit-554"><span class="linenos">554</span></a>
</span><span id="LazyMTS.fit-555"><a href="#LazyMTS.fit-555"><span class="linenos">555</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS.fit-556"><a href="#LazyMTS.fit-556"><span class="linenos">556</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyMTS.fit-557"><a href="#LazyMTS.fit-557"><span class="linenos">557</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyMTS.fit-558"><a href="#LazyMTS.fit-558"><span class="linenos">558</span></a>                            <span class="p">)</span>
</span><span id="LazyMTS.fit-559"><a href="#LazyMTS.fit-559"><span class="linenos">559</span></a>
</span><span id="LazyMTS.fit-560"><a href="#LazyMTS.fit-560"><span class="linenos">560</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyMTS.fit-561"><a href="#LazyMTS.fit-561"><span class="linenos">561</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyMTS.fit-562"><a href="#LazyMTS.fit-562"><span class="linenos">562</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_pred</span>
</span><span id="LazyMTS.fit-563"><a href="#LazyMTS.fit-563"><span class="linenos">563</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyMTS.fit-564"><a href="#LazyMTS.fit-564"><span class="linenos">564</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyMTS.fit-565"><a href="#LazyMTS.fit-565"><span class="linenos">565</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyMTS.fit-566"><a href="#LazyMTS.fit-566"><span class="linenos">566</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyMTS.fit-567"><a href="#LazyMTS.fit-567"><span class="linenos">567</span></a>
</span><span id="LazyMTS.fit-568"><a href="#LazyMTS.fit-568"><span class="linenos">568</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyMTS.fit-569"><a href="#LazyMTS.fit-569"><span class="linenos">569</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS.fit-570"><a href="#LazyMTS.fit-570"><span class="linenos">570</span></a>                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyMTS.fit-571"><a href="#LazyMTS.fit-571"><span class="linenos">571</span></a>                <span class="c1"># &quot;Adjusted R-Squared&quot;: ADJR2,</span>
</span><span id="LazyMTS.fit-572"><a href="#LazyMTS.fit-572"><span class="linenos">572</span></a>                <span class="c1"># &quot;R-Squared&quot;: R2,</span>
</span><span id="LazyMTS.fit-573"><a href="#LazyMTS.fit-573"><span class="linenos">573</span></a>                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyMTS.fit-574"><a href="#LazyMTS.fit-574"><span class="linenos">574</span></a>                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">MAE</span><span class="p">,</span>
</span><span id="LazyMTS.fit-575"><a href="#LazyMTS.fit-575"><span class="linenos">575</span></a>                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">MPL</span><span class="p">,</span>
</span><span id="LazyMTS.fit-576"><a href="#LazyMTS.fit-576"><span class="linenos">576</span></a>                <span class="c1"># &quot;MPE&quot;: MPE,</span>
</span><span id="LazyMTS.fit-577"><a href="#LazyMTS.fit-577"><span class="linenos">577</span></a>                <span class="c1"># &quot;MAPE&quot;: MAPE,</span>
</span><span id="LazyMTS.fit-578"><a href="#LazyMTS.fit-578"><span class="linenos">578</span></a>                <span class="s2">&quot;WINKLERSCORE&quot;</span><span class="p">:</span> <span class="n">WINKLERSCORE</span><span class="p">,</span>
</span><span id="LazyMTS.fit-579"><a href="#LazyMTS.fit-579"><span class="linenos">579</span></a>                <span class="s2">&quot;COVERAGE&quot;</span><span class="p">:</span> <span class="n">COVERAGE</span><span class="p">,</span>
</span><span id="LazyMTS.fit-580"><a href="#LazyMTS.fit-580"><span class="linenos">580</span></a>                <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyMTS.fit-581"><a href="#LazyMTS.fit-581"><span class="linenos">581</span></a>            <span class="p">}</span>
</span><span id="LazyMTS.fit-582"><a href="#LazyMTS.fit-582"><span class="linenos">582</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS.fit-583"><a href="#LazyMTS.fit-583"><span class="linenos">583</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS.fit-584"><a href="#LazyMTS.fit-584"><span class="linenos">584</span></a>                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyMTS.fit-585"><a href="#LazyMTS.fit-585"><span class="linenos">585</span></a>                <span class="c1"># &quot;Adjusted R-Squared&quot;: ADJR2,</span>
</span><span id="LazyMTS.fit-586"><a href="#LazyMTS.fit-586"><span class="linenos">586</span></a>                <span class="c1"># &quot;R-Squared&quot;: R2,</span>
</span><span id="LazyMTS.fit-587"><a href="#LazyMTS.fit-587"><span class="linenos">587</span></a>                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyMTS.fit-588"><a href="#LazyMTS.fit-588"><span class="linenos">588</span></a>                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">MAE</span><span class="p">,</span>
</span><span id="LazyMTS.fit-589"><a href="#LazyMTS.fit-589"><span class="linenos">589</span></a>                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">MPL</span><span class="p">,</span>
</span><span id="LazyMTS.fit-590"><a href="#LazyMTS.fit-590"><span class="linenos">590</span></a>                <span class="c1"># &quot;MPE&quot;: MPE,</span>
</span><span id="LazyMTS.fit-591"><a href="#LazyMTS.fit-591"><span class="linenos">591</span></a>                <span class="c1"># &quot;MAPE&quot;: MAPE,</span>
</span><span id="LazyMTS.fit-592"><a href="#LazyMTS.fit-592"><span class="linenos">592</span></a>                <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyMTS.fit-593"><a href="#LazyMTS.fit-593"><span class="linenos">593</span></a>            <span class="p">}</span>
</span><span id="LazyMTS.fit-594"><a href="#LazyMTS.fit-594"><span class="linenos">594</span></a>
</span><span id="LazyMTS.fit-595"><a href="#LazyMTS.fit-595"><span class="linenos">595</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS.fit-596"><a href="#LazyMTS.fit-596"><span class="linenos">596</span></a>            <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">CUSTOM_METRIC</span>
</span><span id="LazyMTS.fit-597"><a href="#LazyMTS.fit-597"><span class="linenos">597</span></a>
</span><span id="LazyMTS.fit-598"><a href="#LazyMTS.fit-598"><span class="linenos">598</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LazyMTS.fit-599"><a href="#LazyMTS.fit-599"><span class="linenos">599</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyMTS.fit-600"><a href="#LazyMTS.fit-600"><span class="linenos">600</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyMTS.fit-601"><a href="#LazyMTS.fit-601"><span class="linenos">601</span></a>        <span class="p">)</span>
</span><span id="LazyMTS.fit-602"><a href="#LazyMTS.fit-602"><span class="linenos">602</span></a>
</span><span id="LazyMTS.fit-603"><a href="#LazyMTS.fit-603"><span class="linenos">603</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyMTS.fit-604"><a href="#LazyMTS.fit-604"><span class="linenos">604</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyMTS.fit-605"><a href="#LazyMTS.fit-605"><span class="linenos">605</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span></pre></div>


            <div class="docstring"><p>Fit Regression algorithms to X_train, predict and score on X_test.</p>

<p>Parameters:</p>

<pre><code>X_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.

xreg: array-like, optional (default=None)
    Additional (external) regressors to be passed to self.obj
    xreg must be in 'increasing' order (most recent observations last)
</code></pre>

<p>Returns:</p>

<pre><code>scores: Pandas DataFrame
    Returns metrics of all the models in a Pandas DataFrame.

predictions: Pandas DataFrame
    Returns predictions of all the models in a Pandas DataFrame.
</code></pre>
</div>


                                </div>
                                <div id="LazyMTS.provide_models" class="classattr">
                                            <input id="LazyMTS.provide_models-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">provide_models</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyMTS.provide_models-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyMTS.provide_models"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyMTS.provide_models-607"><a href="#LazyMTS.provide_models-607"><span class="linenos">607</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">):</span>
</span><span id="LazyMTS.provide_models-608"><a href="#LazyMTS.provide_models-608"><span class="linenos">608</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyMTS.provide_models-609"><a href="#LazyMTS.provide_models-609"><span class="linenos">609</span></a><span class="sd">        This function returns all the model objects trained in fit function.</span>
</span><span id="LazyMTS.provide_models-610"><a href="#LazyMTS.provide_models-610"><span class="linenos">610</span></a><span class="sd">        If fit is not called already, then we call fit and then return the models.</span>
</span><span id="LazyMTS.provide_models-611"><a href="#LazyMTS.provide_models-611"><span class="linenos">611</span></a>
</span><span id="LazyMTS.provide_models-612"><a href="#LazyMTS.provide_models-612"><span class="linenos">612</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyMTS.provide_models-613"><a href="#LazyMTS.provide_models-613"><span class="linenos">613</span></a>
</span><span id="LazyMTS.provide_models-614"><a href="#LazyMTS.provide_models-614"><span class="linenos">614</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyMTS.provide_models-615"><a href="#LazyMTS.provide_models-615"><span class="linenos">615</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyMTS.provide_models-616"><a href="#LazyMTS.provide_models-616"><span class="linenos">616</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyMTS.provide_models-617"><a href="#LazyMTS.provide_models-617"><span class="linenos">617</span></a>
</span><span id="LazyMTS.provide_models-618"><a href="#LazyMTS.provide_models-618"><span class="linenos">618</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyMTS.provide_models-619"><a href="#LazyMTS.provide_models-619"><span class="linenos">619</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyMTS.provide_models-620"><a href="#LazyMTS.provide_models-620"><span class="linenos">620</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyMTS.provide_models-621"><a href="#LazyMTS.provide_models-621"><span class="linenos">621</span></a>
</span><span id="LazyMTS.provide_models-622"><a href="#LazyMTS.provide_models-622"><span class="linenos">622</span></a><span class="sd">        Returns:</span>
</span><span id="LazyMTS.provide_models-623"><a href="#LazyMTS.provide_models-623"><span class="linenos">623</span></a>
</span><span id="LazyMTS.provide_models-624"><a href="#LazyMTS.provide_models-624"><span class="linenos">624</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyMTS.provide_models-625"><a href="#LazyMTS.provide_models-625"><span class="linenos">625</span></a><span class="sd">                Returns a dictionary with each model pipeline as value</span>
</span><span id="LazyMTS.provide_models-626"><a href="#LazyMTS.provide_models-626"><span class="linenos">626</span></a><span class="sd">                with key as name of models.</span>
</span><span id="LazyMTS.provide_models-627"><a href="#LazyMTS.provide_models-627"><span class="linenos">627</span></a>
</span><span id="LazyMTS.provide_models-628"><a href="#LazyMTS.provide_models-628"><span class="linenos">628</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyMTS.provide_models-629"><a href="#LazyMTS.provide_models-629"><span class="linenos">629</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyMTS.provide_models-630"><a href="#LazyMTS.provide_models-630"><span class="linenos">630</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyMTS.provide_models-631"><a href="#LazyMTS.provide_models-631"><span class="linenos">631</span></a>
</span><span id="LazyMTS.provide_models-632"><a href="#LazyMTS.provide_models-632"><span class="linenos">632</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>This function returns all the model objects trained in fit function.
If fit is not called already, then we call fit and then return the models.</p>

<p>Parameters:</p>

<pre><code>X_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.
</code></pre>

<p>Returns:</p>

<pre><code>models: dict-object,
    Returns a dictionary with each model pipeline as value
    with key as name of models.
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="LazyDeepClassifier">
                            <input id="LazyDeepClassifier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LazyDeepClassifier</span><wbr>(<span class="base">nnetsauce.custom.custom.Custom</span>, <span class="base">sklearn.base.ClassifierMixin</span>):

                <label class="view-source-button" for="LazyDeepClassifier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepClassifier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepClassifier-84"><a href="#LazyDeepClassifier-84"><span class="linenos"> 84</span></a><span class="k">class</span> <span class="nc">LazyDeepClassifier</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">):</span>
</span><span id="LazyDeepClassifier-85"><a href="#LazyDeepClassifier-85"><span class="linenos"> 85</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyDeepClassifier-86"><a href="#LazyDeepClassifier-86"><span class="linenos"> 86</span></a>
</span><span id="LazyDeepClassifier-87"><a href="#LazyDeepClassifier-87"><span class="linenos"> 87</span></a><span class="sd">    Fitting -- almost -- all the classification algorithms with layers of</span>
</span><span id="LazyDeepClassifier-88"><a href="#LazyDeepClassifier-88"><span class="linenos"> 88</span></a><span class="sd">    nnetsauce&#39;s CustomClassifier and returning their scores.</span>
</span><span id="LazyDeepClassifier-89"><a href="#LazyDeepClassifier-89"><span class="linenos"> 89</span></a>
</span><span id="LazyDeepClassifier-90"><a href="#LazyDeepClassifier-90"><span class="linenos"> 90</span></a><span class="sd">    Parameters:</span>
</span><span id="LazyDeepClassifier-91"><a href="#LazyDeepClassifier-91"><span class="linenos"> 91</span></a>
</span><span id="LazyDeepClassifier-92"><a href="#LazyDeepClassifier-92"><span class="linenos"> 92</span></a><span class="sd">        verbose: int, optional (default=0)</span>
</span><span id="LazyDeepClassifier-93"><a href="#LazyDeepClassifier-93"><span class="linenos"> 93</span></a><span class="sd">            Any positive number for verbosity.</span>
</span><span id="LazyDeepClassifier-94"><a href="#LazyDeepClassifier-94"><span class="linenos"> 94</span></a>
</span><span id="LazyDeepClassifier-95"><a href="#LazyDeepClassifier-95"><span class="linenos"> 95</span></a><span class="sd">        ignore_warnings: bool, optional (default=True)</span>
</span><span id="LazyDeepClassifier-96"><a href="#LazyDeepClassifier-96"><span class="linenos"> 96</span></a><span class="sd">            When set to True, the warning related to algorigms that are not</span>
</span><span id="LazyDeepClassifier-97"><a href="#LazyDeepClassifier-97"><span class="linenos"> 97</span></a><span class="sd">            able to run are ignored.</span>
</span><span id="LazyDeepClassifier-98"><a href="#LazyDeepClassifier-98"><span class="linenos"> 98</span></a>
</span><span id="LazyDeepClassifier-99"><a href="#LazyDeepClassifier-99"><span class="linenos"> 99</span></a><span class="sd">        custom_metric: function, optional (default=None)</span>
</span><span id="LazyDeepClassifier-100"><a href="#LazyDeepClassifier-100"><span class="linenos">100</span></a><span class="sd">            When function is provided, models are evaluated based on the custom</span>
</span><span id="LazyDeepClassifier-101"><a href="#LazyDeepClassifier-101"><span class="linenos">101</span></a><span class="sd">              evaluation metric provided.</span>
</span><span id="LazyDeepClassifier-102"><a href="#LazyDeepClassifier-102"><span class="linenos">102</span></a>
</span><span id="LazyDeepClassifier-103"><a href="#LazyDeepClassifier-103"><span class="linenos">103</span></a><span class="sd">        predictions: bool, optional (default=False)</span>
</span><span id="LazyDeepClassifier-104"><a href="#LazyDeepClassifier-104"><span class="linenos">104</span></a><span class="sd">            When set to True, the predictions of all the models models are</span>
</span><span id="LazyDeepClassifier-105"><a href="#LazyDeepClassifier-105"><span class="linenos">105</span></a><span class="sd">            returned as data frame.</span>
</span><span id="LazyDeepClassifier-106"><a href="#LazyDeepClassifier-106"><span class="linenos">106</span></a>
</span><span id="LazyDeepClassifier-107"><a href="#LazyDeepClassifier-107"><span class="linenos">107</span></a><span class="sd">        sort_by: string, optional (default=&#39;Accuracy&#39;)</span>
</span><span id="LazyDeepClassifier-108"><a href="#LazyDeepClassifier-108"><span class="linenos">108</span></a><span class="sd">            Sort models by a metric. Available options are &#39;Accuracy&#39;,</span>
</span><span id="LazyDeepClassifier-109"><a href="#LazyDeepClassifier-109"><span class="linenos">109</span></a><span class="sd">            &#39;Balanced Accuracy&#39;, &#39;ROC AUC&#39;, &#39;F1 Score&#39; or a custom metric</span>
</span><span id="LazyDeepClassifier-110"><a href="#LazyDeepClassifier-110"><span class="linenos">110</span></a><span class="sd">            identified by its name and provided by custom_metric.</span>
</span><span id="LazyDeepClassifier-111"><a href="#LazyDeepClassifier-111"><span class="linenos">111</span></a>
</span><span id="LazyDeepClassifier-112"><a href="#LazyDeepClassifier-112"><span class="linenos">112</span></a><span class="sd">        random_state: int, optional (default=42)</span>
</span><span id="LazyDeepClassifier-113"><a href="#LazyDeepClassifier-113"><span class="linenos">113</span></a><span class="sd">            Reproducibiility seed.</span>
</span><span id="LazyDeepClassifier-114"><a href="#LazyDeepClassifier-114"><span class="linenos">114</span></a>
</span><span id="LazyDeepClassifier-115"><a href="#LazyDeepClassifier-115"><span class="linenos">115</span></a><span class="sd">        estimators: list, optional (default=&#39;all&#39;)</span>
</span><span id="LazyDeepClassifier-116"><a href="#LazyDeepClassifier-116"><span class="linenos">116</span></a><span class="sd">            list of Estimators names or just &#39;all&#39; for &gt; 90 classifiers</span>
</span><span id="LazyDeepClassifier-117"><a href="#LazyDeepClassifier-117"><span class="linenos">117</span></a><span class="sd">            (default=&#39;all&#39;)</span>
</span><span id="LazyDeepClassifier-118"><a href="#LazyDeepClassifier-118"><span class="linenos">118</span></a>
</span><span id="LazyDeepClassifier-119"><a href="#LazyDeepClassifier-119"><span class="linenos">119</span></a><span class="sd">        preprocess: bool, preprocessing is done when set to True</span>
</span><span id="LazyDeepClassifier-120"><a href="#LazyDeepClassifier-120"><span class="linenos">120</span></a>
</span><span id="LazyDeepClassifier-121"><a href="#LazyDeepClassifier-121"><span class="linenos">121</span></a><span class="sd">        n_jobs: int, when possible, run in parallel</span>
</span><span id="LazyDeepClassifier-122"><a href="#LazyDeepClassifier-122"><span class="linenos">122</span></a><span class="sd">            For now, only used by individual models that support it.</span>
</span><span id="LazyDeepClassifier-123"><a href="#LazyDeepClassifier-123"><span class="linenos">123</span></a>
</span><span id="LazyDeepClassifier-124"><a href="#LazyDeepClassifier-124"><span class="linenos">124</span></a><span class="sd">        n_layers: int, optional (default=3)</span>
</span><span id="LazyDeepClassifier-125"><a href="#LazyDeepClassifier-125"><span class="linenos">125</span></a><span class="sd">            Number of layers of CustomClassifiers to be used.</span>
</span><span id="LazyDeepClassifier-126"><a href="#LazyDeepClassifier-126"><span class="linenos">126</span></a>
</span><span id="LazyDeepClassifier-127"><a href="#LazyDeepClassifier-127"><span class="linenos">127</span></a><span class="sd">        All the other parameters are the same as CustomClassifier&#39;s.</span>
</span><span id="LazyDeepClassifier-128"><a href="#LazyDeepClassifier-128"><span class="linenos">128</span></a>
</span><span id="LazyDeepClassifier-129"><a href="#LazyDeepClassifier-129"><span class="linenos">129</span></a>
</span><span id="LazyDeepClassifier-130"><a href="#LazyDeepClassifier-130"><span class="linenos">130</span></a><span class="sd">    Examples</span>
</span><span id="LazyDeepClassifier-131"><a href="#LazyDeepClassifier-131"><span class="linenos">131</span></a>
</span><span id="LazyDeepClassifier-132"><a href="#LazyDeepClassifier-132"><span class="linenos">132</span></a><span class="sd">        ```python</span>
</span><span id="LazyDeepClassifier-133"><a href="#LazyDeepClassifier-133"><span class="linenos">133</span></a><span class="sd">        import nnetsauce as ns</span>
</span><span id="LazyDeepClassifier-134"><a href="#LazyDeepClassifier-134"><span class="linenos">134</span></a><span class="sd">        from sklearn.datasets import load_breast_cancer</span>
</span><span id="LazyDeepClassifier-135"><a href="#LazyDeepClassifier-135"><span class="linenos">135</span></a><span class="sd">        from sklearn.model_selection import train_test_split</span>
</span><span id="LazyDeepClassifier-136"><a href="#LazyDeepClassifier-136"><span class="linenos">136</span></a><span class="sd">        data = load_breast_cancer()</span>
</span><span id="LazyDeepClassifier-137"><a href="#LazyDeepClassifier-137"><span class="linenos">137</span></a><span class="sd">        X = data.data</span>
</span><span id="LazyDeepClassifier-138"><a href="#LazyDeepClassifier-138"><span class="linenos">138</span></a><span class="sd">        y= data.target</span>
</span><span id="LazyDeepClassifier-139"><a href="#LazyDeepClassifier-139"><span class="linenos">139</span></a><span class="sd">        X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=.2,</span>
</span><span id="LazyDeepClassifier-140"><a href="#LazyDeepClassifier-140"><span class="linenos">140</span></a><span class="sd">            random_state=123)</span>
</span><span id="LazyDeepClassifier-141"><a href="#LazyDeepClassifier-141"><span class="linenos">141</span></a><span class="sd">        clf = ns.LazyDeepClassifier(verbose=0, ignore_warnings=True, custom_metric=None)</span>
</span><span id="LazyDeepClassifier-142"><a href="#LazyDeepClassifier-142"><span class="linenos">142</span></a><span class="sd">        models, predictions = clf.fit(X_train, X_test, y_train, y_test)</span>
</span><span id="LazyDeepClassifier-143"><a href="#LazyDeepClassifier-143"><span class="linenos">143</span></a><span class="sd">        model_dictionary = clf.provide_models(X_train,X_test,y_train,y_test)</span>
</span><span id="LazyDeepClassifier-144"><a href="#LazyDeepClassifier-144"><span class="linenos">144</span></a><span class="sd">        print(models)</span>
</span><span id="LazyDeepClassifier-145"><a href="#LazyDeepClassifier-145"><span class="linenos">145</span></a><span class="sd">        ```</span>
</span><span id="LazyDeepClassifier-146"><a href="#LazyDeepClassifier-146"><span class="linenos">146</span></a>
</span><span id="LazyDeepClassifier-147"><a href="#LazyDeepClassifier-147"><span class="linenos">147</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LazyDeepClassifier-148"><a href="#LazyDeepClassifier-148"><span class="linenos">148</span></a>
</span><span id="LazyDeepClassifier-149"><a href="#LazyDeepClassifier-149"><span class="linenos">149</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-150"><a href="#LazyDeepClassifier-150"><span class="linenos">150</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-151"><a href="#LazyDeepClassifier-151"><span class="linenos">151</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-152"><a href="#LazyDeepClassifier-152"><span class="linenos">152</span></a>        <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-153"><a href="#LazyDeepClassifier-153"><span class="linenos">153</span></a>        <span class="n">custom_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-154"><a href="#LazyDeepClassifier-154"><span class="linenos">154</span></a>        <span class="n">predictions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-155"><a href="#LazyDeepClassifier-155"><span class="linenos">155</span></a>        <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-156"><a href="#LazyDeepClassifier-156"><span class="linenos">156</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-157"><a href="#LazyDeepClassifier-157"><span class="linenos">157</span></a>        <span class="n">estimators</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-158"><a href="#LazyDeepClassifier-158"><span class="linenos">158</span></a>        <span class="n">preprocess</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-159"><a href="#LazyDeepClassifier-159"><span class="linenos">159</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-160"><a href="#LazyDeepClassifier-160"><span class="linenos">160</span></a>        <span class="c1"># Defining depth</span>
</span><span id="LazyDeepClassifier-161"><a href="#LazyDeepClassifier-161"><span class="linenos">161</span></a>        <span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-162"><a href="#LazyDeepClassifier-162"><span class="linenos">162</span></a>        <span class="c1"># CustomClassifier attributes</span>
</span><span id="LazyDeepClassifier-163"><a href="#LazyDeepClassifier-163"><span class="linenos">163</span></a>        <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-164"><a href="#LazyDeepClassifier-164"><span class="linenos">164</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-165"><a href="#LazyDeepClassifier-165"><span class="linenos">165</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-166"><a href="#LazyDeepClassifier-166"><span class="linenos">166</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-167"><a href="#LazyDeepClassifier-167"><span class="linenos">167</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-168"><a href="#LazyDeepClassifier-168"><span class="linenos">168</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-169"><a href="#LazyDeepClassifier-169"><span class="linenos">169</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-170"><a href="#LazyDeepClassifier-170"><span class="linenos">170</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-171"><a href="#LazyDeepClassifier-171"><span class="linenos">171</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-172"><a href="#LazyDeepClassifier-172"><span class="linenos">172</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-173"><a href="#LazyDeepClassifier-173"><span class="linenos">173</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-174"><a href="#LazyDeepClassifier-174"><span class="linenos">174</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="LazyDeepClassifier-175"><a href="#LazyDeepClassifier-175"><span class="linenos">175</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-176"><a href="#LazyDeepClassifier-176"><span class="linenos">176</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-177"><a href="#LazyDeepClassifier-177"><span class="linenos">177</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-178"><a href="#LazyDeepClassifier-178"><span class="linenos">178</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-179"><a href="#LazyDeepClassifier-179"><span class="linenos">179</span></a>    <span class="p">):</span>
</span><span id="LazyDeepClassifier-180"><a href="#LazyDeepClassifier-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="LazyDeepClassifier-181"><a href="#LazyDeepClassifier-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="o">=</span> <span class="n">ignore_warnings</span>
</span><span id="LazyDeepClassifier-182"><a href="#LazyDeepClassifier-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="o">=</span> <span class="n">custom_metric</span>
</span><span id="LazyDeepClassifier-183"><a href="#LazyDeepClassifier-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span>
</span><span id="LazyDeepClassifier-184"><a href="#LazyDeepClassifier-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sort_by</span> <span class="o">=</span> <span class="n">sort_by</span>
</span><span id="LazyDeepClassifier-185"><a href="#LazyDeepClassifier-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepClassifier-186"><a href="#LazyDeepClassifier-186"><span class="linenos">186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="LazyDeepClassifier-187"><a href="#LazyDeepClassifier-187"><span class="linenos">187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">=</span> <span class="n">estimators</span>
</span><span id="LazyDeepClassifier-188"><a href="#LazyDeepClassifier-188"><span class="linenos">188</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="o">=</span> <span class="n">preprocess</span>
</span><span id="LazyDeepClassifier-189"><a href="#LazyDeepClassifier-189"><span class="linenos">189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">=</span> <span class="n">n_layers</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="LazyDeepClassifier-190"><a href="#LazyDeepClassifier-190"><span class="linenos">190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="LazyDeepClassifier-191"><a href="#LazyDeepClassifier-191"><span class="linenos">191</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-192"><a href="#LazyDeepClassifier-192"><span class="linenos">192</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-193"><a href="#LazyDeepClassifier-193"><span class="linenos">193</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-194"><a href="#LazyDeepClassifier-194"><span class="linenos">194</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-195"><a href="#LazyDeepClassifier-195"><span class="linenos">195</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-196"><a href="#LazyDeepClassifier-196"><span class="linenos">196</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-197"><a href="#LazyDeepClassifier-197"><span class="linenos">197</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-198"><a href="#LazyDeepClassifier-198"><span class="linenos">198</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-199"><a href="#LazyDeepClassifier-199"><span class="linenos">199</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-200"><a href="#LazyDeepClassifier-200"><span class="linenos">200</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-201"><a href="#LazyDeepClassifier-201"><span class="linenos">201</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-202"><a href="#LazyDeepClassifier-202"><span class="linenos">202</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-203"><a href="#LazyDeepClassifier-203"><span class="linenos">203</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-204"><a href="#LazyDeepClassifier-204"><span class="linenos">204</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-205"><a href="#LazyDeepClassifier-205"><span class="linenos">205</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-206"><a href="#LazyDeepClassifier-206"><span class="linenos">206</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-207"><a href="#LazyDeepClassifier-207"><span class="linenos">207</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-208"><a href="#LazyDeepClassifier-208"><span class="linenos">208</span></a>        <span class="p">)</span>
</span><span id="LazyDeepClassifier-209"><a href="#LazyDeepClassifier-209"><span class="linenos">209</span></a>
</span><span id="LazyDeepClassifier-210"><a href="#LazyDeepClassifier-210"><span class="linenos">210</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyDeepClassifier-211"><a href="#LazyDeepClassifier-211"><span class="linenos">211</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit classifiers to X_train and y_train, predict and score on X_test,</span>
</span><span id="LazyDeepClassifier-212"><a href="#LazyDeepClassifier-212"><span class="linenos">212</span></a><span class="sd">        y_test.</span>
</span><span id="LazyDeepClassifier-213"><a href="#LazyDeepClassifier-213"><span class="linenos">213</span></a>
</span><span id="LazyDeepClassifier-214"><a href="#LazyDeepClassifier-214"><span class="linenos">214</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepClassifier-215"><a href="#LazyDeepClassifier-215"><span class="linenos">215</span></a>
</span><span id="LazyDeepClassifier-216"><a href="#LazyDeepClassifier-216"><span class="linenos">216</span></a><span class="sd">            X_train: array-like,</span>
</span><span id="LazyDeepClassifier-217"><a href="#LazyDeepClassifier-217"><span class="linenos">217</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier-218"><a href="#LazyDeepClassifier-218"><span class="linenos">218</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepClassifier-219"><a href="#LazyDeepClassifier-219"><span class="linenos">219</span></a>
</span><span id="LazyDeepClassifier-220"><a href="#LazyDeepClassifier-220"><span class="linenos">220</span></a><span class="sd">            X_test: array-like,</span>
</span><span id="LazyDeepClassifier-221"><a href="#LazyDeepClassifier-221"><span class="linenos">221</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier-222"><a href="#LazyDeepClassifier-222"><span class="linenos">222</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepClassifier-223"><a href="#LazyDeepClassifier-223"><span class="linenos">223</span></a>
</span><span id="LazyDeepClassifier-224"><a href="#LazyDeepClassifier-224"><span class="linenos">224</span></a><span class="sd">            y_train: array-like,</span>
</span><span id="LazyDeepClassifier-225"><a href="#LazyDeepClassifier-225"><span class="linenos">225</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier-226"><a href="#LazyDeepClassifier-226"><span class="linenos">226</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepClassifier-227"><a href="#LazyDeepClassifier-227"><span class="linenos">227</span></a>
</span><span id="LazyDeepClassifier-228"><a href="#LazyDeepClassifier-228"><span class="linenos">228</span></a><span class="sd">            y_test: array-like,</span>
</span><span id="LazyDeepClassifier-229"><a href="#LazyDeepClassifier-229"><span class="linenos">229</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier-230"><a href="#LazyDeepClassifier-230"><span class="linenos">230</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepClassifier-231"><a href="#LazyDeepClassifier-231"><span class="linenos">231</span></a>
</span><span id="LazyDeepClassifier-232"><a href="#LazyDeepClassifier-232"><span class="linenos">232</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepClassifier-233"><a href="#LazyDeepClassifier-233"><span class="linenos">233</span></a>
</span><span id="LazyDeepClassifier-234"><a href="#LazyDeepClassifier-234"><span class="linenos">234</span></a><span class="sd">            scores: Pandas DataFrame</span>
</span><span id="LazyDeepClassifier-235"><a href="#LazyDeepClassifier-235"><span class="linenos">235</span></a><span class="sd">                Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepClassifier-236"><a href="#LazyDeepClassifier-236"><span class="linenos">236</span></a>
</span><span id="LazyDeepClassifier-237"><a href="#LazyDeepClassifier-237"><span class="linenos">237</span></a><span class="sd">            predictions: Pandas DataFrame</span>
</span><span id="LazyDeepClassifier-238"><a href="#LazyDeepClassifier-238"><span class="linenos">238</span></a><span class="sd">                Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepClassifier-239"><a href="#LazyDeepClassifier-239"><span class="linenos">239</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepClassifier-240"><a href="#LazyDeepClassifier-240"><span class="linenos">240</span></a>        <span class="n">Accuracy</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier-241"><a href="#LazyDeepClassifier-241"><span class="linenos">241</span></a>        <span class="n">B_Accuracy</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier-242"><a href="#LazyDeepClassifier-242"><span class="linenos">242</span></a>        <span class="n">ROC_AUC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier-243"><a href="#LazyDeepClassifier-243"><span class="linenos">243</span></a>        <span class="n">F1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier-244"><a href="#LazyDeepClassifier-244"><span class="linenos">244</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier-245"><a href="#LazyDeepClassifier-245"><span class="linenos">245</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier-246"><a href="#LazyDeepClassifier-246"><span class="linenos">246</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepClassifier-247"><a href="#LazyDeepClassifier-247"><span class="linenos">247</span></a>
</span><span id="LazyDeepClassifier-248"><a href="#LazyDeepClassifier-248"><span class="linenos">248</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-249"><a href="#LazyDeepClassifier-249"><span class="linenos">249</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier-250"><a href="#LazyDeepClassifier-250"><span class="linenos">250</span></a>
</span><span id="LazyDeepClassifier-251"><a href="#LazyDeepClassifier-251"><span class="linenos">251</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyDeepClassifier-252"><a href="#LazyDeepClassifier-252"><span class="linenos">252</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-253"><a href="#LazyDeepClassifier-253"><span class="linenos">253</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-254"><a href="#LazyDeepClassifier-254"><span class="linenos">254</span></a>
</span><span id="LazyDeepClassifier-255"><a href="#LazyDeepClassifier-255"><span class="linenos">255</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepClassifier-256"><a href="#LazyDeepClassifier-256"><span class="linenos">256</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepClassifier-257"><a href="#LazyDeepClassifier-257"><span class="linenos">257</span></a>
</span><span id="LazyDeepClassifier-258"><a href="#LazyDeepClassifier-258"><span class="linenos">258</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-259"><a href="#LazyDeepClassifier-259"><span class="linenos">259</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyDeepClassifier-260"><a href="#LazyDeepClassifier-260"><span class="linenos">260</span></a>        <span class="p">)</span>
</span><span id="LazyDeepClassifier-261"><a href="#LazyDeepClassifier-261"><span class="linenos">261</span></a>
</span><span id="LazyDeepClassifier-262"><a href="#LazyDeepClassifier-262"><span class="linenos">262</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-263"><a href="#LazyDeepClassifier-263"><span class="linenos">263</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-264"><a href="#LazyDeepClassifier-264"><span class="linenos">264</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepClassifier-265"><a href="#LazyDeepClassifier-265"><span class="linenos">265</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyDeepClassifier-266"><a href="#LazyDeepClassifier-266"><span class="linenos">266</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepClassifier-267"><a href="#LazyDeepClassifier-267"><span class="linenos">267</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-268"><a href="#LazyDeepClassifier-268"><span class="linenos">268</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-269"><a href="#LazyDeepClassifier-269"><span class="linenos">269</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-270"><a href="#LazyDeepClassifier-270"><span class="linenos">270</span></a>                    <span class="p">),</span>
</span><span id="LazyDeepClassifier-271"><a href="#LazyDeepClassifier-271"><span class="linenos">271</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepClassifier-272"><a href="#LazyDeepClassifier-272"><span class="linenos">272</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-273"><a href="#LazyDeepClassifier-273"><span class="linenos">273</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-274"><a href="#LazyDeepClassifier-274"><span class="linenos">274</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-275"><a href="#LazyDeepClassifier-275"><span class="linenos">275</span></a>                    <span class="p">),</span>
</span><span id="LazyDeepClassifier-276"><a href="#LazyDeepClassifier-276"><span class="linenos">276</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier-277"><a href="#LazyDeepClassifier-277"><span class="linenos">277</span></a>            <span class="p">)</span>
</span><span id="LazyDeepClassifier-278"><a href="#LazyDeepClassifier-278"><span class="linenos">278</span></a>
</span><span id="LazyDeepClassifier-279"><a href="#LazyDeepClassifier-279"><span class="linenos">279</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-280"><a href="#LazyDeepClassifier-280"><span class="linenos">280</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyDeepClassifier-281"><a href="#LazyDeepClassifier-281"><span class="linenos">281</span></a>                <span class="n">item</span>
</span><span id="LazyDeepClassifier-282"><a href="#LazyDeepClassifier-282"><span class="linenos">282</span></a>                <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="LazyDeepClassifier-283"><a href="#LazyDeepClassifier-283"><span class="linenos">283</span></a>                    <span class="n">DEEPCLASSIFIERS</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-284"><a href="#LazyDeepClassifier-284"><span class="linenos">284</span></a>                    <span class="n">DEEPMULTITASKCLASSIFIERS</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-285"><a href="#LazyDeepClassifier-285"><span class="linenos">285</span></a>                    <span class="n">DEEPSIMPLEMULTITASKCLASSIFIERS</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-286"><a href="#LazyDeepClassifier-286"><span class="linenos">286</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier-287"><a href="#LazyDeepClassifier-287"><span class="linenos">287</span></a>                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span>
</span><span id="LazyDeepClassifier-288"><a href="#LazyDeepClassifier-288"><span class="linenos">288</span></a>            <span class="p">]</span>
</span><span id="LazyDeepClassifier-289"><a href="#LazyDeepClassifier-289"><span class="linenos">289</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-290"><a href="#LazyDeepClassifier-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier-291"><a href="#LazyDeepClassifier-291"><span class="linenos">291</span></a>                <span class="p">[</span>
</span><span id="LazyDeepClassifier-292"><a href="#LazyDeepClassifier-292"><span class="linenos">292</span></a>                    <span class="p">(</span><span class="s2">&quot;DeepCustomClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyDeepClassifier-293"><a href="#LazyDeepClassifier-293"><span class="linenos">293</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepClassifier-294"><a href="#LazyDeepClassifier-294"><span class="linenos">294</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier-295"><a href="#LazyDeepClassifier-295"><span class="linenos">295</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ClassifierMixin</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-296"><a href="#LazyDeepClassifier-296"><span class="linenos">296</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-297"><a href="#LazyDeepClassifier-297"><span class="linenos">297</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier-298"><a href="#LazyDeepClassifier-298"><span class="linenos">298</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier-299"><a href="#LazyDeepClassifier-299"><span class="linenos">299</span></a>                <span class="o">+</span> <span class="p">[</span>
</span><span id="LazyDeepClassifier-300"><a href="#LazyDeepClassifier-300"><span class="linenos">300</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepClassifier-301"><a href="#LazyDeepClassifier-301"><span class="linenos">301</span></a>                        <span class="s2">&quot;DeepMultitaskClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-302"><a href="#LazyDeepClassifier-302"><span class="linenos">302</span></a>                        <span class="n">partial</span><span class="p">(</span><span class="n">MultitaskClassifier</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">]()),</span>
</span><span id="LazyDeepClassifier-303"><a href="#LazyDeepClassifier-303"><span class="linenos">303</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier-304"><a href="#LazyDeepClassifier-304"><span class="linenos">304</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepClassifier-305"><a href="#LazyDeepClassifier-305"><span class="linenos">305</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier-306"><a href="#LazyDeepClassifier-306"><span class="linenos">306</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-307"><a href="#LazyDeepClassifier-307"><span class="linenos">307</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-308"><a href="#LazyDeepClassifier-308"><span class="linenos">308</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier-309"><a href="#LazyDeepClassifier-309"><span class="linenos">309</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier-310"><a href="#LazyDeepClassifier-310"><span class="linenos">310</span></a>                <span class="o">+</span> <span class="p">[</span>
</span><span id="LazyDeepClassifier-311"><a href="#LazyDeepClassifier-311"><span class="linenos">311</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepClassifier-312"><a href="#LazyDeepClassifier-312"><span class="linenos">312</span></a>                        <span class="s2">&quot;DeepSimpleMultitaskClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-313"><a href="#LazyDeepClassifier-313"><span class="linenos">313</span></a>                        <span class="n">partial</span><span class="p">(</span><span class="n">SimpleMultitaskClassifier</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">]()),</span>
</span><span id="LazyDeepClassifier-314"><a href="#LazyDeepClassifier-314"><span class="linenos">314</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier-315"><a href="#LazyDeepClassifier-315"><span class="linenos">315</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepClassifier-316"><a href="#LazyDeepClassifier-316"><span class="linenos">316</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier-317"><a href="#LazyDeepClassifier-317"><span class="linenos">317</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-318"><a href="#LazyDeepClassifier-318"><span class="linenos">318</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-319"><a href="#LazyDeepClassifier-319"><span class="linenos">319</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier-320"><a href="#LazyDeepClassifier-320"><span class="linenos">320</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier-321"><a href="#LazyDeepClassifier-321"><span class="linenos">321</span></a>            <span class="p">)</span>
</span><span id="LazyDeepClassifier-322"><a href="#LazyDeepClassifier-322"><span class="linenos">322</span></a>
</span><span id="LazyDeepClassifier-323"><a href="#LazyDeepClassifier-323"><span class="linenos">323</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-324"><a href="#LazyDeepClassifier-324"><span class="linenos">324</span></a>
</span><span id="LazyDeepClassifier-325"><a href="#LazyDeepClassifier-325"><span class="linenos">325</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepClassifier-326"><a href="#LazyDeepClassifier-326"><span class="linenos">326</span></a>
</span><span id="LazyDeepClassifier-327"><a href="#LazyDeepClassifier-327"><span class="linenos">327</span></a>                <span class="n">other_args</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier-328"><a href="#LazyDeepClassifier-328"><span class="linenos">328</span></a>                    <span class="p">{}</span>
</span><span id="LazyDeepClassifier-329"><a href="#LazyDeepClassifier-329"><span class="linenos">329</span></a>                <span class="p">)</span>  <span class="c1"># use this trick for `random_state` too --&gt; refactor</span>
</span><span id="LazyDeepClassifier-330"><a href="#LazyDeepClassifier-330"><span class="linenos">330</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-331"><a href="#LazyDeepClassifier-331"><span class="linenos">331</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier-332"><a href="#LazyDeepClassifier-332"><span class="linenos">332</span></a>                        <span class="s2">&quot;n_jobs&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="LazyDeepClassifier-333"><a href="#LazyDeepClassifier-333"><span class="linenos">333</span></a>                        <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;LogisticRegression&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="LazyDeepClassifier-334"><a href="#LazyDeepClassifier-334"><span class="linenos">334</span></a>                    <span class="p">):</span>
</span><span id="LazyDeepClassifier-335"><a href="#LazyDeepClassifier-335"><span class="linenos">335</span></a>                        <span class="n">other_args</span><span class="p">[</span><span class="s2">&quot;n_jobs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span>
</span><span id="LazyDeepClassifier-336"><a href="#LazyDeepClassifier-336"><span class="linenos">336</span></a>                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-337"><a href="#LazyDeepClassifier-337"><span class="linenos">337</span></a>                    <span class="k">pass</span>
</span><span id="LazyDeepClassifier-338"><a href="#LazyDeepClassifier-338"><span class="linenos">338</span></a>
</span><span id="LazyDeepClassifier-339"><a href="#LazyDeepClassifier-339"><span class="linenos">339</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepClassifier-340"><a href="#LazyDeepClassifier-340"><span class="linenos">340</span></a>
</span><span id="LazyDeepClassifier-341"><a href="#LazyDeepClassifier-341"><span class="linenos">341</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-342"><a href="#LazyDeepClassifier-342"><span class="linenos">342</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepClassifier-343"><a href="#LazyDeepClassifier-343"><span class="linenos">343</span></a>                        <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-344"><a href="#LazyDeepClassifier-344"><span class="linenos">344</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">),</span>
</span><span id="LazyDeepClassifier-345"><a href="#LazyDeepClassifier-345"><span class="linenos">345</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-346"><a href="#LazyDeepClassifier-346"><span class="linenos">346</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-347"><a href="#LazyDeepClassifier-347"><span class="linenos">347</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-348"><a href="#LazyDeepClassifier-348"><span class="linenos">348</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-349"><a href="#LazyDeepClassifier-349"><span class="linenos">349</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-350"><a href="#LazyDeepClassifier-350"><span class="linenos">350</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-351"><a href="#LazyDeepClassifier-351"><span class="linenos">351</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-352"><a href="#LazyDeepClassifier-352"><span class="linenos">352</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-353"><a href="#LazyDeepClassifier-353"><span class="linenos">353</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-354"><a href="#LazyDeepClassifier-354"><span class="linenos">354</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-355"><a href="#LazyDeepClassifier-355"><span class="linenos">355</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-356"><a href="#LazyDeepClassifier-356"><span class="linenos">356</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-357"><a href="#LazyDeepClassifier-357"><span class="linenos">357</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-358"><a href="#LazyDeepClassifier-358"><span class="linenos">358</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-359"><a href="#LazyDeepClassifier-359"><span class="linenos">359</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-360"><a href="#LazyDeepClassifier-360"><span class="linenos">360</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier-361"><a href="#LazyDeepClassifier-361"><span class="linenos">361</span></a>
</span><span id="LazyDeepClassifier-362"><a href="#LazyDeepClassifier-362"><span class="linenos">362</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-363"><a href="#LazyDeepClassifier-363"><span class="linenos">363</span></a>                        <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-364"><a href="#LazyDeepClassifier-364"><span class="linenos">364</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyDeepClassifier-365"><a href="#LazyDeepClassifier-365"><span class="linenos">365</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-366"><a href="#LazyDeepClassifier-366"><span class="linenos">366</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-367"><a href="#LazyDeepClassifier-367"><span class="linenos">367</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-368"><a href="#LazyDeepClassifier-368"><span class="linenos">368</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-369"><a href="#LazyDeepClassifier-369"><span class="linenos">369</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-370"><a href="#LazyDeepClassifier-370"><span class="linenos">370</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-371"><a href="#LazyDeepClassifier-371"><span class="linenos">371</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-372"><a href="#LazyDeepClassifier-372"><span class="linenos">372</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-373"><a href="#LazyDeepClassifier-373"><span class="linenos">373</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-374"><a href="#LazyDeepClassifier-374"><span class="linenos">374</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-375"><a href="#LazyDeepClassifier-375"><span class="linenos">375</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-376"><a href="#LazyDeepClassifier-376"><span class="linenos">376</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-377"><a href="#LazyDeepClassifier-377"><span class="linenos">377</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-378"><a href="#LazyDeepClassifier-378"><span class="linenos">378</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-379"><a href="#LazyDeepClassifier-379"><span class="linenos">379</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-380"><a href="#LazyDeepClassifier-380"><span class="linenos">380</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier-381"><a href="#LazyDeepClassifier-381"><span class="linenos">381</span></a>
</span><span id="LazyDeepClassifier-382"><a href="#LazyDeepClassifier-382"><span class="linenos">382</span></a>                    <span class="n">layer_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-383"><a href="#LazyDeepClassifier-383"><span class="linenos">383</span></a>
</span><span id="LazyDeepClassifier-384"><a href="#LazyDeepClassifier-384"><span class="linenos">384</span></a>                    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">):</span>
</span><span id="LazyDeepClassifier-385"><a href="#LazyDeepClassifier-385"><span class="linenos">385</span></a>                        <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-386"><a href="#LazyDeepClassifier-386"><span class="linenos">386</span></a>                            <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-387"><a href="#LazyDeepClassifier-387"><span class="linenos">387</span></a>                                <span class="n">obj</span><span class="o">=</span><span class="n">layer_clf</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-388"><a href="#LazyDeepClassifier-388"><span class="linenos">388</span></a>                                <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-389"><a href="#LazyDeepClassifier-389"><span class="linenos">389</span></a>                                <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-390"><a href="#LazyDeepClassifier-390"><span class="linenos">390</span></a>                                <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-391"><a href="#LazyDeepClassifier-391"><span class="linenos">391</span></a>                                <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-392"><a href="#LazyDeepClassifier-392"><span class="linenos">392</span></a>                                <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-393"><a href="#LazyDeepClassifier-393"><span class="linenos">393</span></a>                                <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-394"><a href="#LazyDeepClassifier-394"><span class="linenos">394</span></a>                                <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-395"><a href="#LazyDeepClassifier-395"><span class="linenos">395</span></a>                                <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-396"><a href="#LazyDeepClassifier-396"><span class="linenos">396</span></a>                                <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-397"><a href="#LazyDeepClassifier-397"><span class="linenos">397</span></a>                                <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-398"><a href="#LazyDeepClassifier-398"><span class="linenos">398</span></a>                                <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-399"><a href="#LazyDeepClassifier-399"><span class="linenos">399</span></a>                                <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-400"><a href="#LazyDeepClassifier-400"><span class="linenos">400</span></a>                                <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-401"><a href="#LazyDeepClassifier-401"><span class="linenos">401</span></a>                                <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-402"><a href="#LazyDeepClassifier-402"><span class="linenos">402</span></a>                                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-403"><a href="#LazyDeepClassifier-403"><span class="linenos">403</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepClassifier-404"><a href="#LazyDeepClassifier-404"><span class="linenos">404</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier-405"><a href="#LazyDeepClassifier-405"><span class="linenos">405</span></a>
</span><span id="LazyDeepClassifier-406"><a href="#LazyDeepClassifier-406"><span class="linenos">406</span></a>                    <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-407"><a href="#LazyDeepClassifier-407"><span class="linenos">407</span></a>                        <span class="p">[</span>
</span><span id="LazyDeepClassifier-408"><a href="#LazyDeepClassifier-408"><span class="linenos">408</span></a>                            <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyDeepClassifier-409"><a href="#LazyDeepClassifier-409"><span class="linenos">409</span></a>                            <span class="p">(</span><span class="s2">&quot;classifier&quot;</span><span class="p">,</span> <span class="n">layer_clf</span><span class="p">),</span>
</span><span id="LazyDeepClassifier-410"><a href="#LazyDeepClassifier-410"><span class="linenos">410</span></a>                        <span class="p">]</span>
</span><span id="LazyDeepClassifier-411"><a href="#LazyDeepClassifier-411"><span class="linenos">411</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier-412"><a href="#LazyDeepClassifier-412"><span class="linenos">412</span></a>
</span><span id="LazyDeepClassifier-413"><a href="#LazyDeepClassifier-413"><span class="linenos">413</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-414"><a href="#LazyDeepClassifier-414"><span class="linenos">414</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyDeepClassifier-415"><a href="#LazyDeepClassifier-415"><span class="linenos">415</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-416"><a href="#LazyDeepClassifier-416"><span class="linenos">416</span></a>                    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-417"><a href="#LazyDeepClassifier-417"><span class="linenos">417</span></a>                    <span class="n">b_accuracy</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-418"><a href="#LazyDeepClassifier-418"><span class="linenos">418</span></a>                    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-419"><a href="#LazyDeepClassifier-419"><span class="linenos">419</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-420"><a href="#LazyDeepClassifier-420"><span class="linenos">420</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-421"><a href="#LazyDeepClassifier-421"><span class="linenos">421</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-422"><a href="#LazyDeepClassifier-422"><span class="linenos">422</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LazyDeepClassifier-423"><a href="#LazyDeepClassifier-423"><span class="linenos">423</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-424"><a href="#LazyDeepClassifier-424"><span class="linenos">424</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROC AUC couldn&#39;t be calculated for &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-425"><a href="#LazyDeepClassifier-425"><span class="linenos">425</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-426"><a href="#LazyDeepClassifier-426"><span class="linenos">426</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-427"><a href="#LazyDeepClassifier-427"><span class="linenos">427</span></a>                    <span class="n">Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-428"><a href="#LazyDeepClassifier-428"><span class="linenos">428</span></a>                    <span class="n">B_Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_accuracy</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-429"><a href="#LazyDeepClassifier-429"><span class="linenos">429</span></a>                    <span class="n">ROC_AUC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-430"><a href="#LazyDeepClassifier-430"><span class="linenos">430</span></a>                    <span class="n">F1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-431"><a href="#LazyDeepClassifier-431"><span class="linenos">431</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-432"><a href="#LazyDeepClassifier-432"><span class="linenos">432</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-433"><a href="#LazyDeepClassifier-433"><span class="linenos">433</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-434"><a href="#LazyDeepClassifier-434"><span class="linenos">434</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-435"><a href="#LazyDeepClassifier-435"><span class="linenos">435</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-436"><a href="#LazyDeepClassifier-436"><span class="linenos">436</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-437"><a href="#LazyDeepClassifier-437"><span class="linenos">437</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-438"><a href="#LazyDeepClassifier-438"><span class="linenos">438</span></a>                                <span class="p">{</span>
</span><span id="LazyDeepClassifier-439"><a href="#LazyDeepClassifier-439"><span class="linenos">439</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-440"><a href="#LazyDeepClassifier-440"><span class="linenos">440</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-441"><a href="#LazyDeepClassifier-441"><span class="linenos">441</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-442"><a href="#LazyDeepClassifier-442"><span class="linenos">442</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-443"><a href="#LazyDeepClassifier-443"><span class="linenos">443</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-444"><a href="#LazyDeepClassifier-444"><span class="linenos">444</span></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">custom_metric</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-445"><a href="#LazyDeepClassifier-445"><span class="linenos">445</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-446"><a href="#LazyDeepClassifier-446"><span class="linenos">446</span></a>                                <span class="p">}</span>
</span><span id="LazyDeepClassifier-447"><a href="#LazyDeepClassifier-447"><span class="linenos">447</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepClassifier-448"><a href="#LazyDeepClassifier-448"><span class="linenos">448</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-449"><a href="#LazyDeepClassifier-449"><span class="linenos">449</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-450"><a href="#LazyDeepClassifier-450"><span class="linenos">450</span></a>                                <span class="p">{</span>
</span><span id="LazyDeepClassifier-451"><a href="#LazyDeepClassifier-451"><span class="linenos">451</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-452"><a href="#LazyDeepClassifier-452"><span class="linenos">452</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-453"><a href="#LazyDeepClassifier-453"><span class="linenos">453</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-454"><a href="#LazyDeepClassifier-454"><span class="linenos">454</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-455"><a href="#LazyDeepClassifier-455"><span class="linenos">455</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-456"><a href="#LazyDeepClassifier-456"><span class="linenos">456</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-457"><a href="#LazyDeepClassifier-457"><span class="linenos">457</span></a>                                <span class="p">}</span>
</span><span id="LazyDeepClassifier-458"><a href="#LazyDeepClassifier-458"><span class="linenos">458</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepClassifier-459"><a href="#LazyDeepClassifier-459"><span class="linenos">459</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-460"><a href="#LazyDeepClassifier-460"><span class="linenos">460</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyDeepClassifier-461"><a href="#LazyDeepClassifier-461"><span class="linenos">461</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-462"><a href="#LazyDeepClassifier-462"><span class="linenos">462</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-463"><a href="#LazyDeepClassifier-463"><span class="linenos">463</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-464"><a href="#LazyDeepClassifier-464"><span class="linenos">464</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-465"><a href="#LazyDeepClassifier-465"><span class="linenos">465</span></a>
</span><span id="LazyDeepClassifier-466"><a href="#LazyDeepClassifier-466"><span class="linenos">466</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># no preprocessing</span>
</span><span id="LazyDeepClassifier-467"><a href="#LazyDeepClassifier-467"><span class="linenos">467</span></a>
</span><span id="LazyDeepClassifier-468"><a href="#LazyDeepClassifier-468"><span class="linenos">468</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepClassifier-469"><a href="#LazyDeepClassifier-469"><span class="linenos">469</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepClassifier-470"><a href="#LazyDeepClassifier-470"><span class="linenos">470</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-471"><a href="#LazyDeepClassifier-471"><span class="linenos">471</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepClassifier-472"><a href="#LazyDeepClassifier-472"><span class="linenos">472</span></a>                        <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-473"><a href="#LazyDeepClassifier-473"><span class="linenos">473</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">),</span>
</span><span id="LazyDeepClassifier-474"><a href="#LazyDeepClassifier-474"><span class="linenos">474</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-475"><a href="#LazyDeepClassifier-475"><span class="linenos">475</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-476"><a href="#LazyDeepClassifier-476"><span class="linenos">476</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-477"><a href="#LazyDeepClassifier-477"><span class="linenos">477</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-478"><a href="#LazyDeepClassifier-478"><span class="linenos">478</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-479"><a href="#LazyDeepClassifier-479"><span class="linenos">479</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-480"><a href="#LazyDeepClassifier-480"><span class="linenos">480</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-481"><a href="#LazyDeepClassifier-481"><span class="linenos">481</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-482"><a href="#LazyDeepClassifier-482"><span class="linenos">482</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-483"><a href="#LazyDeepClassifier-483"><span class="linenos">483</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-484"><a href="#LazyDeepClassifier-484"><span class="linenos">484</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-485"><a href="#LazyDeepClassifier-485"><span class="linenos">485</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-486"><a href="#LazyDeepClassifier-486"><span class="linenos">486</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-487"><a href="#LazyDeepClassifier-487"><span class="linenos">487</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-488"><a href="#LazyDeepClassifier-488"><span class="linenos">488</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-489"><a href="#LazyDeepClassifier-489"><span class="linenos">489</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier-490"><a href="#LazyDeepClassifier-490"><span class="linenos">490</span></a>
</span><span id="LazyDeepClassifier-491"><a href="#LazyDeepClassifier-491"><span class="linenos">491</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-492"><a href="#LazyDeepClassifier-492"><span class="linenos">492</span></a>                        <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-493"><a href="#LazyDeepClassifier-493"><span class="linenos">493</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyDeepClassifier-494"><a href="#LazyDeepClassifier-494"><span class="linenos">494</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-495"><a href="#LazyDeepClassifier-495"><span class="linenos">495</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-496"><a href="#LazyDeepClassifier-496"><span class="linenos">496</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-497"><a href="#LazyDeepClassifier-497"><span class="linenos">497</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-498"><a href="#LazyDeepClassifier-498"><span class="linenos">498</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-499"><a href="#LazyDeepClassifier-499"><span class="linenos">499</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-500"><a href="#LazyDeepClassifier-500"><span class="linenos">500</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-501"><a href="#LazyDeepClassifier-501"><span class="linenos">501</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-502"><a href="#LazyDeepClassifier-502"><span class="linenos">502</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-503"><a href="#LazyDeepClassifier-503"><span class="linenos">503</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-504"><a href="#LazyDeepClassifier-504"><span class="linenos">504</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-505"><a href="#LazyDeepClassifier-505"><span class="linenos">505</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-506"><a href="#LazyDeepClassifier-506"><span class="linenos">506</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-507"><a href="#LazyDeepClassifier-507"><span class="linenos">507</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-508"><a href="#LazyDeepClassifier-508"><span class="linenos">508</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-509"><a href="#LazyDeepClassifier-509"><span class="linenos">509</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier-510"><a href="#LazyDeepClassifier-510"><span class="linenos">510</span></a>
</span><span id="LazyDeepClassifier-511"><a href="#LazyDeepClassifier-511"><span class="linenos">511</span></a>                    <span class="n">layer_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-512"><a href="#LazyDeepClassifier-512"><span class="linenos">512</span></a>
</span><span id="LazyDeepClassifier-513"><a href="#LazyDeepClassifier-513"><span class="linenos">513</span></a>                    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">):</span>
</span><span id="LazyDeepClassifier-514"><a href="#LazyDeepClassifier-514"><span class="linenos">514</span></a>                        <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-515"><a href="#LazyDeepClassifier-515"><span class="linenos">515</span></a>                            <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-516"><a href="#LazyDeepClassifier-516"><span class="linenos">516</span></a>                                <span class="n">obj</span><span class="o">=</span><span class="n">layer_clf</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-517"><a href="#LazyDeepClassifier-517"><span class="linenos">517</span></a>                                <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-518"><a href="#LazyDeepClassifier-518"><span class="linenos">518</span></a>                                <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-519"><a href="#LazyDeepClassifier-519"><span class="linenos">519</span></a>                                <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-520"><a href="#LazyDeepClassifier-520"><span class="linenos">520</span></a>                                <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-521"><a href="#LazyDeepClassifier-521"><span class="linenos">521</span></a>                                <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-522"><a href="#LazyDeepClassifier-522"><span class="linenos">522</span></a>                                <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-523"><a href="#LazyDeepClassifier-523"><span class="linenos">523</span></a>                                <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-524"><a href="#LazyDeepClassifier-524"><span class="linenos">524</span></a>                                <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-525"><a href="#LazyDeepClassifier-525"><span class="linenos">525</span></a>                                <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-526"><a href="#LazyDeepClassifier-526"><span class="linenos">526</span></a>                                <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-527"><a href="#LazyDeepClassifier-527"><span class="linenos">527</span></a>                                <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-528"><a href="#LazyDeepClassifier-528"><span class="linenos">528</span></a>                                <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-529"><a href="#LazyDeepClassifier-529"><span class="linenos">529</span></a>                                <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-530"><a href="#LazyDeepClassifier-530"><span class="linenos">530</span></a>                                <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-531"><a href="#LazyDeepClassifier-531"><span class="linenos">531</span></a>                                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-532"><a href="#LazyDeepClassifier-532"><span class="linenos">532</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepClassifier-533"><a href="#LazyDeepClassifier-533"><span class="linenos">533</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier-534"><a href="#LazyDeepClassifier-534"><span class="linenos">534</span></a>
</span><span id="LazyDeepClassifier-535"><a href="#LazyDeepClassifier-535"><span class="linenos">535</span></a>                        <span class="c1"># layer_clf.fit(X_train, y_train)</span>
</span><span id="LazyDeepClassifier-536"><a href="#LazyDeepClassifier-536"><span class="linenos">536</span></a>
</span><span id="LazyDeepClassifier-537"><a href="#LazyDeepClassifier-537"><span class="linenos">537</span></a>                    <span class="n">layer_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-538"><a href="#LazyDeepClassifier-538"><span class="linenos">538</span></a>
</span><span id="LazyDeepClassifier-539"><a href="#LazyDeepClassifier-539"><span class="linenos">539</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_clf</span>
</span><span id="LazyDeepClassifier-540"><a href="#LazyDeepClassifier-540"><span class="linenos">540</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">layer_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-541"><a href="#LazyDeepClassifier-541"><span class="linenos">541</span></a>                    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-542"><a href="#LazyDeepClassifier-542"><span class="linenos">542</span></a>                    <span class="n">b_accuracy</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-543"><a href="#LazyDeepClassifier-543"><span class="linenos">543</span></a>                    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-544"><a href="#LazyDeepClassifier-544"><span class="linenos">544</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-545"><a href="#LazyDeepClassifier-545"><span class="linenos">545</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-546"><a href="#LazyDeepClassifier-546"><span class="linenos">546</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-547"><a href="#LazyDeepClassifier-547"><span class="linenos">547</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LazyDeepClassifier-548"><a href="#LazyDeepClassifier-548"><span class="linenos">548</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-549"><a href="#LazyDeepClassifier-549"><span class="linenos">549</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROC AUC couldn&#39;t be calculated for &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-550"><a href="#LazyDeepClassifier-550"><span class="linenos">550</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-551"><a href="#LazyDeepClassifier-551"><span class="linenos">551</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-552"><a href="#LazyDeepClassifier-552"><span class="linenos">552</span></a>                    <span class="n">Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-553"><a href="#LazyDeepClassifier-553"><span class="linenos">553</span></a>                    <span class="n">B_Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_accuracy</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-554"><a href="#LazyDeepClassifier-554"><span class="linenos">554</span></a>                    <span class="n">ROC_AUC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-555"><a href="#LazyDeepClassifier-555"><span class="linenos">555</span></a>                    <span class="n">F1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-556"><a href="#LazyDeepClassifier-556"><span class="linenos">556</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-557"><a href="#LazyDeepClassifier-557"><span class="linenos">557</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-558"><a href="#LazyDeepClassifier-558"><span class="linenos">558</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-559"><a href="#LazyDeepClassifier-559"><span class="linenos">559</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-560"><a href="#LazyDeepClassifier-560"><span class="linenos">560</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-561"><a href="#LazyDeepClassifier-561"><span class="linenos">561</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-562"><a href="#LazyDeepClassifier-562"><span class="linenos">562</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-563"><a href="#LazyDeepClassifier-563"><span class="linenos">563</span></a>                                <span class="p">{</span>
</span><span id="LazyDeepClassifier-564"><a href="#LazyDeepClassifier-564"><span class="linenos">564</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-565"><a href="#LazyDeepClassifier-565"><span class="linenos">565</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-566"><a href="#LazyDeepClassifier-566"><span class="linenos">566</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-567"><a href="#LazyDeepClassifier-567"><span class="linenos">567</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-568"><a href="#LazyDeepClassifier-568"><span class="linenos">568</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-569"><a href="#LazyDeepClassifier-569"><span class="linenos">569</span></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">custom_metric</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-570"><a href="#LazyDeepClassifier-570"><span class="linenos">570</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-571"><a href="#LazyDeepClassifier-571"><span class="linenos">571</span></a>                                <span class="p">}</span>
</span><span id="LazyDeepClassifier-572"><a href="#LazyDeepClassifier-572"><span class="linenos">572</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepClassifier-573"><a href="#LazyDeepClassifier-573"><span class="linenos">573</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-574"><a href="#LazyDeepClassifier-574"><span class="linenos">574</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-575"><a href="#LazyDeepClassifier-575"><span class="linenos">575</span></a>                                <span class="p">{</span>
</span><span id="LazyDeepClassifier-576"><a href="#LazyDeepClassifier-576"><span class="linenos">576</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-577"><a href="#LazyDeepClassifier-577"><span class="linenos">577</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-578"><a href="#LazyDeepClassifier-578"><span class="linenos">578</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-579"><a href="#LazyDeepClassifier-579"><span class="linenos">579</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-580"><a href="#LazyDeepClassifier-580"><span class="linenos">580</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-581"><a href="#LazyDeepClassifier-581"><span class="linenos">581</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-582"><a href="#LazyDeepClassifier-582"><span class="linenos">582</span></a>                                <span class="p">}</span>
</span><span id="LazyDeepClassifier-583"><a href="#LazyDeepClassifier-583"><span class="linenos">583</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepClassifier-584"><a href="#LazyDeepClassifier-584"><span class="linenos">584</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-585"><a href="#LazyDeepClassifier-585"><span class="linenos">585</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyDeepClassifier-586"><a href="#LazyDeepClassifier-586"><span class="linenos">586</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-587"><a href="#LazyDeepClassifier-587"><span class="linenos">587</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-588"><a href="#LazyDeepClassifier-588"><span class="linenos">588</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-589"><a href="#LazyDeepClassifier-589"><span class="linenos">589</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-590"><a href="#LazyDeepClassifier-590"><span class="linenos">590</span></a>
</span><span id="LazyDeepClassifier-591"><a href="#LazyDeepClassifier-591"><span class="linenos">591</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-592"><a href="#LazyDeepClassifier-592"><span class="linenos">592</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-593"><a href="#LazyDeepClassifier-593"><span class="linenos">593</span></a>                <span class="p">{</span>
</span><span id="LazyDeepClassifier-594"><a href="#LazyDeepClassifier-594"><span class="linenos">594</span></a>                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-595"><a href="#LazyDeepClassifier-595"><span class="linenos">595</span></a>                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-596"><a href="#LazyDeepClassifier-596"><span class="linenos">596</span></a>                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">B_Accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-597"><a href="#LazyDeepClassifier-597"><span class="linenos">597</span></a>                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">ROC_AUC</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-598"><a href="#LazyDeepClassifier-598"><span class="linenos">598</span></a>                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-599"><a href="#LazyDeepClassifier-599"><span class="linenos">599</span></a>                    <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-600"><a href="#LazyDeepClassifier-600"><span class="linenos">600</span></a>                <span class="p">}</span>
</span><span id="LazyDeepClassifier-601"><a href="#LazyDeepClassifier-601"><span class="linenos">601</span></a>            <span class="p">)</span>
</span><span id="LazyDeepClassifier-602"><a href="#LazyDeepClassifier-602"><span class="linenos">602</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-603"><a href="#LazyDeepClassifier-603"><span class="linenos">603</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-604"><a href="#LazyDeepClassifier-604"><span class="linenos">604</span></a>                <span class="p">{</span>
</span><span id="LazyDeepClassifier-605"><a href="#LazyDeepClassifier-605"><span class="linenos">605</span></a>                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-606"><a href="#LazyDeepClassifier-606"><span class="linenos">606</span></a>                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-607"><a href="#LazyDeepClassifier-607"><span class="linenos">607</span></a>                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">B_Accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-608"><a href="#LazyDeepClassifier-608"><span class="linenos">608</span></a>                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">ROC_AUC</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-609"><a href="#LazyDeepClassifier-609"><span class="linenos">609</span></a>                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-610"><a href="#LazyDeepClassifier-610"><span class="linenos">610</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">CUSTOM_METRIC</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-611"><a href="#LazyDeepClassifier-611"><span class="linenos">611</span></a>                    <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-612"><a href="#LazyDeepClassifier-612"><span class="linenos">612</span></a>                <span class="p">}</span>
</span><span id="LazyDeepClassifier-613"><a href="#LazyDeepClassifier-613"><span class="linenos">613</span></a>            <span class="p">)</span>
</span><span id="LazyDeepClassifier-614"><a href="#LazyDeepClassifier-614"><span class="linenos">614</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_by</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-615"><a href="#LazyDeepClassifier-615"><span class="linenos">615</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyDeepClassifier-616"><a href="#LazyDeepClassifier-616"><span class="linenos">616</span></a>        <span class="p">)</span>
</span><span id="LazyDeepClassifier-617"><a href="#LazyDeepClassifier-617"><span class="linenos">617</span></a>
</span><span id="LazyDeepClassifier-618"><a href="#LazyDeepClassifier-618"><span class="linenos">618</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-619"><a href="#LazyDeepClassifier-619"><span class="linenos">619</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-620"><a href="#LazyDeepClassifier-620"><span class="linenos">620</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span><span id="LazyDeepClassifier-621"><a href="#LazyDeepClassifier-621"><span class="linenos">621</span></a>
</span><span id="LazyDeepClassifier-622"><a href="#LazyDeepClassifier-622"><span class="linenos">622</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyDeepClassifier-623"><a href="#LazyDeepClassifier-623"><span class="linenos">623</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all the model objects trained. If fit hasn&#39;t been called yet,</span>
</span><span id="LazyDeepClassifier-624"><a href="#LazyDeepClassifier-624"><span class="linenos">624</span></a><span class="sd">        then it&#39;s called to return the models.</span>
</span><span id="LazyDeepClassifier-625"><a href="#LazyDeepClassifier-625"><span class="linenos">625</span></a>
</span><span id="LazyDeepClassifier-626"><a href="#LazyDeepClassifier-626"><span class="linenos">626</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepClassifier-627"><a href="#LazyDeepClassifier-627"><span class="linenos">627</span></a>
</span><span id="LazyDeepClassifier-628"><a href="#LazyDeepClassifier-628"><span class="linenos">628</span></a><span class="sd">        X_train: array-like,</span>
</span><span id="LazyDeepClassifier-629"><a href="#LazyDeepClassifier-629"><span class="linenos">629</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier-630"><a href="#LazyDeepClassifier-630"><span class="linenos">630</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyDeepClassifier-631"><a href="#LazyDeepClassifier-631"><span class="linenos">631</span></a>
</span><span id="LazyDeepClassifier-632"><a href="#LazyDeepClassifier-632"><span class="linenos">632</span></a><span class="sd">        X_test: array-like,</span>
</span><span id="LazyDeepClassifier-633"><a href="#LazyDeepClassifier-633"><span class="linenos">633</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier-634"><a href="#LazyDeepClassifier-634"><span class="linenos">634</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyDeepClassifier-635"><a href="#LazyDeepClassifier-635"><span class="linenos">635</span></a>
</span><span id="LazyDeepClassifier-636"><a href="#LazyDeepClassifier-636"><span class="linenos">636</span></a><span class="sd">        y_train: array-like,</span>
</span><span id="LazyDeepClassifier-637"><a href="#LazyDeepClassifier-637"><span class="linenos">637</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier-638"><a href="#LazyDeepClassifier-638"><span class="linenos">638</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyDeepClassifier-639"><a href="#LazyDeepClassifier-639"><span class="linenos">639</span></a>
</span><span id="LazyDeepClassifier-640"><a href="#LazyDeepClassifier-640"><span class="linenos">640</span></a><span class="sd">        y_test: array-like,</span>
</span><span id="LazyDeepClassifier-641"><a href="#LazyDeepClassifier-641"><span class="linenos">641</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier-642"><a href="#LazyDeepClassifier-642"><span class="linenos">642</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyDeepClassifier-643"><a href="#LazyDeepClassifier-643"><span class="linenos">643</span></a>
</span><span id="LazyDeepClassifier-644"><a href="#LazyDeepClassifier-644"><span class="linenos">644</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepClassifier-645"><a href="#LazyDeepClassifier-645"><span class="linenos">645</span></a>
</span><span id="LazyDeepClassifier-646"><a href="#LazyDeepClassifier-646"><span class="linenos">646</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyDeepClassifier-647"><a href="#LazyDeepClassifier-647"><span class="linenos">647</span></a><span class="sd">                Returns a dictionary with each model&#39;s pipeline as value</span>
</span><span id="LazyDeepClassifier-648"><a href="#LazyDeepClassifier-648"><span class="linenos">648</span></a><span class="sd">                and key = name of the model.</span>
</span><span id="LazyDeepClassifier-649"><a href="#LazyDeepClassifier-649"><span class="linenos">649</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepClassifier-650"><a href="#LazyDeepClassifier-650"><span class="linenos">650</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-651"><a href="#LazyDeepClassifier-651"><span class="linenos">651</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-652"><a href="#LazyDeepClassifier-652"><span class="linenos">652</span></a>
</span><span id="LazyDeepClassifier-653"><a href="#LazyDeepClassifier-653"><span class="linenos">653</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>Fitting -- almost -- all the classification algorithms with layers of
nnetsauce's CustomClassifier and returning their scores.</p>

<p>Parameters:</p>

<pre><code>verbose: int, optional (default=0)
    Any positive number for verbosity.

ignore_warnings: bool, optional (default=True)
    When set to True, the warning related to algorigms that are not
    able to run are ignored.

custom_metric: function, optional (default=None)
    When function is provided, models are evaluated based on the custom
      evaluation metric provided.

predictions: bool, optional (default=False)
    When set to True, the predictions of all the models models are
    returned as data frame.

sort_by: string, optional (default='Accuracy')
    Sort models by a metric. Available options are 'Accuracy',
    'Balanced Accuracy', 'ROC AUC', 'F1 Score' or a custom metric
    identified by its name and provided by custom_metric.

random_state: int, optional (default=42)
    Reproducibiility seed.

estimators: list, optional (default='all')
    list of Estimators names or just 'all' for &gt; 90 classifiers
    (default='all')

preprocess: bool, preprocessing is done when set to True

n_jobs: int, when possible, run in parallel
    For now, only used by individual models that support it.

n_layers: int, optional (default=3)
    Number of layers of CustomClassifiers to be used.

All the other parameters are the same as CustomClassifier's.
</code></pre>

<p>Examples
    <div class="pdoc-code codehilite">
    <pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
    <span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
    <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>
    <span class="n">y</span><span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">target</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">LazyDeepClassifier</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">custom_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">models</span><span class="p">,</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="n">model_dictionary</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">provide_models</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">models</span><span class="p">)</span>
    </code></pre>
    </div></p>
</div>


                                <div id="LazyDeepClassifier.fit" class="classattr">
                                            <input id="LazyDeepClassifier.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">y_train</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyDeepClassifier.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepClassifier.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepClassifier.fit-210"><a href="#LazyDeepClassifier.fit-210"><span class="linenos">210</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyDeepClassifier.fit-211"><a href="#LazyDeepClassifier.fit-211"><span class="linenos">211</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit classifiers to X_train and y_train, predict and score on X_test,</span>
</span><span id="LazyDeepClassifier.fit-212"><a href="#LazyDeepClassifier.fit-212"><span class="linenos">212</span></a><span class="sd">        y_test.</span>
</span><span id="LazyDeepClassifier.fit-213"><a href="#LazyDeepClassifier.fit-213"><span class="linenos">213</span></a>
</span><span id="LazyDeepClassifier.fit-214"><a href="#LazyDeepClassifier.fit-214"><span class="linenos">214</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepClassifier.fit-215"><a href="#LazyDeepClassifier.fit-215"><span class="linenos">215</span></a>
</span><span id="LazyDeepClassifier.fit-216"><a href="#LazyDeepClassifier.fit-216"><span class="linenos">216</span></a><span class="sd">            X_train: array-like,</span>
</span><span id="LazyDeepClassifier.fit-217"><a href="#LazyDeepClassifier.fit-217"><span class="linenos">217</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier.fit-218"><a href="#LazyDeepClassifier.fit-218"><span class="linenos">218</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepClassifier.fit-219"><a href="#LazyDeepClassifier.fit-219"><span class="linenos">219</span></a>
</span><span id="LazyDeepClassifier.fit-220"><a href="#LazyDeepClassifier.fit-220"><span class="linenos">220</span></a><span class="sd">            X_test: array-like,</span>
</span><span id="LazyDeepClassifier.fit-221"><a href="#LazyDeepClassifier.fit-221"><span class="linenos">221</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier.fit-222"><a href="#LazyDeepClassifier.fit-222"><span class="linenos">222</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepClassifier.fit-223"><a href="#LazyDeepClassifier.fit-223"><span class="linenos">223</span></a>
</span><span id="LazyDeepClassifier.fit-224"><a href="#LazyDeepClassifier.fit-224"><span class="linenos">224</span></a><span class="sd">            y_train: array-like,</span>
</span><span id="LazyDeepClassifier.fit-225"><a href="#LazyDeepClassifier.fit-225"><span class="linenos">225</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier.fit-226"><a href="#LazyDeepClassifier.fit-226"><span class="linenos">226</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepClassifier.fit-227"><a href="#LazyDeepClassifier.fit-227"><span class="linenos">227</span></a>
</span><span id="LazyDeepClassifier.fit-228"><a href="#LazyDeepClassifier.fit-228"><span class="linenos">228</span></a><span class="sd">            y_test: array-like,</span>
</span><span id="LazyDeepClassifier.fit-229"><a href="#LazyDeepClassifier.fit-229"><span class="linenos">229</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier.fit-230"><a href="#LazyDeepClassifier.fit-230"><span class="linenos">230</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepClassifier.fit-231"><a href="#LazyDeepClassifier.fit-231"><span class="linenos">231</span></a>
</span><span id="LazyDeepClassifier.fit-232"><a href="#LazyDeepClassifier.fit-232"><span class="linenos">232</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepClassifier.fit-233"><a href="#LazyDeepClassifier.fit-233"><span class="linenos">233</span></a>
</span><span id="LazyDeepClassifier.fit-234"><a href="#LazyDeepClassifier.fit-234"><span class="linenos">234</span></a><span class="sd">            scores: Pandas DataFrame</span>
</span><span id="LazyDeepClassifier.fit-235"><a href="#LazyDeepClassifier.fit-235"><span class="linenos">235</span></a><span class="sd">                Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepClassifier.fit-236"><a href="#LazyDeepClassifier.fit-236"><span class="linenos">236</span></a>
</span><span id="LazyDeepClassifier.fit-237"><a href="#LazyDeepClassifier.fit-237"><span class="linenos">237</span></a><span class="sd">            predictions: Pandas DataFrame</span>
</span><span id="LazyDeepClassifier.fit-238"><a href="#LazyDeepClassifier.fit-238"><span class="linenos">238</span></a><span class="sd">                Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepClassifier.fit-239"><a href="#LazyDeepClassifier.fit-239"><span class="linenos">239</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepClassifier.fit-240"><a href="#LazyDeepClassifier.fit-240"><span class="linenos">240</span></a>        <span class="n">Accuracy</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier.fit-241"><a href="#LazyDeepClassifier.fit-241"><span class="linenos">241</span></a>        <span class="n">B_Accuracy</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier.fit-242"><a href="#LazyDeepClassifier.fit-242"><span class="linenos">242</span></a>        <span class="n">ROC_AUC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier.fit-243"><a href="#LazyDeepClassifier.fit-243"><span class="linenos">243</span></a>        <span class="n">F1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier.fit-244"><a href="#LazyDeepClassifier.fit-244"><span class="linenos">244</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier.fit-245"><a href="#LazyDeepClassifier.fit-245"><span class="linenos">245</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier.fit-246"><a href="#LazyDeepClassifier.fit-246"><span class="linenos">246</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepClassifier.fit-247"><a href="#LazyDeepClassifier.fit-247"><span class="linenos">247</span></a>
</span><span id="LazyDeepClassifier.fit-248"><a href="#LazyDeepClassifier.fit-248"><span class="linenos">248</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-249"><a href="#LazyDeepClassifier.fit-249"><span class="linenos">249</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier.fit-250"><a href="#LazyDeepClassifier.fit-250"><span class="linenos">250</span></a>
</span><span id="LazyDeepClassifier.fit-251"><a href="#LazyDeepClassifier.fit-251"><span class="linenos">251</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyDeepClassifier.fit-252"><a href="#LazyDeepClassifier.fit-252"><span class="linenos">252</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-253"><a href="#LazyDeepClassifier.fit-253"><span class="linenos">253</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-254"><a href="#LazyDeepClassifier.fit-254"><span class="linenos">254</span></a>
</span><span id="LazyDeepClassifier.fit-255"><a href="#LazyDeepClassifier.fit-255"><span class="linenos">255</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepClassifier.fit-256"><a href="#LazyDeepClassifier.fit-256"><span class="linenos">256</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepClassifier.fit-257"><a href="#LazyDeepClassifier.fit-257"><span class="linenos">257</span></a>
</span><span id="LazyDeepClassifier.fit-258"><a href="#LazyDeepClassifier.fit-258"><span class="linenos">258</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-259"><a href="#LazyDeepClassifier.fit-259"><span class="linenos">259</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyDeepClassifier.fit-260"><a href="#LazyDeepClassifier.fit-260"><span class="linenos">260</span></a>        <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-261"><a href="#LazyDeepClassifier.fit-261"><span class="linenos">261</span></a>
</span><span id="LazyDeepClassifier.fit-262"><a href="#LazyDeepClassifier.fit-262"><span class="linenos">262</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-263"><a href="#LazyDeepClassifier.fit-263"><span class="linenos">263</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-264"><a href="#LazyDeepClassifier.fit-264"><span class="linenos">264</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepClassifier.fit-265"><a href="#LazyDeepClassifier.fit-265"><span class="linenos">265</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyDeepClassifier.fit-266"><a href="#LazyDeepClassifier.fit-266"><span class="linenos">266</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-267"><a href="#LazyDeepClassifier.fit-267"><span class="linenos">267</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-268"><a href="#LazyDeepClassifier.fit-268"><span class="linenos">268</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-269"><a href="#LazyDeepClassifier.fit-269"><span class="linenos">269</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-270"><a href="#LazyDeepClassifier.fit-270"><span class="linenos">270</span></a>                    <span class="p">),</span>
</span><span id="LazyDeepClassifier.fit-271"><a href="#LazyDeepClassifier.fit-271"><span class="linenos">271</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-272"><a href="#LazyDeepClassifier.fit-272"><span class="linenos">272</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-273"><a href="#LazyDeepClassifier.fit-273"><span class="linenos">273</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-274"><a href="#LazyDeepClassifier.fit-274"><span class="linenos">274</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-275"><a href="#LazyDeepClassifier.fit-275"><span class="linenos">275</span></a>                    <span class="p">),</span>
</span><span id="LazyDeepClassifier.fit-276"><a href="#LazyDeepClassifier.fit-276"><span class="linenos">276</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier.fit-277"><a href="#LazyDeepClassifier.fit-277"><span class="linenos">277</span></a>            <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-278"><a href="#LazyDeepClassifier.fit-278"><span class="linenos">278</span></a>
</span><span id="LazyDeepClassifier.fit-279"><a href="#LazyDeepClassifier.fit-279"><span class="linenos">279</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-280"><a href="#LazyDeepClassifier.fit-280"><span class="linenos">280</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyDeepClassifier.fit-281"><a href="#LazyDeepClassifier.fit-281"><span class="linenos">281</span></a>                <span class="n">item</span>
</span><span id="LazyDeepClassifier.fit-282"><a href="#LazyDeepClassifier.fit-282"><span class="linenos">282</span></a>                <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="LazyDeepClassifier.fit-283"><a href="#LazyDeepClassifier.fit-283"><span class="linenos">283</span></a>                    <span class="n">DEEPCLASSIFIERS</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-284"><a href="#LazyDeepClassifier.fit-284"><span class="linenos">284</span></a>                    <span class="n">DEEPMULTITASKCLASSIFIERS</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-285"><a href="#LazyDeepClassifier.fit-285"><span class="linenos">285</span></a>                    <span class="n">DEEPSIMPLEMULTITASKCLASSIFIERS</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-286"><a href="#LazyDeepClassifier.fit-286"><span class="linenos">286</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier.fit-287"><a href="#LazyDeepClassifier.fit-287"><span class="linenos">287</span></a>                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span>
</span><span id="LazyDeepClassifier.fit-288"><a href="#LazyDeepClassifier.fit-288"><span class="linenos">288</span></a>            <span class="p">]</span>
</span><span id="LazyDeepClassifier.fit-289"><a href="#LazyDeepClassifier.fit-289"><span class="linenos">289</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-290"><a href="#LazyDeepClassifier.fit-290"><span class="linenos">290</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-291"><a href="#LazyDeepClassifier.fit-291"><span class="linenos">291</span></a>                <span class="p">[</span>
</span><span id="LazyDeepClassifier.fit-292"><a href="#LazyDeepClassifier.fit-292"><span class="linenos">292</span></a>                    <span class="p">(</span><span class="s2">&quot;DeepCustomClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyDeepClassifier.fit-293"><a href="#LazyDeepClassifier.fit-293"><span class="linenos">293</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepClassifier.fit-294"><a href="#LazyDeepClassifier.fit-294"><span class="linenos">294</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-295"><a href="#LazyDeepClassifier.fit-295"><span class="linenos">295</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ClassifierMixin</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-296"><a href="#LazyDeepClassifier.fit-296"><span class="linenos">296</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-297"><a href="#LazyDeepClassifier.fit-297"><span class="linenos">297</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-298"><a href="#LazyDeepClassifier.fit-298"><span class="linenos">298</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier.fit-299"><a href="#LazyDeepClassifier.fit-299"><span class="linenos">299</span></a>                <span class="o">+</span> <span class="p">[</span>
</span><span id="LazyDeepClassifier.fit-300"><a href="#LazyDeepClassifier.fit-300"><span class="linenos">300</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-301"><a href="#LazyDeepClassifier.fit-301"><span class="linenos">301</span></a>                        <span class="s2">&quot;DeepMultitaskClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-302"><a href="#LazyDeepClassifier.fit-302"><span class="linenos">302</span></a>                        <span class="n">partial</span><span class="p">(</span><span class="n">MultitaskClassifier</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">]()),</span>
</span><span id="LazyDeepClassifier.fit-303"><a href="#LazyDeepClassifier.fit-303"><span class="linenos">303</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-304"><a href="#LazyDeepClassifier.fit-304"><span class="linenos">304</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepClassifier.fit-305"><a href="#LazyDeepClassifier.fit-305"><span class="linenos">305</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-306"><a href="#LazyDeepClassifier.fit-306"><span class="linenos">306</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-307"><a href="#LazyDeepClassifier.fit-307"><span class="linenos">307</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-308"><a href="#LazyDeepClassifier.fit-308"><span class="linenos">308</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-309"><a href="#LazyDeepClassifier.fit-309"><span class="linenos">309</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier.fit-310"><a href="#LazyDeepClassifier.fit-310"><span class="linenos">310</span></a>                <span class="o">+</span> <span class="p">[</span>
</span><span id="LazyDeepClassifier.fit-311"><a href="#LazyDeepClassifier.fit-311"><span class="linenos">311</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-312"><a href="#LazyDeepClassifier.fit-312"><span class="linenos">312</span></a>                        <span class="s2">&quot;DeepSimpleMultitaskClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-313"><a href="#LazyDeepClassifier.fit-313"><span class="linenos">313</span></a>                        <span class="n">partial</span><span class="p">(</span><span class="n">SimpleMultitaskClassifier</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">]()),</span>
</span><span id="LazyDeepClassifier.fit-314"><a href="#LazyDeepClassifier.fit-314"><span class="linenos">314</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-315"><a href="#LazyDeepClassifier.fit-315"><span class="linenos">315</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepClassifier.fit-316"><a href="#LazyDeepClassifier.fit-316"><span class="linenos">316</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-317"><a href="#LazyDeepClassifier.fit-317"><span class="linenos">317</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-318"><a href="#LazyDeepClassifier.fit-318"><span class="linenos">318</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-319"><a href="#LazyDeepClassifier.fit-319"><span class="linenos">319</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-320"><a href="#LazyDeepClassifier.fit-320"><span class="linenos">320</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier.fit-321"><a href="#LazyDeepClassifier.fit-321"><span class="linenos">321</span></a>            <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-322"><a href="#LazyDeepClassifier.fit-322"><span class="linenos">322</span></a>
</span><span id="LazyDeepClassifier.fit-323"><a href="#LazyDeepClassifier.fit-323"><span class="linenos">323</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-324"><a href="#LazyDeepClassifier.fit-324"><span class="linenos">324</span></a>
</span><span id="LazyDeepClassifier.fit-325"><a href="#LazyDeepClassifier.fit-325"><span class="linenos">325</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepClassifier.fit-326"><a href="#LazyDeepClassifier.fit-326"><span class="linenos">326</span></a>
</span><span id="LazyDeepClassifier.fit-327"><a href="#LazyDeepClassifier.fit-327"><span class="linenos">327</span></a>                <span class="n">other_args</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-328"><a href="#LazyDeepClassifier.fit-328"><span class="linenos">328</span></a>                    <span class="p">{}</span>
</span><span id="LazyDeepClassifier.fit-329"><a href="#LazyDeepClassifier.fit-329"><span class="linenos">329</span></a>                <span class="p">)</span>  <span class="c1"># use this trick for `random_state` too --&gt; refactor</span>
</span><span id="LazyDeepClassifier.fit-330"><a href="#LazyDeepClassifier.fit-330"><span class="linenos">330</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-331"><a href="#LazyDeepClassifier.fit-331"><span class="linenos">331</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-332"><a href="#LazyDeepClassifier.fit-332"><span class="linenos">332</span></a>                        <span class="s2">&quot;n_jobs&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="LazyDeepClassifier.fit-333"><a href="#LazyDeepClassifier.fit-333"><span class="linenos">333</span></a>                        <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;LogisticRegression&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="LazyDeepClassifier.fit-334"><a href="#LazyDeepClassifier.fit-334"><span class="linenos">334</span></a>                    <span class="p">):</span>
</span><span id="LazyDeepClassifier.fit-335"><a href="#LazyDeepClassifier.fit-335"><span class="linenos">335</span></a>                        <span class="n">other_args</span><span class="p">[</span><span class="s2">&quot;n_jobs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span>
</span><span id="LazyDeepClassifier.fit-336"><a href="#LazyDeepClassifier.fit-336"><span class="linenos">336</span></a>                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-337"><a href="#LazyDeepClassifier.fit-337"><span class="linenos">337</span></a>                    <span class="k">pass</span>
</span><span id="LazyDeepClassifier.fit-338"><a href="#LazyDeepClassifier.fit-338"><span class="linenos">338</span></a>
</span><span id="LazyDeepClassifier.fit-339"><a href="#LazyDeepClassifier.fit-339"><span class="linenos">339</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepClassifier.fit-340"><a href="#LazyDeepClassifier.fit-340"><span class="linenos">340</span></a>
</span><span id="LazyDeepClassifier.fit-341"><a href="#LazyDeepClassifier.fit-341"><span class="linenos">341</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-342"><a href="#LazyDeepClassifier.fit-342"><span class="linenos">342</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepClassifier.fit-343"><a href="#LazyDeepClassifier.fit-343"><span class="linenos">343</span></a>                        <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-344"><a href="#LazyDeepClassifier.fit-344"><span class="linenos">344</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">),</span>
</span><span id="LazyDeepClassifier.fit-345"><a href="#LazyDeepClassifier.fit-345"><span class="linenos">345</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-346"><a href="#LazyDeepClassifier.fit-346"><span class="linenos">346</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-347"><a href="#LazyDeepClassifier.fit-347"><span class="linenos">347</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-348"><a href="#LazyDeepClassifier.fit-348"><span class="linenos">348</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-349"><a href="#LazyDeepClassifier.fit-349"><span class="linenos">349</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-350"><a href="#LazyDeepClassifier.fit-350"><span class="linenos">350</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-351"><a href="#LazyDeepClassifier.fit-351"><span class="linenos">351</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-352"><a href="#LazyDeepClassifier.fit-352"><span class="linenos">352</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-353"><a href="#LazyDeepClassifier.fit-353"><span class="linenos">353</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-354"><a href="#LazyDeepClassifier.fit-354"><span class="linenos">354</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-355"><a href="#LazyDeepClassifier.fit-355"><span class="linenos">355</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-356"><a href="#LazyDeepClassifier.fit-356"><span class="linenos">356</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-357"><a href="#LazyDeepClassifier.fit-357"><span class="linenos">357</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-358"><a href="#LazyDeepClassifier.fit-358"><span class="linenos">358</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-359"><a href="#LazyDeepClassifier.fit-359"><span class="linenos">359</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-360"><a href="#LazyDeepClassifier.fit-360"><span class="linenos">360</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-361"><a href="#LazyDeepClassifier.fit-361"><span class="linenos">361</span></a>
</span><span id="LazyDeepClassifier.fit-362"><a href="#LazyDeepClassifier.fit-362"><span class="linenos">362</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-363"><a href="#LazyDeepClassifier.fit-363"><span class="linenos">363</span></a>                        <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-364"><a href="#LazyDeepClassifier.fit-364"><span class="linenos">364</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyDeepClassifier.fit-365"><a href="#LazyDeepClassifier.fit-365"><span class="linenos">365</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-366"><a href="#LazyDeepClassifier.fit-366"><span class="linenos">366</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-367"><a href="#LazyDeepClassifier.fit-367"><span class="linenos">367</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-368"><a href="#LazyDeepClassifier.fit-368"><span class="linenos">368</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-369"><a href="#LazyDeepClassifier.fit-369"><span class="linenos">369</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-370"><a href="#LazyDeepClassifier.fit-370"><span class="linenos">370</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-371"><a href="#LazyDeepClassifier.fit-371"><span class="linenos">371</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-372"><a href="#LazyDeepClassifier.fit-372"><span class="linenos">372</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-373"><a href="#LazyDeepClassifier.fit-373"><span class="linenos">373</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-374"><a href="#LazyDeepClassifier.fit-374"><span class="linenos">374</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-375"><a href="#LazyDeepClassifier.fit-375"><span class="linenos">375</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-376"><a href="#LazyDeepClassifier.fit-376"><span class="linenos">376</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-377"><a href="#LazyDeepClassifier.fit-377"><span class="linenos">377</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-378"><a href="#LazyDeepClassifier.fit-378"><span class="linenos">378</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-379"><a href="#LazyDeepClassifier.fit-379"><span class="linenos">379</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-380"><a href="#LazyDeepClassifier.fit-380"><span class="linenos">380</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-381"><a href="#LazyDeepClassifier.fit-381"><span class="linenos">381</span></a>
</span><span id="LazyDeepClassifier.fit-382"><a href="#LazyDeepClassifier.fit-382"><span class="linenos">382</span></a>                    <span class="n">layer_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-383"><a href="#LazyDeepClassifier.fit-383"><span class="linenos">383</span></a>
</span><span id="LazyDeepClassifier.fit-384"><a href="#LazyDeepClassifier.fit-384"><span class="linenos">384</span></a>                    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">):</span>
</span><span id="LazyDeepClassifier.fit-385"><a href="#LazyDeepClassifier.fit-385"><span class="linenos">385</span></a>                        <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-386"><a href="#LazyDeepClassifier.fit-386"><span class="linenos">386</span></a>                            <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-387"><a href="#LazyDeepClassifier.fit-387"><span class="linenos">387</span></a>                                <span class="n">obj</span><span class="o">=</span><span class="n">layer_clf</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-388"><a href="#LazyDeepClassifier.fit-388"><span class="linenos">388</span></a>                                <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-389"><a href="#LazyDeepClassifier.fit-389"><span class="linenos">389</span></a>                                <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-390"><a href="#LazyDeepClassifier.fit-390"><span class="linenos">390</span></a>                                <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-391"><a href="#LazyDeepClassifier.fit-391"><span class="linenos">391</span></a>                                <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-392"><a href="#LazyDeepClassifier.fit-392"><span class="linenos">392</span></a>                                <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-393"><a href="#LazyDeepClassifier.fit-393"><span class="linenos">393</span></a>                                <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-394"><a href="#LazyDeepClassifier.fit-394"><span class="linenos">394</span></a>                                <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-395"><a href="#LazyDeepClassifier.fit-395"><span class="linenos">395</span></a>                                <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-396"><a href="#LazyDeepClassifier.fit-396"><span class="linenos">396</span></a>                                <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-397"><a href="#LazyDeepClassifier.fit-397"><span class="linenos">397</span></a>                                <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-398"><a href="#LazyDeepClassifier.fit-398"><span class="linenos">398</span></a>                                <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-399"><a href="#LazyDeepClassifier.fit-399"><span class="linenos">399</span></a>                                <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-400"><a href="#LazyDeepClassifier.fit-400"><span class="linenos">400</span></a>                                <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-401"><a href="#LazyDeepClassifier.fit-401"><span class="linenos">401</span></a>                                <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-402"><a href="#LazyDeepClassifier.fit-402"><span class="linenos">402</span></a>                                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-403"><a href="#LazyDeepClassifier.fit-403"><span class="linenos">403</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-404"><a href="#LazyDeepClassifier.fit-404"><span class="linenos">404</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-405"><a href="#LazyDeepClassifier.fit-405"><span class="linenos">405</span></a>
</span><span id="LazyDeepClassifier.fit-406"><a href="#LazyDeepClassifier.fit-406"><span class="linenos">406</span></a>                    <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-407"><a href="#LazyDeepClassifier.fit-407"><span class="linenos">407</span></a>                        <span class="p">[</span>
</span><span id="LazyDeepClassifier.fit-408"><a href="#LazyDeepClassifier.fit-408"><span class="linenos">408</span></a>                            <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyDeepClassifier.fit-409"><a href="#LazyDeepClassifier.fit-409"><span class="linenos">409</span></a>                            <span class="p">(</span><span class="s2">&quot;classifier&quot;</span><span class="p">,</span> <span class="n">layer_clf</span><span class="p">),</span>
</span><span id="LazyDeepClassifier.fit-410"><a href="#LazyDeepClassifier.fit-410"><span class="linenos">410</span></a>                        <span class="p">]</span>
</span><span id="LazyDeepClassifier.fit-411"><a href="#LazyDeepClassifier.fit-411"><span class="linenos">411</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-412"><a href="#LazyDeepClassifier.fit-412"><span class="linenos">412</span></a>
</span><span id="LazyDeepClassifier.fit-413"><a href="#LazyDeepClassifier.fit-413"><span class="linenos">413</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-414"><a href="#LazyDeepClassifier.fit-414"><span class="linenos">414</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyDeepClassifier.fit-415"><a href="#LazyDeepClassifier.fit-415"><span class="linenos">415</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-416"><a href="#LazyDeepClassifier.fit-416"><span class="linenos">416</span></a>                    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-417"><a href="#LazyDeepClassifier.fit-417"><span class="linenos">417</span></a>                    <span class="n">b_accuracy</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-418"><a href="#LazyDeepClassifier.fit-418"><span class="linenos">418</span></a>                    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-419"><a href="#LazyDeepClassifier.fit-419"><span class="linenos">419</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-420"><a href="#LazyDeepClassifier.fit-420"><span class="linenos">420</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-421"><a href="#LazyDeepClassifier.fit-421"><span class="linenos">421</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-422"><a href="#LazyDeepClassifier.fit-422"><span class="linenos">422</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LazyDeepClassifier.fit-423"><a href="#LazyDeepClassifier.fit-423"><span class="linenos">423</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-424"><a href="#LazyDeepClassifier.fit-424"><span class="linenos">424</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROC AUC couldn&#39;t be calculated for &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-425"><a href="#LazyDeepClassifier.fit-425"><span class="linenos">425</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-426"><a href="#LazyDeepClassifier.fit-426"><span class="linenos">426</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-427"><a href="#LazyDeepClassifier.fit-427"><span class="linenos">427</span></a>                    <span class="n">Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-428"><a href="#LazyDeepClassifier.fit-428"><span class="linenos">428</span></a>                    <span class="n">B_Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_accuracy</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-429"><a href="#LazyDeepClassifier.fit-429"><span class="linenos">429</span></a>                    <span class="n">ROC_AUC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-430"><a href="#LazyDeepClassifier.fit-430"><span class="linenos">430</span></a>                    <span class="n">F1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-431"><a href="#LazyDeepClassifier.fit-431"><span class="linenos">431</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-432"><a href="#LazyDeepClassifier.fit-432"><span class="linenos">432</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-433"><a href="#LazyDeepClassifier.fit-433"><span class="linenos">433</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-434"><a href="#LazyDeepClassifier.fit-434"><span class="linenos">434</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-435"><a href="#LazyDeepClassifier.fit-435"><span class="linenos">435</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-436"><a href="#LazyDeepClassifier.fit-436"><span class="linenos">436</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-437"><a href="#LazyDeepClassifier.fit-437"><span class="linenos">437</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-438"><a href="#LazyDeepClassifier.fit-438"><span class="linenos">438</span></a>                                <span class="p">{</span>
</span><span id="LazyDeepClassifier.fit-439"><a href="#LazyDeepClassifier.fit-439"><span class="linenos">439</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-440"><a href="#LazyDeepClassifier.fit-440"><span class="linenos">440</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-441"><a href="#LazyDeepClassifier.fit-441"><span class="linenos">441</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-442"><a href="#LazyDeepClassifier.fit-442"><span class="linenos">442</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-443"><a href="#LazyDeepClassifier.fit-443"><span class="linenos">443</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-444"><a href="#LazyDeepClassifier.fit-444"><span class="linenos">444</span></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">custom_metric</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-445"><a href="#LazyDeepClassifier.fit-445"><span class="linenos">445</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-446"><a href="#LazyDeepClassifier.fit-446"><span class="linenos">446</span></a>                                <span class="p">}</span>
</span><span id="LazyDeepClassifier.fit-447"><a href="#LazyDeepClassifier.fit-447"><span class="linenos">447</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-448"><a href="#LazyDeepClassifier.fit-448"><span class="linenos">448</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-449"><a href="#LazyDeepClassifier.fit-449"><span class="linenos">449</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-450"><a href="#LazyDeepClassifier.fit-450"><span class="linenos">450</span></a>                                <span class="p">{</span>
</span><span id="LazyDeepClassifier.fit-451"><a href="#LazyDeepClassifier.fit-451"><span class="linenos">451</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-452"><a href="#LazyDeepClassifier.fit-452"><span class="linenos">452</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-453"><a href="#LazyDeepClassifier.fit-453"><span class="linenos">453</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-454"><a href="#LazyDeepClassifier.fit-454"><span class="linenos">454</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-455"><a href="#LazyDeepClassifier.fit-455"><span class="linenos">455</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-456"><a href="#LazyDeepClassifier.fit-456"><span class="linenos">456</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-457"><a href="#LazyDeepClassifier.fit-457"><span class="linenos">457</span></a>                                <span class="p">}</span>
</span><span id="LazyDeepClassifier.fit-458"><a href="#LazyDeepClassifier.fit-458"><span class="linenos">458</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-459"><a href="#LazyDeepClassifier.fit-459"><span class="linenos">459</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-460"><a href="#LazyDeepClassifier.fit-460"><span class="linenos">460</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyDeepClassifier.fit-461"><a href="#LazyDeepClassifier.fit-461"><span class="linenos">461</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-462"><a href="#LazyDeepClassifier.fit-462"><span class="linenos">462</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-463"><a href="#LazyDeepClassifier.fit-463"><span class="linenos">463</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-464"><a href="#LazyDeepClassifier.fit-464"><span class="linenos">464</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-465"><a href="#LazyDeepClassifier.fit-465"><span class="linenos">465</span></a>
</span><span id="LazyDeepClassifier.fit-466"><a href="#LazyDeepClassifier.fit-466"><span class="linenos">466</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># no preprocessing</span>
</span><span id="LazyDeepClassifier.fit-467"><a href="#LazyDeepClassifier.fit-467"><span class="linenos">467</span></a>
</span><span id="LazyDeepClassifier.fit-468"><a href="#LazyDeepClassifier.fit-468"><span class="linenos">468</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepClassifier.fit-469"><a href="#LazyDeepClassifier.fit-469"><span class="linenos">469</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepClassifier.fit-470"><a href="#LazyDeepClassifier.fit-470"><span class="linenos">470</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-471"><a href="#LazyDeepClassifier.fit-471"><span class="linenos">471</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepClassifier.fit-472"><a href="#LazyDeepClassifier.fit-472"><span class="linenos">472</span></a>                        <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-473"><a href="#LazyDeepClassifier.fit-473"><span class="linenos">473</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">),</span>
</span><span id="LazyDeepClassifier.fit-474"><a href="#LazyDeepClassifier.fit-474"><span class="linenos">474</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-475"><a href="#LazyDeepClassifier.fit-475"><span class="linenos">475</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-476"><a href="#LazyDeepClassifier.fit-476"><span class="linenos">476</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-477"><a href="#LazyDeepClassifier.fit-477"><span class="linenos">477</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-478"><a href="#LazyDeepClassifier.fit-478"><span class="linenos">478</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-479"><a href="#LazyDeepClassifier.fit-479"><span class="linenos">479</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-480"><a href="#LazyDeepClassifier.fit-480"><span class="linenos">480</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-481"><a href="#LazyDeepClassifier.fit-481"><span class="linenos">481</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-482"><a href="#LazyDeepClassifier.fit-482"><span class="linenos">482</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-483"><a href="#LazyDeepClassifier.fit-483"><span class="linenos">483</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-484"><a href="#LazyDeepClassifier.fit-484"><span class="linenos">484</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-485"><a href="#LazyDeepClassifier.fit-485"><span class="linenos">485</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-486"><a href="#LazyDeepClassifier.fit-486"><span class="linenos">486</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-487"><a href="#LazyDeepClassifier.fit-487"><span class="linenos">487</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-488"><a href="#LazyDeepClassifier.fit-488"><span class="linenos">488</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-489"><a href="#LazyDeepClassifier.fit-489"><span class="linenos">489</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-490"><a href="#LazyDeepClassifier.fit-490"><span class="linenos">490</span></a>
</span><span id="LazyDeepClassifier.fit-491"><a href="#LazyDeepClassifier.fit-491"><span class="linenos">491</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-492"><a href="#LazyDeepClassifier.fit-492"><span class="linenos">492</span></a>                        <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-493"><a href="#LazyDeepClassifier.fit-493"><span class="linenos">493</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyDeepClassifier.fit-494"><a href="#LazyDeepClassifier.fit-494"><span class="linenos">494</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-495"><a href="#LazyDeepClassifier.fit-495"><span class="linenos">495</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-496"><a href="#LazyDeepClassifier.fit-496"><span class="linenos">496</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-497"><a href="#LazyDeepClassifier.fit-497"><span class="linenos">497</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-498"><a href="#LazyDeepClassifier.fit-498"><span class="linenos">498</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-499"><a href="#LazyDeepClassifier.fit-499"><span class="linenos">499</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-500"><a href="#LazyDeepClassifier.fit-500"><span class="linenos">500</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-501"><a href="#LazyDeepClassifier.fit-501"><span class="linenos">501</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-502"><a href="#LazyDeepClassifier.fit-502"><span class="linenos">502</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-503"><a href="#LazyDeepClassifier.fit-503"><span class="linenos">503</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-504"><a href="#LazyDeepClassifier.fit-504"><span class="linenos">504</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-505"><a href="#LazyDeepClassifier.fit-505"><span class="linenos">505</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-506"><a href="#LazyDeepClassifier.fit-506"><span class="linenos">506</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-507"><a href="#LazyDeepClassifier.fit-507"><span class="linenos">507</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-508"><a href="#LazyDeepClassifier.fit-508"><span class="linenos">508</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-509"><a href="#LazyDeepClassifier.fit-509"><span class="linenos">509</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-510"><a href="#LazyDeepClassifier.fit-510"><span class="linenos">510</span></a>
</span><span id="LazyDeepClassifier.fit-511"><a href="#LazyDeepClassifier.fit-511"><span class="linenos">511</span></a>                    <span class="n">layer_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-512"><a href="#LazyDeepClassifier.fit-512"><span class="linenos">512</span></a>
</span><span id="LazyDeepClassifier.fit-513"><a href="#LazyDeepClassifier.fit-513"><span class="linenos">513</span></a>                    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">):</span>
</span><span id="LazyDeepClassifier.fit-514"><a href="#LazyDeepClassifier.fit-514"><span class="linenos">514</span></a>                        <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-515"><a href="#LazyDeepClassifier.fit-515"><span class="linenos">515</span></a>                            <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-516"><a href="#LazyDeepClassifier.fit-516"><span class="linenos">516</span></a>                                <span class="n">obj</span><span class="o">=</span><span class="n">layer_clf</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-517"><a href="#LazyDeepClassifier.fit-517"><span class="linenos">517</span></a>                                <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-518"><a href="#LazyDeepClassifier.fit-518"><span class="linenos">518</span></a>                                <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-519"><a href="#LazyDeepClassifier.fit-519"><span class="linenos">519</span></a>                                <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-520"><a href="#LazyDeepClassifier.fit-520"><span class="linenos">520</span></a>                                <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-521"><a href="#LazyDeepClassifier.fit-521"><span class="linenos">521</span></a>                                <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-522"><a href="#LazyDeepClassifier.fit-522"><span class="linenos">522</span></a>                                <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-523"><a href="#LazyDeepClassifier.fit-523"><span class="linenos">523</span></a>                                <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-524"><a href="#LazyDeepClassifier.fit-524"><span class="linenos">524</span></a>                                <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-525"><a href="#LazyDeepClassifier.fit-525"><span class="linenos">525</span></a>                                <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-526"><a href="#LazyDeepClassifier.fit-526"><span class="linenos">526</span></a>                                <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-527"><a href="#LazyDeepClassifier.fit-527"><span class="linenos">527</span></a>                                <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-528"><a href="#LazyDeepClassifier.fit-528"><span class="linenos">528</span></a>                                <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-529"><a href="#LazyDeepClassifier.fit-529"><span class="linenos">529</span></a>                                <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-530"><a href="#LazyDeepClassifier.fit-530"><span class="linenos">530</span></a>                                <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-531"><a href="#LazyDeepClassifier.fit-531"><span class="linenos">531</span></a>                                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-532"><a href="#LazyDeepClassifier.fit-532"><span class="linenos">532</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-533"><a href="#LazyDeepClassifier.fit-533"><span class="linenos">533</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-534"><a href="#LazyDeepClassifier.fit-534"><span class="linenos">534</span></a>
</span><span id="LazyDeepClassifier.fit-535"><a href="#LazyDeepClassifier.fit-535"><span class="linenos">535</span></a>                        <span class="c1"># layer_clf.fit(X_train, y_train)</span>
</span><span id="LazyDeepClassifier.fit-536"><a href="#LazyDeepClassifier.fit-536"><span class="linenos">536</span></a>
</span><span id="LazyDeepClassifier.fit-537"><a href="#LazyDeepClassifier.fit-537"><span class="linenos">537</span></a>                    <span class="n">layer_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-538"><a href="#LazyDeepClassifier.fit-538"><span class="linenos">538</span></a>
</span><span id="LazyDeepClassifier.fit-539"><a href="#LazyDeepClassifier.fit-539"><span class="linenos">539</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_clf</span>
</span><span id="LazyDeepClassifier.fit-540"><a href="#LazyDeepClassifier.fit-540"><span class="linenos">540</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">layer_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-541"><a href="#LazyDeepClassifier.fit-541"><span class="linenos">541</span></a>                    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-542"><a href="#LazyDeepClassifier.fit-542"><span class="linenos">542</span></a>                    <span class="n">b_accuracy</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-543"><a href="#LazyDeepClassifier.fit-543"><span class="linenos">543</span></a>                    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-544"><a href="#LazyDeepClassifier.fit-544"><span class="linenos">544</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-545"><a href="#LazyDeepClassifier.fit-545"><span class="linenos">545</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-546"><a href="#LazyDeepClassifier.fit-546"><span class="linenos">546</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-547"><a href="#LazyDeepClassifier.fit-547"><span class="linenos">547</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LazyDeepClassifier.fit-548"><a href="#LazyDeepClassifier.fit-548"><span class="linenos">548</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-549"><a href="#LazyDeepClassifier.fit-549"><span class="linenos">549</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROC AUC couldn&#39;t be calculated for &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-550"><a href="#LazyDeepClassifier.fit-550"><span class="linenos">550</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-551"><a href="#LazyDeepClassifier.fit-551"><span class="linenos">551</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-552"><a href="#LazyDeepClassifier.fit-552"><span class="linenos">552</span></a>                    <span class="n">Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-553"><a href="#LazyDeepClassifier.fit-553"><span class="linenos">553</span></a>                    <span class="n">B_Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_accuracy</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-554"><a href="#LazyDeepClassifier.fit-554"><span class="linenos">554</span></a>                    <span class="n">ROC_AUC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-555"><a href="#LazyDeepClassifier.fit-555"><span class="linenos">555</span></a>                    <span class="n">F1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-556"><a href="#LazyDeepClassifier.fit-556"><span class="linenos">556</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-557"><a href="#LazyDeepClassifier.fit-557"><span class="linenos">557</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-558"><a href="#LazyDeepClassifier.fit-558"><span class="linenos">558</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-559"><a href="#LazyDeepClassifier.fit-559"><span class="linenos">559</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-560"><a href="#LazyDeepClassifier.fit-560"><span class="linenos">560</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-561"><a href="#LazyDeepClassifier.fit-561"><span class="linenos">561</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-562"><a href="#LazyDeepClassifier.fit-562"><span class="linenos">562</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-563"><a href="#LazyDeepClassifier.fit-563"><span class="linenos">563</span></a>                                <span class="p">{</span>
</span><span id="LazyDeepClassifier.fit-564"><a href="#LazyDeepClassifier.fit-564"><span class="linenos">564</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-565"><a href="#LazyDeepClassifier.fit-565"><span class="linenos">565</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-566"><a href="#LazyDeepClassifier.fit-566"><span class="linenos">566</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-567"><a href="#LazyDeepClassifier.fit-567"><span class="linenos">567</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-568"><a href="#LazyDeepClassifier.fit-568"><span class="linenos">568</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-569"><a href="#LazyDeepClassifier.fit-569"><span class="linenos">569</span></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">custom_metric</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-570"><a href="#LazyDeepClassifier.fit-570"><span class="linenos">570</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-571"><a href="#LazyDeepClassifier.fit-571"><span class="linenos">571</span></a>                                <span class="p">}</span>
</span><span id="LazyDeepClassifier.fit-572"><a href="#LazyDeepClassifier.fit-572"><span class="linenos">572</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-573"><a href="#LazyDeepClassifier.fit-573"><span class="linenos">573</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-574"><a href="#LazyDeepClassifier.fit-574"><span class="linenos">574</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-575"><a href="#LazyDeepClassifier.fit-575"><span class="linenos">575</span></a>                                <span class="p">{</span>
</span><span id="LazyDeepClassifier.fit-576"><a href="#LazyDeepClassifier.fit-576"><span class="linenos">576</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-577"><a href="#LazyDeepClassifier.fit-577"><span class="linenos">577</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-578"><a href="#LazyDeepClassifier.fit-578"><span class="linenos">578</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-579"><a href="#LazyDeepClassifier.fit-579"><span class="linenos">579</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-580"><a href="#LazyDeepClassifier.fit-580"><span class="linenos">580</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-581"><a href="#LazyDeepClassifier.fit-581"><span class="linenos">581</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-582"><a href="#LazyDeepClassifier.fit-582"><span class="linenos">582</span></a>                                <span class="p">}</span>
</span><span id="LazyDeepClassifier.fit-583"><a href="#LazyDeepClassifier.fit-583"><span class="linenos">583</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-584"><a href="#LazyDeepClassifier.fit-584"><span class="linenos">584</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-585"><a href="#LazyDeepClassifier.fit-585"><span class="linenos">585</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyDeepClassifier.fit-586"><a href="#LazyDeepClassifier.fit-586"><span class="linenos">586</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-587"><a href="#LazyDeepClassifier.fit-587"><span class="linenos">587</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-588"><a href="#LazyDeepClassifier.fit-588"><span class="linenos">588</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-589"><a href="#LazyDeepClassifier.fit-589"><span class="linenos">589</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-590"><a href="#LazyDeepClassifier.fit-590"><span class="linenos">590</span></a>
</span><span id="LazyDeepClassifier.fit-591"><a href="#LazyDeepClassifier.fit-591"><span class="linenos">591</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-592"><a href="#LazyDeepClassifier.fit-592"><span class="linenos">592</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-593"><a href="#LazyDeepClassifier.fit-593"><span class="linenos">593</span></a>                <span class="p">{</span>
</span><span id="LazyDeepClassifier.fit-594"><a href="#LazyDeepClassifier.fit-594"><span class="linenos">594</span></a>                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-595"><a href="#LazyDeepClassifier.fit-595"><span class="linenos">595</span></a>                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-596"><a href="#LazyDeepClassifier.fit-596"><span class="linenos">596</span></a>                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">B_Accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-597"><a href="#LazyDeepClassifier.fit-597"><span class="linenos">597</span></a>                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">ROC_AUC</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-598"><a href="#LazyDeepClassifier.fit-598"><span class="linenos">598</span></a>                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-599"><a href="#LazyDeepClassifier.fit-599"><span class="linenos">599</span></a>                    <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-600"><a href="#LazyDeepClassifier.fit-600"><span class="linenos">600</span></a>                <span class="p">}</span>
</span><span id="LazyDeepClassifier.fit-601"><a href="#LazyDeepClassifier.fit-601"><span class="linenos">601</span></a>            <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-602"><a href="#LazyDeepClassifier.fit-602"><span class="linenos">602</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-603"><a href="#LazyDeepClassifier.fit-603"><span class="linenos">603</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-604"><a href="#LazyDeepClassifier.fit-604"><span class="linenos">604</span></a>                <span class="p">{</span>
</span><span id="LazyDeepClassifier.fit-605"><a href="#LazyDeepClassifier.fit-605"><span class="linenos">605</span></a>                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-606"><a href="#LazyDeepClassifier.fit-606"><span class="linenos">606</span></a>                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-607"><a href="#LazyDeepClassifier.fit-607"><span class="linenos">607</span></a>                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">B_Accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-608"><a href="#LazyDeepClassifier.fit-608"><span class="linenos">608</span></a>                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">ROC_AUC</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-609"><a href="#LazyDeepClassifier.fit-609"><span class="linenos">609</span></a>                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-610"><a href="#LazyDeepClassifier.fit-610"><span class="linenos">610</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">CUSTOM_METRIC</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-611"><a href="#LazyDeepClassifier.fit-611"><span class="linenos">611</span></a>                    <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-612"><a href="#LazyDeepClassifier.fit-612"><span class="linenos">612</span></a>                <span class="p">}</span>
</span><span id="LazyDeepClassifier.fit-613"><a href="#LazyDeepClassifier.fit-613"><span class="linenos">613</span></a>            <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-614"><a href="#LazyDeepClassifier.fit-614"><span class="linenos">614</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_by</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-615"><a href="#LazyDeepClassifier.fit-615"><span class="linenos">615</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyDeepClassifier.fit-616"><a href="#LazyDeepClassifier.fit-616"><span class="linenos">616</span></a>        <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-617"><a href="#LazyDeepClassifier.fit-617"><span class="linenos">617</span></a>
</span><span id="LazyDeepClassifier.fit-618"><a href="#LazyDeepClassifier.fit-618"><span class="linenos">618</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-619"><a href="#LazyDeepClassifier.fit-619"><span class="linenos">619</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-620"><a href="#LazyDeepClassifier.fit-620"><span class="linenos">620</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span></pre></div>


            <div class="docstring"><p>Fit classifiers to X_train and y_train, predict and score on X_test,
y_test.</p>

<p>Parameters:</p>

<pre><code>X_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.

y_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

y_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.
</code></pre>

<p>Returns:</p>

<pre><code>scores: Pandas DataFrame
    Returns metrics of all the models in a Pandas DataFrame.

predictions: Pandas DataFrame
    Returns predictions of all the models in a Pandas DataFrame.
</code></pre>
</div>


                                </div>
                                <div id="LazyDeepClassifier.provide_models" class="classattr">
                                            <input id="LazyDeepClassifier.provide_models-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">provide_models</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">y_train</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyDeepClassifier.provide_models-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepClassifier.provide_models"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepClassifier.provide_models-622"><a href="#LazyDeepClassifier.provide_models-622"><span class="linenos">622</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyDeepClassifier.provide_models-623"><a href="#LazyDeepClassifier.provide_models-623"><span class="linenos">623</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all the model objects trained. If fit hasn&#39;t been called yet,</span>
</span><span id="LazyDeepClassifier.provide_models-624"><a href="#LazyDeepClassifier.provide_models-624"><span class="linenos">624</span></a><span class="sd">        then it&#39;s called to return the models.</span>
</span><span id="LazyDeepClassifier.provide_models-625"><a href="#LazyDeepClassifier.provide_models-625"><span class="linenos">625</span></a>
</span><span id="LazyDeepClassifier.provide_models-626"><a href="#LazyDeepClassifier.provide_models-626"><span class="linenos">626</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepClassifier.provide_models-627"><a href="#LazyDeepClassifier.provide_models-627"><span class="linenos">627</span></a>
</span><span id="LazyDeepClassifier.provide_models-628"><a href="#LazyDeepClassifier.provide_models-628"><span class="linenos">628</span></a><span class="sd">        X_train: array-like,</span>
</span><span id="LazyDeepClassifier.provide_models-629"><a href="#LazyDeepClassifier.provide_models-629"><span class="linenos">629</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier.provide_models-630"><a href="#LazyDeepClassifier.provide_models-630"><span class="linenos">630</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyDeepClassifier.provide_models-631"><a href="#LazyDeepClassifier.provide_models-631"><span class="linenos">631</span></a>
</span><span id="LazyDeepClassifier.provide_models-632"><a href="#LazyDeepClassifier.provide_models-632"><span class="linenos">632</span></a><span class="sd">        X_test: array-like,</span>
</span><span id="LazyDeepClassifier.provide_models-633"><a href="#LazyDeepClassifier.provide_models-633"><span class="linenos">633</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier.provide_models-634"><a href="#LazyDeepClassifier.provide_models-634"><span class="linenos">634</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyDeepClassifier.provide_models-635"><a href="#LazyDeepClassifier.provide_models-635"><span class="linenos">635</span></a>
</span><span id="LazyDeepClassifier.provide_models-636"><a href="#LazyDeepClassifier.provide_models-636"><span class="linenos">636</span></a><span class="sd">        y_train: array-like,</span>
</span><span id="LazyDeepClassifier.provide_models-637"><a href="#LazyDeepClassifier.provide_models-637"><span class="linenos">637</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier.provide_models-638"><a href="#LazyDeepClassifier.provide_models-638"><span class="linenos">638</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyDeepClassifier.provide_models-639"><a href="#LazyDeepClassifier.provide_models-639"><span class="linenos">639</span></a>
</span><span id="LazyDeepClassifier.provide_models-640"><a href="#LazyDeepClassifier.provide_models-640"><span class="linenos">640</span></a><span class="sd">        y_test: array-like,</span>
</span><span id="LazyDeepClassifier.provide_models-641"><a href="#LazyDeepClassifier.provide_models-641"><span class="linenos">641</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier.provide_models-642"><a href="#LazyDeepClassifier.provide_models-642"><span class="linenos">642</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyDeepClassifier.provide_models-643"><a href="#LazyDeepClassifier.provide_models-643"><span class="linenos">643</span></a>
</span><span id="LazyDeepClassifier.provide_models-644"><a href="#LazyDeepClassifier.provide_models-644"><span class="linenos">644</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepClassifier.provide_models-645"><a href="#LazyDeepClassifier.provide_models-645"><span class="linenos">645</span></a>
</span><span id="LazyDeepClassifier.provide_models-646"><a href="#LazyDeepClassifier.provide_models-646"><span class="linenos">646</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyDeepClassifier.provide_models-647"><a href="#LazyDeepClassifier.provide_models-647"><span class="linenos">647</span></a><span class="sd">                Returns a dictionary with each model&#39;s pipeline as value</span>
</span><span id="LazyDeepClassifier.provide_models-648"><a href="#LazyDeepClassifier.provide_models-648"><span class="linenos">648</span></a><span class="sd">                and key = name of the model.</span>
</span><span id="LazyDeepClassifier.provide_models-649"><a href="#LazyDeepClassifier.provide_models-649"><span class="linenos">649</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepClassifier.provide_models-650"><a href="#LazyDeepClassifier.provide_models-650"><span class="linenos">650</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.provide_models-651"><a href="#LazyDeepClassifier.provide_models-651"><span class="linenos">651</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.provide_models-652"><a href="#LazyDeepClassifier.provide_models-652"><span class="linenos">652</span></a>
</span><span id="LazyDeepClassifier.provide_models-653"><a href="#LazyDeepClassifier.provide_models-653"><span class="linenos">653</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>Returns all the model objects trained. If fit hasn't been called yet,
then it's called to return the models.</p>

<p>Parameters:</p>

<p>X_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.</p>

<p>X_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.</p>

<p>y_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.</p>

<p>y_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.</p>

<p>Returns:</p>

<pre><code>models: dict-object,
    Returns a dictionary with each model's pipeline as value
    and key = name of the model.
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="LazyDeepRegressor">
                            <input id="LazyDeepRegressor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LazyDeepRegressor</span><wbr>(<span class="base">nnetsauce.custom.custom.Custom</span>, <span class="base">sklearn.base.RegressorMixin</span>):

                <label class="view-source-button" for="LazyDeepRegressor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepRegressor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepRegressor-83"><a href="#LazyDeepRegressor-83"><span class="linenos"> 83</span></a><span class="k">class</span> <span class="nc">LazyDeepRegressor</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">RegressorMixin</span><span class="p">):</span>
</span><span id="LazyDeepRegressor-84"><a href="#LazyDeepRegressor-84"><span class="linenos"> 84</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyDeepRegressor-85"><a href="#LazyDeepRegressor-85"><span class="linenos"> 85</span></a><span class="sd">        Fitting -- almost -- all the regression algorithms with layers of</span>
</span><span id="LazyDeepRegressor-86"><a href="#LazyDeepRegressor-86"><span class="linenos"> 86</span></a><span class="sd">        nnetsauce&#39;s CustomRegressor and returning their scores.</span>
</span><span id="LazyDeepRegressor-87"><a href="#LazyDeepRegressor-87"><span class="linenos"> 87</span></a>
</span><span id="LazyDeepRegressor-88"><a href="#LazyDeepRegressor-88"><span class="linenos"> 88</span></a><span class="sd">    Parameters:</span>
</span><span id="LazyDeepRegressor-89"><a href="#LazyDeepRegressor-89"><span class="linenos"> 89</span></a>
</span><span id="LazyDeepRegressor-90"><a href="#LazyDeepRegressor-90"><span class="linenos"> 90</span></a><span class="sd">        verbose: int, optional (default=0)</span>
</span><span id="LazyDeepRegressor-91"><a href="#LazyDeepRegressor-91"><span class="linenos"> 91</span></a><span class="sd">            Any positive number for verbosity.</span>
</span><span id="LazyDeepRegressor-92"><a href="#LazyDeepRegressor-92"><span class="linenos"> 92</span></a>
</span><span id="LazyDeepRegressor-93"><a href="#LazyDeepRegressor-93"><span class="linenos"> 93</span></a><span class="sd">        ignore_warnings: bool, optional (default=True)</span>
</span><span id="LazyDeepRegressor-94"><a href="#LazyDeepRegressor-94"><span class="linenos"> 94</span></a><span class="sd">            When set to True, the warning related to algorigms that are not able to run are ignored.</span>
</span><span id="LazyDeepRegressor-95"><a href="#LazyDeepRegressor-95"><span class="linenos"> 95</span></a>
</span><span id="LazyDeepRegressor-96"><a href="#LazyDeepRegressor-96"><span class="linenos"> 96</span></a><span class="sd">        custom_metric: function, optional (default=None)</span>
</span><span id="LazyDeepRegressor-97"><a href="#LazyDeepRegressor-97"><span class="linenos"> 97</span></a><span class="sd">            When function is provided, models are evaluated based on the custom evaluation metric provided.</span>
</span><span id="LazyDeepRegressor-98"><a href="#LazyDeepRegressor-98"><span class="linenos"> 98</span></a>
</span><span id="LazyDeepRegressor-99"><a href="#LazyDeepRegressor-99"><span class="linenos"> 99</span></a><span class="sd">        predictions: bool, optional (default=False)</span>
</span><span id="LazyDeepRegressor-100"><a href="#LazyDeepRegressor-100"><span class="linenos">100</span></a><span class="sd">            When set to True, the predictions of all the models models are returned as dataframe.</span>
</span><span id="LazyDeepRegressor-101"><a href="#LazyDeepRegressor-101"><span class="linenos">101</span></a>
</span><span id="LazyDeepRegressor-102"><a href="#LazyDeepRegressor-102"><span class="linenos">102</span></a><span class="sd">        sort_by: string, optional (default=&#39;Accuracy&#39;)</span>
</span><span id="LazyDeepRegressor-103"><a href="#LazyDeepRegressor-103"><span class="linenos">103</span></a><span class="sd">            Sort models by a metric. Available options are &#39;Accuracy&#39;, &#39;Balanced Accuracy&#39;, &#39;ROC AUC&#39;, &#39;F1 Score&#39;</span>
</span><span id="LazyDeepRegressor-104"><a href="#LazyDeepRegressor-104"><span class="linenos">104</span></a><span class="sd">            or a custom metric identified by its name and provided by custom_metric.</span>
</span><span id="LazyDeepRegressor-105"><a href="#LazyDeepRegressor-105"><span class="linenos">105</span></a>
</span><span id="LazyDeepRegressor-106"><a href="#LazyDeepRegressor-106"><span class="linenos">106</span></a><span class="sd">        random_state: int, optional (default=42)</span>
</span><span id="LazyDeepRegressor-107"><a href="#LazyDeepRegressor-107"><span class="linenos">107</span></a><span class="sd">            Reproducibiility seed.</span>
</span><span id="LazyDeepRegressor-108"><a href="#LazyDeepRegressor-108"><span class="linenos">108</span></a>
</span><span id="LazyDeepRegressor-109"><a href="#LazyDeepRegressor-109"><span class="linenos">109</span></a><span class="sd">        estimators: list, optional (default=&#39;all&#39;)</span>
</span><span id="LazyDeepRegressor-110"><a href="#LazyDeepRegressor-110"><span class="linenos">110</span></a><span class="sd">            list of Estimators names or just &#39;all&#39; (default=&#39;all&#39;)</span>
</span><span id="LazyDeepRegressor-111"><a href="#LazyDeepRegressor-111"><span class="linenos">111</span></a>
</span><span id="LazyDeepRegressor-112"><a href="#LazyDeepRegressor-112"><span class="linenos">112</span></a><span class="sd">        preprocess: bool</span>
</span><span id="LazyDeepRegressor-113"><a href="#LazyDeepRegressor-113"><span class="linenos">113</span></a><span class="sd">            preprocessing is done when set to True</span>
</span><span id="LazyDeepRegressor-114"><a href="#LazyDeepRegressor-114"><span class="linenos">114</span></a>
</span><span id="LazyDeepRegressor-115"><a href="#LazyDeepRegressor-115"><span class="linenos">115</span></a><span class="sd">        n_jobs : int, when possible, run in parallel</span>
</span><span id="LazyDeepRegressor-116"><a href="#LazyDeepRegressor-116"><span class="linenos">116</span></a><span class="sd">            For now, only used by individual models that support it.</span>
</span><span id="LazyDeepRegressor-117"><a href="#LazyDeepRegressor-117"><span class="linenos">117</span></a>
</span><span id="LazyDeepRegressor-118"><a href="#LazyDeepRegressor-118"><span class="linenos">118</span></a><span class="sd">        n_layers: int, optional (default=3)</span>
</span><span id="LazyDeepRegressor-119"><a href="#LazyDeepRegressor-119"><span class="linenos">119</span></a><span class="sd">            Number of layers of CustomRegressors to be used.</span>
</span><span id="LazyDeepRegressor-120"><a href="#LazyDeepRegressor-120"><span class="linenos">120</span></a>
</span><span id="LazyDeepRegressor-121"><a href="#LazyDeepRegressor-121"><span class="linenos">121</span></a><span class="sd">        All the other parameters are the same as CustomRegressor&#39;s.</span>
</span><span id="LazyDeepRegressor-122"><a href="#LazyDeepRegressor-122"><span class="linenos">122</span></a>
</span><span id="LazyDeepRegressor-123"><a href="#LazyDeepRegressor-123"><span class="linenos">123</span></a><span class="sd">    Examples:</span>
</span><span id="LazyDeepRegressor-124"><a href="#LazyDeepRegressor-124"><span class="linenos">124</span></a>
</span><span id="LazyDeepRegressor-125"><a href="#LazyDeepRegressor-125"><span class="linenos">125</span></a><span class="sd">        import nnetsauce as ns</span>
</span><span id="LazyDeepRegressor-126"><a href="#LazyDeepRegressor-126"><span class="linenos">126</span></a><span class="sd">        import numpy as np</span>
</span><span id="LazyDeepRegressor-127"><a href="#LazyDeepRegressor-127"><span class="linenos">127</span></a><span class="sd">        from sklearn import datasets</span>
</span><span id="LazyDeepRegressor-128"><a href="#LazyDeepRegressor-128"><span class="linenos">128</span></a><span class="sd">        from sklearn.utils import shuffle</span>
</span><span id="LazyDeepRegressor-129"><a href="#LazyDeepRegressor-129"><span class="linenos">129</span></a>
</span><span id="LazyDeepRegressor-130"><a href="#LazyDeepRegressor-130"><span class="linenos">130</span></a><span class="sd">        diabetes = datasets.load_diabetes()</span>
</span><span id="LazyDeepRegressor-131"><a href="#LazyDeepRegressor-131"><span class="linenos">131</span></a><span class="sd">        X, y = shuffle(diabetes.data, diabetes.target, random_state=13)</span>
</span><span id="LazyDeepRegressor-132"><a href="#LazyDeepRegressor-132"><span class="linenos">132</span></a><span class="sd">        X = X.astype(np.float32)</span>
</span><span id="LazyDeepRegressor-133"><a href="#LazyDeepRegressor-133"><span class="linenos">133</span></a>
</span><span id="LazyDeepRegressor-134"><a href="#LazyDeepRegressor-134"><span class="linenos">134</span></a><span class="sd">        offset = int(X.shape[0] * 0.9)</span>
</span><span id="LazyDeepRegressor-135"><a href="#LazyDeepRegressor-135"><span class="linenos">135</span></a><span class="sd">        X_train, y_train = X[:offset], y[:offset]</span>
</span><span id="LazyDeepRegressor-136"><a href="#LazyDeepRegressor-136"><span class="linenos">136</span></a><span class="sd">        X_test, y_test = X[offset:], y[offset:]</span>
</span><span id="LazyDeepRegressor-137"><a href="#LazyDeepRegressor-137"><span class="linenos">137</span></a>
</span><span id="LazyDeepRegressor-138"><a href="#LazyDeepRegressor-138"><span class="linenos">138</span></a><span class="sd">        reg = ns.LazyDeepRegressor(verbose=0, ignore_warnings=False, custom_metric=None)</span>
</span><span id="LazyDeepRegressor-139"><a href="#LazyDeepRegressor-139"><span class="linenos">139</span></a><span class="sd">        models, predictions = reg.fit(X_train, X_test, y_train, y_test)</span>
</span><span id="LazyDeepRegressor-140"><a href="#LazyDeepRegressor-140"><span class="linenos">140</span></a><span class="sd">        print(models)</span>
</span><span id="LazyDeepRegressor-141"><a href="#LazyDeepRegressor-141"><span class="linenos">141</span></a>
</span><span id="LazyDeepRegressor-142"><a href="#LazyDeepRegressor-142"><span class="linenos">142</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LazyDeepRegressor-143"><a href="#LazyDeepRegressor-143"><span class="linenos">143</span></a>
</span><span id="LazyDeepRegressor-144"><a href="#LazyDeepRegressor-144"><span class="linenos">144</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-145"><a href="#LazyDeepRegressor-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-146"><a href="#LazyDeepRegressor-146"><span class="linenos">146</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-147"><a href="#LazyDeepRegressor-147"><span class="linenos">147</span></a>        <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-148"><a href="#LazyDeepRegressor-148"><span class="linenos">148</span></a>        <span class="n">custom_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-149"><a href="#LazyDeepRegressor-149"><span class="linenos">149</span></a>        <span class="n">predictions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-150"><a href="#LazyDeepRegressor-150"><span class="linenos">150</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-151"><a href="#LazyDeepRegressor-151"><span class="linenos">151</span></a>        <span class="n">estimators</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-152"><a href="#LazyDeepRegressor-152"><span class="linenos">152</span></a>        <span class="n">preprocess</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-153"><a href="#LazyDeepRegressor-153"><span class="linenos">153</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-154"><a href="#LazyDeepRegressor-154"><span class="linenos">154</span></a>        <span class="c1"># Defining depth</span>
</span><span id="LazyDeepRegressor-155"><a href="#LazyDeepRegressor-155"><span class="linenos">155</span></a>        <span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-156"><a href="#LazyDeepRegressor-156"><span class="linenos">156</span></a>        <span class="c1"># CustomRegressor attributes</span>
</span><span id="LazyDeepRegressor-157"><a href="#LazyDeepRegressor-157"><span class="linenos">157</span></a>        <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-158"><a href="#LazyDeepRegressor-158"><span class="linenos">158</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-159"><a href="#LazyDeepRegressor-159"><span class="linenos">159</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-160"><a href="#LazyDeepRegressor-160"><span class="linenos">160</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-161"><a href="#LazyDeepRegressor-161"><span class="linenos">161</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-162"><a href="#LazyDeepRegressor-162"><span class="linenos">162</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-163"><a href="#LazyDeepRegressor-163"><span class="linenos">163</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-164"><a href="#LazyDeepRegressor-164"><span class="linenos">164</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-165"><a href="#LazyDeepRegressor-165"><span class="linenos">165</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-166"><a href="#LazyDeepRegressor-166"><span class="linenos">166</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-167"><a href="#LazyDeepRegressor-167"><span class="linenos">167</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-168"><a href="#LazyDeepRegressor-168"><span class="linenos">168</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="LazyDeepRegressor-169"><a href="#LazyDeepRegressor-169"><span class="linenos">169</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-170"><a href="#LazyDeepRegressor-170"><span class="linenos">170</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-171"><a href="#LazyDeepRegressor-171"><span class="linenos">171</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-172"><a href="#LazyDeepRegressor-172"><span class="linenos">172</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-173"><a href="#LazyDeepRegressor-173"><span class="linenos">173</span></a>    <span class="p">):</span>
</span><span id="LazyDeepRegressor-174"><a href="#LazyDeepRegressor-174"><span class="linenos">174</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="LazyDeepRegressor-175"><a href="#LazyDeepRegressor-175"><span class="linenos">175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="o">=</span> <span class="n">ignore_warnings</span>
</span><span id="LazyDeepRegressor-176"><a href="#LazyDeepRegressor-176"><span class="linenos">176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="o">=</span> <span class="n">custom_metric</span>
</span><span id="LazyDeepRegressor-177"><a href="#LazyDeepRegressor-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span>
</span><span id="LazyDeepRegressor-178"><a href="#LazyDeepRegressor-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepRegressor-179"><a href="#LazyDeepRegressor-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="LazyDeepRegressor-180"><a href="#LazyDeepRegressor-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">=</span> <span class="n">estimators</span>
</span><span id="LazyDeepRegressor-181"><a href="#LazyDeepRegressor-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="o">=</span> <span class="n">preprocess</span>
</span><span id="LazyDeepRegressor-182"><a href="#LazyDeepRegressor-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">=</span> <span class="n">n_layers</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="LazyDeepRegressor-183"><a href="#LazyDeepRegressor-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="LazyDeepRegressor-184"><a href="#LazyDeepRegressor-184"><span class="linenos">184</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-185"><a href="#LazyDeepRegressor-185"><span class="linenos">185</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-186"><a href="#LazyDeepRegressor-186"><span class="linenos">186</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-187"><a href="#LazyDeepRegressor-187"><span class="linenos">187</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-188"><a href="#LazyDeepRegressor-188"><span class="linenos">188</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-189"><a href="#LazyDeepRegressor-189"><span class="linenos">189</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-190"><a href="#LazyDeepRegressor-190"><span class="linenos">190</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-191"><a href="#LazyDeepRegressor-191"><span class="linenos">191</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-192"><a href="#LazyDeepRegressor-192"><span class="linenos">192</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-193"><a href="#LazyDeepRegressor-193"><span class="linenos">193</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-194"><a href="#LazyDeepRegressor-194"><span class="linenos">194</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-195"><a href="#LazyDeepRegressor-195"><span class="linenos">195</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-196"><a href="#LazyDeepRegressor-196"><span class="linenos">196</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-197"><a href="#LazyDeepRegressor-197"><span class="linenos">197</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-198"><a href="#LazyDeepRegressor-198"><span class="linenos">198</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-199"><a href="#LazyDeepRegressor-199"><span class="linenos">199</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-200"><a href="#LazyDeepRegressor-200"><span class="linenos">200</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-201"><a href="#LazyDeepRegressor-201"><span class="linenos">201</span></a>        <span class="p">)</span>
</span><span id="LazyDeepRegressor-202"><a href="#LazyDeepRegressor-202"><span class="linenos">202</span></a>
</span><span id="LazyDeepRegressor-203"><a href="#LazyDeepRegressor-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyDeepRegressor-204"><a href="#LazyDeepRegressor-204"><span class="linenos">204</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X_train and y_train, predict and score on X_test, y_test.</span>
</span><span id="LazyDeepRegressor-205"><a href="#LazyDeepRegressor-205"><span class="linenos">205</span></a>
</span><span id="LazyDeepRegressor-206"><a href="#LazyDeepRegressor-206"><span class="linenos">206</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepRegressor-207"><a href="#LazyDeepRegressor-207"><span class="linenos">207</span></a>
</span><span id="LazyDeepRegressor-208"><a href="#LazyDeepRegressor-208"><span class="linenos">208</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyDeepRegressor-209"><a href="#LazyDeepRegressor-209"><span class="linenos">209</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor-210"><a href="#LazyDeepRegressor-210"><span class="linenos">210</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor-211"><a href="#LazyDeepRegressor-211"><span class="linenos">211</span></a>
</span><span id="LazyDeepRegressor-212"><a href="#LazyDeepRegressor-212"><span class="linenos">212</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyDeepRegressor-213"><a href="#LazyDeepRegressor-213"><span class="linenos">213</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor-214"><a href="#LazyDeepRegressor-214"><span class="linenos">214</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor-215"><a href="#LazyDeepRegressor-215"><span class="linenos">215</span></a>
</span><span id="LazyDeepRegressor-216"><a href="#LazyDeepRegressor-216"><span class="linenos">216</span></a><span class="sd">            y_train : array-like,</span>
</span><span id="LazyDeepRegressor-217"><a href="#LazyDeepRegressor-217"><span class="linenos">217</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor-218"><a href="#LazyDeepRegressor-218"><span class="linenos">218</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor-219"><a href="#LazyDeepRegressor-219"><span class="linenos">219</span></a>
</span><span id="LazyDeepRegressor-220"><a href="#LazyDeepRegressor-220"><span class="linenos">220</span></a><span class="sd">            y_test : array-like,</span>
</span><span id="LazyDeepRegressor-221"><a href="#LazyDeepRegressor-221"><span class="linenos">221</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor-222"><a href="#LazyDeepRegressor-222"><span class="linenos">222</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor-223"><a href="#LazyDeepRegressor-223"><span class="linenos">223</span></a>
</span><span id="LazyDeepRegressor-224"><a href="#LazyDeepRegressor-224"><span class="linenos">224</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepRegressor-225"><a href="#LazyDeepRegressor-225"><span class="linenos">225</span></a><span class="sd">        -------</span>
</span><span id="LazyDeepRegressor-226"><a href="#LazyDeepRegressor-226"><span class="linenos">226</span></a><span class="sd">        scores:  Pandas DataFrame</span>
</span><span id="LazyDeepRegressor-227"><a href="#LazyDeepRegressor-227"><span class="linenos">227</span></a><span class="sd">            Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepRegressor-228"><a href="#LazyDeepRegressor-228"><span class="linenos">228</span></a>
</span><span id="LazyDeepRegressor-229"><a href="#LazyDeepRegressor-229"><span class="linenos">229</span></a><span class="sd">        predictions : Pandas DataFrame</span>
</span><span id="LazyDeepRegressor-230"><a href="#LazyDeepRegressor-230"><span class="linenos">230</span></a><span class="sd">            Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepRegressor-231"><a href="#LazyDeepRegressor-231"><span class="linenos">231</span></a>
</span><span id="LazyDeepRegressor-232"><a href="#LazyDeepRegressor-232"><span class="linenos">232</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepRegressor-233"><a href="#LazyDeepRegressor-233"><span class="linenos">233</span></a>        <span class="n">R2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor-234"><a href="#LazyDeepRegressor-234"><span class="linenos">234</span></a>        <span class="n">ADJR2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor-235"><a href="#LazyDeepRegressor-235"><span class="linenos">235</span></a>        <span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor-236"><a href="#LazyDeepRegressor-236"><span class="linenos">236</span></a>        <span class="c1"># WIN = []</span>
</span><span id="LazyDeepRegressor-237"><a href="#LazyDeepRegressor-237"><span class="linenos">237</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor-238"><a href="#LazyDeepRegressor-238"><span class="linenos">238</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor-239"><a href="#LazyDeepRegressor-239"><span class="linenos">239</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepRegressor-240"><a href="#LazyDeepRegressor-240"><span class="linenos">240</span></a>
</span><span id="LazyDeepRegressor-241"><a href="#LazyDeepRegressor-241"><span class="linenos">241</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-242"><a href="#LazyDeepRegressor-242"><span class="linenos">242</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor-243"><a href="#LazyDeepRegressor-243"><span class="linenos">243</span></a>
</span><span id="LazyDeepRegressor-244"><a href="#LazyDeepRegressor-244"><span class="linenos">244</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyDeepRegressor-245"><a href="#LazyDeepRegressor-245"><span class="linenos">245</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-246"><a href="#LazyDeepRegressor-246"><span class="linenos">246</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-247"><a href="#LazyDeepRegressor-247"><span class="linenos">247</span></a>
</span><span id="LazyDeepRegressor-248"><a href="#LazyDeepRegressor-248"><span class="linenos">248</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepRegressor-249"><a href="#LazyDeepRegressor-249"><span class="linenos">249</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepRegressor-250"><a href="#LazyDeepRegressor-250"><span class="linenos">250</span></a>
</span><span id="LazyDeepRegressor-251"><a href="#LazyDeepRegressor-251"><span class="linenos">251</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-252"><a href="#LazyDeepRegressor-252"><span class="linenos">252</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyDeepRegressor-253"><a href="#LazyDeepRegressor-253"><span class="linenos">253</span></a>        <span class="p">)</span>
</span><span id="LazyDeepRegressor-254"><a href="#LazyDeepRegressor-254"><span class="linenos">254</span></a>
</span><span id="LazyDeepRegressor-255"><a href="#LazyDeepRegressor-255"><span class="linenos">255</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-256"><a href="#LazyDeepRegressor-256"><span class="linenos">256</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-257"><a href="#LazyDeepRegressor-257"><span class="linenos">257</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepRegressor-258"><a href="#LazyDeepRegressor-258"><span class="linenos">258</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyDeepRegressor-259"><a href="#LazyDeepRegressor-259"><span class="linenos">259</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepRegressor-260"><a href="#LazyDeepRegressor-260"><span class="linenos">260</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-261"><a href="#LazyDeepRegressor-261"><span class="linenos">261</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-262"><a href="#LazyDeepRegressor-262"><span class="linenos">262</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-263"><a href="#LazyDeepRegressor-263"><span class="linenos">263</span></a>                    <span class="p">),</span>
</span><span id="LazyDeepRegressor-264"><a href="#LazyDeepRegressor-264"><span class="linenos">264</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepRegressor-265"><a href="#LazyDeepRegressor-265"><span class="linenos">265</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-266"><a href="#LazyDeepRegressor-266"><span class="linenos">266</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-267"><a href="#LazyDeepRegressor-267"><span class="linenos">267</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-268"><a href="#LazyDeepRegressor-268"><span class="linenos">268</span></a>                    <span class="p">),</span>
</span><span id="LazyDeepRegressor-269"><a href="#LazyDeepRegressor-269"><span class="linenos">269</span></a>                <span class="p">]</span>
</span><span id="LazyDeepRegressor-270"><a href="#LazyDeepRegressor-270"><span class="linenos">270</span></a>            <span class="p">)</span>
</span><span id="LazyDeepRegressor-271"><a href="#LazyDeepRegressor-271"><span class="linenos">271</span></a>
</span><span id="LazyDeepRegressor-272"><a href="#LazyDeepRegressor-272"><span class="linenos">272</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-273"><a href="#LazyDeepRegressor-273"><span class="linenos">273</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="n">DEEPREGRESSORS</span>
</span><span id="LazyDeepRegressor-274"><a href="#LazyDeepRegressor-274"><span class="linenos">274</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-275"><a href="#LazyDeepRegressor-275"><span class="linenos">275</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyDeepRegressor-276"><a href="#LazyDeepRegressor-276"><span class="linenos">276</span></a>                <span class="p">(</span><span class="s2">&quot;DeepCustomRegressor(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyDeepRegressor-277"><a href="#LazyDeepRegressor-277"><span class="linenos">277</span></a>                <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepRegressor-278"><a href="#LazyDeepRegressor-278"><span class="linenos">278</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepRegressor-279"><a href="#LazyDeepRegressor-279"><span class="linenos">279</span></a>                    <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-280"><a href="#LazyDeepRegressor-280"><span class="linenos">280</span></a>                    <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-281"><a href="#LazyDeepRegressor-281"><span class="linenos">281</span></a>                <span class="p">)</span>
</span><span id="LazyDeepRegressor-282"><a href="#LazyDeepRegressor-282"><span class="linenos">282</span></a>            <span class="p">]</span>
</span><span id="LazyDeepRegressor-283"><a href="#LazyDeepRegressor-283"><span class="linenos">283</span></a>
</span><span id="LazyDeepRegressor-284"><a href="#LazyDeepRegressor-284"><span class="linenos">284</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-285"><a href="#LazyDeepRegressor-285"><span class="linenos">285</span></a>
</span><span id="LazyDeepRegressor-286"><a href="#LazyDeepRegressor-286"><span class="linenos">286</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepRegressor-287"><a href="#LazyDeepRegressor-287"><span class="linenos">287</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepRegressor-288"><a href="#LazyDeepRegressor-288"><span class="linenos">288</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-289"><a href="#LazyDeepRegressor-289"><span class="linenos">289</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepRegressor-290"><a href="#LazyDeepRegressor-290"><span class="linenos">290</span></a>                        <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-291"><a href="#LazyDeepRegressor-291"><span class="linenos">291</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">),</span>
</span><span id="LazyDeepRegressor-292"><a href="#LazyDeepRegressor-292"><span class="linenos">292</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-293"><a href="#LazyDeepRegressor-293"><span class="linenos">293</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-294"><a href="#LazyDeepRegressor-294"><span class="linenos">294</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-295"><a href="#LazyDeepRegressor-295"><span class="linenos">295</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-296"><a href="#LazyDeepRegressor-296"><span class="linenos">296</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-297"><a href="#LazyDeepRegressor-297"><span class="linenos">297</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-298"><a href="#LazyDeepRegressor-298"><span class="linenos">298</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-299"><a href="#LazyDeepRegressor-299"><span class="linenos">299</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-300"><a href="#LazyDeepRegressor-300"><span class="linenos">300</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-301"><a href="#LazyDeepRegressor-301"><span class="linenos">301</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-302"><a href="#LazyDeepRegressor-302"><span class="linenos">302</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-303"><a href="#LazyDeepRegressor-303"><span class="linenos">303</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-304"><a href="#LazyDeepRegressor-304"><span class="linenos">304</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-305"><a href="#LazyDeepRegressor-305"><span class="linenos">305</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-306"><a href="#LazyDeepRegressor-306"><span class="linenos">306</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-307"><a href="#LazyDeepRegressor-307"><span class="linenos">307</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepRegressor-308"><a href="#LazyDeepRegressor-308"><span class="linenos">308</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-309"><a href="#LazyDeepRegressor-309"><span class="linenos">309</span></a>                        <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-310"><a href="#LazyDeepRegressor-310"><span class="linenos">310</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyDeepRegressor-311"><a href="#LazyDeepRegressor-311"><span class="linenos">311</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-312"><a href="#LazyDeepRegressor-312"><span class="linenos">312</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-313"><a href="#LazyDeepRegressor-313"><span class="linenos">313</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-314"><a href="#LazyDeepRegressor-314"><span class="linenos">314</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-315"><a href="#LazyDeepRegressor-315"><span class="linenos">315</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-316"><a href="#LazyDeepRegressor-316"><span class="linenos">316</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-317"><a href="#LazyDeepRegressor-317"><span class="linenos">317</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-318"><a href="#LazyDeepRegressor-318"><span class="linenos">318</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-319"><a href="#LazyDeepRegressor-319"><span class="linenos">319</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-320"><a href="#LazyDeepRegressor-320"><span class="linenos">320</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-321"><a href="#LazyDeepRegressor-321"><span class="linenos">321</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-322"><a href="#LazyDeepRegressor-322"><span class="linenos">322</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-323"><a href="#LazyDeepRegressor-323"><span class="linenos">323</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-324"><a href="#LazyDeepRegressor-324"><span class="linenos">324</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-325"><a href="#LazyDeepRegressor-325"><span class="linenos">325</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-326"><a href="#LazyDeepRegressor-326"><span class="linenos">326</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepRegressor-327"><a href="#LazyDeepRegressor-327"><span class="linenos">327</span></a>
</span><span id="LazyDeepRegressor-328"><a href="#LazyDeepRegressor-328"><span class="linenos">328</span></a>                    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">):</span>
</span><span id="LazyDeepRegressor-329"><a href="#LazyDeepRegressor-329"><span class="linenos">329</span></a>                        <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-330"><a href="#LazyDeepRegressor-330"><span class="linenos">330</span></a>                            <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-331"><a href="#LazyDeepRegressor-331"><span class="linenos">331</span></a>                                <span class="n">obj</span><span class="o">=</span><span class="n">layer_regr</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-332"><a href="#LazyDeepRegressor-332"><span class="linenos">332</span></a>                                <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-333"><a href="#LazyDeepRegressor-333"><span class="linenos">333</span></a>                                <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-334"><a href="#LazyDeepRegressor-334"><span class="linenos">334</span></a>                                <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-335"><a href="#LazyDeepRegressor-335"><span class="linenos">335</span></a>                                <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-336"><a href="#LazyDeepRegressor-336"><span class="linenos">336</span></a>                                <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-337"><a href="#LazyDeepRegressor-337"><span class="linenos">337</span></a>                                <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-338"><a href="#LazyDeepRegressor-338"><span class="linenos">338</span></a>                                <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-339"><a href="#LazyDeepRegressor-339"><span class="linenos">339</span></a>                                <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-340"><a href="#LazyDeepRegressor-340"><span class="linenos">340</span></a>                                <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-341"><a href="#LazyDeepRegressor-341"><span class="linenos">341</span></a>                                <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-342"><a href="#LazyDeepRegressor-342"><span class="linenos">342</span></a>                                <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-343"><a href="#LazyDeepRegressor-343"><span class="linenos">343</span></a>                                <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-344"><a href="#LazyDeepRegressor-344"><span class="linenos">344</span></a>                                <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-345"><a href="#LazyDeepRegressor-345"><span class="linenos">345</span></a>                                <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-346"><a href="#LazyDeepRegressor-346"><span class="linenos">346</span></a>                                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-347"><a href="#LazyDeepRegressor-347"><span class="linenos">347</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepRegressor-348"><a href="#LazyDeepRegressor-348"><span class="linenos">348</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepRegressor-349"><a href="#LazyDeepRegressor-349"><span class="linenos">349</span></a>
</span><span id="LazyDeepRegressor-350"><a href="#LazyDeepRegressor-350"><span class="linenos">350</span></a>                    <span class="n">layer_regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-351"><a href="#LazyDeepRegressor-351"><span class="linenos">351</span></a>
</span><span id="LazyDeepRegressor-352"><a href="#LazyDeepRegressor-352"><span class="linenos">352</span></a>                    <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-353"><a href="#LazyDeepRegressor-353"><span class="linenos">353</span></a>                        <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepRegressor-354"><a href="#LazyDeepRegressor-354"><span class="linenos">354</span></a>                            <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyDeepRegressor-355"><a href="#LazyDeepRegressor-355"><span class="linenos">355</span></a>                            <span class="p">(</span><span class="s2">&quot;regressor&quot;</span><span class="p">,</span> <span class="n">layer_regr</span><span class="p">),</span>
</span><span id="LazyDeepRegressor-356"><a href="#LazyDeepRegressor-356"><span class="linenos">356</span></a>                        <span class="p">]</span>
</span><span id="LazyDeepRegressor-357"><a href="#LazyDeepRegressor-357"><span class="linenos">357</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepRegressor-358"><a href="#LazyDeepRegressor-358"><span class="linenos">358</span></a>
</span><span id="LazyDeepRegressor-359"><a href="#LazyDeepRegressor-359"><span class="linenos">359</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-360"><a href="#LazyDeepRegressor-360"><span class="linenos">360</span></a>
</span><span id="LazyDeepRegressor-361"><a href="#LazyDeepRegressor-361"><span class="linenos">361</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyDeepRegressor-362"><a href="#LazyDeepRegressor-362"><span class="linenos">362</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-363"><a href="#LazyDeepRegressor-363"><span class="linenos">363</span></a>                    <span class="n">r_squared</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-364"><a href="#LazyDeepRegressor-364"><span class="linenos">364</span></a>                    <span class="n">adj_rsquared</span> <span class="o">=</span> <span class="n">adjusted_rsquared</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-365"><a href="#LazyDeepRegressor-365"><span class="linenos">365</span></a>                        <span class="n">r_squared</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LazyDeepRegressor-366"><a href="#LazyDeepRegressor-366"><span class="linenos">366</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepRegressor-367"><a href="#LazyDeepRegressor-367"><span class="linenos">367</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-368"><a href="#LazyDeepRegressor-368"><span class="linenos">368</span></a>
</span><span id="LazyDeepRegressor-369"><a href="#LazyDeepRegressor-369"><span class="linenos">369</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-370"><a href="#LazyDeepRegressor-370"><span class="linenos">370</span></a>                    <span class="n">R2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_squared</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-371"><a href="#LazyDeepRegressor-371"><span class="linenos">371</span></a>                    <span class="n">ADJR2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_rsquared</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-372"><a href="#LazyDeepRegressor-372"><span class="linenos">372</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-373"><a href="#LazyDeepRegressor-373"><span class="linenos">373</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-374"><a href="#LazyDeepRegressor-374"><span class="linenos">374</span></a>
</span><span id="LazyDeepRegressor-375"><a href="#LazyDeepRegressor-375"><span class="linenos">375</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-376"><a href="#LazyDeepRegressor-376"><span class="linenos">376</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-377"><a href="#LazyDeepRegressor-377"><span class="linenos">377</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-378"><a href="#LazyDeepRegressor-378"><span class="linenos">378</span></a>
</span><span id="LazyDeepRegressor-379"><a href="#LazyDeepRegressor-379"><span class="linenos">379</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-380"><a href="#LazyDeepRegressor-380"><span class="linenos">380</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepRegressor-381"><a href="#LazyDeepRegressor-381"><span class="linenos">381</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-382"><a href="#LazyDeepRegressor-382"><span class="linenos">382</span></a>                            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">r_squared</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-383"><a href="#LazyDeepRegressor-383"><span class="linenos">383</span></a>                            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">adj_rsquared</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-384"><a href="#LazyDeepRegressor-384"><span class="linenos">384</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-385"><a href="#LazyDeepRegressor-385"><span class="linenos">385</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-386"><a href="#LazyDeepRegressor-386"><span class="linenos">386</span></a>                        <span class="p">}</span>
</span><span id="LazyDeepRegressor-387"><a href="#LazyDeepRegressor-387"><span class="linenos">387</span></a>
</span><span id="LazyDeepRegressor-388"><a href="#LazyDeepRegressor-388"><span class="linenos">388</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-389"><a href="#LazyDeepRegressor-389"><span class="linenos">389</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepRegressor-390"><a href="#LazyDeepRegressor-390"><span class="linenos">390</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyDeepRegressor-391"><a href="#LazyDeepRegressor-391"><span class="linenos">391</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepRegressor-392"><a href="#LazyDeepRegressor-392"><span class="linenos">392</span></a>
</span><span id="LazyDeepRegressor-393"><a href="#LazyDeepRegressor-393"><span class="linenos">393</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-394"><a href="#LazyDeepRegressor-394"><span class="linenos">394</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-395"><a href="#LazyDeepRegressor-395"><span class="linenos">395</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyDeepRegressor-396"><a href="#LazyDeepRegressor-396"><span class="linenos">396</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-397"><a href="#LazyDeepRegressor-397"><span class="linenos">397</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-398"><a href="#LazyDeepRegressor-398"><span class="linenos">398</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-399"><a href="#LazyDeepRegressor-399"><span class="linenos">399</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-400"><a href="#LazyDeepRegressor-400"><span class="linenos">400</span></a>
</span><span id="LazyDeepRegressor-401"><a href="#LazyDeepRegressor-401"><span class="linenos">401</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># no preprocessing</span>
</span><span id="LazyDeepRegressor-402"><a href="#LazyDeepRegressor-402"><span class="linenos">402</span></a>
</span><span id="LazyDeepRegressor-403"><a href="#LazyDeepRegressor-403"><span class="linenos">403</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepRegressor-404"><a href="#LazyDeepRegressor-404"><span class="linenos">404</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepRegressor-405"><a href="#LazyDeepRegressor-405"><span class="linenos">405</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-406"><a href="#LazyDeepRegressor-406"><span class="linenos">406</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepRegressor-407"><a href="#LazyDeepRegressor-407"><span class="linenos">407</span></a>                        <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-408"><a href="#LazyDeepRegressor-408"><span class="linenos">408</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">),</span>
</span><span id="LazyDeepRegressor-409"><a href="#LazyDeepRegressor-409"><span class="linenos">409</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-410"><a href="#LazyDeepRegressor-410"><span class="linenos">410</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-411"><a href="#LazyDeepRegressor-411"><span class="linenos">411</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-412"><a href="#LazyDeepRegressor-412"><span class="linenos">412</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-413"><a href="#LazyDeepRegressor-413"><span class="linenos">413</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-414"><a href="#LazyDeepRegressor-414"><span class="linenos">414</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-415"><a href="#LazyDeepRegressor-415"><span class="linenos">415</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-416"><a href="#LazyDeepRegressor-416"><span class="linenos">416</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-417"><a href="#LazyDeepRegressor-417"><span class="linenos">417</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-418"><a href="#LazyDeepRegressor-418"><span class="linenos">418</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-419"><a href="#LazyDeepRegressor-419"><span class="linenos">419</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-420"><a href="#LazyDeepRegressor-420"><span class="linenos">420</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-421"><a href="#LazyDeepRegressor-421"><span class="linenos">421</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-422"><a href="#LazyDeepRegressor-422"><span class="linenos">422</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-423"><a href="#LazyDeepRegressor-423"><span class="linenos">423</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-424"><a href="#LazyDeepRegressor-424"><span class="linenos">424</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepRegressor-425"><a href="#LazyDeepRegressor-425"><span class="linenos">425</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-426"><a href="#LazyDeepRegressor-426"><span class="linenos">426</span></a>                        <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-427"><a href="#LazyDeepRegressor-427"><span class="linenos">427</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyDeepRegressor-428"><a href="#LazyDeepRegressor-428"><span class="linenos">428</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-429"><a href="#LazyDeepRegressor-429"><span class="linenos">429</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-430"><a href="#LazyDeepRegressor-430"><span class="linenos">430</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-431"><a href="#LazyDeepRegressor-431"><span class="linenos">431</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-432"><a href="#LazyDeepRegressor-432"><span class="linenos">432</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-433"><a href="#LazyDeepRegressor-433"><span class="linenos">433</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-434"><a href="#LazyDeepRegressor-434"><span class="linenos">434</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-435"><a href="#LazyDeepRegressor-435"><span class="linenos">435</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-436"><a href="#LazyDeepRegressor-436"><span class="linenos">436</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-437"><a href="#LazyDeepRegressor-437"><span class="linenos">437</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-438"><a href="#LazyDeepRegressor-438"><span class="linenos">438</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-439"><a href="#LazyDeepRegressor-439"><span class="linenos">439</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-440"><a href="#LazyDeepRegressor-440"><span class="linenos">440</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-441"><a href="#LazyDeepRegressor-441"><span class="linenos">441</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-442"><a href="#LazyDeepRegressor-442"><span class="linenos">442</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-443"><a href="#LazyDeepRegressor-443"><span class="linenos">443</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepRegressor-444"><a href="#LazyDeepRegressor-444"><span class="linenos">444</span></a>
</span><span id="LazyDeepRegressor-445"><a href="#LazyDeepRegressor-445"><span class="linenos">445</span></a>                    <span class="n">layer_regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-446"><a href="#LazyDeepRegressor-446"><span class="linenos">446</span></a>
</span><span id="LazyDeepRegressor-447"><a href="#LazyDeepRegressor-447"><span class="linenos">447</span></a>                    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">):</span>
</span><span id="LazyDeepRegressor-448"><a href="#LazyDeepRegressor-448"><span class="linenos">448</span></a>                        <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-449"><a href="#LazyDeepRegressor-449"><span class="linenos">449</span></a>                            <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-450"><a href="#LazyDeepRegressor-450"><span class="linenos">450</span></a>                                <span class="n">obj</span><span class="o">=</span><span class="n">layer_regr</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-451"><a href="#LazyDeepRegressor-451"><span class="linenos">451</span></a>                                <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-452"><a href="#LazyDeepRegressor-452"><span class="linenos">452</span></a>                                <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-453"><a href="#LazyDeepRegressor-453"><span class="linenos">453</span></a>                                <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-454"><a href="#LazyDeepRegressor-454"><span class="linenos">454</span></a>                                <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-455"><a href="#LazyDeepRegressor-455"><span class="linenos">455</span></a>                                <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-456"><a href="#LazyDeepRegressor-456"><span class="linenos">456</span></a>                                <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-457"><a href="#LazyDeepRegressor-457"><span class="linenos">457</span></a>                                <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-458"><a href="#LazyDeepRegressor-458"><span class="linenos">458</span></a>                                <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-459"><a href="#LazyDeepRegressor-459"><span class="linenos">459</span></a>                                <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-460"><a href="#LazyDeepRegressor-460"><span class="linenos">460</span></a>                                <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-461"><a href="#LazyDeepRegressor-461"><span class="linenos">461</span></a>                                <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-462"><a href="#LazyDeepRegressor-462"><span class="linenos">462</span></a>                                <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-463"><a href="#LazyDeepRegressor-463"><span class="linenos">463</span></a>                                <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-464"><a href="#LazyDeepRegressor-464"><span class="linenos">464</span></a>                                <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-465"><a href="#LazyDeepRegressor-465"><span class="linenos">465</span></a>                                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-466"><a href="#LazyDeepRegressor-466"><span class="linenos">466</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepRegressor-467"><a href="#LazyDeepRegressor-467"><span class="linenos">467</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepRegressor-468"><a href="#LazyDeepRegressor-468"><span class="linenos">468</span></a>
</span><span id="LazyDeepRegressor-469"><a href="#LazyDeepRegressor-469"><span class="linenos">469</span></a>                        <span class="c1"># layer_regr.fit(X_train, y_train)</span>
</span><span id="LazyDeepRegressor-470"><a href="#LazyDeepRegressor-470"><span class="linenos">470</span></a>
</span><span id="LazyDeepRegressor-471"><a href="#LazyDeepRegressor-471"><span class="linenos">471</span></a>                    <span class="n">layer_regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-472"><a href="#LazyDeepRegressor-472"><span class="linenos">472</span></a>
</span><span id="LazyDeepRegressor-473"><a href="#LazyDeepRegressor-473"><span class="linenos">473</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_regr</span>
</span><span id="LazyDeepRegressor-474"><a href="#LazyDeepRegressor-474"><span class="linenos">474</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">layer_regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-475"><a href="#LazyDeepRegressor-475"><span class="linenos">475</span></a>
</span><span id="LazyDeepRegressor-476"><a href="#LazyDeepRegressor-476"><span class="linenos">476</span></a>                    <span class="n">r_squared</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-477"><a href="#LazyDeepRegressor-477"><span class="linenos">477</span></a>                    <span class="n">adj_rsquared</span> <span class="o">=</span> <span class="n">adjusted_rsquared</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-478"><a href="#LazyDeepRegressor-478"><span class="linenos">478</span></a>                        <span class="n">r_squared</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LazyDeepRegressor-479"><a href="#LazyDeepRegressor-479"><span class="linenos">479</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepRegressor-480"><a href="#LazyDeepRegressor-480"><span class="linenos">480</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-481"><a href="#LazyDeepRegressor-481"><span class="linenos">481</span></a>
</span><span id="LazyDeepRegressor-482"><a href="#LazyDeepRegressor-482"><span class="linenos">482</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-483"><a href="#LazyDeepRegressor-483"><span class="linenos">483</span></a>                    <span class="n">R2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_squared</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-484"><a href="#LazyDeepRegressor-484"><span class="linenos">484</span></a>                    <span class="n">ADJR2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_rsquared</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-485"><a href="#LazyDeepRegressor-485"><span class="linenos">485</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-486"><a href="#LazyDeepRegressor-486"><span class="linenos">486</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-487"><a href="#LazyDeepRegressor-487"><span class="linenos">487</span></a>
</span><span id="LazyDeepRegressor-488"><a href="#LazyDeepRegressor-488"><span class="linenos">488</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-489"><a href="#LazyDeepRegressor-489"><span class="linenos">489</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-490"><a href="#LazyDeepRegressor-490"><span class="linenos">490</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-491"><a href="#LazyDeepRegressor-491"><span class="linenos">491</span></a>
</span><span id="LazyDeepRegressor-492"><a href="#LazyDeepRegressor-492"><span class="linenos">492</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-493"><a href="#LazyDeepRegressor-493"><span class="linenos">493</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepRegressor-494"><a href="#LazyDeepRegressor-494"><span class="linenos">494</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-495"><a href="#LazyDeepRegressor-495"><span class="linenos">495</span></a>                            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">r_squared</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-496"><a href="#LazyDeepRegressor-496"><span class="linenos">496</span></a>                            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">adj_rsquared</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-497"><a href="#LazyDeepRegressor-497"><span class="linenos">497</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-498"><a href="#LazyDeepRegressor-498"><span class="linenos">498</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-499"><a href="#LazyDeepRegressor-499"><span class="linenos">499</span></a>                        <span class="p">}</span>
</span><span id="LazyDeepRegressor-500"><a href="#LazyDeepRegressor-500"><span class="linenos">500</span></a>
</span><span id="LazyDeepRegressor-501"><a href="#LazyDeepRegressor-501"><span class="linenos">501</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-502"><a href="#LazyDeepRegressor-502"><span class="linenos">502</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepRegressor-503"><a href="#LazyDeepRegressor-503"><span class="linenos">503</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyDeepRegressor-504"><a href="#LazyDeepRegressor-504"><span class="linenos">504</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepRegressor-505"><a href="#LazyDeepRegressor-505"><span class="linenos">505</span></a>
</span><span id="LazyDeepRegressor-506"><a href="#LazyDeepRegressor-506"><span class="linenos">506</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-507"><a href="#LazyDeepRegressor-507"><span class="linenos">507</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-508"><a href="#LazyDeepRegressor-508"><span class="linenos">508</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyDeepRegressor-509"><a href="#LazyDeepRegressor-509"><span class="linenos">509</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-510"><a href="#LazyDeepRegressor-510"><span class="linenos">510</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-511"><a href="#LazyDeepRegressor-511"><span class="linenos">511</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-512"><a href="#LazyDeepRegressor-512"><span class="linenos">512</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-513"><a href="#LazyDeepRegressor-513"><span class="linenos">513</span></a>
</span><span id="LazyDeepRegressor-514"><a href="#LazyDeepRegressor-514"><span class="linenos">514</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepRegressor-515"><a href="#LazyDeepRegressor-515"><span class="linenos">515</span></a>            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-516"><a href="#LazyDeepRegressor-516"><span class="linenos">516</span></a>            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">ADJR2</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-517"><a href="#LazyDeepRegressor-517"><span class="linenos">517</span></a>            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">R2</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-518"><a href="#LazyDeepRegressor-518"><span class="linenos">518</span></a>            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-519"><a href="#LazyDeepRegressor-519"><span class="linenos">519</span></a>            <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-520"><a href="#LazyDeepRegressor-520"><span class="linenos">520</span></a>        <span class="p">}</span>
</span><span id="LazyDeepRegressor-521"><a href="#LazyDeepRegressor-521"><span class="linenos">521</span></a>
</span><span id="LazyDeepRegressor-522"><a href="#LazyDeepRegressor-522"><span class="linenos">522</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-523"><a href="#LazyDeepRegressor-523"><span class="linenos">523</span></a>            <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">CUSTOM_METRIC</span>
</span><span id="LazyDeepRegressor-524"><a href="#LazyDeepRegressor-524"><span class="linenos">524</span></a>
</span><span id="LazyDeepRegressor-525"><a href="#LazyDeepRegressor-525"><span class="linenos">525</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-526"><a href="#LazyDeepRegressor-526"><span class="linenos">526</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-527"><a href="#LazyDeepRegressor-527"><span class="linenos">527</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyDeepRegressor-528"><a href="#LazyDeepRegressor-528"><span class="linenos">528</span></a>        <span class="p">)</span>
</span><span id="LazyDeepRegressor-529"><a href="#LazyDeepRegressor-529"><span class="linenos">529</span></a>
</span><span id="LazyDeepRegressor-530"><a href="#LazyDeepRegressor-530"><span class="linenos">530</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-531"><a href="#LazyDeepRegressor-531"><span class="linenos">531</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-532"><a href="#LazyDeepRegressor-532"><span class="linenos">532</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span><span id="LazyDeepRegressor-533"><a href="#LazyDeepRegressor-533"><span class="linenos">533</span></a>
</span><span id="LazyDeepRegressor-534"><a href="#LazyDeepRegressor-534"><span class="linenos">534</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyDeepRegressor-535"><a href="#LazyDeepRegressor-535"><span class="linenos">535</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyDeepRegressor-536"><a href="#LazyDeepRegressor-536"><span class="linenos">536</span></a><span class="sd">        This function returns all the model objects trained in fit function.</span>
</span><span id="LazyDeepRegressor-537"><a href="#LazyDeepRegressor-537"><span class="linenos">537</span></a><span class="sd">        If fit is not called already, then we call fit and then return the models.</span>
</span><span id="LazyDeepRegressor-538"><a href="#LazyDeepRegressor-538"><span class="linenos">538</span></a>
</span><span id="LazyDeepRegressor-539"><a href="#LazyDeepRegressor-539"><span class="linenos">539</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepRegressor-540"><a href="#LazyDeepRegressor-540"><span class="linenos">540</span></a>
</span><span id="LazyDeepRegressor-541"><a href="#LazyDeepRegressor-541"><span class="linenos">541</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyDeepRegressor-542"><a href="#LazyDeepRegressor-542"><span class="linenos">542</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor-543"><a href="#LazyDeepRegressor-543"><span class="linenos">543</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor-544"><a href="#LazyDeepRegressor-544"><span class="linenos">544</span></a>
</span><span id="LazyDeepRegressor-545"><a href="#LazyDeepRegressor-545"><span class="linenos">545</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyDeepRegressor-546"><a href="#LazyDeepRegressor-546"><span class="linenos">546</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor-547"><a href="#LazyDeepRegressor-547"><span class="linenos">547</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor-548"><a href="#LazyDeepRegressor-548"><span class="linenos">548</span></a>
</span><span id="LazyDeepRegressor-549"><a href="#LazyDeepRegressor-549"><span class="linenos">549</span></a><span class="sd">            y_train : array-like,</span>
</span><span id="LazyDeepRegressor-550"><a href="#LazyDeepRegressor-550"><span class="linenos">550</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor-551"><a href="#LazyDeepRegressor-551"><span class="linenos">551</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor-552"><a href="#LazyDeepRegressor-552"><span class="linenos">552</span></a>
</span><span id="LazyDeepRegressor-553"><a href="#LazyDeepRegressor-553"><span class="linenos">553</span></a><span class="sd">            y_test : array-like,</span>
</span><span id="LazyDeepRegressor-554"><a href="#LazyDeepRegressor-554"><span class="linenos">554</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor-555"><a href="#LazyDeepRegressor-555"><span class="linenos">555</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor-556"><a href="#LazyDeepRegressor-556"><span class="linenos">556</span></a>
</span><span id="LazyDeepRegressor-557"><a href="#LazyDeepRegressor-557"><span class="linenos">557</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepRegressor-558"><a href="#LazyDeepRegressor-558"><span class="linenos">558</span></a>
</span><span id="LazyDeepRegressor-559"><a href="#LazyDeepRegressor-559"><span class="linenos">559</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyDeepRegressor-560"><a href="#LazyDeepRegressor-560"><span class="linenos">560</span></a><span class="sd">                Returns a dictionary with each model pipeline as value</span>
</span><span id="LazyDeepRegressor-561"><a href="#LazyDeepRegressor-561"><span class="linenos">561</span></a><span class="sd">                with key as name of models.</span>
</span><span id="LazyDeepRegressor-562"><a href="#LazyDeepRegressor-562"><span class="linenos">562</span></a>
</span><span id="LazyDeepRegressor-563"><a href="#LazyDeepRegressor-563"><span class="linenos">563</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepRegressor-564"><a href="#LazyDeepRegressor-564"><span class="linenos">564</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-565"><a href="#LazyDeepRegressor-565"><span class="linenos">565</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-566"><a href="#LazyDeepRegressor-566"><span class="linenos">566</span></a>
</span><span id="LazyDeepRegressor-567"><a href="#LazyDeepRegressor-567"><span class="linenos">567</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>Fitting -- almost -- all the regression algorithms with layers of
    nnetsauce's CustomRegressor and returning their scores.</p>

<p>Parameters:</p>

<pre><code>verbose: int, optional (default=0)
    Any positive number for verbosity.

ignore_warnings: bool, optional (default=True)
    When set to True, the warning related to algorigms that are not able to run are ignored.

custom_metric: function, optional (default=None)
    When function is provided, models are evaluated based on the custom evaluation metric provided.

predictions: bool, optional (default=False)
    When set to True, the predictions of all the models models are returned as dataframe.

sort_by: string, optional (default='Accuracy')
    Sort models by a metric. Available options are 'Accuracy', 'Balanced Accuracy', 'ROC AUC', 'F1 Score'
    or a custom metric identified by its name and provided by custom_metric.

random_state: int, optional (default=42)
    Reproducibiility seed.

estimators: list, optional (default='all')
    list of Estimators names or just 'all' (default='all')

preprocess: bool
    preprocessing is done when set to True

n_jobs : int, when possible, run in parallel
    For now, only used by individual models that support it.

n_layers: int, optional (default=3)
    Number of layers of CustomRegressors to be used.

All the other parameters are the same as CustomRegressor's.
</code></pre>

<p>Examples:</p>

<pre><code>import nnetsauce as ns
import numpy as np
from sklearn import datasets
from sklearn.utils import shuffle

diabetes = datasets.load_diabetes()
X, y = shuffle(diabetes.data, diabetes.target, random_state=13)
X = X.astype(np.float32)

offset = int(X.shape[0] * 0.9)
X_train, y_train = X[:offset], y[:offset]
X_test, y_test = X[offset:], y[offset:]

reg = ns.LazyDeepRegressor(verbose=0, ignore_warnings=False, custom_metric=None)
models, predictions = reg.fit(X_train, X_test, y_train, y_test)
print(models)
</code></pre>
</div>


                                <div id="LazyDeepRegressor.fit" class="classattr">
                                            <input id="LazyDeepRegressor.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">y_train</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyDeepRegressor.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepRegressor.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepRegressor.fit-203"><a href="#LazyDeepRegressor.fit-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyDeepRegressor.fit-204"><a href="#LazyDeepRegressor.fit-204"><span class="linenos">204</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X_train and y_train, predict and score on X_test, y_test.</span>
</span><span id="LazyDeepRegressor.fit-205"><a href="#LazyDeepRegressor.fit-205"><span class="linenos">205</span></a>
</span><span id="LazyDeepRegressor.fit-206"><a href="#LazyDeepRegressor.fit-206"><span class="linenos">206</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepRegressor.fit-207"><a href="#LazyDeepRegressor.fit-207"><span class="linenos">207</span></a>
</span><span id="LazyDeepRegressor.fit-208"><a href="#LazyDeepRegressor.fit-208"><span class="linenos">208</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyDeepRegressor.fit-209"><a href="#LazyDeepRegressor.fit-209"><span class="linenos">209</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor.fit-210"><a href="#LazyDeepRegressor.fit-210"><span class="linenos">210</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor.fit-211"><a href="#LazyDeepRegressor.fit-211"><span class="linenos">211</span></a>
</span><span id="LazyDeepRegressor.fit-212"><a href="#LazyDeepRegressor.fit-212"><span class="linenos">212</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyDeepRegressor.fit-213"><a href="#LazyDeepRegressor.fit-213"><span class="linenos">213</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor.fit-214"><a href="#LazyDeepRegressor.fit-214"><span class="linenos">214</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor.fit-215"><a href="#LazyDeepRegressor.fit-215"><span class="linenos">215</span></a>
</span><span id="LazyDeepRegressor.fit-216"><a href="#LazyDeepRegressor.fit-216"><span class="linenos">216</span></a><span class="sd">            y_train : array-like,</span>
</span><span id="LazyDeepRegressor.fit-217"><a href="#LazyDeepRegressor.fit-217"><span class="linenos">217</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor.fit-218"><a href="#LazyDeepRegressor.fit-218"><span class="linenos">218</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor.fit-219"><a href="#LazyDeepRegressor.fit-219"><span class="linenos">219</span></a>
</span><span id="LazyDeepRegressor.fit-220"><a href="#LazyDeepRegressor.fit-220"><span class="linenos">220</span></a><span class="sd">            y_test : array-like,</span>
</span><span id="LazyDeepRegressor.fit-221"><a href="#LazyDeepRegressor.fit-221"><span class="linenos">221</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor.fit-222"><a href="#LazyDeepRegressor.fit-222"><span class="linenos">222</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor.fit-223"><a href="#LazyDeepRegressor.fit-223"><span class="linenos">223</span></a>
</span><span id="LazyDeepRegressor.fit-224"><a href="#LazyDeepRegressor.fit-224"><span class="linenos">224</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepRegressor.fit-225"><a href="#LazyDeepRegressor.fit-225"><span class="linenos">225</span></a><span class="sd">        -------</span>
</span><span id="LazyDeepRegressor.fit-226"><a href="#LazyDeepRegressor.fit-226"><span class="linenos">226</span></a><span class="sd">        scores:  Pandas DataFrame</span>
</span><span id="LazyDeepRegressor.fit-227"><a href="#LazyDeepRegressor.fit-227"><span class="linenos">227</span></a><span class="sd">            Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepRegressor.fit-228"><a href="#LazyDeepRegressor.fit-228"><span class="linenos">228</span></a>
</span><span id="LazyDeepRegressor.fit-229"><a href="#LazyDeepRegressor.fit-229"><span class="linenos">229</span></a><span class="sd">        predictions : Pandas DataFrame</span>
</span><span id="LazyDeepRegressor.fit-230"><a href="#LazyDeepRegressor.fit-230"><span class="linenos">230</span></a><span class="sd">            Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepRegressor.fit-231"><a href="#LazyDeepRegressor.fit-231"><span class="linenos">231</span></a>
</span><span id="LazyDeepRegressor.fit-232"><a href="#LazyDeepRegressor.fit-232"><span class="linenos">232</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepRegressor.fit-233"><a href="#LazyDeepRegressor.fit-233"><span class="linenos">233</span></a>        <span class="n">R2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor.fit-234"><a href="#LazyDeepRegressor.fit-234"><span class="linenos">234</span></a>        <span class="n">ADJR2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor.fit-235"><a href="#LazyDeepRegressor.fit-235"><span class="linenos">235</span></a>        <span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor.fit-236"><a href="#LazyDeepRegressor.fit-236"><span class="linenos">236</span></a>        <span class="c1"># WIN = []</span>
</span><span id="LazyDeepRegressor.fit-237"><a href="#LazyDeepRegressor.fit-237"><span class="linenos">237</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor.fit-238"><a href="#LazyDeepRegressor.fit-238"><span class="linenos">238</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor.fit-239"><a href="#LazyDeepRegressor.fit-239"><span class="linenos">239</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepRegressor.fit-240"><a href="#LazyDeepRegressor.fit-240"><span class="linenos">240</span></a>
</span><span id="LazyDeepRegressor.fit-241"><a href="#LazyDeepRegressor.fit-241"><span class="linenos">241</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-242"><a href="#LazyDeepRegressor.fit-242"><span class="linenos">242</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor.fit-243"><a href="#LazyDeepRegressor.fit-243"><span class="linenos">243</span></a>
</span><span id="LazyDeepRegressor.fit-244"><a href="#LazyDeepRegressor.fit-244"><span class="linenos">244</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyDeepRegressor.fit-245"><a href="#LazyDeepRegressor.fit-245"><span class="linenos">245</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-246"><a href="#LazyDeepRegressor.fit-246"><span class="linenos">246</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-247"><a href="#LazyDeepRegressor.fit-247"><span class="linenos">247</span></a>
</span><span id="LazyDeepRegressor.fit-248"><a href="#LazyDeepRegressor.fit-248"><span class="linenos">248</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepRegressor.fit-249"><a href="#LazyDeepRegressor.fit-249"><span class="linenos">249</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepRegressor.fit-250"><a href="#LazyDeepRegressor.fit-250"><span class="linenos">250</span></a>
</span><span id="LazyDeepRegressor.fit-251"><a href="#LazyDeepRegressor.fit-251"><span class="linenos">251</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-252"><a href="#LazyDeepRegressor.fit-252"><span class="linenos">252</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyDeepRegressor.fit-253"><a href="#LazyDeepRegressor.fit-253"><span class="linenos">253</span></a>        <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-254"><a href="#LazyDeepRegressor.fit-254"><span class="linenos">254</span></a>
</span><span id="LazyDeepRegressor.fit-255"><a href="#LazyDeepRegressor.fit-255"><span class="linenos">255</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-256"><a href="#LazyDeepRegressor.fit-256"><span class="linenos">256</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-257"><a href="#LazyDeepRegressor.fit-257"><span class="linenos">257</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepRegressor.fit-258"><a href="#LazyDeepRegressor.fit-258"><span class="linenos">258</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyDeepRegressor.fit-259"><a href="#LazyDeepRegressor.fit-259"><span class="linenos">259</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-260"><a href="#LazyDeepRegressor.fit-260"><span class="linenos">260</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-261"><a href="#LazyDeepRegressor.fit-261"><span class="linenos">261</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-262"><a href="#LazyDeepRegressor.fit-262"><span class="linenos">262</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-263"><a href="#LazyDeepRegressor.fit-263"><span class="linenos">263</span></a>                    <span class="p">),</span>
</span><span id="LazyDeepRegressor.fit-264"><a href="#LazyDeepRegressor.fit-264"><span class="linenos">264</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-265"><a href="#LazyDeepRegressor.fit-265"><span class="linenos">265</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-266"><a href="#LazyDeepRegressor.fit-266"><span class="linenos">266</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-267"><a href="#LazyDeepRegressor.fit-267"><span class="linenos">267</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-268"><a href="#LazyDeepRegressor.fit-268"><span class="linenos">268</span></a>                    <span class="p">),</span>
</span><span id="LazyDeepRegressor.fit-269"><a href="#LazyDeepRegressor.fit-269"><span class="linenos">269</span></a>                <span class="p">]</span>
</span><span id="LazyDeepRegressor.fit-270"><a href="#LazyDeepRegressor.fit-270"><span class="linenos">270</span></a>            <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-271"><a href="#LazyDeepRegressor.fit-271"><span class="linenos">271</span></a>
</span><span id="LazyDeepRegressor.fit-272"><a href="#LazyDeepRegressor.fit-272"><span class="linenos">272</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-273"><a href="#LazyDeepRegressor.fit-273"><span class="linenos">273</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="n">DEEPREGRESSORS</span>
</span><span id="LazyDeepRegressor.fit-274"><a href="#LazyDeepRegressor.fit-274"><span class="linenos">274</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-275"><a href="#LazyDeepRegressor.fit-275"><span class="linenos">275</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyDeepRegressor.fit-276"><a href="#LazyDeepRegressor.fit-276"><span class="linenos">276</span></a>                <span class="p">(</span><span class="s2">&quot;DeepCustomRegressor(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyDeepRegressor.fit-277"><a href="#LazyDeepRegressor.fit-277"><span class="linenos">277</span></a>                <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepRegressor.fit-278"><a href="#LazyDeepRegressor.fit-278"><span class="linenos">278</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-279"><a href="#LazyDeepRegressor.fit-279"><span class="linenos">279</span></a>                    <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-280"><a href="#LazyDeepRegressor.fit-280"><span class="linenos">280</span></a>                    <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-281"><a href="#LazyDeepRegressor.fit-281"><span class="linenos">281</span></a>                <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-282"><a href="#LazyDeepRegressor.fit-282"><span class="linenos">282</span></a>            <span class="p">]</span>
</span><span id="LazyDeepRegressor.fit-283"><a href="#LazyDeepRegressor.fit-283"><span class="linenos">283</span></a>
</span><span id="LazyDeepRegressor.fit-284"><a href="#LazyDeepRegressor.fit-284"><span class="linenos">284</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-285"><a href="#LazyDeepRegressor.fit-285"><span class="linenos">285</span></a>
</span><span id="LazyDeepRegressor.fit-286"><a href="#LazyDeepRegressor.fit-286"><span class="linenos">286</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepRegressor.fit-287"><a href="#LazyDeepRegressor.fit-287"><span class="linenos">287</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepRegressor.fit-288"><a href="#LazyDeepRegressor.fit-288"><span class="linenos">288</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-289"><a href="#LazyDeepRegressor.fit-289"><span class="linenos">289</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepRegressor.fit-290"><a href="#LazyDeepRegressor.fit-290"><span class="linenos">290</span></a>                        <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-291"><a href="#LazyDeepRegressor.fit-291"><span class="linenos">291</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">),</span>
</span><span id="LazyDeepRegressor.fit-292"><a href="#LazyDeepRegressor.fit-292"><span class="linenos">292</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-293"><a href="#LazyDeepRegressor.fit-293"><span class="linenos">293</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-294"><a href="#LazyDeepRegressor.fit-294"><span class="linenos">294</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-295"><a href="#LazyDeepRegressor.fit-295"><span class="linenos">295</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-296"><a href="#LazyDeepRegressor.fit-296"><span class="linenos">296</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-297"><a href="#LazyDeepRegressor.fit-297"><span class="linenos">297</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-298"><a href="#LazyDeepRegressor.fit-298"><span class="linenos">298</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-299"><a href="#LazyDeepRegressor.fit-299"><span class="linenos">299</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-300"><a href="#LazyDeepRegressor.fit-300"><span class="linenos">300</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-301"><a href="#LazyDeepRegressor.fit-301"><span class="linenos">301</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-302"><a href="#LazyDeepRegressor.fit-302"><span class="linenos">302</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-303"><a href="#LazyDeepRegressor.fit-303"><span class="linenos">303</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-304"><a href="#LazyDeepRegressor.fit-304"><span class="linenos">304</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-305"><a href="#LazyDeepRegressor.fit-305"><span class="linenos">305</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-306"><a href="#LazyDeepRegressor.fit-306"><span class="linenos">306</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-307"><a href="#LazyDeepRegressor.fit-307"><span class="linenos">307</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-308"><a href="#LazyDeepRegressor.fit-308"><span class="linenos">308</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-309"><a href="#LazyDeepRegressor.fit-309"><span class="linenos">309</span></a>                        <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-310"><a href="#LazyDeepRegressor.fit-310"><span class="linenos">310</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyDeepRegressor.fit-311"><a href="#LazyDeepRegressor.fit-311"><span class="linenos">311</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-312"><a href="#LazyDeepRegressor.fit-312"><span class="linenos">312</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-313"><a href="#LazyDeepRegressor.fit-313"><span class="linenos">313</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-314"><a href="#LazyDeepRegressor.fit-314"><span class="linenos">314</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-315"><a href="#LazyDeepRegressor.fit-315"><span class="linenos">315</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-316"><a href="#LazyDeepRegressor.fit-316"><span class="linenos">316</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-317"><a href="#LazyDeepRegressor.fit-317"><span class="linenos">317</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-318"><a href="#LazyDeepRegressor.fit-318"><span class="linenos">318</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-319"><a href="#LazyDeepRegressor.fit-319"><span class="linenos">319</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-320"><a href="#LazyDeepRegressor.fit-320"><span class="linenos">320</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-321"><a href="#LazyDeepRegressor.fit-321"><span class="linenos">321</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-322"><a href="#LazyDeepRegressor.fit-322"><span class="linenos">322</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-323"><a href="#LazyDeepRegressor.fit-323"><span class="linenos">323</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-324"><a href="#LazyDeepRegressor.fit-324"><span class="linenos">324</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-325"><a href="#LazyDeepRegressor.fit-325"><span class="linenos">325</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-326"><a href="#LazyDeepRegressor.fit-326"><span class="linenos">326</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-327"><a href="#LazyDeepRegressor.fit-327"><span class="linenos">327</span></a>
</span><span id="LazyDeepRegressor.fit-328"><a href="#LazyDeepRegressor.fit-328"><span class="linenos">328</span></a>                    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">):</span>
</span><span id="LazyDeepRegressor.fit-329"><a href="#LazyDeepRegressor.fit-329"><span class="linenos">329</span></a>                        <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-330"><a href="#LazyDeepRegressor.fit-330"><span class="linenos">330</span></a>                            <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-331"><a href="#LazyDeepRegressor.fit-331"><span class="linenos">331</span></a>                                <span class="n">obj</span><span class="o">=</span><span class="n">layer_regr</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-332"><a href="#LazyDeepRegressor.fit-332"><span class="linenos">332</span></a>                                <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-333"><a href="#LazyDeepRegressor.fit-333"><span class="linenos">333</span></a>                                <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-334"><a href="#LazyDeepRegressor.fit-334"><span class="linenos">334</span></a>                                <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-335"><a href="#LazyDeepRegressor.fit-335"><span class="linenos">335</span></a>                                <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-336"><a href="#LazyDeepRegressor.fit-336"><span class="linenos">336</span></a>                                <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-337"><a href="#LazyDeepRegressor.fit-337"><span class="linenos">337</span></a>                                <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-338"><a href="#LazyDeepRegressor.fit-338"><span class="linenos">338</span></a>                                <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-339"><a href="#LazyDeepRegressor.fit-339"><span class="linenos">339</span></a>                                <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-340"><a href="#LazyDeepRegressor.fit-340"><span class="linenos">340</span></a>                                <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-341"><a href="#LazyDeepRegressor.fit-341"><span class="linenos">341</span></a>                                <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-342"><a href="#LazyDeepRegressor.fit-342"><span class="linenos">342</span></a>                                <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-343"><a href="#LazyDeepRegressor.fit-343"><span class="linenos">343</span></a>                                <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-344"><a href="#LazyDeepRegressor.fit-344"><span class="linenos">344</span></a>                                <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-345"><a href="#LazyDeepRegressor.fit-345"><span class="linenos">345</span></a>                                <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-346"><a href="#LazyDeepRegressor.fit-346"><span class="linenos">346</span></a>                                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-347"><a href="#LazyDeepRegressor.fit-347"><span class="linenos">347</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-348"><a href="#LazyDeepRegressor.fit-348"><span class="linenos">348</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-349"><a href="#LazyDeepRegressor.fit-349"><span class="linenos">349</span></a>
</span><span id="LazyDeepRegressor.fit-350"><a href="#LazyDeepRegressor.fit-350"><span class="linenos">350</span></a>                    <span class="n">layer_regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-351"><a href="#LazyDeepRegressor.fit-351"><span class="linenos">351</span></a>
</span><span id="LazyDeepRegressor.fit-352"><a href="#LazyDeepRegressor.fit-352"><span class="linenos">352</span></a>                    <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-353"><a href="#LazyDeepRegressor.fit-353"><span class="linenos">353</span></a>                        <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepRegressor.fit-354"><a href="#LazyDeepRegressor.fit-354"><span class="linenos">354</span></a>                            <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyDeepRegressor.fit-355"><a href="#LazyDeepRegressor.fit-355"><span class="linenos">355</span></a>                            <span class="p">(</span><span class="s2">&quot;regressor&quot;</span><span class="p">,</span> <span class="n">layer_regr</span><span class="p">),</span>
</span><span id="LazyDeepRegressor.fit-356"><a href="#LazyDeepRegressor.fit-356"><span class="linenos">356</span></a>                        <span class="p">]</span>
</span><span id="LazyDeepRegressor.fit-357"><a href="#LazyDeepRegressor.fit-357"><span class="linenos">357</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-358"><a href="#LazyDeepRegressor.fit-358"><span class="linenos">358</span></a>
</span><span id="LazyDeepRegressor.fit-359"><a href="#LazyDeepRegressor.fit-359"><span class="linenos">359</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-360"><a href="#LazyDeepRegressor.fit-360"><span class="linenos">360</span></a>
</span><span id="LazyDeepRegressor.fit-361"><a href="#LazyDeepRegressor.fit-361"><span class="linenos">361</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyDeepRegressor.fit-362"><a href="#LazyDeepRegressor.fit-362"><span class="linenos">362</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-363"><a href="#LazyDeepRegressor.fit-363"><span class="linenos">363</span></a>                    <span class="n">r_squared</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-364"><a href="#LazyDeepRegressor.fit-364"><span class="linenos">364</span></a>                    <span class="n">adj_rsquared</span> <span class="o">=</span> <span class="n">adjusted_rsquared</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-365"><a href="#LazyDeepRegressor.fit-365"><span class="linenos">365</span></a>                        <span class="n">r_squared</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LazyDeepRegressor.fit-366"><a href="#LazyDeepRegressor.fit-366"><span class="linenos">366</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-367"><a href="#LazyDeepRegressor.fit-367"><span class="linenos">367</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-368"><a href="#LazyDeepRegressor.fit-368"><span class="linenos">368</span></a>
</span><span id="LazyDeepRegressor.fit-369"><a href="#LazyDeepRegressor.fit-369"><span class="linenos">369</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-370"><a href="#LazyDeepRegressor.fit-370"><span class="linenos">370</span></a>                    <span class="n">R2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_squared</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-371"><a href="#LazyDeepRegressor.fit-371"><span class="linenos">371</span></a>                    <span class="n">ADJR2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_rsquared</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-372"><a href="#LazyDeepRegressor.fit-372"><span class="linenos">372</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-373"><a href="#LazyDeepRegressor.fit-373"><span class="linenos">373</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-374"><a href="#LazyDeepRegressor.fit-374"><span class="linenos">374</span></a>
</span><span id="LazyDeepRegressor.fit-375"><a href="#LazyDeepRegressor.fit-375"><span class="linenos">375</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-376"><a href="#LazyDeepRegressor.fit-376"><span class="linenos">376</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-377"><a href="#LazyDeepRegressor.fit-377"><span class="linenos">377</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-378"><a href="#LazyDeepRegressor.fit-378"><span class="linenos">378</span></a>
</span><span id="LazyDeepRegressor.fit-379"><a href="#LazyDeepRegressor.fit-379"><span class="linenos">379</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-380"><a href="#LazyDeepRegressor.fit-380"><span class="linenos">380</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepRegressor.fit-381"><a href="#LazyDeepRegressor.fit-381"><span class="linenos">381</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-382"><a href="#LazyDeepRegressor.fit-382"><span class="linenos">382</span></a>                            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">r_squared</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-383"><a href="#LazyDeepRegressor.fit-383"><span class="linenos">383</span></a>                            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">adj_rsquared</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-384"><a href="#LazyDeepRegressor.fit-384"><span class="linenos">384</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-385"><a href="#LazyDeepRegressor.fit-385"><span class="linenos">385</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-386"><a href="#LazyDeepRegressor.fit-386"><span class="linenos">386</span></a>                        <span class="p">}</span>
</span><span id="LazyDeepRegressor.fit-387"><a href="#LazyDeepRegressor.fit-387"><span class="linenos">387</span></a>
</span><span id="LazyDeepRegressor.fit-388"><a href="#LazyDeepRegressor.fit-388"><span class="linenos">388</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-389"><a href="#LazyDeepRegressor.fit-389"><span class="linenos">389</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-390"><a href="#LazyDeepRegressor.fit-390"><span class="linenos">390</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyDeepRegressor.fit-391"><a href="#LazyDeepRegressor.fit-391"><span class="linenos">391</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-392"><a href="#LazyDeepRegressor.fit-392"><span class="linenos">392</span></a>
</span><span id="LazyDeepRegressor.fit-393"><a href="#LazyDeepRegressor.fit-393"><span class="linenos">393</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-394"><a href="#LazyDeepRegressor.fit-394"><span class="linenos">394</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-395"><a href="#LazyDeepRegressor.fit-395"><span class="linenos">395</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyDeepRegressor.fit-396"><a href="#LazyDeepRegressor.fit-396"><span class="linenos">396</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-397"><a href="#LazyDeepRegressor.fit-397"><span class="linenos">397</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-398"><a href="#LazyDeepRegressor.fit-398"><span class="linenos">398</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-399"><a href="#LazyDeepRegressor.fit-399"><span class="linenos">399</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-400"><a href="#LazyDeepRegressor.fit-400"><span class="linenos">400</span></a>
</span><span id="LazyDeepRegressor.fit-401"><a href="#LazyDeepRegressor.fit-401"><span class="linenos">401</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># no preprocessing</span>
</span><span id="LazyDeepRegressor.fit-402"><a href="#LazyDeepRegressor.fit-402"><span class="linenos">402</span></a>
</span><span id="LazyDeepRegressor.fit-403"><a href="#LazyDeepRegressor.fit-403"><span class="linenos">403</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepRegressor.fit-404"><a href="#LazyDeepRegressor.fit-404"><span class="linenos">404</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepRegressor.fit-405"><a href="#LazyDeepRegressor.fit-405"><span class="linenos">405</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-406"><a href="#LazyDeepRegressor.fit-406"><span class="linenos">406</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepRegressor.fit-407"><a href="#LazyDeepRegressor.fit-407"><span class="linenos">407</span></a>                        <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-408"><a href="#LazyDeepRegressor.fit-408"><span class="linenos">408</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">),</span>
</span><span id="LazyDeepRegressor.fit-409"><a href="#LazyDeepRegressor.fit-409"><span class="linenos">409</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-410"><a href="#LazyDeepRegressor.fit-410"><span class="linenos">410</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-411"><a href="#LazyDeepRegressor.fit-411"><span class="linenos">411</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-412"><a href="#LazyDeepRegressor.fit-412"><span class="linenos">412</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-413"><a href="#LazyDeepRegressor.fit-413"><span class="linenos">413</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-414"><a href="#LazyDeepRegressor.fit-414"><span class="linenos">414</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-415"><a href="#LazyDeepRegressor.fit-415"><span class="linenos">415</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-416"><a href="#LazyDeepRegressor.fit-416"><span class="linenos">416</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-417"><a href="#LazyDeepRegressor.fit-417"><span class="linenos">417</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-418"><a href="#LazyDeepRegressor.fit-418"><span class="linenos">418</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-419"><a href="#LazyDeepRegressor.fit-419"><span class="linenos">419</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-420"><a href="#LazyDeepRegressor.fit-420"><span class="linenos">420</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-421"><a href="#LazyDeepRegressor.fit-421"><span class="linenos">421</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-422"><a href="#LazyDeepRegressor.fit-422"><span class="linenos">422</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-423"><a href="#LazyDeepRegressor.fit-423"><span class="linenos">423</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-424"><a href="#LazyDeepRegressor.fit-424"><span class="linenos">424</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-425"><a href="#LazyDeepRegressor.fit-425"><span class="linenos">425</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-426"><a href="#LazyDeepRegressor.fit-426"><span class="linenos">426</span></a>                        <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-427"><a href="#LazyDeepRegressor.fit-427"><span class="linenos">427</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyDeepRegressor.fit-428"><a href="#LazyDeepRegressor.fit-428"><span class="linenos">428</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-429"><a href="#LazyDeepRegressor.fit-429"><span class="linenos">429</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-430"><a href="#LazyDeepRegressor.fit-430"><span class="linenos">430</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-431"><a href="#LazyDeepRegressor.fit-431"><span class="linenos">431</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-432"><a href="#LazyDeepRegressor.fit-432"><span class="linenos">432</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-433"><a href="#LazyDeepRegressor.fit-433"><span class="linenos">433</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-434"><a href="#LazyDeepRegressor.fit-434"><span class="linenos">434</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-435"><a href="#LazyDeepRegressor.fit-435"><span class="linenos">435</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-436"><a href="#LazyDeepRegressor.fit-436"><span class="linenos">436</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-437"><a href="#LazyDeepRegressor.fit-437"><span class="linenos">437</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-438"><a href="#LazyDeepRegressor.fit-438"><span class="linenos">438</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-439"><a href="#LazyDeepRegressor.fit-439"><span class="linenos">439</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-440"><a href="#LazyDeepRegressor.fit-440"><span class="linenos">440</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-441"><a href="#LazyDeepRegressor.fit-441"><span class="linenos">441</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-442"><a href="#LazyDeepRegressor.fit-442"><span class="linenos">442</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-443"><a href="#LazyDeepRegressor.fit-443"><span class="linenos">443</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-444"><a href="#LazyDeepRegressor.fit-444"><span class="linenos">444</span></a>
</span><span id="LazyDeepRegressor.fit-445"><a href="#LazyDeepRegressor.fit-445"><span class="linenos">445</span></a>                    <span class="n">layer_regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-446"><a href="#LazyDeepRegressor.fit-446"><span class="linenos">446</span></a>
</span><span id="LazyDeepRegressor.fit-447"><a href="#LazyDeepRegressor.fit-447"><span class="linenos">447</span></a>                    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">):</span>
</span><span id="LazyDeepRegressor.fit-448"><a href="#LazyDeepRegressor.fit-448"><span class="linenos">448</span></a>                        <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-449"><a href="#LazyDeepRegressor.fit-449"><span class="linenos">449</span></a>                            <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-450"><a href="#LazyDeepRegressor.fit-450"><span class="linenos">450</span></a>                                <span class="n">obj</span><span class="o">=</span><span class="n">layer_regr</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-451"><a href="#LazyDeepRegressor.fit-451"><span class="linenos">451</span></a>                                <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-452"><a href="#LazyDeepRegressor.fit-452"><span class="linenos">452</span></a>                                <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-453"><a href="#LazyDeepRegressor.fit-453"><span class="linenos">453</span></a>                                <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-454"><a href="#LazyDeepRegressor.fit-454"><span class="linenos">454</span></a>                                <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-455"><a href="#LazyDeepRegressor.fit-455"><span class="linenos">455</span></a>                                <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-456"><a href="#LazyDeepRegressor.fit-456"><span class="linenos">456</span></a>                                <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-457"><a href="#LazyDeepRegressor.fit-457"><span class="linenos">457</span></a>                                <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-458"><a href="#LazyDeepRegressor.fit-458"><span class="linenos">458</span></a>                                <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-459"><a href="#LazyDeepRegressor.fit-459"><span class="linenos">459</span></a>                                <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-460"><a href="#LazyDeepRegressor.fit-460"><span class="linenos">460</span></a>                                <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-461"><a href="#LazyDeepRegressor.fit-461"><span class="linenos">461</span></a>                                <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-462"><a href="#LazyDeepRegressor.fit-462"><span class="linenos">462</span></a>                                <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-463"><a href="#LazyDeepRegressor.fit-463"><span class="linenos">463</span></a>                                <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-464"><a href="#LazyDeepRegressor.fit-464"><span class="linenos">464</span></a>                                <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-465"><a href="#LazyDeepRegressor.fit-465"><span class="linenos">465</span></a>                                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-466"><a href="#LazyDeepRegressor.fit-466"><span class="linenos">466</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-467"><a href="#LazyDeepRegressor.fit-467"><span class="linenos">467</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-468"><a href="#LazyDeepRegressor.fit-468"><span class="linenos">468</span></a>
</span><span id="LazyDeepRegressor.fit-469"><a href="#LazyDeepRegressor.fit-469"><span class="linenos">469</span></a>                        <span class="c1"># layer_regr.fit(X_train, y_train)</span>
</span><span id="LazyDeepRegressor.fit-470"><a href="#LazyDeepRegressor.fit-470"><span class="linenos">470</span></a>
</span><span id="LazyDeepRegressor.fit-471"><a href="#LazyDeepRegressor.fit-471"><span class="linenos">471</span></a>                    <span class="n">layer_regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-472"><a href="#LazyDeepRegressor.fit-472"><span class="linenos">472</span></a>
</span><span id="LazyDeepRegressor.fit-473"><a href="#LazyDeepRegressor.fit-473"><span class="linenos">473</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_regr</span>
</span><span id="LazyDeepRegressor.fit-474"><a href="#LazyDeepRegressor.fit-474"><span class="linenos">474</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">layer_regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-475"><a href="#LazyDeepRegressor.fit-475"><span class="linenos">475</span></a>
</span><span id="LazyDeepRegressor.fit-476"><a href="#LazyDeepRegressor.fit-476"><span class="linenos">476</span></a>                    <span class="n">r_squared</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-477"><a href="#LazyDeepRegressor.fit-477"><span class="linenos">477</span></a>                    <span class="n">adj_rsquared</span> <span class="o">=</span> <span class="n">adjusted_rsquared</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-478"><a href="#LazyDeepRegressor.fit-478"><span class="linenos">478</span></a>                        <span class="n">r_squared</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LazyDeepRegressor.fit-479"><a href="#LazyDeepRegressor.fit-479"><span class="linenos">479</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-480"><a href="#LazyDeepRegressor.fit-480"><span class="linenos">480</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-481"><a href="#LazyDeepRegressor.fit-481"><span class="linenos">481</span></a>
</span><span id="LazyDeepRegressor.fit-482"><a href="#LazyDeepRegressor.fit-482"><span class="linenos">482</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-483"><a href="#LazyDeepRegressor.fit-483"><span class="linenos">483</span></a>                    <span class="n">R2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_squared</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-484"><a href="#LazyDeepRegressor.fit-484"><span class="linenos">484</span></a>                    <span class="n">ADJR2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_rsquared</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-485"><a href="#LazyDeepRegressor.fit-485"><span class="linenos">485</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-486"><a href="#LazyDeepRegressor.fit-486"><span class="linenos">486</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-487"><a href="#LazyDeepRegressor.fit-487"><span class="linenos">487</span></a>
</span><span id="LazyDeepRegressor.fit-488"><a href="#LazyDeepRegressor.fit-488"><span class="linenos">488</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-489"><a href="#LazyDeepRegressor.fit-489"><span class="linenos">489</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-490"><a href="#LazyDeepRegressor.fit-490"><span class="linenos">490</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-491"><a href="#LazyDeepRegressor.fit-491"><span class="linenos">491</span></a>
</span><span id="LazyDeepRegressor.fit-492"><a href="#LazyDeepRegressor.fit-492"><span class="linenos">492</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-493"><a href="#LazyDeepRegressor.fit-493"><span class="linenos">493</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepRegressor.fit-494"><a href="#LazyDeepRegressor.fit-494"><span class="linenos">494</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-495"><a href="#LazyDeepRegressor.fit-495"><span class="linenos">495</span></a>                            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">r_squared</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-496"><a href="#LazyDeepRegressor.fit-496"><span class="linenos">496</span></a>                            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">adj_rsquared</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-497"><a href="#LazyDeepRegressor.fit-497"><span class="linenos">497</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-498"><a href="#LazyDeepRegressor.fit-498"><span class="linenos">498</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-499"><a href="#LazyDeepRegressor.fit-499"><span class="linenos">499</span></a>                        <span class="p">}</span>
</span><span id="LazyDeepRegressor.fit-500"><a href="#LazyDeepRegressor.fit-500"><span class="linenos">500</span></a>
</span><span id="LazyDeepRegressor.fit-501"><a href="#LazyDeepRegressor.fit-501"><span class="linenos">501</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-502"><a href="#LazyDeepRegressor.fit-502"><span class="linenos">502</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-503"><a href="#LazyDeepRegressor.fit-503"><span class="linenos">503</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyDeepRegressor.fit-504"><a href="#LazyDeepRegressor.fit-504"><span class="linenos">504</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-505"><a href="#LazyDeepRegressor.fit-505"><span class="linenos">505</span></a>
</span><span id="LazyDeepRegressor.fit-506"><a href="#LazyDeepRegressor.fit-506"><span class="linenos">506</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-507"><a href="#LazyDeepRegressor.fit-507"><span class="linenos">507</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-508"><a href="#LazyDeepRegressor.fit-508"><span class="linenos">508</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyDeepRegressor.fit-509"><a href="#LazyDeepRegressor.fit-509"><span class="linenos">509</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-510"><a href="#LazyDeepRegressor.fit-510"><span class="linenos">510</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-511"><a href="#LazyDeepRegressor.fit-511"><span class="linenos">511</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-512"><a href="#LazyDeepRegressor.fit-512"><span class="linenos">512</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-513"><a href="#LazyDeepRegressor.fit-513"><span class="linenos">513</span></a>
</span><span id="LazyDeepRegressor.fit-514"><a href="#LazyDeepRegressor.fit-514"><span class="linenos">514</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepRegressor.fit-515"><a href="#LazyDeepRegressor.fit-515"><span class="linenos">515</span></a>            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-516"><a href="#LazyDeepRegressor.fit-516"><span class="linenos">516</span></a>            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">ADJR2</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-517"><a href="#LazyDeepRegressor.fit-517"><span class="linenos">517</span></a>            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">R2</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-518"><a href="#LazyDeepRegressor.fit-518"><span class="linenos">518</span></a>            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-519"><a href="#LazyDeepRegressor.fit-519"><span class="linenos">519</span></a>            <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-520"><a href="#LazyDeepRegressor.fit-520"><span class="linenos">520</span></a>        <span class="p">}</span>
</span><span id="LazyDeepRegressor.fit-521"><a href="#LazyDeepRegressor.fit-521"><span class="linenos">521</span></a>
</span><span id="LazyDeepRegressor.fit-522"><a href="#LazyDeepRegressor.fit-522"><span class="linenos">522</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-523"><a href="#LazyDeepRegressor.fit-523"><span class="linenos">523</span></a>            <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">CUSTOM_METRIC</span>
</span><span id="LazyDeepRegressor.fit-524"><a href="#LazyDeepRegressor.fit-524"><span class="linenos">524</span></a>
</span><span id="LazyDeepRegressor.fit-525"><a href="#LazyDeepRegressor.fit-525"><span class="linenos">525</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-526"><a href="#LazyDeepRegressor.fit-526"><span class="linenos">526</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-527"><a href="#LazyDeepRegressor.fit-527"><span class="linenos">527</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyDeepRegressor.fit-528"><a href="#LazyDeepRegressor.fit-528"><span class="linenos">528</span></a>        <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-529"><a href="#LazyDeepRegressor.fit-529"><span class="linenos">529</span></a>
</span><span id="LazyDeepRegressor.fit-530"><a href="#LazyDeepRegressor.fit-530"><span class="linenos">530</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-531"><a href="#LazyDeepRegressor.fit-531"><span class="linenos">531</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-532"><a href="#LazyDeepRegressor.fit-532"><span class="linenos">532</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span></pre></div>


            <div class="docstring"><p>Fit Regression algorithms to X_train and y_train, predict and score on X_test, y_test.</p>

<p>Parameters:</p>

<pre><code>X_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.

y_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

y_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.
</code></pre>

<h2 id="returns">Returns:</h2>

<p>scores:  Pandas DataFrame
    Returns metrics of all the models in a Pandas DataFrame.</p>

<p>predictions : Pandas DataFrame
    Returns predictions of all the models in a Pandas DataFrame.</p>
</div>


                                </div>
                                <div id="LazyDeepRegressor.provide_models" class="classattr">
                                            <input id="LazyDeepRegressor.provide_models-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">provide_models</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">y_train</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyDeepRegressor.provide_models-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepRegressor.provide_models"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepRegressor.provide_models-534"><a href="#LazyDeepRegressor.provide_models-534"><span class="linenos">534</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyDeepRegressor.provide_models-535"><a href="#LazyDeepRegressor.provide_models-535"><span class="linenos">535</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyDeepRegressor.provide_models-536"><a href="#LazyDeepRegressor.provide_models-536"><span class="linenos">536</span></a><span class="sd">        This function returns all the model objects trained in fit function.</span>
</span><span id="LazyDeepRegressor.provide_models-537"><a href="#LazyDeepRegressor.provide_models-537"><span class="linenos">537</span></a><span class="sd">        If fit is not called already, then we call fit and then return the models.</span>
</span><span id="LazyDeepRegressor.provide_models-538"><a href="#LazyDeepRegressor.provide_models-538"><span class="linenos">538</span></a>
</span><span id="LazyDeepRegressor.provide_models-539"><a href="#LazyDeepRegressor.provide_models-539"><span class="linenos">539</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepRegressor.provide_models-540"><a href="#LazyDeepRegressor.provide_models-540"><span class="linenos">540</span></a>
</span><span id="LazyDeepRegressor.provide_models-541"><a href="#LazyDeepRegressor.provide_models-541"><span class="linenos">541</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyDeepRegressor.provide_models-542"><a href="#LazyDeepRegressor.provide_models-542"><span class="linenos">542</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor.provide_models-543"><a href="#LazyDeepRegressor.provide_models-543"><span class="linenos">543</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor.provide_models-544"><a href="#LazyDeepRegressor.provide_models-544"><span class="linenos">544</span></a>
</span><span id="LazyDeepRegressor.provide_models-545"><a href="#LazyDeepRegressor.provide_models-545"><span class="linenos">545</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyDeepRegressor.provide_models-546"><a href="#LazyDeepRegressor.provide_models-546"><span class="linenos">546</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor.provide_models-547"><a href="#LazyDeepRegressor.provide_models-547"><span class="linenos">547</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor.provide_models-548"><a href="#LazyDeepRegressor.provide_models-548"><span class="linenos">548</span></a>
</span><span id="LazyDeepRegressor.provide_models-549"><a href="#LazyDeepRegressor.provide_models-549"><span class="linenos">549</span></a><span class="sd">            y_train : array-like,</span>
</span><span id="LazyDeepRegressor.provide_models-550"><a href="#LazyDeepRegressor.provide_models-550"><span class="linenos">550</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor.provide_models-551"><a href="#LazyDeepRegressor.provide_models-551"><span class="linenos">551</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor.provide_models-552"><a href="#LazyDeepRegressor.provide_models-552"><span class="linenos">552</span></a>
</span><span id="LazyDeepRegressor.provide_models-553"><a href="#LazyDeepRegressor.provide_models-553"><span class="linenos">553</span></a><span class="sd">            y_test : array-like,</span>
</span><span id="LazyDeepRegressor.provide_models-554"><a href="#LazyDeepRegressor.provide_models-554"><span class="linenos">554</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor.provide_models-555"><a href="#LazyDeepRegressor.provide_models-555"><span class="linenos">555</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor.provide_models-556"><a href="#LazyDeepRegressor.provide_models-556"><span class="linenos">556</span></a>
</span><span id="LazyDeepRegressor.provide_models-557"><a href="#LazyDeepRegressor.provide_models-557"><span class="linenos">557</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepRegressor.provide_models-558"><a href="#LazyDeepRegressor.provide_models-558"><span class="linenos">558</span></a>
</span><span id="LazyDeepRegressor.provide_models-559"><a href="#LazyDeepRegressor.provide_models-559"><span class="linenos">559</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyDeepRegressor.provide_models-560"><a href="#LazyDeepRegressor.provide_models-560"><span class="linenos">560</span></a><span class="sd">                Returns a dictionary with each model pipeline as value</span>
</span><span id="LazyDeepRegressor.provide_models-561"><a href="#LazyDeepRegressor.provide_models-561"><span class="linenos">561</span></a><span class="sd">                with key as name of models.</span>
</span><span id="LazyDeepRegressor.provide_models-562"><a href="#LazyDeepRegressor.provide_models-562"><span class="linenos">562</span></a>
</span><span id="LazyDeepRegressor.provide_models-563"><a href="#LazyDeepRegressor.provide_models-563"><span class="linenos">563</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepRegressor.provide_models-564"><a href="#LazyDeepRegressor.provide_models-564"><span class="linenos">564</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.provide_models-565"><a href="#LazyDeepRegressor.provide_models-565"><span class="linenos">565</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.provide_models-566"><a href="#LazyDeepRegressor.provide_models-566"><span class="linenos">566</span></a>
</span><span id="LazyDeepRegressor.provide_models-567"><a href="#LazyDeepRegressor.provide_models-567"><span class="linenos">567</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>This function returns all the model objects trained in fit function.
If fit is not called already, then we call fit and then return the models.</p>

<p>Parameters:</p>

<pre><code>X_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.

y_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

y_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.
</code></pre>

<p>Returns:</p>

<pre><code>models: dict-object,
    Returns a dictionary with each model pipeline as value
    with key as name of models.
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="LazyDeepMTS">
                            <input id="LazyDeepMTS-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LazyDeepMTS</span><wbr>(<span class="base"><a href="#MTS">nnetsauce.MTS</a></span>):

                <label class="view-source-button" for="LazyDeepMTS-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepMTS"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepMTS-91"><a href="#LazyDeepMTS-91"><span class="linenos"> 91</span></a><span class="k">class</span> <span class="nc">LazyDeepMTS</span><span class="p">(</span><span class="n">MTS</span><span class="p">):</span>
</span><span id="LazyDeepMTS-92"><a href="#LazyDeepMTS-92"><span class="linenos"> 92</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyDeepMTS-93"><a href="#LazyDeepMTS-93"><span class="linenos"> 93</span></a>
</span><span id="LazyDeepMTS-94"><a href="#LazyDeepMTS-94"><span class="linenos"> 94</span></a><span class="sd">        Fitting -- almost -- all the regression algorithms with layers of</span>
</span><span id="LazyDeepMTS-95"><a href="#LazyDeepMTS-95"><span class="linenos"> 95</span></a><span class="sd">        nnetsauce&#39;s CustomRegressor to multivariate time series</span>
</span><span id="LazyDeepMTS-96"><a href="#LazyDeepMTS-96"><span class="linenos"> 96</span></a><span class="sd">        and returning their scores.</span>
</span><span id="LazyDeepMTS-97"><a href="#LazyDeepMTS-97"><span class="linenos"> 97</span></a>
</span><span id="LazyDeepMTS-98"><a href="#LazyDeepMTS-98"><span class="linenos"> 98</span></a><span class="sd">    Parameters:</span>
</span><span id="LazyDeepMTS-99"><a href="#LazyDeepMTS-99"><span class="linenos"> 99</span></a>
</span><span id="LazyDeepMTS-100"><a href="#LazyDeepMTS-100"><span class="linenos">100</span></a><span class="sd">        verbose: int, optional (default=0)</span>
</span><span id="LazyDeepMTS-101"><a href="#LazyDeepMTS-101"><span class="linenos">101</span></a><span class="sd">            Any positive number for verbosity.</span>
</span><span id="LazyDeepMTS-102"><a href="#LazyDeepMTS-102"><span class="linenos">102</span></a>
</span><span id="LazyDeepMTS-103"><a href="#LazyDeepMTS-103"><span class="linenos">103</span></a><span class="sd">        ignore_warnings: bool, optional (default=True)</span>
</span><span id="LazyDeepMTS-104"><a href="#LazyDeepMTS-104"><span class="linenos">104</span></a><span class="sd">            When set to True, the warning related to algorigms that are not</span>
</span><span id="LazyDeepMTS-105"><a href="#LazyDeepMTS-105"><span class="linenos">105</span></a><span class="sd">            able to run are ignored.</span>
</span><span id="LazyDeepMTS-106"><a href="#LazyDeepMTS-106"><span class="linenos">106</span></a>
</span><span id="LazyDeepMTS-107"><a href="#LazyDeepMTS-107"><span class="linenos">107</span></a><span class="sd">        custom_metric: function, optional (default=None)</span>
</span><span id="LazyDeepMTS-108"><a href="#LazyDeepMTS-108"><span class="linenos">108</span></a><span class="sd">            When function is provided, models are evaluated based on the</span>
</span><span id="LazyDeepMTS-109"><a href="#LazyDeepMTS-109"><span class="linenos">109</span></a><span class="sd">            custom evaluation metric provided.</span>
</span><span id="LazyDeepMTS-110"><a href="#LazyDeepMTS-110"><span class="linenos">110</span></a>
</span><span id="LazyDeepMTS-111"><a href="#LazyDeepMTS-111"><span class="linenos">111</span></a><span class="sd">        predictions: bool, optional (default=False)</span>
</span><span id="LazyDeepMTS-112"><a href="#LazyDeepMTS-112"><span class="linenos">112</span></a><span class="sd">            When set to True, the predictions of all the models models are</span>
</span><span id="LazyDeepMTS-113"><a href="#LazyDeepMTS-113"><span class="linenos">113</span></a><span class="sd">            returned as dataframe.</span>
</span><span id="LazyDeepMTS-114"><a href="#LazyDeepMTS-114"><span class="linenos">114</span></a>
</span><span id="LazyDeepMTS-115"><a href="#LazyDeepMTS-115"><span class="linenos">115</span></a><span class="sd">        sort_by: string, optional (default=&#39;RMSE&#39;)</span>
</span><span id="LazyDeepMTS-116"><a href="#LazyDeepMTS-116"><span class="linenos">116</span></a><span class="sd">            Sort models by a metric. Available options are &#39;RMSE&#39;, &#39;MAE&#39;,</span>
</span><span id="LazyDeepMTS-117"><a href="#LazyDeepMTS-117"><span class="linenos">117</span></a><span class="sd">            &#39;MPL&#39;, &#39;MPE&#39;, &#39;MAPE&#39;, &#39;R-Squared&#39;, &#39;Adjusted R-Squared&#39; or</span>
</span><span id="LazyDeepMTS-118"><a href="#LazyDeepMTS-118"><span class="linenos">118</span></a><span class="sd">            a custom metric identified by its name and</span>
</span><span id="LazyDeepMTS-119"><a href="#LazyDeepMTS-119"><span class="linenos">119</span></a><span class="sd">            provided by custom_metric.</span>
</span><span id="LazyDeepMTS-120"><a href="#LazyDeepMTS-120"><span class="linenos">120</span></a>
</span><span id="LazyDeepMTS-121"><a href="#LazyDeepMTS-121"><span class="linenos">121</span></a><span class="sd">        random_state: int, optional (default=42)</span>
</span><span id="LazyDeepMTS-122"><a href="#LazyDeepMTS-122"><span class="linenos">122</span></a><span class="sd">            Reproducibiility seed.</span>
</span><span id="LazyDeepMTS-123"><a href="#LazyDeepMTS-123"><span class="linenos">123</span></a>
</span><span id="LazyDeepMTS-124"><a href="#LazyDeepMTS-124"><span class="linenos">124</span></a><span class="sd">        estimators: list, optional (default=&#39;all&#39;)</span>
</span><span id="LazyDeepMTS-125"><a href="#LazyDeepMTS-125"><span class="linenos">125</span></a><span class="sd">            list of Estimators (regression algorithms) names or just</span>
</span><span id="LazyDeepMTS-126"><a href="#LazyDeepMTS-126"><span class="linenos">126</span></a><span class="sd">            &#39;all&#39; (default=&#39;all&#39;)</span>
</span><span id="LazyDeepMTS-127"><a href="#LazyDeepMTS-127"><span class="linenos">127</span></a>
</span><span id="LazyDeepMTS-128"><a href="#LazyDeepMTS-128"><span class="linenos">128</span></a><span class="sd">        preprocess: bool, preprocessing is done when set to True</span>
</span><span id="LazyDeepMTS-129"><a href="#LazyDeepMTS-129"><span class="linenos">129</span></a>
</span><span id="LazyDeepMTS-130"><a href="#LazyDeepMTS-130"><span class="linenos">130</span></a><span class="sd">        n_jobs : int, when possible, run in parallel</span>
</span><span id="LazyDeepMTS-131"><a href="#LazyDeepMTS-131"><span class="linenos">131</span></a><span class="sd">            For now, only used by individual models that support it.</span>
</span><span id="LazyDeepMTS-132"><a href="#LazyDeepMTS-132"><span class="linenos">132</span></a>
</span><span id="LazyDeepMTS-133"><a href="#LazyDeepMTS-133"><span class="linenos">133</span></a><span class="sd">        n_layers: int, optional (default=3)</span>
</span><span id="LazyDeepMTS-134"><a href="#LazyDeepMTS-134"><span class="linenos">134</span></a><span class="sd">            Number of layers of CustomRegressors to be used.</span>
</span><span id="LazyDeepMTS-135"><a href="#LazyDeepMTS-135"><span class="linenos">135</span></a>
</span><span id="LazyDeepMTS-136"><a href="#LazyDeepMTS-136"><span class="linenos">136</span></a><span class="sd">        All the other parameters are the same as MTS&#39;s.</span>
</span><span id="LazyDeepMTS-137"><a href="#LazyDeepMTS-137"><span class="linenos">137</span></a>
</span><span id="LazyDeepMTS-138"><a href="#LazyDeepMTS-138"><span class="linenos">138</span></a><span class="sd">    Examples</span>
</span><span id="LazyDeepMTS-139"><a href="#LazyDeepMTS-139"><span class="linenos">139</span></a>
</span><span id="LazyDeepMTS-140"><a href="#LazyDeepMTS-140"><span class="linenos">140</span></a><span class="sd">        See https://github.com/Techtonique/nnetsauce/blob/master/nnetsauce/demo/thierrymoudiki_20240106_LazyDeepMTS.ipynb</span>
</span><span id="LazyDeepMTS-141"><a href="#LazyDeepMTS-141"><span class="linenos">141</span></a>
</span><span id="LazyDeepMTS-142"><a href="#LazyDeepMTS-142"><span class="linenos">142</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LazyDeepMTS-143"><a href="#LazyDeepMTS-143"><span class="linenos">143</span></a>
</span><span id="LazyDeepMTS-144"><a href="#LazyDeepMTS-144"><span class="linenos">144</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyDeepMTS-145"><a href="#LazyDeepMTS-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="LazyDeepMTS-146"><a href="#LazyDeepMTS-146"><span class="linenos">146</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyDeepMTS-147"><a href="#LazyDeepMTS-147"><span class="linenos">147</span></a>        <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepMTS-148"><a href="#LazyDeepMTS-148"><span class="linenos">148</span></a>        <span class="n">custom_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepMTS-149"><a href="#LazyDeepMTS-149"><span class="linenos">149</span></a>        <span class="n">predictions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyDeepMTS-150"><a href="#LazyDeepMTS-150"><span class="linenos">150</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="LazyDeepMTS-151"><a href="#LazyDeepMTS-151"><span class="linenos">151</span></a>        <span class="n">estimators</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-152"><a href="#LazyDeepMTS-152"><span class="linenos">152</span></a>        <span class="n">preprocess</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyDeepMTS-153"><a href="#LazyDeepMTS-153"><span class="linenos">153</span></a>        <span class="c1"># Defining depth</span>
</span><span id="LazyDeepMTS-154"><a href="#LazyDeepMTS-154"><span class="linenos">154</span></a>        <span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="LazyDeepMTS-155"><a href="#LazyDeepMTS-155"><span class="linenos">155</span></a>        <span class="c1"># MTS attributes</span>
</span><span id="LazyDeepMTS-156"><a href="#LazyDeepMTS-156"><span class="linenos">156</span></a>        <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepMTS-157"><a href="#LazyDeepMTS-157"><span class="linenos">157</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="LazyDeepMTS-158"><a href="#LazyDeepMTS-158"><span class="linenos">158</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-159"><a href="#LazyDeepMTS-159"><span class="linenos">159</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="LazyDeepMTS-160"><a href="#LazyDeepMTS-160"><span class="linenos">160</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-161"><a href="#LazyDeepMTS-161"><span class="linenos">161</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepMTS-162"><a href="#LazyDeepMTS-162"><span class="linenos">162</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyDeepMTS-163"><a href="#LazyDeepMTS-163"><span class="linenos">163</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepMTS-164"><a href="#LazyDeepMTS-164"><span class="linenos">164</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="LazyDeepMTS-165"><a href="#LazyDeepMTS-165"><span class="linenos">165</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepMTS-166"><a href="#LazyDeepMTS-166"><span class="linenos">166</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-167"><a href="#LazyDeepMTS-167"><span class="linenos">167</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="LazyDeepMTS-168"><a href="#LazyDeepMTS-168"><span class="linenos">168</span></a>        <span class="n">lags</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyDeepMTS-169"><a href="#LazyDeepMTS-169"><span class="linenos">169</span></a>        <span class="n">type_pi</span><span class="o">=</span><span class="s2">&quot;kde&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-170"><a href="#LazyDeepMTS-170"><span class="linenos">170</span></a>        <span class="n">replications</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepMTS-171"><a href="#LazyDeepMTS-171"><span class="linenos">171</span></a>        <span class="n">kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepMTS-172"><a href="#LazyDeepMTS-172"><span class="linenos">172</span></a>        <span class="n">agg</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-173"><a href="#LazyDeepMTS-173"><span class="linenos">173</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="LazyDeepMTS-174"><a href="#LazyDeepMTS-174"><span class="linenos">174</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-175"><a href="#LazyDeepMTS-175"><span class="linenos">175</span></a>        <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyDeepMTS-176"><a href="#LazyDeepMTS-176"><span class="linenos">176</span></a>    <span class="p">):</span>
</span><span id="LazyDeepMTS-177"><a href="#LazyDeepMTS-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="LazyDeepMTS-178"><a href="#LazyDeepMTS-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="o">=</span> <span class="n">ignore_warnings</span>
</span><span id="LazyDeepMTS-179"><a href="#LazyDeepMTS-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="o">=</span> <span class="n">custom_metric</span>
</span><span id="LazyDeepMTS-180"><a href="#LazyDeepMTS-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span>
</span><span id="LazyDeepMTS-181"><a href="#LazyDeepMTS-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepMTS-182"><a href="#LazyDeepMTS-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="LazyDeepMTS-183"><a href="#LazyDeepMTS-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">=</span> <span class="n">estimators</span>
</span><span id="LazyDeepMTS-184"><a href="#LazyDeepMTS-184"><span class="linenos">184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="o">=</span> <span class="n">preprocess</span>
</span><span id="LazyDeepMTS-185"><a href="#LazyDeepMTS-185"><span class="linenos">185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">=</span> <span class="n">n_layers</span>
</span><span id="LazyDeepMTS-186"><a href="#LazyDeepMTS-186"><span class="linenos">186</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyDeepMTS-187"><a href="#LazyDeepMTS-187"><span class="linenos">187</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="LazyDeepMTS-188"><a href="#LazyDeepMTS-188"><span class="linenos">188</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS-189"><a href="#LazyDeepMTS-189"><span class="linenos">189</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS-190"><a href="#LazyDeepMTS-190"><span class="linenos">190</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS-191"><a href="#LazyDeepMTS-191"><span class="linenos">191</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS-192"><a href="#LazyDeepMTS-192"><span class="linenos">192</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS-193"><a href="#LazyDeepMTS-193"><span class="linenos">193</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS-194"><a href="#LazyDeepMTS-194"><span class="linenos">194</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS-195"><a href="#LazyDeepMTS-195"><span class="linenos">195</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS-196"><a href="#LazyDeepMTS-196"><span class="linenos">196</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS-197"><a href="#LazyDeepMTS-197"><span class="linenos">197</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS-198"><a href="#LazyDeepMTS-198"><span class="linenos">198</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS-199"><a href="#LazyDeepMTS-199"><span class="linenos">199</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS-200"><a href="#LazyDeepMTS-200"><span class="linenos">200</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS-201"><a href="#LazyDeepMTS-201"><span class="linenos">201</span></a>            <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS-202"><a href="#LazyDeepMTS-202"><span class="linenos">202</span></a>            <span class="n">type_pi</span><span class="o">=</span><span class="n">type_pi</span><span class="p">,</span>
</span><span id="LazyDeepMTS-203"><a href="#LazyDeepMTS-203"><span class="linenos">203</span></a>            <span class="n">replications</span><span class="o">=</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS-204"><a href="#LazyDeepMTS-204"><span class="linenos">204</span></a>            <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS-205"><a href="#LazyDeepMTS-205"><span class="linenos">205</span></a>            <span class="n">agg</span><span class="o">=</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS-206"><a href="#LazyDeepMTS-206"><span class="linenos">206</span></a>            <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS-207"><a href="#LazyDeepMTS-207"><span class="linenos">207</span></a>        <span class="p">)</span>
</span><span id="LazyDeepMTS-208"><a href="#LazyDeepMTS-208"><span class="linenos">208</span></a>
</span><span id="LazyDeepMTS-209"><a href="#LazyDeepMTS-209"><span class="linenos">209</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">xreg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="LazyDeepMTS-210"><a href="#LazyDeepMTS-210"><span class="linenos">210</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X_train, predict and score on X_test.</span>
</span><span id="LazyDeepMTS-211"><a href="#LazyDeepMTS-211"><span class="linenos">211</span></a>
</span><span id="LazyDeepMTS-212"><a href="#LazyDeepMTS-212"><span class="linenos">212</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepMTS-213"><a href="#LazyDeepMTS-213"><span class="linenos">213</span></a>
</span><span id="LazyDeepMTS-214"><a href="#LazyDeepMTS-214"><span class="linenos">214</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyDeepMTS-215"><a href="#LazyDeepMTS-215"><span class="linenos">215</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepMTS-216"><a href="#LazyDeepMTS-216"><span class="linenos">216</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepMTS-217"><a href="#LazyDeepMTS-217"><span class="linenos">217</span></a>
</span><span id="LazyDeepMTS-218"><a href="#LazyDeepMTS-218"><span class="linenos">218</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyDeepMTS-219"><a href="#LazyDeepMTS-219"><span class="linenos">219</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepMTS-220"><a href="#LazyDeepMTS-220"><span class="linenos">220</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepMTS-221"><a href="#LazyDeepMTS-221"><span class="linenos">221</span></a>
</span><span id="LazyDeepMTS-222"><a href="#LazyDeepMTS-222"><span class="linenos">222</span></a><span class="sd">            xreg: {array-like}, shape = [n_samples, n_features_xreg]</span>
</span><span id="LazyDeepMTS-223"><a href="#LazyDeepMTS-223"><span class="linenos">223</span></a><span class="sd">                Additional (external) regressors to be passed to self.obj</span>
</span><span id="LazyDeepMTS-224"><a href="#LazyDeepMTS-224"><span class="linenos">224</span></a><span class="sd">                xreg must be in &#39;increasing&#39; order (most recent observations last)</span>
</span><span id="LazyDeepMTS-225"><a href="#LazyDeepMTS-225"><span class="linenos">225</span></a>
</span><span id="LazyDeepMTS-226"><a href="#LazyDeepMTS-226"><span class="linenos">226</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepMTS-227"><a href="#LazyDeepMTS-227"><span class="linenos">227</span></a>
</span><span id="LazyDeepMTS-228"><a href="#LazyDeepMTS-228"><span class="linenos">228</span></a><span class="sd">            scores : Pandas DataFrame</span>
</span><span id="LazyDeepMTS-229"><a href="#LazyDeepMTS-229"><span class="linenos">229</span></a><span class="sd">                Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepMTS-230"><a href="#LazyDeepMTS-230"><span class="linenos">230</span></a>
</span><span id="LazyDeepMTS-231"><a href="#LazyDeepMTS-231"><span class="linenos">231</span></a><span class="sd">            predictions : Pandas DataFrame</span>
</span><span id="LazyDeepMTS-232"><a href="#LazyDeepMTS-232"><span class="linenos">232</span></a><span class="sd">                Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepMTS-233"><a href="#LazyDeepMTS-233"><span class="linenos">233</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepMTS-234"><a href="#LazyDeepMTS-234"><span class="linenos">234</span></a>        <span class="n">R2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-235"><a href="#LazyDeepMTS-235"><span class="linenos">235</span></a>        <span class="n">ADJR2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-236"><a href="#LazyDeepMTS-236"><span class="linenos">236</span></a>        <span class="n">ME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-237"><a href="#LazyDeepMTS-237"><span class="linenos">237</span></a>        <span class="n">MPL</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-238"><a href="#LazyDeepMTS-238"><span class="linenos">238</span></a>        <span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-239"><a href="#LazyDeepMTS-239"><span class="linenos">239</span></a>        <span class="n">MAE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-240"><a href="#LazyDeepMTS-240"><span class="linenos">240</span></a>        <span class="n">MPE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-241"><a href="#LazyDeepMTS-241"><span class="linenos">241</span></a>        <span class="n">MAPE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-242"><a href="#LazyDeepMTS-242"><span class="linenos">242</span></a>        <span class="n">WINKLERSCORE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-243"><a href="#LazyDeepMTS-243"><span class="linenos">243</span></a>        <span class="n">COVERAGE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-244"><a href="#LazyDeepMTS-244"><span class="linenos">244</span></a>
</span><span id="LazyDeepMTS-245"><a href="#LazyDeepMTS-245"><span class="linenos">245</span></a>        <span class="c1"># WIN = []</span>
</span><span id="LazyDeepMTS-246"><a href="#LazyDeepMTS-246"><span class="linenos">246</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-247"><a href="#LazyDeepMTS-247"><span class="linenos">247</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-248"><a href="#LazyDeepMTS-248"><span class="linenos">248</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepMTS-249"><a href="#LazyDeepMTS-249"><span class="linenos">249</span></a>
</span><span id="LazyDeepMTS-250"><a href="#LazyDeepMTS-250"><span class="linenos">250</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS-251"><a href="#LazyDeepMTS-251"><span class="linenos">251</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-252"><a href="#LazyDeepMTS-252"><span class="linenos">252</span></a>
</span><span id="LazyDeepMTS-253"><a href="#LazyDeepMTS-253"><span class="linenos">253</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyDeepMTS-254"><a href="#LazyDeepMTS-254"><span class="linenos">254</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyDeepMTS-255"><a href="#LazyDeepMTS-255"><span class="linenos">255</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepMTS-256"><a href="#LazyDeepMTS-256"><span class="linenos">256</span></a>
</span><span id="LazyDeepMTS-257"><a href="#LazyDeepMTS-257"><span class="linenos">257</span></a>        <span class="n">X_train</span> <span class="o">=</span> <span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyDeepMTS-258"><a href="#LazyDeepMTS-258"><span class="linenos">258</span></a>        <span class="n">X_test</span> <span class="o">=</span> <span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepMTS-259"><a href="#LazyDeepMTS-259"><span class="linenos">259</span></a>
</span><span id="LazyDeepMTS-260"><a href="#LazyDeepMTS-260"><span class="linenos">260</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepMTS-261"><a href="#LazyDeepMTS-261"><span class="linenos">261</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepMTS-262"><a href="#LazyDeepMTS-262"><span class="linenos">262</span></a>
</span><span id="LazyDeepMTS-263"><a href="#LazyDeepMTS-263"><span class="linenos">263</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyDeepMTS-264"><a href="#LazyDeepMTS-264"><span class="linenos">264</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyDeepMTS-265"><a href="#LazyDeepMTS-265"><span class="linenos">265</span></a>        <span class="p">)</span>
</span><span id="LazyDeepMTS-266"><a href="#LazyDeepMTS-266"><span class="linenos">266</span></a>
</span><span id="LazyDeepMTS-267"><a href="#LazyDeepMTS-267"><span class="linenos">267</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span><span class="p">:</span>
</span><span id="LazyDeepMTS-268"><a href="#LazyDeepMTS-268"><span class="linenos">268</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyDeepMTS-269"><a href="#LazyDeepMTS-269"><span class="linenos">269</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepMTS-270"><a href="#LazyDeepMTS-270"><span class="linenos">270</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyDeepMTS-271"><a href="#LazyDeepMTS-271"><span class="linenos">271</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepMTS-272"><a href="#LazyDeepMTS-272"><span class="linenos">272</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-273"><a href="#LazyDeepMTS-273"><span class="linenos">273</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyDeepMTS-274"><a href="#LazyDeepMTS-274"><span class="linenos">274</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyDeepMTS-275"><a href="#LazyDeepMTS-275"><span class="linenos">275</span></a>                    <span class="p">),</span>
</span><span id="LazyDeepMTS-276"><a href="#LazyDeepMTS-276"><span class="linenos">276</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepMTS-277"><a href="#LazyDeepMTS-277"><span class="linenos">277</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-278"><a href="#LazyDeepMTS-278"><span class="linenos">278</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyDeepMTS-279"><a href="#LazyDeepMTS-279"><span class="linenos">279</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyDeepMTS-280"><a href="#LazyDeepMTS-280"><span class="linenos">280</span></a>                    <span class="p">),</span>
</span><span id="LazyDeepMTS-281"><a href="#LazyDeepMTS-281"><span class="linenos">281</span></a>                <span class="p">]</span>
</span><span id="LazyDeepMTS-282"><a href="#LazyDeepMTS-282"><span class="linenos">282</span></a>            <span class="p">)</span>
</span><span id="LazyDeepMTS-283"><a href="#LazyDeepMTS-283"><span class="linenos">283</span></a>
</span><span id="LazyDeepMTS-284"><a href="#LazyDeepMTS-284"><span class="linenos">284</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyDeepMTS-285"><a href="#LazyDeepMTS-285"><span class="linenos">285</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="n">DEEPREGRESSORSMTS</span>
</span><span id="LazyDeepMTS-286"><a href="#LazyDeepMTS-286"><span class="linenos">286</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS-287"><a href="#LazyDeepMTS-287"><span class="linenos">287</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyDeepMTS-288"><a href="#LazyDeepMTS-288"><span class="linenos">288</span></a>                <span class="p">(</span><span class="s2">&quot;DeepMTS(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyDeepMTS-289"><a href="#LazyDeepMTS-289"><span class="linenos">289</span></a>                <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepMTS-290"><a href="#LazyDeepMTS-290"><span class="linenos">290</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepMTS-291"><a href="#LazyDeepMTS-291"><span class="linenos">291</span></a>                    <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyDeepMTS-292"><a href="#LazyDeepMTS-292"><span class="linenos">292</span></a>                    <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepMTS-293"><a href="#LazyDeepMTS-293"><span class="linenos">293</span></a>                <span class="p">)</span>
</span><span id="LazyDeepMTS-294"><a href="#LazyDeepMTS-294"><span class="linenos">294</span></a>            <span class="p">]</span>
</span><span id="LazyDeepMTS-295"><a href="#LazyDeepMTS-295"><span class="linenos">295</span></a>
</span><span id="LazyDeepMTS-296"><a href="#LazyDeepMTS-296"><span class="linenos">296</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyDeepMTS-297"><a href="#LazyDeepMTS-297"><span class="linenos">297</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepMTS-298"><a href="#LazyDeepMTS-298"><span class="linenos">298</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepMTS-299"><a href="#LazyDeepMTS-299"><span class="linenos">299</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepMTS-300"><a href="#LazyDeepMTS-300"><span class="linenos">300</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepMTS-301"><a href="#LazyDeepMTS-301"><span class="linenos">301</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyDeepMTS-302"><a href="#LazyDeepMTS-302"><span class="linenos">302</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepMTS-303"><a href="#LazyDeepMTS-303"><span class="linenos">303</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyDeepMTS-304"><a href="#LazyDeepMTS-304"><span class="linenos">304</span></a>                                <span class="p">(</span>
</span><span id="LazyDeepMTS-305"><a href="#LazyDeepMTS-305"><span class="linenos">305</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-306"><a href="#LazyDeepMTS-306"><span class="linenos">306</span></a>                                    <span class="n">DeepMTS</span><span class="p">(</span>
</span><span id="LazyDeepMTS-307"><a href="#LazyDeepMTS-307"><span class="linenos">307</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyDeepMTS-308"><a href="#LazyDeepMTS-308"><span class="linenos">308</span></a>                                            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="LazyDeepMTS-309"><a href="#LazyDeepMTS-309"><span class="linenos">309</span></a>                                            <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyDeepMTS-310"><a href="#LazyDeepMTS-310"><span class="linenos">310</span></a>                                        <span class="p">),</span>
</span><span id="LazyDeepMTS-311"><a href="#LazyDeepMTS-311"><span class="linenos">311</span></a>                                        <span class="n">n_layers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">,</span>
</span><span id="LazyDeepMTS-312"><a href="#LazyDeepMTS-312"><span class="linenos">312</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS-313"><a href="#LazyDeepMTS-313"><span class="linenos">313</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS-314"><a href="#LazyDeepMTS-314"><span class="linenos">314</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS-315"><a href="#LazyDeepMTS-315"><span class="linenos">315</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS-316"><a href="#LazyDeepMTS-316"><span class="linenos">316</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS-317"><a href="#LazyDeepMTS-317"><span class="linenos">317</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS-318"><a href="#LazyDeepMTS-318"><span class="linenos">318</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS-319"><a href="#LazyDeepMTS-319"><span class="linenos">319</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS-320"><a href="#LazyDeepMTS-320"><span class="linenos">320</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS-321"><a href="#LazyDeepMTS-321"><span class="linenos">321</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS-322"><a href="#LazyDeepMTS-322"><span class="linenos">322</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS-323"><a href="#LazyDeepMTS-323"><span class="linenos">323</span></a>                                        <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS-324"><a href="#LazyDeepMTS-324"><span class="linenos">324</span></a>                                        <span class="n">type_pi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span><span class="p">,</span>
</span><span id="LazyDeepMTS-325"><a href="#LazyDeepMTS-325"><span class="linenos">325</span></a>                                        <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS-326"><a href="#LazyDeepMTS-326"><span class="linenos">326</span></a>                                        <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS-327"><a href="#LazyDeepMTS-327"><span class="linenos">327</span></a>                                        <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS-328"><a href="#LazyDeepMTS-328"><span class="linenos">328</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS-329"><a href="#LazyDeepMTS-329"><span class="linenos">329</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS-330"><a href="#LazyDeepMTS-330"><span class="linenos">330</span></a>                                        <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS-331"><a href="#LazyDeepMTS-331"><span class="linenos">331</span></a>                                    <span class="p">),</span>
</span><span id="LazyDeepMTS-332"><a href="#LazyDeepMTS-332"><span class="linenos">332</span></a>                                <span class="p">),</span>
</span><span id="LazyDeepMTS-333"><a href="#LazyDeepMTS-333"><span class="linenos">333</span></a>                            <span class="p">]</span>
</span><span id="LazyDeepMTS-334"><a href="#LazyDeepMTS-334"><span class="linenos">334</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS-335"><a href="#LazyDeepMTS-335"><span class="linenos">335</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS-336"><a href="#LazyDeepMTS-336"><span class="linenos">336</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyDeepMTS-337"><a href="#LazyDeepMTS-337"><span class="linenos">337</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepMTS-338"><a href="#LazyDeepMTS-338"><span class="linenos">338</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyDeepMTS-339"><a href="#LazyDeepMTS-339"><span class="linenos">339</span></a>                                <span class="p">(</span>
</span><span id="LazyDeepMTS-340"><a href="#LazyDeepMTS-340"><span class="linenos">340</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-341"><a href="#LazyDeepMTS-341"><span class="linenos">341</span></a>                                    <span class="n">DeepMTS</span><span class="p">(</span>
</span><span id="LazyDeepMTS-342"><a href="#LazyDeepMTS-342"><span class="linenos">342</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyDeepMTS-343"><a href="#LazyDeepMTS-343"><span class="linenos">343</span></a>                                        <span class="n">n_layers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">,</span>
</span><span id="LazyDeepMTS-344"><a href="#LazyDeepMTS-344"><span class="linenos">344</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS-345"><a href="#LazyDeepMTS-345"><span class="linenos">345</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS-346"><a href="#LazyDeepMTS-346"><span class="linenos">346</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS-347"><a href="#LazyDeepMTS-347"><span class="linenos">347</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS-348"><a href="#LazyDeepMTS-348"><span class="linenos">348</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS-349"><a href="#LazyDeepMTS-349"><span class="linenos">349</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS-350"><a href="#LazyDeepMTS-350"><span class="linenos">350</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS-351"><a href="#LazyDeepMTS-351"><span class="linenos">351</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS-352"><a href="#LazyDeepMTS-352"><span class="linenos">352</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS-353"><a href="#LazyDeepMTS-353"><span class="linenos">353</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS-354"><a href="#LazyDeepMTS-354"><span class="linenos">354</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS-355"><a href="#LazyDeepMTS-355"><span class="linenos">355</span></a>                                        <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS-356"><a href="#LazyDeepMTS-356"><span class="linenos">356</span></a>                                        <span class="n">type_pi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span><span class="p">,</span>
</span><span id="LazyDeepMTS-357"><a href="#LazyDeepMTS-357"><span class="linenos">357</span></a>                                        <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS-358"><a href="#LazyDeepMTS-358"><span class="linenos">358</span></a>                                        <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS-359"><a href="#LazyDeepMTS-359"><span class="linenos">359</span></a>                                        <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS-360"><a href="#LazyDeepMTS-360"><span class="linenos">360</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS-361"><a href="#LazyDeepMTS-361"><span class="linenos">361</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS-362"><a href="#LazyDeepMTS-362"><span class="linenos">362</span></a>                                        <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS-363"><a href="#LazyDeepMTS-363"><span class="linenos">363</span></a>                                    <span class="p">),</span>
</span><span id="LazyDeepMTS-364"><a href="#LazyDeepMTS-364"><span class="linenos">364</span></a>                                <span class="p">),</span>
</span><span id="LazyDeepMTS-365"><a href="#LazyDeepMTS-365"><span class="linenos">365</span></a>                            <span class="p">]</span>
</span><span id="LazyDeepMTS-366"><a href="#LazyDeepMTS-366"><span class="linenos">366</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS-367"><a href="#LazyDeepMTS-367"><span class="linenos">367</span></a>
</span><span id="LazyDeepMTS-368"><a href="#LazyDeepMTS-368"><span class="linenos">368</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="LazyDeepMTS-369"><a href="#LazyDeepMTS-369"><span class="linenos">369</span></a>                    <span class="c1"># pipe.fit(X_train, xreg=xreg)</span>
</span><span id="LazyDeepMTS-370"><a href="#LazyDeepMTS-370"><span class="linenos">370</span></a>
</span><span id="LazyDeepMTS-371"><a href="#LazyDeepMTS-371"><span class="linenos">371</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyDeepMTS-372"><a href="#LazyDeepMTS-372"><span class="linenos">372</span></a>                    <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">[</span><span class="s2">&quot;regressor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyDeepMTS-373"><a href="#LazyDeepMTS-373"><span class="linenos">373</span></a>                        <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyDeepMTS-374"><a href="#LazyDeepMTS-374"><span class="linenos">374</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepMTS-375"><a href="#LazyDeepMTS-375"><span class="linenos">375</span></a>
</span><span id="LazyDeepMTS-376"><a href="#LazyDeepMTS-376"><span class="linenos">376</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS-377"><a href="#LazyDeepMTS-377"><span class="linenos">377</span></a>                        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span>
</span><span id="LazyDeepMTS-378"><a href="#LazyDeepMTS-378"><span class="linenos">378</span></a>                            <span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span>
</span><span id="LazyDeepMTS-379"><a href="#LazyDeepMTS-379"><span class="linenos">379</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS-380"><a href="#LazyDeepMTS-380"><span class="linenos">380</span></a>                        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span><span id="LazyDeepMTS-381"><a href="#LazyDeepMTS-381"><span class="linenos">381</span></a>                        <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span><span id="LazyDeepMTS-382"><a href="#LazyDeepMTS-382"><span class="linenos">382</span></a>                        <span class="n">winklerscore</span> <span class="o">=</span> <span class="n">winkler_score</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
</span><span id="LazyDeepMTS-383"><a href="#LazyDeepMTS-383"><span class="linenos">383</span></a>                        <span class="n">coveragecalc</span> <span class="o">=</span> <span class="n">coverage</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
</span><span id="LazyDeepMTS-384"><a href="#LazyDeepMTS-384"><span class="linenos">384</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS-385"><a href="#LazyDeepMTS-385"><span class="linenos">385</span></a>                        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyDeepMTS-386"><a href="#LazyDeepMTS-386"><span class="linenos">386</span></a>                        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS-387"><a href="#LazyDeepMTS-387"><span class="linenos">387</span></a>                        <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS-388"><a href="#LazyDeepMTS-388"><span class="linenos">388</span></a>
</span><span id="LazyDeepMTS-389"><a href="#LazyDeepMTS-389"><span class="linenos">389</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepMTS-390"><a href="#LazyDeepMTS-390"><span class="linenos">390</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyDeepMTS-391"><a href="#LazyDeepMTS-391"><span class="linenos">391</span></a>                    <span class="n">MAE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</span><span id="LazyDeepMTS-392"><a href="#LazyDeepMTS-392"><span class="linenos">392</span></a>                    <span class="n">MPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpl</span><span class="p">)</span>
</span><span id="LazyDeepMTS-393"><a href="#LazyDeepMTS-393"><span class="linenos">393</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS-394"><a href="#LazyDeepMTS-394"><span class="linenos">394</span></a>                        <span class="n">WINKLERSCORE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">winklerscore</span><span class="p">)</span>
</span><span id="LazyDeepMTS-395"><a href="#LazyDeepMTS-395"><span class="linenos">395</span></a>                        <span class="n">COVERAGE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coveragecalc</span><span class="p">)</span>
</span><span id="LazyDeepMTS-396"><a href="#LazyDeepMTS-396"><span class="linenos">396</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepMTS-397"><a href="#LazyDeepMTS-397"><span class="linenos">397</span></a>
</span><span id="LazyDeepMTS-398"><a href="#LazyDeepMTS-398"><span class="linenos">398</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS-399"><a href="#LazyDeepMTS-399"><span class="linenos">399</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS-400"><a href="#LazyDeepMTS-400"><span class="linenos">400</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepMTS-401"><a href="#LazyDeepMTS-401"><span class="linenos">401</span></a>
</span><span id="LazyDeepMTS-402"><a href="#LazyDeepMTS-402"><span class="linenos">402</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepMTS-403"><a href="#LazyDeepMTS-403"><span class="linenos">403</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS-404"><a href="#LazyDeepMTS-404"><span class="linenos">404</span></a>                            <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS-405"><a href="#LazyDeepMTS-405"><span class="linenos">405</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepMTS-406"><a href="#LazyDeepMTS-406"><span class="linenos">406</span></a>                                <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyDeepMTS-407"><a href="#LazyDeepMTS-407"><span class="linenos">407</span></a>                                <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyDeepMTS-408"><a href="#LazyDeepMTS-408"><span class="linenos">408</span></a>                                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepMTS-409"><a href="#LazyDeepMTS-409"><span class="linenos">409</span></a>                                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyDeepMTS-410"><a href="#LazyDeepMTS-410"><span class="linenos">410</span></a>                                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyDeepMTS-411"><a href="#LazyDeepMTS-411"><span class="linenos">411</span></a>                                <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyDeepMTS-412"><a href="#LazyDeepMTS-412"><span class="linenos">412</span></a>                                <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyDeepMTS-413"><a href="#LazyDeepMTS-413"><span class="linenos">413</span></a>                                <span class="s2">&quot;WINKLERSCORE&quot;</span><span class="p">:</span> <span class="n">winklerscore</span><span class="p">,</span>
</span><span id="LazyDeepMTS-414"><a href="#LazyDeepMTS-414"><span class="linenos">414</span></a>                                <span class="s2">&quot;COVERAGE&quot;</span><span class="p">:</span> <span class="n">coveragecalc</span><span class="p">,</span>
</span><span id="LazyDeepMTS-415"><a href="#LazyDeepMTS-415"><span class="linenos">415</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepMTS-416"><a href="#LazyDeepMTS-416"><span class="linenos">416</span></a>                            <span class="p">}</span>
</span><span id="LazyDeepMTS-417"><a href="#LazyDeepMTS-417"><span class="linenos">417</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS-418"><a href="#LazyDeepMTS-418"><span class="linenos">418</span></a>                            <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS-419"><a href="#LazyDeepMTS-419"><span class="linenos">419</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepMTS-420"><a href="#LazyDeepMTS-420"><span class="linenos">420</span></a>                                <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyDeepMTS-421"><a href="#LazyDeepMTS-421"><span class="linenos">421</span></a>                                <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyDeepMTS-422"><a href="#LazyDeepMTS-422"><span class="linenos">422</span></a>                                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepMTS-423"><a href="#LazyDeepMTS-423"><span class="linenos">423</span></a>                                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyDeepMTS-424"><a href="#LazyDeepMTS-424"><span class="linenos">424</span></a>                                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyDeepMTS-425"><a href="#LazyDeepMTS-425"><span class="linenos">425</span></a>                                <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyDeepMTS-426"><a href="#LazyDeepMTS-426"><span class="linenos">426</span></a>                                <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyDeepMTS-427"><a href="#LazyDeepMTS-427"><span class="linenos">427</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepMTS-428"><a href="#LazyDeepMTS-428"><span class="linenos">428</span></a>                            <span class="p">}</span>
</span><span id="LazyDeepMTS-429"><a href="#LazyDeepMTS-429"><span class="linenos">429</span></a>
</span><span id="LazyDeepMTS-430"><a href="#LazyDeepMTS-430"><span class="linenos">430</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS-431"><a href="#LazyDeepMTS-431"><span class="linenos">431</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepMTS-432"><a href="#LazyDeepMTS-432"><span class="linenos">432</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyDeepMTS-433"><a href="#LazyDeepMTS-433"><span class="linenos">433</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepMTS-434"><a href="#LazyDeepMTS-434"><span class="linenos">434</span></a>
</span><span id="LazyDeepMTS-435"><a href="#LazyDeepMTS-435"><span class="linenos">435</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyDeepMTS-436"><a href="#LazyDeepMTS-436"><span class="linenos">436</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepMTS-437"><a href="#LazyDeepMTS-437"><span class="linenos">437</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_pred</span>
</span><span id="LazyDeepMTS-438"><a href="#LazyDeepMTS-438"><span class="linenos">438</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepMTS-439"><a href="#LazyDeepMTS-439"><span class="linenos">439</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepMTS-440"><a href="#LazyDeepMTS-440"><span class="linenos">440</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepMTS-441"><a href="#LazyDeepMTS-441"><span class="linenos">441</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepMTS-442"><a href="#LazyDeepMTS-442"><span class="linenos">442</span></a>
</span><span id="LazyDeepMTS-443"><a href="#LazyDeepMTS-443"><span class="linenos">443</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># no preprocessing</span>
</span><span id="LazyDeepMTS-444"><a href="#LazyDeepMTS-444"><span class="linenos">444</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepMTS-445"><a href="#LazyDeepMTS-445"><span class="linenos">445</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepMTS-446"><a href="#LazyDeepMTS-446"><span class="linenos">446</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepMTS-447"><a href="#LazyDeepMTS-447"><span class="linenos">447</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepMTS-448"><a href="#LazyDeepMTS-448"><span class="linenos">448</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">DeepMTS</span><span class="p">(</span>
</span><span id="LazyDeepMTS-449"><a href="#LazyDeepMTS-449"><span class="linenos">449</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyDeepMTS-450"><a href="#LazyDeepMTS-450"><span class="linenos">450</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS-451"><a href="#LazyDeepMTS-451"><span class="linenos">451</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS-452"><a href="#LazyDeepMTS-452"><span class="linenos">452</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS-453"><a href="#LazyDeepMTS-453"><span class="linenos">453</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS-454"><a href="#LazyDeepMTS-454"><span class="linenos">454</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS-455"><a href="#LazyDeepMTS-455"><span class="linenos">455</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS-456"><a href="#LazyDeepMTS-456"><span class="linenos">456</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS-457"><a href="#LazyDeepMTS-457"><span class="linenos">457</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS-458"><a href="#LazyDeepMTS-458"><span class="linenos">458</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS-459"><a href="#LazyDeepMTS-459"><span class="linenos">459</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS-460"><a href="#LazyDeepMTS-460"><span class="linenos">460</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS-461"><a href="#LazyDeepMTS-461"><span class="linenos">461</span></a>                            <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS-462"><a href="#LazyDeepMTS-462"><span class="linenos">462</span></a>                            <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS-463"><a href="#LazyDeepMTS-463"><span class="linenos">463</span></a>                            <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS-464"><a href="#LazyDeepMTS-464"><span class="linenos">464</span></a>                            <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS-465"><a href="#LazyDeepMTS-465"><span class="linenos">465</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS-466"><a href="#LazyDeepMTS-466"><span class="linenos">466</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS-467"><a href="#LazyDeepMTS-467"><span class="linenos">467</span></a>                            <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS-468"><a href="#LazyDeepMTS-468"><span class="linenos">468</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS-469"><a href="#LazyDeepMTS-469"><span class="linenos">469</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS-470"><a href="#LazyDeepMTS-470"><span class="linenos">470</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">DeepMTS</span><span class="p">(</span>
</span><span id="LazyDeepMTS-471"><a href="#LazyDeepMTS-471"><span class="linenos">471</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyDeepMTS-472"><a href="#LazyDeepMTS-472"><span class="linenos">472</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS-473"><a href="#LazyDeepMTS-473"><span class="linenos">473</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS-474"><a href="#LazyDeepMTS-474"><span class="linenos">474</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS-475"><a href="#LazyDeepMTS-475"><span class="linenos">475</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS-476"><a href="#LazyDeepMTS-476"><span class="linenos">476</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS-477"><a href="#LazyDeepMTS-477"><span class="linenos">477</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS-478"><a href="#LazyDeepMTS-478"><span class="linenos">478</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS-479"><a href="#LazyDeepMTS-479"><span class="linenos">479</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS-480"><a href="#LazyDeepMTS-480"><span class="linenos">480</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS-481"><a href="#LazyDeepMTS-481"><span class="linenos">481</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS-482"><a href="#LazyDeepMTS-482"><span class="linenos">482</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS-483"><a href="#LazyDeepMTS-483"><span class="linenos">483</span></a>                            <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS-484"><a href="#LazyDeepMTS-484"><span class="linenos">484</span></a>                            <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS-485"><a href="#LazyDeepMTS-485"><span class="linenos">485</span></a>                            <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS-486"><a href="#LazyDeepMTS-486"><span class="linenos">486</span></a>                            <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS-487"><a href="#LazyDeepMTS-487"><span class="linenos">487</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS-488"><a href="#LazyDeepMTS-488"><span class="linenos">488</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS-489"><a href="#LazyDeepMTS-489"><span class="linenos">489</span></a>                            <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS-490"><a href="#LazyDeepMTS-490"><span class="linenos">490</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS-491"><a href="#LazyDeepMTS-491"><span class="linenos">491</span></a>
</span><span id="LazyDeepMTS-492"><a href="#LazyDeepMTS-492"><span class="linenos">492</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="LazyDeepMTS-493"><a href="#LazyDeepMTS-493"><span class="linenos">493</span></a>                    <span class="c1"># pipe.fit(X_train, xreg=xreg) # DO xreg like in `ahead`</span>
</span><span id="LazyDeepMTS-494"><a href="#LazyDeepMTS-494"><span class="linenos">494</span></a>
</span><span id="LazyDeepMTS-495"><a href="#LazyDeepMTS-495"><span class="linenos">495</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyDeepMTS-496"><a href="#LazyDeepMTS-496"><span class="linenos">496</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyDeepMTS-497"><a href="#LazyDeepMTS-497"><span class="linenos">497</span></a>                        <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">[</span><span class="s2">&quot;regressor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyDeepMTS-498"><a href="#LazyDeepMTS-498"><span class="linenos">498</span></a>                            <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyDeepMTS-499"><a href="#LazyDeepMTS-499"><span class="linenos">499</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS-500"><a href="#LazyDeepMTS-500"><span class="linenos">500</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS-501"><a href="#LazyDeepMTS-501"><span class="linenos">501</span></a>                        <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyDeepMTS-502"><a href="#LazyDeepMTS-502"><span class="linenos">502</span></a>                            <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyDeepMTS-503"><a href="#LazyDeepMTS-503"><span class="linenos">503</span></a>                        <span class="p">)</span>  <span class="c1"># X_pred = pipe.predict(h=X_test.shape[0], new_xreg=new_xreg) ## DO xreg like in `ahead`</span>
</span><span id="LazyDeepMTS-504"><a href="#LazyDeepMTS-504"><span class="linenos">504</span></a>
</span><span id="LazyDeepMTS-505"><a href="#LazyDeepMTS-505"><span class="linenos">505</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS-506"><a href="#LazyDeepMTS-506"><span class="linenos">506</span></a>                        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span>
</span><span id="LazyDeepMTS-507"><a href="#LazyDeepMTS-507"><span class="linenos">507</span></a>                            <span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span>
</span><span id="LazyDeepMTS-508"><a href="#LazyDeepMTS-508"><span class="linenos">508</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS-509"><a href="#LazyDeepMTS-509"><span class="linenos">509</span></a>                        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span><span id="LazyDeepMTS-510"><a href="#LazyDeepMTS-510"><span class="linenos">510</span></a>                        <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span><span id="LazyDeepMTS-511"><a href="#LazyDeepMTS-511"><span class="linenos">511</span></a>                        <span class="n">winklerscore</span> <span class="o">=</span> <span class="n">winkler_score</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
</span><span id="LazyDeepMTS-512"><a href="#LazyDeepMTS-512"><span class="linenos">512</span></a>                        <span class="n">coveragecalc</span> <span class="o">=</span> <span class="n">coverage</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
</span><span id="LazyDeepMTS-513"><a href="#LazyDeepMTS-513"><span class="linenos">513</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS-514"><a href="#LazyDeepMTS-514"><span class="linenos">514</span></a>                        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyDeepMTS-515"><a href="#LazyDeepMTS-515"><span class="linenos">515</span></a>                        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS-516"><a href="#LazyDeepMTS-516"><span class="linenos">516</span></a>                        <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS-517"><a href="#LazyDeepMTS-517"><span class="linenos">517</span></a>
</span><span id="LazyDeepMTS-518"><a href="#LazyDeepMTS-518"><span class="linenos">518</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepMTS-519"><a href="#LazyDeepMTS-519"><span class="linenos">519</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyDeepMTS-520"><a href="#LazyDeepMTS-520"><span class="linenos">520</span></a>                    <span class="n">MAE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</span><span id="LazyDeepMTS-521"><a href="#LazyDeepMTS-521"><span class="linenos">521</span></a>                    <span class="n">MPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpl</span><span class="p">)</span>
</span><span id="LazyDeepMTS-522"><a href="#LazyDeepMTS-522"><span class="linenos">522</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS-523"><a href="#LazyDeepMTS-523"><span class="linenos">523</span></a>                        <span class="n">WINKLERSCORE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">winklerscore</span><span class="p">)</span>
</span><span id="LazyDeepMTS-524"><a href="#LazyDeepMTS-524"><span class="linenos">524</span></a>                        <span class="n">COVERAGE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coveragecalc</span><span class="p">)</span>
</span><span id="LazyDeepMTS-525"><a href="#LazyDeepMTS-525"><span class="linenos">525</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepMTS-526"><a href="#LazyDeepMTS-526"><span class="linenos">526</span></a>
</span><span id="LazyDeepMTS-527"><a href="#LazyDeepMTS-527"><span class="linenos">527</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS-528"><a href="#LazyDeepMTS-528"><span class="linenos">528</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS-529"><a href="#LazyDeepMTS-529"><span class="linenos">529</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepMTS-530"><a href="#LazyDeepMTS-530"><span class="linenos">530</span></a>
</span><span id="LazyDeepMTS-531"><a href="#LazyDeepMTS-531"><span class="linenos">531</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepMTS-532"><a href="#LazyDeepMTS-532"><span class="linenos">532</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS-533"><a href="#LazyDeepMTS-533"><span class="linenos">533</span></a>                            <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS-534"><a href="#LazyDeepMTS-534"><span class="linenos">534</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepMTS-535"><a href="#LazyDeepMTS-535"><span class="linenos">535</span></a>                                <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyDeepMTS-536"><a href="#LazyDeepMTS-536"><span class="linenos">536</span></a>                                <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyDeepMTS-537"><a href="#LazyDeepMTS-537"><span class="linenos">537</span></a>                                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepMTS-538"><a href="#LazyDeepMTS-538"><span class="linenos">538</span></a>                                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyDeepMTS-539"><a href="#LazyDeepMTS-539"><span class="linenos">539</span></a>                                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyDeepMTS-540"><a href="#LazyDeepMTS-540"><span class="linenos">540</span></a>                                <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyDeepMTS-541"><a href="#LazyDeepMTS-541"><span class="linenos">541</span></a>                                <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyDeepMTS-542"><a href="#LazyDeepMTS-542"><span class="linenos">542</span></a>                                <span class="s2">&quot;WINKLERSCORE&quot;</span><span class="p">:</span> <span class="n">winklerscore</span><span class="p">,</span>
</span><span id="LazyDeepMTS-543"><a href="#LazyDeepMTS-543"><span class="linenos">543</span></a>                                <span class="s2">&quot;COVERAGE&quot;</span><span class="p">:</span> <span class="n">coveragecalc</span><span class="p">,</span>
</span><span id="LazyDeepMTS-544"><a href="#LazyDeepMTS-544"><span class="linenos">544</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepMTS-545"><a href="#LazyDeepMTS-545"><span class="linenos">545</span></a>                            <span class="p">}</span>
</span><span id="LazyDeepMTS-546"><a href="#LazyDeepMTS-546"><span class="linenos">546</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS-547"><a href="#LazyDeepMTS-547"><span class="linenos">547</span></a>                            <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS-548"><a href="#LazyDeepMTS-548"><span class="linenos">548</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepMTS-549"><a href="#LazyDeepMTS-549"><span class="linenos">549</span></a>                                <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyDeepMTS-550"><a href="#LazyDeepMTS-550"><span class="linenos">550</span></a>                                <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyDeepMTS-551"><a href="#LazyDeepMTS-551"><span class="linenos">551</span></a>                                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepMTS-552"><a href="#LazyDeepMTS-552"><span class="linenos">552</span></a>                                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyDeepMTS-553"><a href="#LazyDeepMTS-553"><span class="linenos">553</span></a>                                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyDeepMTS-554"><a href="#LazyDeepMTS-554"><span class="linenos">554</span></a>                                <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyDeepMTS-555"><a href="#LazyDeepMTS-555"><span class="linenos">555</span></a>                                <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyDeepMTS-556"><a href="#LazyDeepMTS-556"><span class="linenos">556</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepMTS-557"><a href="#LazyDeepMTS-557"><span class="linenos">557</span></a>                            <span class="p">}</span>
</span><span id="LazyDeepMTS-558"><a href="#LazyDeepMTS-558"><span class="linenos">558</span></a>
</span><span id="LazyDeepMTS-559"><a href="#LazyDeepMTS-559"><span class="linenos">559</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS-560"><a href="#LazyDeepMTS-560"><span class="linenos">560</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepMTS-561"><a href="#LazyDeepMTS-561"><span class="linenos">561</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyDeepMTS-562"><a href="#LazyDeepMTS-562"><span class="linenos">562</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepMTS-563"><a href="#LazyDeepMTS-563"><span class="linenos">563</span></a>
</span><span id="LazyDeepMTS-564"><a href="#LazyDeepMTS-564"><span class="linenos">564</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyDeepMTS-565"><a href="#LazyDeepMTS-565"><span class="linenos">565</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepMTS-566"><a href="#LazyDeepMTS-566"><span class="linenos">566</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_pred</span>
</span><span id="LazyDeepMTS-567"><a href="#LazyDeepMTS-567"><span class="linenos">567</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepMTS-568"><a href="#LazyDeepMTS-568"><span class="linenos">568</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepMTS-569"><a href="#LazyDeepMTS-569"><span class="linenos">569</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepMTS-570"><a href="#LazyDeepMTS-570"><span class="linenos">570</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepMTS-571"><a href="#LazyDeepMTS-571"><span class="linenos">571</span></a>
</span><span id="LazyDeepMTS-572"><a href="#LazyDeepMTS-572"><span class="linenos">572</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS-573"><a href="#LazyDeepMTS-573"><span class="linenos">573</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS-574"><a href="#LazyDeepMTS-574"><span class="linenos">574</span></a>                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepMTS-575"><a href="#LazyDeepMTS-575"><span class="linenos">575</span></a>                <span class="c1"># &quot;Adjusted R-Squared&quot;: ADJR2,</span>
</span><span id="LazyDeepMTS-576"><a href="#LazyDeepMTS-576"><span class="linenos">576</span></a>                <span class="c1"># &quot;R-Squared&quot;: R2,</span>
</span><span id="LazyDeepMTS-577"><a href="#LazyDeepMTS-577"><span class="linenos">577</span></a>                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyDeepMTS-578"><a href="#LazyDeepMTS-578"><span class="linenos">578</span></a>                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">MAE</span><span class="p">,</span>
</span><span id="LazyDeepMTS-579"><a href="#LazyDeepMTS-579"><span class="linenos">579</span></a>                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">MPL</span><span class="p">,</span>
</span><span id="LazyDeepMTS-580"><a href="#LazyDeepMTS-580"><span class="linenos">580</span></a>                <span class="c1"># &quot;MPE&quot;: MPE,</span>
</span><span id="LazyDeepMTS-581"><a href="#LazyDeepMTS-581"><span class="linenos">581</span></a>                <span class="c1"># &quot;MAPE&quot;: MAPE,</span>
</span><span id="LazyDeepMTS-582"><a href="#LazyDeepMTS-582"><span class="linenos">582</span></a>                <span class="s2">&quot;WINKLERSCORE&quot;</span><span class="p">:</span> <span class="n">WINKLERSCORE</span><span class="p">,</span>
</span><span id="LazyDeepMTS-583"><a href="#LazyDeepMTS-583"><span class="linenos">583</span></a>                <span class="s2">&quot;COVERAGE&quot;</span><span class="p">:</span> <span class="n">COVERAGE</span><span class="p">,</span>
</span><span id="LazyDeepMTS-584"><a href="#LazyDeepMTS-584"><span class="linenos">584</span></a>                <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepMTS-585"><a href="#LazyDeepMTS-585"><span class="linenos">585</span></a>            <span class="p">}</span>
</span><span id="LazyDeepMTS-586"><a href="#LazyDeepMTS-586"><span class="linenos">586</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS-587"><a href="#LazyDeepMTS-587"><span class="linenos">587</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS-588"><a href="#LazyDeepMTS-588"><span class="linenos">588</span></a>                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepMTS-589"><a href="#LazyDeepMTS-589"><span class="linenos">589</span></a>                <span class="c1"># &quot;Adjusted R-Squared&quot;: ADJR2,</span>
</span><span id="LazyDeepMTS-590"><a href="#LazyDeepMTS-590"><span class="linenos">590</span></a>                <span class="c1"># &quot;R-Squared&quot;: R2,</span>
</span><span id="LazyDeepMTS-591"><a href="#LazyDeepMTS-591"><span class="linenos">591</span></a>                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyDeepMTS-592"><a href="#LazyDeepMTS-592"><span class="linenos">592</span></a>                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">MAE</span><span class="p">,</span>
</span><span id="LazyDeepMTS-593"><a href="#LazyDeepMTS-593"><span class="linenos">593</span></a>                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">MPL</span><span class="p">,</span>
</span><span id="LazyDeepMTS-594"><a href="#LazyDeepMTS-594"><span class="linenos">594</span></a>                <span class="c1"># &quot;MPE&quot;: MPE,</span>
</span><span id="LazyDeepMTS-595"><a href="#LazyDeepMTS-595"><span class="linenos">595</span></a>                <span class="c1"># &quot;MAPE&quot;: MAPE,</span>
</span><span id="LazyDeepMTS-596"><a href="#LazyDeepMTS-596"><span class="linenos">596</span></a>                <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepMTS-597"><a href="#LazyDeepMTS-597"><span class="linenos">597</span></a>            <span class="p">}</span>
</span><span id="LazyDeepMTS-598"><a href="#LazyDeepMTS-598"><span class="linenos">598</span></a>
</span><span id="LazyDeepMTS-599"><a href="#LazyDeepMTS-599"><span class="linenos">599</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS-600"><a href="#LazyDeepMTS-600"><span class="linenos">600</span></a>            <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">CUSTOM_METRIC</span>
</span><span id="LazyDeepMTS-601"><a href="#LazyDeepMTS-601"><span class="linenos">601</span></a>
</span><span id="LazyDeepMTS-602"><a href="#LazyDeepMTS-602"><span class="linenos">602</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LazyDeepMTS-603"><a href="#LazyDeepMTS-603"><span class="linenos">603</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyDeepMTS-604"><a href="#LazyDeepMTS-604"><span class="linenos">604</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyDeepMTS-605"><a href="#LazyDeepMTS-605"><span class="linenos">605</span></a>        <span class="p">)</span>
</span><span id="LazyDeepMTS-606"><a href="#LazyDeepMTS-606"><span class="linenos">606</span></a>
</span><span id="LazyDeepMTS-607"><a href="#LazyDeepMTS-607"><span class="linenos">607</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepMTS-608"><a href="#LazyDeepMTS-608"><span class="linenos">608</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyDeepMTS-609"><a href="#LazyDeepMTS-609"><span class="linenos">609</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span><span id="LazyDeepMTS-610"><a href="#LazyDeepMTS-610"><span class="linenos">610</span></a>
</span><span id="LazyDeepMTS-611"><a href="#LazyDeepMTS-611"><span class="linenos">611</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">):</span>
</span><span id="LazyDeepMTS-612"><a href="#LazyDeepMTS-612"><span class="linenos">612</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyDeepMTS-613"><a href="#LazyDeepMTS-613"><span class="linenos">613</span></a><span class="sd">        This function returns all the model objects trained in fit function.</span>
</span><span id="LazyDeepMTS-614"><a href="#LazyDeepMTS-614"><span class="linenos">614</span></a><span class="sd">        If fit is not called already, then we call fit and then return the models.</span>
</span><span id="LazyDeepMTS-615"><a href="#LazyDeepMTS-615"><span class="linenos">615</span></a>
</span><span id="LazyDeepMTS-616"><a href="#LazyDeepMTS-616"><span class="linenos">616</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepMTS-617"><a href="#LazyDeepMTS-617"><span class="linenos">617</span></a>
</span><span id="LazyDeepMTS-618"><a href="#LazyDeepMTS-618"><span class="linenos">618</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyDeepMTS-619"><a href="#LazyDeepMTS-619"><span class="linenos">619</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepMTS-620"><a href="#LazyDeepMTS-620"><span class="linenos">620</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepMTS-621"><a href="#LazyDeepMTS-621"><span class="linenos">621</span></a>
</span><span id="LazyDeepMTS-622"><a href="#LazyDeepMTS-622"><span class="linenos">622</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyDeepMTS-623"><a href="#LazyDeepMTS-623"><span class="linenos">623</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepMTS-624"><a href="#LazyDeepMTS-624"><span class="linenos">624</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepMTS-625"><a href="#LazyDeepMTS-625"><span class="linenos">625</span></a>
</span><span id="LazyDeepMTS-626"><a href="#LazyDeepMTS-626"><span class="linenos">626</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepMTS-627"><a href="#LazyDeepMTS-627"><span class="linenos">627</span></a>
</span><span id="LazyDeepMTS-628"><a href="#LazyDeepMTS-628"><span class="linenos">628</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyDeepMTS-629"><a href="#LazyDeepMTS-629"><span class="linenos">629</span></a><span class="sd">                Returns a dictionary with each model pipeline as value</span>
</span><span id="LazyDeepMTS-630"><a href="#LazyDeepMTS-630"><span class="linenos">630</span></a><span class="sd">                with key as name of models.</span>
</span><span id="LazyDeepMTS-631"><a href="#LazyDeepMTS-631"><span class="linenos">631</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepMTS-632"><a href="#LazyDeepMTS-632"><span class="linenos">632</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepMTS-633"><a href="#LazyDeepMTS-633"><span class="linenos">633</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepMTS-634"><a href="#LazyDeepMTS-634"><span class="linenos">634</span></a>
</span><span id="LazyDeepMTS-635"><a href="#LazyDeepMTS-635"><span class="linenos">635</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>Fitting -- almost -- all the regression algorithms with layers of
    nnetsauce's CustomRegressor to multivariate time series
    and returning their scores.</p>

<p>Parameters:</p>

<pre><code>verbose: int, optional (default=0)
    Any positive number for verbosity.

ignore_warnings: bool, optional (default=True)
    When set to True, the warning related to algorigms that are not
    able to run are ignored.

custom_metric: function, optional (default=None)
    When function is provided, models are evaluated based on the
    custom evaluation metric provided.

predictions: bool, optional (default=False)
    When set to True, the predictions of all the models models are
    returned as dataframe.

sort_by: string, optional (default='RMSE')
    Sort models by a metric. Available options are 'RMSE', 'MAE',
    'MPL', 'MPE', 'MAPE', 'R-Squared', 'Adjusted R-Squared' or
    a custom metric identified by its name and
    provided by custom_metric.

random_state: int, optional (default=42)
    Reproducibiility seed.

estimators: list, optional (default='all')
    list of Estimators (regression algorithms) names or just
    'all' (default='all')

preprocess: bool, preprocessing is done when set to True

n_jobs : int, when possible, run in parallel
    For now, only used by individual models that support it.

n_layers: int, optional (default=3)
    Number of layers of CustomRegressors to be used.

All the other parameters are the same as MTS's.
</code></pre>

<p>Examples</p>

<pre><code>See https://github.com/Techtonique/nnetsauce/blob/master/nnetsauce/demo/thierrymoudiki_20240106_LazyDeepMTS.ipynb
</code></pre>
</div>


                                <div id="LazyDeepMTS.fit" class="classattr">
                                            <input id="LazyDeepMTS.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">xreg</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyDeepMTS.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepMTS.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepMTS.fit-209"><a href="#LazyDeepMTS.fit-209"><span class="linenos">209</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">xreg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="LazyDeepMTS.fit-210"><a href="#LazyDeepMTS.fit-210"><span class="linenos">210</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X_train, predict and score on X_test.</span>
</span><span id="LazyDeepMTS.fit-211"><a href="#LazyDeepMTS.fit-211"><span class="linenos">211</span></a>
</span><span id="LazyDeepMTS.fit-212"><a href="#LazyDeepMTS.fit-212"><span class="linenos">212</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepMTS.fit-213"><a href="#LazyDeepMTS.fit-213"><span class="linenos">213</span></a>
</span><span id="LazyDeepMTS.fit-214"><a href="#LazyDeepMTS.fit-214"><span class="linenos">214</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyDeepMTS.fit-215"><a href="#LazyDeepMTS.fit-215"><span class="linenos">215</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepMTS.fit-216"><a href="#LazyDeepMTS.fit-216"><span class="linenos">216</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepMTS.fit-217"><a href="#LazyDeepMTS.fit-217"><span class="linenos">217</span></a>
</span><span id="LazyDeepMTS.fit-218"><a href="#LazyDeepMTS.fit-218"><span class="linenos">218</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyDeepMTS.fit-219"><a href="#LazyDeepMTS.fit-219"><span class="linenos">219</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepMTS.fit-220"><a href="#LazyDeepMTS.fit-220"><span class="linenos">220</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepMTS.fit-221"><a href="#LazyDeepMTS.fit-221"><span class="linenos">221</span></a>
</span><span id="LazyDeepMTS.fit-222"><a href="#LazyDeepMTS.fit-222"><span class="linenos">222</span></a><span class="sd">            xreg: {array-like}, shape = [n_samples, n_features_xreg]</span>
</span><span id="LazyDeepMTS.fit-223"><a href="#LazyDeepMTS.fit-223"><span class="linenos">223</span></a><span class="sd">                Additional (external) regressors to be passed to self.obj</span>
</span><span id="LazyDeepMTS.fit-224"><a href="#LazyDeepMTS.fit-224"><span class="linenos">224</span></a><span class="sd">                xreg must be in &#39;increasing&#39; order (most recent observations last)</span>
</span><span id="LazyDeepMTS.fit-225"><a href="#LazyDeepMTS.fit-225"><span class="linenos">225</span></a>
</span><span id="LazyDeepMTS.fit-226"><a href="#LazyDeepMTS.fit-226"><span class="linenos">226</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepMTS.fit-227"><a href="#LazyDeepMTS.fit-227"><span class="linenos">227</span></a>
</span><span id="LazyDeepMTS.fit-228"><a href="#LazyDeepMTS.fit-228"><span class="linenos">228</span></a><span class="sd">            scores : Pandas DataFrame</span>
</span><span id="LazyDeepMTS.fit-229"><a href="#LazyDeepMTS.fit-229"><span class="linenos">229</span></a><span class="sd">                Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepMTS.fit-230"><a href="#LazyDeepMTS.fit-230"><span class="linenos">230</span></a>
</span><span id="LazyDeepMTS.fit-231"><a href="#LazyDeepMTS.fit-231"><span class="linenos">231</span></a><span class="sd">            predictions : Pandas DataFrame</span>
</span><span id="LazyDeepMTS.fit-232"><a href="#LazyDeepMTS.fit-232"><span class="linenos">232</span></a><span class="sd">                Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepMTS.fit-233"><a href="#LazyDeepMTS.fit-233"><span class="linenos">233</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepMTS.fit-234"><a href="#LazyDeepMTS.fit-234"><span class="linenos">234</span></a>        <span class="n">R2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-235"><a href="#LazyDeepMTS.fit-235"><span class="linenos">235</span></a>        <span class="n">ADJR2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-236"><a href="#LazyDeepMTS.fit-236"><span class="linenos">236</span></a>        <span class="n">ME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-237"><a href="#LazyDeepMTS.fit-237"><span class="linenos">237</span></a>        <span class="n">MPL</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-238"><a href="#LazyDeepMTS.fit-238"><span class="linenos">238</span></a>        <span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-239"><a href="#LazyDeepMTS.fit-239"><span class="linenos">239</span></a>        <span class="n">MAE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-240"><a href="#LazyDeepMTS.fit-240"><span class="linenos">240</span></a>        <span class="n">MPE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-241"><a href="#LazyDeepMTS.fit-241"><span class="linenos">241</span></a>        <span class="n">MAPE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-242"><a href="#LazyDeepMTS.fit-242"><span class="linenos">242</span></a>        <span class="n">WINKLERSCORE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-243"><a href="#LazyDeepMTS.fit-243"><span class="linenos">243</span></a>        <span class="n">COVERAGE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-244"><a href="#LazyDeepMTS.fit-244"><span class="linenos">244</span></a>
</span><span id="LazyDeepMTS.fit-245"><a href="#LazyDeepMTS.fit-245"><span class="linenos">245</span></a>        <span class="c1"># WIN = []</span>
</span><span id="LazyDeepMTS.fit-246"><a href="#LazyDeepMTS.fit-246"><span class="linenos">246</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-247"><a href="#LazyDeepMTS.fit-247"><span class="linenos">247</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-248"><a href="#LazyDeepMTS.fit-248"><span class="linenos">248</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepMTS.fit-249"><a href="#LazyDeepMTS.fit-249"><span class="linenos">249</span></a>
</span><span id="LazyDeepMTS.fit-250"><a href="#LazyDeepMTS.fit-250"><span class="linenos">250</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-251"><a href="#LazyDeepMTS.fit-251"><span class="linenos">251</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-252"><a href="#LazyDeepMTS.fit-252"><span class="linenos">252</span></a>
</span><span id="LazyDeepMTS.fit-253"><a href="#LazyDeepMTS.fit-253"><span class="linenos">253</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyDeepMTS.fit-254"><a href="#LazyDeepMTS.fit-254"><span class="linenos">254</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-255"><a href="#LazyDeepMTS.fit-255"><span class="linenos">255</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-256"><a href="#LazyDeepMTS.fit-256"><span class="linenos">256</span></a>
</span><span id="LazyDeepMTS.fit-257"><a href="#LazyDeepMTS.fit-257"><span class="linenos">257</span></a>        <span class="n">X_train</span> <span class="o">=</span> <span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-258"><a href="#LazyDeepMTS.fit-258"><span class="linenos">258</span></a>        <span class="n">X_test</span> <span class="o">=</span> <span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-259"><a href="#LazyDeepMTS.fit-259"><span class="linenos">259</span></a>
</span><span id="LazyDeepMTS.fit-260"><a href="#LazyDeepMTS.fit-260"><span class="linenos">260</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepMTS.fit-261"><a href="#LazyDeepMTS.fit-261"><span class="linenos">261</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepMTS.fit-262"><a href="#LazyDeepMTS.fit-262"><span class="linenos">262</span></a>
</span><span id="LazyDeepMTS.fit-263"><a href="#LazyDeepMTS.fit-263"><span class="linenos">263</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-264"><a href="#LazyDeepMTS.fit-264"><span class="linenos">264</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyDeepMTS.fit-265"><a href="#LazyDeepMTS.fit-265"><span class="linenos">265</span></a>        <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-266"><a href="#LazyDeepMTS.fit-266"><span class="linenos">266</span></a>
</span><span id="LazyDeepMTS.fit-267"><a href="#LazyDeepMTS.fit-267"><span class="linenos">267</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-268"><a href="#LazyDeepMTS.fit-268"><span class="linenos">268</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-269"><a href="#LazyDeepMTS.fit-269"><span class="linenos">269</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepMTS.fit-270"><a href="#LazyDeepMTS.fit-270"><span class="linenos">270</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyDeepMTS.fit-271"><a href="#LazyDeepMTS.fit-271"><span class="linenos">271</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepMTS.fit-272"><a href="#LazyDeepMTS.fit-272"><span class="linenos">272</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-273"><a href="#LazyDeepMTS.fit-273"><span class="linenos">273</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-274"><a href="#LazyDeepMTS.fit-274"><span class="linenos">274</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-275"><a href="#LazyDeepMTS.fit-275"><span class="linenos">275</span></a>                    <span class="p">),</span>
</span><span id="LazyDeepMTS.fit-276"><a href="#LazyDeepMTS.fit-276"><span class="linenos">276</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepMTS.fit-277"><a href="#LazyDeepMTS.fit-277"><span class="linenos">277</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-278"><a href="#LazyDeepMTS.fit-278"><span class="linenos">278</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-279"><a href="#LazyDeepMTS.fit-279"><span class="linenos">279</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-280"><a href="#LazyDeepMTS.fit-280"><span class="linenos">280</span></a>                    <span class="p">),</span>
</span><span id="LazyDeepMTS.fit-281"><a href="#LazyDeepMTS.fit-281"><span class="linenos">281</span></a>                <span class="p">]</span>
</span><span id="LazyDeepMTS.fit-282"><a href="#LazyDeepMTS.fit-282"><span class="linenos">282</span></a>            <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-283"><a href="#LazyDeepMTS.fit-283"><span class="linenos">283</span></a>
</span><span id="LazyDeepMTS.fit-284"><a href="#LazyDeepMTS.fit-284"><span class="linenos">284</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-285"><a href="#LazyDeepMTS.fit-285"><span class="linenos">285</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="n">DEEPREGRESSORSMTS</span>
</span><span id="LazyDeepMTS.fit-286"><a href="#LazyDeepMTS.fit-286"><span class="linenos">286</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-287"><a href="#LazyDeepMTS.fit-287"><span class="linenos">287</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyDeepMTS.fit-288"><a href="#LazyDeepMTS.fit-288"><span class="linenos">288</span></a>                <span class="p">(</span><span class="s2">&quot;DeepMTS(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyDeepMTS.fit-289"><a href="#LazyDeepMTS.fit-289"><span class="linenos">289</span></a>                <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepMTS.fit-290"><a href="#LazyDeepMTS.fit-290"><span class="linenos">290</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepMTS.fit-291"><a href="#LazyDeepMTS.fit-291"><span class="linenos">291</span></a>                    <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-292"><a href="#LazyDeepMTS.fit-292"><span class="linenos">292</span></a>                    <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-293"><a href="#LazyDeepMTS.fit-293"><span class="linenos">293</span></a>                <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-294"><a href="#LazyDeepMTS.fit-294"><span class="linenos">294</span></a>            <span class="p">]</span>
</span><span id="LazyDeepMTS.fit-295"><a href="#LazyDeepMTS.fit-295"><span class="linenos">295</span></a>
</span><span id="LazyDeepMTS.fit-296"><a href="#LazyDeepMTS.fit-296"><span class="linenos">296</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-297"><a href="#LazyDeepMTS.fit-297"><span class="linenos">297</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepMTS.fit-298"><a href="#LazyDeepMTS.fit-298"><span class="linenos">298</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepMTS.fit-299"><a href="#LazyDeepMTS.fit-299"><span class="linenos">299</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-300"><a href="#LazyDeepMTS.fit-300"><span class="linenos">300</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepMTS.fit-301"><a href="#LazyDeepMTS.fit-301"><span class="linenos">301</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-302"><a href="#LazyDeepMTS.fit-302"><span class="linenos">302</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepMTS.fit-303"><a href="#LazyDeepMTS.fit-303"><span class="linenos">303</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyDeepMTS.fit-304"><a href="#LazyDeepMTS.fit-304"><span class="linenos">304</span></a>                                <span class="p">(</span>
</span><span id="LazyDeepMTS.fit-305"><a href="#LazyDeepMTS.fit-305"><span class="linenos">305</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-306"><a href="#LazyDeepMTS.fit-306"><span class="linenos">306</span></a>                                    <span class="n">DeepMTS</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-307"><a href="#LazyDeepMTS.fit-307"><span class="linenos">307</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-308"><a href="#LazyDeepMTS.fit-308"><span class="linenos">308</span></a>                                            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-309"><a href="#LazyDeepMTS.fit-309"><span class="linenos">309</span></a>                                            <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyDeepMTS.fit-310"><a href="#LazyDeepMTS.fit-310"><span class="linenos">310</span></a>                                        <span class="p">),</span>
</span><span id="LazyDeepMTS.fit-311"><a href="#LazyDeepMTS.fit-311"><span class="linenos">311</span></a>                                        <span class="n">n_layers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-312"><a href="#LazyDeepMTS.fit-312"><span class="linenos">312</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-313"><a href="#LazyDeepMTS.fit-313"><span class="linenos">313</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-314"><a href="#LazyDeepMTS.fit-314"><span class="linenos">314</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-315"><a href="#LazyDeepMTS.fit-315"><span class="linenos">315</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-316"><a href="#LazyDeepMTS.fit-316"><span class="linenos">316</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-317"><a href="#LazyDeepMTS.fit-317"><span class="linenos">317</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-318"><a href="#LazyDeepMTS.fit-318"><span class="linenos">318</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-319"><a href="#LazyDeepMTS.fit-319"><span class="linenos">319</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-320"><a href="#LazyDeepMTS.fit-320"><span class="linenos">320</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-321"><a href="#LazyDeepMTS.fit-321"><span class="linenos">321</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-322"><a href="#LazyDeepMTS.fit-322"><span class="linenos">322</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-323"><a href="#LazyDeepMTS.fit-323"><span class="linenos">323</span></a>                                        <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-324"><a href="#LazyDeepMTS.fit-324"><span class="linenos">324</span></a>                                        <span class="n">type_pi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-325"><a href="#LazyDeepMTS.fit-325"><span class="linenos">325</span></a>                                        <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-326"><a href="#LazyDeepMTS.fit-326"><span class="linenos">326</span></a>                                        <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-327"><a href="#LazyDeepMTS.fit-327"><span class="linenos">327</span></a>                                        <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-328"><a href="#LazyDeepMTS.fit-328"><span class="linenos">328</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-329"><a href="#LazyDeepMTS.fit-329"><span class="linenos">329</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-330"><a href="#LazyDeepMTS.fit-330"><span class="linenos">330</span></a>                                        <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-331"><a href="#LazyDeepMTS.fit-331"><span class="linenos">331</span></a>                                    <span class="p">),</span>
</span><span id="LazyDeepMTS.fit-332"><a href="#LazyDeepMTS.fit-332"><span class="linenos">332</span></a>                                <span class="p">),</span>
</span><span id="LazyDeepMTS.fit-333"><a href="#LazyDeepMTS.fit-333"><span class="linenos">333</span></a>                            <span class="p">]</span>
</span><span id="LazyDeepMTS.fit-334"><a href="#LazyDeepMTS.fit-334"><span class="linenos">334</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-335"><a href="#LazyDeepMTS.fit-335"><span class="linenos">335</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-336"><a href="#LazyDeepMTS.fit-336"><span class="linenos">336</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-337"><a href="#LazyDeepMTS.fit-337"><span class="linenos">337</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepMTS.fit-338"><a href="#LazyDeepMTS.fit-338"><span class="linenos">338</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyDeepMTS.fit-339"><a href="#LazyDeepMTS.fit-339"><span class="linenos">339</span></a>                                <span class="p">(</span>
</span><span id="LazyDeepMTS.fit-340"><a href="#LazyDeepMTS.fit-340"><span class="linenos">340</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-341"><a href="#LazyDeepMTS.fit-341"><span class="linenos">341</span></a>                                    <span class="n">DeepMTS</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-342"><a href="#LazyDeepMTS.fit-342"><span class="linenos">342</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyDeepMTS.fit-343"><a href="#LazyDeepMTS.fit-343"><span class="linenos">343</span></a>                                        <span class="n">n_layers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-344"><a href="#LazyDeepMTS.fit-344"><span class="linenos">344</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-345"><a href="#LazyDeepMTS.fit-345"><span class="linenos">345</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-346"><a href="#LazyDeepMTS.fit-346"><span class="linenos">346</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-347"><a href="#LazyDeepMTS.fit-347"><span class="linenos">347</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-348"><a href="#LazyDeepMTS.fit-348"><span class="linenos">348</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-349"><a href="#LazyDeepMTS.fit-349"><span class="linenos">349</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-350"><a href="#LazyDeepMTS.fit-350"><span class="linenos">350</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-351"><a href="#LazyDeepMTS.fit-351"><span class="linenos">351</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-352"><a href="#LazyDeepMTS.fit-352"><span class="linenos">352</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-353"><a href="#LazyDeepMTS.fit-353"><span class="linenos">353</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-354"><a href="#LazyDeepMTS.fit-354"><span class="linenos">354</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-355"><a href="#LazyDeepMTS.fit-355"><span class="linenos">355</span></a>                                        <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-356"><a href="#LazyDeepMTS.fit-356"><span class="linenos">356</span></a>                                        <span class="n">type_pi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-357"><a href="#LazyDeepMTS.fit-357"><span class="linenos">357</span></a>                                        <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-358"><a href="#LazyDeepMTS.fit-358"><span class="linenos">358</span></a>                                        <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-359"><a href="#LazyDeepMTS.fit-359"><span class="linenos">359</span></a>                                        <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-360"><a href="#LazyDeepMTS.fit-360"><span class="linenos">360</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-361"><a href="#LazyDeepMTS.fit-361"><span class="linenos">361</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-362"><a href="#LazyDeepMTS.fit-362"><span class="linenos">362</span></a>                                        <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-363"><a href="#LazyDeepMTS.fit-363"><span class="linenos">363</span></a>                                    <span class="p">),</span>
</span><span id="LazyDeepMTS.fit-364"><a href="#LazyDeepMTS.fit-364"><span class="linenos">364</span></a>                                <span class="p">),</span>
</span><span id="LazyDeepMTS.fit-365"><a href="#LazyDeepMTS.fit-365"><span class="linenos">365</span></a>                            <span class="p">]</span>
</span><span id="LazyDeepMTS.fit-366"><a href="#LazyDeepMTS.fit-366"><span class="linenos">366</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-367"><a href="#LazyDeepMTS.fit-367"><span class="linenos">367</span></a>
</span><span id="LazyDeepMTS.fit-368"><a href="#LazyDeepMTS.fit-368"><span class="linenos">368</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-369"><a href="#LazyDeepMTS.fit-369"><span class="linenos">369</span></a>                    <span class="c1"># pipe.fit(X_train, xreg=xreg)</span>
</span><span id="LazyDeepMTS.fit-370"><a href="#LazyDeepMTS.fit-370"><span class="linenos">370</span></a>
</span><span id="LazyDeepMTS.fit-371"><a href="#LazyDeepMTS.fit-371"><span class="linenos">371</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyDeepMTS.fit-372"><a href="#LazyDeepMTS.fit-372"><span class="linenos">372</span></a>                    <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">[</span><span class="s2">&quot;regressor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-373"><a href="#LazyDeepMTS.fit-373"><span class="linenos">373</span></a>                        <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyDeepMTS.fit-374"><a href="#LazyDeepMTS.fit-374"><span class="linenos">374</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-375"><a href="#LazyDeepMTS.fit-375"><span class="linenos">375</span></a>
</span><span id="LazyDeepMTS.fit-376"><a href="#LazyDeepMTS.fit-376"><span class="linenos">376</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-377"><a href="#LazyDeepMTS.fit-377"><span class="linenos">377</span></a>                        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-378"><a href="#LazyDeepMTS.fit-378"><span class="linenos">378</span></a>                            <span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span>
</span><span id="LazyDeepMTS.fit-379"><a href="#LazyDeepMTS.fit-379"><span class="linenos">379</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-380"><a href="#LazyDeepMTS.fit-380"><span class="linenos">380</span></a>                        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-381"><a href="#LazyDeepMTS.fit-381"><span class="linenos">381</span></a>                        <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-382"><a href="#LazyDeepMTS.fit-382"><span class="linenos">382</span></a>                        <span class="n">winklerscore</span> <span class="o">=</span> <span class="n">winkler_score</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-383"><a href="#LazyDeepMTS.fit-383"><span class="linenos">383</span></a>                        <span class="n">coveragecalc</span> <span class="o">=</span> <span class="n">coverage</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-384"><a href="#LazyDeepMTS.fit-384"><span class="linenos">384</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-385"><a href="#LazyDeepMTS.fit-385"><span class="linenos">385</span></a>                        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-386"><a href="#LazyDeepMTS.fit-386"><span class="linenos">386</span></a>                        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-387"><a href="#LazyDeepMTS.fit-387"><span class="linenos">387</span></a>                        <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-388"><a href="#LazyDeepMTS.fit-388"><span class="linenos">388</span></a>
</span><span id="LazyDeepMTS.fit-389"><a href="#LazyDeepMTS.fit-389"><span class="linenos">389</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-390"><a href="#LazyDeepMTS.fit-390"><span class="linenos">390</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-391"><a href="#LazyDeepMTS.fit-391"><span class="linenos">391</span></a>                    <span class="n">MAE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-392"><a href="#LazyDeepMTS.fit-392"><span class="linenos">392</span></a>                    <span class="n">MPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpl</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-393"><a href="#LazyDeepMTS.fit-393"><span class="linenos">393</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-394"><a href="#LazyDeepMTS.fit-394"><span class="linenos">394</span></a>                        <span class="n">WINKLERSCORE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">winklerscore</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-395"><a href="#LazyDeepMTS.fit-395"><span class="linenos">395</span></a>                        <span class="n">COVERAGE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coveragecalc</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-396"><a href="#LazyDeepMTS.fit-396"><span class="linenos">396</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-397"><a href="#LazyDeepMTS.fit-397"><span class="linenos">397</span></a>
</span><span id="LazyDeepMTS.fit-398"><a href="#LazyDeepMTS.fit-398"><span class="linenos">398</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-399"><a href="#LazyDeepMTS.fit-399"><span class="linenos">399</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-400"><a href="#LazyDeepMTS.fit-400"><span class="linenos">400</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-401"><a href="#LazyDeepMTS.fit-401"><span class="linenos">401</span></a>
</span><span id="LazyDeepMTS.fit-402"><a href="#LazyDeepMTS.fit-402"><span class="linenos">402</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-403"><a href="#LazyDeepMTS.fit-403"><span class="linenos">403</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-404"><a href="#LazyDeepMTS.fit-404"><span class="linenos">404</span></a>                            <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS.fit-405"><a href="#LazyDeepMTS.fit-405"><span class="linenos">405</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-406"><a href="#LazyDeepMTS.fit-406"><span class="linenos">406</span></a>                                <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyDeepMTS.fit-407"><a href="#LazyDeepMTS.fit-407"><span class="linenos">407</span></a>                                <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyDeepMTS.fit-408"><a href="#LazyDeepMTS.fit-408"><span class="linenos">408</span></a>                                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-409"><a href="#LazyDeepMTS.fit-409"><span class="linenos">409</span></a>                                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-410"><a href="#LazyDeepMTS.fit-410"><span class="linenos">410</span></a>                                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-411"><a href="#LazyDeepMTS.fit-411"><span class="linenos">411</span></a>                                <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyDeepMTS.fit-412"><a href="#LazyDeepMTS.fit-412"><span class="linenos">412</span></a>                                <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyDeepMTS.fit-413"><a href="#LazyDeepMTS.fit-413"><span class="linenos">413</span></a>                                <span class="s2">&quot;WINKLERSCORE&quot;</span><span class="p">:</span> <span class="n">winklerscore</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-414"><a href="#LazyDeepMTS.fit-414"><span class="linenos">414</span></a>                                <span class="s2">&quot;COVERAGE&quot;</span><span class="p">:</span> <span class="n">coveragecalc</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-415"><a href="#LazyDeepMTS.fit-415"><span class="linenos">415</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-416"><a href="#LazyDeepMTS.fit-416"><span class="linenos">416</span></a>                            <span class="p">}</span>
</span><span id="LazyDeepMTS.fit-417"><a href="#LazyDeepMTS.fit-417"><span class="linenos">417</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-418"><a href="#LazyDeepMTS.fit-418"><span class="linenos">418</span></a>                            <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS.fit-419"><a href="#LazyDeepMTS.fit-419"><span class="linenos">419</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-420"><a href="#LazyDeepMTS.fit-420"><span class="linenos">420</span></a>                                <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyDeepMTS.fit-421"><a href="#LazyDeepMTS.fit-421"><span class="linenos">421</span></a>                                <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyDeepMTS.fit-422"><a href="#LazyDeepMTS.fit-422"><span class="linenos">422</span></a>                                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-423"><a href="#LazyDeepMTS.fit-423"><span class="linenos">423</span></a>                                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-424"><a href="#LazyDeepMTS.fit-424"><span class="linenos">424</span></a>                                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-425"><a href="#LazyDeepMTS.fit-425"><span class="linenos">425</span></a>                                <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyDeepMTS.fit-426"><a href="#LazyDeepMTS.fit-426"><span class="linenos">426</span></a>                                <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyDeepMTS.fit-427"><a href="#LazyDeepMTS.fit-427"><span class="linenos">427</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-428"><a href="#LazyDeepMTS.fit-428"><span class="linenos">428</span></a>                            <span class="p">}</span>
</span><span id="LazyDeepMTS.fit-429"><a href="#LazyDeepMTS.fit-429"><span class="linenos">429</span></a>
</span><span id="LazyDeepMTS.fit-430"><a href="#LazyDeepMTS.fit-430"><span class="linenos">430</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-431"><a href="#LazyDeepMTS.fit-431"><span class="linenos">431</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepMTS.fit-432"><a href="#LazyDeepMTS.fit-432"><span class="linenos">432</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyDeepMTS.fit-433"><a href="#LazyDeepMTS.fit-433"><span class="linenos">433</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-434"><a href="#LazyDeepMTS.fit-434"><span class="linenos">434</span></a>
</span><span id="LazyDeepMTS.fit-435"><a href="#LazyDeepMTS.fit-435"><span class="linenos">435</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-436"><a href="#LazyDeepMTS.fit-436"><span class="linenos">436</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-437"><a href="#LazyDeepMTS.fit-437"><span class="linenos">437</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_pred</span>
</span><span id="LazyDeepMTS.fit-438"><a href="#LazyDeepMTS.fit-438"><span class="linenos">438</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-439"><a href="#LazyDeepMTS.fit-439"><span class="linenos">439</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-440"><a href="#LazyDeepMTS.fit-440"><span class="linenos">440</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-441"><a href="#LazyDeepMTS.fit-441"><span class="linenos">441</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-442"><a href="#LazyDeepMTS.fit-442"><span class="linenos">442</span></a>
</span><span id="LazyDeepMTS.fit-443"><a href="#LazyDeepMTS.fit-443"><span class="linenos">443</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># no preprocessing</span>
</span><span id="LazyDeepMTS.fit-444"><a href="#LazyDeepMTS.fit-444"><span class="linenos">444</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepMTS.fit-445"><a href="#LazyDeepMTS.fit-445"><span class="linenos">445</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepMTS.fit-446"><a href="#LazyDeepMTS.fit-446"><span class="linenos">446</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-447"><a href="#LazyDeepMTS.fit-447"><span class="linenos">447</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepMTS.fit-448"><a href="#LazyDeepMTS.fit-448"><span class="linenos">448</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">DeepMTS</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-449"><a href="#LazyDeepMTS.fit-449"><span class="linenos">449</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyDeepMTS.fit-450"><a href="#LazyDeepMTS.fit-450"><span class="linenos">450</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-451"><a href="#LazyDeepMTS.fit-451"><span class="linenos">451</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-452"><a href="#LazyDeepMTS.fit-452"><span class="linenos">452</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-453"><a href="#LazyDeepMTS.fit-453"><span class="linenos">453</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-454"><a href="#LazyDeepMTS.fit-454"><span class="linenos">454</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-455"><a href="#LazyDeepMTS.fit-455"><span class="linenos">455</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-456"><a href="#LazyDeepMTS.fit-456"><span class="linenos">456</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-457"><a href="#LazyDeepMTS.fit-457"><span class="linenos">457</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-458"><a href="#LazyDeepMTS.fit-458"><span class="linenos">458</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-459"><a href="#LazyDeepMTS.fit-459"><span class="linenos">459</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-460"><a href="#LazyDeepMTS.fit-460"><span class="linenos">460</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-461"><a href="#LazyDeepMTS.fit-461"><span class="linenos">461</span></a>                            <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-462"><a href="#LazyDeepMTS.fit-462"><span class="linenos">462</span></a>                            <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-463"><a href="#LazyDeepMTS.fit-463"><span class="linenos">463</span></a>                            <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-464"><a href="#LazyDeepMTS.fit-464"><span class="linenos">464</span></a>                            <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-465"><a href="#LazyDeepMTS.fit-465"><span class="linenos">465</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-466"><a href="#LazyDeepMTS.fit-466"><span class="linenos">466</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-467"><a href="#LazyDeepMTS.fit-467"><span class="linenos">467</span></a>                            <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-468"><a href="#LazyDeepMTS.fit-468"><span class="linenos">468</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-469"><a href="#LazyDeepMTS.fit-469"><span class="linenos">469</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-470"><a href="#LazyDeepMTS.fit-470"><span class="linenos">470</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">DeepMTS</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-471"><a href="#LazyDeepMTS.fit-471"><span class="linenos">471</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyDeepMTS.fit-472"><a href="#LazyDeepMTS.fit-472"><span class="linenos">472</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-473"><a href="#LazyDeepMTS.fit-473"><span class="linenos">473</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-474"><a href="#LazyDeepMTS.fit-474"><span class="linenos">474</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-475"><a href="#LazyDeepMTS.fit-475"><span class="linenos">475</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-476"><a href="#LazyDeepMTS.fit-476"><span class="linenos">476</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-477"><a href="#LazyDeepMTS.fit-477"><span class="linenos">477</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-478"><a href="#LazyDeepMTS.fit-478"><span class="linenos">478</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-479"><a href="#LazyDeepMTS.fit-479"><span class="linenos">479</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-480"><a href="#LazyDeepMTS.fit-480"><span class="linenos">480</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-481"><a href="#LazyDeepMTS.fit-481"><span class="linenos">481</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-482"><a href="#LazyDeepMTS.fit-482"><span class="linenos">482</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-483"><a href="#LazyDeepMTS.fit-483"><span class="linenos">483</span></a>                            <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-484"><a href="#LazyDeepMTS.fit-484"><span class="linenos">484</span></a>                            <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-485"><a href="#LazyDeepMTS.fit-485"><span class="linenos">485</span></a>                            <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-486"><a href="#LazyDeepMTS.fit-486"><span class="linenos">486</span></a>                            <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-487"><a href="#LazyDeepMTS.fit-487"><span class="linenos">487</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-488"><a href="#LazyDeepMTS.fit-488"><span class="linenos">488</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-489"><a href="#LazyDeepMTS.fit-489"><span class="linenos">489</span></a>                            <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-490"><a href="#LazyDeepMTS.fit-490"><span class="linenos">490</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-491"><a href="#LazyDeepMTS.fit-491"><span class="linenos">491</span></a>
</span><span id="LazyDeepMTS.fit-492"><a href="#LazyDeepMTS.fit-492"><span class="linenos">492</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-493"><a href="#LazyDeepMTS.fit-493"><span class="linenos">493</span></a>                    <span class="c1"># pipe.fit(X_train, xreg=xreg) # DO xreg like in `ahead`</span>
</span><span id="LazyDeepMTS.fit-494"><a href="#LazyDeepMTS.fit-494"><span class="linenos">494</span></a>
</span><span id="LazyDeepMTS.fit-495"><a href="#LazyDeepMTS.fit-495"><span class="linenos">495</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyDeepMTS.fit-496"><a href="#LazyDeepMTS.fit-496"><span class="linenos">496</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-497"><a href="#LazyDeepMTS.fit-497"><span class="linenos">497</span></a>                        <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">[</span><span class="s2">&quot;regressor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-498"><a href="#LazyDeepMTS.fit-498"><span class="linenos">498</span></a>                            <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyDeepMTS.fit-499"><a href="#LazyDeepMTS.fit-499"><span class="linenos">499</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-500"><a href="#LazyDeepMTS.fit-500"><span class="linenos">500</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-501"><a href="#LazyDeepMTS.fit-501"><span class="linenos">501</span></a>                        <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-502"><a href="#LazyDeepMTS.fit-502"><span class="linenos">502</span></a>                            <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyDeepMTS.fit-503"><a href="#LazyDeepMTS.fit-503"><span class="linenos">503</span></a>                        <span class="p">)</span>  <span class="c1"># X_pred = pipe.predict(h=X_test.shape[0], new_xreg=new_xreg) ## DO xreg like in `ahead`</span>
</span><span id="LazyDeepMTS.fit-504"><a href="#LazyDeepMTS.fit-504"><span class="linenos">504</span></a>
</span><span id="LazyDeepMTS.fit-505"><a href="#LazyDeepMTS.fit-505"><span class="linenos">505</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-506"><a href="#LazyDeepMTS.fit-506"><span class="linenos">506</span></a>                        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-507"><a href="#LazyDeepMTS.fit-507"><span class="linenos">507</span></a>                            <span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span>
</span><span id="LazyDeepMTS.fit-508"><a href="#LazyDeepMTS.fit-508"><span class="linenos">508</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-509"><a href="#LazyDeepMTS.fit-509"><span class="linenos">509</span></a>                        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-510"><a href="#LazyDeepMTS.fit-510"><span class="linenos">510</span></a>                        <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-511"><a href="#LazyDeepMTS.fit-511"><span class="linenos">511</span></a>                        <span class="n">winklerscore</span> <span class="o">=</span> <span class="n">winkler_score</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-512"><a href="#LazyDeepMTS.fit-512"><span class="linenos">512</span></a>                        <span class="n">coveragecalc</span> <span class="o">=</span> <span class="n">coverage</span><span class="p">(</span><span class="n">X_pred</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-513"><a href="#LazyDeepMTS.fit-513"><span class="linenos">513</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-514"><a href="#LazyDeepMTS.fit-514"><span class="linenos">514</span></a>                        <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-515"><a href="#LazyDeepMTS.fit-515"><span class="linenos">515</span></a>                        <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-516"><a href="#LazyDeepMTS.fit-516"><span class="linenos">516</span></a>                        <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-517"><a href="#LazyDeepMTS.fit-517"><span class="linenos">517</span></a>
</span><span id="LazyDeepMTS.fit-518"><a href="#LazyDeepMTS.fit-518"><span class="linenos">518</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-519"><a href="#LazyDeepMTS.fit-519"><span class="linenos">519</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-520"><a href="#LazyDeepMTS.fit-520"><span class="linenos">520</span></a>                    <span class="n">MAE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-521"><a href="#LazyDeepMTS.fit-521"><span class="linenos">521</span></a>                    <span class="n">MPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpl</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-522"><a href="#LazyDeepMTS.fit-522"><span class="linenos">522</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-523"><a href="#LazyDeepMTS.fit-523"><span class="linenos">523</span></a>                        <span class="n">WINKLERSCORE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">winklerscore</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-524"><a href="#LazyDeepMTS.fit-524"><span class="linenos">524</span></a>                        <span class="n">COVERAGE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coveragecalc</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-525"><a href="#LazyDeepMTS.fit-525"><span class="linenos">525</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-526"><a href="#LazyDeepMTS.fit-526"><span class="linenos">526</span></a>
</span><span id="LazyDeepMTS.fit-527"><a href="#LazyDeepMTS.fit-527"><span class="linenos">527</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-528"><a href="#LazyDeepMTS.fit-528"><span class="linenos">528</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-529"><a href="#LazyDeepMTS.fit-529"><span class="linenos">529</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-530"><a href="#LazyDeepMTS.fit-530"><span class="linenos">530</span></a>
</span><span id="LazyDeepMTS.fit-531"><a href="#LazyDeepMTS.fit-531"><span class="linenos">531</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-532"><a href="#LazyDeepMTS.fit-532"><span class="linenos">532</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-533"><a href="#LazyDeepMTS.fit-533"><span class="linenos">533</span></a>                            <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS.fit-534"><a href="#LazyDeepMTS.fit-534"><span class="linenos">534</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-535"><a href="#LazyDeepMTS.fit-535"><span class="linenos">535</span></a>                                <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyDeepMTS.fit-536"><a href="#LazyDeepMTS.fit-536"><span class="linenos">536</span></a>                                <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyDeepMTS.fit-537"><a href="#LazyDeepMTS.fit-537"><span class="linenos">537</span></a>                                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-538"><a href="#LazyDeepMTS.fit-538"><span class="linenos">538</span></a>                                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-539"><a href="#LazyDeepMTS.fit-539"><span class="linenos">539</span></a>                                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-540"><a href="#LazyDeepMTS.fit-540"><span class="linenos">540</span></a>                                <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyDeepMTS.fit-541"><a href="#LazyDeepMTS.fit-541"><span class="linenos">541</span></a>                                <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyDeepMTS.fit-542"><a href="#LazyDeepMTS.fit-542"><span class="linenos">542</span></a>                                <span class="s2">&quot;WINKLERSCORE&quot;</span><span class="p">:</span> <span class="n">winklerscore</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-543"><a href="#LazyDeepMTS.fit-543"><span class="linenos">543</span></a>                                <span class="s2">&quot;COVERAGE&quot;</span><span class="p">:</span> <span class="n">coveragecalc</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-544"><a href="#LazyDeepMTS.fit-544"><span class="linenos">544</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-545"><a href="#LazyDeepMTS.fit-545"><span class="linenos">545</span></a>                            <span class="p">}</span>
</span><span id="LazyDeepMTS.fit-546"><a href="#LazyDeepMTS.fit-546"><span class="linenos">546</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-547"><a href="#LazyDeepMTS.fit-547"><span class="linenos">547</span></a>                            <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS.fit-548"><a href="#LazyDeepMTS.fit-548"><span class="linenos">548</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-549"><a href="#LazyDeepMTS.fit-549"><span class="linenos">549</span></a>                                <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyDeepMTS.fit-550"><a href="#LazyDeepMTS.fit-550"><span class="linenos">550</span></a>                                <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyDeepMTS.fit-551"><a href="#LazyDeepMTS.fit-551"><span class="linenos">551</span></a>                                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-552"><a href="#LazyDeepMTS.fit-552"><span class="linenos">552</span></a>                                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-553"><a href="#LazyDeepMTS.fit-553"><span class="linenos">553</span></a>                                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-554"><a href="#LazyDeepMTS.fit-554"><span class="linenos">554</span></a>                                <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyDeepMTS.fit-555"><a href="#LazyDeepMTS.fit-555"><span class="linenos">555</span></a>                                <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyDeepMTS.fit-556"><a href="#LazyDeepMTS.fit-556"><span class="linenos">556</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-557"><a href="#LazyDeepMTS.fit-557"><span class="linenos">557</span></a>                            <span class="p">}</span>
</span><span id="LazyDeepMTS.fit-558"><a href="#LazyDeepMTS.fit-558"><span class="linenos">558</span></a>
</span><span id="LazyDeepMTS.fit-559"><a href="#LazyDeepMTS.fit-559"><span class="linenos">559</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-560"><a href="#LazyDeepMTS.fit-560"><span class="linenos">560</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepMTS.fit-561"><a href="#LazyDeepMTS.fit-561"><span class="linenos">561</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyDeepMTS.fit-562"><a href="#LazyDeepMTS.fit-562"><span class="linenos">562</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-563"><a href="#LazyDeepMTS.fit-563"><span class="linenos">563</span></a>
</span><span id="LazyDeepMTS.fit-564"><a href="#LazyDeepMTS.fit-564"><span class="linenos">564</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-565"><a href="#LazyDeepMTS.fit-565"><span class="linenos">565</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-566"><a href="#LazyDeepMTS.fit-566"><span class="linenos">566</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_pred</span>
</span><span id="LazyDeepMTS.fit-567"><a href="#LazyDeepMTS.fit-567"><span class="linenos">567</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-568"><a href="#LazyDeepMTS.fit-568"><span class="linenos">568</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-569"><a href="#LazyDeepMTS.fit-569"><span class="linenos">569</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-570"><a href="#LazyDeepMTS.fit-570"><span class="linenos">570</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-571"><a href="#LazyDeepMTS.fit-571"><span class="linenos">571</span></a>
</span><span id="LazyDeepMTS.fit-572"><a href="#LazyDeepMTS.fit-572"><span class="linenos">572</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-573"><a href="#LazyDeepMTS.fit-573"><span class="linenos">573</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS.fit-574"><a href="#LazyDeepMTS.fit-574"><span class="linenos">574</span></a>                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-575"><a href="#LazyDeepMTS.fit-575"><span class="linenos">575</span></a>                <span class="c1"># &quot;Adjusted R-Squared&quot;: ADJR2,</span>
</span><span id="LazyDeepMTS.fit-576"><a href="#LazyDeepMTS.fit-576"><span class="linenos">576</span></a>                <span class="c1"># &quot;R-Squared&quot;: R2,</span>
</span><span id="LazyDeepMTS.fit-577"><a href="#LazyDeepMTS.fit-577"><span class="linenos">577</span></a>                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-578"><a href="#LazyDeepMTS.fit-578"><span class="linenos">578</span></a>                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">MAE</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-579"><a href="#LazyDeepMTS.fit-579"><span class="linenos">579</span></a>                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">MPL</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-580"><a href="#LazyDeepMTS.fit-580"><span class="linenos">580</span></a>                <span class="c1"># &quot;MPE&quot;: MPE,</span>
</span><span id="LazyDeepMTS.fit-581"><a href="#LazyDeepMTS.fit-581"><span class="linenos">581</span></a>                <span class="c1"># &quot;MAPE&quot;: MAPE,</span>
</span><span id="LazyDeepMTS.fit-582"><a href="#LazyDeepMTS.fit-582"><span class="linenos">582</span></a>                <span class="s2">&quot;WINKLERSCORE&quot;</span><span class="p">:</span> <span class="n">WINKLERSCORE</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-583"><a href="#LazyDeepMTS.fit-583"><span class="linenos">583</span></a>                <span class="s2">&quot;COVERAGE&quot;</span><span class="p">:</span> <span class="n">COVERAGE</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-584"><a href="#LazyDeepMTS.fit-584"><span class="linenos">584</span></a>                <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-585"><a href="#LazyDeepMTS.fit-585"><span class="linenos">585</span></a>            <span class="p">}</span>
</span><span id="LazyDeepMTS.fit-586"><a href="#LazyDeepMTS.fit-586"><span class="linenos">586</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-587"><a href="#LazyDeepMTS.fit-587"><span class="linenos">587</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS.fit-588"><a href="#LazyDeepMTS.fit-588"><span class="linenos">588</span></a>                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-589"><a href="#LazyDeepMTS.fit-589"><span class="linenos">589</span></a>                <span class="c1"># &quot;Adjusted R-Squared&quot;: ADJR2,</span>
</span><span id="LazyDeepMTS.fit-590"><a href="#LazyDeepMTS.fit-590"><span class="linenos">590</span></a>                <span class="c1"># &quot;R-Squared&quot;: R2,</span>
</span><span id="LazyDeepMTS.fit-591"><a href="#LazyDeepMTS.fit-591"><span class="linenos">591</span></a>                <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-592"><a href="#LazyDeepMTS.fit-592"><span class="linenos">592</span></a>                <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">MAE</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-593"><a href="#LazyDeepMTS.fit-593"><span class="linenos">593</span></a>                <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">MPL</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-594"><a href="#LazyDeepMTS.fit-594"><span class="linenos">594</span></a>                <span class="c1"># &quot;MPE&quot;: MPE,</span>
</span><span id="LazyDeepMTS.fit-595"><a href="#LazyDeepMTS.fit-595"><span class="linenos">595</span></a>                <span class="c1"># &quot;MAPE&quot;: MAPE,</span>
</span><span id="LazyDeepMTS.fit-596"><a href="#LazyDeepMTS.fit-596"><span class="linenos">596</span></a>                <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-597"><a href="#LazyDeepMTS.fit-597"><span class="linenos">597</span></a>            <span class="p">}</span>
</span><span id="LazyDeepMTS.fit-598"><a href="#LazyDeepMTS.fit-598"><span class="linenos">598</span></a>
</span><span id="LazyDeepMTS.fit-599"><a href="#LazyDeepMTS.fit-599"><span class="linenos">599</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-600"><a href="#LazyDeepMTS.fit-600"><span class="linenos">600</span></a>            <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">CUSTOM_METRIC</span>
</span><span id="LazyDeepMTS.fit-601"><a href="#LazyDeepMTS.fit-601"><span class="linenos">601</span></a>
</span><span id="LazyDeepMTS.fit-602"><a href="#LazyDeepMTS.fit-602"><span class="linenos">602</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-603"><a href="#LazyDeepMTS.fit-603"><span class="linenos">603</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-604"><a href="#LazyDeepMTS.fit-604"><span class="linenos">604</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyDeepMTS.fit-605"><a href="#LazyDeepMTS.fit-605"><span class="linenos">605</span></a>        <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-606"><a href="#LazyDeepMTS.fit-606"><span class="linenos">606</span></a>
</span><span id="LazyDeepMTS.fit-607"><a href="#LazyDeepMTS.fit-607"><span class="linenos">607</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-608"><a href="#LazyDeepMTS.fit-608"><span class="linenos">608</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-609"><a href="#LazyDeepMTS.fit-609"><span class="linenos">609</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span></pre></div>


            <div class="docstring"><p>Fit Regression algorithms to X_train, predict and score on X_test.</p>

<p>Parameters:</p>

<pre><code>X_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.

xreg: {array-like}, shape = [n_samples, n_features_xreg]
    Additional (external) regressors to be passed to self.obj
    xreg must be in 'increasing' order (most recent observations last)
</code></pre>

<p>Returns:</p>

<pre><code>scores : Pandas DataFrame
    Returns metrics of all the models in a Pandas DataFrame.

predictions : Pandas DataFrame
    Returns predictions of all the models in a Pandas DataFrame.
</code></pre>
</div>


                                </div>
                                <div id="LazyDeepMTS.provide_models" class="classattr">
                                            <input id="LazyDeepMTS.provide_models-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">provide_models</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyDeepMTS.provide_models-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepMTS.provide_models"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepMTS.provide_models-611"><a href="#LazyDeepMTS.provide_models-611"><span class="linenos">611</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">):</span>
</span><span id="LazyDeepMTS.provide_models-612"><a href="#LazyDeepMTS.provide_models-612"><span class="linenos">612</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyDeepMTS.provide_models-613"><a href="#LazyDeepMTS.provide_models-613"><span class="linenos">613</span></a><span class="sd">        This function returns all the model objects trained in fit function.</span>
</span><span id="LazyDeepMTS.provide_models-614"><a href="#LazyDeepMTS.provide_models-614"><span class="linenos">614</span></a><span class="sd">        If fit is not called already, then we call fit and then return the models.</span>
</span><span id="LazyDeepMTS.provide_models-615"><a href="#LazyDeepMTS.provide_models-615"><span class="linenos">615</span></a>
</span><span id="LazyDeepMTS.provide_models-616"><a href="#LazyDeepMTS.provide_models-616"><span class="linenos">616</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepMTS.provide_models-617"><a href="#LazyDeepMTS.provide_models-617"><span class="linenos">617</span></a>
</span><span id="LazyDeepMTS.provide_models-618"><a href="#LazyDeepMTS.provide_models-618"><span class="linenos">618</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyDeepMTS.provide_models-619"><a href="#LazyDeepMTS.provide_models-619"><span class="linenos">619</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepMTS.provide_models-620"><a href="#LazyDeepMTS.provide_models-620"><span class="linenos">620</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepMTS.provide_models-621"><a href="#LazyDeepMTS.provide_models-621"><span class="linenos">621</span></a>
</span><span id="LazyDeepMTS.provide_models-622"><a href="#LazyDeepMTS.provide_models-622"><span class="linenos">622</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyDeepMTS.provide_models-623"><a href="#LazyDeepMTS.provide_models-623"><span class="linenos">623</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepMTS.provide_models-624"><a href="#LazyDeepMTS.provide_models-624"><span class="linenos">624</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepMTS.provide_models-625"><a href="#LazyDeepMTS.provide_models-625"><span class="linenos">625</span></a>
</span><span id="LazyDeepMTS.provide_models-626"><a href="#LazyDeepMTS.provide_models-626"><span class="linenos">626</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepMTS.provide_models-627"><a href="#LazyDeepMTS.provide_models-627"><span class="linenos">627</span></a>
</span><span id="LazyDeepMTS.provide_models-628"><a href="#LazyDeepMTS.provide_models-628"><span class="linenos">628</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyDeepMTS.provide_models-629"><a href="#LazyDeepMTS.provide_models-629"><span class="linenos">629</span></a><span class="sd">                Returns a dictionary with each model pipeline as value</span>
</span><span id="LazyDeepMTS.provide_models-630"><a href="#LazyDeepMTS.provide_models-630"><span class="linenos">630</span></a><span class="sd">                with key as name of models.</span>
</span><span id="LazyDeepMTS.provide_models-631"><a href="#LazyDeepMTS.provide_models-631"><span class="linenos">631</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepMTS.provide_models-632"><a href="#LazyDeepMTS.provide_models-632"><span class="linenos">632</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepMTS.provide_models-633"><a href="#LazyDeepMTS.provide_models-633"><span class="linenos">633</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepMTS.provide_models-634"><a href="#LazyDeepMTS.provide_models-634"><span class="linenos">634</span></a>
</span><span id="LazyDeepMTS.provide_models-635"><a href="#LazyDeepMTS.provide_models-635"><span class="linenos">635</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>This function returns all the model objects trained in fit function.
If fit is not called already, then we call fit and then return the models.</p>

<p>Parameters:</p>

<pre><code>X_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.
</code></pre>

<p>Returns:</p>

<pre><code>models: dict-object,
    Returns a dictionary with each model pipeline as value
    with key as name of models.
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="MTS">
                            <input id="MTS-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MTS</span><wbr>(<span class="base"><a href="#Base">nnetsauce.Base</a></span>):

                <label class="view-source-button" for="MTS-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MTS"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MTS-25"><a href="#MTS-25"><span class="linenos">  25</span></a><span class="k">class</span> <span class="nc">MTS</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
</span><span id="MTS-26"><a href="#MTS-26"><span class="linenos">  26</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Univariate and multivariate time series (MTS) forecasting with Quasi-Randomized networks</span>
</span><span id="MTS-27"><a href="#MTS-27"><span class="linenos">  27</span></a>
</span><span id="MTS-28"><a href="#MTS-28"><span class="linenos">  28</span></a><span class="sd">    Parameters:</span>
</span><span id="MTS-29"><a href="#MTS-29"><span class="linenos">  29</span></a>
</span><span id="MTS-30"><a href="#MTS-30"><span class="linenos">  30</span></a><span class="sd">        obj: object.</span>
</span><span id="MTS-31"><a href="#MTS-31"><span class="linenos">  31</span></a><span class="sd">            any object containing a method fit (obj.fit()) and a method predict</span>
</span><span id="MTS-32"><a href="#MTS-32"><span class="linenos">  32</span></a><span class="sd">            (obj.predict()).</span>
</span><span id="MTS-33"><a href="#MTS-33"><span class="linenos">  33</span></a>
</span><span id="MTS-34"><a href="#MTS-34"><span class="linenos">  34</span></a><span class="sd">        n_hidden_features: int.</span>
</span><span id="MTS-35"><a href="#MTS-35"><span class="linenos">  35</span></a><span class="sd">            number of nodes in the hidden layer.</span>
</span><span id="MTS-36"><a href="#MTS-36"><span class="linenos">  36</span></a>
</span><span id="MTS-37"><a href="#MTS-37"><span class="linenos">  37</span></a><span class="sd">        activation_name: str.</span>
</span><span id="MTS-38"><a href="#MTS-38"><span class="linenos">  38</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;.</span>
</span><span id="MTS-39"><a href="#MTS-39"><span class="linenos">  39</span></a>
</span><span id="MTS-40"><a href="#MTS-40"><span class="linenos">  40</span></a><span class="sd">        a: float.</span>
</span><span id="MTS-41"><a href="#MTS-41"><span class="linenos">  41</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function.</span>
</span><span id="MTS-42"><a href="#MTS-42"><span class="linenos">  42</span></a>
</span><span id="MTS-43"><a href="#MTS-43"><span class="linenos">  43</span></a><span class="sd">        nodes_sim: str.</span>
</span><span id="MTS-44"><a href="#MTS-44"><span class="linenos">  44</span></a><span class="sd">            type of simulation for the nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;,</span>
</span><span id="MTS-45"><a href="#MTS-45"><span class="linenos">  45</span></a><span class="sd">            &#39;uniform&#39;.</span>
</span><span id="MTS-46"><a href="#MTS-46"><span class="linenos">  46</span></a>
</span><span id="MTS-47"><a href="#MTS-47"><span class="linenos">  47</span></a><span class="sd">        bias: boolean.</span>
</span><span id="MTS-48"><a href="#MTS-48"><span class="linenos">  48</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or not</span>
</span><span id="MTS-49"><a href="#MTS-49"><span class="linenos">  49</span></a><span class="sd">            (False).</span>
</span><span id="MTS-50"><a href="#MTS-50"><span class="linenos">  50</span></a>
</span><span id="MTS-51"><a href="#MTS-51"><span class="linenos">  51</span></a><span class="sd">        dropout: float.</span>
</span><span id="MTS-52"><a href="#MTS-52"><span class="linenos">  52</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="MTS-53"><a href="#MTS-53"><span class="linenos">  53</span></a><span class="sd">            of the training.</span>
</span><span id="MTS-54"><a href="#MTS-54"><span class="linenos">  54</span></a>
</span><span id="MTS-55"><a href="#MTS-55"><span class="linenos">  55</span></a><span class="sd">        direct_link: boolean.</span>
</span><span id="MTS-56"><a href="#MTS-56"><span class="linenos">  56</span></a><span class="sd">            indicates if the original predictors are included (True) in model&#39;s fitting or not (False).</span>
</span><span id="MTS-57"><a href="#MTS-57"><span class="linenos">  57</span></a>
</span><span id="MTS-58"><a href="#MTS-58"><span class="linenos">  58</span></a><span class="sd">        n_clusters: int.</span>
</span><span id="MTS-59"><a href="#MTS-59"><span class="linenos">  59</span></a><span class="sd">            number of clusters for &#39;kmeans&#39; or &#39;gmm&#39; clustering (could be 0: no clustering).</span>
</span><span id="MTS-60"><a href="#MTS-60"><span class="linenos">  60</span></a>
</span><span id="MTS-61"><a href="#MTS-61"><span class="linenos">  61</span></a><span class="sd">        cluster_encode: bool.</span>
</span><span id="MTS-62"><a href="#MTS-62"><span class="linenos">  62</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot)</span>
</span><span id="MTS-63"><a href="#MTS-63"><span class="linenos">  63</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding.</span>
</span><span id="MTS-64"><a href="#MTS-64"><span class="linenos">  64</span></a>
</span><span id="MTS-65"><a href="#MTS-65"><span class="linenos">  65</span></a><span class="sd">        type_clust: str.</span>
</span><span id="MTS-66"><a href="#MTS-66"><span class="linenos">  66</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian</span>
</span><span id="MTS-67"><a href="#MTS-67"><span class="linenos">  67</span></a><span class="sd">            Mixture Model (&#39;gmm&#39;).</span>
</span><span id="MTS-68"><a href="#MTS-68"><span class="linenos">  68</span></a>
</span><span id="MTS-69"><a href="#MTS-69"><span class="linenos">  69</span></a><span class="sd">        type_scaling: a tuple of 3 strings.</span>
</span><span id="MTS-70"><a href="#MTS-70"><span class="linenos">  70</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="MTS-71"><a href="#MTS-71"><span class="linenos">  71</span></a><span class="sd">            (and when relevant).</span>
</span><span id="MTS-72"><a href="#MTS-72"><span class="linenos">  72</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;).</span>
</span><span id="MTS-73"><a href="#MTS-73"><span class="linenos">  73</span></a>
</span><span id="MTS-74"><a href="#MTS-74"><span class="linenos">  74</span></a><span class="sd">        lags: int.</span>
</span><span id="MTS-75"><a href="#MTS-75"><span class="linenos">  75</span></a><span class="sd">            number of lags used for each time series.</span>
</span><span id="MTS-76"><a href="#MTS-76"><span class="linenos">  76</span></a>
</span><span id="MTS-77"><a href="#MTS-77"><span class="linenos">  77</span></a><span class="sd">        type_pi: str.</span>
</span><span id="MTS-78"><a href="#MTS-78"><span class="linenos">  78</span></a><span class="sd">            type of prediction interval; currently:</span>
</span><span id="MTS-79"><a href="#MTS-79"><span class="linenos">  79</span></a><span class="sd">            - &quot;gaussian&quot;: simple, fast, but: assumes stationarity of Gaussian in-sample residuals and independence in the multivariate case</span>
</span><span id="MTS-80"><a href="#MTS-80"><span class="linenos">  80</span></a><span class="sd">            - &quot;kde&quot;: based on Kernel Density Estimation of in-sample residuals</span>
</span><span id="MTS-81"><a href="#MTS-81"><span class="linenos">  81</span></a><span class="sd">            - &quot;bootstrap&quot;: based on independent bootstrap of in-sample residuals</span>
</span><span id="MTS-82"><a href="#MTS-82"><span class="linenos">  82</span></a><span class="sd">            - &quot;block-bootstrap&quot;: based on basic block bootstrap of in-sample residuals</span>
</span><span id="MTS-83"><a href="#MTS-83"><span class="linenos">  83</span></a><span class="sd">            - &quot;scp-kde&quot;: Split conformal prediction with Kernel Density Estimation of calibrated residuals</span>
</span><span id="MTS-84"><a href="#MTS-84"><span class="linenos">  84</span></a><span class="sd">            - &quot;scp-bootstrap&quot;: Split conformal prediction with independent bootstrap of calibrated residuals</span>
</span><span id="MTS-85"><a href="#MTS-85"><span class="linenos">  85</span></a><span class="sd">            - &quot;scp-block-bootstrap&quot;: Split conformal prediction with basic block bootstrap of calibrated residuals</span>
</span><span id="MTS-86"><a href="#MTS-86"><span class="linenos">  86</span></a><span class="sd">            - &quot;scp2-kde&quot;: Split conformal prediction with Kernel Density Estimation of standardized calibrated residuals</span>
</span><span id="MTS-87"><a href="#MTS-87"><span class="linenos">  87</span></a><span class="sd">            - &quot;scp2-bootstrap&quot;: Split conformal prediction with independent bootstrap of standardized calibrated residuals</span>
</span><span id="MTS-88"><a href="#MTS-88"><span class="linenos">  88</span></a><span class="sd">            - &quot;scp2-block-bootstrap&quot;: Split conformal prediction with basic block bootstrap of standardized calibrated residuals</span>
</span><span id="MTS-89"><a href="#MTS-89"><span class="linenos">  89</span></a>
</span><span id="MTS-90"><a href="#MTS-90"><span class="linenos">  90</span></a><span class="sd">        replications: int.</span>
</span><span id="MTS-91"><a href="#MTS-91"><span class="linenos">  91</span></a><span class="sd">            number of replications (if needed, for predictive simulation). Default is &#39;None&#39;.</span>
</span><span id="MTS-92"><a href="#MTS-92"><span class="linenos">  92</span></a>
</span><span id="MTS-93"><a href="#MTS-93"><span class="linenos">  93</span></a><span class="sd">        kernel: str.</span>
</span><span id="MTS-94"><a href="#MTS-94"><span class="linenos">  94</span></a><span class="sd">            the kernel to use for residuals density estimation (used for predictive simulation). Currently, either &#39;gaussian&#39; or &#39;tophat&#39;.</span>
</span><span id="MTS-95"><a href="#MTS-95"><span class="linenos">  95</span></a>
</span><span id="MTS-96"><a href="#MTS-96"><span class="linenos">  96</span></a><span class="sd">        agg: str.</span>
</span><span id="MTS-97"><a href="#MTS-97"><span class="linenos">  97</span></a><span class="sd">            either &quot;mean&quot; or &quot;median&quot; for simulation of bootstrap aggregating</span>
</span><span id="MTS-98"><a href="#MTS-98"><span class="linenos">  98</span></a>
</span><span id="MTS-99"><a href="#MTS-99"><span class="linenos">  99</span></a><span class="sd">        seed: int.</span>
</span><span id="MTS-100"><a href="#MTS-100"><span class="linenos"> 100</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39; or predictive simulation.</span>
</span><span id="MTS-101"><a href="#MTS-101"><span class="linenos"> 101</span></a>
</span><span id="MTS-102"><a href="#MTS-102"><span class="linenos"> 102</span></a><span class="sd">        backend: str.</span>
</span><span id="MTS-103"><a href="#MTS-103"><span class="linenos"> 103</span></a><span class="sd">            &quot;cpu&quot; or &quot;gpu&quot; or &quot;tpu&quot;.</span>
</span><span id="MTS-104"><a href="#MTS-104"><span class="linenos"> 104</span></a>
</span><span id="MTS-105"><a href="#MTS-105"><span class="linenos"> 105</span></a><span class="sd">        verbose: int.</span>
</span><span id="MTS-106"><a href="#MTS-106"><span class="linenos"> 106</span></a><span class="sd">            0: not printing; 1: printing</span>
</span><span id="MTS-107"><a href="#MTS-107"><span class="linenos"> 107</span></a>
</span><span id="MTS-108"><a href="#MTS-108"><span class="linenos"> 108</span></a><span class="sd">        show_progress: bool.</span>
</span><span id="MTS-109"><a href="#MTS-109"><span class="linenos"> 109</span></a><span class="sd">            True: progress bar when fitting each series; False: no progress bar when fitting each series</span>
</span><span id="MTS-110"><a href="#MTS-110"><span class="linenos"> 110</span></a>
</span><span id="MTS-111"><a href="#MTS-111"><span class="linenos"> 111</span></a><span class="sd">    Attributes:</span>
</span><span id="MTS-112"><a href="#MTS-112"><span class="linenos"> 112</span></a>
</span><span id="MTS-113"><a href="#MTS-113"><span class="linenos"> 113</span></a><span class="sd">        fit_objs_: dict</span>
</span><span id="MTS-114"><a href="#MTS-114"><span class="linenos"> 114</span></a><span class="sd">            objects adjusted to each individual time series</span>
</span><span id="MTS-115"><a href="#MTS-115"><span class="linenos"> 115</span></a>
</span><span id="MTS-116"><a href="#MTS-116"><span class="linenos"> 116</span></a><span class="sd">        y_: {array-like}</span>
</span><span id="MTS-117"><a href="#MTS-117"><span class="linenos"> 117</span></a><span class="sd">            MTS responses (most recent observations first)</span>
</span><span id="MTS-118"><a href="#MTS-118"><span class="linenos"> 118</span></a>
</span><span id="MTS-119"><a href="#MTS-119"><span class="linenos"> 119</span></a><span class="sd">        X_: {array-like}</span>
</span><span id="MTS-120"><a href="#MTS-120"><span class="linenos"> 120</span></a><span class="sd">            MTS lags</span>
</span><span id="MTS-121"><a href="#MTS-121"><span class="linenos"> 121</span></a>
</span><span id="MTS-122"><a href="#MTS-122"><span class="linenos"> 122</span></a><span class="sd">        xreg_: {array-like}</span>
</span><span id="MTS-123"><a href="#MTS-123"><span class="linenos"> 123</span></a><span class="sd">            external regressors</span>
</span><span id="MTS-124"><a href="#MTS-124"><span class="linenos"> 124</span></a>
</span><span id="MTS-125"><a href="#MTS-125"><span class="linenos"> 125</span></a><span class="sd">        y_means_: dict</span>
</span><span id="MTS-126"><a href="#MTS-126"><span class="linenos"> 126</span></a><span class="sd">            a dictionary of each series mean values</span>
</span><span id="MTS-127"><a href="#MTS-127"><span class="linenos"> 127</span></a>
</span><span id="MTS-128"><a href="#MTS-128"><span class="linenos"> 128</span></a><span class="sd">        preds_: {array-like}</span>
</span><span id="MTS-129"><a href="#MTS-129"><span class="linenos"> 129</span></a><span class="sd">            successive model predictions</span>
</span><span id="MTS-130"><a href="#MTS-130"><span class="linenos"> 130</span></a>
</span><span id="MTS-131"><a href="#MTS-131"><span class="linenos"> 131</span></a><span class="sd">        preds_std_: {array-like}</span>
</span><span id="MTS-132"><a href="#MTS-132"><span class="linenos"> 132</span></a><span class="sd">            standard deviation around the predictions for Bayesian base learners (`obj`)</span>
</span><span id="MTS-133"><a href="#MTS-133"><span class="linenos"> 133</span></a>
</span><span id="MTS-134"><a href="#MTS-134"><span class="linenos"> 134</span></a><span class="sd">        gaussian_preds_std_: {array-like}</span>
</span><span id="MTS-135"><a href="#MTS-135"><span class="linenos"> 135</span></a><span class="sd">            standard deviation around the predictions for `type_pi=&#39;gaussian&#39;`</span>
</span><span id="MTS-136"><a href="#MTS-136"><span class="linenos"> 136</span></a>
</span><span id="MTS-137"><a href="#MTS-137"><span class="linenos"> 137</span></a><span class="sd">        return_std_: boolean</span>
</span><span id="MTS-138"><a href="#MTS-138"><span class="linenos"> 138</span></a><span class="sd">            return uncertainty or not (set in predict)</span>
</span><span id="MTS-139"><a href="#MTS-139"><span class="linenos"> 139</span></a>
</span><span id="MTS-140"><a href="#MTS-140"><span class="linenos"> 140</span></a><span class="sd">        df_: data frame</span>
</span><span id="MTS-141"><a href="#MTS-141"><span class="linenos"> 141</span></a><span class="sd">            the input data frame, in case a data.frame is provided to `fit`</span>
</span><span id="MTS-142"><a href="#MTS-142"><span class="linenos"> 142</span></a>
</span><span id="MTS-143"><a href="#MTS-143"><span class="linenos"> 143</span></a><span class="sd">        n_obs_: int</span>
</span><span id="MTS-144"><a href="#MTS-144"><span class="linenos"> 144</span></a><span class="sd">            number of time series observations (number of rows for multivariate)</span>
</span><span id="MTS-145"><a href="#MTS-145"><span class="linenos"> 145</span></a>
</span><span id="MTS-146"><a href="#MTS-146"><span class="linenos"> 146</span></a><span class="sd">        level_: int</span>
</span><span id="MTS-147"><a href="#MTS-147"><span class="linenos"> 147</span></a><span class="sd">            level of confidence for prediction intervals (default is 95)</span>
</span><span id="MTS-148"><a href="#MTS-148"><span class="linenos"> 148</span></a>
</span><span id="MTS-149"><a href="#MTS-149"><span class="linenos"> 149</span></a><span class="sd">        residuals_: {array-like}</span>
</span><span id="MTS-150"><a href="#MTS-150"><span class="linenos"> 150</span></a><span class="sd">            in-sample residuals (for `type_pi` not conformal prediction) or calibrated residuals</span>
</span><span id="MTS-151"><a href="#MTS-151"><span class="linenos"> 151</span></a><span class="sd">            (for `type_pi` in conformal prediction)</span>
</span><span id="MTS-152"><a href="#MTS-152"><span class="linenos"> 152</span></a>
</span><span id="MTS-153"><a href="#MTS-153"><span class="linenos"> 153</span></a><span class="sd">        residuals_sims_: tuple of {array-like}</span>
</span><span id="MTS-154"><a href="#MTS-154"><span class="linenos"> 154</span></a><span class="sd">            simulations of in-sample residuals (for `type_pi` not conformal prediction) or</span>
</span><span id="MTS-155"><a href="#MTS-155"><span class="linenos"> 155</span></a><span class="sd">            calibrated residuals (for `type_pi` in conformal prediction)</span>
</span><span id="MTS-156"><a href="#MTS-156"><span class="linenos"> 156</span></a>
</span><span id="MTS-157"><a href="#MTS-157"><span class="linenos"> 157</span></a><span class="sd">        kde_: A scikit-learn object, see https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KernelDensity.html</span>
</span><span id="MTS-158"><a href="#MTS-158"><span class="linenos"> 158</span></a>
</span><span id="MTS-159"><a href="#MTS-159"><span class="linenos"> 159</span></a><span class="sd">        residuals_std_dev_: residuals standard deviation</span>
</span><span id="MTS-160"><a href="#MTS-160"><span class="linenos"> 160</span></a>
</span><span id="MTS-161"><a href="#MTS-161"><span class="linenos"> 161</span></a><span class="sd">    Examples:</span>
</span><span id="MTS-162"><a href="#MTS-162"><span class="linenos"> 162</span></a>
</span><span id="MTS-163"><a href="#MTS-163"><span class="linenos"> 163</span></a><span class="sd">    Example 1:</span>
</span><span id="MTS-164"><a href="#MTS-164"><span class="linenos"> 164</span></a>
</span><span id="MTS-165"><a href="#MTS-165"><span class="linenos"> 165</span></a><span class="sd">    ```python</span>
</span><span id="MTS-166"><a href="#MTS-166"><span class="linenos"> 166</span></a><span class="sd">    import nnetsauce as ns</span>
</span><span id="MTS-167"><a href="#MTS-167"><span class="linenos"> 167</span></a><span class="sd">    import numpy as np</span>
</span><span id="MTS-168"><a href="#MTS-168"><span class="linenos"> 168</span></a><span class="sd">    from sklearn import linear_model</span>
</span><span id="MTS-169"><a href="#MTS-169"><span class="linenos"> 169</span></a><span class="sd">    np.random.seed(123)</span>
</span><span id="MTS-170"><a href="#MTS-170"><span class="linenos"> 170</span></a>
</span><span id="MTS-171"><a href="#MTS-171"><span class="linenos"> 171</span></a><span class="sd">    M = np.random.rand(10, 3)</span>
</span><span id="MTS-172"><a href="#MTS-172"><span class="linenos"> 172</span></a><span class="sd">    M[:,0] = 10*M[:,0]</span>
</span><span id="MTS-173"><a href="#MTS-173"><span class="linenos"> 173</span></a><span class="sd">    M[:,2] = 25*M[:,2]</span>
</span><span id="MTS-174"><a href="#MTS-174"><span class="linenos"> 174</span></a><span class="sd">    print(M)</span>
</span><span id="MTS-175"><a href="#MTS-175"><span class="linenos"> 175</span></a>
</span><span id="MTS-176"><a href="#MTS-176"><span class="linenos"> 176</span></a><span class="sd">    # Adjust Bayesian Ridge</span>
</span><span id="MTS-177"><a href="#MTS-177"><span class="linenos"> 177</span></a><span class="sd">    regr4 = linear_model.BayesianRidge()</span>
</span><span id="MTS-178"><a href="#MTS-178"><span class="linenos"> 178</span></a><span class="sd">    obj_MTS = ns.MTS(regr4, lags = 1, n_hidden_features=5)</span>
</span><span id="MTS-179"><a href="#MTS-179"><span class="linenos"> 179</span></a><span class="sd">    obj_MTS.fit(M)</span>
</span><span id="MTS-180"><a href="#MTS-180"><span class="linenos"> 180</span></a><span class="sd">    print(obj_MTS.predict())</span>
</span><span id="MTS-181"><a href="#MTS-181"><span class="linenos"> 181</span></a>
</span><span id="MTS-182"><a href="#MTS-182"><span class="linenos"> 182</span></a><span class="sd">    # with credible intervals</span>
</span><span id="MTS-183"><a href="#MTS-183"><span class="linenos"> 183</span></a><span class="sd">    print(obj_MTS.predict(return_std=True, level=80))</span>
</span><span id="MTS-184"><a href="#MTS-184"><span class="linenos"> 184</span></a>
</span><span id="MTS-185"><a href="#MTS-185"><span class="linenos"> 185</span></a><span class="sd">    print(obj_MTS.predict(return_std=True, level=95))</span>
</span><span id="MTS-186"><a href="#MTS-186"><span class="linenos"> 186</span></a><span class="sd">    ```</span>
</span><span id="MTS-187"><a href="#MTS-187"><span class="linenos"> 187</span></a>
</span><span id="MTS-188"><a href="#MTS-188"><span class="linenos"> 188</span></a><span class="sd">    Example 2:</span>
</span><span id="MTS-189"><a href="#MTS-189"><span class="linenos"> 189</span></a>
</span><span id="MTS-190"><a href="#MTS-190"><span class="linenos"> 190</span></a><span class="sd">    ```python</span>
</span><span id="MTS-191"><a href="#MTS-191"><span class="linenos"> 191</span></a><span class="sd">    import nnetsauce as ns</span>
</span><span id="MTS-192"><a href="#MTS-192"><span class="linenos"> 192</span></a><span class="sd">    import numpy as np</span>
</span><span id="MTS-193"><a href="#MTS-193"><span class="linenos"> 193</span></a><span class="sd">    from sklearn import linear_model</span>
</span><span id="MTS-194"><a href="#MTS-194"><span class="linenos"> 194</span></a>
</span><span id="MTS-195"><a href="#MTS-195"><span class="linenos"> 195</span></a><span class="sd">    dataset = {</span>
</span><span id="MTS-196"><a href="#MTS-196"><span class="linenos"> 196</span></a><span class="sd">    &#39;date&#39; : [&#39;2001-01-01&#39;, &#39;2002-01-01&#39;, &#39;2003-01-01&#39;, &#39;2004-01-01&#39;, &#39;2005-01-01&#39;],</span>
</span><span id="MTS-197"><a href="#MTS-197"><span class="linenos"> 197</span></a><span class="sd">    &#39;series1&#39; : [34, 30, 35.6, 33.3, 38.1],</span>
</span><span id="MTS-198"><a href="#MTS-198"><span class="linenos"> 198</span></a><span class="sd">    &#39;series2&#39; : [4, 5.5, 5.6, 6.3, 5.1],</span>
</span><span id="MTS-199"><a href="#MTS-199"><span class="linenos"> 199</span></a><span class="sd">    &#39;series3&#39; : [100, 100.5, 100.6, 100.2, 100.1]}</span>
</span><span id="MTS-200"><a href="#MTS-200"><span class="linenos"> 200</span></a><span class="sd">    df = pd.DataFrame(dataset).set_index(&#39;date&#39;)</span>
</span><span id="MTS-201"><a href="#MTS-201"><span class="linenos"> 201</span></a><span class="sd">    print(df)</span>
</span><span id="MTS-202"><a href="#MTS-202"><span class="linenos"> 202</span></a>
</span><span id="MTS-203"><a href="#MTS-203"><span class="linenos"> 203</span></a><span class="sd">    # Adjust Bayesian Ridge</span>
</span><span id="MTS-204"><a href="#MTS-204"><span class="linenos"> 204</span></a><span class="sd">    regr5 = linear_model.BayesianRidge()</span>
</span><span id="MTS-205"><a href="#MTS-205"><span class="linenos"> 205</span></a><span class="sd">    obj_MTS = ns.MTS(regr5, lags = 1, n_hidden_features=5)</span>
</span><span id="MTS-206"><a href="#MTS-206"><span class="linenos"> 206</span></a><span class="sd">    obj_MTS.fit(df)</span>
</span><span id="MTS-207"><a href="#MTS-207"><span class="linenos"> 207</span></a><span class="sd">    print(obj_MTS.predict())</span>
</span><span id="MTS-208"><a href="#MTS-208"><span class="linenos"> 208</span></a>
</span><span id="MTS-209"><a href="#MTS-209"><span class="linenos"> 209</span></a><span class="sd">    # with credible intervals</span>
</span><span id="MTS-210"><a href="#MTS-210"><span class="linenos"> 210</span></a><span class="sd">    print(obj_MTS.predict(return_std=True, level=80))</span>
</span><span id="MTS-211"><a href="#MTS-211"><span class="linenos"> 211</span></a>
</span><span id="MTS-212"><a href="#MTS-212"><span class="linenos"> 212</span></a><span class="sd">    print(obj_MTS.predict(return_std=True, level=95))</span>
</span><span id="MTS-213"><a href="#MTS-213"><span class="linenos"> 213</span></a><span class="sd">    ```</span>
</span><span id="MTS-214"><a href="#MTS-214"><span class="linenos"> 214</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MTS-215"><a href="#MTS-215"><span class="linenos"> 215</span></a>
</span><span id="MTS-216"><a href="#MTS-216"><span class="linenos"> 216</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="MTS-217"><a href="#MTS-217"><span class="linenos"> 217</span></a>
</span><span id="MTS-218"><a href="#MTS-218"><span class="linenos"> 218</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="MTS-219"><a href="#MTS-219"><span class="linenos"> 219</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="MTS-220"><a href="#MTS-220"><span class="linenos"> 220</span></a>        <span class="n">obj</span><span class="p">,</span>
</span><span id="MTS-221"><a href="#MTS-221"><span class="linenos"> 221</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="MTS-222"><a href="#MTS-222"><span class="linenos"> 222</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="MTS-223"><a href="#MTS-223"><span class="linenos"> 223</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="MTS-224"><a href="#MTS-224"><span class="linenos"> 224</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="MTS-225"><a href="#MTS-225"><span class="linenos"> 225</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="MTS-226"><a href="#MTS-226"><span class="linenos"> 226</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MTS-227"><a href="#MTS-227"><span class="linenos"> 227</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="MTS-228"><a href="#MTS-228"><span class="linenos"> 228</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="MTS-229"><a href="#MTS-229"><span class="linenos"> 229</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="MTS-230"><a href="#MTS-230"><span class="linenos"> 230</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="MTS-231"><a href="#MTS-231"><span class="linenos"> 231</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="MTS-232"><a href="#MTS-232"><span class="linenos"> 232</span></a>        <span class="n">lags</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="MTS-233"><a href="#MTS-233"><span class="linenos"> 233</span></a>        <span class="n">type_pi</span><span class="o">=</span><span class="s2">&quot;kde&quot;</span><span class="p">,</span>
</span><span id="MTS-234"><a href="#MTS-234"><span class="linenos"> 234</span></a>        <span class="n">replications</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="MTS-235"><a href="#MTS-235"><span class="linenos"> 235</span></a>        <span class="n">kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="MTS-236"><a href="#MTS-236"><span class="linenos"> 236</span></a>        <span class="n">agg</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
</span><span id="MTS-237"><a href="#MTS-237"><span class="linenos"> 237</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="MTS-238"><a href="#MTS-238"><span class="linenos"> 238</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="MTS-239"><a href="#MTS-239"><span class="linenos"> 239</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MTS-240"><a href="#MTS-240"><span class="linenos"> 240</span></a>        <span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="MTS-241"><a href="#MTS-241"><span class="linenos"> 241</span></a>    <span class="p">):</span>
</span><span id="MTS-242"><a href="#MTS-242"><span class="linenos"> 242</span></a>        <span class="k">assert</span> <span class="nb">int</span><span class="p">(</span><span class="n">lags</span><span class="p">)</span> <span class="o">==</span> <span class="n">lags</span><span class="p">,</span> <span class="s2">&quot;parameter &#39;lags&#39; should be an integer&quot;</span>
</span><span id="MTS-243"><a href="#MTS-243"><span class="linenos"> 243</span></a>
</span><span id="MTS-244"><a href="#MTS-244"><span class="linenos"> 244</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="MTS-245"><a href="#MTS-245"><span class="linenos"> 245</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="MTS-246"><a href="#MTS-246"><span class="linenos"> 246</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="MTS-247"><a href="#MTS-247"><span class="linenos"> 247</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="MTS-248"><a href="#MTS-248"><span class="linenos"> 248</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="MTS-249"><a href="#MTS-249"><span class="linenos"> 249</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="MTS-250"><a href="#MTS-250"><span class="linenos"> 250</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="MTS-251"><a href="#MTS-251"><span class="linenos"> 251</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="MTS-252"><a href="#MTS-252"><span class="linenos"> 252</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="MTS-253"><a href="#MTS-253"><span class="linenos"> 253</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="MTS-254"><a href="#MTS-254"><span class="linenos"> 254</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="MTS-255"><a href="#MTS-255"><span class="linenos"> 255</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="MTS-256"><a href="#MTS-256"><span class="linenos"> 256</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="MTS-257"><a href="#MTS-257"><span class="linenos"> 257</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="MTS-258"><a href="#MTS-258"><span class="linenos"> 258</span></a>        <span class="p">)</span>
</span><span id="MTS-259"><a href="#MTS-259"><span class="linenos"> 259</span></a>
</span><span id="MTS-260"><a href="#MTS-260"><span class="linenos"> 260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
</span><span id="MTS-261"><a href="#MTS-261"><span class="linenos"> 261</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_series</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-262"><a href="#MTS-262"><span class="linenos"> 262</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="o">=</span> <span class="n">lags</span>
</span><span id="MTS-263"><a href="#MTS-263"><span class="linenos"> 263</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">=</span> <span class="n">type_pi</span>
</span><span id="MTS-264"><a href="#MTS-264"><span class="linenos"> 264</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="o">=</span> <span class="n">replications</span>
</span><span id="MTS-265"><a href="#MTS-265"><span class="linenos"> 265</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="o">=</span> <span class="n">kernel</span>
</span><span id="MTS-266"><a href="#MTS-266"><span class="linenos"> 266</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">agg</span> <span class="o">=</span> <span class="n">agg</span>
</span><span id="MTS-267"><a href="#MTS-267"><span class="linenos"> 267</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="MTS-268"><a href="#MTS-268"><span class="linenos"> 268</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span> <span class="o">=</span> <span class="n">show_progress</span>
</span><span id="MTS-269"><a href="#MTS-269"><span class="linenos"> 269</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">series_names</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-270"><a href="#MTS-270"><span class="linenos"> 270</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">input_dates</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-271"><a href="#MTS-271"><span class="linenos"> 271</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MTS-272"><a href="#MTS-272"><span class="linenos"> 272</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># MTS responses (most recent observations first)</span>
</span><span id="MTS-273"><a href="#MTS-273"><span class="linenos"> 273</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># MTS lags</span>
</span><span id="MTS-274"><a href="#MTS-274"><span class="linenos"> 274</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-275"><a href="#MTS-275"><span class="linenos"> 275</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_means_</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MTS-276"><a href="#MTS-276"><span class="linenos"> 276</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-277"><a href="#MTS-277"><span class="linenos"> 277</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-278"><a href="#MTS-278"><span class="linenos"> 278</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-279"><a href="#MTS-279"><span class="linenos"> 279</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-280"><a href="#MTS-280"><span class="linenos"> 280</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">preds_std_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS-281"><a href="#MTS-281"><span class="linenos"> 281</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_preds_std_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-282"><a href="#MTS-282"><span class="linenos"> 282</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-283"><a href="#MTS-283"><span class="linenos"> 283</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">return_std_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-284"><a href="#MTS-284"><span class="linenos"> 284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-285"><a href="#MTS-285"><span class="linenos"> 285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS-286"><a href="#MTS-286"><span class="linenos"> 286</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-287"><a href="#MTS-287"><span class="linenos"> 287</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-288"><a href="#MTS-288"><span class="linenos"> 288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-289"><a href="#MTS-289"><span class="linenos"> 289</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">residuals_std_dev_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-290"><a href="#MTS-290"><span class="linenos"> 290</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_obs_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-291"><a href="#MTS-291"><span class="linenos"> 291</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">level_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-292"><a href="#MTS-292"><span class="linenos"> 292</span></a>
</span><span id="MTS-293"><a href="#MTS-293"><span class="linenos"> 293</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">xreg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MTS-294"><a href="#MTS-294"><span class="linenos"> 294</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit MTS model to training data X, with optional regressors xreg</span>
</span><span id="MTS-295"><a href="#MTS-295"><span class="linenos"> 295</span></a>
</span><span id="MTS-296"><a href="#MTS-296"><span class="linenos"> 296</span></a><span class="sd">        Parameters:</span>
</span><span id="MTS-297"><a href="#MTS-297"><span class="linenos"> 297</span></a>
</span><span id="MTS-298"><a href="#MTS-298"><span class="linenos"> 298</span></a><span class="sd">        X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="MTS-299"><a href="#MTS-299"><span class="linenos"> 299</span></a><span class="sd">            Training time series, where n_samples is the number</span>
</span><span id="MTS-300"><a href="#MTS-300"><span class="linenos"> 300</span></a><span class="sd">            of samples and n_features is the number of features;</span>
</span><span id="MTS-301"><a href="#MTS-301"><span class="linenos"> 301</span></a><span class="sd">            X must be in increasing order (most recent observations last)</span>
</span><span id="MTS-302"><a href="#MTS-302"><span class="linenos"> 302</span></a>
</span><span id="MTS-303"><a href="#MTS-303"><span class="linenos"> 303</span></a><span class="sd">        xreg: {array-like}, shape = [n_samples, n_features_xreg]</span>
</span><span id="MTS-304"><a href="#MTS-304"><span class="linenos"> 304</span></a><span class="sd">            Additional (external) regressors to be passed to self.obj</span>
</span><span id="MTS-305"><a href="#MTS-305"><span class="linenos"> 305</span></a><span class="sd">            xreg must be in &#39;increasing&#39; order (most recent observations last)</span>
</span><span id="MTS-306"><a href="#MTS-306"><span class="linenos"> 306</span></a>
</span><span id="MTS-307"><a href="#MTS-307"><span class="linenos"> 307</span></a><span class="sd">        **kwargs: for now, additional parameters to be passed to for kernel density estimation, when needed (see sklearn.neighbors.KernelDensity)</span>
</span><span id="MTS-308"><a href="#MTS-308"><span class="linenos"> 308</span></a>
</span><span id="MTS-309"><a href="#MTS-309"><span class="linenos"> 309</span></a><span class="sd">        Returns:</span>
</span><span id="MTS-310"><a href="#MTS-310"><span class="linenos"> 310</span></a>
</span><span id="MTS-311"><a href="#MTS-311"><span class="linenos"> 311</span></a><span class="sd">        self: object</span>
</span><span id="MTS-312"><a href="#MTS-312"><span class="linenos"> 312</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MTS-313"><a href="#MTS-313"><span class="linenos"> 313</span></a>
</span><span id="MTS-314"><a href="#MTS-314"><span class="linenos"> 314</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="MTS-315"><a href="#MTS-315"><span class="linenos"> 315</span></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span>
</span><span id="MTS-316"><a href="#MTS-316"><span class="linenos"> 316</span></a>        <span class="p">):</span>  <span class="c1"># input data set is a numpy array</span>
</span><span id="MTS-317"><a href="#MTS-317"><span class="linenos"> 317</span></a>
</span><span id="MTS-318"><a href="#MTS-318"><span class="linenos"> 318</span></a>            <span class="k">if</span> <span class="n">xreg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS-319"><a href="#MTS-319"><span class="linenos"> 319</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="MTS-320"><a href="#MTS-320"><span class="linenos"> 320</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">series_names</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MTS-321"><a href="#MTS-321"><span class="linenos"> 321</span></a>                    <span class="s2">&quot;series&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="MTS-322"><a href="#MTS-322"><span class="linenos"> 322</span></a>                <span class="p">]</span>
</span><span id="MTS-323"><a href="#MTS-323"><span class="linenos"> 323</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># xreg is not None</span>
</span><span id="MTS-324"><a href="#MTS-324"><span class="linenos"> 324</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">xreg</span><span class="p">)</span>
</span><span id="MTS-325"><a href="#MTS-325"><span class="linenos"> 325</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span> <span class="o">=</span> <span class="n">xreg</span>
</span><span id="MTS-326"><a href="#MTS-326"><span class="linenos"> 326</span></a>
</span><span id="MTS-327"><a href="#MTS-327"><span class="linenos"> 327</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># input data set is a DataFrame with column names</span>
</span><span id="MTS-328"><a href="#MTS-328"><span class="linenos"> 328</span></a>
</span><span id="MTS-329"><a href="#MTS-329"><span class="linenos"> 329</span></a>            <span class="n">X_index</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-330"><a href="#MTS-330"><span class="linenos"> 330</span></a>            <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS-331"><a href="#MTS-331"><span class="linenos"> 331</span></a>                <span class="n">X_index</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span>
</span><span id="MTS-332"><a href="#MTS-332"><span class="linenos"> 332</span></a>            <span class="k">if</span> <span class="n">xreg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS-333"><a href="#MTS-333"><span class="linenos"> 333</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">mo</span><span class="o">.</span><span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</span><span id="MTS-334"><a href="#MTS-334"><span class="linenos"> 334</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="MTS-335"><a href="#MTS-335"><span class="linenos"> 335</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">mo</span><span class="o">.</span><span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">xreg</span><span class="p">))</span>
</span><span id="MTS-336"><a href="#MTS-336"><span class="linenos"> 336</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span> <span class="o">=</span> <span class="n">xreg</span>
</span><span id="MTS-337"><a href="#MTS-337"><span class="linenos"> 337</span></a>            <span class="k">if</span> <span class="n">X_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS-338"><a href="#MTS-338"><span class="linenos"> 338</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">X_index</span>
</span><span id="MTS-339"><a href="#MTS-339"><span class="linenos"> 339</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">series_names</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="MTS-340"><a href="#MTS-340"><span class="linenos"> 340</span></a>
</span><span id="MTS-341"><a href="#MTS-341"><span class="linenos"> 341</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="MTS-342"><a href="#MTS-342"><span class="linenos"> 342</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">df_</span> <span class="o">=</span> <span class="n">X</span>
</span><span id="MTS-343"><a href="#MTS-343"><span class="linenos"> 343</span></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">values</span>
</span><span id="MTS-344"><a href="#MTS-344"><span class="linenos"> 344</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">df_</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series_names</span>
</span><span id="MTS-345"><a href="#MTS-345"><span class="linenos"> 345</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">input_dates</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">compute_input_dates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_</span><span class="p">)</span>
</span><span id="MTS-346"><a href="#MTS-346"><span class="linenos"> 346</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MTS-347"><a href="#MTS-347"><span class="linenos"> 347</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">df_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">)</span>
</span><span id="MTS-348"><a href="#MTS-348"><span class="linenos"> 348</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">input_dates</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">compute_input_dates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_</span><span class="p">)</span>
</span><span id="MTS-349"><a href="#MTS-349"><span class="linenos"> 349</span></a>
</span><span id="MTS-350"><a href="#MTS-350"><span class="linenos"> 350</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="MTS-351"><a href="#MTS-351"><span class="linenos"> 351</span></a>            <span class="c1"># multivariate time series</span>
</span><span id="MTS-352"><a href="#MTS-352"><span class="linenos"> 352</span></a>            <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="MTS-353"><a href="#MTS-353"><span class="linenos"> 353</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="MTS-354"><a href="#MTS-354"><span class="linenos"> 354</span></a>            <span class="c1"># univariate time series</span>
</span><span id="MTS-355"><a href="#MTS-355"><span class="linenos"> 355</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MTS-356"><a href="#MTS-356"><span class="linenos"> 356</span></a>            <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="MTS-357"><a href="#MTS-357"><span class="linenos"> 357</span></a>
</span><span id="MTS-358"><a href="#MTS-358"><span class="linenos"> 358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_obs_</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="MTS-359"><a href="#MTS-359"><span class="linenos"> 359</span></a>
</span><span id="MTS-360"><a href="#MTS-360"><span class="linenos"> 360</span></a>        <span class="n">rep_1_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="MTS-361"><a href="#MTS-361"><span class="linenos"> 361</span></a>
</span><span id="MTS-362"><a href="#MTS-362"><span class="linenos"> 362</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-363"><a href="#MTS-363"><span class="linenos"> 363</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-364"><a href="#MTS-364"><span class="linenos"> 364</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_series</span> <span class="o">=</span> <span class="n">p</span>
</span><span id="MTS-365"><a href="#MTS-365"><span class="linenos"> 365</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="MTS-366"><a href="#MTS-366"><span class="linenos"> 366</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_means_</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="MTS-367"><a href="#MTS-367"><span class="linenos"> 367</span></a>        <span class="n">residuals_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS-368"><a href="#MTS-368"><span class="linenos"> 368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-369"><a href="#MTS-369"><span class="linenos"> 369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-370"><a href="#MTS-370"><span class="linenos"> 370</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-371"><a href="#MTS-371"><span class="linenos"> 371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-372"><a href="#MTS-372"><span class="linenos"> 372</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_Z_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS-373"><a href="#MTS-373"><span class="linenos"> 373</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">centered_y_is_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS-374"><a href="#MTS-374"><span class="linenos"> 374</span></a>
</span><span id="MTS-375"><a href="#MTS-375"><span class="linenos"> 375</span></a>        <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MTS-376"><a href="#MTS-376"><span class="linenos"> 376</span></a>            <span class="c1"># multivariate time series</span>
</span><span id="MTS-377"><a href="#MTS-377"><span class="linenos"> 377</span></a>            <span class="n">mts_input</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">create_train_inputs</span><span class="p">(</span><span class="n">X</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">)</span>
</span><span id="MTS-378"><a href="#MTS-378"><span class="linenos"> 378</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MTS-379"><a href="#MTS-379"><span class="linenos"> 379</span></a>            <span class="c1"># univariate time series</span>
</span><span id="MTS-380"><a href="#MTS-380"><span class="linenos"> 380</span></a>            <span class="n">mts_input</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">create_train_inputs</span><span class="p">(</span>
</span><span id="MTS-381"><a href="#MTS-381"><span class="linenos"> 381</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span>
</span><span id="MTS-382"><a href="#MTS-382"><span class="linenos"> 382</span></a>            <span class="p">)</span>
</span><span id="MTS-383"><a href="#MTS-383"><span class="linenos"> 383</span></a>
</span><span id="MTS-384"><a href="#MTS-384"><span class="linenos"> 384</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_</span> <span class="o">=</span> <span class="n">mts_input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MTS-385"><a href="#MTS-385"><span class="linenos"> 385</span></a>
</span><span id="MTS-386"><a href="#MTS-386"><span class="linenos"> 386</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="n">mts_input</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MTS-387"><a href="#MTS-387"><span class="linenos"> 387</span></a>
</span><span id="MTS-388"><a href="#MTS-388"><span class="linenos"> 388</span></a>        <span class="n">dummy_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">rep_1_n</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">)</span>
</span><span id="MTS-389"><a href="#MTS-389"><span class="linenos"> 389</span></a>
</span><span id="MTS-390"><a href="#MTS-390"><span class="linenos"> 390</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_Z_</span> <span class="o">=</span> <span class="n">scaled_Z</span>
</span><span id="MTS-391"><a href="#MTS-391"><span class="linenos"> 391</span></a>
</span><span id="MTS-392"><a href="#MTS-392"><span class="linenos"> 392</span></a>        <span class="c1"># loop on all the time series and adjust self.obj.fit</span>
</span><span id="MTS-393"><a href="#MTS-393"><span class="linenos"> 393</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="MTS-394"><a href="#MTS-394"><span class="linenos"> 394</span></a>            <span class="nb">print</span><span class="p">(</span>
</span><span id="MTS-395"><a href="#MTS-395"><span class="linenos"> 395</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Adjusting </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> to multivariate time series... </span><span class="se">\n</span><span class="s2"> &quot;</span>
</span><span id="MTS-396"><a href="#MTS-396"><span class="linenos"> 396</span></a>            <span class="p">)</span>
</span><span id="MTS-397"><a href="#MTS-397"><span class="linenos"> 397</span></a>
</span><span id="MTS-398"><a href="#MTS-398"><span class="linenos"> 398</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="MTS-399"><a href="#MTS-399"><span class="linenos"> 399</span></a>            <span class="n">iterator</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</span><span id="MTS-400"><a href="#MTS-400"><span class="linenos"> 400</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MTS-401"><a href="#MTS-401"><span class="linenos"> 401</span></a>            <span class="n">iterator</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="MTS-402"><a href="#MTS-402"><span class="linenos"> 402</span></a>
</span><span id="MTS-403"><a href="#MTS-403"><span class="linenos"> 403</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;gaussian&quot;</span><span class="p">,</span> <span class="s2">&quot;kde&quot;</span><span class="p">,</span> <span class="s2">&quot;bootstrap&quot;</span><span class="p">,</span> <span class="s2">&quot;block-bootstrap&quot;</span><span class="p">):</span>
</span><span id="MTS-404"><a href="#MTS-404"><span class="linenos"> 404</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
</span><span id="MTS-405"><a href="#MTS-405"><span class="linenos"> 405</span></a>                <span class="n">y_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
</span><span id="MTS-406"><a href="#MTS-406"><span class="linenos"> 406</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y_means_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_mean</span>
</span><span id="MTS-407"><a href="#MTS-407"><span class="linenos"> 407</span></a>                <span class="n">centered_y_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_mean</span>
</span><span id="MTS-408"><a href="#MTS-408"><span class="linenos"> 408</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">centered_y_is_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">centered_y_i</span><span class="p">)</span>
</span><span id="MTS-409"><a href="#MTS-409"><span class="linenos"> 409</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">centered_y_i</span><span class="p">)</span>
</span><span id="MTS-410"><a href="#MTS-410"><span class="linenos"> 410</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
</span><span id="MTS-411"><a href="#MTS-411"><span class="linenos"> 411</span></a>                <span class="n">residuals_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="MTS-412"><a href="#MTS-412"><span class="linenos"> 412</span></a>                    <span class="p">(</span>
</span><span id="MTS-413"><a href="#MTS-413"><span class="linenos"> 413</span></a>                        <span class="n">centered_y_i</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">)</span>
</span><span id="MTS-414"><a href="#MTS-414"><span class="linenos"> 414</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="MTS-415"><a href="#MTS-415"><span class="linenos"> 415</span></a>                <span class="p">)</span>
</span><span id="MTS-416"><a href="#MTS-416"><span class="linenos"> 416</span></a>
</span><span id="MTS-417"><a href="#MTS-417"><span class="linenos"> 417</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MTS-418"><a href="#MTS-418"><span class="linenos"> 418</span></a>            <span class="s2">&quot;scp-kde&quot;</span><span class="p">,</span>
</span><span id="MTS-419"><a href="#MTS-419"><span class="linenos"> 419</span></a>            <span class="s2">&quot;scp-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS-420"><a href="#MTS-420"><span class="linenos"> 420</span></a>            <span class="s2">&quot;scp-block-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS-421"><a href="#MTS-421"><span class="linenos"> 421</span></a>            <span class="s2">&quot;scp2-kde&quot;</span><span class="p">,</span>
</span><span id="MTS-422"><a href="#MTS-422"><span class="linenos"> 422</span></a>            <span class="s2">&quot;scp2-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS-423"><a href="#MTS-423"><span class="linenos"> 423</span></a>            <span class="s2">&quot;scp2-block-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS-424"><a href="#MTS-424"><span class="linenos"> 424</span></a>        <span class="p">):</span>
</span><span id="MTS-425"><a href="#MTS-425"><span class="linenos"> 425</span></a>            <span class="c1"># split conformal prediction</span>
</span><span id="MTS-426"><a href="#MTS-426"><span class="linenos"> 426</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
</span><span id="MTS-427"><a href="#MTS-427"><span class="linenos"> 427</span></a>                <span class="n">n_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MTS-428"><a href="#MTS-428"><span class="linenos"> 428</span></a>                <span class="n">n_y_half</span> <span class="o">=</span> <span class="n">n_y</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="MTS-429"><a href="#MTS-429"><span class="linenos"> 429</span></a>                <span class="n">first_half_idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_y_half</span><span class="p">)</span>
</span><span id="MTS-430"><a href="#MTS-430"><span class="linenos"> 430</span></a>                <span class="n">second_half_idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_y_half</span><span class="p">,</span> <span class="n">n_y</span><span class="p">)</span>
</span><span id="MTS-431"><a href="#MTS-431"><span class="linenos"> 431</span></a>                <span class="n">y_mean_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">[</span><span class="n">first_half_idx</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
</span><span id="MTS-432"><a href="#MTS-432"><span class="linenos"> 432</span></a>                <span class="n">centered_y_i_temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">[</span><span class="n">first_half_idx</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_mean_temp</span>
</span><span id="MTS-433"><a href="#MTS-433"><span class="linenos"> 433</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">[</span><span class="n">first_half_idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">centered_y_i_temp</span><span class="p">)</span>
</span><span id="MTS-434"><a href="#MTS-434"><span class="linenos"> 434</span></a>                <span class="c1"># calibrated residuals actually</span>
</span><span id="MTS-435"><a href="#MTS-435"><span class="linenos"> 435</span></a>                <span class="n">residuals_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="MTS-436"><a href="#MTS-436"><span class="linenos"> 436</span></a>                    <span class="p">(</span>
</span><span id="MTS-437"><a href="#MTS-437"><span class="linenos"> 437</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">[</span><span class="n">second_half_idx</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
</span><span id="MTS-438"><a href="#MTS-438"><span class="linenos"> 438</span></a>                        <span class="o">-</span> <span class="p">(</span>
</span><span id="MTS-439"><a href="#MTS-439"><span class="linenos"> 439</span></a>                            <span class="n">y_mean_temp</span>
</span><span id="MTS-440"><a href="#MTS-440"><span class="linenos"> 440</span></a>                            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">[</span><span class="n">second_half_idx</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="MTS-441"><a href="#MTS-441"><span class="linenos"> 441</span></a>                        <span class="p">)</span>
</span><span id="MTS-442"><a href="#MTS-442"><span class="linenos"> 442</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="MTS-443"><a href="#MTS-443"><span class="linenos"> 443</span></a>                <span class="p">)</span>
</span><span id="MTS-444"><a href="#MTS-444"><span class="linenos"> 444</span></a>                <span class="c1"># fit on the second half</span>
</span><span id="MTS-445"><a href="#MTS-445"><span class="linenos"> 445</span></a>                <span class="n">y_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">[</span><span class="n">second_half_idx</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
</span><span id="MTS-446"><a href="#MTS-446"><span class="linenos"> 446</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y_means_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_mean</span>
</span><span id="MTS-447"><a href="#MTS-447"><span class="linenos"> 447</span></a>                <span class="n">centered_y_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">[</span><span class="n">second_half_idx</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_mean</span>
</span><span id="MTS-448"><a href="#MTS-448"><span class="linenos"> 448</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">[</span><span class="n">second_half_idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">centered_y_i</span><span class="p">)</span>
</span><span id="MTS-449"><a href="#MTS-449"><span class="linenos"> 449</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
</span><span id="MTS-450"><a href="#MTS-450"><span class="linenos"> 450</span></a>
</span><span id="MTS-451"><a href="#MTS-451"><span class="linenos"> 451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">residuals_</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="MTS-452"><a href="#MTS-452"><span class="linenos"> 452</span></a>
</span><span id="MTS-453"><a href="#MTS-453"><span class="linenos"> 453</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">==</span> <span class="s2">&quot;gaussian&quot;</span><span class="p">:</span>
</span><span id="MTS-454"><a href="#MTS-454"><span class="linenos"> 454</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_preds_std_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="MTS-455"><a href="#MTS-455"><span class="linenos"> 455</span></a>
</span><span id="MTS-456"><a href="#MTS-456"><span class="linenos"> 456</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MTS-457"><a href="#MTS-457"><span class="linenos"> 457</span></a>            <span class="s2">&quot;scp2-kde&quot;</span><span class="p">,</span>
</span><span id="MTS-458"><a href="#MTS-458"><span class="linenos"> 458</span></a>            <span class="s2">&quot;scp2-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS-459"><a href="#MTS-459"><span class="linenos"> 459</span></a>            <span class="s2">&quot;scp2-block-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS-460"><a href="#MTS-460"><span class="linenos"> 460</span></a>        <span class="p">):</span>
</span><span id="MTS-461"><a href="#MTS-461"><span class="linenos"> 461</span></a>            <span class="c1"># Calculate mean and standard deviation for each column</span>
</span><span id="MTS-462"><a href="#MTS-462"><span class="linenos"> 462</span></a>            <span class="n">data_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="MTS-463"><a href="#MTS-463"><span class="linenos"> 463</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">residuals_std_dev_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="MTS-464"><a href="#MTS-464"><span class="linenos"> 464</span></a>            <span class="c1"># Center and scale the array using broadcasting</span>
</span><span id="MTS-465"><a href="#MTS-465"><span class="linenos"> 465</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MTS-466"><a href="#MTS-466"><span class="linenos"> 466</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span> <span class="o">-</span> <span class="n">data_mean</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="MTS-467"><a href="#MTS-467"><span class="linenos"> 467</span></a>            <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">residuals_std_dev_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="MTS-468"><a href="#MTS-468"><span class="linenos"> 468</span></a>
</span><span id="MTS-469"><a href="#MTS-469"><span class="linenos"> 469</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MTS-470"><a href="#MTS-470"><span class="linenos"> 470</span></a>            <span class="s2">&quot;kde&quot;</span><span class="p">,</span>
</span><span id="MTS-471"><a href="#MTS-471"><span class="linenos"> 471</span></a>            <span class="s2">&quot;scp-kde&quot;</span><span class="p">,</span>
</span><span id="MTS-472"><a href="#MTS-472"><span class="linenos"> 472</span></a>            <span class="s2">&quot;scp2-kde&quot;</span><span class="p">,</span>
</span><span id="MTS-473"><a href="#MTS-473"><span class="linenos"> 473</span></a>        <span class="p">):</span>
</span><span id="MTS-474"><a href="#MTS-474"><span class="linenos"> 474</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="MTS-475"><a href="#MTS-475"><span class="linenos"> 475</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Simulate residuals using </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="si">}</span><span class="s2"> kernel... </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="MTS-476"><a href="#MTS-476"><span class="linenos"> 476</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MTS-477"><a href="#MTS-477"><span class="linenos"> 477</span></a>                <span class="s2">&quot;gaussian&quot;</span><span class="p">,</span>
</span><span id="MTS-478"><a href="#MTS-478"><span class="linenos"> 478</span></a>                <span class="s2">&quot;tophat&quot;</span><span class="p">,</span>
</span><span id="MTS-479"><a href="#MTS-479"><span class="linenos"> 479</span></a>            <span class="p">),</span> <span class="s2">&quot;currently, &#39;kernel&#39; must be either &#39;gaussian&#39; or &#39;tophat&#39;&quot;</span>
</span><span id="MTS-480"><a href="#MTS-480"><span class="linenos"> 480</span></a>            <span class="n">kernel_bandwidths</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;bandwidth&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">150</span><span class="p">)}</span>
</span><span id="MTS-481"><a href="#MTS-481"><span class="linenos"> 481</span></a>            <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
</span><span id="MTS-482"><a href="#MTS-482"><span class="linenos"> 482</span></a>                <span class="n">KernelDensity</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="MTS-483"><a href="#MTS-483"><span class="linenos"> 483</span></a>                <span class="n">param_grid</span><span class="o">=</span><span class="n">kernel_bandwidths</span><span class="p">,</span>
</span><span id="MTS-484"><a href="#MTS-484"><span class="linenos"> 484</span></a>            <span class="p">)</span>
</span><span id="MTS-485"><a href="#MTS-485"><span class="linenos"> 485</span></a>            <span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span><span class="p">)</span>
</span><span id="MTS-486"><a href="#MTS-486"><span class="linenos"> 486</span></a>
</span><span id="MTS-487"><a href="#MTS-487"><span class="linenos"> 487</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="MTS-488"><a href="#MTS-488"><span class="linenos"> 488</span></a>                <span class="nb">print</span><span class="p">(</span>
</span><span id="MTS-489"><a href="#MTS-489"><span class="linenos"> 489</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Best parameters for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="si">}</span><span class="s2"> kernel: </span><span class="si">{</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="MTS-490"><a href="#MTS-490"><span class="linenos"> 490</span></a>                <span class="p">)</span>
</span><span id="MTS-491"><a href="#MTS-491"><span class="linenos"> 491</span></a>
</span><span id="MTS-492"><a href="#MTS-492"><span class="linenos"> 492</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">best_estimator_</span>
</span><span id="MTS-493"><a href="#MTS-493"><span class="linenos"> 493</span></a>
</span><span id="MTS-494"><a href="#MTS-494"><span class="linenos"> 494</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="MTS-495"><a href="#MTS-495"><span class="linenos"> 495</span></a>
</span><span id="MTS-496"><a href="#MTS-496"><span class="linenos"> 496</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MTS-497"><a href="#MTS-497"><span class="linenos"> 497</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Forecast all the time series, h steps ahead</span>
</span><span id="MTS-498"><a href="#MTS-498"><span class="linenos"> 498</span></a>
</span><span id="MTS-499"><a href="#MTS-499"><span class="linenos"> 499</span></a><span class="sd">        Parameters:</span>
</span><span id="MTS-500"><a href="#MTS-500"><span class="linenos"> 500</span></a>
</span><span id="MTS-501"><a href="#MTS-501"><span class="linenos"> 501</span></a><span class="sd">        h: {integer}</span>
</span><span id="MTS-502"><a href="#MTS-502"><span class="linenos"> 502</span></a><span class="sd">            Forecasting horizon</span>
</span><span id="MTS-503"><a href="#MTS-503"><span class="linenos"> 503</span></a>
</span><span id="MTS-504"><a href="#MTS-504"><span class="linenos"> 504</span></a><span class="sd">        level: {integer}</span>
</span><span id="MTS-505"><a href="#MTS-505"><span class="linenos"> 505</span></a><span class="sd">            Level of confidence (if obj has option &#39;return_std&#39; and the</span>
</span><span id="MTS-506"><a href="#MTS-506"><span class="linenos"> 506</span></a><span class="sd">            posterior is gaussian)</span>
</span><span id="MTS-507"><a href="#MTS-507"><span class="linenos"> 507</span></a>
</span><span id="MTS-508"><a href="#MTS-508"><span class="linenos"> 508</span></a><span class="sd">        new_xreg: {array-like}, shape = [n_samples = h, n_new_xreg]</span>
</span><span id="MTS-509"><a href="#MTS-509"><span class="linenos"> 509</span></a><span class="sd">            New values of additional (deterministic) regressors on horizon = h</span>
</span><span id="MTS-510"><a href="#MTS-510"><span class="linenos"> 510</span></a><span class="sd">            new_xreg must be in increasing order (most recent observations last)</span>
</span><span id="MTS-511"><a href="#MTS-511"><span class="linenos"> 511</span></a>
</span><span id="MTS-512"><a href="#MTS-512"><span class="linenos"> 512</span></a><span class="sd">        **kwargs: additional parameters to be passed to</span>
</span><span id="MTS-513"><a href="#MTS-513"><span class="linenos"> 513</span></a><span class="sd">                self.cook_test_set</span>
</span><span id="MTS-514"><a href="#MTS-514"><span class="linenos"> 514</span></a>
</span><span id="MTS-515"><a href="#MTS-515"><span class="linenos"> 515</span></a><span class="sd">        Returns:</span>
</span><span id="MTS-516"><a href="#MTS-516"><span class="linenos"> 516</span></a>
</span><span id="MTS-517"><a href="#MTS-517"><span class="linenos"> 517</span></a><span class="sd">        model predictions for horizon = h: {array-like}, data frame or tuple.</span>
</span><span id="MTS-518"><a href="#MTS-518"><span class="linenos"> 518</span></a><span class="sd">        Standard deviation and prediction intervals are returned when</span>
</span><span id="MTS-519"><a href="#MTS-519"><span class="linenos"> 519</span></a><span class="sd">        `obj.predict` can return standard deviation</span>
</span><span id="MTS-520"><a href="#MTS-520"><span class="linenos"> 520</span></a>
</span><span id="MTS-521"><a href="#MTS-521"><span class="linenos"> 521</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MTS-522"><a href="#MTS-522"><span class="linenos"> 522</span></a>
</span><span id="MTS-523"><a href="#MTS-523"><span class="linenos"> 523</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">compute_output_dates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
</span><span id="MTS-524"><a href="#MTS-524"><span class="linenos"> 524</span></a>
</span><span id="MTS-525"><a href="#MTS-525"><span class="linenos"> 525</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">level_</span> <span class="o">=</span> <span class="n">level</span>
</span><span id="MTS-526"><a href="#MTS-526"><span class="linenos"> 526</span></a>
</span><span id="MTS-527"><a href="#MTS-527"><span class="linenos"> 527</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">return_std_</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># do not remove (/!\)</span>
</span><span id="MTS-528"><a href="#MTS-528"><span class="linenos"> 528</span></a>
</span><span id="MTS-529"><a href="#MTS-529"><span class="linenos"> 529</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># do not remove (/!\)</span>
</span><span id="MTS-530"><a href="#MTS-530"><span class="linenos"> 530</span></a>
</span><span id="MTS-531"><a href="#MTS-531"><span class="linenos"> 531</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">)</span>  <span class="c1"># do not remove (/!\)</span>
</span><span id="MTS-532"><a href="#MTS-532"><span class="linenos"> 532</span></a>
</span><span id="MTS-533"><a href="#MTS-533"><span class="linenos"> 533</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># do not remove (/!\)</span>
</span><span id="MTS-534"><a href="#MTS-534"><span class="linenos"> 534</span></a>
</span><span id="MTS-535"><a href="#MTS-535"><span class="linenos"> 535</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># do not remove (/!\)</span>
</span><span id="MTS-536"><a href="#MTS-536"><span class="linenos"> 536</span></a>
</span><span id="MTS-537"><a href="#MTS-537"><span class="linenos"> 537</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># do not remove (/!\)</span>
</span><span id="MTS-538"><a href="#MTS-538"><span class="linenos"> 538</span></a>
</span><span id="MTS-539"><a href="#MTS-539"><span class="linenos"> 539</span></a>        <span class="n">y_means_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">y_means_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_series</span><span class="p">)])</span>
</span><span id="MTS-540"><a href="#MTS-540"><span class="linenos"> 540</span></a>
</span><span id="MTS-541"><a href="#MTS-541"><span class="linenos"> 541</span></a>        <span class="n">n_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_series</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span>
</span><span id="MTS-542"><a href="#MTS-542"><span class="linenos"> 542</span></a>
</span><span id="MTS-543"><a href="#MTS-543"><span class="linenos"> 543</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">level</span>
</span><span id="MTS-544"><a href="#MTS-544"><span class="linenos"> 544</span></a>
</span><span id="MTS-545"><a href="#MTS-545"><span class="linenos"> 545</span></a>        <span class="n">pi_multiplier</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">/</span> <span class="mi">200</span><span class="p">)</span>
</span><span id="MTS-546"><a href="#MTS-546"><span class="linenos"> 546</span></a>
</span><span id="MTS-547"><a href="#MTS-547"><span class="linenos"> 547</span></a>        <span class="k">if</span> <span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>  <span class="c1"># bayesian forecasting</span>
</span><span id="MTS-548"><a href="#MTS-548"><span class="linenos"> 548</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">return_std_</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MTS-549"><a href="#MTS-549"><span class="linenos"> 549</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">preds_std_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS-550"><a href="#MTS-550"><span class="linenos"> 550</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="MTS-551"><a href="#MTS-551"><span class="linenos"> 551</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="MTS-552"><a href="#MTS-552"><span class="linenos"> 552</span></a>            <span class="p">)</span>  <span class="c1"># to be updated</span>
</span><span id="MTS-553"><a href="#MTS-553"><span class="linenos"> 553</span></a>
</span><span id="MTS-554"><a href="#MTS-554"><span class="linenos"> 554</span></a>        <span class="k">if</span> <span class="s2">&quot;return_pi&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>  <span class="c1"># split conformal, without simulation</span>
</span><span id="MTS-555"><a href="#MTS-555"><span class="linenos"> 555</span></a>            <span class="n">mean_pi_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS-556"><a href="#MTS-556"><span class="linenos"> 556</span></a>            <span class="n">lower_pi_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS-557"><a href="#MTS-557"><span class="linenos"> 557</span></a>            <span class="n">upper_pi_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS-558"><a href="#MTS-558"><span class="linenos"> 558</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="MTS-559"><a href="#MTS-559"><span class="linenos"> 559</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="MTS-560"><a href="#MTS-560"><span class="linenos"> 560</span></a>            <span class="p">)</span>  <span class="c1"># to be updated</span>
</span><span id="MTS-561"><a href="#MTS-561"><span class="linenos"> 561</span></a>
</span><span id="MTS-562"><a href="#MTS-562"><span class="linenos"> 562</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MTS-563"><a href="#MTS-563"><span class="linenos"> 563</span></a>            <span class="s2">&quot;kde&quot;</span><span class="p">,</span>
</span><span id="MTS-564"><a href="#MTS-564"><span class="linenos"> 564</span></a>            <span class="s2">&quot;scp-kde&quot;</span><span class="p">,</span>
</span><span id="MTS-565"><a href="#MTS-565"><span class="linenos"> 565</span></a>            <span class="s2">&quot;scp2-kde&quot;</span><span class="p">,</span>
</span><span id="MTS-566"><a href="#MTS-566"><span class="linenos"> 566</span></a>        <span class="p">):</span>  <span class="c1"># kde</span>
</span><span id="MTS-567"><a href="#MTS-567"><span class="linenos"> 567</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="MTS-568"><a href="#MTS-568"><span class="linenos"> 568</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>
</span><span id="MTS-569"><a href="#MTS-569"><span class="linenos"> 569</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">))</span>
</span><span id="MTS-570"><a href="#MTS-570"><span class="linenos"> 570</span></a>            <span class="p">)</span>
</span><span id="MTS-571"><a href="#MTS-571"><span class="linenos"> 571</span></a>
</span><span id="MTS-572"><a href="#MTS-572"><span class="linenos"> 572</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;bootstrap&quot;</span><span class="p">,</span> <span class="s2">&quot;scp-bootstrap&quot;</span><span class="p">,</span> <span class="s2">&quot;scp2-bootstrap&quot;</span><span class="p">):</span>
</span><span id="MTS-573"><a href="#MTS-573"><span class="linenos"> 573</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="MTS-574"><a href="#MTS-574"><span class="linenos"> 574</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span> <span class="nb">int</span>
</span><span id="MTS-575"><a href="#MTS-575"><span class="linenos"> 575</span></a>            <span class="p">),</span> <span class="s2">&quot;&#39;replications&#39; must be provided and be an integer&quot;</span>
</span><span id="MTS-576"><a href="#MTS-576"><span class="linenos"> 576</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="MTS-577"><a href="#MTS-577"><span class="linenos"> 577</span></a>                <span class="n">ts</span><span class="o">.</span><span class="n">bootstrap</span><span class="p">(</span>
</span><span id="MTS-578"><a href="#MTS-578"><span class="linenos"> 578</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span><span class="p">,</span>
</span><span id="MTS-579"><a href="#MTS-579"><span class="linenos"> 579</span></a>                    <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span>
</span><span id="MTS-580"><a href="#MTS-580"><span class="linenos"> 580</span></a>                    <span class="n">block_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="MTS-581"><a href="#MTS-581"><span class="linenos"> 581</span></a>                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span>
</span><span id="MTS-582"><a href="#MTS-582"><span class="linenos"> 582</span></a>                <span class="p">)</span>
</span><span id="MTS-583"><a href="#MTS-583"><span class="linenos"> 583</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">))</span>
</span><span id="MTS-584"><a href="#MTS-584"><span class="linenos"> 584</span></a>            <span class="p">)</span>
</span><span id="MTS-585"><a href="#MTS-585"><span class="linenos"> 585</span></a>
</span><span id="MTS-586"><a href="#MTS-586"><span class="linenos"> 586</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MTS-587"><a href="#MTS-587"><span class="linenos"> 587</span></a>            <span class="s2">&quot;block-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS-588"><a href="#MTS-588"><span class="linenos"> 588</span></a>            <span class="s2">&quot;scp-block-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS-589"><a href="#MTS-589"><span class="linenos"> 589</span></a>            <span class="s2">&quot;scp2-block-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS-590"><a href="#MTS-590"><span class="linenos"> 590</span></a>        <span class="p">):</span>
</span><span id="MTS-591"><a href="#MTS-591"><span class="linenos"> 591</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="MTS-592"><a href="#MTS-592"><span class="linenos"> 592</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span> <span class="nb">int</span>
</span><span id="MTS-593"><a href="#MTS-593"><span class="linenos"> 593</span></a>            <span class="p">),</span> <span class="s2">&quot;&#39;replications&#39; must be provided and be an integer&quot;</span>
</span><span id="MTS-594"><a href="#MTS-594"><span class="linenos"> 594</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="MTS-595"><a href="#MTS-595"><span class="linenos"> 595</span></a>                <span class="n">ts</span><span class="o">.</span><span class="n">bootstrap</span><span class="p">(</span>
</span><span id="MTS-596"><a href="#MTS-596"><span class="linenos"> 596</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">block_size</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">i</span>
</span><span id="MTS-597"><a href="#MTS-597"><span class="linenos"> 597</span></a>                <span class="p">)</span>
</span><span id="MTS-598"><a href="#MTS-598"><span class="linenos"> 598</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">))</span>
</span><span id="MTS-599"><a href="#MTS-599"><span class="linenos"> 599</span></a>            <span class="p">)</span>
</span><span id="MTS-600"><a href="#MTS-600"><span class="linenos"> 600</span></a>
</span><span id="MTS-601"><a href="#MTS-601"><span class="linenos"> 601</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
</span><span id="MTS-602"><a href="#MTS-602"><span class="linenos"> 602</span></a>
</span><span id="MTS-603"><a href="#MTS-603"><span class="linenos"> 603</span></a>            <span class="n">new_obs</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">reformat_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">)</span>
</span><span id="MTS-604"><a href="#MTS-604"><span class="linenos"> 604</span></a>
</span><span id="MTS-605"><a href="#MTS-605"><span class="linenos"> 605</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">new_obs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)</span>
</span><span id="MTS-606"><a href="#MTS-606"><span class="linenos"> 606</span></a>
</span><span id="MTS-607"><a href="#MTS-607"><span class="linenos"> 607</span></a>            <span class="n">cooked_new_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MTS-608"><a href="#MTS-608"><span class="linenos"> 608</span></a>
</span><span id="MTS-609"><a href="#MTS-609"><span class="linenos"> 609</span></a>            <span class="k">if</span> <span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="MTS-610"><a href="#MTS-610"><span class="linenos"> 610</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">preds_std_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="MTS-611"><a href="#MTS-611"><span class="linenos"> 611</span></a>                    <span class="p">[</span>
</span><span id="MTS-612"><a href="#MTS-612"><span class="linenos"> 612</span></a>                        <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
</span><span id="MTS-613"><a href="#MTS-613"><span class="linenos"> 613</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="MTS-614"><a href="#MTS-614"><span class="linenos"> 614</span></a>                                <span class="n">cooked_new_X</span><span class="p">,</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">True</span>
</span><span id="MTS-615"><a href="#MTS-615"><span class="linenos"> 615</span></a>                            <span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MTS-616"><a href="#MTS-616"><span class="linenos"> 616</span></a>                        <span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span><span id="MTS-617"><a href="#MTS-617"><span class="linenos"> 617</span></a>                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_series</span><span class="p">)</span>
</span><span id="MTS-618"><a href="#MTS-618"><span class="linenos"> 618</span></a>                    <span class="p">]</span>
</span><span id="MTS-619"><a href="#MTS-619"><span class="linenos"> 619</span></a>                <span class="p">)</span>
</span><span id="MTS-620"><a href="#MTS-620"><span class="linenos"> 620</span></a>
</span><span id="MTS-621"><a href="#MTS-621"><span class="linenos"> 621</span></a>            <span class="k">if</span> <span class="s2">&quot;return_pi&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="MTS-622"><a href="#MTS-622"><span class="linenos"> 622</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_series</span><span class="p">):</span>
</span><span id="MTS-623"><a href="#MTS-623"><span class="linenos"> 623</span></a>                    <span class="n">preds_pi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="MTS-624"><a href="#MTS-624"><span class="linenos"> 624</span></a>                        <span class="n">cooked_new_X</span><span class="p">,</span> <span class="n">return_pi</span><span class="o">=</span><span class="kc">True</span>
</span><span id="MTS-625"><a href="#MTS-625"><span class="linenos"> 625</span></a>                    <span class="p">)</span>
</span><span id="MTS-626"><a href="#MTS-626"><span class="linenos"> 626</span></a>                    <span class="n">mean_pi_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds_pi</span><span class="o">.</span><span class="n">mean</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="MTS-627"><a href="#MTS-627"><span class="linenos"> 627</span></a>                    <span class="n">lower_pi_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds_pi</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="MTS-628"><a href="#MTS-628"><span class="linenos"> 628</span></a>                    <span class="n">upper_pi_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds_pi</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="MTS-629"><a href="#MTS-629"><span class="linenos"> 629</span></a>
</span><span id="MTS-630"><a href="#MTS-630"><span class="linenos"> 630</span></a>            <span class="n">predicted_cooked_new_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
</span><span id="MTS-631"><a href="#MTS-631"><span class="linenos"> 631</span></a>                <span class="p">[</span>
</span><span id="MTS-632"><a href="#MTS-632"><span class="linenos"> 632</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">cooked_new_X</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span><span id="MTS-633"><a href="#MTS-633"><span class="linenos"> 633</span></a>                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_series</span><span class="p">)</span>
</span><span id="MTS-634"><a href="#MTS-634"><span class="linenos"> 634</span></a>                <span class="p">]</span>
</span><span id="MTS-635"><a href="#MTS-635"><span class="linenos"> 635</span></a>            <span class="p">)</span>
</span><span id="MTS-636"><a href="#MTS-636"><span class="linenos"> 636</span></a>
</span><span id="MTS-637"><a href="#MTS-637"><span class="linenos"> 637</span></a>            <span class="n">preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_means_</span> <span class="o">+</span> <span class="n">predicted_cooked_new_X</span><span class="p">)</span>
</span><span id="MTS-638"><a href="#MTS-638"><span class="linenos"> 638</span></a>
</span><span id="MTS-639"><a href="#MTS-639"><span class="linenos"> 639</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">)</span>  <span class="c1"># preallocate?</span>
</span><span id="MTS-640"><a href="#MTS-640"><span class="linenos"> 640</span></a>
</span><span id="MTS-641"><a href="#MTS-641"><span class="linenos"> 641</span></a>        <span class="c1"># function&#39;s return ----------------------------------------------------------------------</span>
</span><span id="MTS-642"><a href="#MTS-642"><span class="linenos"> 642</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS-643"><a href="#MTS-643"><span class="linenos"> 643</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">h</span><span class="p">,</span> <span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
</span><span id="MTS-644"><a href="#MTS-644"><span class="linenos"> 644</span></a>            <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df_</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
</span><span id="MTS-645"><a href="#MTS-645"><span class="linenos"> 645</span></a>            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS-646"><a href="#MTS-646"><span class="linenos"> 646</span></a>        <span class="p">)</span>
</span><span id="MTS-647"><a href="#MTS-647"><span class="linenos"> 647</span></a>        <span class="k">if</span> <span class="p">((</span><span class="s2">&quot;return_std&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;return_pi&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span>
</span><span id="MTS-648"><a href="#MTS-648"><span class="linenos"> 648</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">!=</span> <span class="s2">&quot;gaussian&quot;</span>
</span><span id="MTS-649"><a href="#MTS-649"><span class="linenos"> 649</span></a>        <span class="p">):</span>
</span><span id="MTS-650"><a href="#MTS-650"><span class="linenos"> 650</span></a>
</span><span id="MTS-651"><a href="#MTS-651"><span class="linenos"> 651</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS-652"><a href="#MTS-652"><span class="linenos"> 652</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span>
</span><span id="MTS-653"><a href="#MTS-653"><span class="linenos"> 653</span></a>
</span><span id="MTS-654"><a href="#MTS-654"><span class="linenos"> 654</span></a>            <span class="c1"># if &quot;return_std&quot; not in kwargs and self.replications is not None</span>
</span><span id="MTS-655"><a href="#MTS-655"><span class="linenos"> 655</span></a>            <span class="n">meanf</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS-656"><a href="#MTS-656"><span class="linenos"> 656</span></a>            <span class="n">lower</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS-657"><a href="#MTS-657"><span class="linenos"> 657</span></a>            <span class="n">upper</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS-658"><a href="#MTS-658"><span class="linenos"> 658</span></a>
</span><span id="MTS-659"><a href="#MTS-659"><span class="linenos"> 659</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MTS-660"><a href="#MTS-660"><span class="linenos"> 660</span></a>                <span class="s2">&quot;scp2-kde&quot;</span><span class="p">,</span>
</span><span id="MTS-661"><a href="#MTS-661"><span class="linenos"> 661</span></a>                <span class="s2">&quot;scp2-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS-662"><a href="#MTS-662"><span class="linenos"> 662</span></a>                <span class="s2">&quot;scp2-block-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS-663"><a href="#MTS-663"><span class="linenos"> 663</span></a>            <span class="p">):</span>
</span><span id="MTS-664"><a href="#MTS-664"><span class="linenos"> 664</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="MTS-665"><a href="#MTS-665"><span class="linenos"> 665</span></a>                    <span class="p">(</span>
</span><span id="MTS-666"><a href="#MTS-666"><span class="linenos"> 666</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span>
</span><span id="MTS-667"><a href="#MTS-667"><span class="linenos"> 667</span></a>                        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="MTS-668"><a href="#MTS-668"><span class="linenos"> 668</span></a>                        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">residuals_std_dev_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="MTS-669"><a href="#MTS-669"><span class="linenos"> 669</span></a>                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">))</span>
</span><span id="MTS-670"><a href="#MTS-670"><span class="linenos"> 670</span></a>                    <span class="p">)</span>
</span><span id="MTS-671"><a href="#MTS-671"><span class="linenos"> 671</span></a>                <span class="p">)</span>
</span><span id="MTS-672"><a href="#MTS-672"><span class="linenos"> 672</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="MTS-673"><a href="#MTS-673"><span class="linenos"> 673</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="MTS-674"><a href="#MTS-674"><span class="linenos"> 674</span></a>                    <span class="p">(</span>
</span><span id="MTS-675"><a href="#MTS-675"><span class="linenos"> 675</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="MTS-676"><a href="#MTS-676"><span class="linenos"> 676</span></a>                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">))</span>
</span><span id="MTS-677"><a href="#MTS-677"><span class="linenos"> 677</span></a>                    <span class="p">)</span>
</span><span id="MTS-678"><a href="#MTS-678"><span class="linenos"> 678</span></a>                <span class="p">)</span>
</span><span id="MTS-679"><a href="#MTS-679"><span class="linenos"> 679</span></a>
</span><span id="MTS-680"><a href="#MTS-680"><span class="linenos"> 680</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="MTS-681"><a href="#MTS-681"><span class="linenos"> 681</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;sims&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="MTS-682"><a href="#MTS-682"><span class="linenos"> 682</span></a>            <span class="p">)</span>
</span><span id="MTS-683"><a href="#MTS-683"><span class="linenos"> 683</span></a>            <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_series</span><span class="p">):</span>
</span><span id="MTS-684"><a href="#MTS-684"><span class="linenos"> 684</span></a>                <span class="n">sims_ix</span> <span class="o">=</span> <span class="n">getsims</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="n">ix</span><span class="p">)</span>
</span><span id="MTS-685"><a href="#MTS-685"><span class="linenos"> 685</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">agg</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span><span class="p">:</span>
</span><span id="MTS-686"><a href="#MTS-686"><span class="linenos"> 686</span></a>                    <span class="n">meanf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sims_ix</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span><span id="MTS-687"><a href="#MTS-687"><span class="linenos"> 687</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MTS-688"><a href="#MTS-688"><span class="linenos"> 688</span></a>                    <span class="n">meanf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">sims_ix</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span><span id="MTS-689"><a href="#MTS-689"><span class="linenos"> 689</span></a>                <span class="n">lower</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">sims_ix</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">/</span> <span class="mi">200</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span><span id="MTS-690"><a href="#MTS-690"><span class="linenos"> 690</span></a>                <span class="n">upper</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="MTS-691"><a href="#MTS-691"><span class="linenos"> 691</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">sims_ix</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">/</span> <span class="mi">200</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="MTS-692"><a href="#MTS-692"><span class="linenos"> 692</span></a>                <span class="p">)</span>
</span><span id="MTS-693"><a href="#MTS-693"><span class="linenos"> 693</span></a>
</span><span id="MTS-694"><a href="#MTS-694"><span class="linenos"> 694</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS-695"><a href="#MTS-695"><span class="linenos"> 695</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">meanf</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="MTS-696"><a href="#MTS-696"><span class="linenos"> 696</span></a>                <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS-697"><a href="#MTS-697"><span class="linenos"> 697</span></a>                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS-698"><a href="#MTS-698"><span class="linenos"> 698</span></a>            <span class="p">)</span>
</span><span id="MTS-699"><a href="#MTS-699"><span class="linenos"> 699</span></a>
</span><span id="MTS-700"><a href="#MTS-700"><span class="linenos"> 700</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS-701"><a href="#MTS-701"><span class="linenos"> 701</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="MTS-702"><a href="#MTS-702"><span class="linenos"> 702</span></a>                <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS-703"><a href="#MTS-703"><span class="linenos"> 703</span></a>                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS-704"><a href="#MTS-704"><span class="linenos"> 704</span></a>            <span class="p">)</span>
</span><span id="MTS-705"><a href="#MTS-705"><span class="linenos"> 705</span></a>
</span><span id="MTS-706"><a href="#MTS-706"><span class="linenos"> 706</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS-707"><a href="#MTS-707"><span class="linenos"> 707</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="MTS-708"><a href="#MTS-708"><span class="linenos"> 708</span></a>                <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS-709"><a href="#MTS-709"><span class="linenos"> 709</span></a>                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS-710"><a href="#MTS-710"><span class="linenos"> 710</span></a>            <span class="p">)</span>
</span><span id="MTS-711"><a href="#MTS-711"><span class="linenos"> 711</span></a>
</span><span id="MTS-712"><a href="#MTS-712"><span class="linenos"> 712</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">DescribeResult</span><span class="p">(</span>
</span><span id="MTS-713"><a href="#MTS-713"><span class="linenos"> 713</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span>
</span><span id="MTS-714"><a href="#MTS-714"><span class="linenos"> 714</span></a>            <span class="p">)</span>
</span><span id="MTS-715"><a href="#MTS-715"><span class="linenos"> 715</span></a>
</span><span id="MTS-716"><a href="#MTS-716"><span class="linenos"> 716</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS-717"><a href="#MTS-717"><span class="linenos"> 717</span></a>
</span><span id="MTS-718"><a href="#MTS-718"><span class="linenos"> 718</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MTS-719"><a href="#MTS-719"><span class="linenos"> 719</span></a>
</span><span id="MTS-720"><a href="#MTS-720"><span class="linenos"> 720</span></a>                    <span class="n">res2</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">tuple_map</span><span class="p">(</span>
</span><span id="MTS-721"><a href="#MTS-721"><span class="linenos"> 721</span></a>                        <span class="n">res</span><span class="p">,</span>
</span><span id="MTS-722"><a href="#MTS-722"><span class="linenos"> 722</span></a>                        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mo</span><span class="o">.</span><span class="n">delete_last_columns</span><span class="p">(</span>
</span><span id="MTS-723"><a href="#MTS-723"><span class="linenos"> 723</span></a>                            <span class="n">x</span><span class="p">,</span> <span class="n">num_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MTS-724"><a href="#MTS-724"><span class="linenos"> 724</span></a>                        <span class="p">),</span>
</span><span id="MTS-725"><a href="#MTS-725"><span class="linenos"> 725</span></a>                    <span class="p">)</span>
</span><span id="MTS-726"><a href="#MTS-726"><span class="linenos"> 726</span></a>
</span><span id="MTS-727"><a href="#MTS-727"><span class="linenos"> 727</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MTS-728"><a href="#MTS-728"><span class="linenos"> 728</span></a>
</span><span id="MTS-729"><a href="#MTS-729"><span class="linenos"> 729</span></a>                    <span class="n">res2</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">tuple_map</span><span class="p">(</span>
</span><span id="MTS-730"><a href="#MTS-730"><span class="linenos"> 730</span></a>                        <span class="n">res</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mo</span><span class="o">.</span><span class="n">delete_last_columns</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">num_columns</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="MTS-731"><a href="#MTS-731"><span class="linenos"> 731</span></a>                    <span class="p">)</span>
</span><span id="MTS-732"><a href="#MTS-732"><span class="linenos"> 732</span></a>
</span><span id="MTS-733"><a href="#MTS-733"><span class="linenos"> 733</span></a>                <span class="k">return</span> <span class="n">res2</span>
</span><span id="MTS-734"><a href="#MTS-734"><span class="linenos"> 734</span></a>
</span><span id="MTS-735"><a href="#MTS-735"><span class="linenos"> 735</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="MTS-736"><a href="#MTS-736"><span class="linenos"> 736</span></a>
</span><span id="MTS-737"><a href="#MTS-737"><span class="linenos"> 737</span></a>                <span class="k">return</span> <span class="n">res</span>
</span><span id="MTS-738"><a href="#MTS-738"><span class="linenos"> 738</span></a>
</span><span id="MTS-739"><a href="#MTS-739"><span class="linenos"> 739</span></a>        <span class="k">if</span> <span class="p">((</span><span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;return_pi&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span>
</span><span id="MTS-740"><a href="#MTS-740"><span class="linenos"> 740</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">!=</span> <span class="s2">&quot;gaussian&quot;</span>
</span><span id="MTS-741"><a href="#MTS-741"><span class="linenos"> 741</span></a>        <span class="p">):</span>
</span><span id="MTS-742"><a href="#MTS-742"><span class="linenos"> 742</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="MTS-743"><a href="#MTS-743"><span class="linenos"> 743</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="MTS-744"><a href="#MTS-744"><span class="linenos"> 744</span></a>            <span class="p">)</span>
</span><span id="MTS-745"><a href="#MTS-745"><span class="linenos"> 745</span></a>
</span><span id="MTS-746"><a href="#MTS-746"><span class="linenos"> 746</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS-747"><a href="#MTS-747"><span class="linenos"> 747</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">),</span>
</span><span id="MTS-748"><a href="#MTS-748"><span class="linenos"> 748</span></a>                <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS-749"><a href="#MTS-749"><span class="linenos"> 749</span></a>                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS-750"><a href="#MTS-750"><span class="linenos"> 750</span></a>            <span class="p">)</span>
</span><span id="MTS-751"><a href="#MTS-751"><span class="linenos"> 751</span></a>
</span><span id="MTS-752"><a href="#MTS-752"><span class="linenos"> 752</span></a>            <span class="k">if</span> <span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="MTS-753"><a href="#MTS-753"><span class="linenos"> 753</span></a>
</span><span id="MTS-754"><a href="#MTS-754"><span class="linenos"> 754</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">preds_std_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preds_std_</span><span class="p">)</span>
</span><span id="MTS-755"><a href="#MTS-755"><span class="linenos"> 755</span></a>
</span><span id="MTS-756"><a href="#MTS-756"><span class="linenos"> 756</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS-757"><a href="#MTS-757"><span class="linenos"> 757</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">pi_multiplier</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">preds_std_</span><span class="p">,</span>
</span><span id="MTS-758"><a href="#MTS-758"><span class="linenos"> 758</span></a>                    <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS-759"><a href="#MTS-759"><span class="linenos"> 759</span></a>                    <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS-760"><a href="#MTS-760"><span class="linenos"> 760</span></a>                <span class="p">)</span>
</span><span id="MTS-761"><a href="#MTS-761"><span class="linenos"> 761</span></a>
</span><span id="MTS-762"><a href="#MTS-762"><span class="linenos"> 762</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS-763"><a href="#MTS-763"><span class="linenos"> 763</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">pi_multiplier</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">preds_std_</span><span class="p">,</span>
</span><span id="MTS-764"><a href="#MTS-764"><span class="linenos"> 764</span></a>                    <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS-765"><a href="#MTS-765"><span class="linenos"> 765</span></a>                    <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS-766"><a href="#MTS-766"><span class="linenos"> 766</span></a>                <span class="p">)</span>
</span><span id="MTS-767"><a href="#MTS-767"><span class="linenos"> 767</span></a>
</span><span id="MTS-768"><a href="#MTS-768"><span class="linenos"> 768</span></a>            <span class="k">if</span> <span class="s2">&quot;return_pi&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="MTS-769"><a href="#MTS-769"><span class="linenos"> 769</span></a>
</span><span id="MTS-770"><a href="#MTS-770"><span class="linenos"> 770</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS-771"><a href="#MTS-771"><span class="linenos"> 771</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">lower_pi_</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_series</span><span class="p">)</span>
</span><span id="MTS-772"><a href="#MTS-772"><span class="linenos"> 772</span></a>                    <span class="o">+</span> <span class="n">y_means_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:],</span>
</span><span id="MTS-773"><a href="#MTS-773"><span class="linenos"> 773</span></a>                    <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS-774"><a href="#MTS-774"><span class="linenos"> 774</span></a>                    <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS-775"><a href="#MTS-775"><span class="linenos"> 775</span></a>                <span class="p">)</span>
</span><span id="MTS-776"><a href="#MTS-776"><span class="linenos"> 776</span></a>
</span><span id="MTS-777"><a href="#MTS-777"><span class="linenos"> 777</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS-778"><a href="#MTS-778"><span class="linenos"> 778</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">upper_pi_</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_series</span><span class="p">)</span>
</span><span id="MTS-779"><a href="#MTS-779"><span class="linenos"> 779</span></a>                    <span class="o">+</span> <span class="n">y_means_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:],</span>
</span><span id="MTS-780"><a href="#MTS-780"><span class="linenos"> 780</span></a>                    <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS-781"><a href="#MTS-781"><span class="linenos"> 781</span></a>                    <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS-782"><a href="#MTS-782"><span class="linenos"> 782</span></a>                <span class="p">)</span>
</span><span id="MTS-783"><a href="#MTS-783"><span class="linenos"> 783</span></a>
</span><span id="MTS-784"><a href="#MTS-784"><span class="linenos"> 784</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span><span class="p">)</span>
</span><span id="MTS-785"><a href="#MTS-785"><span class="linenos"> 785</span></a>
</span><span id="MTS-786"><a href="#MTS-786"><span class="linenos"> 786</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS-787"><a href="#MTS-787"><span class="linenos"> 787</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MTS-788"><a href="#MTS-788"><span class="linenos"> 788</span></a>                    <span class="n">res2</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">tuple_map</span><span class="p">(</span>
</span><span id="MTS-789"><a href="#MTS-789"><span class="linenos"> 789</span></a>                        <span class="n">res</span><span class="p">,</span>
</span><span id="MTS-790"><a href="#MTS-790"><span class="linenos"> 790</span></a>                        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mo</span><span class="o">.</span><span class="n">delete_last_columns</span><span class="p">(</span>
</span><span id="MTS-791"><a href="#MTS-791"><span class="linenos"> 791</span></a>                            <span class="n">x</span><span class="p">,</span> <span class="n">num_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MTS-792"><a href="#MTS-792"><span class="linenos"> 792</span></a>                        <span class="p">),</span>
</span><span id="MTS-793"><a href="#MTS-793"><span class="linenos"> 793</span></a>                    <span class="p">)</span>
</span><span id="MTS-794"><a href="#MTS-794"><span class="linenos"> 794</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MTS-795"><a href="#MTS-795"><span class="linenos"> 795</span></a>                    <span class="n">res2</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">tuple_map</span><span class="p">(</span>
</span><span id="MTS-796"><a href="#MTS-796"><span class="linenos"> 796</span></a>                        <span class="n">res</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mo</span><span class="o">.</span><span class="n">delete_last_columns</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">num_columns</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="MTS-797"><a href="#MTS-797"><span class="linenos"> 797</span></a>                    <span class="p">)</span>
</span><span id="MTS-798"><a href="#MTS-798"><span class="linenos"> 798</span></a>                <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="n">res2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">res2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">res2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="MTS-799"><a href="#MTS-799"><span class="linenos"> 799</span></a>
</span><span id="MTS-800"><a href="#MTS-800"><span class="linenos"> 800</span></a>            <span class="k">return</span> <span class="n">res</span>
</span><span id="MTS-801"><a href="#MTS-801"><span class="linenos"> 801</span></a>
</span><span id="MTS-802"><a href="#MTS-802"><span class="linenos"> 802</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">==</span> <span class="s2">&quot;gaussian&quot;</span><span class="p">:</span>
</span><span id="MTS-803"><a href="#MTS-803"><span class="linenos"> 803</span></a>
</span><span id="MTS-804"><a href="#MTS-804"><span class="linenos"> 804</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="MTS-805"><a href="#MTS-805"><span class="linenos"> 805</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="MTS-806"><a href="#MTS-806"><span class="linenos"> 806</span></a>            <span class="p">)</span>
</span><span id="MTS-807"><a href="#MTS-807"><span class="linenos"> 807</span></a>
</span><span id="MTS-808"><a href="#MTS-808"><span class="linenos"> 808</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS-809"><a href="#MTS-809"><span class="linenos"> 809</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">),</span>
</span><span id="MTS-810"><a href="#MTS-810"><span class="linenos"> 810</span></a>                <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS-811"><a href="#MTS-811"><span class="linenos"> 811</span></a>                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS-812"><a href="#MTS-812"><span class="linenos"> 812</span></a>            <span class="p">)</span>
</span><span id="MTS-813"><a href="#MTS-813"><span class="linenos"> 813</span></a>
</span><span id="MTS-814"><a href="#MTS-814"><span class="linenos"> 814</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS-815"><a href="#MTS-815"><span class="linenos"> 815</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">pi_multiplier</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_preds_std_</span><span class="p">,</span>
</span><span id="MTS-816"><a href="#MTS-816"><span class="linenos"> 816</span></a>                <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS-817"><a href="#MTS-817"><span class="linenos"> 817</span></a>                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS-818"><a href="#MTS-818"><span class="linenos"> 818</span></a>            <span class="p">)</span>
</span><span id="MTS-819"><a href="#MTS-819"><span class="linenos"> 819</span></a>
</span><span id="MTS-820"><a href="#MTS-820"><span class="linenos"> 820</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS-821"><a href="#MTS-821"><span class="linenos"> 821</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">pi_multiplier</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_preds_std_</span><span class="p">,</span>
</span><span id="MTS-822"><a href="#MTS-822"><span class="linenos"> 822</span></a>                <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS-823"><a href="#MTS-823"><span class="linenos"> 823</span></a>                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS-824"><a href="#MTS-824"><span class="linenos"> 824</span></a>            <span class="p">)</span>
</span><span id="MTS-825"><a href="#MTS-825"><span class="linenos"> 825</span></a>
</span><span id="MTS-826"><a href="#MTS-826"><span class="linenos"> 826</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span><span class="p">)</span>
</span><span id="MTS-827"><a href="#MTS-827"><span class="linenos"> 827</span></a>
</span><span id="MTS-828"><a href="#MTS-828"><span class="linenos"> 828</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS-829"><a href="#MTS-829"><span class="linenos"> 829</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MTS-830"><a href="#MTS-830"><span class="linenos"> 830</span></a>                    <span class="n">res2</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">tuple_map</span><span class="p">(</span>
</span><span id="MTS-831"><a href="#MTS-831"><span class="linenos"> 831</span></a>                        <span class="n">res</span><span class="p">,</span>
</span><span id="MTS-832"><a href="#MTS-832"><span class="linenos"> 832</span></a>                        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mo</span><span class="o">.</span><span class="n">delete_last_columns</span><span class="p">(</span>
</span><span id="MTS-833"><a href="#MTS-833"><span class="linenos"> 833</span></a>                            <span class="n">x</span><span class="p">,</span> <span class="n">num_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MTS-834"><a href="#MTS-834"><span class="linenos"> 834</span></a>                        <span class="p">),</span>
</span><span id="MTS-835"><a href="#MTS-835"><span class="linenos"> 835</span></a>                    <span class="p">)</span>
</span><span id="MTS-836"><a href="#MTS-836"><span class="linenos"> 836</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MTS-837"><a href="#MTS-837"><span class="linenos"> 837</span></a>                    <span class="n">res2</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">tuple_map</span><span class="p">(</span>
</span><span id="MTS-838"><a href="#MTS-838"><span class="linenos"> 838</span></a>                        <span class="n">res</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mo</span><span class="o">.</span><span class="n">delete_last_columns</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">num_columns</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="MTS-839"><a href="#MTS-839"><span class="linenos"> 839</span></a>                    <span class="p">)</span>
</span><span id="MTS-840"><a href="#MTS-840"><span class="linenos"> 840</span></a>                <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="n">res2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">res2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">res2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="MTS-841"><a href="#MTS-841"><span class="linenos"> 841</span></a>
</span><span id="MTS-842"><a href="#MTS-842"><span class="linenos"> 842</span></a>            <span class="k">return</span> <span class="n">res</span>
</span><span id="MTS-843"><a href="#MTS-843"><span class="linenos"> 843</span></a>
</span><span id="MTS-844"><a href="#MTS-844"><span class="linenos"> 844</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">training_index</span><span class="p">,</span> <span class="n">testing_index</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MTS-845"><a href="#MTS-845"><span class="linenos"> 845</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Train on training_index, score on testing_index.&quot;&quot;&quot;</span>
</span><span id="MTS-846"><a href="#MTS-846"><span class="linenos"> 846</span></a>
</span><span id="MTS-847"><a href="#MTS-847"><span class="linenos"> 847</span></a>        <span class="k">assert</span> <span class="p">(</span>
</span><span id="MTS-848"><a href="#MTS-848"><span class="linenos"> 848</span></a>            <span class="nb">bool</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">training_index</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">testing_index</span><span class="p">)))</span> <span class="o">==</span> <span class="kc">False</span>
</span><span id="MTS-849"><a href="#MTS-849"><span class="linenos"> 849</span></a>        <span class="p">),</span> <span class="s2">&quot;Non-overlapping &#39;training_index&#39; and &#39;testing_index&#39; required&quot;</span>
</span><span id="MTS-850"><a href="#MTS-850"><span class="linenos"> 850</span></a>
</span><span id="MTS-851"><a href="#MTS-851"><span class="linenos"> 851</span></a>        <span class="c1"># Dimensions</span>
</span><span id="MTS-852"><a href="#MTS-852"><span class="linenos"> 852</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="MTS-853"><a href="#MTS-853"><span class="linenos"> 853</span></a>            <span class="c1"># multivariate time series</span>
</span><span id="MTS-854"><a href="#MTS-854"><span class="linenos"> 854</span></a>            <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="MTS-855"><a href="#MTS-855"><span class="linenos"> 855</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="MTS-856"><a href="#MTS-856"><span class="linenos"> 856</span></a>            <span class="c1"># univariate time series</span>
</span><span id="MTS-857"><a href="#MTS-857"><span class="linenos"> 857</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MTS-858"><a href="#MTS-858"><span class="linenos"> 858</span></a>            <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="MTS-859"><a href="#MTS-859"><span class="linenos"> 859</span></a>
</span><span id="MTS-860"><a href="#MTS-860"><span class="linenos"> 860</span></a>        <span class="c1"># Training and testing sets</span>
</span><span id="MTS-861"><a href="#MTS-861"><span class="linenos"> 861</span></a>        <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MTS-862"><a href="#MTS-862"><span class="linenos"> 862</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">training_index</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="MTS-863"><a href="#MTS-863"><span class="linenos"> 863</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">testing_index</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="MTS-864"><a href="#MTS-864"><span class="linenos"> 864</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MTS-865"><a href="#MTS-865"><span class="linenos"> 865</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">training_index</span><span class="p">]</span>
</span><span id="MTS-866"><a href="#MTS-866"><span class="linenos"> 866</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">testing_index</span><span class="p">]</span>
</span><span id="MTS-867"><a href="#MTS-867"><span class="linenos"> 867</span></a>
</span><span id="MTS-868"><a href="#MTS-868"><span class="linenos"> 868</span></a>        <span class="c1"># Horizon</span>
</span><span id="MTS-869"><a href="#MTS-869"><span class="linenos"> 869</span></a>        <span class="n">h</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">testing_index</span><span class="p">)</span>
</span><span id="MTS-870"><a href="#MTS-870"><span class="linenos"> 870</span></a>        <span class="k">assert</span> <span class="p">(</span>
</span><span id="MTS-871"><a href="#MTS-871"><span class="linenos"> 871</span></a>            <span class="nb">len</span><span class="p">(</span><span class="n">training_index</span><span class="p">)</span> <span class="o">+</span> <span class="n">h</span>
</span><span id="MTS-872"><a href="#MTS-872"><span class="linenos"> 872</span></a>        <span class="p">)</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">,</span> <span class="s2">&quot;Please check lengths of training and testing windows&quot;</span>
</span><span id="MTS-873"><a href="#MTS-873"><span class="linenos"> 873</span></a>
</span><span id="MTS-874"><a href="#MTS-874"><span class="linenos"> 874</span></a>        <span class="c1"># Fit and predict</span>
</span><span id="MTS-875"><a href="#MTS-875"><span class="linenos"> 875</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MTS-876"><a href="#MTS-876"><span class="linenos"> 876</span></a>        <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MTS-877"><a href="#MTS-877"><span class="linenos"> 877</span></a>
</span><span id="MTS-878"><a href="#MTS-878"><span class="linenos"> 878</span></a>        <span class="k">if</span> <span class="n">scoring</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS-879"><a href="#MTS-879"><span class="linenos"> 879</span></a>            <span class="n">scoring</span> <span class="o">=</span> <span class="s2">&quot;neg_root_mean_squared_error&quot;</span>
</span><span id="MTS-880"><a href="#MTS-880"><span class="linenos"> 880</span></a>
</span><span id="MTS-881"><a href="#MTS-881"><span class="linenos"> 881</span></a>        <span class="c1"># check inputs</span>
</span><span id="MTS-882"><a href="#MTS-882"><span class="linenos"> 882</span></a>        <span class="k">assert</span> <span class="n">scoring</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MTS-883"><a href="#MTS-883"><span class="linenos"> 883</span></a>            <span class="s2">&quot;explained_variance&quot;</span><span class="p">,</span>
</span><span id="MTS-884"><a href="#MTS-884"><span class="linenos"> 884</span></a>            <span class="s2">&quot;neg_mean_absolute_error&quot;</span><span class="p">,</span>
</span><span id="MTS-885"><a href="#MTS-885"><span class="linenos"> 885</span></a>            <span class="s2">&quot;neg_mean_squared_error&quot;</span><span class="p">,</span>
</span><span id="MTS-886"><a href="#MTS-886"><span class="linenos"> 886</span></a>            <span class="s2">&quot;neg_root_mean_squared_error&quot;</span><span class="p">,</span>
</span><span id="MTS-887"><a href="#MTS-887"><span class="linenos"> 887</span></a>            <span class="s2">&quot;neg_mean_squared_log_error&quot;</span><span class="p">,</span>
</span><span id="MTS-888"><a href="#MTS-888"><span class="linenos"> 888</span></a>            <span class="s2">&quot;neg_median_absolute_error&quot;</span><span class="p">,</span>
</span><span id="MTS-889"><a href="#MTS-889"><span class="linenos"> 889</span></a>            <span class="s2">&quot;r2&quot;</span><span class="p">,</span>
</span><span id="MTS-890"><a href="#MTS-890"><span class="linenos"> 890</span></a>        <span class="p">),</span> <span class="s2">&quot;&#39;scoring&#39; should be in (&#39;explained_variance&#39;, &#39;neg_mean_absolute_error&#39;, </span><span class="se">\</span>
</span><span id="MTS-891"><a href="#MTS-891"><span class="linenos"> 891</span></a><span class="s2">                               &#39;neg_mean_squared_error&#39;, &#39;neg_root_mean_squared_error&#39;, &#39;neg_mean_squared_log_error&#39;, </span><span class="se">\</span>
</span><span id="MTS-892"><a href="#MTS-892"><span class="linenos"> 892</span></a><span class="s2">                               &#39;neg_median_absolute_error&#39;, &#39;r2&#39;)&quot;</span>
</span><span id="MTS-893"><a href="#MTS-893"><span class="linenos"> 893</span></a>
</span><span id="MTS-894"><a href="#MTS-894"><span class="linenos"> 894</span></a>        <span class="n">scoring_options</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="MTS-895"><a href="#MTS-895"><span class="linenos"> 895</span></a>            <span class="s2">&quot;explained_variance&quot;</span><span class="p">:</span> <span class="n">skm2</span><span class="o">.</span><span class="n">explained_variance_score</span><span class="p">,</span>
</span><span id="MTS-896"><a href="#MTS-896"><span class="linenos"> 896</span></a>            <span class="s2">&quot;neg_mean_absolute_error&quot;</span><span class="p">:</span> <span class="n">skm2</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">,</span>
</span><span id="MTS-897"><a href="#MTS-897"><span class="linenos"> 897</span></a>            <span class="s2">&quot;neg_mean_squared_error&quot;</span><span class="p">:</span> <span class="n">skm2</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">,</span>
</span><span id="MTS-898"><a href="#MTS-898"><span class="linenos"> 898</span></a>            <span class="s2">&quot;neg_root_mean_squared_error&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
</span><span id="MTS-899"><a href="#MTS-899"><span class="linenos"> 899</span></a>                <span class="n">skm2</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="MTS-900"><a href="#MTS-900"><span class="linenos"> 900</span></a>            <span class="p">),</span>
</span><span id="MTS-901"><a href="#MTS-901"><span class="linenos"> 901</span></a>            <span class="s2">&quot;neg_mean_squared_log_error&quot;</span><span class="p">:</span> <span class="n">skm2</span><span class="o">.</span><span class="n">mean_squared_log_error</span><span class="p">,</span>
</span><span id="MTS-902"><a href="#MTS-902"><span class="linenos"> 902</span></a>            <span class="s2">&quot;neg_median_absolute_error&quot;</span><span class="p">:</span> <span class="n">skm2</span><span class="o">.</span><span class="n">median_absolute_error</span><span class="p">,</span>
</span><span id="MTS-903"><a href="#MTS-903"><span class="linenos"> 903</span></a>            <span class="s2">&quot;r2&quot;</span><span class="p">:</span> <span class="n">skm2</span><span class="o">.</span><span class="n">r2_score</span><span class="p">,</span>
</span><span id="MTS-904"><a href="#MTS-904"><span class="linenos"> 904</span></a>        <span class="p">}</span>
</span><span id="MTS-905"><a href="#MTS-905"><span class="linenos"> 905</span></a>
</span><span id="MTS-906"><a href="#MTS-906"><span class="linenos"> 906</span></a>        <span class="c1"># if p &gt; 1:</span>
</span><span id="MTS-907"><a href="#MTS-907"><span class="linenos"> 907</span></a>        <span class="c1">#     return tuple(</span>
</span><span id="MTS-908"><a href="#MTS-908"><span class="linenos"> 908</span></a>        <span class="c1">#         [</span>
</span><span id="MTS-909"><a href="#MTS-909"><span class="linenos"> 909</span></a>        <span class="c1">#             scoring_options[scoring](</span>
</span><span id="MTS-910"><a href="#MTS-910"><span class="linenos"> 910</span></a>        <span class="c1">#                 X_test[:, i], preds[:, i]#, **kwargs</span>
</span><span id="MTS-911"><a href="#MTS-911"><span class="linenos"> 911</span></a>        <span class="c1">#             )</span>
</span><span id="MTS-912"><a href="#MTS-912"><span class="linenos"> 912</span></a>        <span class="c1">#             for i in range(p)</span>
</span><span id="MTS-913"><a href="#MTS-913"><span class="linenos"> 913</span></a>        <span class="c1">#         ]</span>
</span><span id="MTS-914"><a href="#MTS-914"><span class="linenos"> 914</span></a>        <span class="c1">#     )</span>
</span><span id="MTS-915"><a href="#MTS-915"><span class="linenos"> 915</span></a>        <span class="c1"># else:</span>
</span><span id="MTS-916"><a href="#MTS-916"><span class="linenos"> 916</span></a>        <span class="k">return</span> <span class="n">scoring_options</span><span class="p">[</span><span class="n">scoring</span><span class="p">](</span><span class="n">X_test</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
</span><span id="MTS-917"><a href="#MTS-917"><span class="linenos"> 917</span></a>
</span><span id="MTS-918"><a href="#MTS-918"><span class="linenos"> 918</span></a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">series</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">type_axis</span><span class="o">=</span><span class="s2">&quot;dates&quot;</span><span class="p">,</span> <span class="n">type_plot</span><span class="o">=</span><span class="s2">&quot;pi&quot;</span><span class="p">):</span>
</span><span id="MTS-919"><a href="#MTS-919"><span class="linenos"> 919</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot time series forecast</span>
</span><span id="MTS-920"><a href="#MTS-920"><span class="linenos"> 920</span></a>
</span><span id="MTS-921"><a href="#MTS-921"><span class="linenos"> 921</span></a><span class="sd">        Parameters:</span>
</span><span id="MTS-922"><a href="#MTS-922"><span class="linenos"> 922</span></a>
</span><span id="MTS-923"><a href="#MTS-923"><span class="linenos"> 923</span></a><span class="sd">        series: {integer} or {string}</span>
</span><span id="MTS-924"><a href="#MTS-924"><span class="linenos"> 924</span></a><span class="sd">            series index or name</span>
</span><span id="MTS-925"><a href="#MTS-925"><span class="linenos"> 925</span></a>
</span><span id="MTS-926"><a href="#MTS-926"><span class="linenos"> 926</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MTS-927"><a href="#MTS-927"><span class="linenos"> 927</span></a>
</span><span id="MTS-928"><a href="#MTS-928"><span class="linenos"> 928</span></a>        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
</span><span id="MTS-929"><a href="#MTS-929"><span class="linenos"> 929</span></a>            <span class="p">[</span>
</span><span id="MTS-930"><a href="#MTS-930"><span class="linenos"> 930</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MTS-931"><a href="#MTS-931"><span class="linenos"> 931</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MTS-932"><a href="#MTS-932"><span class="linenos"> 932</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MTS-933"><a href="#MTS-933"><span class="linenos"> 933</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="MTS-934"><a href="#MTS-934"><span class="linenos"> 934</span></a>            <span class="p">]</span>
</span><span id="MTS-935"><a href="#MTS-935"><span class="linenos"> 935</span></a>        <span class="p">),</span> <span class="s2">&quot;model forecasting must be obtained first (with predict)&quot;</span>
</span><span id="MTS-936"><a href="#MTS-936"><span class="linenos"> 936</span></a>
</span><span id="MTS-937"><a href="#MTS-937"><span class="linenos"> 937</span></a>        <span class="k">if</span> <span class="n">series</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS-938"><a href="#MTS-938"><span class="linenos"> 938</span></a>            <span class="k">assert</span> <span class="p">(</span>
</span><span id="MTS-939"><a href="#MTS-939"><span class="linenos"> 939</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">n_series</span> <span class="o">==</span> <span class="mi">1</span>
</span><span id="MTS-940"><a href="#MTS-940"><span class="linenos"> 940</span></a>            <span class="p">),</span> <span class="s2">&quot;please specify series index or name (n_series &gt; 1)&quot;</span>
</span><span id="MTS-941"><a href="#MTS-941"><span class="linenos"> 941</span></a>            <span class="n">series</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="MTS-942"><a href="#MTS-942"><span class="linenos"> 942</span></a>
</span><span id="MTS-943"><a href="#MTS-943"><span class="linenos"> 943</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="MTS-944"><a href="#MTS-944"><span class="linenos"> 944</span></a>            <span class="k">assert</span> <span class="p">(</span>
</span><span id="MTS-945"><a href="#MTS-945"><span class="linenos"> 945</span></a>                <span class="n">series</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">series_names</span>
</span><span id="MTS-946"><a href="#MTS-946"><span class="linenos"> 946</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;series </span><span class="si">{</span><span class="n">series</span><span class="si">}</span><span class="s2"> doesn&#39;t exist in the input dataset&quot;</span>
</span><span id="MTS-947"><a href="#MTS-947"><span class="linenos"> 947</span></a>            <span class="n">series_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
</span><span id="MTS-948"><a href="#MTS-948"><span class="linenos"> 948</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MTS-949"><a href="#MTS-949"><span class="linenos"> 949</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
</span><span id="MTS-950"><a href="#MTS-950"><span class="linenos"> 950</span></a>                <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">series</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_series</span>
</span><span id="MTS-951"><a href="#MTS-951"><span class="linenos"> 951</span></a>            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;check series index (&lt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_series</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="MTS-952"><a href="#MTS-952"><span class="linenos"> 952</span></a>            <span class="n">series_idx</span> <span class="o">=</span> <span class="n">series</span>
</span><span id="MTS-953"><a href="#MTS-953"><span class="linenos"> 953</span></a>
</span><span id="MTS-954"><a href="#MTS-954"><span class="linenos"> 954</span></a>        <span class="n">y_all</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">series_idx</span><span class="p">])</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span>
</span><span id="MTS-955"><a href="#MTS-955"><span class="linenos"> 955</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">series_idx</span><span class="p">]</span>
</span><span id="MTS-956"><a href="#MTS-956"><span class="linenos"> 956</span></a>        <span class="p">)</span>
</span><span id="MTS-957"><a href="#MTS-957"><span class="linenos"> 957</span></a>        <span class="n">y_test</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">series_idx</span><span class="p">])</span>
</span><span id="MTS-958"><a href="#MTS-958"><span class="linenos"> 958</span></a>        <span class="n">n_points_all</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_all</span><span class="p">)</span>
</span><span id="MTS-959"><a href="#MTS-959"><span class="linenos"> 959</span></a>        <span class="n">n_points_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MTS-960"><a href="#MTS-960"><span class="linenos"> 960</span></a>
</span><span id="MTS-961"><a href="#MTS-961"><span class="linenos"> 961</span></a>        <span class="k">if</span> <span class="n">type_axis</span> <span class="o">==</span> <span class="s2">&quot;numeric&quot;</span><span class="p">:</span>
</span><span id="MTS-962"><a href="#MTS-962"><span class="linenos"> 962</span></a>            <span class="n">x_all</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_points_all</span><span class="p">)]</span>
</span><span id="MTS-963"><a href="#MTS-963"><span class="linenos"> 963</span></a>            <span class="n">x_test</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_points_train</span><span class="p">,</span> <span class="n">n_points_all</span><span class="p">)]</span>
</span><span id="MTS-964"><a href="#MTS-964"><span class="linenos"> 964</span></a>
</span><span id="MTS-965"><a href="#MTS-965"><span class="linenos"> 965</span></a>        <span class="k">if</span> <span class="n">type_axis</span> <span class="o">==</span> <span class="s2">&quot;dates&quot;</span><span class="p">:</span>  <span class="c1"># use dates</span>
</span><span id="MTS-966"><a href="#MTS-966"><span class="linenos"> 966</span></a>            <span class="n">x_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="MTS-967"><a href="#MTS-967"><span class="linenos"> 967</span></a>                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_dates</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span>
</span><span id="MTS-968"><a href="#MTS-968"><span class="linenos"> 968</span></a>            <span class="p">)</span>
</span><span id="MTS-969"><a href="#MTS-969"><span class="linenos"> 969</span></a>            <span class="n">x_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="o">.</span><span class="n">values</span>
</span><span id="MTS-970"><a href="#MTS-970"><span class="linenos"> 970</span></a>
</span><span id="MTS-971"><a href="#MTS-971"><span class="linenos"> 971</span></a>        <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;pi&quot;</span><span class="p">:</span>
</span><span id="MTS-972"><a href="#MTS-972"><span class="linenos"> 972</span></a>            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</span><span id="MTS-973"><a href="#MTS-973"><span class="linenos"> 973</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_all</span><span class="p">,</span> <span class="n">y_all</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
</span><span id="MTS-974"><a href="#MTS-974"><span class="linenos"> 974</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>
</span><span id="MTS-975"><a href="#MTS-975"><span class="linenos"> 975</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
</span><span id="MTS-976"><a href="#MTS-976"><span class="linenos"> 976</span></a>                <span class="n">x_test</span><span class="p">,</span>
</span><span id="MTS-977"><a href="#MTS-977"><span class="linenos"> 977</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">series_idx</span><span class="p">],</span>
</span><span id="MTS-978"><a href="#MTS-978"><span class="linenos"> 978</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">series_idx</span><span class="p">],</span>
</span><span id="MTS-979"><a href="#MTS-979"><span class="linenos"> 979</span></a>                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
</span><span id="MTS-980"><a href="#MTS-980"><span class="linenos"> 980</span></a>                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>
</span><span id="MTS-981"><a href="#MTS-981"><span class="linenos"> 981</span></a>            <span class="p">)</span>
</span><span id="MTS-982"><a href="#MTS-982"><span class="linenos"> 982</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS-983"><a href="#MTS-983"><span class="linenos"> 983</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_series</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MTS-984"><a href="#MTS-984"><span class="linenos"> 984</span></a>                    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
</span><span id="MTS-985"><a href="#MTS-985"><span class="linenos"> 985</span></a>                        <span class="sa">f</span><span class="s2">&quot;prediction intervals for </span><span class="si">{</span><span class="n">series</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MTS-986"><a href="#MTS-986"><span class="linenos"> 986</span></a>                        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="MTS-987"><a href="#MTS-987"><span class="linenos"> 987</span></a>                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
</span><span id="MTS-988"><a href="#MTS-988"><span class="linenos"> 988</span></a>                        <span class="n">fontweight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MTS-989"><a href="#MTS-989"><span class="linenos"> 989</span></a>                        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
</span><span id="MTS-990"><a href="#MTS-990"><span class="linenos"> 990</span></a>                    <span class="p">)</span>
</span><span id="MTS-991"><a href="#MTS-991"><span class="linenos"> 991</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MTS-992"><a href="#MTS-992"><span class="linenos"> 992</span></a>                    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
</span><span id="MTS-993"><a href="#MTS-993"><span class="linenos"> 993</span></a>                        <span class="sa">f</span><span class="s2">&quot;prediction intervals for input time series&quot;</span><span class="p">,</span>
</span><span id="MTS-994"><a href="#MTS-994"><span class="linenos"> 994</span></a>                        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="MTS-995"><a href="#MTS-995"><span class="linenos"> 995</span></a>                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
</span><span id="MTS-996"><a href="#MTS-996"><span class="linenos"> 996</span></a>                        <span class="n">fontweight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MTS-997"><a href="#MTS-997"><span class="linenos"> 997</span></a>                        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
</span><span id="MTS-998"><a href="#MTS-998"><span class="linenos"> 998</span></a>                    <span class="p">)</span>
</span><span id="MTS-999"><a href="#MTS-999"><span class="linenos"> 999</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="MTS-1000"><a href="#MTS-1000"><span class="linenos">1000</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># self.replications is not None</span>
</span><span id="MTS-1001"><a href="#MTS-1001"><span class="linenos">1001</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_series</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MTS-1002"><a href="#MTS-1002"><span class="linenos">1002</span></a>                    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
</span><span id="MTS-1003"><a href="#MTS-1003"><span class="linenos">1003</span></a>                        <span class="sa">f</span><span class="s2">&quot;prediction intervals for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="si">}</span><span class="s2"> simulations of </span><span class="si">{</span><span class="n">series</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MTS-1004"><a href="#MTS-1004"><span class="linenos">1004</span></a>                        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="MTS-1005"><a href="#MTS-1005"><span class="linenos">1005</span></a>                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
</span><span id="MTS-1006"><a href="#MTS-1006"><span class="linenos">1006</span></a>                        <span class="n">fontweight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MTS-1007"><a href="#MTS-1007"><span class="linenos">1007</span></a>                        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
</span><span id="MTS-1008"><a href="#MTS-1008"><span class="linenos">1008</span></a>                    <span class="p">)</span>
</span><span id="MTS-1009"><a href="#MTS-1009"><span class="linenos">1009</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MTS-1010"><a href="#MTS-1010"><span class="linenos">1010</span></a>                    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
</span><span id="MTS-1011"><a href="#MTS-1011"><span class="linenos">1011</span></a>                        <span class="sa">f</span><span class="s2">&quot;prediction intervals for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="si">}</span><span class="s2"> simulations of input time series&quot;</span><span class="p">,</span>
</span><span id="MTS-1012"><a href="#MTS-1012"><span class="linenos">1012</span></a>                        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="MTS-1013"><a href="#MTS-1013"><span class="linenos">1013</span></a>                        <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
</span><span id="MTS-1014"><a href="#MTS-1014"><span class="linenos">1014</span></a>                        <span class="n">fontweight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MTS-1015"><a href="#MTS-1015"><span class="linenos">1015</span></a>                        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
</span><span id="MTS-1016"><a href="#MTS-1016"><span class="linenos">1016</span></a>                    <span class="p">)</span>
</span><span id="MTS-1017"><a href="#MTS-1017"><span class="linenos">1017</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="MTS-1018"><a href="#MTS-1018"><span class="linenos">1018</span></a>
</span><span id="MTS-1019"><a href="#MTS-1019"><span class="linenos">1019</span></a>        <span class="k">if</span> <span class="n">type_plot</span> <span class="o">==</span> <span class="s2">&quot;spaghetti&quot;</span><span class="p">:</span>
</span><span id="MTS-1020"><a href="#MTS-1020"><span class="linenos">1020</span></a>            <span class="n">palette</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;Set1&quot;</span><span class="p">)</span>
</span><span id="MTS-1021"><a href="#MTS-1021"><span class="linenos">1021</span></a>            <span class="n">sims_ix</span> <span class="o">=</span> <span class="n">getsims</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="n">series_idx</span><span class="p">)</span>
</span><span id="MTS-1022"><a href="#MTS-1022"><span class="linenos">1022</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_all</span><span class="p">,</span> <span class="n">y_all</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
</span><span id="MTS-1023"><a href="#MTS-1023"><span class="linenos">1023</span></a>            <span class="k">for</span> <span class="n">col_ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
</span><span id="MTS-1024"><a href="#MTS-1024"><span class="linenos">1024</span></a>                <span class="n">sims_ix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MTS-1025"><a href="#MTS-1025"><span class="linenos">1025</span></a>            <span class="p">):</span>  <span class="c1"># avoid this when there are thousands of simulations</span>
</span><span id="MTS-1026"><a href="#MTS-1026"><span class="linenos">1026</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="MTS-1027"><a href="#MTS-1027"><span class="linenos">1027</span></a>                    <span class="n">x_test</span><span class="p">,</span>
</span><span id="MTS-1028"><a href="#MTS-1028"><span class="linenos">1028</span></a>                    <span class="n">sims_ix</span><span class="p">[:,</span> <span class="n">col_ix</span><span class="p">],</span>
</span><span id="MTS-1029"><a href="#MTS-1029"><span class="linenos">1029</span></a>                    <span class="s2">&quot;-&quot;</span><span class="p">,</span>
</span><span id="MTS-1030"><a href="#MTS-1030"><span class="linenos">1030</span></a>                    <span class="n">color</span><span class="o">=</span><span class="n">palette</span><span class="p">(</span><span class="n">col_ix</span><span class="p">),</span>
</span><span id="MTS-1031"><a href="#MTS-1031"><span class="linenos">1031</span></a>                    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="MTS-1032"><a href="#MTS-1032"><span class="linenos">1032</span></a>                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
</span><span id="MTS-1033"><a href="#MTS-1033"><span class="linenos">1033</span></a>                <span class="p">)</span>
</span><span id="MTS-1034"><a href="#MTS-1034"><span class="linenos">1034</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_all</span><span class="p">,</span> <span class="n">y_all</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
</span><span id="MTS-1035"><a href="#MTS-1035"><span class="linenos">1035</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</span><span id="MTS-1036"><a href="#MTS-1036"><span class="linenos">1036</span></a>            <span class="c1"># Add titles</span>
</span><span id="MTS-1037"><a href="#MTS-1037"><span class="linenos">1037</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_series</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MTS-1038"><a href="#MTS-1038"><span class="linenos">1038</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
</span><span id="MTS-1039"><a href="#MTS-1039"><span class="linenos">1039</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="si">}</span><span class="s2"> simulations of </span><span class="si">{</span><span class="n">series</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="MTS-1040"><a href="#MTS-1040"><span class="linenos">1040</span></a>                    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="MTS-1041"><a href="#MTS-1041"><span class="linenos">1041</span></a>                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
</span><span id="MTS-1042"><a href="#MTS-1042"><span class="linenos">1042</span></a>                    <span class="n">fontweight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MTS-1043"><a href="#MTS-1043"><span class="linenos">1043</span></a>                    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
</span><span id="MTS-1044"><a href="#MTS-1044"><span class="linenos">1044</span></a>                <span class="p">)</span>
</span><span id="MTS-1045"><a href="#MTS-1045"><span class="linenos">1045</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="MTS-1046"><a href="#MTS-1046"><span class="linenos">1046</span></a>                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
</span><span id="MTS-1047"><a href="#MTS-1047"><span class="linenos">1047</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="si">}</span><span class="s2"> simulations of input time series&quot;</span><span class="p">,</span>
</span><span id="MTS-1048"><a href="#MTS-1048"><span class="linenos">1048</span></a>                    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
</span><span id="MTS-1049"><a href="#MTS-1049"><span class="linenos">1049</span></a>                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
</span><span id="MTS-1050"><a href="#MTS-1050"><span class="linenos">1050</span></a>                    <span class="n">fontweight</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MTS-1051"><a href="#MTS-1051"><span class="linenos">1051</span></a>                    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
</span><span id="MTS-1052"><a href="#MTS-1052"><span class="linenos">1052</span></a>                <span class="p">)</span>
</span><span id="MTS-1053"><a href="#MTS-1053"><span class="linenos">1053</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
</span><span id="MTS-1054"><a href="#MTS-1054"><span class="linenos">1054</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Values&quot;</span><span class="p">)</span>
</span><span id="MTS-1055"><a href="#MTS-1055"><span class="linenos">1055</span></a>            <span class="c1"># Show the graph</span>
</span><span id="MTS-1056"><a href="#MTS-1056"><span class="linenos">1056</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Univariate and multivariate time series (MTS) forecasting with Quasi-Randomized networks</p>

<p>Parameters:</p>

<pre><code>obj: object.
    any object containing a method fit (obj.fit()) and a method predict
    (obj.predict()).

n_hidden_features: int.
    number of nodes in the hidden layer.

activation_name: str.
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'.

a: float.
    hyperparameter for 'prelu' or 'elu' activation function.

nodes_sim: str.
    type of simulation for the nodes: 'sobol', 'hammersley', 'halton',
    'uniform'.

bias: boolean.
    indicates if the hidden layer contains a bias term (True) or not
    (False).

dropout: float.
    regularization parameter; (random) percentage of nodes dropped out
    of the training.

direct_link: boolean.
    indicates if the original predictors are included (True) in model's fitting or not (False).

n_clusters: int.
    number of clusters for 'kmeans' or 'gmm' clustering (could be 0: no clustering).

cluster_encode: bool.
    defines how the variable containing clusters is treated (default is one-hot)
    if `False`, then labels are used, without one-hot encoding.

type_clust: str.
    type of clustering method: currently k-means ('kmeans') or Gaussian
    Mixture Model ('gmm').

type_scaling: a tuple of 3 strings.
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax').

lags: int.
    number of lags used for each time series.

type_pi: str.
    type of prediction interval; currently:
    - "gaussian": simple, fast, but: assumes stationarity of Gaussian in-sample residuals and independence in the multivariate case
    - "kde": based on Kernel Density Estimation of in-sample residuals
    - "bootstrap": based on independent bootstrap of in-sample residuals
    - "block-bootstrap": based on basic block bootstrap of in-sample residuals
    - "scp-kde": Split conformal prediction with Kernel Density Estimation of calibrated residuals
    - "scp-bootstrap": Split conformal prediction with independent bootstrap of calibrated residuals
    - "scp-block-bootstrap": Split conformal prediction with basic block bootstrap of calibrated residuals
    - "scp2-kde": Split conformal prediction with Kernel Density Estimation of standardized calibrated residuals
    - "scp2-bootstrap": Split conformal prediction with independent bootstrap of standardized calibrated residuals
    - "scp2-block-bootstrap": Split conformal prediction with basic block bootstrap of standardized calibrated residuals

replications: int.
    number of replications (if needed, for predictive simulation). Default is 'None'.

kernel: str.
    the kernel to use for residuals density estimation (used for predictive simulation). Currently, either 'gaussian' or 'tophat'.

agg: str.
    either "mean" or "median" for simulation of bootstrap aggregating

seed: int.
    reproducibility seed for nodes_sim=='uniform' or predictive simulation.

backend: str.
    "cpu" or "gpu" or "tpu".

verbose: int.
    0: not printing; 1: printing

show_progress: bool.
    True: progress bar when fitting each series; False: no progress bar when fitting each series
</code></pre>

<p>Attributes:</p>

<pre><code>fit_objs_: dict
    objects adjusted to each individual time series

y_: {array-like}
    MTS responses (most recent observations first)

X_: {array-like}
    MTS lags

xreg_: {array-like}
    external regressors

y_means_: dict
    a dictionary of each series mean values

preds_: {array-like}
    successive model predictions

preds_std_: {array-like}
    standard deviation around the predictions for Bayesian base learners (`obj`)

gaussian_preds_std_: {array-like}
    standard deviation around the predictions for `type_pi='gaussian'`

return_std_: boolean
    return uncertainty or not (set in predict)

df_: data frame
    the input data frame, in case a data.frame is provided to `fit`

n_obs_: int
    number of time series observations (number of rows for multivariate)

level_: int
    level of confidence for prediction intervals (default is 95)

residuals_: {array-like}
    in-sample residuals (for `type_pi` not conformal prediction) or calibrated residuals
    (for `type_pi` in conformal prediction)

residuals_sims_: tuple of {array-like}
    simulations of in-sample residuals (for `type_pi` not conformal prediction) or
    calibrated residuals (for `type_pi` in conformal prediction)

kde_: A scikit-learn object, see https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KernelDensity.html

residuals_std_dev_: residuals standard deviation
</code></pre>

<p>Examples:</p>

<p>Example 1:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">M</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">M</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">M</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">25</span><span class="o">*</span><span class="n">M</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>

<span class="c1"># Adjust Bayesian Ridge</span>
<span class="n">regr4</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">BayesianRidge</span><span class="p">()</span>
<span class="n">obj_MTS</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">MTS</span><span class="p">(</span><span class="n">regr4</span><span class="p">,</span> <span class="n">lags</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">obj_MTS</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obj_MTS</span><span class="o">.</span><span class="n">predict</span><span class="p">())</span>

<span class="c1"># with credible intervals</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obj_MTS</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">return_std</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">80</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">obj_MTS</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">return_std</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">))</span>
</code></pre>
</div>

<p>Example 2:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="p">{</span>
<span class="s1">&#39;date&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2001-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2002-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2003-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-01-01&#39;</span><span class="p">],</span>
<span class="s1">&#39;series1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">34</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mf">35.6</span><span class="p">,</span> <span class="mf">33.3</span><span class="p">,</span> <span class="mf">38.1</span><span class="p">],</span>
<span class="s1">&#39;series2&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">5.6</span><span class="p">,</span> <span class="mf">6.3</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">],</span>
<span class="s1">&#39;series3&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mf">100.5</span><span class="p">,</span> <span class="mf">100.6</span><span class="p">,</span> <span class="mf">100.2</span><span class="p">,</span> <span class="mf">100.1</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Adjust Bayesian Ridge</span>
<span class="n">regr5</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">BayesianRidge</span><span class="p">()</span>
<span class="n">obj_MTS</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">MTS</span><span class="p">(</span><span class="n">regr5</span><span class="p">,</span> <span class="n">lags</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">obj_MTS</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obj_MTS</span><span class="o">.</span><span class="n">predict</span><span class="p">())</span>

<span class="c1"># with credible intervals</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obj_MTS</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">return_std</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">80</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">obj_MTS</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">return_std</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">))</span>
</code></pre>
</div>
</div>


                                <div id="MTS.fit" class="classattr">
                                            <input id="MTS.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">xreg</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MTS.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MTS.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MTS.fit-293"><a href="#MTS.fit-293"><span class="linenos">293</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">xreg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MTS.fit-294"><a href="#MTS.fit-294"><span class="linenos">294</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit MTS model to training data X, with optional regressors xreg</span>
</span><span id="MTS.fit-295"><a href="#MTS.fit-295"><span class="linenos">295</span></a>
</span><span id="MTS.fit-296"><a href="#MTS.fit-296"><span class="linenos">296</span></a><span class="sd">        Parameters:</span>
</span><span id="MTS.fit-297"><a href="#MTS.fit-297"><span class="linenos">297</span></a>
</span><span id="MTS.fit-298"><a href="#MTS.fit-298"><span class="linenos">298</span></a><span class="sd">        X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="MTS.fit-299"><a href="#MTS.fit-299"><span class="linenos">299</span></a><span class="sd">            Training time series, where n_samples is the number</span>
</span><span id="MTS.fit-300"><a href="#MTS.fit-300"><span class="linenos">300</span></a><span class="sd">            of samples and n_features is the number of features;</span>
</span><span id="MTS.fit-301"><a href="#MTS.fit-301"><span class="linenos">301</span></a><span class="sd">            X must be in increasing order (most recent observations last)</span>
</span><span id="MTS.fit-302"><a href="#MTS.fit-302"><span class="linenos">302</span></a>
</span><span id="MTS.fit-303"><a href="#MTS.fit-303"><span class="linenos">303</span></a><span class="sd">        xreg: {array-like}, shape = [n_samples, n_features_xreg]</span>
</span><span id="MTS.fit-304"><a href="#MTS.fit-304"><span class="linenos">304</span></a><span class="sd">            Additional (external) regressors to be passed to self.obj</span>
</span><span id="MTS.fit-305"><a href="#MTS.fit-305"><span class="linenos">305</span></a><span class="sd">            xreg must be in &#39;increasing&#39; order (most recent observations last)</span>
</span><span id="MTS.fit-306"><a href="#MTS.fit-306"><span class="linenos">306</span></a>
</span><span id="MTS.fit-307"><a href="#MTS.fit-307"><span class="linenos">307</span></a><span class="sd">        **kwargs: for now, additional parameters to be passed to for kernel density estimation, when needed (see sklearn.neighbors.KernelDensity)</span>
</span><span id="MTS.fit-308"><a href="#MTS.fit-308"><span class="linenos">308</span></a>
</span><span id="MTS.fit-309"><a href="#MTS.fit-309"><span class="linenos">309</span></a><span class="sd">        Returns:</span>
</span><span id="MTS.fit-310"><a href="#MTS.fit-310"><span class="linenos">310</span></a>
</span><span id="MTS.fit-311"><a href="#MTS.fit-311"><span class="linenos">311</span></a><span class="sd">        self: object</span>
</span><span id="MTS.fit-312"><a href="#MTS.fit-312"><span class="linenos">312</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MTS.fit-313"><a href="#MTS.fit-313"><span class="linenos">313</span></a>
</span><span id="MTS.fit-314"><a href="#MTS.fit-314"><span class="linenos">314</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="MTS.fit-315"><a href="#MTS.fit-315"><span class="linenos">315</span></a>            <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span>
</span><span id="MTS.fit-316"><a href="#MTS.fit-316"><span class="linenos">316</span></a>        <span class="p">):</span>  <span class="c1"># input data set is a numpy array</span>
</span><span id="MTS.fit-317"><a href="#MTS.fit-317"><span class="linenos">317</span></a>
</span><span id="MTS.fit-318"><a href="#MTS.fit-318"><span class="linenos">318</span></a>            <span class="k">if</span> <span class="n">xreg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS.fit-319"><a href="#MTS.fit-319"><span class="linenos">319</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="MTS.fit-320"><a href="#MTS.fit-320"><span class="linenos">320</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">series_names</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MTS.fit-321"><a href="#MTS.fit-321"><span class="linenos">321</span></a>                    <span class="s2">&quot;series&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="MTS.fit-322"><a href="#MTS.fit-322"><span class="linenos">322</span></a>                <span class="p">]</span>
</span><span id="MTS.fit-323"><a href="#MTS.fit-323"><span class="linenos">323</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># xreg is not None</span>
</span><span id="MTS.fit-324"><a href="#MTS.fit-324"><span class="linenos">324</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">xreg</span><span class="p">)</span>
</span><span id="MTS.fit-325"><a href="#MTS.fit-325"><span class="linenos">325</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span> <span class="o">=</span> <span class="n">xreg</span>
</span><span id="MTS.fit-326"><a href="#MTS.fit-326"><span class="linenos">326</span></a>
</span><span id="MTS.fit-327"><a href="#MTS.fit-327"><span class="linenos">327</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># input data set is a DataFrame with column names</span>
</span><span id="MTS.fit-328"><a href="#MTS.fit-328"><span class="linenos">328</span></a>
</span><span id="MTS.fit-329"><a href="#MTS.fit-329"><span class="linenos">329</span></a>            <span class="n">X_index</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS.fit-330"><a href="#MTS.fit-330"><span class="linenos">330</span></a>            <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS.fit-331"><a href="#MTS.fit-331"><span class="linenos">331</span></a>                <span class="n">X_index</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span>
</span><span id="MTS.fit-332"><a href="#MTS.fit-332"><span class="linenos">332</span></a>            <span class="k">if</span> <span class="n">xreg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS.fit-333"><a href="#MTS.fit-333"><span class="linenos">333</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">mo</span><span class="o">.</span><span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</span><span id="MTS.fit-334"><a href="#MTS.fit-334"><span class="linenos">334</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="MTS.fit-335"><a href="#MTS.fit-335"><span class="linenos">335</span></a>                <span class="n">X</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">mo</span><span class="o">.</span><span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">xreg</span><span class="p">))</span>
</span><span id="MTS.fit-336"><a href="#MTS.fit-336"><span class="linenos">336</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span> <span class="o">=</span> <span class="n">xreg</span>
</span><span id="MTS.fit-337"><a href="#MTS.fit-337"><span class="linenos">337</span></a>            <span class="k">if</span> <span class="n">X_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS.fit-338"><a href="#MTS.fit-338"><span class="linenos">338</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">X_index</span>
</span><span id="MTS.fit-339"><a href="#MTS.fit-339"><span class="linenos">339</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">series_names</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="MTS.fit-340"><a href="#MTS.fit-340"><span class="linenos">340</span></a>
</span><span id="MTS.fit-341"><a href="#MTS.fit-341"><span class="linenos">341</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
</span><span id="MTS.fit-342"><a href="#MTS.fit-342"><span class="linenos">342</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">df_</span> <span class="o">=</span> <span class="n">X</span>
</span><span id="MTS.fit-343"><a href="#MTS.fit-343"><span class="linenos">343</span></a>            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">values</span>
</span><span id="MTS.fit-344"><a href="#MTS.fit-344"><span class="linenos">344</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">df_</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series_names</span>
</span><span id="MTS.fit-345"><a href="#MTS.fit-345"><span class="linenos">345</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">input_dates</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">compute_input_dates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_</span><span class="p">)</span>
</span><span id="MTS.fit-346"><a href="#MTS.fit-346"><span class="linenos">346</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MTS.fit-347"><a href="#MTS.fit-347"><span class="linenos">347</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">df_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">)</span>
</span><span id="MTS.fit-348"><a href="#MTS.fit-348"><span class="linenos">348</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">input_dates</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">compute_input_dates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_</span><span class="p">)</span>
</span><span id="MTS.fit-349"><a href="#MTS.fit-349"><span class="linenos">349</span></a>
</span><span id="MTS.fit-350"><a href="#MTS.fit-350"><span class="linenos">350</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="MTS.fit-351"><a href="#MTS.fit-351"><span class="linenos">351</span></a>            <span class="c1"># multivariate time series</span>
</span><span id="MTS.fit-352"><a href="#MTS.fit-352"><span class="linenos">352</span></a>            <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="MTS.fit-353"><a href="#MTS.fit-353"><span class="linenos">353</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="MTS.fit-354"><a href="#MTS.fit-354"><span class="linenos">354</span></a>            <span class="c1"># univariate time series</span>
</span><span id="MTS.fit-355"><a href="#MTS.fit-355"><span class="linenos">355</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MTS.fit-356"><a href="#MTS.fit-356"><span class="linenos">356</span></a>            <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="MTS.fit-357"><a href="#MTS.fit-357"><span class="linenos">357</span></a>
</span><span id="MTS.fit-358"><a href="#MTS.fit-358"><span class="linenos">358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_obs_</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="MTS.fit-359"><a href="#MTS.fit-359"><span class="linenos">359</span></a>
</span><span id="MTS.fit-360"><a href="#MTS.fit-360"><span class="linenos">360</span></a>        <span class="n">rep_1_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="MTS.fit-361"><a href="#MTS.fit-361"><span class="linenos">361</span></a>
</span><span id="MTS.fit-362"><a href="#MTS.fit-362"><span class="linenos">362</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS.fit-363"><a href="#MTS.fit-363"><span class="linenos">363</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS.fit-364"><a href="#MTS.fit-364"><span class="linenos">364</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_series</span> <span class="o">=</span> <span class="n">p</span>
</span><span id="MTS.fit-365"><a href="#MTS.fit-365"><span class="linenos">365</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="MTS.fit-366"><a href="#MTS.fit-366"><span class="linenos">366</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_means_</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="MTS.fit-367"><a href="#MTS.fit-367"><span class="linenos">367</span></a>        <span class="n">residuals_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS.fit-368"><a href="#MTS.fit-368"><span class="linenos">368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS.fit-369"><a href="#MTS.fit-369"><span class="linenos">369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS.fit-370"><a href="#MTS.fit-370"><span class="linenos">370</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS.fit-371"><a href="#MTS.fit-371"><span class="linenos">371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS.fit-372"><a href="#MTS.fit-372"><span class="linenos">372</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_Z_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MTS.fit-373"><a href="#MTS.fit-373"><span class="linenos">373</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">centered_y_is_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS.fit-374"><a href="#MTS.fit-374"><span class="linenos">374</span></a>
</span><span id="MTS.fit-375"><a href="#MTS.fit-375"><span class="linenos">375</span></a>        <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MTS.fit-376"><a href="#MTS.fit-376"><span class="linenos">376</span></a>            <span class="c1"># multivariate time series</span>
</span><span id="MTS.fit-377"><a href="#MTS.fit-377"><span class="linenos">377</span></a>            <span class="n">mts_input</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">create_train_inputs</span><span class="p">(</span><span class="n">X</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">)</span>
</span><span id="MTS.fit-378"><a href="#MTS.fit-378"><span class="linenos">378</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MTS.fit-379"><a href="#MTS.fit-379"><span class="linenos">379</span></a>            <span class="c1"># univariate time series</span>
</span><span id="MTS.fit-380"><a href="#MTS.fit-380"><span class="linenos">380</span></a>            <span class="n">mts_input</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">create_train_inputs</span><span class="p">(</span>
</span><span id="MTS.fit-381"><a href="#MTS.fit-381"><span class="linenos">381</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span>
</span><span id="MTS.fit-382"><a href="#MTS.fit-382"><span class="linenos">382</span></a>            <span class="p">)</span>
</span><span id="MTS.fit-383"><a href="#MTS.fit-383"><span class="linenos">383</span></a>
</span><span id="MTS.fit-384"><a href="#MTS.fit-384"><span class="linenos">384</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_</span> <span class="o">=</span> <span class="n">mts_input</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MTS.fit-385"><a href="#MTS.fit-385"><span class="linenos">385</span></a>
</span><span id="MTS.fit-386"><a href="#MTS.fit-386"><span class="linenos">386</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_</span> <span class="o">=</span> <span class="n">mts_input</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MTS.fit-387"><a href="#MTS.fit-387"><span class="linenos">387</span></a>
</span><span id="MTS.fit-388"><a href="#MTS.fit-388"><span class="linenos">388</span></a>        <span class="n">dummy_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">rep_1_n</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X_</span><span class="p">)</span>
</span><span id="MTS.fit-389"><a href="#MTS.fit-389"><span class="linenos">389</span></a>
</span><span id="MTS.fit-390"><a href="#MTS.fit-390"><span class="linenos">390</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_Z_</span> <span class="o">=</span> <span class="n">scaled_Z</span>
</span><span id="MTS.fit-391"><a href="#MTS.fit-391"><span class="linenos">391</span></a>
</span><span id="MTS.fit-392"><a href="#MTS.fit-392"><span class="linenos">392</span></a>        <span class="c1"># loop on all the time series and adjust self.obj.fit</span>
</span><span id="MTS.fit-393"><a href="#MTS.fit-393"><span class="linenos">393</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="MTS.fit-394"><a href="#MTS.fit-394"><span class="linenos">394</span></a>            <span class="nb">print</span><span class="p">(</span>
</span><span id="MTS.fit-395"><a href="#MTS.fit-395"><span class="linenos">395</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Adjusting </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> to multivariate time series... </span><span class="se">\n</span><span class="s2"> &quot;</span>
</span><span id="MTS.fit-396"><a href="#MTS.fit-396"><span class="linenos">396</span></a>            <span class="p">)</span>
</span><span id="MTS.fit-397"><a href="#MTS.fit-397"><span class="linenos">397</span></a>
</span><span id="MTS.fit-398"><a href="#MTS.fit-398"><span class="linenos">398</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="MTS.fit-399"><a href="#MTS.fit-399"><span class="linenos">399</span></a>            <span class="n">iterator</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</span><span id="MTS.fit-400"><a href="#MTS.fit-400"><span class="linenos">400</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MTS.fit-401"><a href="#MTS.fit-401"><span class="linenos">401</span></a>            <span class="n">iterator</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="MTS.fit-402"><a href="#MTS.fit-402"><span class="linenos">402</span></a>
</span><span id="MTS.fit-403"><a href="#MTS.fit-403"><span class="linenos">403</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;gaussian&quot;</span><span class="p">,</span> <span class="s2">&quot;kde&quot;</span><span class="p">,</span> <span class="s2">&quot;bootstrap&quot;</span><span class="p">,</span> <span class="s2">&quot;block-bootstrap&quot;</span><span class="p">):</span>
</span><span id="MTS.fit-404"><a href="#MTS.fit-404"><span class="linenos">404</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
</span><span id="MTS.fit-405"><a href="#MTS.fit-405"><span class="linenos">405</span></a>                <span class="n">y_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
</span><span id="MTS.fit-406"><a href="#MTS.fit-406"><span class="linenos">406</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y_means_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_mean</span>
</span><span id="MTS.fit-407"><a href="#MTS.fit-407"><span class="linenos">407</span></a>                <span class="n">centered_y_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_mean</span>
</span><span id="MTS.fit-408"><a href="#MTS.fit-408"><span class="linenos">408</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">centered_y_is_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">centered_y_i</span><span class="p">)</span>
</span><span id="MTS.fit-409"><a href="#MTS.fit-409"><span class="linenos">409</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">centered_y_i</span><span class="p">)</span>
</span><span id="MTS.fit-410"><a href="#MTS.fit-410"><span class="linenos">410</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
</span><span id="MTS.fit-411"><a href="#MTS.fit-411"><span class="linenos">411</span></a>                <span class="n">residuals_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="MTS.fit-412"><a href="#MTS.fit-412"><span class="linenos">412</span></a>                    <span class="p">(</span>
</span><span id="MTS.fit-413"><a href="#MTS.fit-413"><span class="linenos">413</span></a>                        <span class="n">centered_y_i</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">)</span>
</span><span id="MTS.fit-414"><a href="#MTS.fit-414"><span class="linenos">414</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="MTS.fit-415"><a href="#MTS.fit-415"><span class="linenos">415</span></a>                <span class="p">)</span>
</span><span id="MTS.fit-416"><a href="#MTS.fit-416"><span class="linenos">416</span></a>
</span><span id="MTS.fit-417"><a href="#MTS.fit-417"><span class="linenos">417</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MTS.fit-418"><a href="#MTS.fit-418"><span class="linenos">418</span></a>            <span class="s2">&quot;scp-kde&quot;</span><span class="p">,</span>
</span><span id="MTS.fit-419"><a href="#MTS.fit-419"><span class="linenos">419</span></a>            <span class="s2">&quot;scp-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS.fit-420"><a href="#MTS.fit-420"><span class="linenos">420</span></a>            <span class="s2">&quot;scp-block-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS.fit-421"><a href="#MTS.fit-421"><span class="linenos">421</span></a>            <span class="s2">&quot;scp2-kde&quot;</span><span class="p">,</span>
</span><span id="MTS.fit-422"><a href="#MTS.fit-422"><span class="linenos">422</span></a>            <span class="s2">&quot;scp2-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS.fit-423"><a href="#MTS.fit-423"><span class="linenos">423</span></a>            <span class="s2">&quot;scp2-block-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS.fit-424"><a href="#MTS.fit-424"><span class="linenos">424</span></a>        <span class="p">):</span>
</span><span id="MTS.fit-425"><a href="#MTS.fit-425"><span class="linenos">425</span></a>            <span class="c1"># split conformal prediction</span>
</span><span id="MTS.fit-426"><a href="#MTS.fit-426"><span class="linenos">426</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
</span><span id="MTS.fit-427"><a href="#MTS.fit-427"><span class="linenos">427</span></a>                <span class="n">n_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MTS.fit-428"><a href="#MTS.fit-428"><span class="linenos">428</span></a>                <span class="n">n_y_half</span> <span class="o">=</span> <span class="n">n_y</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="MTS.fit-429"><a href="#MTS.fit-429"><span class="linenos">429</span></a>                <span class="n">first_half_idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_y_half</span><span class="p">)</span>
</span><span id="MTS.fit-430"><a href="#MTS.fit-430"><span class="linenos">430</span></a>                <span class="n">second_half_idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_y_half</span><span class="p">,</span> <span class="n">n_y</span><span class="p">)</span>
</span><span id="MTS.fit-431"><a href="#MTS.fit-431"><span class="linenos">431</span></a>                <span class="n">y_mean_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">[</span><span class="n">first_half_idx</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
</span><span id="MTS.fit-432"><a href="#MTS.fit-432"><span class="linenos">432</span></a>                <span class="n">centered_y_i_temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">[</span><span class="n">first_half_idx</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_mean_temp</span>
</span><span id="MTS.fit-433"><a href="#MTS.fit-433"><span class="linenos">433</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">[</span><span class="n">first_half_idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">centered_y_i_temp</span><span class="p">)</span>
</span><span id="MTS.fit-434"><a href="#MTS.fit-434"><span class="linenos">434</span></a>                <span class="c1"># calibrated residuals actually</span>
</span><span id="MTS.fit-435"><a href="#MTS.fit-435"><span class="linenos">435</span></a>                <span class="n">residuals_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="MTS.fit-436"><a href="#MTS.fit-436"><span class="linenos">436</span></a>                    <span class="p">(</span>
</span><span id="MTS.fit-437"><a href="#MTS.fit-437"><span class="linenos">437</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">[</span><span class="n">second_half_idx</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
</span><span id="MTS.fit-438"><a href="#MTS.fit-438"><span class="linenos">438</span></a>                        <span class="o">-</span> <span class="p">(</span>
</span><span id="MTS.fit-439"><a href="#MTS.fit-439"><span class="linenos">439</span></a>                            <span class="n">y_mean_temp</span>
</span><span id="MTS.fit-440"><a href="#MTS.fit-440"><span class="linenos">440</span></a>                            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">[</span><span class="n">second_half_idx</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="MTS.fit-441"><a href="#MTS.fit-441"><span class="linenos">441</span></a>                        <span class="p">)</span>
</span><span id="MTS.fit-442"><a href="#MTS.fit-442"><span class="linenos">442</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="MTS.fit-443"><a href="#MTS.fit-443"><span class="linenos">443</span></a>                <span class="p">)</span>
</span><span id="MTS.fit-444"><a href="#MTS.fit-444"><span class="linenos">444</span></a>                <span class="c1"># fit on the second half</span>
</span><span id="MTS.fit-445"><a href="#MTS.fit-445"><span class="linenos">445</span></a>                <span class="n">y_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">[</span><span class="n">second_half_idx</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
</span><span id="MTS.fit-446"><a href="#MTS.fit-446"><span class="linenos">446</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y_means_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_mean</span>
</span><span id="MTS.fit-447"><a href="#MTS.fit-447"><span class="linenos">447</span></a>                <span class="n">centered_y_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">[</span><span class="n">second_half_idx</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_mean</span>
</span><span id="MTS.fit-448"><a href="#MTS.fit-448"><span class="linenos">448</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">[</span><span class="n">second_half_idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">centered_y_i</span><span class="p">)</span>
</span><span id="MTS.fit-449"><a href="#MTS.fit-449"><span class="linenos">449</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
</span><span id="MTS.fit-450"><a href="#MTS.fit-450"><span class="linenos">450</span></a>
</span><span id="MTS.fit-451"><a href="#MTS.fit-451"><span class="linenos">451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">residuals_</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="MTS.fit-452"><a href="#MTS.fit-452"><span class="linenos">452</span></a>
</span><span id="MTS.fit-453"><a href="#MTS.fit-453"><span class="linenos">453</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">==</span> <span class="s2">&quot;gaussian&quot;</span><span class="p">:</span>
</span><span id="MTS.fit-454"><a href="#MTS.fit-454"><span class="linenos">454</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_preds_std_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="MTS.fit-455"><a href="#MTS.fit-455"><span class="linenos">455</span></a>
</span><span id="MTS.fit-456"><a href="#MTS.fit-456"><span class="linenos">456</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MTS.fit-457"><a href="#MTS.fit-457"><span class="linenos">457</span></a>            <span class="s2">&quot;scp2-kde&quot;</span><span class="p">,</span>
</span><span id="MTS.fit-458"><a href="#MTS.fit-458"><span class="linenos">458</span></a>            <span class="s2">&quot;scp2-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS.fit-459"><a href="#MTS.fit-459"><span class="linenos">459</span></a>            <span class="s2">&quot;scp2-block-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS.fit-460"><a href="#MTS.fit-460"><span class="linenos">460</span></a>        <span class="p">):</span>
</span><span id="MTS.fit-461"><a href="#MTS.fit-461"><span class="linenos">461</span></a>            <span class="c1"># Calculate mean and standard deviation for each column</span>
</span><span id="MTS.fit-462"><a href="#MTS.fit-462"><span class="linenos">462</span></a>            <span class="n">data_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="MTS.fit-463"><a href="#MTS.fit-463"><span class="linenos">463</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">residuals_std_dev_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="MTS.fit-464"><a href="#MTS.fit-464"><span class="linenos">464</span></a>            <span class="c1"># Center and scale the array using broadcasting</span>
</span><span id="MTS.fit-465"><a href="#MTS.fit-465"><span class="linenos">465</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MTS.fit-466"><a href="#MTS.fit-466"><span class="linenos">466</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span> <span class="o">-</span> <span class="n">data_mean</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="MTS.fit-467"><a href="#MTS.fit-467"><span class="linenos">467</span></a>            <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">residuals_std_dev_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="MTS.fit-468"><a href="#MTS.fit-468"><span class="linenos">468</span></a>
</span><span id="MTS.fit-469"><a href="#MTS.fit-469"><span class="linenos">469</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MTS.fit-470"><a href="#MTS.fit-470"><span class="linenos">470</span></a>            <span class="s2">&quot;kde&quot;</span><span class="p">,</span>
</span><span id="MTS.fit-471"><a href="#MTS.fit-471"><span class="linenos">471</span></a>            <span class="s2">&quot;scp-kde&quot;</span><span class="p">,</span>
</span><span id="MTS.fit-472"><a href="#MTS.fit-472"><span class="linenos">472</span></a>            <span class="s2">&quot;scp2-kde&quot;</span><span class="p">,</span>
</span><span id="MTS.fit-473"><a href="#MTS.fit-473"><span class="linenos">473</span></a>        <span class="p">):</span>
</span><span id="MTS.fit-474"><a href="#MTS.fit-474"><span class="linenos">474</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="MTS.fit-475"><a href="#MTS.fit-475"><span class="linenos">475</span></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Simulate residuals using </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="si">}</span><span class="s2"> kernel... </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="MTS.fit-476"><a href="#MTS.fit-476"><span class="linenos">476</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MTS.fit-477"><a href="#MTS.fit-477"><span class="linenos">477</span></a>                <span class="s2">&quot;gaussian&quot;</span><span class="p">,</span>
</span><span id="MTS.fit-478"><a href="#MTS.fit-478"><span class="linenos">478</span></a>                <span class="s2">&quot;tophat&quot;</span><span class="p">,</span>
</span><span id="MTS.fit-479"><a href="#MTS.fit-479"><span class="linenos">479</span></a>            <span class="p">),</span> <span class="s2">&quot;currently, &#39;kernel&#39; must be either &#39;gaussian&#39; or &#39;tophat&#39;&quot;</span>
</span><span id="MTS.fit-480"><a href="#MTS.fit-480"><span class="linenos">480</span></a>            <span class="n">kernel_bandwidths</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;bandwidth&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">150</span><span class="p">)}</span>
</span><span id="MTS.fit-481"><a href="#MTS.fit-481"><span class="linenos">481</span></a>            <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
</span><span id="MTS.fit-482"><a href="#MTS.fit-482"><span class="linenos">482</span></a>                <span class="n">KernelDensity</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="MTS.fit-483"><a href="#MTS.fit-483"><span class="linenos">483</span></a>                <span class="n">param_grid</span><span class="o">=</span><span class="n">kernel_bandwidths</span><span class="p">,</span>
</span><span id="MTS.fit-484"><a href="#MTS.fit-484"><span class="linenos">484</span></a>            <span class="p">)</span>
</span><span id="MTS.fit-485"><a href="#MTS.fit-485"><span class="linenos">485</span></a>            <span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span><span class="p">)</span>
</span><span id="MTS.fit-486"><a href="#MTS.fit-486"><span class="linenos">486</span></a>
</span><span id="MTS.fit-487"><a href="#MTS.fit-487"><span class="linenos">487</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="MTS.fit-488"><a href="#MTS.fit-488"><span class="linenos">488</span></a>                <span class="nb">print</span><span class="p">(</span>
</span><span id="MTS.fit-489"><a href="#MTS.fit-489"><span class="linenos">489</span></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Best parameters for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="si">}</span><span class="s2"> kernel: </span><span class="si">{</span><span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="MTS.fit-490"><a href="#MTS.fit-490"><span class="linenos">490</span></a>                <span class="p">)</span>
</span><span id="MTS.fit-491"><a href="#MTS.fit-491"><span class="linenos">491</span></a>
</span><span id="MTS.fit-492"><a href="#MTS.fit-492"><span class="linenos">492</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">best_estimator_</span>
</span><span id="MTS.fit-493"><a href="#MTS.fit-493"><span class="linenos">493</span></a>
</span><span id="MTS.fit-494"><a href="#MTS.fit-494"><span class="linenos">494</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit MTS model to training data X, with optional regressors xreg</p>

<p>Parameters:</p>

<p>X: {array-like}, shape = [n_samples, n_features]
    Training time series, where n_samples is the number
    of samples and n_features is the number of features;
    X must be in increasing order (most recent observations last)</p>

<p>xreg: {array-like}, shape = [n_samples, n_features_xreg]
    Additional (external) regressors to be passed to self.obj
    xreg must be in 'increasing' order (most recent observations last)</p>

<p>**kwargs: for now, additional parameters to be passed to for kernel density estimation, when needed (see sklearn.neighbors.KernelDensity)</p>

<p>Returns:</p>

<p>self: object</p>
</div>


                                </div>
                                <div id="MTS.predict" class="classattr">
                                            <input id="MTS.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">h</span><span class="o">=</span><span class="mi">5</span>, </span><span class="param"><span class="n">level</span><span class="o">=</span><span class="mi">95</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MTS.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MTS.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MTS.predict-496"><a href="#MTS.predict-496"><span class="linenos">496</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MTS.predict-497"><a href="#MTS.predict-497"><span class="linenos">497</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Forecast all the time series, h steps ahead</span>
</span><span id="MTS.predict-498"><a href="#MTS.predict-498"><span class="linenos">498</span></a>
</span><span id="MTS.predict-499"><a href="#MTS.predict-499"><span class="linenos">499</span></a><span class="sd">        Parameters:</span>
</span><span id="MTS.predict-500"><a href="#MTS.predict-500"><span class="linenos">500</span></a>
</span><span id="MTS.predict-501"><a href="#MTS.predict-501"><span class="linenos">501</span></a><span class="sd">        h: {integer}</span>
</span><span id="MTS.predict-502"><a href="#MTS.predict-502"><span class="linenos">502</span></a><span class="sd">            Forecasting horizon</span>
</span><span id="MTS.predict-503"><a href="#MTS.predict-503"><span class="linenos">503</span></a>
</span><span id="MTS.predict-504"><a href="#MTS.predict-504"><span class="linenos">504</span></a><span class="sd">        level: {integer}</span>
</span><span id="MTS.predict-505"><a href="#MTS.predict-505"><span class="linenos">505</span></a><span class="sd">            Level of confidence (if obj has option &#39;return_std&#39; and the</span>
</span><span id="MTS.predict-506"><a href="#MTS.predict-506"><span class="linenos">506</span></a><span class="sd">            posterior is gaussian)</span>
</span><span id="MTS.predict-507"><a href="#MTS.predict-507"><span class="linenos">507</span></a>
</span><span id="MTS.predict-508"><a href="#MTS.predict-508"><span class="linenos">508</span></a><span class="sd">        new_xreg: {array-like}, shape = [n_samples = h, n_new_xreg]</span>
</span><span id="MTS.predict-509"><a href="#MTS.predict-509"><span class="linenos">509</span></a><span class="sd">            New values of additional (deterministic) regressors on horizon = h</span>
</span><span id="MTS.predict-510"><a href="#MTS.predict-510"><span class="linenos">510</span></a><span class="sd">            new_xreg must be in increasing order (most recent observations last)</span>
</span><span id="MTS.predict-511"><a href="#MTS.predict-511"><span class="linenos">511</span></a>
</span><span id="MTS.predict-512"><a href="#MTS.predict-512"><span class="linenos">512</span></a><span class="sd">        **kwargs: additional parameters to be passed to</span>
</span><span id="MTS.predict-513"><a href="#MTS.predict-513"><span class="linenos">513</span></a><span class="sd">                self.cook_test_set</span>
</span><span id="MTS.predict-514"><a href="#MTS.predict-514"><span class="linenos">514</span></a>
</span><span id="MTS.predict-515"><a href="#MTS.predict-515"><span class="linenos">515</span></a><span class="sd">        Returns:</span>
</span><span id="MTS.predict-516"><a href="#MTS.predict-516"><span class="linenos">516</span></a>
</span><span id="MTS.predict-517"><a href="#MTS.predict-517"><span class="linenos">517</span></a><span class="sd">        model predictions for horizon = h: {array-like}, data frame or tuple.</span>
</span><span id="MTS.predict-518"><a href="#MTS.predict-518"><span class="linenos">518</span></a><span class="sd">        Standard deviation and prediction intervals are returned when</span>
</span><span id="MTS.predict-519"><a href="#MTS.predict-519"><span class="linenos">519</span></a><span class="sd">        `obj.predict` can return standard deviation</span>
</span><span id="MTS.predict-520"><a href="#MTS.predict-520"><span class="linenos">520</span></a>
</span><span id="MTS.predict-521"><a href="#MTS.predict-521"><span class="linenos">521</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MTS.predict-522"><a href="#MTS.predict-522"><span class="linenos">522</span></a>
</span><span id="MTS.predict-523"><a href="#MTS.predict-523"><span class="linenos">523</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span> <span class="n">frequency</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">compute_output_dates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
</span><span id="MTS.predict-524"><a href="#MTS.predict-524"><span class="linenos">524</span></a>
</span><span id="MTS.predict-525"><a href="#MTS.predict-525"><span class="linenos">525</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">level_</span> <span class="o">=</span> <span class="n">level</span>
</span><span id="MTS.predict-526"><a href="#MTS.predict-526"><span class="linenos">526</span></a>
</span><span id="MTS.predict-527"><a href="#MTS.predict-527"><span class="linenos">527</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">return_std_</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># do not remove (/!\)</span>
</span><span id="MTS.predict-528"><a href="#MTS.predict-528"><span class="linenos">528</span></a>
</span><span id="MTS.predict-529"><a href="#MTS.predict-529"><span class="linenos">529</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># do not remove (/!\)</span>
</span><span id="MTS.predict-530"><a href="#MTS.predict-530"><span class="linenos">530</span></a>
</span><span id="MTS.predict-531"><a href="#MTS.predict-531"><span class="linenos">531</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_</span><span class="p">)</span>  <span class="c1"># do not remove (/!\)</span>
</span><span id="MTS.predict-532"><a href="#MTS.predict-532"><span class="linenos">532</span></a>
</span><span id="MTS.predict-533"><a href="#MTS.predict-533"><span class="linenos">533</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># do not remove (/!\)</span>
</span><span id="MTS.predict-534"><a href="#MTS.predict-534"><span class="linenos">534</span></a>
</span><span id="MTS.predict-535"><a href="#MTS.predict-535"><span class="linenos">535</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># do not remove (/!\)</span>
</span><span id="MTS.predict-536"><a href="#MTS.predict-536"><span class="linenos">536</span></a>
</span><span id="MTS.predict-537"><a href="#MTS.predict-537"><span class="linenos">537</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># do not remove (/!\)</span>
</span><span id="MTS.predict-538"><a href="#MTS.predict-538"><span class="linenos">538</span></a>
</span><span id="MTS.predict-539"><a href="#MTS.predict-539"><span class="linenos">539</span></a>        <span class="n">y_means_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">y_means_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_series</span><span class="p">)])</span>
</span><span id="MTS.predict-540"><a href="#MTS.predict-540"><span class="linenos">540</span></a>
</span><span id="MTS.predict-541"><a href="#MTS.predict-541"><span class="linenos">541</span></a>        <span class="n">n_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_series</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span>
</span><span id="MTS.predict-542"><a href="#MTS.predict-542"><span class="linenos">542</span></a>
</span><span id="MTS.predict-543"><a href="#MTS.predict-543"><span class="linenos">543</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">level</span>
</span><span id="MTS.predict-544"><a href="#MTS.predict-544"><span class="linenos">544</span></a>
</span><span id="MTS.predict-545"><a href="#MTS.predict-545"><span class="linenos">545</span></a>        <span class="n">pi_multiplier</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">/</span> <span class="mi">200</span><span class="p">)</span>
</span><span id="MTS.predict-546"><a href="#MTS.predict-546"><span class="linenos">546</span></a>
</span><span id="MTS.predict-547"><a href="#MTS.predict-547"><span class="linenos">547</span></a>        <span class="k">if</span> <span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>  <span class="c1"># bayesian forecasting</span>
</span><span id="MTS.predict-548"><a href="#MTS.predict-548"><span class="linenos">548</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">return_std_</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MTS.predict-549"><a href="#MTS.predict-549"><span class="linenos">549</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">preds_std_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS.predict-550"><a href="#MTS.predict-550"><span class="linenos">550</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="MTS.predict-551"><a href="#MTS.predict-551"><span class="linenos">551</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="MTS.predict-552"><a href="#MTS.predict-552"><span class="linenos">552</span></a>            <span class="p">)</span>  <span class="c1"># to be updated</span>
</span><span id="MTS.predict-553"><a href="#MTS.predict-553"><span class="linenos">553</span></a>
</span><span id="MTS.predict-554"><a href="#MTS.predict-554"><span class="linenos">554</span></a>        <span class="k">if</span> <span class="s2">&quot;return_pi&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>  <span class="c1"># split conformal, without simulation</span>
</span><span id="MTS.predict-555"><a href="#MTS.predict-555"><span class="linenos">555</span></a>            <span class="n">mean_pi_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS.predict-556"><a href="#MTS.predict-556"><span class="linenos">556</span></a>            <span class="n">lower_pi_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS.predict-557"><a href="#MTS.predict-557"><span class="linenos">557</span></a>            <span class="n">upper_pi_</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS.predict-558"><a href="#MTS.predict-558"><span class="linenos">558</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="MTS.predict-559"><a href="#MTS.predict-559"><span class="linenos">559</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="MTS.predict-560"><a href="#MTS.predict-560"><span class="linenos">560</span></a>            <span class="p">)</span>  <span class="c1"># to be updated</span>
</span><span id="MTS.predict-561"><a href="#MTS.predict-561"><span class="linenos">561</span></a>
</span><span id="MTS.predict-562"><a href="#MTS.predict-562"><span class="linenos">562</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MTS.predict-563"><a href="#MTS.predict-563"><span class="linenos">563</span></a>            <span class="s2">&quot;kde&quot;</span><span class="p">,</span>
</span><span id="MTS.predict-564"><a href="#MTS.predict-564"><span class="linenos">564</span></a>            <span class="s2">&quot;scp-kde&quot;</span><span class="p">,</span>
</span><span id="MTS.predict-565"><a href="#MTS.predict-565"><span class="linenos">565</span></a>            <span class="s2">&quot;scp2-kde&quot;</span><span class="p">,</span>
</span><span id="MTS.predict-566"><a href="#MTS.predict-566"><span class="linenos">566</span></a>        <span class="p">):</span>  <span class="c1"># kde</span>
</span><span id="MTS.predict-567"><a href="#MTS.predict-567"><span class="linenos">567</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="MTS.predict-568"><a href="#MTS.predict-568"><span class="linenos">568</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>
</span><span id="MTS.predict-569"><a href="#MTS.predict-569"><span class="linenos">569</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">))</span>
</span><span id="MTS.predict-570"><a href="#MTS.predict-570"><span class="linenos">570</span></a>            <span class="p">)</span>
</span><span id="MTS.predict-571"><a href="#MTS.predict-571"><span class="linenos">571</span></a>
</span><span id="MTS.predict-572"><a href="#MTS.predict-572"><span class="linenos">572</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;bootstrap&quot;</span><span class="p">,</span> <span class="s2">&quot;scp-bootstrap&quot;</span><span class="p">,</span> <span class="s2">&quot;scp2-bootstrap&quot;</span><span class="p">):</span>
</span><span id="MTS.predict-573"><a href="#MTS.predict-573"><span class="linenos">573</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="MTS.predict-574"><a href="#MTS.predict-574"><span class="linenos">574</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span> <span class="nb">int</span>
</span><span id="MTS.predict-575"><a href="#MTS.predict-575"><span class="linenos">575</span></a>            <span class="p">),</span> <span class="s2">&quot;&#39;replications&#39; must be provided and be an integer&quot;</span>
</span><span id="MTS.predict-576"><a href="#MTS.predict-576"><span class="linenos">576</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="MTS.predict-577"><a href="#MTS.predict-577"><span class="linenos">577</span></a>                <span class="n">ts</span><span class="o">.</span><span class="n">bootstrap</span><span class="p">(</span>
</span><span id="MTS.predict-578"><a href="#MTS.predict-578"><span class="linenos">578</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span><span class="p">,</span>
</span><span id="MTS.predict-579"><a href="#MTS.predict-579"><span class="linenos">579</span></a>                    <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span>
</span><span id="MTS.predict-580"><a href="#MTS.predict-580"><span class="linenos">580</span></a>                    <span class="n">block_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="MTS.predict-581"><a href="#MTS.predict-581"><span class="linenos">581</span></a>                    <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span>
</span><span id="MTS.predict-582"><a href="#MTS.predict-582"><span class="linenos">582</span></a>                <span class="p">)</span>
</span><span id="MTS.predict-583"><a href="#MTS.predict-583"><span class="linenos">583</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">))</span>
</span><span id="MTS.predict-584"><a href="#MTS.predict-584"><span class="linenos">584</span></a>            <span class="p">)</span>
</span><span id="MTS.predict-585"><a href="#MTS.predict-585"><span class="linenos">585</span></a>
</span><span id="MTS.predict-586"><a href="#MTS.predict-586"><span class="linenos">586</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MTS.predict-587"><a href="#MTS.predict-587"><span class="linenos">587</span></a>            <span class="s2">&quot;block-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS.predict-588"><a href="#MTS.predict-588"><span class="linenos">588</span></a>            <span class="s2">&quot;scp-block-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS.predict-589"><a href="#MTS.predict-589"><span class="linenos">589</span></a>            <span class="s2">&quot;scp2-block-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS.predict-590"><a href="#MTS.predict-590"><span class="linenos">590</span></a>        <span class="p">):</span>
</span><span id="MTS.predict-591"><a href="#MTS.predict-591"><span class="linenos">591</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
</span><span id="MTS.predict-592"><a href="#MTS.predict-592"><span class="linenos">592</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span> <span class="nb">int</span>
</span><span id="MTS.predict-593"><a href="#MTS.predict-593"><span class="linenos">593</span></a>            <span class="p">),</span> <span class="s2">&quot;&#39;replications&#39; must be provided and be an integer&quot;</span>
</span><span id="MTS.predict-594"><a href="#MTS.predict-594"><span class="linenos">594</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="MTS.predict-595"><a href="#MTS.predict-595"><span class="linenos">595</span></a>                <span class="n">ts</span><span class="o">.</span><span class="n">bootstrap</span><span class="p">(</span>
</span><span id="MTS.predict-596"><a href="#MTS.predict-596"><span class="linenos">596</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">residuals_</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">block_size</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">i</span>
</span><span id="MTS.predict-597"><a href="#MTS.predict-597"><span class="linenos">597</span></a>                <span class="p">)</span>
</span><span id="MTS.predict-598"><a href="#MTS.predict-598"><span class="linenos">598</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">))</span>
</span><span id="MTS.predict-599"><a href="#MTS.predict-599"><span class="linenos">599</span></a>            <span class="p">)</span>
</span><span id="MTS.predict-600"><a href="#MTS.predict-600"><span class="linenos">600</span></a>
</span><span id="MTS.predict-601"><a href="#MTS.predict-601"><span class="linenos">601</span></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
</span><span id="MTS.predict-602"><a href="#MTS.predict-602"><span class="linenos">602</span></a>
</span><span id="MTS.predict-603"><a href="#MTS.predict-603"><span class="linenos">603</span></a>            <span class="n">new_obs</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">reformat_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">)</span>
</span><span id="MTS.predict-604"><a href="#MTS.predict-604"><span class="linenos">604</span></a>
</span><span id="MTS.predict-605"><a href="#MTS.predict-605"><span class="linenos">605</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">new_obs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)</span>
</span><span id="MTS.predict-606"><a href="#MTS.predict-606"><span class="linenos">606</span></a>
</span><span id="MTS.predict-607"><a href="#MTS.predict-607"><span class="linenos">607</span></a>            <span class="n">cooked_new_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MTS.predict-608"><a href="#MTS.predict-608"><span class="linenos">608</span></a>
</span><span id="MTS.predict-609"><a href="#MTS.predict-609"><span class="linenos">609</span></a>            <span class="k">if</span> <span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="MTS.predict-610"><a href="#MTS.predict-610"><span class="linenos">610</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">preds_std_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="MTS.predict-611"><a href="#MTS.predict-611"><span class="linenos">611</span></a>                    <span class="p">[</span>
</span><span id="MTS.predict-612"><a href="#MTS.predict-612"><span class="linenos">612</span></a>                        <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
</span><span id="MTS.predict-613"><a href="#MTS.predict-613"><span class="linenos">613</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="MTS.predict-614"><a href="#MTS.predict-614"><span class="linenos">614</span></a>                                <span class="n">cooked_new_X</span><span class="p">,</span> <span class="n">return_std</span><span class="o">=</span><span class="kc">True</span>
</span><span id="MTS.predict-615"><a href="#MTS.predict-615"><span class="linenos">615</span></a>                            <span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MTS.predict-616"><a href="#MTS.predict-616"><span class="linenos">616</span></a>                        <span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span><span id="MTS.predict-617"><a href="#MTS.predict-617"><span class="linenos">617</span></a>                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_series</span><span class="p">)</span>
</span><span id="MTS.predict-618"><a href="#MTS.predict-618"><span class="linenos">618</span></a>                    <span class="p">]</span>
</span><span id="MTS.predict-619"><a href="#MTS.predict-619"><span class="linenos">619</span></a>                <span class="p">)</span>
</span><span id="MTS.predict-620"><a href="#MTS.predict-620"><span class="linenos">620</span></a>
</span><span id="MTS.predict-621"><a href="#MTS.predict-621"><span class="linenos">621</span></a>            <span class="k">if</span> <span class="s2">&quot;return_pi&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="MTS.predict-622"><a href="#MTS.predict-622"><span class="linenos">622</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_series</span><span class="p">):</span>
</span><span id="MTS.predict-623"><a href="#MTS.predict-623"><span class="linenos">623</span></a>                    <span class="n">preds_pi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="MTS.predict-624"><a href="#MTS.predict-624"><span class="linenos">624</span></a>                        <span class="n">cooked_new_X</span><span class="p">,</span> <span class="n">return_pi</span><span class="o">=</span><span class="kc">True</span>
</span><span id="MTS.predict-625"><a href="#MTS.predict-625"><span class="linenos">625</span></a>                    <span class="p">)</span>
</span><span id="MTS.predict-626"><a href="#MTS.predict-626"><span class="linenos">626</span></a>                    <span class="n">mean_pi_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds_pi</span><span class="o">.</span><span class="n">mean</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="MTS.predict-627"><a href="#MTS.predict-627"><span class="linenos">627</span></a>                    <span class="n">lower_pi_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds_pi</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="MTS.predict-628"><a href="#MTS.predict-628"><span class="linenos">628</span></a>                    <span class="n">upper_pi_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds_pi</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="MTS.predict-629"><a href="#MTS.predict-629"><span class="linenos">629</span></a>
</span><span id="MTS.predict-630"><a href="#MTS.predict-630"><span class="linenos">630</span></a>            <span class="n">predicted_cooked_new_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
</span><span id="MTS.predict-631"><a href="#MTS.predict-631"><span class="linenos">631</span></a>                <span class="p">[</span>
</span><span id="MTS.predict-632"><a href="#MTS.predict-632"><span class="linenos">632</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">cooked_new_X</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</span><span id="MTS.predict-633"><a href="#MTS.predict-633"><span class="linenos">633</span></a>                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_series</span><span class="p">)</span>
</span><span id="MTS.predict-634"><a href="#MTS.predict-634"><span class="linenos">634</span></a>                <span class="p">]</span>
</span><span id="MTS.predict-635"><a href="#MTS.predict-635"><span class="linenos">635</span></a>            <span class="p">)</span>
</span><span id="MTS.predict-636"><a href="#MTS.predict-636"><span class="linenos">636</span></a>
</span><span id="MTS.predict-637"><a href="#MTS.predict-637"><span class="linenos">637</span></a>            <span class="n">preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y_means_</span> <span class="o">+</span> <span class="n">predicted_cooked_new_X</span><span class="p">)</span>
</span><span id="MTS.predict-638"><a href="#MTS.predict-638"><span class="linenos">638</span></a>
</span><span id="MTS.predict-639"><a href="#MTS.predict-639"><span class="linenos">639</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">)</span>  <span class="c1"># preallocate?</span>
</span><span id="MTS.predict-640"><a href="#MTS.predict-640"><span class="linenos">640</span></a>
</span><span id="MTS.predict-641"><a href="#MTS.predict-641"><span class="linenos">641</span></a>        <span class="c1"># function&#39;s return ----------------------------------------------------------------------</span>
</span><span id="MTS.predict-642"><a href="#MTS.predict-642"><span class="linenos">642</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS.predict-643"><a href="#MTS.predict-643"><span class="linenos">643</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">h</span><span class="p">,</span> <span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
</span><span id="MTS.predict-644"><a href="#MTS.predict-644"><span class="linenos">644</span></a>            <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">df_</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
</span><span id="MTS.predict-645"><a href="#MTS.predict-645"><span class="linenos">645</span></a>            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS.predict-646"><a href="#MTS.predict-646"><span class="linenos">646</span></a>        <span class="p">)</span>
</span><span id="MTS.predict-647"><a href="#MTS.predict-647"><span class="linenos">647</span></a>        <span class="k">if</span> <span class="p">((</span><span class="s2">&quot;return_std&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;return_pi&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span>
</span><span id="MTS.predict-648"><a href="#MTS.predict-648"><span class="linenos">648</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">!=</span> <span class="s2">&quot;gaussian&quot;</span>
</span><span id="MTS.predict-649"><a href="#MTS.predict-649"><span class="linenos">649</span></a>        <span class="p">):</span>
</span><span id="MTS.predict-650"><a href="#MTS.predict-650"><span class="linenos">650</span></a>
</span><span id="MTS.predict-651"><a href="#MTS.predict-651"><span class="linenos">651</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS.predict-652"><a href="#MTS.predict-652"><span class="linenos">652</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span>
</span><span id="MTS.predict-653"><a href="#MTS.predict-653"><span class="linenos">653</span></a>
</span><span id="MTS.predict-654"><a href="#MTS.predict-654"><span class="linenos">654</span></a>            <span class="c1"># if &quot;return_std&quot; not in kwargs and self.replications is not None</span>
</span><span id="MTS.predict-655"><a href="#MTS.predict-655"><span class="linenos">655</span></a>            <span class="n">meanf</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS.predict-656"><a href="#MTS.predict-656"><span class="linenos">656</span></a>            <span class="n">lower</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS.predict-657"><a href="#MTS.predict-657"><span class="linenos">657</span></a>            <span class="n">upper</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MTS.predict-658"><a href="#MTS.predict-658"><span class="linenos">658</span></a>
</span><span id="MTS.predict-659"><a href="#MTS.predict-659"><span class="linenos">659</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MTS.predict-660"><a href="#MTS.predict-660"><span class="linenos">660</span></a>                <span class="s2">&quot;scp2-kde&quot;</span><span class="p">,</span>
</span><span id="MTS.predict-661"><a href="#MTS.predict-661"><span class="linenos">661</span></a>                <span class="s2">&quot;scp2-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS.predict-662"><a href="#MTS.predict-662"><span class="linenos">662</span></a>                <span class="s2">&quot;scp2-block-bootstrap&quot;</span><span class="p">,</span>
</span><span id="MTS.predict-663"><a href="#MTS.predict-663"><span class="linenos">663</span></a>            <span class="p">):</span>
</span><span id="MTS.predict-664"><a href="#MTS.predict-664"><span class="linenos">664</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="MTS.predict-665"><a href="#MTS.predict-665"><span class="linenos">665</span></a>                    <span class="p">(</span>
</span><span id="MTS.predict-666"><a href="#MTS.predict-666"><span class="linenos">666</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span>
</span><span id="MTS.predict-667"><a href="#MTS.predict-667"><span class="linenos">667</span></a>                        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="MTS.predict-668"><a href="#MTS.predict-668"><span class="linenos">668</span></a>                        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">residuals_std_dev_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="MTS.predict-669"><a href="#MTS.predict-669"><span class="linenos">669</span></a>                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">))</span>
</span><span id="MTS.predict-670"><a href="#MTS.predict-670"><span class="linenos">670</span></a>                    <span class="p">)</span>
</span><span id="MTS.predict-671"><a href="#MTS.predict-671"><span class="linenos">671</span></a>                <span class="p">)</span>
</span><span id="MTS.predict-672"><a href="#MTS.predict-672"><span class="linenos">672</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="MTS.predict-673"><a href="#MTS.predict-673"><span class="linenos">673</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="MTS.predict-674"><a href="#MTS.predict-674"><span class="linenos">674</span></a>                    <span class="p">(</span>
</span><span id="MTS.predict-675"><a href="#MTS.predict-675"><span class="linenos">675</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="MTS.predict-676"><a href="#MTS.predict-676"><span class="linenos">676</span></a>                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">))</span>
</span><span id="MTS.predict-677"><a href="#MTS.predict-677"><span class="linenos">677</span></a>                    <span class="p">)</span>
</span><span id="MTS.predict-678"><a href="#MTS.predict-678"><span class="linenos">678</span></a>                <span class="p">)</span>
</span><span id="MTS.predict-679"><a href="#MTS.predict-679"><span class="linenos">679</span></a>
</span><span id="MTS.predict-680"><a href="#MTS.predict-680"><span class="linenos">680</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="MTS.predict-681"><a href="#MTS.predict-681"><span class="linenos">681</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;sims&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="MTS.predict-682"><a href="#MTS.predict-682"><span class="linenos">682</span></a>            <span class="p">)</span>
</span><span id="MTS.predict-683"><a href="#MTS.predict-683"><span class="linenos">683</span></a>            <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_series</span><span class="p">):</span>
</span><span id="MTS.predict-684"><a href="#MTS.predict-684"><span class="linenos">684</span></a>                <span class="n">sims_ix</span> <span class="o">=</span> <span class="n">getsims</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="n">ix</span><span class="p">)</span>
</span><span id="MTS.predict-685"><a href="#MTS.predict-685"><span class="linenos">685</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">agg</span> <span class="o">==</span> <span class="s2">&quot;mean&quot;</span><span class="p">:</span>
</span><span id="MTS.predict-686"><a href="#MTS.predict-686"><span class="linenos">686</span></a>                    <span class="n">meanf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sims_ix</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span><span id="MTS.predict-687"><a href="#MTS.predict-687"><span class="linenos">687</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MTS.predict-688"><a href="#MTS.predict-688"><span class="linenos">688</span></a>                    <span class="n">meanf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">sims_ix</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span><span id="MTS.predict-689"><a href="#MTS.predict-689"><span class="linenos">689</span></a>                <span class="n">lower</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">sims_ix</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">/</span> <span class="mi">200</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span><span id="MTS.predict-690"><a href="#MTS.predict-690"><span class="linenos">690</span></a>                <span class="n">upper</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="MTS.predict-691"><a href="#MTS.predict-691"><span class="linenos">691</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">sims_ix</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">/</span> <span class="mi">200</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="MTS.predict-692"><a href="#MTS.predict-692"><span class="linenos">692</span></a>                <span class="p">)</span>
</span><span id="MTS.predict-693"><a href="#MTS.predict-693"><span class="linenos">693</span></a>
</span><span id="MTS.predict-694"><a href="#MTS.predict-694"><span class="linenos">694</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS.predict-695"><a href="#MTS.predict-695"><span class="linenos">695</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">meanf</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="MTS.predict-696"><a href="#MTS.predict-696"><span class="linenos">696</span></a>                <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS.predict-697"><a href="#MTS.predict-697"><span class="linenos">697</span></a>                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS.predict-698"><a href="#MTS.predict-698"><span class="linenos">698</span></a>            <span class="p">)</span>
</span><span id="MTS.predict-699"><a href="#MTS.predict-699"><span class="linenos">699</span></a>
</span><span id="MTS.predict-700"><a href="#MTS.predict-700"><span class="linenos">700</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS.predict-701"><a href="#MTS.predict-701"><span class="linenos">701</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="MTS.predict-702"><a href="#MTS.predict-702"><span class="linenos">702</span></a>                <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS.predict-703"><a href="#MTS.predict-703"><span class="linenos">703</span></a>                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS.predict-704"><a href="#MTS.predict-704"><span class="linenos">704</span></a>            <span class="p">)</span>
</span><span id="MTS.predict-705"><a href="#MTS.predict-705"><span class="linenos">705</span></a>
</span><span id="MTS.predict-706"><a href="#MTS.predict-706"><span class="linenos">706</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS.predict-707"><a href="#MTS.predict-707"><span class="linenos">707</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="MTS.predict-708"><a href="#MTS.predict-708"><span class="linenos">708</span></a>                <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS.predict-709"><a href="#MTS.predict-709"><span class="linenos">709</span></a>                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS.predict-710"><a href="#MTS.predict-710"><span class="linenos">710</span></a>            <span class="p">)</span>
</span><span id="MTS.predict-711"><a href="#MTS.predict-711"><span class="linenos">711</span></a>
</span><span id="MTS.predict-712"><a href="#MTS.predict-712"><span class="linenos">712</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">DescribeResult</span><span class="p">(</span>
</span><span id="MTS.predict-713"><a href="#MTS.predict-713"><span class="linenos">713</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span>
</span><span id="MTS.predict-714"><a href="#MTS.predict-714"><span class="linenos">714</span></a>            <span class="p">)</span>
</span><span id="MTS.predict-715"><a href="#MTS.predict-715"><span class="linenos">715</span></a>
</span><span id="MTS.predict-716"><a href="#MTS.predict-716"><span class="linenos">716</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS.predict-717"><a href="#MTS.predict-717"><span class="linenos">717</span></a>
</span><span id="MTS.predict-718"><a href="#MTS.predict-718"><span class="linenos">718</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MTS.predict-719"><a href="#MTS.predict-719"><span class="linenos">719</span></a>
</span><span id="MTS.predict-720"><a href="#MTS.predict-720"><span class="linenos">720</span></a>                    <span class="n">res2</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">tuple_map</span><span class="p">(</span>
</span><span id="MTS.predict-721"><a href="#MTS.predict-721"><span class="linenos">721</span></a>                        <span class="n">res</span><span class="p">,</span>
</span><span id="MTS.predict-722"><a href="#MTS.predict-722"><span class="linenos">722</span></a>                        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mo</span><span class="o">.</span><span class="n">delete_last_columns</span><span class="p">(</span>
</span><span id="MTS.predict-723"><a href="#MTS.predict-723"><span class="linenos">723</span></a>                            <span class="n">x</span><span class="p">,</span> <span class="n">num_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MTS.predict-724"><a href="#MTS.predict-724"><span class="linenos">724</span></a>                        <span class="p">),</span>
</span><span id="MTS.predict-725"><a href="#MTS.predict-725"><span class="linenos">725</span></a>                    <span class="p">)</span>
</span><span id="MTS.predict-726"><a href="#MTS.predict-726"><span class="linenos">726</span></a>
</span><span id="MTS.predict-727"><a href="#MTS.predict-727"><span class="linenos">727</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MTS.predict-728"><a href="#MTS.predict-728"><span class="linenos">728</span></a>
</span><span id="MTS.predict-729"><a href="#MTS.predict-729"><span class="linenos">729</span></a>                    <span class="n">res2</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">tuple_map</span><span class="p">(</span>
</span><span id="MTS.predict-730"><a href="#MTS.predict-730"><span class="linenos">730</span></a>                        <span class="n">res</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mo</span><span class="o">.</span><span class="n">delete_last_columns</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">num_columns</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="MTS.predict-731"><a href="#MTS.predict-731"><span class="linenos">731</span></a>                    <span class="p">)</span>
</span><span id="MTS.predict-732"><a href="#MTS.predict-732"><span class="linenos">732</span></a>
</span><span id="MTS.predict-733"><a href="#MTS.predict-733"><span class="linenos">733</span></a>                <span class="k">return</span> <span class="n">res2</span>
</span><span id="MTS.predict-734"><a href="#MTS.predict-734"><span class="linenos">734</span></a>
</span><span id="MTS.predict-735"><a href="#MTS.predict-735"><span class="linenos">735</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="MTS.predict-736"><a href="#MTS.predict-736"><span class="linenos">736</span></a>
</span><span id="MTS.predict-737"><a href="#MTS.predict-737"><span class="linenos">737</span></a>                <span class="k">return</span> <span class="n">res</span>
</span><span id="MTS.predict-738"><a href="#MTS.predict-738"><span class="linenos">738</span></a>
</span><span id="MTS.predict-739"><a href="#MTS.predict-739"><span class="linenos">739</span></a>        <span class="k">if</span> <span class="p">((</span><span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;return_pi&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span>
</span><span id="MTS.predict-740"><a href="#MTS.predict-740"><span class="linenos">740</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">!=</span> <span class="s2">&quot;gaussian&quot;</span>
</span><span id="MTS.predict-741"><a href="#MTS.predict-741"><span class="linenos">741</span></a>        <span class="p">):</span>
</span><span id="MTS.predict-742"><a href="#MTS.predict-742"><span class="linenos">742</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="MTS.predict-743"><a href="#MTS.predict-743"><span class="linenos">743</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="MTS.predict-744"><a href="#MTS.predict-744"><span class="linenos">744</span></a>            <span class="p">)</span>
</span><span id="MTS.predict-745"><a href="#MTS.predict-745"><span class="linenos">745</span></a>
</span><span id="MTS.predict-746"><a href="#MTS.predict-746"><span class="linenos">746</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS.predict-747"><a href="#MTS.predict-747"><span class="linenos">747</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">),</span>
</span><span id="MTS.predict-748"><a href="#MTS.predict-748"><span class="linenos">748</span></a>                <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS.predict-749"><a href="#MTS.predict-749"><span class="linenos">749</span></a>                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS.predict-750"><a href="#MTS.predict-750"><span class="linenos">750</span></a>            <span class="p">)</span>
</span><span id="MTS.predict-751"><a href="#MTS.predict-751"><span class="linenos">751</span></a>
</span><span id="MTS.predict-752"><a href="#MTS.predict-752"><span class="linenos">752</span></a>            <span class="k">if</span> <span class="s2">&quot;return_std&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="MTS.predict-753"><a href="#MTS.predict-753"><span class="linenos">753</span></a>
</span><span id="MTS.predict-754"><a href="#MTS.predict-754"><span class="linenos">754</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">preds_std_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">preds_std_</span><span class="p">)</span>
</span><span id="MTS.predict-755"><a href="#MTS.predict-755"><span class="linenos">755</span></a>
</span><span id="MTS.predict-756"><a href="#MTS.predict-756"><span class="linenos">756</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS.predict-757"><a href="#MTS.predict-757"><span class="linenos">757</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">pi_multiplier</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">preds_std_</span><span class="p">,</span>
</span><span id="MTS.predict-758"><a href="#MTS.predict-758"><span class="linenos">758</span></a>                    <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS.predict-759"><a href="#MTS.predict-759"><span class="linenos">759</span></a>                    <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS.predict-760"><a href="#MTS.predict-760"><span class="linenos">760</span></a>                <span class="p">)</span>
</span><span id="MTS.predict-761"><a href="#MTS.predict-761"><span class="linenos">761</span></a>
</span><span id="MTS.predict-762"><a href="#MTS.predict-762"><span class="linenos">762</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS.predict-763"><a href="#MTS.predict-763"><span class="linenos">763</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">pi_multiplier</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">preds_std_</span><span class="p">,</span>
</span><span id="MTS.predict-764"><a href="#MTS.predict-764"><span class="linenos">764</span></a>                    <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS.predict-765"><a href="#MTS.predict-765"><span class="linenos">765</span></a>                    <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS.predict-766"><a href="#MTS.predict-766"><span class="linenos">766</span></a>                <span class="p">)</span>
</span><span id="MTS.predict-767"><a href="#MTS.predict-767"><span class="linenos">767</span></a>
</span><span id="MTS.predict-768"><a href="#MTS.predict-768"><span class="linenos">768</span></a>            <span class="k">if</span> <span class="s2">&quot;return_pi&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="MTS.predict-769"><a href="#MTS.predict-769"><span class="linenos">769</span></a>
</span><span id="MTS.predict-770"><a href="#MTS.predict-770"><span class="linenos">770</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS.predict-771"><a href="#MTS.predict-771"><span class="linenos">771</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">lower_pi_</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_series</span><span class="p">)</span>
</span><span id="MTS.predict-772"><a href="#MTS.predict-772"><span class="linenos">772</span></a>                    <span class="o">+</span> <span class="n">y_means_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:],</span>
</span><span id="MTS.predict-773"><a href="#MTS.predict-773"><span class="linenos">773</span></a>                    <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS.predict-774"><a href="#MTS.predict-774"><span class="linenos">774</span></a>                    <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS.predict-775"><a href="#MTS.predict-775"><span class="linenos">775</span></a>                <span class="p">)</span>
</span><span id="MTS.predict-776"><a href="#MTS.predict-776"><span class="linenos">776</span></a>
</span><span id="MTS.predict-777"><a href="#MTS.predict-777"><span class="linenos">777</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS.predict-778"><a href="#MTS.predict-778"><span class="linenos">778</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">upper_pi_</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_series</span><span class="p">)</span>
</span><span id="MTS.predict-779"><a href="#MTS.predict-779"><span class="linenos">779</span></a>                    <span class="o">+</span> <span class="n">y_means_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:],</span>
</span><span id="MTS.predict-780"><a href="#MTS.predict-780"><span class="linenos">780</span></a>                    <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS.predict-781"><a href="#MTS.predict-781"><span class="linenos">781</span></a>                    <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS.predict-782"><a href="#MTS.predict-782"><span class="linenos">782</span></a>                <span class="p">)</span>
</span><span id="MTS.predict-783"><a href="#MTS.predict-783"><span class="linenos">783</span></a>
</span><span id="MTS.predict-784"><a href="#MTS.predict-784"><span class="linenos">784</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span><span class="p">)</span>
</span><span id="MTS.predict-785"><a href="#MTS.predict-785"><span class="linenos">785</span></a>
</span><span id="MTS.predict-786"><a href="#MTS.predict-786"><span class="linenos">786</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS.predict-787"><a href="#MTS.predict-787"><span class="linenos">787</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MTS.predict-788"><a href="#MTS.predict-788"><span class="linenos">788</span></a>                    <span class="n">res2</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">tuple_map</span><span class="p">(</span>
</span><span id="MTS.predict-789"><a href="#MTS.predict-789"><span class="linenos">789</span></a>                        <span class="n">res</span><span class="p">,</span>
</span><span id="MTS.predict-790"><a href="#MTS.predict-790"><span class="linenos">790</span></a>                        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mo</span><span class="o">.</span><span class="n">delete_last_columns</span><span class="p">(</span>
</span><span id="MTS.predict-791"><a href="#MTS.predict-791"><span class="linenos">791</span></a>                            <span class="n">x</span><span class="p">,</span> <span class="n">num_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MTS.predict-792"><a href="#MTS.predict-792"><span class="linenos">792</span></a>                        <span class="p">),</span>
</span><span id="MTS.predict-793"><a href="#MTS.predict-793"><span class="linenos">793</span></a>                    <span class="p">)</span>
</span><span id="MTS.predict-794"><a href="#MTS.predict-794"><span class="linenos">794</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MTS.predict-795"><a href="#MTS.predict-795"><span class="linenos">795</span></a>                    <span class="n">res2</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">tuple_map</span><span class="p">(</span>
</span><span id="MTS.predict-796"><a href="#MTS.predict-796"><span class="linenos">796</span></a>                        <span class="n">res</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mo</span><span class="o">.</span><span class="n">delete_last_columns</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">num_columns</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="MTS.predict-797"><a href="#MTS.predict-797"><span class="linenos">797</span></a>                    <span class="p">)</span>
</span><span id="MTS.predict-798"><a href="#MTS.predict-798"><span class="linenos">798</span></a>                <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="n">res2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">res2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">res2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="MTS.predict-799"><a href="#MTS.predict-799"><span class="linenos">799</span></a>
</span><span id="MTS.predict-800"><a href="#MTS.predict-800"><span class="linenos">800</span></a>            <span class="k">return</span> <span class="n">res</span>
</span><span id="MTS.predict-801"><a href="#MTS.predict-801"><span class="linenos">801</span></a>
</span><span id="MTS.predict-802"><a href="#MTS.predict-802"><span class="linenos">802</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">==</span> <span class="s2">&quot;gaussian&quot;</span><span class="p">:</span>
</span><span id="MTS.predict-803"><a href="#MTS.predict-803"><span class="linenos">803</span></a>
</span><span id="MTS.predict-804"><a href="#MTS.predict-804"><span class="linenos">804</span></a>            <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="MTS.predict-805"><a href="#MTS.predict-805"><span class="linenos">805</span></a>                <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="MTS.predict-806"><a href="#MTS.predict-806"><span class="linenos">806</span></a>            <span class="p">)</span>
</span><span id="MTS.predict-807"><a href="#MTS.predict-807"><span class="linenos">807</span></a>
</span><span id="MTS.predict-808"><a href="#MTS.predict-808"><span class="linenos">808</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS.predict-809"><a href="#MTS.predict-809"><span class="linenos">809</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">),</span>
</span><span id="MTS.predict-810"><a href="#MTS.predict-810"><span class="linenos">810</span></a>                <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS.predict-811"><a href="#MTS.predict-811"><span class="linenos">811</span></a>                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS.predict-812"><a href="#MTS.predict-812"><span class="linenos">812</span></a>            <span class="p">)</span>
</span><span id="MTS.predict-813"><a href="#MTS.predict-813"><span class="linenos">813</span></a>
</span><span id="MTS.predict-814"><a href="#MTS.predict-814"><span class="linenos">814</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS.predict-815"><a href="#MTS.predict-815"><span class="linenos">815</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">pi_multiplier</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_preds_std_</span><span class="p">,</span>
</span><span id="MTS.predict-816"><a href="#MTS.predict-816"><span class="linenos">816</span></a>                <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS.predict-817"><a href="#MTS.predict-817"><span class="linenos">817</span></a>                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS.predict-818"><a href="#MTS.predict-818"><span class="linenos">818</span></a>            <span class="p">)</span>
</span><span id="MTS.predict-819"><a href="#MTS.predict-819"><span class="linenos">819</span></a>
</span><span id="MTS.predict-820"><a href="#MTS.predict-820"><span class="linenos">820</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="MTS.predict-821"><a href="#MTS.predict-821"><span class="linenos">821</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">pi_multiplier</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_preds_std_</span><span class="p">,</span>
</span><span id="MTS.predict-822"><a href="#MTS.predict-822"><span class="linenos">822</span></a>                <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names</span><span class="p">,</span>  <span class="c1"># self.df_.columns,</span>
</span><span id="MTS.predict-823"><a href="#MTS.predict-823"><span class="linenos">823</span></a>                <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dates_</span><span class="p">,</span>
</span><span id="MTS.predict-824"><a href="#MTS.predict-824"><span class="linenos">824</span></a>            <span class="p">)</span>
</span><span id="MTS.predict-825"><a href="#MTS.predict-825"><span class="linenos">825</span></a>
</span><span id="MTS.predict-826"><a href="#MTS.predict-826"><span class="linenos">826</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span><span class="p">)</span>
</span><span id="MTS.predict-827"><a href="#MTS.predict-827"><span class="linenos">827</span></a>
</span><span id="MTS.predict-828"><a href="#MTS.predict-828"><span class="linenos">828</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS.predict-829"><a href="#MTS.predict-829"><span class="linenos">829</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MTS.predict-830"><a href="#MTS.predict-830"><span class="linenos">830</span></a>                    <span class="n">res2</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">tuple_map</span><span class="p">(</span>
</span><span id="MTS.predict-831"><a href="#MTS.predict-831"><span class="linenos">831</span></a>                        <span class="n">res</span><span class="p">,</span>
</span><span id="MTS.predict-832"><a href="#MTS.predict-832"><span class="linenos">832</span></a>                        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mo</span><span class="o">.</span><span class="n">delete_last_columns</span><span class="p">(</span>
</span><span id="MTS.predict-833"><a href="#MTS.predict-833"><span class="linenos">833</span></a>                            <span class="n">x</span><span class="p">,</span> <span class="n">num_columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xreg_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MTS.predict-834"><a href="#MTS.predict-834"><span class="linenos">834</span></a>                        <span class="p">),</span>
</span><span id="MTS.predict-835"><a href="#MTS.predict-835"><span class="linenos">835</span></a>                    <span class="p">)</span>
</span><span id="MTS.predict-836"><a href="#MTS.predict-836"><span class="linenos">836</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MTS.predict-837"><a href="#MTS.predict-837"><span class="linenos">837</span></a>                    <span class="n">res2</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">tuple_map</span><span class="p">(</span>
</span><span id="MTS.predict-838"><a href="#MTS.predict-838"><span class="linenos">838</span></a>                        <span class="n">res</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">mo</span><span class="o">.</span><span class="n">delete_last_columns</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">num_columns</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="MTS.predict-839"><a href="#MTS.predict-839"><span class="linenos">839</span></a>                    <span class="p">)</span>
</span><span id="MTS.predict-840"><a href="#MTS.predict-840"><span class="linenos">840</span></a>                <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span><span class="n">res2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">res2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">res2</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="MTS.predict-841"><a href="#MTS.predict-841"><span class="linenos">841</span></a>
</span><span id="MTS.predict-842"><a href="#MTS.predict-842"><span class="linenos">842</span></a>            <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Forecast all the time series, h steps ahead</p>

<p>Parameters:</p>

<p>h: {integer}
    Forecasting horizon</p>

<p>level: {integer}
    Level of confidence (if obj has option 'return_std' and the
    posterior is gaussian)</p>

<p>new_xreg: {array-like}, shape = [n_samples = h, n_new_xreg]
    New values of additional (deterministic) regressors on horizon = h
    new_xreg must be in increasing order (most recent observations last)</p>

<p>**kwargs: additional parameters to be passed to
        self.cook_test_set</p>

<p>Returns:</p>

<p>model predictions for horizon = h: {array-like}, data frame or tuple.
Standard deviation and prediction intervals are returned when
<code>obj.predict</code> can return standard deviation</p>
</div>


                                </div>
                                <div id="MTS.score" class="classattr">
                                            <input id="MTS.score-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">score</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">training_index</span>, </span><span class="param"><span class="n">testing_index</span>, </span><span class="param"><span class="n">scoring</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MTS.score-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MTS.score"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MTS.score-844"><a href="#MTS.score-844"><span class="linenos">844</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">training_index</span><span class="p">,</span> <span class="n">testing_index</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MTS.score-845"><a href="#MTS.score-845"><span class="linenos">845</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Train on training_index, score on testing_index.&quot;&quot;&quot;</span>
</span><span id="MTS.score-846"><a href="#MTS.score-846"><span class="linenos">846</span></a>
</span><span id="MTS.score-847"><a href="#MTS.score-847"><span class="linenos">847</span></a>        <span class="k">assert</span> <span class="p">(</span>
</span><span id="MTS.score-848"><a href="#MTS.score-848"><span class="linenos">848</span></a>            <span class="nb">bool</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">training_index</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">testing_index</span><span class="p">)))</span> <span class="o">==</span> <span class="kc">False</span>
</span><span id="MTS.score-849"><a href="#MTS.score-849"><span class="linenos">849</span></a>        <span class="p">),</span> <span class="s2">&quot;Non-overlapping &#39;training_index&#39; and &#39;testing_index&#39; required&quot;</span>
</span><span id="MTS.score-850"><a href="#MTS.score-850"><span class="linenos">850</span></a>
</span><span id="MTS.score-851"><a href="#MTS.score-851"><span class="linenos">851</span></a>        <span class="c1"># Dimensions</span>
</span><span id="MTS.score-852"><a href="#MTS.score-852"><span class="linenos">852</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="MTS.score-853"><a href="#MTS.score-853"><span class="linenos">853</span></a>            <span class="c1"># multivariate time series</span>
</span><span id="MTS.score-854"><a href="#MTS.score-854"><span class="linenos">854</span></a>            <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="MTS.score-855"><a href="#MTS.score-855"><span class="linenos">855</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="MTS.score-856"><a href="#MTS.score-856"><span class="linenos">856</span></a>            <span class="c1"># univariate time series</span>
</span><span id="MTS.score-857"><a href="#MTS.score-857"><span class="linenos">857</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MTS.score-858"><a href="#MTS.score-858"><span class="linenos">858</span></a>            <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="MTS.score-859"><a href="#MTS.score-859"><span class="linenos">859</span></a>
</span><span id="MTS.score-860"><a href="#MTS.score-860"><span class="linenos">860</span></a>        <span class="c1"># Training and testing sets</span>
</span><span id="MTS.score-861"><a href="#MTS.score-861"><span class="linenos">861</span></a>        <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MTS.score-862"><a href="#MTS.score-862"><span class="linenos">862</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">training_index</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="MTS.score-863"><a href="#MTS.score-863"><span class="linenos">863</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">testing_index</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="MTS.score-864"><a href="#MTS.score-864"><span class="linenos">864</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MTS.score-865"><a href="#MTS.score-865"><span class="linenos">865</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">training_index</span><span class="p">]</span>
</span><span id="MTS.score-866"><a href="#MTS.score-866"><span class="linenos">866</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">testing_index</span><span class="p">]</span>
</span><span id="MTS.score-867"><a href="#MTS.score-867"><span class="linenos">867</span></a>
</span><span id="MTS.score-868"><a href="#MTS.score-868"><span class="linenos">868</span></a>        <span class="c1"># Horizon</span>
</span><span id="MTS.score-869"><a href="#MTS.score-869"><span class="linenos">869</span></a>        <span class="n">h</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">testing_index</span><span class="p">)</span>
</span><span id="MTS.score-870"><a href="#MTS.score-870"><span class="linenos">870</span></a>        <span class="k">assert</span> <span class="p">(</span>
</span><span id="MTS.score-871"><a href="#MTS.score-871"><span class="linenos">871</span></a>            <span class="nb">len</span><span class="p">(</span><span class="n">training_index</span><span class="p">)</span> <span class="o">+</span> <span class="n">h</span>
</span><span id="MTS.score-872"><a href="#MTS.score-872"><span class="linenos">872</span></a>        <span class="p">)</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">,</span> <span class="s2">&quot;Please check lengths of training and testing windows&quot;</span>
</span><span id="MTS.score-873"><a href="#MTS.score-873"><span class="linenos">873</span></a>
</span><span id="MTS.score-874"><a href="#MTS.score-874"><span class="linenos">874</span></a>        <span class="c1"># Fit and predict</span>
</span><span id="MTS.score-875"><a href="#MTS.score-875"><span class="linenos">875</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MTS.score-876"><a href="#MTS.score-876"><span class="linenos">876</span></a>        <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MTS.score-877"><a href="#MTS.score-877"><span class="linenos">877</span></a>
</span><span id="MTS.score-878"><a href="#MTS.score-878"><span class="linenos">878</span></a>        <span class="k">if</span> <span class="n">scoring</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MTS.score-879"><a href="#MTS.score-879"><span class="linenos">879</span></a>            <span class="n">scoring</span> <span class="o">=</span> <span class="s2">&quot;neg_root_mean_squared_error&quot;</span>
</span><span id="MTS.score-880"><a href="#MTS.score-880"><span class="linenos">880</span></a>
</span><span id="MTS.score-881"><a href="#MTS.score-881"><span class="linenos">881</span></a>        <span class="c1"># check inputs</span>
</span><span id="MTS.score-882"><a href="#MTS.score-882"><span class="linenos">882</span></a>        <span class="k">assert</span> <span class="n">scoring</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="MTS.score-883"><a href="#MTS.score-883"><span class="linenos">883</span></a>            <span class="s2">&quot;explained_variance&quot;</span><span class="p">,</span>
</span><span id="MTS.score-884"><a href="#MTS.score-884"><span class="linenos">884</span></a>            <span class="s2">&quot;neg_mean_absolute_error&quot;</span><span class="p">,</span>
</span><span id="MTS.score-885"><a href="#MTS.score-885"><span class="linenos">885</span></a>            <span class="s2">&quot;neg_mean_squared_error&quot;</span><span class="p">,</span>
</span><span id="MTS.score-886"><a href="#MTS.score-886"><span class="linenos">886</span></a>            <span class="s2">&quot;neg_root_mean_squared_error&quot;</span><span class="p">,</span>
</span><span id="MTS.score-887"><a href="#MTS.score-887"><span class="linenos">887</span></a>            <span class="s2">&quot;neg_mean_squared_log_error&quot;</span><span class="p">,</span>
</span><span id="MTS.score-888"><a href="#MTS.score-888"><span class="linenos">888</span></a>            <span class="s2">&quot;neg_median_absolute_error&quot;</span><span class="p">,</span>
</span><span id="MTS.score-889"><a href="#MTS.score-889"><span class="linenos">889</span></a>            <span class="s2">&quot;r2&quot;</span><span class="p">,</span>
</span><span id="MTS.score-890"><a href="#MTS.score-890"><span class="linenos">890</span></a>        <span class="p">),</span> <span class="s2">&quot;&#39;scoring&#39; should be in (&#39;explained_variance&#39;, &#39;neg_mean_absolute_error&#39;, </span><span class="se">\</span>
</span><span id="MTS.score-891"><a href="#MTS.score-891"><span class="linenos">891</span></a><span class="s2">                               &#39;neg_mean_squared_error&#39;, &#39;neg_root_mean_squared_error&#39;, &#39;neg_mean_squared_log_error&#39;, </span><span class="se">\</span>
</span><span id="MTS.score-892"><a href="#MTS.score-892"><span class="linenos">892</span></a><span class="s2">                               &#39;neg_median_absolute_error&#39;, &#39;r2&#39;)&quot;</span>
</span><span id="MTS.score-893"><a href="#MTS.score-893"><span class="linenos">893</span></a>
</span><span id="MTS.score-894"><a href="#MTS.score-894"><span class="linenos">894</span></a>        <span class="n">scoring_options</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="MTS.score-895"><a href="#MTS.score-895"><span class="linenos">895</span></a>            <span class="s2">&quot;explained_variance&quot;</span><span class="p">:</span> <span class="n">skm2</span><span class="o">.</span><span class="n">explained_variance_score</span><span class="p">,</span>
</span><span id="MTS.score-896"><a href="#MTS.score-896"><span class="linenos">896</span></a>            <span class="s2">&quot;neg_mean_absolute_error&quot;</span><span class="p">:</span> <span class="n">skm2</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">,</span>
</span><span id="MTS.score-897"><a href="#MTS.score-897"><span class="linenos">897</span></a>            <span class="s2">&quot;neg_mean_squared_error&quot;</span><span class="p">:</span> <span class="n">skm2</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">,</span>
</span><span id="MTS.score-898"><a href="#MTS.score-898"><span class="linenos">898</span></a>            <span class="s2">&quot;neg_root_mean_squared_error&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
</span><span id="MTS.score-899"><a href="#MTS.score-899"><span class="linenos">899</span></a>                <span class="n">skm2</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="MTS.score-900"><a href="#MTS.score-900"><span class="linenos">900</span></a>            <span class="p">),</span>
</span><span id="MTS.score-901"><a href="#MTS.score-901"><span class="linenos">901</span></a>            <span class="s2">&quot;neg_mean_squared_log_error&quot;</span><span class="p">:</span> <span class="n">skm2</span><span class="o">.</span><span class="n">mean_squared_log_error</span><span class="p">,</span>
</span><span id="MTS.score-902"><a href="#MTS.score-902"><span class="linenos">902</span></a>            <span class="s2">&quot;neg_median_absolute_error&quot;</span><span class="p">:</span> <span class="n">skm2</span><span class="o">.</span><span class="n">median_absolute_error</span><span class="p">,</span>
</span><span id="MTS.score-903"><a href="#MTS.score-903"><span class="linenos">903</span></a>            <span class="s2">&quot;r2&quot;</span><span class="p">:</span> <span class="n">skm2</span><span class="o">.</span><span class="n">r2_score</span><span class="p">,</span>
</span><span id="MTS.score-904"><a href="#MTS.score-904"><span class="linenos">904</span></a>        <span class="p">}</span>
</span><span id="MTS.score-905"><a href="#MTS.score-905"><span class="linenos">905</span></a>
</span><span id="MTS.score-906"><a href="#MTS.score-906"><span class="linenos">906</span></a>        <span class="c1"># if p &gt; 1:</span>
</span><span id="MTS.score-907"><a href="#MTS.score-907"><span class="linenos">907</span></a>        <span class="c1">#     return tuple(</span>
</span><span id="MTS.score-908"><a href="#MTS.score-908"><span class="linenos">908</span></a>        <span class="c1">#         [</span>
</span><span id="MTS.score-909"><a href="#MTS.score-909"><span class="linenos">909</span></a>        <span class="c1">#             scoring_options[scoring](</span>
</span><span id="MTS.score-910"><a href="#MTS.score-910"><span class="linenos">910</span></a>        <span class="c1">#                 X_test[:, i], preds[:, i]#, **kwargs</span>
</span><span id="MTS.score-911"><a href="#MTS.score-911"><span class="linenos">911</span></a>        <span class="c1">#             )</span>
</span><span id="MTS.score-912"><a href="#MTS.score-912"><span class="linenos">912</span></a>        <span class="c1">#             for i in range(p)</span>
</span><span id="MTS.score-913"><a href="#MTS.score-913"><span class="linenos">913</span></a>        <span class="c1">#         ]</span>
</span><span id="MTS.score-914"><a href="#MTS.score-914"><span class="linenos">914</span></a>        <span class="c1">#     )</span>
</span><span id="MTS.score-915"><a href="#MTS.score-915"><span class="linenos">915</span></a>        <span class="c1"># else:</span>
</span><span id="MTS.score-916"><a href="#MTS.score-916"><span class="linenos">916</span></a>        <span class="k">return</span> <span class="n">scoring_options</span><span class="p">[</span><span class="n">scoring</span><span class="p">](</span><span class="n">X_test</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Train on training_index, score on testing_index.</p>
</div>


                                </div>
                        
                </section>
                <section id="MultitaskClassifier">
                            <input id="MultitaskClassifier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MultitaskClassifier</span><wbr>(<span class="base"><a href="#Base">nnetsauce.Base</a></span>, <span class="base">sklearn.base.ClassifierMixin</span>):

                <label class="view-source-button" for="MultitaskClassifier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MultitaskClassifier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MultitaskClassifier-16"><a href="#MultitaskClassifier-16"><span class="linenos"> 16</span></a><span class="k">class</span> <span class="nc">MultitaskClassifier</span><span class="p">(</span><span class="n">Base</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">):</span>
</span><span id="MultitaskClassifier-17"><a href="#MultitaskClassifier-17"><span class="linenos"> 17</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Multitask Classification model based on regression models, with shared covariates</span>
</span><span id="MultitaskClassifier-18"><a href="#MultitaskClassifier-18"><span class="linenos"> 18</span></a>
</span><span id="MultitaskClassifier-19"><a href="#MultitaskClassifier-19"><span class="linenos"> 19</span></a><span class="sd">    Parameters:</span>
</span><span id="MultitaskClassifier-20"><a href="#MultitaskClassifier-20"><span class="linenos"> 20</span></a>
</span><span id="MultitaskClassifier-21"><a href="#MultitaskClassifier-21"><span class="linenos"> 21</span></a><span class="sd">        obj: object</span>
</span><span id="MultitaskClassifier-22"><a href="#MultitaskClassifier-22"><span class="linenos"> 22</span></a><span class="sd">            any object (must be a regression model) containing a method fit (obj.fit())</span>
</span><span id="MultitaskClassifier-23"><a href="#MultitaskClassifier-23"><span class="linenos"> 23</span></a><span class="sd">            and a method predict (obj.predict())</span>
</span><span id="MultitaskClassifier-24"><a href="#MultitaskClassifier-24"><span class="linenos"> 24</span></a>
</span><span id="MultitaskClassifier-25"><a href="#MultitaskClassifier-25"><span class="linenos"> 25</span></a><span class="sd">        n_hidden_features: int</span>
</span><span id="MultitaskClassifier-26"><a href="#MultitaskClassifier-26"><span class="linenos"> 26</span></a><span class="sd">            number of nodes in the hidden layer</span>
</span><span id="MultitaskClassifier-27"><a href="#MultitaskClassifier-27"><span class="linenos"> 27</span></a>
</span><span id="MultitaskClassifier-28"><a href="#MultitaskClassifier-28"><span class="linenos"> 28</span></a><span class="sd">        activation_name: str</span>
</span><span id="MultitaskClassifier-29"><a href="#MultitaskClassifier-29"><span class="linenos"> 29</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;</span>
</span><span id="MultitaskClassifier-30"><a href="#MultitaskClassifier-30"><span class="linenos"> 30</span></a>
</span><span id="MultitaskClassifier-31"><a href="#MultitaskClassifier-31"><span class="linenos"> 31</span></a><span class="sd">        a: float</span>
</span><span id="MultitaskClassifier-32"><a href="#MultitaskClassifier-32"><span class="linenos"> 32</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function</span>
</span><span id="MultitaskClassifier-33"><a href="#MultitaskClassifier-33"><span class="linenos"> 33</span></a>
</span><span id="MultitaskClassifier-34"><a href="#MultitaskClassifier-34"><span class="linenos"> 34</span></a><span class="sd">        nodes_sim: str</span>
</span><span id="MultitaskClassifier-35"><a href="#MultitaskClassifier-35"><span class="linenos"> 35</span></a><span class="sd">            type of simulation for the nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;,</span>
</span><span id="MultitaskClassifier-36"><a href="#MultitaskClassifier-36"><span class="linenos"> 36</span></a><span class="sd">            &#39;uniform&#39;</span>
</span><span id="MultitaskClassifier-37"><a href="#MultitaskClassifier-37"><span class="linenos"> 37</span></a>
</span><span id="MultitaskClassifier-38"><a href="#MultitaskClassifier-38"><span class="linenos"> 38</span></a><span class="sd">        bias: boolean</span>
</span><span id="MultitaskClassifier-39"><a href="#MultitaskClassifier-39"><span class="linenos"> 39</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or not</span>
</span><span id="MultitaskClassifier-40"><a href="#MultitaskClassifier-40"><span class="linenos"> 40</span></a><span class="sd">            (False)</span>
</span><span id="MultitaskClassifier-41"><a href="#MultitaskClassifier-41"><span class="linenos"> 41</span></a>
</span><span id="MultitaskClassifier-42"><a href="#MultitaskClassifier-42"><span class="linenos"> 42</span></a><span class="sd">        dropout: float</span>
</span><span id="MultitaskClassifier-43"><a href="#MultitaskClassifier-43"><span class="linenos"> 43</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="MultitaskClassifier-44"><a href="#MultitaskClassifier-44"><span class="linenos"> 44</span></a><span class="sd">            of the training</span>
</span><span id="MultitaskClassifier-45"><a href="#MultitaskClassifier-45"><span class="linenos"> 45</span></a>
</span><span id="MultitaskClassifier-46"><a href="#MultitaskClassifier-46"><span class="linenos"> 46</span></a><span class="sd">        direct_link: boolean</span>
</span><span id="MultitaskClassifier-47"><a href="#MultitaskClassifier-47"><span class="linenos"> 47</span></a><span class="sd">            indicates if the original predictors are included (True) in model&#39;s</span>
</span><span id="MultitaskClassifier-48"><a href="#MultitaskClassifier-48"><span class="linenos"> 48</span></a><span class="sd">            fitting or not (False)</span>
</span><span id="MultitaskClassifier-49"><a href="#MultitaskClassifier-49"><span class="linenos"> 49</span></a>
</span><span id="MultitaskClassifier-50"><a href="#MultitaskClassifier-50"><span class="linenos"> 50</span></a><span class="sd">        n_clusters: int</span>
</span><span id="MultitaskClassifier-51"><a href="#MultitaskClassifier-51"><span class="linenos"> 51</span></a><span class="sd">            number of clusters for &#39;kmeans&#39; or &#39;gmm&#39; clustering (could be 0:</span>
</span><span id="MultitaskClassifier-52"><a href="#MultitaskClassifier-52"><span class="linenos"> 52</span></a><span class="sd">                no clustering)</span>
</span><span id="MultitaskClassifier-53"><a href="#MultitaskClassifier-53"><span class="linenos"> 53</span></a>
</span><span id="MultitaskClassifier-54"><a href="#MultitaskClassifier-54"><span class="linenos"> 54</span></a><span class="sd">        cluster_encode: bool</span>
</span><span id="MultitaskClassifier-55"><a href="#MultitaskClassifier-55"><span class="linenos"> 55</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot)</span>
</span><span id="MultitaskClassifier-56"><a href="#MultitaskClassifier-56"><span class="linenos"> 56</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding</span>
</span><span id="MultitaskClassifier-57"><a href="#MultitaskClassifier-57"><span class="linenos"> 57</span></a>
</span><span id="MultitaskClassifier-58"><a href="#MultitaskClassifier-58"><span class="linenos"> 58</span></a><span class="sd">        type_clust: str</span>
</span><span id="MultitaskClassifier-59"><a href="#MultitaskClassifier-59"><span class="linenos"> 59</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian</span>
</span><span id="MultitaskClassifier-60"><a href="#MultitaskClassifier-60"><span class="linenos"> 60</span></a><span class="sd">            Mixture Model (&#39;gmm&#39;)</span>
</span><span id="MultitaskClassifier-61"><a href="#MultitaskClassifier-61"><span class="linenos"> 61</span></a>
</span><span id="MultitaskClassifier-62"><a href="#MultitaskClassifier-62"><span class="linenos"> 62</span></a><span class="sd">        type_scaling: a tuple of 3 strings</span>
</span><span id="MultitaskClassifier-63"><a href="#MultitaskClassifier-63"><span class="linenos"> 63</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="MultitaskClassifier-64"><a href="#MultitaskClassifier-64"><span class="linenos"> 64</span></a><span class="sd">            (and when relevant).</span>
</span><span id="MultitaskClassifier-65"><a href="#MultitaskClassifier-65"><span class="linenos"> 65</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;)</span>
</span><span id="MultitaskClassifier-66"><a href="#MultitaskClassifier-66"><span class="linenos"> 66</span></a>
</span><span id="MultitaskClassifier-67"><a href="#MultitaskClassifier-67"><span class="linenos"> 67</span></a><span class="sd">        col_sample: float</span>
</span><span id="MultitaskClassifier-68"><a href="#MultitaskClassifier-68"><span class="linenos"> 68</span></a><span class="sd">            percentage of covariates randomly chosen for training</span>
</span><span id="MultitaskClassifier-69"><a href="#MultitaskClassifier-69"><span class="linenos"> 69</span></a>
</span><span id="MultitaskClassifier-70"><a href="#MultitaskClassifier-70"><span class="linenos"> 70</span></a><span class="sd">        row_sample: float</span>
</span><span id="MultitaskClassifier-71"><a href="#MultitaskClassifier-71"><span class="linenos"> 71</span></a><span class="sd">            percentage of rows chosen for training, by stratified bootstrapping</span>
</span><span id="MultitaskClassifier-72"><a href="#MultitaskClassifier-72"><span class="linenos"> 72</span></a>
</span><span id="MultitaskClassifier-73"><a href="#MultitaskClassifier-73"><span class="linenos"> 73</span></a><span class="sd">        seed: int</span>
</span><span id="MultitaskClassifier-74"><a href="#MultitaskClassifier-74"><span class="linenos"> 74</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39;</span>
</span><span id="MultitaskClassifier-75"><a href="#MultitaskClassifier-75"><span class="linenos"> 75</span></a>
</span><span id="MultitaskClassifier-76"><a href="#MultitaskClassifier-76"><span class="linenos"> 76</span></a><span class="sd">        backend: str</span>
</span><span id="MultitaskClassifier-77"><a href="#MultitaskClassifier-77"><span class="linenos"> 77</span></a><span class="sd">            &quot;cpu&quot; or &quot;gpu&quot; or &quot;tpu&quot;</span>
</span><span id="MultitaskClassifier-78"><a href="#MultitaskClassifier-78"><span class="linenos"> 78</span></a>
</span><span id="MultitaskClassifier-79"><a href="#MultitaskClassifier-79"><span class="linenos"> 79</span></a><span class="sd">    Attributes:</span>
</span><span id="MultitaskClassifier-80"><a href="#MultitaskClassifier-80"><span class="linenos"> 80</span></a>
</span><span id="MultitaskClassifier-81"><a href="#MultitaskClassifier-81"><span class="linenos"> 81</span></a><span class="sd">        fit_objs_: dict</span>
</span><span id="MultitaskClassifier-82"><a href="#MultitaskClassifier-82"><span class="linenos"> 82</span></a><span class="sd">            objects adjusted to each individual time series</span>
</span><span id="MultitaskClassifier-83"><a href="#MultitaskClassifier-83"><span class="linenos"> 83</span></a>
</span><span id="MultitaskClassifier-84"><a href="#MultitaskClassifier-84"><span class="linenos"> 84</span></a><span class="sd">        n_classes_: int</span>
</span><span id="MultitaskClassifier-85"><a href="#MultitaskClassifier-85"><span class="linenos"> 85</span></a><span class="sd">            number of classes for the classifier</span>
</span><span id="MultitaskClassifier-86"><a href="#MultitaskClassifier-86"><span class="linenos"> 86</span></a>
</span><span id="MultitaskClassifier-87"><a href="#MultitaskClassifier-87"><span class="linenos"> 87</span></a><span class="sd">    Examples:</span>
</span><span id="MultitaskClassifier-88"><a href="#MultitaskClassifier-88"><span class="linenos"> 88</span></a>
</span><span id="MultitaskClassifier-89"><a href="#MultitaskClassifier-89"><span class="linenos"> 89</span></a><span class="sd">    See also [https://github.com/Techtonique/nnetsauce/blob/master/examples/mtask_classification.py](https://github.com/Techtonique/nnetsauce/blob/master/examples/mtask_classification.py)</span>
</span><span id="MultitaskClassifier-90"><a href="#MultitaskClassifier-90"><span class="linenos"> 90</span></a>
</span><span id="MultitaskClassifier-91"><a href="#MultitaskClassifier-91"><span class="linenos"> 91</span></a><span class="sd">    ```python</span>
</span><span id="MultitaskClassifier-92"><a href="#MultitaskClassifier-92"><span class="linenos"> 92</span></a><span class="sd">    import nnetsauce as ns</span>
</span><span id="MultitaskClassifier-93"><a href="#MultitaskClassifier-93"><span class="linenos"> 93</span></a><span class="sd">    import numpy as np</span>
</span><span id="MultitaskClassifier-94"><a href="#MultitaskClassifier-94"><span class="linenos"> 94</span></a><span class="sd">    from sklearn.datasets import load_breast_cancer</span>
</span><span id="MultitaskClassifier-95"><a href="#MultitaskClassifier-95"><span class="linenos"> 95</span></a><span class="sd">    from sklearn.linear_model import LinearRegression</span>
</span><span id="MultitaskClassifier-96"><a href="#MultitaskClassifier-96"><span class="linenos"> 96</span></a><span class="sd">    from sklearn.model_selection import train_test_split</span>
</span><span id="MultitaskClassifier-97"><a href="#MultitaskClassifier-97"><span class="linenos"> 97</span></a><span class="sd">    from sklearn import metrics</span>
</span><span id="MultitaskClassifier-98"><a href="#MultitaskClassifier-98"><span class="linenos"> 98</span></a><span class="sd">    from time import time</span>
</span><span id="MultitaskClassifier-99"><a href="#MultitaskClassifier-99"><span class="linenos"> 99</span></a>
</span><span id="MultitaskClassifier-100"><a href="#MultitaskClassifier-100"><span class="linenos">100</span></a><span class="sd">    breast_cancer = load_breast_cancer()</span>
</span><span id="MultitaskClassifier-101"><a href="#MultitaskClassifier-101"><span class="linenos">101</span></a><span class="sd">    Z = breast_cancer.data</span>
</span><span id="MultitaskClassifier-102"><a href="#MultitaskClassifier-102"><span class="linenos">102</span></a><span class="sd">    t = breast_cancer.target</span>
</span><span id="MultitaskClassifier-103"><a href="#MultitaskClassifier-103"><span class="linenos">103</span></a>
</span><span id="MultitaskClassifier-104"><a href="#MultitaskClassifier-104"><span class="linenos">104</span></a><span class="sd">    X_train, X_test, y_train, y_test = train_test_split(Z, t, test_size=0.2,</span>
</span><span id="MultitaskClassifier-105"><a href="#MultitaskClassifier-105"><span class="linenos">105</span></a><span class="sd">                                                        random_state=123+2*10)</span>
</span><span id="MultitaskClassifier-106"><a href="#MultitaskClassifier-106"><span class="linenos">106</span></a>
</span><span id="MultitaskClassifier-107"><a href="#MultitaskClassifier-107"><span class="linenos">107</span></a><span class="sd">    # Linear Regression is used</span>
</span><span id="MultitaskClassifier-108"><a href="#MultitaskClassifier-108"><span class="linenos">108</span></a><span class="sd">    regr = LinearRegression()</span>
</span><span id="MultitaskClassifier-109"><a href="#MultitaskClassifier-109"><span class="linenos">109</span></a><span class="sd">    fit_obj = ns.MultitaskClassifier(regr, n_hidden_features=5,</span>
</span><span id="MultitaskClassifier-110"><a href="#MultitaskClassifier-110"><span class="linenos">110</span></a><span class="sd">                                n_clusters=2, type_clust=&quot;gmm&quot;)</span>
</span><span id="MultitaskClassifier-111"><a href="#MultitaskClassifier-111"><span class="linenos">111</span></a>
</span><span id="MultitaskClassifier-112"><a href="#MultitaskClassifier-112"><span class="linenos">112</span></a><span class="sd">    start = time()</span>
</span><span id="MultitaskClassifier-113"><a href="#MultitaskClassifier-113"><span class="linenos">113</span></a><span class="sd">    fit_obj.fit(X_train, y_train)</span>
</span><span id="MultitaskClassifier-114"><a href="#MultitaskClassifier-114"><span class="linenos">114</span></a><span class="sd">    print(f&quot;Elapsed {time() - start}&quot;)</span>
</span><span id="MultitaskClassifier-115"><a href="#MultitaskClassifier-115"><span class="linenos">115</span></a>
</span><span id="MultitaskClassifier-116"><a href="#MultitaskClassifier-116"><span class="linenos">116</span></a><span class="sd">    print(fit_obj.score(X_test, y_test))</span>
</span><span id="MultitaskClassifier-117"><a href="#MultitaskClassifier-117"><span class="linenos">117</span></a><span class="sd">    print(fit_obj.score(X_test, y_test, scoring=&quot;roc_auc&quot;))</span>
</span><span id="MultitaskClassifier-118"><a href="#MultitaskClassifier-118"><span class="linenos">118</span></a>
</span><span id="MultitaskClassifier-119"><a href="#MultitaskClassifier-119"><span class="linenos">119</span></a><span class="sd">    start = time()</span>
</span><span id="MultitaskClassifier-120"><a href="#MultitaskClassifier-120"><span class="linenos">120</span></a><span class="sd">    preds = fit_obj.predict(X_test)</span>
</span><span id="MultitaskClassifier-121"><a href="#MultitaskClassifier-121"><span class="linenos">121</span></a><span class="sd">    print(f&quot;Elapsed {time() - start}&quot;)</span>
</span><span id="MultitaskClassifier-122"><a href="#MultitaskClassifier-122"><span class="linenos">122</span></a><span class="sd">    print(metrics.classification_report(preds, y_test))</span>
</span><span id="MultitaskClassifier-123"><a href="#MultitaskClassifier-123"><span class="linenos">123</span></a><span class="sd">    ```</span>
</span><span id="MultitaskClassifier-124"><a href="#MultitaskClassifier-124"><span class="linenos">124</span></a>
</span><span id="MultitaskClassifier-125"><a href="#MultitaskClassifier-125"><span class="linenos">125</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MultitaskClassifier-126"><a href="#MultitaskClassifier-126"><span class="linenos">126</span></a>
</span><span id="MultitaskClassifier-127"><a href="#MultitaskClassifier-127"><span class="linenos">127</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="MultitaskClassifier-128"><a href="#MultitaskClassifier-128"><span class="linenos">128</span></a>
</span><span id="MultitaskClassifier-129"><a href="#MultitaskClassifier-129"><span class="linenos">129</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="MultitaskClassifier-130"><a href="#MultitaskClassifier-130"><span class="linenos">130</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="MultitaskClassifier-131"><a href="#MultitaskClassifier-131"><span class="linenos">131</span></a>        <span class="n">obj</span><span class="p">,</span>
</span><span id="MultitaskClassifier-132"><a href="#MultitaskClassifier-132"><span class="linenos">132</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="MultitaskClassifier-133"><a href="#MultitaskClassifier-133"><span class="linenos">133</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="MultitaskClassifier-134"><a href="#MultitaskClassifier-134"><span class="linenos">134</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="MultitaskClassifier-135"><a href="#MultitaskClassifier-135"><span class="linenos">135</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="MultitaskClassifier-136"><a href="#MultitaskClassifier-136"><span class="linenos">136</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="MultitaskClassifier-137"><a href="#MultitaskClassifier-137"><span class="linenos">137</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="MultitaskClassifier-138"><a href="#MultitaskClassifier-138"><span class="linenos">138</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="MultitaskClassifier-139"><a href="#MultitaskClassifier-139"><span class="linenos">139</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="MultitaskClassifier-140"><a href="#MultitaskClassifier-140"><span class="linenos">140</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="MultitaskClassifier-141"><a href="#MultitaskClassifier-141"><span class="linenos">141</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="MultitaskClassifier-142"><a href="#MultitaskClassifier-142"><span class="linenos">142</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="MultitaskClassifier-143"><a href="#MultitaskClassifier-143"><span class="linenos">143</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="MultitaskClassifier-144"><a href="#MultitaskClassifier-144"><span class="linenos">144</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="MultitaskClassifier-145"><a href="#MultitaskClassifier-145"><span class="linenos">145</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="MultitaskClassifier-146"><a href="#MultitaskClassifier-146"><span class="linenos">146</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="MultitaskClassifier-147"><a href="#MultitaskClassifier-147"><span class="linenos">147</span></a>    <span class="p">):</span>
</span><span id="MultitaskClassifier-148"><a href="#MultitaskClassifier-148"><span class="linenos">148</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="MultitaskClassifier-149"><a href="#MultitaskClassifier-149"><span class="linenos">149</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="MultitaskClassifier-150"><a href="#MultitaskClassifier-150"><span class="linenos">150</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="MultitaskClassifier-151"><a href="#MultitaskClassifier-151"><span class="linenos">151</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="MultitaskClassifier-152"><a href="#MultitaskClassifier-152"><span class="linenos">152</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="MultitaskClassifier-153"><a href="#MultitaskClassifier-153"><span class="linenos">153</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="MultitaskClassifier-154"><a href="#MultitaskClassifier-154"><span class="linenos">154</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="MultitaskClassifier-155"><a href="#MultitaskClassifier-155"><span class="linenos">155</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="MultitaskClassifier-156"><a href="#MultitaskClassifier-156"><span class="linenos">156</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="MultitaskClassifier-157"><a href="#MultitaskClassifier-157"><span class="linenos">157</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="MultitaskClassifier-158"><a href="#MultitaskClassifier-158"><span class="linenos">158</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="MultitaskClassifier-159"><a href="#MultitaskClassifier-159"><span class="linenos">159</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="MultitaskClassifier-160"><a href="#MultitaskClassifier-160"><span class="linenos">160</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="MultitaskClassifier-161"><a href="#MultitaskClassifier-161"><span class="linenos">161</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="MultitaskClassifier-162"><a href="#MultitaskClassifier-162"><span class="linenos">162</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="MultitaskClassifier-163"><a href="#MultitaskClassifier-163"><span class="linenos">163</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="MultitaskClassifier-164"><a href="#MultitaskClassifier-164"><span class="linenos">164</span></a>        <span class="p">)</span>
</span><span id="MultitaskClassifier-165"><a href="#MultitaskClassifier-165"><span class="linenos">165</span></a>
</span><span id="MultitaskClassifier-166"><a href="#MultitaskClassifier-166"><span class="linenos">166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_fit</span> <span class="o">=</span> <span class="s2">&quot;classification&quot;</span>
</span><span id="MultitaskClassifier-167"><a href="#MultitaskClassifier-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
</span><span id="MultitaskClassifier-168"><a href="#MultitaskClassifier-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MultitaskClassifier-169"><a href="#MultitaskClassifier-169"><span class="linenos">169</span></a>
</span><span id="MultitaskClassifier-170"><a href="#MultitaskClassifier-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MultitaskClassifier-171"><a href="#MultitaskClassifier-171"><span class="linenos">171</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit MultitaskClassifier to training data (X, y).</span>
</span><span id="MultitaskClassifier-172"><a href="#MultitaskClassifier-172"><span class="linenos">172</span></a>
</span><span id="MultitaskClassifier-173"><a href="#MultitaskClassifier-173"><span class="linenos">173</span></a><span class="sd">        Args:</span>
</span><span id="MultitaskClassifier-174"><a href="#MultitaskClassifier-174"><span class="linenos">174</span></a>
</span><span id="MultitaskClassifier-175"><a href="#MultitaskClassifier-175"><span class="linenos">175</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="MultitaskClassifier-176"><a href="#MultitaskClassifier-176"><span class="linenos">176</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="MultitaskClassifier-177"><a href="#MultitaskClassifier-177"><span class="linenos">177</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="MultitaskClassifier-178"><a href="#MultitaskClassifier-178"><span class="linenos">178</span></a>
</span><span id="MultitaskClassifier-179"><a href="#MultitaskClassifier-179"><span class="linenos">179</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="MultitaskClassifier-180"><a href="#MultitaskClassifier-180"><span class="linenos">180</span></a><span class="sd">                Target values.</span>
</span><span id="MultitaskClassifier-181"><a href="#MultitaskClassifier-181"><span class="linenos">181</span></a>
</span><span id="MultitaskClassifier-182"><a href="#MultitaskClassifier-182"><span class="linenos">182</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="MultitaskClassifier-183"><a href="#MultitaskClassifier-183"><span class="linenos">183</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="MultitaskClassifier-184"><a href="#MultitaskClassifier-184"><span class="linenos">184</span></a>
</span><span id="MultitaskClassifier-185"><a href="#MultitaskClassifier-185"><span class="linenos">185</span></a><span class="sd">        Returns:</span>
</span><span id="MultitaskClassifier-186"><a href="#MultitaskClassifier-186"><span class="linenos">186</span></a>
</span><span id="MultitaskClassifier-187"><a href="#MultitaskClassifier-187"><span class="linenos">187</span></a><span class="sd">            self: object</span>
</span><span id="MultitaskClassifier-188"><a href="#MultitaskClassifier-188"><span class="linenos">188</span></a>
</span><span id="MultitaskClassifier-189"><a href="#MultitaskClassifier-189"><span class="linenos">189</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MultitaskClassifier-190"><a href="#MultitaskClassifier-190"><span class="linenos">190</span></a>
</span><span id="MultitaskClassifier-191"><a href="#MultitaskClassifier-191"><span class="linenos">191</span></a>        <span class="k">assert</span> <span class="n">mx</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s2">&quot;y must contain only integers&quot;</span>
</span><span id="MultitaskClassifier-192"><a href="#MultitaskClassifier-192"><span class="linenos">192</span></a>
</span><span id="MultitaskClassifier-193"><a href="#MultitaskClassifier-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="MultitaskClassifier-194"><a href="#MultitaskClassifier-194"><span class="linenos">194</span></a>
</span><span id="MultitaskClassifier-195"><a href="#MultitaskClassifier-195"><span class="linenos">195</span></a>        <span class="n">output_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MultitaskClassifier-196"><a href="#MultitaskClassifier-196"><span class="linenos">196</span></a>
</span><span id="MultitaskClassifier-197"><a href="#MultitaskClassifier-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="MultitaskClassifier-198"><a href="#MultitaskClassifier-198"><span class="linenos">198</span></a>
</span><span id="MultitaskClassifier-199"><a href="#MultitaskClassifier-199"><span class="linenos">199</span></a>        <span class="c1"># multitask response</span>
</span><span id="MultitaskClassifier-200"><a href="#MultitaskClassifier-200"><span class="linenos">200</span></a>        <span class="n">Y</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">one_hot_encode2</span><span class="p">(</span><span class="n">output_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">)</span>
</span><span id="MultitaskClassifier-201"><a href="#MultitaskClassifier-201"><span class="linenos">201</span></a>
</span><span id="MultitaskClassifier-202"><a href="#MultitaskClassifier-202"><span class="linenos">202</span></a>        <span class="c1"># if sample_weight is None:</span>
</span><span id="MultitaskClassifier-203"><a href="#MultitaskClassifier-203"><span class="linenos">203</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">):</span>
</span><span id="MultitaskClassifier-204"><a href="#MultitaskClassifier-204"><span class="linenos">204</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
</span><span id="MultitaskClassifier-205"><a href="#MultitaskClassifier-205"><span class="linenos">205</span></a>                <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">Y</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="MultitaskClassifier-206"><a href="#MultitaskClassifier-206"><span class="linenos">206</span></a>            <span class="p">)</span>
</span><span id="MultitaskClassifier-207"><a href="#MultitaskClassifier-207"><span class="linenos">207</span></a>
</span><span id="MultitaskClassifier-208"><a href="#MultitaskClassifier-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="MultitaskClassifier-209"><a href="#MultitaskClassifier-209"><span class="linenos">209</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="MultitaskClassifier-210"><a href="#MultitaskClassifier-210"><span class="linenos">210</span></a>
</span><span id="MultitaskClassifier-211"><a href="#MultitaskClassifier-211"><span class="linenos">211</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MultitaskClassifier-212"><a href="#MultitaskClassifier-212"><span class="linenos">212</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="MultitaskClassifier-213"><a href="#MultitaskClassifier-213"><span class="linenos">213</span></a>
</span><span id="MultitaskClassifier-214"><a href="#MultitaskClassifier-214"><span class="linenos">214</span></a><span class="sd">        Args:</span>
</span><span id="MultitaskClassifier-215"><a href="#MultitaskClassifier-215"><span class="linenos">215</span></a>
</span><span id="MultitaskClassifier-216"><a href="#MultitaskClassifier-216"><span class="linenos">216</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="MultitaskClassifier-217"><a href="#MultitaskClassifier-217"><span class="linenos">217</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="MultitaskClassifier-218"><a href="#MultitaskClassifier-218"><span class="linenos">218</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="MultitaskClassifier-219"><a href="#MultitaskClassifier-219"><span class="linenos">219</span></a>
</span><span id="MultitaskClassifier-220"><a href="#MultitaskClassifier-220"><span class="linenos">220</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="MultitaskClassifier-221"><a href="#MultitaskClassifier-221"><span class="linenos">221</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="MultitaskClassifier-222"><a href="#MultitaskClassifier-222"><span class="linenos">222</span></a>
</span><span id="MultitaskClassifier-223"><a href="#MultitaskClassifier-223"><span class="linenos">223</span></a><span class="sd">        Returns:</span>
</span><span id="MultitaskClassifier-224"><a href="#MultitaskClassifier-224"><span class="linenos">224</span></a>
</span><span id="MultitaskClassifier-225"><a href="#MultitaskClassifier-225"><span class="linenos">225</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="MultitaskClassifier-226"><a href="#MultitaskClassifier-226"><span class="linenos">226</span></a>
</span><span id="MultitaskClassifier-227"><a href="#MultitaskClassifier-227"><span class="linenos">227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MultitaskClassifier-228"><a href="#MultitaskClassifier-228"><span class="linenos">228</span></a>
</span><span id="MultitaskClassifier-229"><a href="#MultitaskClassifier-229"><span class="linenos">229</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="MultitaskClassifier-230"><a href="#MultitaskClassifier-230"><span class="linenos">230</span></a>
</span><span id="MultitaskClassifier-231"><a href="#MultitaskClassifier-231"><span class="linenos">231</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MultitaskClassifier-232"><a href="#MultitaskClassifier-232"><span class="linenos">232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probabilities for test data X.</span>
</span><span id="MultitaskClassifier-233"><a href="#MultitaskClassifier-233"><span class="linenos">233</span></a>
</span><span id="MultitaskClassifier-234"><a href="#MultitaskClassifier-234"><span class="linenos">234</span></a><span class="sd">        Args:</span>
</span><span id="MultitaskClassifier-235"><a href="#MultitaskClassifier-235"><span class="linenos">235</span></a>
</span><span id="MultitaskClassifier-236"><a href="#MultitaskClassifier-236"><span class="linenos">236</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="MultitaskClassifier-237"><a href="#MultitaskClassifier-237"><span class="linenos">237</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="MultitaskClassifier-238"><a href="#MultitaskClassifier-238"><span class="linenos">238</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="MultitaskClassifier-239"><a href="#MultitaskClassifier-239"><span class="linenos">239</span></a>
</span><span id="MultitaskClassifier-240"><a href="#MultitaskClassifier-240"><span class="linenos">240</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="MultitaskClassifier-241"><a href="#MultitaskClassifier-241"><span class="linenos">241</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="MultitaskClassifier-242"><a href="#MultitaskClassifier-242"><span class="linenos">242</span></a>
</span><span id="MultitaskClassifier-243"><a href="#MultitaskClassifier-243"><span class="linenos">243</span></a><span class="sd">        Returns:</span>
</span><span id="MultitaskClassifier-244"><a href="#MultitaskClassifier-244"><span class="linenos">244</span></a>
</span><span id="MultitaskClassifier-245"><a href="#MultitaskClassifier-245"><span class="linenos">245</span></a><span class="sd">            probability estimates for test data: {array-like}</span>
</span><span id="MultitaskClassifier-246"><a href="#MultitaskClassifier-246"><span class="linenos">246</span></a>
</span><span id="MultitaskClassifier-247"><a href="#MultitaskClassifier-247"><span class="linenos">247</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MultitaskClassifier-248"><a href="#MultitaskClassifier-248"><span class="linenos">248</span></a>
</span><span id="MultitaskClassifier-249"><a href="#MultitaskClassifier-249"><span class="linenos">249</span></a>        <span class="n">shape_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="MultitaskClassifier-250"><a href="#MultitaskClassifier-250"><span class="linenos">250</span></a>
</span><span id="MultitaskClassifier-251"><a href="#MultitaskClassifier-251"><span class="linenos">251</span></a>        <span class="n">probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">shape_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">))</span>
</span><span id="MultitaskClassifier-252"><a href="#MultitaskClassifier-252"><span class="linenos">252</span></a>
</span><span id="MultitaskClassifier-253"><a href="#MultitaskClassifier-253"><span class="linenos">253</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape_X</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MultitaskClassifier-254"><a href="#MultitaskClassifier-254"><span class="linenos">254</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">shape_X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MultitaskClassifier-255"><a href="#MultitaskClassifier-255"><span class="linenos">255</span></a>
</span><span id="MultitaskClassifier-256"><a href="#MultitaskClassifier-256"><span class="linenos">256</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="MultitaskClassifier-257"><a href="#MultitaskClassifier-257"><span class="linenos">257</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="MultitaskClassifier-258"><a href="#MultitaskClassifier-258"><span class="linenos">258</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="MultitaskClassifier-259"><a href="#MultitaskClassifier-259"><span class="linenos">259</span></a>            <span class="p">)</span>
</span><span id="MultitaskClassifier-260"><a href="#MultitaskClassifier-260"><span class="linenos">260</span></a>
</span><span id="MultitaskClassifier-261"><a href="#MultitaskClassifier-261"><span class="linenos">261</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MultitaskClassifier-262"><a href="#MultitaskClassifier-262"><span class="linenos">262</span></a>
</span><span id="MultitaskClassifier-263"><a href="#MultitaskClassifier-263"><span class="linenos">263</span></a>            <span class="c1"># loop on all the classes</span>
</span><span id="MultitaskClassifier-264"><a href="#MultitaskClassifier-264"><span class="linenos">264</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">):</span>
</span><span id="MultitaskClassifier-265"><a href="#MultitaskClassifier-265"><span class="linenos">265</span></a>                <span class="n">probs</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MultitaskClassifier-266"><a href="#MultitaskClassifier-266"><span class="linenos">266</span></a>
</span><span id="MultitaskClassifier-267"><a href="#MultitaskClassifier-267"><span class="linenos">267</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MultitaskClassifier-268"><a href="#MultitaskClassifier-268"><span class="linenos">268</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MultitaskClassifier-269"><a href="#MultitaskClassifier-269"><span class="linenos">269</span></a>
</span><span id="MultitaskClassifier-270"><a href="#MultitaskClassifier-270"><span class="linenos">270</span></a>            <span class="c1"># loop on all the classes</span>
</span><span id="MultitaskClassifier-271"><a href="#MultitaskClassifier-271"><span class="linenos">271</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">):</span>
</span><span id="MultitaskClassifier-272"><a href="#MultitaskClassifier-272"><span class="linenos">272</span></a>                <span class="n">probs</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MultitaskClassifier-273"><a href="#MultitaskClassifier-273"><span class="linenos">273</span></a>
</span><span id="MultitaskClassifier-274"><a href="#MultitaskClassifier-274"><span class="linenos">274</span></a>        <span class="n">expit_raw_probs</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>
</span><span id="MultitaskClassifier-275"><a href="#MultitaskClassifier-275"><span class="linenos">275</span></a>
</span><span id="MultitaskClassifier-276"><a href="#MultitaskClassifier-276"><span class="linenos">276</span></a>        <span class="k">return</span> <span class="n">expit_raw_probs</span> <span class="o">/</span> <span class="n">expit_raw_probs</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Multitask Classification model based on regression models, with shared covariates</p>

<p>Parameters:</p>

<pre><code>obj: object
    any object (must be a regression model) containing a method fit (obj.fit())
    and a method predict (obj.predict())

n_hidden_features: int
    number of nodes in the hidden layer

activation_name: str
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'

a: float
    hyperparameter for 'prelu' or 'elu' activation function

nodes_sim: str
    type of simulation for the nodes: 'sobol', 'hammersley', 'halton',
    'uniform'

bias: boolean
    indicates if the hidden layer contains a bias term (True) or not
    (False)

dropout: float
    regularization parameter; (random) percentage of nodes dropped out
    of the training

direct_link: boolean
    indicates if the original predictors are included (True) in model's
    fitting or not (False)

n_clusters: int
    number of clusters for 'kmeans' or 'gmm' clustering (could be 0:
        no clustering)

cluster_encode: bool
    defines how the variable containing clusters is treated (default is one-hot)
    if `False`, then labels are used, without one-hot encoding

type_clust: str
    type of clustering method: currently k-means ('kmeans') or Gaussian
    Mixture Model ('gmm')

type_scaling: a tuple of 3 strings
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax')

col_sample: float
    percentage of covariates randomly chosen for training

row_sample: float
    percentage of rows chosen for training, by stratified bootstrapping

seed: int
    reproducibility seed for nodes_sim=='uniform'

backend: str
    "cpu" or "gpu" or "tpu"
</code></pre>

<p>Attributes:</p>

<pre><code>fit_objs_: dict
    objects adjusted to each individual time series

n_classes_: int
    number of classes for the classifier
</code></pre>

<p>Examples:</p>

<p>See also <a href="https://github.com/Techtonique/nnetsauce/blob/master/examples/mtask_classification.py">https://github.com/Techtonique/nnetsauce/blob/master/examples/mtask_classification.py</a></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>

<span class="n">breast_cancer</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">breast_cancer</span><span class="o">.</span><span class="n">data</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">breast_cancer</span><span class="o">.</span><span class="n">target</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                                                    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Linear Regression is used</span>
<span class="n">regr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">fit_obj</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">MultitaskClassifier</span><span class="p">(</span><span class="n">regr</span><span class="p">,</span> <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                            <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;gmm&quot;</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">fit_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Elapsed </span><span class="si">{</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fit_obj</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fit_obj</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;roc_auc&quot;</span><span class="p">))</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Elapsed </span><span class="si">{</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</code></pre>
</div>
</div>


                                <div id="MultitaskClassifier.fit" class="classattr">
                                            <input id="MultitaskClassifier.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MultitaskClassifier.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MultitaskClassifier.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MultitaskClassifier.fit-170"><a href="#MultitaskClassifier.fit-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MultitaskClassifier.fit-171"><a href="#MultitaskClassifier.fit-171"><span class="linenos">171</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit MultitaskClassifier to training data (X, y).</span>
</span><span id="MultitaskClassifier.fit-172"><a href="#MultitaskClassifier.fit-172"><span class="linenos">172</span></a>
</span><span id="MultitaskClassifier.fit-173"><a href="#MultitaskClassifier.fit-173"><span class="linenos">173</span></a><span class="sd">        Args:</span>
</span><span id="MultitaskClassifier.fit-174"><a href="#MultitaskClassifier.fit-174"><span class="linenos">174</span></a>
</span><span id="MultitaskClassifier.fit-175"><a href="#MultitaskClassifier.fit-175"><span class="linenos">175</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="MultitaskClassifier.fit-176"><a href="#MultitaskClassifier.fit-176"><span class="linenos">176</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="MultitaskClassifier.fit-177"><a href="#MultitaskClassifier.fit-177"><span class="linenos">177</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="MultitaskClassifier.fit-178"><a href="#MultitaskClassifier.fit-178"><span class="linenos">178</span></a>
</span><span id="MultitaskClassifier.fit-179"><a href="#MultitaskClassifier.fit-179"><span class="linenos">179</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="MultitaskClassifier.fit-180"><a href="#MultitaskClassifier.fit-180"><span class="linenos">180</span></a><span class="sd">                Target values.</span>
</span><span id="MultitaskClassifier.fit-181"><a href="#MultitaskClassifier.fit-181"><span class="linenos">181</span></a>
</span><span id="MultitaskClassifier.fit-182"><a href="#MultitaskClassifier.fit-182"><span class="linenos">182</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="MultitaskClassifier.fit-183"><a href="#MultitaskClassifier.fit-183"><span class="linenos">183</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="MultitaskClassifier.fit-184"><a href="#MultitaskClassifier.fit-184"><span class="linenos">184</span></a>
</span><span id="MultitaskClassifier.fit-185"><a href="#MultitaskClassifier.fit-185"><span class="linenos">185</span></a><span class="sd">        Returns:</span>
</span><span id="MultitaskClassifier.fit-186"><a href="#MultitaskClassifier.fit-186"><span class="linenos">186</span></a>
</span><span id="MultitaskClassifier.fit-187"><a href="#MultitaskClassifier.fit-187"><span class="linenos">187</span></a><span class="sd">            self: object</span>
</span><span id="MultitaskClassifier.fit-188"><a href="#MultitaskClassifier.fit-188"><span class="linenos">188</span></a>
</span><span id="MultitaskClassifier.fit-189"><a href="#MultitaskClassifier.fit-189"><span class="linenos">189</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MultitaskClassifier.fit-190"><a href="#MultitaskClassifier.fit-190"><span class="linenos">190</span></a>
</span><span id="MultitaskClassifier.fit-191"><a href="#MultitaskClassifier.fit-191"><span class="linenos">191</span></a>        <span class="k">assert</span> <span class="n">mx</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s2">&quot;y must contain only integers&quot;</span>
</span><span id="MultitaskClassifier.fit-192"><a href="#MultitaskClassifier.fit-192"><span class="linenos">192</span></a>
</span><span id="MultitaskClassifier.fit-193"><a href="#MultitaskClassifier.fit-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="MultitaskClassifier.fit-194"><a href="#MultitaskClassifier.fit-194"><span class="linenos">194</span></a>
</span><span id="MultitaskClassifier.fit-195"><a href="#MultitaskClassifier.fit-195"><span class="linenos">195</span></a>        <span class="n">output_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MultitaskClassifier.fit-196"><a href="#MultitaskClassifier.fit-196"><span class="linenos">196</span></a>
</span><span id="MultitaskClassifier.fit-197"><a href="#MultitaskClassifier.fit-197"><span class="linenos">197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="MultitaskClassifier.fit-198"><a href="#MultitaskClassifier.fit-198"><span class="linenos">198</span></a>
</span><span id="MultitaskClassifier.fit-199"><a href="#MultitaskClassifier.fit-199"><span class="linenos">199</span></a>        <span class="c1"># multitask response</span>
</span><span id="MultitaskClassifier.fit-200"><a href="#MultitaskClassifier.fit-200"><span class="linenos">200</span></a>        <span class="n">Y</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">one_hot_encode2</span><span class="p">(</span><span class="n">output_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">)</span>
</span><span id="MultitaskClassifier.fit-201"><a href="#MultitaskClassifier.fit-201"><span class="linenos">201</span></a>
</span><span id="MultitaskClassifier.fit-202"><a href="#MultitaskClassifier.fit-202"><span class="linenos">202</span></a>        <span class="c1"># if sample_weight is None:</span>
</span><span id="MultitaskClassifier.fit-203"><a href="#MultitaskClassifier.fit-203"><span class="linenos">203</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">):</span>
</span><span id="MultitaskClassifier.fit-204"><a href="#MultitaskClassifier.fit-204"><span class="linenos">204</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span>
</span><span id="MultitaskClassifier.fit-205"><a href="#MultitaskClassifier.fit-205"><span class="linenos">205</span></a>                <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">Y</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="MultitaskClassifier.fit-206"><a href="#MultitaskClassifier.fit-206"><span class="linenos">206</span></a>            <span class="p">)</span>
</span><span id="MultitaskClassifier.fit-207"><a href="#MultitaskClassifier.fit-207"><span class="linenos">207</span></a>
</span><span id="MultitaskClassifier.fit-208"><a href="#MultitaskClassifier.fit-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="MultitaskClassifier.fit-209"><a href="#MultitaskClassifier.fit-209"><span class="linenos">209</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit MultitaskClassifier to training data (X, y).</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

y: array-like, shape = [n_samples]
    Target values.

**kwargs: additional parameters to be passed to
        self.cook_training_set or self.obj.fit
</code></pre>

<p>Returns:</p>

<pre><code>self: object
</code></pre>
</div>


                                </div>
                                <div id="MultitaskClassifier.predict" class="classattr">
                                            <input id="MultitaskClassifier.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MultitaskClassifier.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MultitaskClassifier.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MultitaskClassifier.predict-211"><a href="#MultitaskClassifier.predict-211"><span class="linenos">211</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MultitaskClassifier.predict-212"><a href="#MultitaskClassifier.predict-212"><span class="linenos">212</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="MultitaskClassifier.predict-213"><a href="#MultitaskClassifier.predict-213"><span class="linenos">213</span></a>
</span><span id="MultitaskClassifier.predict-214"><a href="#MultitaskClassifier.predict-214"><span class="linenos">214</span></a><span class="sd">        Args:</span>
</span><span id="MultitaskClassifier.predict-215"><a href="#MultitaskClassifier.predict-215"><span class="linenos">215</span></a>
</span><span id="MultitaskClassifier.predict-216"><a href="#MultitaskClassifier.predict-216"><span class="linenos">216</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="MultitaskClassifier.predict-217"><a href="#MultitaskClassifier.predict-217"><span class="linenos">217</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="MultitaskClassifier.predict-218"><a href="#MultitaskClassifier.predict-218"><span class="linenos">218</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="MultitaskClassifier.predict-219"><a href="#MultitaskClassifier.predict-219"><span class="linenos">219</span></a>
</span><span id="MultitaskClassifier.predict-220"><a href="#MultitaskClassifier.predict-220"><span class="linenos">220</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="MultitaskClassifier.predict-221"><a href="#MultitaskClassifier.predict-221"><span class="linenos">221</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="MultitaskClassifier.predict-222"><a href="#MultitaskClassifier.predict-222"><span class="linenos">222</span></a>
</span><span id="MultitaskClassifier.predict-223"><a href="#MultitaskClassifier.predict-223"><span class="linenos">223</span></a><span class="sd">        Returns:</span>
</span><span id="MultitaskClassifier.predict-224"><a href="#MultitaskClassifier.predict-224"><span class="linenos">224</span></a>
</span><span id="MultitaskClassifier.predict-225"><a href="#MultitaskClassifier.predict-225"><span class="linenos">225</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="MultitaskClassifier.predict-226"><a href="#MultitaskClassifier.predict-226"><span class="linenos">226</span></a>
</span><span id="MultitaskClassifier.predict-227"><a href="#MultitaskClassifier.predict-227"><span class="linenos">227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MultitaskClassifier.predict-228"><a href="#MultitaskClassifier.predict-228"><span class="linenos">228</span></a>
</span><span id="MultitaskClassifier.predict-229"><a href="#MultitaskClassifier.predict-229"><span class="linenos">229</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>model predictions: {array-like}
</code></pre>
</div>


                                </div>
                                <div id="MultitaskClassifier.predict_proba" class="classattr">
                                            <input id="MultitaskClassifier.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MultitaskClassifier.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MultitaskClassifier.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MultitaskClassifier.predict_proba-231"><a href="#MultitaskClassifier.predict_proba-231"><span class="linenos">231</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MultitaskClassifier.predict_proba-232"><a href="#MultitaskClassifier.predict_proba-232"><span class="linenos">232</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probabilities for test data X.</span>
</span><span id="MultitaskClassifier.predict_proba-233"><a href="#MultitaskClassifier.predict_proba-233"><span class="linenos">233</span></a>
</span><span id="MultitaskClassifier.predict_proba-234"><a href="#MultitaskClassifier.predict_proba-234"><span class="linenos">234</span></a><span class="sd">        Args:</span>
</span><span id="MultitaskClassifier.predict_proba-235"><a href="#MultitaskClassifier.predict_proba-235"><span class="linenos">235</span></a>
</span><span id="MultitaskClassifier.predict_proba-236"><a href="#MultitaskClassifier.predict_proba-236"><span class="linenos">236</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="MultitaskClassifier.predict_proba-237"><a href="#MultitaskClassifier.predict_proba-237"><span class="linenos">237</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="MultitaskClassifier.predict_proba-238"><a href="#MultitaskClassifier.predict_proba-238"><span class="linenos">238</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="MultitaskClassifier.predict_proba-239"><a href="#MultitaskClassifier.predict_proba-239"><span class="linenos">239</span></a>
</span><span id="MultitaskClassifier.predict_proba-240"><a href="#MultitaskClassifier.predict_proba-240"><span class="linenos">240</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="MultitaskClassifier.predict_proba-241"><a href="#MultitaskClassifier.predict_proba-241"><span class="linenos">241</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="MultitaskClassifier.predict_proba-242"><a href="#MultitaskClassifier.predict_proba-242"><span class="linenos">242</span></a>
</span><span id="MultitaskClassifier.predict_proba-243"><a href="#MultitaskClassifier.predict_proba-243"><span class="linenos">243</span></a><span class="sd">        Returns:</span>
</span><span id="MultitaskClassifier.predict_proba-244"><a href="#MultitaskClassifier.predict_proba-244"><span class="linenos">244</span></a>
</span><span id="MultitaskClassifier.predict_proba-245"><a href="#MultitaskClassifier.predict_proba-245"><span class="linenos">245</span></a><span class="sd">            probability estimates for test data: {array-like}</span>
</span><span id="MultitaskClassifier.predict_proba-246"><a href="#MultitaskClassifier.predict_proba-246"><span class="linenos">246</span></a>
</span><span id="MultitaskClassifier.predict_proba-247"><a href="#MultitaskClassifier.predict_proba-247"><span class="linenos">247</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MultitaskClassifier.predict_proba-248"><a href="#MultitaskClassifier.predict_proba-248"><span class="linenos">248</span></a>
</span><span id="MultitaskClassifier.predict_proba-249"><a href="#MultitaskClassifier.predict_proba-249"><span class="linenos">249</span></a>        <span class="n">shape_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="MultitaskClassifier.predict_proba-250"><a href="#MultitaskClassifier.predict_proba-250"><span class="linenos">250</span></a>
</span><span id="MultitaskClassifier.predict_proba-251"><a href="#MultitaskClassifier.predict_proba-251"><span class="linenos">251</span></a>        <span class="n">probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">shape_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">))</span>
</span><span id="MultitaskClassifier.predict_proba-252"><a href="#MultitaskClassifier.predict_proba-252"><span class="linenos">252</span></a>
</span><span id="MultitaskClassifier.predict_proba-253"><a href="#MultitaskClassifier.predict_proba-253"><span class="linenos">253</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape_X</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="MultitaskClassifier.predict_proba-254"><a href="#MultitaskClassifier.predict_proba-254"><span class="linenos">254</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">shape_X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MultitaskClassifier.predict_proba-255"><a href="#MultitaskClassifier.predict_proba-255"><span class="linenos">255</span></a>
</span><span id="MultitaskClassifier.predict_proba-256"><a href="#MultitaskClassifier.predict_proba-256"><span class="linenos">256</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="MultitaskClassifier.predict_proba-257"><a href="#MultitaskClassifier.predict_proba-257"><span class="linenos">257</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="MultitaskClassifier.predict_proba-258"><a href="#MultitaskClassifier.predict_proba-258"><span class="linenos">258</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="MultitaskClassifier.predict_proba-259"><a href="#MultitaskClassifier.predict_proba-259"><span class="linenos">259</span></a>            <span class="p">)</span>
</span><span id="MultitaskClassifier.predict_proba-260"><a href="#MultitaskClassifier.predict_proba-260"><span class="linenos">260</span></a>
</span><span id="MultitaskClassifier.predict_proba-261"><a href="#MultitaskClassifier.predict_proba-261"><span class="linenos">261</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MultitaskClassifier.predict_proba-262"><a href="#MultitaskClassifier.predict_proba-262"><span class="linenos">262</span></a>
</span><span id="MultitaskClassifier.predict_proba-263"><a href="#MultitaskClassifier.predict_proba-263"><span class="linenos">263</span></a>            <span class="c1"># loop on all the classes</span>
</span><span id="MultitaskClassifier.predict_proba-264"><a href="#MultitaskClassifier.predict_proba-264"><span class="linenos">264</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">):</span>
</span><span id="MultitaskClassifier.predict_proba-265"><a href="#MultitaskClassifier.predict_proba-265"><span class="linenos">265</span></a>                <span class="n">probs</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MultitaskClassifier.predict_proba-266"><a href="#MultitaskClassifier.predict_proba-266"><span class="linenos">266</span></a>
</span><span id="MultitaskClassifier.predict_proba-267"><a href="#MultitaskClassifier.predict_proba-267"><span class="linenos">267</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MultitaskClassifier.predict_proba-268"><a href="#MultitaskClassifier.predict_proba-268"><span class="linenos">268</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MultitaskClassifier.predict_proba-269"><a href="#MultitaskClassifier.predict_proba-269"><span class="linenos">269</span></a>
</span><span id="MultitaskClassifier.predict_proba-270"><a href="#MultitaskClassifier.predict_proba-270"><span class="linenos">270</span></a>            <span class="c1"># loop on all the classes</span>
</span><span id="MultitaskClassifier.predict_proba-271"><a href="#MultitaskClassifier.predict_proba-271"><span class="linenos">271</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">):</span>
</span><span id="MultitaskClassifier.predict_proba-272"><a href="#MultitaskClassifier.predict_proba-272"><span class="linenos">272</span></a>                <span class="n">probs</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="MultitaskClassifier.predict_proba-273"><a href="#MultitaskClassifier.predict_proba-273"><span class="linenos">273</span></a>
</span><span id="MultitaskClassifier.predict_proba-274"><a href="#MultitaskClassifier.predict_proba-274"><span class="linenos">274</span></a>        <span class="n">expit_raw_probs</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>
</span><span id="MultitaskClassifier.predict_proba-275"><a href="#MultitaskClassifier.predict_proba-275"><span class="linenos">275</span></a>
</span><span id="MultitaskClassifier.predict_proba-276"><a href="#MultitaskClassifier.predict_proba-276"><span class="linenos">276</span></a>        <span class="k">return</span> <span class="n">expit_raw_probs</span> <span class="o">/</span> <span class="n">expit_raw_probs</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Predict probabilities for test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>probability estimates for test data: {array-like}
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="PredictionInterval">
                            <input id="PredictionInterval-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PredictionInterval</span><wbr>(<span class="base">sklearn.base.BaseEstimator</span>, <span class="base">sklearn.base.RegressorMixin</span>):

                <label class="view-source-button" for="PredictionInterval-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PredictionInterval"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PredictionInterval-20"><a href="#PredictionInterval-20"><span class="linenos"> 20</span></a><span class="k">class</span> <span class="nc">PredictionInterval</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">RegressorMixin</span><span class="p">):</span>
</span><span id="PredictionInterval-21"><a href="#PredictionInterval-21"><span class="linenos"> 21</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class PredictionInterval: Obtain prediction intervals.</span>
</span><span id="PredictionInterval-22"><a href="#PredictionInterval-22"><span class="linenos"> 22</span></a>
</span><span id="PredictionInterval-23"><a href="#PredictionInterval-23"><span class="linenos"> 23</span></a><span class="sd">    Attributes:</span>
</span><span id="PredictionInterval-24"><a href="#PredictionInterval-24"><span class="linenos"> 24</span></a>
</span><span id="PredictionInterval-25"><a href="#PredictionInterval-25"><span class="linenos"> 25</span></a><span class="sd">        obj: an object;</span>
</span><span id="PredictionInterval-26"><a href="#PredictionInterval-26"><span class="linenos"> 26</span></a><span class="sd">            fitted object containing methods `fit` and `predict`</span>
</span><span id="PredictionInterval-27"><a href="#PredictionInterval-27"><span class="linenos"> 27</span></a>
</span><span id="PredictionInterval-28"><a href="#PredictionInterval-28"><span class="linenos"> 28</span></a><span class="sd">        method: a string;</span>
</span><span id="PredictionInterval-29"><a href="#PredictionInterval-29"><span class="linenos"> 29</span></a><span class="sd">            method for constructing the prediction intervals.</span>
</span><span id="PredictionInterval-30"><a href="#PredictionInterval-30"><span class="linenos"> 30</span></a><span class="sd">            Currently &quot;splitconformal&quot; (default) and &quot;localconformal&quot;</span>
</span><span id="PredictionInterval-31"><a href="#PredictionInterval-31"><span class="linenos"> 31</span></a>
</span><span id="PredictionInterval-32"><a href="#PredictionInterval-32"><span class="linenos"> 32</span></a><span class="sd">        level: a float;</span>
</span><span id="PredictionInterval-33"><a href="#PredictionInterval-33"><span class="linenos"> 33</span></a><span class="sd">            Confidence level for prediction intervals. Default is 95,</span>
</span><span id="PredictionInterval-34"><a href="#PredictionInterval-34"><span class="linenos"> 34</span></a><span class="sd">            equivalent to a miscoverage error of 5 (%)</span>
</span><span id="PredictionInterval-35"><a href="#PredictionInterval-35"><span class="linenos"> 35</span></a>
</span><span id="PredictionInterval-36"><a href="#PredictionInterval-36"><span class="linenos"> 36</span></a><span class="sd">        replications: an integer;</span>
</span><span id="PredictionInterval-37"><a href="#PredictionInterval-37"><span class="linenos"> 37</span></a><span class="sd">            Number of replications for simulated conformal (default is `None`)</span>
</span><span id="PredictionInterval-38"><a href="#PredictionInterval-38"><span class="linenos"> 38</span></a>
</span><span id="PredictionInterval-39"><a href="#PredictionInterval-39"><span class="linenos"> 39</span></a><span class="sd">        type_pi: a string;</span>
</span><span id="PredictionInterval-40"><a href="#PredictionInterval-40"><span class="linenos"> 40</span></a><span class="sd">            type of prediction interval: currently &quot;kde&quot; (default) or &quot;bootstrap&quot;</span>
</span><span id="PredictionInterval-41"><a href="#PredictionInterval-41"><span class="linenos"> 41</span></a>
</span><span id="PredictionInterval-42"><a href="#PredictionInterval-42"><span class="linenos"> 42</span></a><span class="sd">        type_split: a string;</span>
</span><span id="PredictionInterval-43"><a href="#PredictionInterval-43"><span class="linenos"> 43</span></a><span class="sd">            &quot;random&quot; (random split of data) or &quot;sequential&quot; (sequential split of data)</span>
</span><span id="PredictionInterval-44"><a href="#PredictionInterval-44"><span class="linenos"> 44</span></a>
</span><span id="PredictionInterval-45"><a href="#PredictionInterval-45"><span class="linenos"> 45</span></a><span class="sd">        seed: an integer;</span>
</span><span id="PredictionInterval-46"><a href="#PredictionInterval-46"><span class="linenos"> 46</span></a><span class="sd">            Reproducibility of fit (there&#39;s a random split between fitting and calibration data)</span>
</span><span id="PredictionInterval-47"><a href="#PredictionInterval-47"><span class="linenos"> 47</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="PredictionInterval-48"><a href="#PredictionInterval-48"><span class="linenos"> 48</span></a>
</span><span id="PredictionInterval-49"><a href="#PredictionInterval-49"><span class="linenos"> 49</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="PredictionInterval-50"><a href="#PredictionInterval-50"><span class="linenos"> 50</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PredictionInterval-51"><a href="#PredictionInterval-51"><span class="linenos"> 51</span></a>        <span class="n">obj</span><span class="p">,</span>
</span><span id="PredictionInterval-52"><a href="#PredictionInterval-52"><span class="linenos"> 52</span></a>        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;splitconformal&quot;</span><span class="p">,</span>
</span><span id="PredictionInterval-53"><a href="#PredictionInterval-53"><span class="linenos"> 53</span></a>        <span class="n">level</span><span class="o">=</span><span class="mi">95</span><span class="p">,</span>
</span><span id="PredictionInterval-54"><a href="#PredictionInterval-54"><span class="linenos"> 54</span></a>        <span class="n">type_pi</span><span class="o">=</span><span class="s2">&quot;bootstrap&quot;</span><span class="p">,</span>
</span><span id="PredictionInterval-55"><a href="#PredictionInterval-55"><span class="linenos"> 55</span></a>        <span class="n">type_split</span><span class="o">=</span><span class="s2">&quot;random&quot;</span><span class="p">,</span>
</span><span id="PredictionInterval-56"><a href="#PredictionInterval-56"><span class="linenos"> 56</span></a>        <span class="n">replications</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="PredictionInterval-57"><a href="#PredictionInterval-57"><span class="linenos"> 57</span></a>        <span class="n">kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="PredictionInterval-58"><a href="#PredictionInterval-58"><span class="linenos"> 58</span></a>        <span class="n">agg</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
</span><span id="PredictionInterval-59"><a href="#PredictionInterval-59"><span class="linenos"> 59</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="PredictionInterval-60"><a href="#PredictionInterval-60"><span class="linenos"> 60</span></a>    <span class="p">):</span>
</span><span id="PredictionInterval-61"><a href="#PredictionInterval-61"><span class="linenos"> 61</span></a>
</span><span id="PredictionInterval-62"><a href="#PredictionInterval-62"><span class="linenos"> 62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
</span><span id="PredictionInterval-63"><a href="#PredictionInterval-63"><span class="linenos"> 63</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
</span><span id="PredictionInterval-64"><a href="#PredictionInterval-64"><span class="linenos"> 64</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">level</span>
</span><span id="PredictionInterval-65"><a href="#PredictionInterval-65"><span class="linenos"> 65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">=</span> <span class="n">type_pi</span>
</span><span id="PredictionInterval-66"><a href="#PredictionInterval-66"><span class="linenos"> 66</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_split</span> <span class="o">=</span> <span class="n">type_split</span>
</span><span id="PredictionInterval-67"><a href="#PredictionInterval-67"><span class="linenos"> 67</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="o">=</span> <span class="n">replications</span>
</span><span id="PredictionInterval-68"><a href="#PredictionInterval-68"><span class="linenos"> 68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="o">=</span> <span class="n">kernel</span>
</span><span id="PredictionInterval-69"><a href="#PredictionInterval-69"><span class="linenos"> 69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">agg</span> <span class="o">=</span> <span class="n">agg</span>
</span><span id="PredictionInterval-70"><a href="#PredictionInterval-70"><span class="linenos"> 70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
</span><span id="PredictionInterval-71"><a href="#PredictionInterval-71"><span class="linenos"> 71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">/</span> <span class="mi">100</span>
</span><span id="PredictionInterval-72"><a href="#PredictionInterval-72"><span class="linenos"> 72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">quantile_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PredictionInterval-73"><a href="#PredictionInterval-73"><span class="linenos"> 73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">icp_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PredictionInterval-74"><a href="#PredictionInterval-74"><span class="linenos"> 74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PredictionInterval-75"><a href="#PredictionInterval-75"><span class="linenos"> 75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_calibrated_residuals_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PredictionInterval-76"><a href="#PredictionInterval-76"><span class="linenos"> 76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PredictionInterval-77"><a href="#PredictionInterval-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PredictionInterval-78"><a href="#PredictionInterval-78"><span class="linenos"> 78</span></a>
</span><span id="PredictionInterval-79"><a href="#PredictionInterval-79"><span class="linenos"> 79</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="PredictionInterval-80"><a href="#PredictionInterval-80"><span class="linenos"> 80</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit the `method` to training data (X, y).</span>
</span><span id="PredictionInterval-81"><a href="#PredictionInterval-81"><span class="linenos"> 81</span></a>
</span><span id="PredictionInterval-82"><a href="#PredictionInterval-82"><span class="linenos"> 82</span></a><span class="sd">        Args:</span>
</span><span id="PredictionInterval-83"><a href="#PredictionInterval-83"><span class="linenos"> 83</span></a>
</span><span id="PredictionInterval-84"><a href="#PredictionInterval-84"><span class="linenos"> 84</span></a><span class="sd">            X: array-like, shape = [n_samples, n_features];</span>
</span><span id="PredictionInterval-85"><a href="#PredictionInterval-85"><span class="linenos"> 85</span></a><span class="sd">                Training set vectors, where n_samples is the number</span>
</span><span id="PredictionInterval-86"><a href="#PredictionInterval-86"><span class="linenos"> 86</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="PredictionInterval-87"><a href="#PredictionInterval-87"><span class="linenos"> 87</span></a>
</span><span id="PredictionInterval-88"><a href="#PredictionInterval-88"><span class="linenos"> 88</span></a><span class="sd">            y: array-like, shape = [n_samples, ]; Target values.</span>
</span><span id="PredictionInterval-89"><a href="#PredictionInterval-89"><span class="linenos"> 89</span></a>
</span><span id="PredictionInterval-90"><a href="#PredictionInterval-90"><span class="linenos"> 90</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PredictionInterval-91"><a href="#PredictionInterval-91"><span class="linenos"> 91</span></a>
</span><span id="PredictionInterval-92"><a href="#PredictionInterval-92"><span class="linenos"> 92</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_split</span> <span class="o">==</span> <span class="s2">&quot;random&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval-93"><a href="#PredictionInterval-93"><span class="linenos"> 93</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">X_calibration</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_calibration</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
</span><span id="PredictionInterval-94"><a href="#PredictionInterval-94"><span class="linenos"> 94</span></a>                <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span>
</span><span id="PredictionInterval-95"><a href="#PredictionInterval-95"><span class="linenos"> 95</span></a>            <span class="p">)</span>
</span><span id="PredictionInterval-96"><a href="#PredictionInterval-96"><span class="linenos"> 96</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_split</span> <span class="o">==</span> <span class="s2">&quot;sequential&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval-97"><a href="#PredictionInterval-97"><span class="linenos"> 97</span></a>            <span class="n">n_x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PredictionInterval-98"><a href="#PredictionInterval-98"><span class="linenos"> 98</span></a>            <span class="n">n_x_half</span> <span class="o">=</span> <span class="n">n_x</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="PredictionInterval-99"><a href="#PredictionInterval-99"><span class="linenos"> 99</span></a>            <span class="n">first_half_idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_x_half</span><span class="p">)</span>
</span><span id="PredictionInterval-100"><a href="#PredictionInterval-100"><span class="linenos">100</span></a>            <span class="n">second_half_idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_x_half</span><span class="p">,</span> <span class="n">n_x</span><span class="p">)</span>
</span><span id="PredictionInterval-101"><a href="#PredictionInterval-101"><span class="linenos">101</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">first_half_idx</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="PredictionInterval-102"><a href="#PredictionInterval-102"><span class="linenos">102</span></a>            <span class="n">X_calibration</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">second_half_idx</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="PredictionInterval-103"><a href="#PredictionInterval-103"><span class="linenos">103</span></a>            <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">first_half_idx</span><span class="p">]</span>
</span><span id="PredictionInterval-104"><a href="#PredictionInterval-104"><span class="linenos">104</span></a>            <span class="n">y_calibration</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">second_half_idx</span><span class="p">]</span>
</span><span id="PredictionInterval-105"><a href="#PredictionInterval-105"><span class="linenos">105</span></a>
</span><span id="PredictionInterval-106"><a href="#PredictionInterval-106"><span class="linenos">106</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;splitconformal&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval-107"><a href="#PredictionInterval-107"><span class="linenos">107</span></a>
</span><span id="PredictionInterval-108"><a href="#PredictionInterval-108"><span class="linenos">108</span></a>            <span class="n">n_samples_calibration</span> <span class="o">=</span> <span class="n">X_calibration</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PredictionInterval-109"><a href="#PredictionInterval-109"><span class="linenos">109</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="PredictionInterval-110"><a href="#PredictionInterval-110"><span class="linenos">110</span></a>            <span class="n">preds_calibration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_calibration</span><span class="p">)</span>
</span><span id="PredictionInterval-111"><a href="#PredictionInterval-111"><span class="linenos">111</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_</span> <span class="o">=</span> <span class="n">y_calibration</span> <span class="o">-</span> <span class="n">preds_calibration</span>
</span><span id="PredictionInterval-112"><a href="#PredictionInterval-112"><span class="linenos">112</span></a>            <span class="n">absolute_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_</span><span class="p">)</span>
</span><span id="PredictionInterval-113"><a href="#PredictionInterval-113"><span class="linenos">113</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">(</span>
</span><span id="PredictionInterval-114"><a href="#PredictionInterval-114"><span class="linenos">114</span></a>                <span class="n">with_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_std</span><span class="o">=</span><span class="kc">True</span>
</span><span id="PredictionInterval-115"><a href="#PredictionInterval-115"><span class="linenos">115</span></a>            <span class="p">)</span>
</span><span id="PredictionInterval-116"><a href="#PredictionInterval-116"><span class="linenos">116</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaled_calibrated_residuals_</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PredictionInterval-117"><a href="#PredictionInterval-117"><span class="linenos">117</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span>
</span><span id="PredictionInterval-118"><a href="#PredictionInterval-118"><span class="linenos">118</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="PredictionInterval-119"><a href="#PredictionInterval-119"><span class="linenos">119</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</span><span id="PredictionInterval-120"><a href="#PredictionInterval-120"><span class="linenos">120</span></a>            <span class="p">)</span>
</span><span id="PredictionInterval-121"><a href="#PredictionInterval-121"><span class="linenos">121</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PredictionInterval-122"><a href="#PredictionInterval-122"><span class="linenos">122</span></a>                <span class="c1"># numpy version &gt;= 1.22</span>
</span><span id="PredictionInterval-123"><a href="#PredictionInterval-123"><span class="linenos">123</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">quantile_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
</span><span id="PredictionInterval-124"><a href="#PredictionInterval-124"><span class="linenos">124</span></a>                    <span class="n">a</span><span class="o">=</span><span class="n">absolute_residuals</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;higher&quot;</span>
</span><span id="PredictionInterval-125"><a href="#PredictionInterval-125"><span class="linenos">125</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval-126"><a href="#PredictionInterval-126"><span class="linenos">126</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="PredictionInterval-127"><a href="#PredictionInterval-127"><span class="linenos">127</span></a>                <span class="c1"># numpy version &lt; 1.22</span>
</span><span id="PredictionInterval-128"><a href="#PredictionInterval-128"><span class="linenos">128</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">quantile_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
</span><span id="PredictionInterval-129"><a href="#PredictionInterval-129"><span class="linenos">129</span></a>                    <span class="n">a</span><span class="o">=</span><span class="n">absolute_residuals</span><span class="p">,</span>
</span><span id="PredictionInterval-130"><a href="#PredictionInterval-130"><span class="linenos">130</span></a>                    <span class="n">q</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="PredictionInterval-131"><a href="#PredictionInterval-131"><span class="linenos">131</span></a>                    <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;higher&quot;</span><span class="p">,</span>
</span><span id="PredictionInterval-132"><a href="#PredictionInterval-132"><span class="linenos">132</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval-133"><a href="#PredictionInterval-133"><span class="linenos">133</span></a>
</span><span id="PredictionInterval-134"><a href="#PredictionInterval-134"><span class="linenos">134</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;localconformal&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval-135"><a href="#PredictionInterval-135"><span class="linenos">135</span></a>
</span><span id="PredictionInterval-136"><a href="#PredictionInterval-136"><span class="linenos">136</span></a>            <span class="n">mad_estimator</span> <span class="o">=</span> <span class="n">ExtraTreesRegressor</span><span class="p">()</span>
</span><span id="PredictionInterval-137"><a href="#PredictionInterval-137"><span class="linenos">137</span></a>            <span class="n">normalizer</span> <span class="o">=</span> <span class="n">RegressorNormalizer</span><span class="p">(</span>
</span><span id="PredictionInterval-138"><a href="#PredictionInterval-138"><span class="linenos">138</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">mad_estimator</span><span class="p">,</span> <span class="n">AbsErrorErrFunc</span><span class="p">()</span>
</span><span id="PredictionInterval-139"><a href="#PredictionInterval-139"><span class="linenos">139</span></a>            <span class="p">)</span>
</span><span id="PredictionInterval-140"><a href="#PredictionInterval-140"><span class="linenos">140</span></a>            <span class="n">nc</span> <span class="o">=</span> <span class="n">RegressorNc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">AbsErrorErrFunc</span><span class="p">(),</span> <span class="n">normalizer</span><span class="p">)</span>
</span><span id="PredictionInterval-141"><a href="#PredictionInterval-141"><span class="linenos">141</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">icp_</span> <span class="o">=</span> <span class="n">IcpRegressor</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span>
</span><span id="PredictionInterval-142"><a href="#PredictionInterval-142"><span class="linenos">142</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">icp_</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="PredictionInterval-143"><a href="#PredictionInterval-143"><span class="linenos">143</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">icp_</span><span class="o">.</span><span class="n">calibrate</span><span class="p">(</span><span class="n">X_calibration</span><span class="p">,</span> <span class="n">y_calibration</span><span class="p">)</span>
</span><span id="PredictionInterval-144"><a href="#PredictionInterval-144"><span class="linenos">144</span></a>            <span class="n">preds_calibration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">icp_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_calibration</span><span class="p">)</span>
</span><span id="PredictionInterval-145"><a href="#PredictionInterval-145"><span class="linenos">145</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_</span> <span class="o">=</span> <span class="n">y_calibration</span> <span class="o">-</span> <span class="n">preds_calibration</span>
</span><span id="PredictionInterval-146"><a href="#PredictionInterval-146"><span class="linenos">146</span></a>            <span class="n">absolute_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_</span><span class="p">)</span>
</span><span id="PredictionInterval-147"><a href="#PredictionInterval-147"><span class="linenos">147</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">(</span>
</span><span id="PredictionInterval-148"><a href="#PredictionInterval-148"><span class="linenos">148</span></a>                <span class="n">with_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_std</span><span class="o">=</span><span class="kc">True</span>
</span><span id="PredictionInterval-149"><a href="#PredictionInterval-149"><span class="linenos">149</span></a>            <span class="p">)</span>
</span><span id="PredictionInterval-150"><a href="#PredictionInterval-150"><span class="linenos">150</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaled_calibrated_residuals_</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PredictionInterval-151"><a href="#PredictionInterval-151"><span class="linenos">151</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span>
</span><span id="PredictionInterval-152"><a href="#PredictionInterval-152"><span class="linenos">152</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="PredictionInterval-153"><a href="#PredictionInterval-153"><span class="linenos">153</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</span><span id="PredictionInterval-154"><a href="#PredictionInterval-154"><span class="linenos">154</span></a>            <span class="p">)</span>
</span><span id="PredictionInterval-155"><a href="#PredictionInterval-155"><span class="linenos">155</span></a>
</span><span id="PredictionInterval-156"><a href="#PredictionInterval-156"><span class="linenos">156</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="PredictionInterval-157"><a href="#PredictionInterval-157"><span class="linenos">157</span></a>
</span><span id="PredictionInterval-158"><a href="#PredictionInterval-158"><span class="linenos">158</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">return_pi</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="PredictionInterval-159"><a href="#PredictionInterval-159"><span class="linenos">159</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Obtain predictions and prediction intervals</span>
</span><span id="PredictionInterval-160"><a href="#PredictionInterval-160"><span class="linenos">160</span></a>
</span><span id="PredictionInterval-161"><a href="#PredictionInterval-161"><span class="linenos">161</span></a><span class="sd">        Args:</span>
</span><span id="PredictionInterval-162"><a href="#PredictionInterval-162"><span class="linenos">162</span></a>
</span><span id="PredictionInterval-163"><a href="#PredictionInterval-163"><span class="linenos">163</span></a><span class="sd">            X: array-like, shape = [n_samples, n_features];</span>
</span><span id="PredictionInterval-164"><a href="#PredictionInterval-164"><span class="linenos">164</span></a><span class="sd">                Testing set vectors, where n_samples is the number</span>
</span><span id="PredictionInterval-165"><a href="#PredictionInterval-165"><span class="linenos">165</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="PredictionInterval-166"><a href="#PredictionInterval-166"><span class="linenos">166</span></a>
</span><span id="PredictionInterval-167"><a href="#PredictionInterval-167"><span class="linenos">167</span></a><span class="sd">            return_pi: boolean</span>
</span><span id="PredictionInterval-168"><a href="#PredictionInterval-168"><span class="linenos">168</span></a><span class="sd">                Whether the prediction interval is returned or not.</span>
</span><span id="PredictionInterval-169"><a href="#PredictionInterval-169"><span class="linenos">169</span></a><span class="sd">                Default is False, for compatibility with other _estimators_.</span>
</span><span id="PredictionInterval-170"><a href="#PredictionInterval-170"><span class="linenos">170</span></a><span class="sd">                If True, a tuple containing the predictions + lower and upper</span>
</span><span id="PredictionInterval-171"><a href="#PredictionInterval-171"><span class="linenos">171</span></a><span class="sd">                bounds is returned.</span>
</span><span id="PredictionInterval-172"><a href="#PredictionInterval-172"><span class="linenos">172</span></a>
</span><span id="PredictionInterval-173"><a href="#PredictionInterval-173"><span class="linenos">173</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PredictionInterval-174"><a href="#PredictionInterval-174"><span class="linenos">174</span></a>
</span><span id="PredictionInterval-175"><a href="#PredictionInterval-175"><span class="linenos">175</span></a>        <span class="n">pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="PredictionInterval-176"><a href="#PredictionInterval-176"><span class="linenos">176</span></a>
</span><span id="PredictionInterval-177"><a href="#PredictionInterval-177"><span class="linenos">177</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;splitconformal&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval-178"><a href="#PredictionInterval-178"><span class="linenos">178</span></a>
</span><span id="PredictionInterval-179"><a href="#PredictionInterval-179"><span class="linenos">179</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PredictionInterval-180"><a href="#PredictionInterval-180"><span class="linenos">180</span></a>
</span><span id="PredictionInterval-181"><a href="#PredictionInterval-181"><span class="linenos">181</span></a>                <span class="k">if</span> <span class="n">return_pi</span><span class="p">:</span>
</span><span id="PredictionInterval-182"><a href="#PredictionInterval-182"><span class="linenos">182</span></a>
</span><span id="PredictionInterval-183"><a href="#PredictionInterval-183"><span class="linenos">183</span></a>                    <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="PredictionInterval-184"><a href="#PredictionInterval-184"><span class="linenos">184</span></a>                        <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="PredictionInterval-185"><a href="#PredictionInterval-185"><span class="linenos">185</span></a>                    <span class="p">)</span>
</span><span id="PredictionInterval-186"><a href="#PredictionInterval-186"><span class="linenos">186</span></a>
</span><span id="PredictionInterval-187"><a href="#PredictionInterval-187"><span class="linenos">187</span></a>                    <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span>
</span><span id="PredictionInterval-188"><a href="#PredictionInterval-188"><span class="linenos">188</span></a>                        <span class="n">pred</span><span class="p">,</span> <span class="n">pred</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantile_</span><span class="p">,</span> <span class="n">pred</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantile_</span>
</span><span id="PredictionInterval-189"><a href="#PredictionInterval-189"><span class="linenos">189</span></a>                    <span class="p">)</span>
</span><span id="PredictionInterval-190"><a href="#PredictionInterval-190"><span class="linenos">190</span></a>
</span><span id="PredictionInterval-191"><a href="#PredictionInterval-191"><span class="linenos">191</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PredictionInterval-192"><a href="#PredictionInterval-192"><span class="linenos">192</span></a>
</span><span id="PredictionInterval-193"><a href="#PredictionInterval-193"><span class="linenos">193</span></a>                    <span class="k">return</span> <span class="n">pred</span>
</span><span id="PredictionInterval-194"><a href="#PredictionInterval-194"><span class="linenos">194</span></a>
</span><span id="PredictionInterval-195"><a href="#PredictionInterval-195"><span class="linenos">195</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># if self.replications is not None</span>
</span><span id="PredictionInterval-196"><a href="#PredictionInterval-196"><span class="linenos">196</span></a>
</span><span id="PredictionInterval-197"><a href="#PredictionInterval-197"><span class="linenos">197</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="PredictionInterval-198"><a href="#PredictionInterval-198"><span class="linenos">198</span></a>                    <span class="s2">&quot;bootstrap&quot;</span><span class="p">,</span>
</span><span id="PredictionInterval-199"><a href="#PredictionInterval-199"><span class="linenos">199</span></a>                    <span class="s2">&quot;kde&quot;</span><span class="p">,</span>
</span><span id="PredictionInterval-200"><a href="#PredictionInterval-200"><span class="linenos">200</span></a>                <span class="p">),</span> <span class="s2">&quot;`self.type_pi` must be in (&#39;bootstrap&#39;, &#39;kde&#39;)&quot;</span>
</span><span id="PredictionInterval-201"><a href="#PredictionInterval-201"><span class="linenos">201</span></a>
</span><span id="PredictionInterval-202"><a href="#PredictionInterval-202"><span class="linenos">202</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">==</span> <span class="s2">&quot;bootstrap&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval-203"><a href="#PredictionInterval-203"><span class="linenos">203</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="PredictionInterval-204"><a href="#PredictionInterval-204"><span class="linenos">204</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
</span><span id="PredictionInterval-205"><a href="#PredictionInterval-205"><span class="linenos">205</span></a>                        <span class="p">[</span>
</span><span id="PredictionInterval-206"><a href="#PredictionInterval-206"><span class="linenos">206</span></a>                            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
</span><span id="PredictionInterval-207"><a href="#PredictionInterval-207"><span class="linenos">207</span></a>                                <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_calibrated_residuals_</span><span class="p">,</span>
</span><span id="PredictionInterval-208"><a href="#PredictionInterval-208"><span class="linenos">208</span></a>                                <span class="n">size</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="PredictionInterval-209"><a href="#PredictionInterval-209"><span class="linenos">209</span></a>                            <span class="p">)</span>
</span><span id="PredictionInterval-210"><a href="#PredictionInterval-210"><span class="linenos">210</span></a>                            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">)</span>
</span><span id="PredictionInterval-211"><a href="#PredictionInterval-211"><span class="linenos">211</span></a>                        <span class="p">]</span>
</span><span id="PredictionInterval-212"><a href="#PredictionInterval-212"><span class="linenos">212</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="PredictionInterval-213"><a href="#PredictionInterval-213"><span class="linenos">213</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
</span><span id="PredictionInterval-214"><a href="#PredictionInterval-214"><span class="linenos">214</span></a>                        <span class="p">[</span>
</span><span id="PredictionInterval-215"><a href="#PredictionInterval-215"><span class="linenos">215</span></a>                            <span class="n">pred</span>
</span><span id="PredictionInterval-216"><a href="#PredictionInterval-216"><span class="linenos">216</span></a>                            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span><span class="o">.</span><span class="n">scale_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PredictionInterval-217"><a href="#PredictionInterval-217"><span class="linenos">217</span></a>                            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</span><span id="PredictionInterval-218"><a href="#PredictionInterval-218"><span class="linenos">218</span></a>                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">)</span>
</span><span id="PredictionInterval-219"><a href="#PredictionInterval-219"><span class="linenos">219</span></a>                        <span class="p">]</span>
</span><span id="PredictionInterval-220"><a href="#PredictionInterval-220"><span class="linenos">220</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="PredictionInterval-221"><a href="#PredictionInterval-221"><span class="linenos">221</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">==</span> <span class="s2">&quot;kde&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval-222"><a href="#PredictionInterval-222"><span class="linenos">222</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span>
</span><span id="PredictionInterval-223"><a href="#PredictionInterval-223"><span class="linenos">223</span></a>                        <span class="n">dataset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_calibrated_residuals_</span>
</span><span id="PredictionInterval-224"><a href="#PredictionInterval-224"><span class="linenos">224</span></a>                    <span class="p">)</span>
</span><span id="PredictionInterval-225"><a href="#PredictionInterval-225"><span class="linenos">225</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
</span><span id="PredictionInterval-226"><a href="#PredictionInterval-226"><span class="linenos">226</span></a>                        <span class="p">[</span>
</span><span id="PredictionInterval-227"><a href="#PredictionInterval-227"><span class="linenos">227</span></a>                            <span class="n">pred</span>
</span><span id="PredictionInterval-228"><a href="#PredictionInterval-228"><span class="linenos">228</span></a>                            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span><span class="o">.</span><span class="n">scale_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PredictionInterval-229"><a href="#PredictionInterval-229"><span class="linenos">229</span></a>                            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span>
</span><span id="PredictionInterval-230"><a href="#PredictionInterval-230"><span class="linenos">230</span></a>                                <span class="n">size</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="n">i</span>
</span><span id="PredictionInterval-231"><a href="#PredictionInterval-231"><span class="linenos">231</span></a>                            <span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</span><span id="PredictionInterval-232"><a href="#PredictionInterval-232"><span class="linenos">232</span></a>                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">)</span>
</span><span id="PredictionInterval-233"><a href="#PredictionInterval-233"><span class="linenos">233</span></a>                        <span class="p">]</span>
</span><span id="PredictionInterval-234"><a href="#PredictionInterval-234"><span class="linenos">234</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="PredictionInterval-235"><a href="#PredictionInterval-235"><span class="linenos">235</span></a>
</span><span id="PredictionInterval-236"><a href="#PredictionInterval-236"><span class="linenos">236</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PredictionInterval-237"><a href="#PredictionInterval-237"><span class="linenos">237</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
</span><span id="PredictionInterval-238"><a href="#PredictionInterval-238"><span class="linenos">238</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">/</span> <span class="mi">200</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="PredictionInterval-239"><a href="#PredictionInterval-239"><span class="linenos">239</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval-240"><a href="#PredictionInterval-240"><span class="linenos">240</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
</span><span id="PredictionInterval-241"><a href="#PredictionInterval-241"><span class="linenos">241</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">/</span> <span class="mi">200</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="PredictionInterval-242"><a href="#PredictionInterval-242"><span class="linenos">242</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval-243"><a href="#PredictionInterval-243"><span class="linenos">243</span></a>
</span><span id="PredictionInterval-244"><a href="#PredictionInterval-244"><span class="linenos">244</span></a>                <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="PredictionInterval-245"><a href="#PredictionInterval-245"><span class="linenos">245</span></a>                    <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;sims&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="PredictionInterval-246"><a href="#PredictionInterval-246"><span class="linenos">246</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval-247"><a href="#PredictionInterval-247"><span class="linenos">247</span></a>
</span><span id="PredictionInterval-248"><a href="#PredictionInterval-248"><span class="linenos">248</span></a>                <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span>
</span><span id="PredictionInterval-249"><a href="#PredictionInterval-249"><span class="linenos">249</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span>
</span><span id="PredictionInterval-250"><a href="#PredictionInterval-250"><span class="linenos">250</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval-251"><a href="#PredictionInterval-251"><span class="linenos">251</span></a>
</span><span id="PredictionInterval-252"><a href="#PredictionInterval-252"><span class="linenos">252</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;localconformal&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval-253"><a href="#PredictionInterval-253"><span class="linenos">253</span></a>
</span><span id="PredictionInterval-254"><a href="#PredictionInterval-254"><span class="linenos">254</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PredictionInterval-255"><a href="#PredictionInterval-255"><span class="linenos">255</span></a>
</span><span id="PredictionInterval-256"><a href="#PredictionInterval-256"><span class="linenos">256</span></a>                <span class="k">if</span> <span class="n">return_pi</span><span class="p">:</span>
</span><span id="PredictionInterval-257"><a href="#PredictionInterval-257"><span class="linenos">257</span></a>
</span><span id="PredictionInterval-258"><a href="#PredictionInterval-258"><span class="linenos">258</span></a>                    <span class="n">predictions_bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">icp_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="PredictionInterval-259"><a href="#PredictionInterval-259"><span class="linenos">259</span></a>                        <span class="n">X</span><span class="p">,</span> <span class="n">significance</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span>
</span><span id="PredictionInterval-260"><a href="#PredictionInterval-260"><span class="linenos">260</span></a>                    <span class="p">)</span>
</span><span id="PredictionInterval-261"><a href="#PredictionInterval-261"><span class="linenos">261</span></a>                    <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="PredictionInterval-262"><a href="#PredictionInterval-262"><span class="linenos">262</span></a>                        <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="PredictionInterval-263"><a href="#PredictionInterval-263"><span class="linenos">263</span></a>                    <span class="p">)</span>
</span><span id="PredictionInterval-264"><a href="#PredictionInterval-264"><span class="linenos">264</span></a>                    <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span>
</span><span id="PredictionInterval-265"><a href="#PredictionInterval-265"><span class="linenos">265</span></a>                        <span class="n">pred</span><span class="p">,</span> <span class="n">predictions_bounds</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">predictions_bounds</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="PredictionInterval-266"><a href="#PredictionInterval-266"><span class="linenos">266</span></a>                    <span class="p">)</span>
</span><span id="PredictionInterval-267"><a href="#PredictionInterval-267"><span class="linenos">267</span></a>
</span><span id="PredictionInterval-268"><a href="#PredictionInterval-268"><span class="linenos">268</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PredictionInterval-269"><a href="#PredictionInterval-269"><span class="linenos">269</span></a>
</span><span id="PredictionInterval-270"><a href="#PredictionInterval-270"><span class="linenos">270</span></a>                    <span class="k">return</span> <span class="n">pred</span>
</span><span id="PredictionInterval-271"><a href="#PredictionInterval-271"><span class="linenos">271</span></a>
</span><span id="PredictionInterval-272"><a href="#PredictionInterval-272"><span class="linenos">272</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># if self.replications is not None</span>
</span><span id="PredictionInterval-273"><a href="#PredictionInterval-273"><span class="linenos">273</span></a>
</span><span id="PredictionInterval-274"><a href="#PredictionInterval-274"><span class="linenos">274</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="PredictionInterval-275"><a href="#PredictionInterval-275"><span class="linenos">275</span></a>                    <span class="s2">&quot;bootstrap&quot;</span><span class="p">,</span>
</span><span id="PredictionInterval-276"><a href="#PredictionInterval-276"><span class="linenos">276</span></a>                    <span class="s2">&quot;kde&quot;</span><span class="p">,</span>
</span><span id="PredictionInterval-277"><a href="#PredictionInterval-277"><span class="linenos">277</span></a>                <span class="p">),</span> <span class="s2">&quot;`self.type_pi` must be in (&#39;bootstrap&#39;, &#39;kde&#39;)&quot;</span>
</span><span id="PredictionInterval-278"><a href="#PredictionInterval-278"><span class="linenos">278</span></a>
</span><span id="PredictionInterval-279"><a href="#PredictionInterval-279"><span class="linenos">279</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">==</span> <span class="s2">&quot;bootstrap&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval-280"><a href="#PredictionInterval-280"><span class="linenos">280</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="PredictionInterval-281"><a href="#PredictionInterval-281"><span class="linenos">281</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
</span><span id="PredictionInterval-282"><a href="#PredictionInterval-282"><span class="linenos">282</span></a>                        <span class="p">[</span>
</span><span id="PredictionInterval-283"><a href="#PredictionInterval-283"><span class="linenos">283</span></a>                            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
</span><span id="PredictionInterval-284"><a href="#PredictionInterval-284"><span class="linenos">284</span></a>                                <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_calibrated_residuals_</span><span class="p">,</span>
</span><span id="PredictionInterval-285"><a href="#PredictionInterval-285"><span class="linenos">285</span></a>                                <span class="n">size</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="PredictionInterval-286"><a href="#PredictionInterval-286"><span class="linenos">286</span></a>                            <span class="p">)</span>
</span><span id="PredictionInterval-287"><a href="#PredictionInterval-287"><span class="linenos">287</span></a>                            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">)</span>
</span><span id="PredictionInterval-288"><a href="#PredictionInterval-288"><span class="linenos">288</span></a>                        <span class="p">]</span>
</span><span id="PredictionInterval-289"><a href="#PredictionInterval-289"><span class="linenos">289</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="PredictionInterval-290"><a href="#PredictionInterval-290"><span class="linenos">290</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
</span><span id="PredictionInterval-291"><a href="#PredictionInterval-291"><span class="linenos">291</span></a>                        <span class="p">[</span>
</span><span id="PredictionInterval-292"><a href="#PredictionInterval-292"><span class="linenos">292</span></a>                            <span class="n">pred</span>
</span><span id="PredictionInterval-293"><a href="#PredictionInterval-293"><span class="linenos">293</span></a>                            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span><span class="o">.</span><span class="n">scale_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PredictionInterval-294"><a href="#PredictionInterval-294"><span class="linenos">294</span></a>                            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</span><span id="PredictionInterval-295"><a href="#PredictionInterval-295"><span class="linenos">295</span></a>                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">))</span>
</span><span id="PredictionInterval-296"><a href="#PredictionInterval-296"><span class="linenos">296</span></a>                        <span class="p">]</span>
</span><span id="PredictionInterval-297"><a href="#PredictionInterval-297"><span class="linenos">297</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="PredictionInterval-298"><a href="#PredictionInterval-298"><span class="linenos">298</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">==</span> <span class="s2">&quot;kde&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval-299"><a href="#PredictionInterval-299"><span class="linenos">299</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span>
</span><span id="PredictionInterval-300"><a href="#PredictionInterval-300"><span class="linenos">300</span></a>                        <span class="n">dataset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_calibrated_residuals_</span>
</span><span id="PredictionInterval-301"><a href="#PredictionInterval-301"><span class="linenos">301</span></a>                    <span class="p">)</span>
</span><span id="PredictionInterval-302"><a href="#PredictionInterval-302"><span class="linenos">302</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
</span><span id="PredictionInterval-303"><a href="#PredictionInterval-303"><span class="linenos">303</span></a>                        <span class="p">[</span>
</span><span id="PredictionInterval-304"><a href="#PredictionInterval-304"><span class="linenos">304</span></a>                            <span class="n">pred</span>
</span><span id="PredictionInterval-305"><a href="#PredictionInterval-305"><span class="linenos">305</span></a>                            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span><span class="o">.</span><span class="n">scale_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PredictionInterval-306"><a href="#PredictionInterval-306"><span class="linenos">306</span></a>                            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span>
</span><span id="PredictionInterval-307"><a href="#PredictionInterval-307"><span class="linenos">307</span></a>                                <span class="n">size</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="n">i</span>
</span><span id="PredictionInterval-308"><a href="#PredictionInterval-308"><span class="linenos">308</span></a>                            <span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</span><span id="PredictionInterval-309"><a href="#PredictionInterval-309"><span class="linenos">309</span></a>                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">))</span>
</span><span id="PredictionInterval-310"><a href="#PredictionInterval-310"><span class="linenos">310</span></a>                        <span class="p">]</span>
</span><span id="PredictionInterval-311"><a href="#PredictionInterval-311"><span class="linenos">311</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="PredictionInterval-312"><a href="#PredictionInterval-312"><span class="linenos">312</span></a>
</span><span id="PredictionInterval-313"><a href="#PredictionInterval-313"><span class="linenos">313</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PredictionInterval-314"><a href="#PredictionInterval-314"><span class="linenos">314</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
</span><span id="PredictionInterval-315"><a href="#PredictionInterval-315"><span class="linenos">315</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">/</span> <span class="mi">200</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="PredictionInterval-316"><a href="#PredictionInterval-316"><span class="linenos">316</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval-317"><a href="#PredictionInterval-317"><span class="linenos">317</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
</span><span id="PredictionInterval-318"><a href="#PredictionInterval-318"><span class="linenos">318</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">/</span> <span class="mi">200</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="PredictionInterval-319"><a href="#PredictionInterval-319"><span class="linenos">319</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval-320"><a href="#PredictionInterval-320"><span class="linenos">320</span></a>
</span><span id="PredictionInterval-321"><a href="#PredictionInterval-321"><span class="linenos">321</span></a>                <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="PredictionInterval-322"><a href="#PredictionInterval-322"><span class="linenos">322</span></a>                    <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;sims&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="PredictionInterval-323"><a href="#PredictionInterval-323"><span class="linenos">323</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval-324"><a href="#PredictionInterval-324"><span class="linenos">324</span></a>
</span><span id="PredictionInterval-325"><a href="#PredictionInterval-325"><span class="linenos">325</span></a>                <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span>
</span><span id="PredictionInterval-326"><a href="#PredictionInterval-326"><span class="linenos">326</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span>
</span><span id="PredictionInterval-327"><a href="#PredictionInterval-327"><span class="linenos">327</span></a>                <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Class PredictionInterval: Obtain prediction intervals.</p>

<p>Attributes:</p>

<pre><code>obj: an object;
    fitted object containing methods `fit` and `predict`

method: a string;
    method for constructing the prediction intervals.
    Currently "splitconformal" (default) and "localconformal"

level: a float;
    Confidence level for prediction intervals. Default is 95,
    equivalent to a miscoverage error of 5 (%)

replications: an integer;
    Number of replications for simulated conformal (default is `None`)

type_pi: a string;
    type of prediction interval: currently "kde" (default) or "bootstrap"

type_split: a string;
    "random" (random split of data) or "sequential" (sequential split of data)

seed: an integer;
    Reproducibility of fit (there's a random split between fitting and calibration data)
</code></pre>
</div>


                                <div id="PredictionInterval.fit" class="classattr">
                                            <input id="PredictionInterval.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PredictionInterval.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PredictionInterval.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PredictionInterval.fit-79"><a href="#PredictionInterval.fit-79"><span class="linenos"> 79</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="PredictionInterval.fit-80"><a href="#PredictionInterval.fit-80"><span class="linenos"> 80</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit the `method` to training data (X, y).</span>
</span><span id="PredictionInterval.fit-81"><a href="#PredictionInterval.fit-81"><span class="linenos"> 81</span></a>
</span><span id="PredictionInterval.fit-82"><a href="#PredictionInterval.fit-82"><span class="linenos"> 82</span></a><span class="sd">        Args:</span>
</span><span id="PredictionInterval.fit-83"><a href="#PredictionInterval.fit-83"><span class="linenos"> 83</span></a>
</span><span id="PredictionInterval.fit-84"><a href="#PredictionInterval.fit-84"><span class="linenos"> 84</span></a><span class="sd">            X: array-like, shape = [n_samples, n_features];</span>
</span><span id="PredictionInterval.fit-85"><a href="#PredictionInterval.fit-85"><span class="linenos"> 85</span></a><span class="sd">                Training set vectors, where n_samples is the number</span>
</span><span id="PredictionInterval.fit-86"><a href="#PredictionInterval.fit-86"><span class="linenos"> 86</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="PredictionInterval.fit-87"><a href="#PredictionInterval.fit-87"><span class="linenos"> 87</span></a>
</span><span id="PredictionInterval.fit-88"><a href="#PredictionInterval.fit-88"><span class="linenos"> 88</span></a><span class="sd">            y: array-like, shape = [n_samples, ]; Target values.</span>
</span><span id="PredictionInterval.fit-89"><a href="#PredictionInterval.fit-89"><span class="linenos"> 89</span></a>
</span><span id="PredictionInterval.fit-90"><a href="#PredictionInterval.fit-90"><span class="linenos"> 90</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PredictionInterval.fit-91"><a href="#PredictionInterval.fit-91"><span class="linenos"> 91</span></a>
</span><span id="PredictionInterval.fit-92"><a href="#PredictionInterval.fit-92"><span class="linenos"> 92</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_split</span> <span class="o">==</span> <span class="s2">&quot;random&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval.fit-93"><a href="#PredictionInterval.fit-93"><span class="linenos"> 93</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">X_calibration</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_calibration</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
</span><span id="PredictionInterval.fit-94"><a href="#PredictionInterval.fit-94"><span class="linenos"> 94</span></a>                <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span>
</span><span id="PredictionInterval.fit-95"><a href="#PredictionInterval.fit-95"><span class="linenos"> 95</span></a>            <span class="p">)</span>
</span><span id="PredictionInterval.fit-96"><a href="#PredictionInterval.fit-96"><span class="linenos"> 96</span></a>        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_split</span> <span class="o">==</span> <span class="s2">&quot;sequential&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval.fit-97"><a href="#PredictionInterval.fit-97"><span class="linenos"> 97</span></a>            <span class="n">n_x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PredictionInterval.fit-98"><a href="#PredictionInterval.fit-98"><span class="linenos"> 98</span></a>            <span class="n">n_x_half</span> <span class="o">=</span> <span class="n">n_x</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="PredictionInterval.fit-99"><a href="#PredictionInterval.fit-99"><span class="linenos"> 99</span></a>            <span class="n">first_half_idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_x_half</span><span class="p">)</span>
</span><span id="PredictionInterval.fit-100"><a href="#PredictionInterval.fit-100"><span class="linenos">100</span></a>            <span class="n">second_half_idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_x_half</span><span class="p">,</span> <span class="n">n_x</span><span class="p">)</span>
</span><span id="PredictionInterval.fit-101"><a href="#PredictionInterval.fit-101"><span class="linenos">101</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">first_half_idx</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="PredictionInterval.fit-102"><a href="#PredictionInterval.fit-102"><span class="linenos">102</span></a>            <span class="n">X_calibration</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">second_half_idx</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="PredictionInterval.fit-103"><a href="#PredictionInterval.fit-103"><span class="linenos">103</span></a>            <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">first_half_idx</span><span class="p">]</span>
</span><span id="PredictionInterval.fit-104"><a href="#PredictionInterval.fit-104"><span class="linenos">104</span></a>            <span class="n">y_calibration</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">second_half_idx</span><span class="p">]</span>
</span><span id="PredictionInterval.fit-105"><a href="#PredictionInterval.fit-105"><span class="linenos">105</span></a>
</span><span id="PredictionInterval.fit-106"><a href="#PredictionInterval.fit-106"><span class="linenos">106</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;splitconformal&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval.fit-107"><a href="#PredictionInterval.fit-107"><span class="linenos">107</span></a>
</span><span id="PredictionInterval.fit-108"><a href="#PredictionInterval.fit-108"><span class="linenos">108</span></a>            <span class="n">n_samples_calibration</span> <span class="o">=</span> <span class="n">X_calibration</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PredictionInterval.fit-109"><a href="#PredictionInterval.fit-109"><span class="linenos">109</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="PredictionInterval.fit-110"><a href="#PredictionInterval.fit-110"><span class="linenos">110</span></a>            <span class="n">preds_calibration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_calibration</span><span class="p">)</span>
</span><span id="PredictionInterval.fit-111"><a href="#PredictionInterval.fit-111"><span class="linenos">111</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_</span> <span class="o">=</span> <span class="n">y_calibration</span> <span class="o">-</span> <span class="n">preds_calibration</span>
</span><span id="PredictionInterval.fit-112"><a href="#PredictionInterval.fit-112"><span class="linenos">112</span></a>            <span class="n">absolute_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_</span><span class="p">)</span>
</span><span id="PredictionInterval.fit-113"><a href="#PredictionInterval.fit-113"><span class="linenos">113</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">(</span>
</span><span id="PredictionInterval.fit-114"><a href="#PredictionInterval.fit-114"><span class="linenos">114</span></a>                <span class="n">with_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_std</span><span class="o">=</span><span class="kc">True</span>
</span><span id="PredictionInterval.fit-115"><a href="#PredictionInterval.fit-115"><span class="linenos">115</span></a>            <span class="p">)</span>
</span><span id="PredictionInterval.fit-116"><a href="#PredictionInterval.fit-116"><span class="linenos">116</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaled_calibrated_residuals_</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PredictionInterval.fit-117"><a href="#PredictionInterval.fit-117"><span class="linenos">117</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span>
</span><span id="PredictionInterval.fit-118"><a href="#PredictionInterval.fit-118"><span class="linenos">118</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="PredictionInterval.fit-119"><a href="#PredictionInterval.fit-119"><span class="linenos">119</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</span><span id="PredictionInterval.fit-120"><a href="#PredictionInterval.fit-120"><span class="linenos">120</span></a>            <span class="p">)</span>
</span><span id="PredictionInterval.fit-121"><a href="#PredictionInterval.fit-121"><span class="linenos">121</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PredictionInterval.fit-122"><a href="#PredictionInterval.fit-122"><span class="linenos">122</span></a>                <span class="c1"># numpy version &gt;= 1.22</span>
</span><span id="PredictionInterval.fit-123"><a href="#PredictionInterval.fit-123"><span class="linenos">123</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">quantile_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
</span><span id="PredictionInterval.fit-124"><a href="#PredictionInterval.fit-124"><span class="linenos">124</span></a>                    <span class="n">a</span><span class="o">=</span><span class="n">absolute_residuals</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;higher&quot;</span>
</span><span id="PredictionInterval.fit-125"><a href="#PredictionInterval.fit-125"><span class="linenos">125</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval.fit-126"><a href="#PredictionInterval.fit-126"><span class="linenos">126</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="PredictionInterval.fit-127"><a href="#PredictionInterval.fit-127"><span class="linenos">127</span></a>                <span class="c1"># numpy version &lt; 1.22</span>
</span><span id="PredictionInterval.fit-128"><a href="#PredictionInterval.fit-128"><span class="linenos">128</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">quantile_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
</span><span id="PredictionInterval.fit-129"><a href="#PredictionInterval.fit-129"><span class="linenos">129</span></a>                    <span class="n">a</span><span class="o">=</span><span class="n">absolute_residuals</span><span class="p">,</span>
</span><span id="PredictionInterval.fit-130"><a href="#PredictionInterval.fit-130"><span class="linenos">130</span></a>                    <span class="n">q</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">/</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="PredictionInterval.fit-131"><a href="#PredictionInterval.fit-131"><span class="linenos">131</span></a>                    <span class="n">interpolation</span><span class="o">=</span><span class="s2">&quot;higher&quot;</span><span class="p">,</span>
</span><span id="PredictionInterval.fit-132"><a href="#PredictionInterval.fit-132"><span class="linenos">132</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval.fit-133"><a href="#PredictionInterval.fit-133"><span class="linenos">133</span></a>
</span><span id="PredictionInterval.fit-134"><a href="#PredictionInterval.fit-134"><span class="linenos">134</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;localconformal&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval.fit-135"><a href="#PredictionInterval.fit-135"><span class="linenos">135</span></a>
</span><span id="PredictionInterval.fit-136"><a href="#PredictionInterval.fit-136"><span class="linenos">136</span></a>            <span class="n">mad_estimator</span> <span class="o">=</span> <span class="n">ExtraTreesRegressor</span><span class="p">()</span>
</span><span id="PredictionInterval.fit-137"><a href="#PredictionInterval.fit-137"><span class="linenos">137</span></a>            <span class="n">normalizer</span> <span class="o">=</span> <span class="n">RegressorNormalizer</span><span class="p">(</span>
</span><span id="PredictionInterval.fit-138"><a href="#PredictionInterval.fit-138"><span class="linenos">138</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">mad_estimator</span><span class="p">,</span> <span class="n">AbsErrorErrFunc</span><span class="p">()</span>
</span><span id="PredictionInterval.fit-139"><a href="#PredictionInterval.fit-139"><span class="linenos">139</span></a>            <span class="p">)</span>
</span><span id="PredictionInterval.fit-140"><a href="#PredictionInterval.fit-140"><span class="linenos">140</span></a>            <span class="n">nc</span> <span class="o">=</span> <span class="n">RegressorNc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">AbsErrorErrFunc</span><span class="p">(),</span> <span class="n">normalizer</span><span class="p">)</span>
</span><span id="PredictionInterval.fit-141"><a href="#PredictionInterval.fit-141"><span class="linenos">141</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">icp_</span> <span class="o">=</span> <span class="n">IcpRegressor</span><span class="p">(</span><span class="n">nc</span><span class="p">)</span>
</span><span id="PredictionInterval.fit-142"><a href="#PredictionInterval.fit-142"><span class="linenos">142</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">icp_</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="PredictionInterval.fit-143"><a href="#PredictionInterval.fit-143"><span class="linenos">143</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">icp_</span><span class="o">.</span><span class="n">calibrate</span><span class="p">(</span><span class="n">X_calibration</span><span class="p">,</span> <span class="n">y_calibration</span><span class="p">)</span>
</span><span id="PredictionInterval.fit-144"><a href="#PredictionInterval.fit-144"><span class="linenos">144</span></a>            <span class="n">preds_calibration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">icp_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_calibration</span><span class="p">)</span>
</span><span id="PredictionInterval.fit-145"><a href="#PredictionInterval.fit-145"><span class="linenos">145</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_</span> <span class="o">=</span> <span class="n">y_calibration</span> <span class="o">-</span> <span class="n">preds_calibration</span>
</span><span id="PredictionInterval.fit-146"><a href="#PredictionInterval.fit-146"><span class="linenos">146</span></a>            <span class="n">absolute_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_</span><span class="p">)</span>
</span><span id="PredictionInterval.fit-147"><a href="#PredictionInterval.fit-147"><span class="linenos">147</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">(</span>
</span><span id="PredictionInterval.fit-148"><a href="#PredictionInterval.fit-148"><span class="linenos">148</span></a>                <span class="n">with_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_std</span><span class="o">=</span><span class="kc">True</span>
</span><span id="PredictionInterval.fit-149"><a href="#PredictionInterval.fit-149"><span class="linenos">149</span></a>            <span class="p">)</span>
</span><span id="PredictionInterval.fit-150"><a href="#PredictionInterval.fit-150"><span class="linenos">150</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scaled_calibrated_residuals_</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PredictionInterval.fit-151"><a href="#PredictionInterval.fit-151"><span class="linenos">151</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span>
</span><span id="PredictionInterval.fit-152"><a href="#PredictionInterval.fit-152"><span class="linenos">152</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="PredictionInterval.fit-153"><a href="#PredictionInterval.fit-153"><span class="linenos">153</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</span><span id="PredictionInterval.fit-154"><a href="#PredictionInterval.fit-154"><span class="linenos">154</span></a>            <span class="p">)</span>
</span><span id="PredictionInterval.fit-155"><a href="#PredictionInterval.fit-155"><span class="linenos">155</span></a>
</span><span id="PredictionInterval.fit-156"><a href="#PredictionInterval.fit-156"><span class="linenos">156</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit the <code><a href="#PredictionInterval.method">method</a></code> to training data (X, y).</p>

<p>Args:</p>

<pre><code>X: array-like, shape = [n_samples, n_features];
    Training set vectors, where n_samples is the number
    of samples and n_features is the number of features.

y: array-like, shape = [n_samples, ]; Target values.
</code></pre>
</div>


                                </div>
                                <div id="PredictionInterval.predict" class="classattr">
                                            <input id="PredictionInterval.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">return_pi</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PredictionInterval.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PredictionInterval.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PredictionInterval.predict-158"><a href="#PredictionInterval.predict-158"><span class="linenos">158</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">return_pi</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="PredictionInterval.predict-159"><a href="#PredictionInterval.predict-159"><span class="linenos">159</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Obtain predictions and prediction intervals</span>
</span><span id="PredictionInterval.predict-160"><a href="#PredictionInterval.predict-160"><span class="linenos">160</span></a>
</span><span id="PredictionInterval.predict-161"><a href="#PredictionInterval.predict-161"><span class="linenos">161</span></a><span class="sd">        Args:</span>
</span><span id="PredictionInterval.predict-162"><a href="#PredictionInterval.predict-162"><span class="linenos">162</span></a>
</span><span id="PredictionInterval.predict-163"><a href="#PredictionInterval.predict-163"><span class="linenos">163</span></a><span class="sd">            X: array-like, shape = [n_samples, n_features];</span>
</span><span id="PredictionInterval.predict-164"><a href="#PredictionInterval.predict-164"><span class="linenos">164</span></a><span class="sd">                Testing set vectors, where n_samples is the number</span>
</span><span id="PredictionInterval.predict-165"><a href="#PredictionInterval.predict-165"><span class="linenos">165</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="PredictionInterval.predict-166"><a href="#PredictionInterval.predict-166"><span class="linenos">166</span></a>
</span><span id="PredictionInterval.predict-167"><a href="#PredictionInterval.predict-167"><span class="linenos">167</span></a><span class="sd">            return_pi: boolean</span>
</span><span id="PredictionInterval.predict-168"><a href="#PredictionInterval.predict-168"><span class="linenos">168</span></a><span class="sd">                Whether the prediction interval is returned or not.</span>
</span><span id="PredictionInterval.predict-169"><a href="#PredictionInterval.predict-169"><span class="linenos">169</span></a><span class="sd">                Default is False, for compatibility with other _estimators_.</span>
</span><span id="PredictionInterval.predict-170"><a href="#PredictionInterval.predict-170"><span class="linenos">170</span></a><span class="sd">                If True, a tuple containing the predictions + lower and upper</span>
</span><span id="PredictionInterval.predict-171"><a href="#PredictionInterval.predict-171"><span class="linenos">171</span></a><span class="sd">                bounds is returned.</span>
</span><span id="PredictionInterval.predict-172"><a href="#PredictionInterval.predict-172"><span class="linenos">172</span></a>
</span><span id="PredictionInterval.predict-173"><a href="#PredictionInterval.predict-173"><span class="linenos">173</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PredictionInterval.predict-174"><a href="#PredictionInterval.predict-174"><span class="linenos">174</span></a>
</span><span id="PredictionInterval.predict-175"><a href="#PredictionInterval.predict-175"><span class="linenos">175</span></a>        <span class="n">pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="PredictionInterval.predict-176"><a href="#PredictionInterval.predict-176"><span class="linenos">176</span></a>
</span><span id="PredictionInterval.predict-177"><a href="#PredictionInterval.predict-177"><span class="linenos">177</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;splitconformal&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval.predict-178"><a href="#PredictionInterval.predict-178"><span class="linenos">178</span></a>
</span><span id="PredictionInterval.predict-179"><a href="#PredictionInterval.predict-179"><span class="linenos">179</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PredictionInterval.predict-180"><a href="#PredictionInterval.predict-180"><span class="linenos">180</span></a>
</span><span id="PredictionInterval.predict-181"><a href="#PredictionInterval.predict-181"><span class="linenos">181</span></a>                <span class="k">if</span> <span class="n">return_pi</span><span class="p">:</span>
</span><span id="PredictionInterval.predict-182"><a href="#PredictionInterval.predict-182"><span class="linenos">182</span></a>
</span><span id="PredictionInterval.predict-183"><a href="#PredictionInterval.predict-183"><span class="linenos">183</span></a>                    <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-184"><a href="#PredictionInterval.predict-184"><span class="linenos">184</span></a>                        <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="PredictionInterval.predict-185"><a href="#PredictionInterval.predict-185"><span class="linenos">185</span></a>                    <span class="p">)</span>
</span><span id="PredictionInterval.predict-186"><a href="#PredictionInterval.predict-186"><span class="linenos">186</span></a>
</span><span id="PredictionInterval.predict-187"><a href="#PredictionInterval.predict-187"><span class="linenos">187</span></a>                    <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-188"><a href="#PredictionInterval.predict-188"><span class="linenos">188</span></a>                        <span class="n">pred</span><span class="p">,</span> <span class="n">pred</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantile_</span><span class="p">,</span> <span class="n">pred</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantile_</span>
</span><span id="PredictionInterval.predict-189"><a href="#PredictionInterval.predict-189"><span class="linenos">189</span></a>                    <span class="p">)</span>
</span><span id="PredictionInterval.predict-190"><a href="#PredictionInterval.predict-190"><span class="linenos">190</span></a>
</span><span id="PredictionInterval.predict-191"><a href="#PredictionInterval.predict-191"><span class="linenos">191</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PredictionInterval.predict-192"><a href="#PredictionInterval.predict-192"><span class="linenos">192</span></a>
</span><span id="PredictionInterval.predict-193"><a href="#PredictionInterval.predict-193"><span class="linenos">193</span></a>                    <span class="k">return</span> <span class="n">pred</span>
</span><span id="PredictionInterval.predict-194"><a href="#PredictionInterval.predict-194"><span class="linenos">194</span></a>
</span><span id="PredictionInterval.predict-195"><a href="#PredictionInterval.predict-195"><span class="linenos">195</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># if self.replications is not None</span>
</span><span id="PredictionInterval.predict-196"><a href="#PredictionInterval.predict-196"><span class="linenos">196</span></a>
</span><span id="PredictionInterval.predict-197"><a href="#PredictionInterval.predict-197"><span class="linenos">197</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="PredictionInterval.predict-198"><a href="#PredictionInterval.predict-198"><span class="linenos">198</span></a>                    <span class="s2">&quot;bootstrap&quot;</span><span class="p">,</span>
</span><span id="PredictionInterval.predict-199"><a href="#PredictionInterval.predict-199"><span class="linenos">199</span></a>                    <span class="s2">&quot;kde&quot;</span><span class="p">,</span>
</span><span id="PredictionInterval.predict-200"><a href="#PredictionInterval.predict-200"><span class="linenos">200</span></a>                <span class="p">),</span> <span class="s2">&quot;`self.type_pi` must be in (&#39;bootstrap&#39;, &#39;kde&#39;)&quot;</span>
</span><span id="PredictionInterval.predict-201"><a href="#PredictionInterval.predict-201"><span class="linenos">201</span></a>
</span><span id="PredictionInterval.predict-202"><a href="#PredictionInterval.predict-202"><span class="linenos">202</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">==</span> <span class="s2">&quot;bootstrap&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval.predict-203"><a href="#PredictionInterval.predict-203"><span class="linenos">203</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="PredictionInterval.predict-204"><a href="#PredictionInterval.predict-204"><span class="linenos">204</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-205"><a href="#PredictionInterval.predict-205"><span class="linenos">205</span></a>                        <span class="p">[</span>
</span><span id="PredictionInterval.predict-206"><a href="#PredictionInterval.predict-206"><span class="linenos">206</span></a>                            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-207"><a href="#PredictionInterval.predict-207"><span class="linenos">207</span></a>                                <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_calibrated_residuals_</span><span class="p">,</span>
</span><span id="PredictionInterval.predict-208"><a href="#PredictionInterval.predict-208"><span class="linenos">208</span></a>                                <span class="n">size</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="PredictionInterval.predict-209"><a href="#PredictionInterval.predict-209"><span class="linenos">209</span></a>                            <span class="p">)</span>
</span><span id="PredictionInterval.predict-210"><a href="#PredictionInterval.predict-210"><span class="linenos">210</span></a>                            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">)</span>
</span><span id="PredictionInterval.predict-211"><a href="#PredictionInterval.predict-211"><span class="linenos">211</span></a>                        <span class="p">]</span>
</span><span id="PredictionInterval.predict-212"><a href="#PredictionInterval.predict-212"><span class="linenos">212</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="PredictionInterval.predict-213"><a href="#PredictionInterval.predict-213"><span class="linenos">213</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-214"><a href="#PredictionInterval.predict-214"><span class="linenos">214</span></a>                        <span class="p">[</span>
</span><span id="PredictionInterval.predict-215"><a href="#PredictionInterval.predict-215"><span class="linenos">215</span></a>                            <span class="n">pred</span>
</span><span id="PredictionInterval.predict-216"><a href="#PredictionInterval.predict-216"><span class="linenos">216</span></a>                            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span><span class="o">.</span><span class="n">scale_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PredictionInterval.predict-217"><a href="#PredictionInterval.predict-217"><span class="linenos">217</span></a>                            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</span><span id="PredictionInterval.predict-218"><a href="#PredictionInterval.predict-218"><span class="linenos">218</span></a>                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">)</span>
</span><span id="PredictionInterval.predict-219"><a href="#PredictionInterval.predict-219"><span class="linenos">219</span></a>                        <span class="p">]</span>
</span><span id="PredictionInterval.predict-220"><a href="#PredictionInterval.predict-220"><span class="linenos">220</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="PredictionInterval.predict-221"><a href="#PredictionInterval.predict-221"><span class="linenos">221</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">==</span> <span class="s2">&quot;kde&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval.predict-222"><a href="#PredictionInterval.predict-222"><span class="linenos">222</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-223"><a href="#PredictionInterval.predict-223"><span class="linenos">223</span></a>                        <span class="n">dataset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_calibrated_residuals_</span>
</span><span id="PredictionInterval.predict-224"><a href="#PredictionInterval.predict-224"><span class="linenos">224</span></a>                    <span class="p">)</span>
</span><span id="PredictionInterval.predict-225"><a href="#PredictionInterval.predict-225"><span class="linenos">225</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-226"><a href="#PredictionInterval.predict-226"><span class="linenos">226</span></a>                        <span class="p">[</span>
</span><span id="PredictionInterval.predict-227"><a href="#PredictionInterval.predict-227"><span class="linenos">227</span></a>                            <span class="n">pred</span>
</span><span id="PredictionInterval.predict-228"><a href="#PredictionInterval.predict-228"><span class="linenos">228</span></a>                            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span><span class="o">.</span><span class="n">scale_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PredictionInterval.predict-229"><a href="#PredictionInterval.predict-229"><span class="linenos">229</span></a>                            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-230"><a href="#PredictionInterval.predict-230"><span class="linenos">230</span></a>                                <span class="n">size</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="n">i</span>
</span><span id="PredictionInterval.predict-231"><a href="#PredictionInterval.predict-231"><span class="linenos">231</span></a>                            <span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</span><span id="PredictionInterval.predict-232"><a href="#PredictionInterval.predict-232"><span class="linenos">232</span></a>                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">)</span>
</span><span id="PredictionInterval.predict-233"><a href="#PredictionInterval.predict-233"><span class="linenos">233</span></a>                        <span class="p">]</span>
</span><span id="PredictionInterval.predict-234"><a href="#PredictionInterval.predict-234"><span class="linenos">234</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="PredictionInterval.predict-235"><a href="#PredictionInterval.predict-235"><span class="linenos">235</span></a>
</span><span id="PredictionInterval.predict-236"><a href="#PredictionInterval.predict-236"><span class="linenos">236</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PredictionInterval.predict-237"><a href="#PredictionInterval.predict-237"><span class="linenos">237</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-238"><a href="#PredictionInterval.predict-238"><span class="linenos">238</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">/</span> <span class="mi">200</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="PredictionInterval.predict-239"><a href="#PredictionInterval.predict-239"><span class="linenos">239</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval.predict-240"><a href="#PredictionInterval.predict-240"><span class="linenos">240</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-241"><a href="#PredictionInterval.predict-241"><span class="linenos">241</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">/</span> <span class="mi">200</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="PredictionInterval.predict-242"><a href="#PredictionInterval.predict-242"><span class="linenos">242</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval.predict-243"><a href="#PredictionInterval.predict-243"><span class="linenos">243</span></a>
</span><span id="PredictionInterval.predict-244"><a href="#PredictionInterval.predict-244"><span class="linenos">244</span></a>                <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-245"><a href="#PredictionInterval.predict-245"><span class="linenos">245</span></a>                    <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;sims&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="PredictionInterval.predict-246"><a href="#PredictionInterval.predict-246"><span class="linenos">246</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval.predict-247"><a href="#PredictionInterval.predict-247"><span class="linenos">247</span></a>
</span><span id="PredictionInterval.predict-248"><a href="#PredictionInterval.predict-248"><span class="linenos">248</span></a>                <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-249"><a href="#PredictionInterval.predict-249"><span class="linenos">249</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span>
</span><span id="PredictionInterval.predict-250"><a href="#PredictionInterval.predict-250"><span class="linenos">250</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval.predict-251"><a href="#PredictionInterval.predict-251"><span class="linenos">251</span></a>
</span><span id="PredictionInterval.predict-252"><a href="#PredictionInterval.predict-252"><span class="linenos">252</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;localconformal&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval.predict-253"><a href="#PredictionInterval.predict-253"><span class="linenos">253</span></a>
</span><span id="PredictionInterval.predict-254"><a href="#PredictionInterval.predict-254"><span class="linenos">254</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">replications</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PredictionInterval.predict-255"><a href="#PredictionInterval.predict-255"><span class="linenos">255</span></a>
</span><span id="PredictionInterval.predict-256"><a href="#PredictionInterval.predict-256"><span class="linenos">256</span></a>                <span class="k">if</span> <span class="n">return_pi</span><span class="p">:</span>
</span><span id="PredictionInterval.predict-257"><a href="#PredictionInterval.predict-257"><span class="linenos">257</span></a>
</span><span id="PredictionInterval.predict-258"><a href="#PredictionInterval.predict-258"><span class="linenos">258</span></a>                    <span class="n">predictions_bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">icp_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-259"><a href="#PredictionInterval.predict-259"><span class="linenos">259</span></a>                        <span class="n">X</span><span class="p">,</span> <span class="n">significance</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span>
</span><span id="PredictionInterval.predict-260"><a href="#PredictionInterval.predict-260"><span class="linenos">260</span></a>                    <span class="p">)</span>
</span><span id="PredictionInterval.predict-261"><a href="#PredictionInterval.predict-261"><span class="linenos">261</span></a>                    <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-262"><a href="#PredictionInterval.predict-262"><span class="linenos">262</span></a>                        <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="PredictionInterval.predict-263"><a href="#PredictionInterval.predict-263"><span class="linenos">263</span></a>                    <span class="p">)</span>
</span><span id="PredictionInterval.predict-264"><a href="#PredictionInterval.predict-264"><span class="linenos">264</span></a>                    <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-265"><a href="#PredictionInterval.predict-265"><span class="linenos">265</span></a>                        <span class="n">pred</span><span class="p">,</span> <span class="n">predictions_bounds</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">predictions_bounds</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="PredictionInterval.predict-266"><a href="#PredictionInterval.predict-266"><span class="linenos">266</span></a>                    <span class="p">)</span>
</span><span id="PredictionInterval.predict-267"><a href="#PredictionInterval.predict-267"><span class="linenos">267</span></a>
</span><span id="PredictionInterval.predict-268"><a href="#PredictionInterval.predict-268"><span class="linenos">268</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PredictionInterval.predict-269"><a href="#PredictionInterval.predict-269"><span class="linenos">269</span></a>
</span><span id="PredictionInterval.predict-270"><a href="#PredictionInterval.predict-270"><span class="linenos">270</span></a>                    <span class="k">return</span> <span class="n">pred</span>
</span><span id="PredictionInterval.predict-271"><a href="#PredictionInterval.predict-271"><span class="linenos">271</span></a>
</span><span id="PredictionInterval.predict-272"><a href="#PredictionInterval.predict-272"><span class="linenos">272</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># if self.replications is not None</span>
</span><span id="PredictionInterval.predict-273"><a href="#PredictionInterval.predict-273"><span class="linenos">273</span></a>
</span><span id="PredictionInterval.predict-274"><a href="#PredictionInterval.predict-274"><span class="linenos">274</span></a>                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="ow">in</span> <span class="p">(</span>
</span><span id="PredictionInterval.predict-275"><a href="#PredictionInterval.predict-275"><span class="linenos">275</span></a>                    <span class="s2">&quot;bootstrap&quot;</span><span class="p">,</span>
</span><span id="PredictionInterval.predict-276"><a href="#PredictionInterval.predict-276"><span class="linenos">276</span></a>                    <span class="s2">&quot;kde&quot;</span><span class="p">,</span>
</span><span id="PredictionInterval.predict-277"><a href="#PredictionInterval.predict-277"><span class="linenos">277</span></a>                <span class="p">),</span> <span class="s2">&quot;`self.type_pi` must be in (&#39;bootstrap&#39;, &#39;kde&#39;)&quot;</span>
</span><span id="PredictionInterval.predict-278"><a href="#PredictionInterval.predict-278"><span class="linenos">278</span></a>
</span><span id="PredictionInterval.predict-279"><a href="#PredictionInterval.predict-279"><span class="linenos">279</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">==</span> <span class="s2">&quot;bootstrap&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval.predict-280"><a href="#PredictionInterval.predict-280"><span class="linenos">280</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>
</span><span id="PredictionInterval.predict-281"><a href="#PredictionInterval.predict-281"><span class="linenos">281</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-282"><a href="#PredictionInterval.predict-282"><span class="linenos">282</span></a>                        <span class="p">[</span>
</span><span id="PredictionInterval.predict-283"><a href="#PredictionInterval.predict-283"><span class="linenos">283</span></a>                            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-284"><a href="#PredictionInterval.predict-284"><span class="linenos">284</span></a>                                <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_calibrated_residuals_</span><span class="p">,</span>
</span><span id="PredictionInterval.predict-285"><a href="#PredictionInterval.predict-285"><span class="linenos">285</span></a>                                <span class="n">size</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="PredictionInterval.predict-286"><a href="#PredictionInterval.predict-286"><span class="linenos">286</span></a>                            <span class="p">)</span>
</span><span id="PredictionInterval.predict-287"><a href="#PredictionInterval.predict-287"><span class="linenos">287</span></a>                            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">)</span>
</span><span id="PredictionInterval.predict-288"><a href="#PredictionInterval.predict-288"><span class="linenos">288</span></a>                        <span class="p">]</span>
</span><span id="PredictionInterval.predict-289"><a href="#PredictionInterval.predict-289"><span class="linenos">289</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="PredictionInterval.predict-290"><a href="#PredictionInterval.predict-290"><span class="linenos">290</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-291"><a href="#PredictionInterval.predict-291"><span class="linenos">291</span></a>                        <span class="p">[</span>
</span><span id="PredictionInterval.predict-292"><a href="#PredictionInterval.predict-292"><span class="linenos">292</span></a>                            <span class="n">pred</span>
</span><span id="PredictionInterval.predict-293"><a href="#PredictionInterval.predict-293"><span class="linenos">293</span></a>                            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span><span class="o">.</span><span class="n">scale_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PredictionInterval.predict-294"><a href="#PredictionInterval.predict-294"><span class="linenos">294</span></a>                            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">residuals_sims_</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</span><span id="PredictionInterval.predict-295"><a href="#PredictionInterval.predict-295"><span class="linenos">295</span></a>                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">))</span>
</span><span id="PredictionInterval.predict-296"><a href="#PredictionInterval.predict-296"><span class="linenos">296</span></a>                        <span class="p">]</span>
</span><span id="PredictionInterval.predict-297"><a href="#PredictionInterval.predict-297"><span class="linenos">297</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="PredictionInterval.predict-298"><a href="#PredictionInterval.predict-298"><span class="linenos">298</span></a>                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_pi</span> <span class="o">==</span> <span class="s2">&quot;kde&quot;</span><span class="p">:</span>
</span><span id="PredictionInterval.predict-299"><a href="#PredictionInterval.predict-299"><span class="linenos">299</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-300"><a href="#PredictionInterval.predict-300"><span class="linenos">300</span></a>                        <span class="n">dataset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_calibrated_residuals_</span>
</span><span id="PredictionInterval.predict-301"><a href="#PredictionInterval.predict-301"><span class="linenos">301</span></a>                    <span class="p">)</span>
</span><span id="PredictionInterval.predict-302"><a href="#PredictionInterval.predict-302"><span class="linenos">302</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-303"><a href="#PredictionInterval.predict-303"><span class="linenos">303</span></a>                        <span class="p">[</span>
</span><span id="PredictionInterval.predict-304"><a href="#PredictionInterval.predict-304"><span class="linenos">304</span></a>                            <span class="n">pred</span>
</span><span id="PredictionInterval.predict-305"><a href="#PredictionInterval.predict-305"><span class="linenos">305</span></a>                            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">calibrated_residuals_scaler_</span><span class="o">.</span><span class="n">scale_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PredictionInterval.predict-306"><a href="#PredictionInterval.predict-306"><span class="linenos">306</span></a>                            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">kde_</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-307"><a href="#PredictionInterval.predict-307"><span class="linenos">307</span></a>                                <span class="n">size</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="n">i</span>
</span><span id="PredictionInterval.predict-308"><a href="#PredictionInterval.predict-308"><span class="linenos">308</span></a>                            <span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</span><span id="PredictionInterval.predict-309"><a href="#PredictionInterval.predict-309"><span class="linenos">309</span></a>                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">))</span>
</span><span id="PredictionInterval.predict-310"><a href="#PredictionInterval.predict-310"><span class="linenos">310</span></a>                        <span class="p">]</span>
</span><span id="PredictionInterval.predict-311"><a href="#PredictionInterval.predict-311"><span class="linenos">311</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="PredictionInterval.predict-312"><a href="#PredictionInterval.predict-312"><span class="linenos">312</span></a>
</span><span id="PredictionInterval.predict-313"><a href="#PredictionInterval.predict-313"><span class="linenos">313</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PredictionInterval.predict-314"><a href="#PredictionInterval.predict-314"><span class="linenos">314</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-315"><a href="#PredictionInterval.predict-315"><span class="linenos">315</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">/</span> <span class="mi">200</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="PredictionInterval.predict-316"><a href="#PredictionInterval.predict-316"><span class="linenos">316</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval.predict-317"><a href="#PredictionInterval.predict-317"><span class="linenos">317</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-318"><a href="#PredictionInterval.predict-318"><span class="linenos">318</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">/</span> <span class="mi">200</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
</span><span id="PredictionInterval.predict-319"><a href="#PredictionInterval.predict-319"><span class="linenos">319</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval.predict-320"><a href="#PredictionInterval.predict-320"><span class="linenos">320</span></a>
</span><span id="PredictionInterval.predict-321"><a href="#PredictionInterval.predict-321"><span class="linenos">321</span></a>                <span class="n">DescribeResult</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-322"><a href="#PredictionInterval.predict-322"><span class="linenos">322</span></a>                    <span class="s2">&quot;DescribeResult&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;sims&quot;</span><span class="p">,</span> <span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="s2">&quot;upper&quot;</span><span class="p">)</span>
</span><span id="PredictionInterval.predict-323"><a href="#PredictionInterval.predict-323"><span class="linenos">323</span></a>                <span class="p">)</span>
</span><span id="PredictionInterval.predict-324"><a href="#PredictionInterval.predict-324"><span class="linenos">324</span></a>
</span><span id="PredictionInterval.predict-325"><a href="#PredictionInterval.predict-325"><span class="linenos">325</span></a>                <span class="k">return</span> <span class="n">DescribeResult</span><span class="p">(</span>
</span><span id="PredictionInterval.predict-326"><a href="#PredictionInterval.predict-326"><span class="linenos">326</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">mean_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sims_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_</span>
</span><span id="PredictionInterval.predict-327"><a href="#PredictionInterval.predict-327"><span class="linenos">327</span></a>                <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Obtain predictions and prediction intervals</p>

<p>Args:</p>

<pre><code>X: array-like, shape = [n_samples, n_features];
    Testing set vectors, where n_samples is the number
    of samples and n_features is the number of features.

return_pi: boolean
    Whether the prediction interval is returned or not.
    Default is False, for compatibility with other _estimators_.
    If True, a tuple containing the predictions + lower and upper
    bounds is returned.
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="SimpleMultitaskClassifier">
                            <input id="SimpleMultitaskClassifier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SimpleMultitaskClassifier</span><wbr>(<span class="base"><a href="#Base">nnetsauce.Base</a></span>, <span class="base">sklearn.base.ClassifierMixin</span>):

                <label class="view-source-button" for="SimpleMultitaskClassifier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SimpleMultitaskClassifier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SimpleMultitaskClassifier-17"><a href="#SimpleMultitaskClassifier-17"><span class="linenos"> 17</span></a><span class="k">class</span> <span class="nc">SimpleMultitaskClassifier</span><span class="p">(</span><span class="n">Base</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">):</span>
</span><span id="SimpleMultitaskClassifier-18"><a href="#SimpleMultitaskClassifier-18"><span class="linenos"> 18</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Multitask Classification model based on regression models, with shared covariates</span>
</span><span id="SimpleMultitaskClassifier-19"><a href="#SimpleMultitaskClassifier-19"><span class="linenos"> 19</span></a>
</span><span id="SimpleMultitaskClassifier-20"><a href="#SimpleMultitaskClassifier-20"><span class="linenos"> 20</span></a><span class="sd">    Parameters:</span>
</span><span id="SimpleMultitaskClassifier-21"><a href="#SimpleMultitaskClassifier-21"><span class="linenos"> 21</span></a>
</span><span id="SimpleMultitaskClassifier-22"><a href="#SimpleMultitaskClassifier-22"><span class="linenos"> 22</span></a><span class="sd">        obj: object</span>
</span><span id="SimpleMultitaskClassifier-23"><a href="#SimpleMultitaskClassifier-23"><span class="linenos"> 23</span></a><span class="sd">            any object (must be a regression model) containing a method fit (obj.fit())</span>
</span><span id="SimpleMultitaskClassifier-24"><a href="#SimpleMultitaskClassifier-24"><span class="linenos"> 24</span></a><span class="sd">            and a method predict (obj.predict())</span>
</span><span id="SimpleMultitaskClassifier-25"><a href="#SimpleMultitaskClassifier-25"><span class="linenos"> 25</span></a>
</span><span id="SimpleMultitaskClassifier-26"><a href="#SimpleMultitaskClassifier-26"><span class="linenos"> 26</span></a><span class="sd">        seed: int</span>
</span><span id="SimpleMultitaskClassifier-27"><a href="#SimpleMultitaskClassifier-27"><span class="linenos"> 27</span></a><span class="sd">            reproducibility seed</span>
</span><span id="SimpleMultitaskClassifier-28"><a href="#SimpleMultitaskClassifier-28"><span class="linenos"> 28</span></a>
</span><span id="SimpleMultitaskClassifier-29"><a href="#SimpleMultitaskClassifier-29"><span class="linenos"> 29</span></a><span class="sd">    Attributes:</span>
</span><span id="SimpleMultitaskClassifier-30"><a href="#SimpleMultitaskClassifier-30"><span class="linenos"> 30</span></a>
</span><span id="SimpleMultitaskClassifier-31"><a href="#SimpleMultitaskClassifier-31"><span class="linenos"> 31</span></a><span class="sd">        fit_objs_: dict</span>
</span><span id="SimpleMultitaskClassifier-32"><a href="#SimpleMultitaskClassifier-32"><span class="linenos"> 32</span></a><span class="sd">            objects adjusted to each individual time series</span>
</span><span id="SimpleMultitaskClassifier-33"><a href="#SimpleMultitaskClassifier-33"><span class="linenos"> 33</span></a>
</span><span id="SimpleMultitaskClassifier-34"><a href="#SimpleMultitaskClassifier-34"><span class="linenos"> 34</span></a><span class="sd">        n_classes_: int</span>
</span><span id="SimpleMultitaskClassifier-35"><a href="#SimpleMultitaskClassifier-35"><span class="linenos"> 35</span></a><span class="sd">            number of classes for the classifier</span>
</span><span id="SimpleMultitaskClassifier-36"><a href="#SimpleMultitaskClassifier-36"><span class="linenos"> 36</span></a>
</span><span id="SimpleMultitaskClassifier-37"><a href="#SimpleMultitaskClassifier-37"><span class="linenos"> 37</span></a><span class="sd">    Examples:</span>
</span><span id="SimpleMultitaskClassifier-38"><a href="#SimpleMultitaskClassifier-38"><span class="linenos"> 38</span></a>
</span><span id="SimpleMultitaskClassifier-39"><a href="#SimpleMultitaskClassifier-39"><span class="linenos"> 39</span></a><span class="sd">    ```python</span>
</span><span id="SimpleMultitaskClassifier-40"><a href="#SimpleMultitaskClassifier-40"><span class="linenos"> 40</span></a><span class="sd">    import nnetsauce as ns</span>
</span><span id="SimpleMultitaskClassifier-41"><a href="#SimpleMultitaskClassifier-41"><span class="linenos"> 41</span></a><span class="sd">    import numpy as np</span>
</span><span id="SimpleMultitaskClassifier-42"><a href="#SimpleMultitaskClassifier-42"><span class="linenos"> 42</span></a><span class="sd">    from sklearn.datasets import load_breast_cancer</span>
</span><span id="SimpleMultitaskClassifier-43"><a href="#SimpleMultitaskClassifier-43"><span class="linenos"> 43</span></a><span class="sd">    from sklearn.linear_model import LinearRegression</span>
</span><span id="SimpleMultitaskClassifier-44"><a href="#SimpleMultitaskClassifier-44"><span class="linenos"> 44</span></a><span class="sd">    from sklearn.model_selection import train_test_split</span>
</span><span id="SimpleMultitaskClassifier-45"><a href="#SimpleMultitaskClassifier-45"><span class="linenos"> 45</span></a><span class="sd">    from sklearn import metrics</span>
</span><span id="SimpleMultitaskClassifier-46"><a href="#SimpleMultitaskClassifier-46"><span class="linenos"> 46</span></a><span class="sd">    from time import time</span>
</span><span id="SimpleMultitaskClassifier-47"><a href="#SimpleMultitaskClassifier-47"><span class="linenos"> 47</span></a>
</span><span id="SimpleMultitaskClassifier-48"><a href="#SimpleMultitaskClassifier-48"><span class="linenos"> 48</span></a><span class="sd">    breast_cancer = load_breast_cancer()</span>
</span><span id="SimpleMultitaskClassifier-49"><a href="#SimpleMultitaskClassifier-49"><span class="linenos"> 49</span></a><span class="sd">    Z = breast_cancer.data</span>
</span><span id="SimpleMultitaskClassifier-50"><a href="#SimpleMultitaskClassifier-50"><span class="linenos"> 50</span></a><span class="sd">    t = breast_cancer.target</span>
</span><span id="SimpleMultitaskClassifier-51"><a href="#SimpleMultitaskClassifier-51"><span class="linenos"> 51</span></a>
</span><span id="SimpleMultitaskClassifier-52"><a href="#SimpleMultitaskClassifier-52"><span class="linenos"> 52</span></a><span class="sd">    X_train, X_test, y_train, y_test = train_test_split(Z, t, test_size=0.2,</span>
</span><span id="SimpleMultitaskClassifier-53"><a href="#SimpleMultitaskClassifier-53"><span class="linenos"> 53</span></a><span class="sd">                                                        random_state=123+2*10)</span>
</span><span id="SimpleMultitaskClassifier-54"><a href="#SimpleMultitaskClassifier-54"><span class="linenos"> 54</span></a>
</span><span id="SimpleMultitaskClassifier-55"><a href="#SimpleMultitaskClassifier-55"><span class="linenos"> 55</span></a><span class="sd">    # Linear Regression is used</span>
</span><span id="SimpleMultitaskClassifier-56"><a href="#SimpleMultitaskClassifier-56"><span class="linenos"> 56</span></a><span class="sd">    regr = LinearRegression()</span>
</span><span id="SimpleMultitaskClassifier-57"><a href="#SimpleMultitaskClassifier-57"><span class="linenos"> 57</span></a><span class="sd">    fit_obj = ns.SimpleMultitaskClassifier(regr)</span>
</span><span id="SimpleMultitaskClassifier-58"><a href="#SimpleMultitaskClassifier-58"><span class="linenos"> 58</span></a>
</span><span id="SimpleMultitaskClassifier-59"><a href="#SimpleMultitaskClassifier-59"><span class="linenos"> 59</span></a><span class="sd">    start = time()</span>
</span><span id="SimpleMultitaskClassifier-60"><a href="#SimpleMultitaskClassifier-60"><span class="linenos"> 60</span></a><span class="sd">    fit_obj.fit(X_train, y_train)</span>
</span><span id="SimpleMultitaskClassifier-61"><a href="#SimpleMultitaskClassifier-61"><span class="linenos"> 61</span></a><span class="sd">    print(f&quot;Elapsed {time() - start}&quot;)</span>
</span><span id="SimpleMultitaskClassifier-62"><a href="#SimpleMultitaskClassifier-62"><span class="linenos"> 62</span></a>
</span><span id="SimpleMultitaskClassifier-63"><a href="#SimpleMultitaskClassifier-63"><span class="linenos"> 63</span></a><span class="sd">    print(fit_obj.score(X_test, y_test))</span>
</span><span id="SimpleMultitaskClassifier-64"><a href="#SimpleMultitaskClassifier-64"><span class="linenos"> 64</span></a><span class="sd">    print(fit_obj.score(X_test, y_test, scoring=&quot;roc_auc&quot;))</span>
</span><span id="SimpleMultitaskClassifier-65"><a href="#SimpleMultitaskClassifier-65"><span class="linenos"> 65</span></a>
</span><span id="SimpleMultitaskClassifier-66"><a href="#SimpleMultitaskClassifier-66"><span class="linenos"> 66</span></a><span class="sd">    start = time()</span>
</span><span id="SimpleMultitaskClassifier-67"><a href="#SimpleMultitaskClassifier-67"><span class="linenos"> 67</span></a><span class="sd">    preds = fit_obj.predict(X_test)</span>
</span><span id="SimpleMultitaskClassifier-68"><a href="#SimpleMultitaskClassifier-68"><span class="linenos"> 68</span></a><span class="sd">    print(f&quot;Elapsed {time() - start}&quot;)</span>
</span><span id="SimpleMultitaskClassifier-69"><a href="#SimpleMultitaskClassifier-69"><span class="linenos"> 69</span></a><span class="sd">    print(metrics.classification_report(preds, y_test))</span>
</span><span id="SimpleMultitaskClassifier-70"><a href="#SimpleMultitaskClassifier-70"><span class="linenos"> 70</span></a><span class="sd">    ```</span>
</span><span id="SimpleMultitaskClassifier-71"><a href="#SimpleMultitaskClassifier-71"><span class="linenos"> 71</span></a>
</span><span id="SimpleMultitaskClassifier-72"><a href="#SimpleMultitaskClassifier-72"><span class="linenos"> 72</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SimpleMultitaskClassifier-73"><a href="#SimpleMultitaskClassifier-73"><span class="linenos"> 73</span></a>
</span><span id="SimpleMultitaskClassifier-74"><a href="#SimpleMultitaskClassifier-74"><span class="linenos"> 74</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="SimpleMultitaskClassifier-75"><a href="#SimpleMultitaskClassifier-75"><span class="linenos"> 75</span></a>
</span><span id="SimpleMultitaskClassifier-76"><a href="#SimpleMultitaskClassifier-76"><span class="linenos"> 76</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="SimpleMultitaskClassifier-77"><a href="#SimpleMultitaskClassifier-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SimpleMultitaskClassifier-78"><a href="#SimpleMultitaskClassifier-78"><span class="linenos"> 78</span></a>        <span class="n">obj</span><span class="p">,</span>
</span><span id="SimpleMultitaskClassifier-79"><a href="#SimpleMultitaskClassifier-79"><span class="linenos"> 79</span></a>    <span class="p">):</span>
</span><span id="SimpleMultitaskClassifier-80"><a href="#SimpleMultitaskClassifier-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_fit</span> <span class="o">=</span> <span class="s2">&quot;classification&quot;</span>
</span><span id="SimpleMultitaskClassifier-81"><a href="#SimpleMultitaskClassifier-81"><span class="linenos"> 81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
</span><span id="SimpleMultitaskClassifier-82"><a href="#SimpleMultitaskClassifier-82"><span class="linenos"> 82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="SimpleMultitaskClassifier-83"><a href="#SimpleMultitaskClassifier-83"><span class="linenos"> 83</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X_scaler_</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
</span><span id="SimpleMultitaskClassifier-84"><a href="#SimpleMultitaskClassifier-84"><span class="linenos"> 84</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_X_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SimpleMultitaskClassifier-85"><a href="#SimpleMultitaskClassifier-85"><span class="linenos"> 85</span></a>
</span><span id="SimpleMultitaskClassifier-86"><a href="#SimpleMultitaskClassifier-86"><span class="linenos"> 86</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="SimpleMultitaskClassifier-87"><a href="#SimpleMultitaskClassifier-87"><span class="linenos"> 87</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit SimpleMultitaskClassifier to training data (X, y).</span>
</span><span id="SimpleMultitaskClassifier-88"><a href="#SimpleMultitaskClassifier-88"><span class="linenos"> 88</span></a>
</span><span id="SimpleMultitaskClassifier-89"><a href="#SimpleMultitaskClassifier-89"><span class="linenos"> 89</span></a><span class="sd">        Args:</span>
</span><span id="SimpleMultitaskClassifier-90"><a href="#SimpleMultitaskClassifier-90"><span class="linenos"> 90</span></a>
</span><span id="SimpleMultitaskClassifier-91"><a href="#SimpleMultitaskClassifier-91"><span class="linenos"> 91</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="SimpleMultitaskClassifier-92"><a href="#SimpleMultitaskClassifier-92"><span class="linenos"> 92</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="SimpleMultitaskClassifier-93"><a href="#SimpleMultitaskClassifier-93"><span class="linenos"> 93</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="SimpleMultitaskClassifier-94"><a href="#SimpleMultitaskClassifier-94"><span class="linenos"> 94</span></a>
</span><span id="SimpleMultitaskClassifier-95"><a href="#SimpleMultitaskClassifier-95"><span class="linenos"> 95</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="SimpleMultitaskClassifier-96"><a href="#SimpleMultitaskClassifier-96"><span class="linenos"> 96</span></a><span class="sd">                Target values.</span>
</span><span id="SimpleMultitaskClassifier-97"><a href="#SimpleMultitaskClassifier-97"><span class="linenos"> 97</span></a>
</span><span id="SimpleMultitaskClassifier-98"><a href="#SimpleMultitaskClassifier-98"><span class="linenos"> 98</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="SimpleMultitaskClassifier-99"><a href="#SimpleMultitaskClassifier-99"><span class="linenos"> 99</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="SimpleMultitaskClassifier-100"><a href="#SimpleMultitaskClassifier-100"><span class="linenos">100</span></a>
</span><span id="SimpleMultitaskClassifier-101"><a href="#SimpleMultitaskClassifier-101"><span class="linenos">101</span></a><span class="sd">        Returns:</span>
</span><span id="SimpleMultitaskClassifier-102"><a href="#SimpleMultitaskClassifier-102"><span class="linenos">102</span></a>
</span><span id="SimpleMultitaskClassifier-103"><a href="#SimpleMultitaskClassifier-103"><span class="linenos">103</span></a><span class="sd">            self: object</span>
</span><span id="SimpleMultitaskClassifier-104"><a href="#SimpleMultitaskClassifier-104"><span class="linenos">104</span></a>
</span><span id="SimpleMultitaskClassifier-105"><a href="#SimpleMultitaskClassifier-105"><span class="linenos">105</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SimpleMultitaskClassifier-106"><a href="#SimpleMultitaskClassifier-106"><span class="linenos">106</span></a>
</span><span id="SimpleMultitaskClassifier-107"><a href="#SimpleMultitaskClassifier-107"><span class="linenos">107</span></a>        <span class="k">assert</span> <span class="n">mx</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s2">&quot;y must contain only integers&quot;</span>
</span><span id="SimpleMultitaskClassifier-108"><a href="#SimpleMultitaskClassifier-108"><span class="linenos">108</span></a>
</span><span id="SimpleMultitaskClassifier-109"><a href="#SimpleMultitaskClassifier-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="SimpleMultitaskClassifier-110"><a href="#SimpleMultitaskClassifier-110"><span class="linenos">110</span></a>
</span><span id="SimpleMultitaskClassifier-111"><a href="#SimpleMultitaskClassifier-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_X_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_scaler_</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier-112"><a href="#SimpleMultitaskClassifier-112"><span class="linenos">112</span></a>
</span><span id="SimpleMultitaskClassifier-113"><a href="#SimpleMultitaskClassifier-113"><span class="linenos">113</span></a>        <span class="c1"># multitask response</span>
</span><span id="SimpleMultitaskClassifier-114"><a href="#SimpleMultitaskClassifier-114"><span class="linenos">114</span></a>        <span class="n">Y</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">one_hot_encode2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier-115"><a href="#SimpleMultitaskClassifier-115"><span class="linenos">115</span></a>
</span><span id="SimpleMultitaskClassifier-116"><a href="#SimpleMultitaskClassifier-116"><span class="linenos">116</span></a>        <span class="c1"># if sample_weight is None:</span>
</span><span id="SimpleMultitaskClassifier-117"><a href="#SimpleMultitaskClassifier-117"><span class="linenos">117</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">):</span>
</span><span id="SimpleMultitaskClassifier-118"><a href="#SimpleMultitaskClassifier-118"><span class="linenos">118</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="SimpleMultitaskClassifier-119"><a href="#SimpleMultitaskClassifier-119"><span class="linenos">119</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_X_</span><span class="p">,</span> <span class="n">Y</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier-120"><a href="#SimpleMultitaskClassifier-120"><span class="linenos">120</span></a>            <span class="p">)</span>
</span><span id="SimpleMultitaskClassifier-121"><a href="#SimpleMultitaskClassifier-121"><span class="linenos">121</span></a>
</span><span id="SimpleMultitaskClassifier-122"><a href="#SimpleMultitaskClassifier-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier-123"><a href="#SimpleMultitaskClassifier-123"><span class="linenos">123</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="SimpleMultitaskClassifier-124"><a href="#SimpleMultitaskClassifier-124"><span class="linenos">124</span></a>
</span><span id="SimpleMultitaskClassifier-125"><a href="#SimpleMultitaskClassifier-125"><span class="linenos">125</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="SimpleMultitaskClassifier-126"><a href="#SimpleMultitaskClassifier-126"><span class="linenos">126</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="SimpleMultitaskClassifier-127"><a href="#SimpleMultitaskClassifier-127"><span class="linenos">127</span></a>
</span><span id="SimpleMultitaskClassifier-128"><a href="#SimpleMultitaskClassifier-128"><span class="linenos">128</span></a><span class="sd">        Args:</span>
</span><span id="SimpleMultitaskClassifier-129"><a href="#SimpleMultitaskClassifier-129"><span class="linenos">129</span></a>
</span><span id="SimpleMultitaskClassifier-130"><a href="#SimpleMultitaskClassifier-130"><span class="linenos">130</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="SimpleMultitaskClassifier-131"><a href="#SimpleMultitaskClassifier-131"><span class="linenos">131</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="SimpleMultitaskClassifier-132"><a href="#SimpleMultitaskClassifier-132"><span class="linenos">132</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="SimpleMultitaskClassifier-133"><a href="#SimpleMultitaskClassifier-133"><span class="linenos">133</span></a>
</span><span id="SimpleMultitaskClassifier-134"><a href="#SimpleMultitaskClassifier-134"><span class="linenos">134</span></a><span class="sd">            **kwargs: additional parameters</span>
</span><span id="SimpleMultitaskClassifier-135"><a href="#SimpleMultitaskClassifier-135"><span class="linenos">135</span></a>
</span><span id="SimpleMultitaskClassifier-136"><a href="#SimpleMultitaskClassifier-136"><span class="linenos">136</span></a><span class="sd">        Returns:</span>
</span><span id="SimpleMultitaskClassifier-137"><a href="#SimpleMultitaskClassifier-137"><span class="linenos">137</span></a>
</span><span id="SimpleMultitaskClassifier-138"><a href="#SimpleMultitaskClassifier-138"><span class="linenos">138</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="SimpleMultitaskClassifier-139"><a href="#SimpleMultitaskClassifier-139"><span class="linenos">139</span></a>
</span><span id="SimpleMultitaskClassifier-140"><a href="#SimpleMultitaskClassifier-140"><span class="linenos">140</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SimpleMultitaskClassifier-141"><a href="#SimpleMultitaskClassifier-141"><span class="linenos">141</span></a>
</span><span id="SimpleMultitaskClassifier-142"><a href="#SimpleMultitaskClassifier-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier-143"><a href="#SimpleMultitaskClassifier-143"><span class="linenos">143</span></a>
</span><span id="SimpleMultitaskClassifier-144"><a href="#SimpleMultitaskClassifier-144"><span class="linenos">144</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="SimpleMultitaskClassifier-145"><a href="#SimpleMultitaskClassifier-145"><span class="linenos">145</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probabilities for test data X.</span>
</span><span id="SimpleMultitaskClassifier-146"><a href="#SimpleMultitaskClassifier-146"><span class="linenos">146</span></a>
</span><span id="SimpleMultitaskClassifier-147"><a href="#SimpleMultitaskClassifier-147"><span class="linenos">147</span></a><span class="sd">        Args:</span>
</span><span id="SimpleMultitaskClassifier-148"><a href="#SimpleMultitaskClassifier-148"><span class="linenos">148</span></a>
</span><span id="SimpleMultitaskClassifier-149"><a href="#SimpleMultitaskClassifier-149"><span class="linenos">149</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="SimpleMultitaskClassifier-150"><a href="#SimpleMultitaskClassifier-150"><span class="linenos">150</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="SimpleMultitaskClassifier-151"><a href="#SimpleMultitaskClassifier-151"><span class="linenos">151</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="SimpleMultitaskClassifier-152"><a href="#SimpleMultitaskClassifier-152"><span class="linenos">152</span></a>
</span><span id="SimpleMultitaskClassifier-153"><a href="#SimpleMultitaskClassifier-153"><span class="linenos">153</span></a><span class="sd">            **kwargs: additional parameters</span>
</span><span id="SimpleMultitaskClassifier-154"><a href="#SimpleMultitaskClassifier-154"><span class="linenos">154</span></a>
</span><span id="SimpleMultitaskClassifier-155"><a href="#SimpleMultitaskClassifier-155"><span class="linenos">155</span></a><span class="sd">        Returns:</span>
</span><span id="SimpleMultitaskClassifier-156"><a href="#SimpleMultitaskClassifier-156"><span class="linenos">156</span></a>
</span><span id="SimpleMultitaskClassifier-157"><a href="#SimpleMultitaskClassifier-157"><span class="linenos">157</span></a><span class="sd">            probability estimates for test data: {array-like}</span>
</span><span id="SimpleMultitaskClassifier-158"><a href="#SimpleMultitaskClassifier-158"><span class="linenos">158</span></a>
</span><span id="SimpleMultitaskClassifier-159"><a href="#SimpleMultitaskClassifier-159"><span class="linenos">159</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SimpleMultitaskClassifier-160"><a href="#SimpleMultitaskClassifier-160"><span class="linenos">160</span></a>
</span><span id="SimpleMultitaskClassifier-161"><a href="#SimpleMultitaskClassifier-161"><span class="linenos">161</span></a>        <span class="n">shape_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="SimpleMultitaskClassifier-162"><a href="#SimpleMultitaskClassifier-162"><span class="linenos">162</span></a>
</span><span id="SimpleMultitaskClassifier-163"><a href="#SimpleMultitaskClassifier-163"><span class="linenos">163</span></a>        <span class="n">probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">shape_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">))</span>
</span><span id="SimpleMultitaskClassifier-164"><a href="#SimpleMultitaskClassifier-164"><span class="linenos">164</span></a>
</span><span id="SimpleMultitaskClassifier-165"><a href="#SimpleMultitaskClassifier-165"><span class="linenos">165</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape_X</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="SimpleMultitaskClassifier-166"><a href="#SimpleMultitaskClassifier-166"><span class="linenos">166</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">shape_X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SimpleMultitaskClassifier-167"><a href="#SimpleMultitaskClassifier-167"><span class="linenos">167</span></a>
</span><span id="SimpleMultitaskClassifier-168"><a href="#SimpleMultitaskClassifier-168"><span class="linenos">168</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="SimpleMultitaskClassifier-169"><a href="#SimpleMultitaskClassifier-169"><span class="linenos">169</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="SimpleMultitaskClassifier-170"><a href="#SimpleMultitaskClassifier-170"><span class="linenos">170</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="SimpleMultitaskClassifier-171"><a href="#SimpleMultitaskClassifier-171"><span class="linenos">171</span></a>            <span class="p">)</span>
</span><span id="SimpleMultitaskClassifier-172"><a href="#SimpleMultitaskClassifier-172"><span class="linenos">172</span></a>
</span><span id="SimpleMultitaskClassifier-173"><a href="#SimpleMultitaskClassifier-173"><span class="linenos">173</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier-174"><a href="#SimpleMultitaskClassifier-174"><span class="linenos">174</span></a>
</span><span id="SimpleMultitaskClassifier-175"><a href="#SimpleMultitaskClassifier-175"><span class="linenos">175</span></a>            <span class="c1"># loop on all the classes</span>
</span><span id="SimpleMultitaskClassifier-176"><a href="#SimpleMultitaskClassifier-176"><span class="linenos">176</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">):</span>
</span><span id="SimpleMultitaskClassifier-177"><a href="#SimpleMultitaskClassifier-177"><span class="linenos">177</span></a>                <span class="n">probs</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SimpleMultitaskClassifier-178"><a href="#SimpleMultitaskClassifier-178"><span class="linenos">178</span></a>
</span><span id="SimpleMultitaskClassifier-179"><a href="#SimpleMultitaskClassifier-179"><span class="linenos">179</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SimpleMultitaskClassifier-180"><a href="#SimpleMultitaskClassifier-180"><span class="linenos">180</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier-181"><a href="#SimpleMultitaskClassifier-181"><span class="linenos">181</span></a>
</span><span id="SimpleMultitaskClassifier-182"><a href="#SimpleMultitaskClassifier-182"><span class="linenos">182</span></a>            <span class="c1"># loop on all the classes</span>
</span><span id="SimpleMultitaskClassifier-183"><a href="#SimpleMultitaskClassifier-183"><span class="linenos">183</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">):</span>
</span><span id="SimpleMultitaskClassifier-184"><a href="#SimpleMultitaskClassifier-184"><span class="linenos">184</span></a>                <span class="n">probs</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier-185"><a href="#SimpleMultitaskClassifier-185"><span class="linenos">185</span></a>
</span><span id="SimpleMultitaskClassifier-186"><a href="#SimpleMultitaskClassifier-186"><span class="linenos">186</span></a>        <span class="n">expit_raw_probs</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier-187"><a href="#SimpleMultitaskClassifier-187"><span class="linenos">187</span></a>
</span><span id="SimpleMultitaskClassifier-188"><a href="#SimpleMultitaskClassifier-188"><span class="linenos">188</span></a>        <span class="k">return</span> <span class="n">expit_raw_probs</span> <span class="o">/</span> <span class="n">expit_raw_probs</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Multitask Classification model based on regression models, with shared covariates</p>

<p>Parameters:</p>

<pre><code>obj: object
    any object (must be a regression model) containing a method fit (obj.fit())
    and a method predict (obj.predict())

seed: int
    reproducibility seed
</code></pre>

<p>Attributes:</p>

<pre><code>fit_objs_: dict
    objects adjusted to each individual time series

n_classes_: int
    number of classes for the classifier
</code></pre>

<p>Examples:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>

<span class="n">breast_cancer</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">breast_cancer</span><span class="o">.</span><span class="n">data</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">breast_cancer</span><span class="o">.</span><span class="n">target</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                                                    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Linear Regression is used</span>
<span class="n">regr</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">fit_obj</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">SimpleMultitaskClassifier</span><span class="p">(</span><span class="n">regr</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">fit_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Elapsed </span><span class="si">{</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fit_obj</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fit_obj</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;roc_auc&quot;</span><span class="p">))</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Elapsed </span><span class="si">{</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</code></pre>
</div>
</div>


                                <div id="SimpleMultitaskClassifier.fit" class="classattr">
                                            <input id="SimpleMultitaskClassifier.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SimpleMultitaskClassifier.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SimpleMultitaskClassifier.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SimpleMultitaskClassifier.fit-86"><a href="#SimpleMultitaskClassifier.fit-86"><span class="linenos"> 86</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="SimpleMultitaskClassifier.fit-87"><a href="#SimpleMultitaskClassifier.fit-87"><span class="linenos"> 87</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit SimpleMultitaskClassifier to training data (X, y).</span>
</span><span id="SimpleMultitaskClassifier.fit-88"><a href="#SimpleMultitaskClassifier.fit-88"><span class="linenos"> 88</span></a>
</span><span id="SimpleMultitaskClassifier.fit-89"><a href="#SimpleMultitaskClassifier.fit-89"><span class="linenos"> 89</span></a><span class="sd">        Args:</span>
</span><span id="SimpleMultitaskClassifier.fit-90"><a href="#SimpleMultitaskClassifier.fit-90"><span class="linenos"> 90</span></a>
</span><span id="SimpleMultitaskClassifier.fit-91"><a href="#SimpleMultitaskClassifier.fit-91"><span class="linenos"> 91</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="SimpleMultitaskClassifier.fit-92"><a href="#SimpleMultitaskClassifier.fit-92"><span class="linenos"> 92</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="SimpleMultitaskClassifier.fit-93"><a href="#SimpleMultitaskClassifier.fit-93"><span class="linenos"> 93</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="SimpleMultitaskClassifier.fit-94"><a href="#SimpleMultitaskClassifier.fit-94"><span class="linenos"> 94</span></a>
</span><span id="SimpleMultitaskClassifier.fit-95"><a href="#SimpleMultitaskClassifier.fit-95"><span class="linenos"> 95</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="SimpleMultitaskClassifier.fit-96"><a href="#SimpleMultitaskClassifier.fit-96"><span class="linenos"> 96</span></a><span class="sd">                Target values.</span>
</span><span id="SimpleMultitaskClassifier.fit-97"><a href="#SimpleMultitaskClassifier.fit-97"><span class="linenos"> 97</span></a>
</span><span id="SimpleMultitaskClassifier.fit-98"><a href="#SimpleMultitaskClassifier.fit-98"><span class="linenos"> 98</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="SimpleMultitaskClassifier.fit-99"><a href="#SimpleMultitaskClassifier.fit-99"><span class="linenos"> 99</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="SimpleMultitaskClassifier.fit-100"><a href="#SimpleMultitaskClassifier.fit-100"><span class="linenos">100</span></a>
</span><span id="SimpleMultitaskClassifier.fit-101"><a href="#SimpleMultitaskClassifier.fit-101"><span class="linenos">101</span></a><span class="sd">        Returns:</span>
</span><span id="SimpleMultitaskClassifier.fit-102"><a href="#SimpleMultitaskClassifier.fit-102"><span class="linenos">102</span></a>
</span><span id="SimpleMultitaskClassifier.fit-103"><a href="#SimpleMultitaskClassifier.fit-103"><span class="linenos">103</span></a><span class="sd">            self: object</span>
</span><span id="SimpleMultitaskClassifier.fit-104"><a href="#SimpleMultitaskClassifier.fit-104"><span class="linenos">104</span></a>
</span><span id="SimpleMultitaskClassifier.fit-105"><a href="#SimpleMultitaskClassifier.fit-105"><span class="linenos">105</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SimpleMultitaskClassifier.fit-106"><a href="#SimpleMultitaskClassifier.fit-106"><span class="linenos">106</span></a>
</span><span id="SimpleMultitaskClassifier.fit-107"><a href="#SimpleMultitaskClassifier.fit-107"><span class="linenos">107</span></a>        <span class="k">assert</span> <span class="n">mx</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s2">&quot;y must contain only integers&quot;</span>
</span><span id="SimpleMultitaskClassifier.fit-108"><a href="#SimpleMultitaskClassifier.fit-108"><span class="linenos">108</span></a>
</span><span id="SimpleMultitaskClassifier.fit-109"><a href="#SimpleMultitaskClassifier.fit-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="SimpleMultitaskClassifier.fit-110"><a href="#SimpleMultitaskClassifier.fit-110"><span class="linenos">110</span></a>
</span><span id="SimpleMultitaskClassifier.fit-111"><a href="#SimpleMultitaskClassifier.fit-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scaled_X_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_scaler_</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier.fit-112"><a href="#SimpleMultitaskClassifier.fit-112"><span class="linenos">112</span></a>
</span><span id="SimpleMultitaskClassifier.fit-113"><a href="#SimpleMultitaskClassifier.fit-113"><span class="linenos">113</span></a>        <span class="c1"># multitask response</span>
</span><span id="SimpleMultitaskClassifier.fit-114"><a href="#SimpleMultitaskClassifier.fit-114"><span class="linenos">114</span></a>        <span class="n">Y</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">one_hot_encode2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier.fit-115"><a href="#SimpleMultitaskClassifier.fit-115"><span class="linenos">115</span></a>
</span><span id="SimpleMultitaskClassifier.fit-116"><a href="#SimpleMultitaskClassifier.fit-116"><span class="linenos">116</span></a>        <span class="c1"># if sample_weight is None:</span>
</span><span id="SimpleMultitaskClassifier.fit-117"><a href="#SimpleMultitaskClassifier.fit-117"><span class="linenos">117</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">):</span>
</span><span id="SimpleMultitaskClassifier.fit-118"><a href="#SimpleMultitaskClassifier.fit-118"><span class="linenos">118</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="SimpleMultitaskClassifier.fit-119"><a href="#SimpleMultitaskClassifier.fit-119"><span class="linenos">119</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scaled_X_</span><span class="p">,</span> <span class="n">Y</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier.fit-120"><a href="#SimpleMultitaskClassifier.fit-120"><span class="linenos">120</span></a>            <span class="p">)</span>
</span><span id="SimpleMultitaskClassifier.fit-121"><a href="#SimpleMultitaskClassifier.fit-121"><span class="linenos">121</span></a>
</span><span id="SimpleMultitaskClassifier.fit-122"><a href="#SimpleMultitaskClassifier.fit-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier.fit-123"><a href="#SimpleMultitaskClassifier.fit-123"><span class="linenos">123</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit SimpleMultitaskClassifier to training data (X, y).</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

y: array-like, shape = [n_samples]
    Target values.

**kwargs: additional parameters to be passed to
        self.cook_training_set or self.obj.fit
</code></pre>

<p>Returns:</p>

<pre><code>self: object
</code></pre>
</div>


                                </div>
                                <div id="SimpleMultitaskClassifier.predict" class="classattr">
                                            <input id="SimpleMultitaskClassifier.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SimpleMultitaskClassifier.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SimpleMultitaskClassifier.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SimpleMultitaskClassifier.predict-125"><a href="#SimpleMultitaskClassifier.predict-125"><span class="linenos">125</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="SimpleMultitaskClassifier.predict-126"><a href="#SimpleMultitaskClassifier.predict-126"><span class="linenos">126</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="SimpleMultitaskClassifier.predict-127"><a href="#SimpleMultitaskClassifier.predict-127"><span class="linenos">127</span></a>
</span><span id="SimpleMultitaskClassifier.predict-128"><a href="#SimpleMultitaskClassifier.predict-128"><span class="linenos">128</span></a><span class="sd">        Args:</span>
</span><span id="SimpleMultitaskClassifier.predict-129"><a href="#SimpleMultitaskClassifier.predict-129"><span class="linenos">129</span></a>
</span><span id="SimpleMultitaskClassifier.predict-130"><a href="#SimpleMultitaskClassifier.predict-130"><span class="linenos">130</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="SimpleMultitaskClassifier.predict-131"><a href="#SimpleMultitaskClassifier.predict-131"><span class="linenos">131</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="SimpleMultitaskClassifier.predict-132"><a href="#SimpleMultitaskClassifier.predict-132"><span class="linenos">132</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="SimpleMultitaskClassifier.predict-133"><a href="#SimpleMultitaskClassifier.predict-133"><span class="linenos">133</span></a>
</span><span id="SimpleMultitaskClassifier.predict-134"><a href="#SimpleMultitaskClassifier.predict-134"><span class="linenos">134</span></a><span class="sd">            **kwargs: additional parameters</span>
</span><span id="SimpleMultitaskClassifier.predict-135"><a href="#SimpleMultitaskClassifier.predict-135"><span class="linenos">135</span></a>
</span><span id="SimpleMultitaskClassifier.predict-136"><a href="#SimpleMultitaskClassifier.predict-136"><span class="linenos">136</span></a><span class="sd">        Returns:</span>
</span><span id="SimpleMultitaskClassifier.predict-137"><a href="#SimpleMultitaskClassifier.predict-137"><span class="linenos">137</span></a>
</span><span id="SimpleMultitaskClassifier.predict-138"><a href="#SimpleMultitaskClassifier.predict-138"><span class="linenos">138</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="SimpleMultitaskClassifier.predict-139"><a href="#SimpleMultitaskClassifier.predict-139"><span class="linenos">139</span></a>
</span><span id="SimpleMultitaskClassifier.predict-140"><a href="#SimpleMultitaskClassifier.predict-140"><span class="linenos">140</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SimpleMultitaskClassifier.predict-141"><a href="#SimpleMultitaskClassifier.predict-141"><span class="linenos">141</span></a>
</span><span id="SimpleMultitaskClassifier.predict-142"><a href="#SimpleMultitaskClassifier.predict-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters
</code></pre>

<p>Returns:</p>

<pre><code>model predictions: {array-like}
</code></pre>
</div>


                                </div>
                                <div id="SimpleMultitaskClassifier.predict_proba" class="classattr">
                                            <input id="SimpleMultitaskClassifier.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SimpleMultitaskClassifier.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SimpleMultitaskClassifier.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SimpleMultitaskClassifier.predict_proba-144"><a href="#SimpleMultitaskClassifier.predict_proba-144"><span class="linenos">144</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-145"><a href="#SimpleMultitaskClassifier.predict_proba-145"><span class="linenos">145</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probabilities for test data X.</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-146"><a href="#SimpleMultitaskClassifier.predict_proba-146"><span class="linenos">146</span></a>
</span><span id="SimpleMultitaskClassifier.predict_proba-147"><a href="#SimpleMultitaskClassifier.predict_proba-147"><span class="linenos">147</span></a><span class="sd">        Args:</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-148"><a href="#SimpleMultitaskClassifier.predict_proba-148"><span class="linenos">148</span></a>
</span><span id="SimpleMultitaskClassifier.predict_proba-149"><a href="#SimpleMultitaskClassifier.predict_proba-149"><span class="linenos">149</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-150"><a href="#SimpleMultitaskClassifier.predict_proba-150"><span class="linenos">150</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-151"><a href="#SimpleMultitaskClassifier.predict_proba-151"><span class="linenos">151</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-152"><a href="#SimpleMultitaskClassifier.predict_proba-152"><span class="linenos">152</span></a>
</span><span id="SimpleMultitaskClassifier.predict_proba-153"><a href="#SimpleMultitaskClassifier.predict_proba-153"><span class="linenos">153</span></a><span class="sd">            **kwargs: additional parameters</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-154"><a href="#SimpleMultitaskClassifier.predict_proba-154"><span class="linenos">154</span></a>
</span><span id="SimpleMultitaskClassifier.predict_proba-155"><a href="#SimpleMultitaskClassifier.predict_proba-155"><span class="linenos">155</span></a><span class="sd">        Returns:</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-156"><a href="#SimpleMultitaskClassifier.predict_proba-156"><span class="linenos">156</span></a>
</span><span id="SimpleMultitaskClassifier.predict_proba-157"><a href="#SimpleMultitaskClassifier.predict_proba-157"><span class="linenos">157</span></a><span class="sd">            probability estimates for test data: {array-like}</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-158"><a href="#SimpleMultitaskClassifier.predict_proba-158"><span class="linenos">158</span></a>
</span><span id="SimpleMultitaskClassifier.predict_proba-159"><a href="#SimpleMultitaskClassifier.predict_proba-159"><span class="linenos">159</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-160"><a href="#SimpleMultitaskClassifier.predict_proba-160"><span class="linenos">160</span></a>
</span><span id="SimpleMultitaskClassifier.predict_proba-161"><a href="#SimpleMultitaskClassifier.predict_proba-161"><span class="linenos">161</span></a>        <span class="n">shape_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-162"><a href="#SimpleMultitaskClassifier.predict_proba-162"><span class="linenos">162</span></a>
</span><span id="SimpleMultitaskClassifier.predict_proba-163"><a href="#SimpleMultitaskClassifier.predict_proba-163"><span class="linenos">163</span></a>        <span class="n">probs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">shape_X</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">))</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-164"><a href="#SimpleMultitaskClassifier.predict_proba-164"><span class="linenos">164</span></a>
</span><span id="SimpleMultitaskClassifier.predict_proba-165"><a href="#SimpleMultitaskClassifier.predict_proba-165"><span class="linenos">165</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape_X</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-166"><a href="#SimpleMultitaskClassifier.predict_proba-166"><span class="linenos">166</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">shape_X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-167"><a href="#SimpleMultitaskClassifier.predict_proba-167"><span class="linenos">167</span></a>
</span><span id="SimpleMultitaskClassifier.predict_proba-168"><a href="#SimpleMultitaskClassifier.predict_proba-168"><span class="linenos">168</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-169"><a href="#SimpleMultitaskClassifier.predict_proba-169"><span class="linenos">169</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-170"><a href="#SimpleMultitaskClassifier.predict_proba-170"><span class="linenos">170</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-171"><a href="#SimpleMultitaskClassifier.predict_proba-171"><span class="linenos">171</span></a>            <span class="p">)</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-172"><a href="#SimpleMultitaskClassifier.predict_proba-172"><span class="linenos">172</span></a>
</span><span id="SimpleMultitaskClassifier.predict_proba-173"><a href="#SimpleMultitaskClassifier.predict_proba-173"><span class="linenos">173</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-174"><a href="#SimpleMultitaskClassifier.predict_proba-174"><span class="linenos">174</span></a>
</span><span id="SimpleMultitaskClassifier.predict_proba-175"><a href="#SimpleMultitaskClassifier.predict_proba-175"><span class="linenos">175</span></a>            <span class="c1"># loop on all the classes</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-176"><a href="#SimpleMultitaskClassifier.predict_proba-176"><span class="linenos">176</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">):</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-177"><a href="#SimpleMultitaskClassifier.predict_proba-177"><span class="linenos">177</span></a>                <span class="n">probs</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-178"><a href="#SimpleMultitaskClassifier.predict_proba-178"><span class="linenos">178</span></a>
</span><span id="SimpleMultitaskClassifier.predict_proba-179"><a href="#SimpleMultitaskClassifier.predict_proba-179"><span class="linenos">179</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-180"><a href="#SimpleMultitaskClassifier.predict_proba-180"><span class="linenos">180</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_scaler_</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-181"><a href="#SimpleMultitaskClassifier.predict_proba-181"><span class="linenos">181</span></a>
</span><span id="SimpleMultitaskClassifier.predict_proba-182"><a href="#SimpleMultitaskClassifier.predict_proba-182"><span class="linenos">182</span></a>            <span class="c1"># loop on all the classes</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-183"><a href="#SimpleMultitaskClassifier.predict_proba-183"><span class="linenos">183</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span><span class="p">):</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-184"><a href="#SimpleMultitaskClassifier.predict_proba-184"><span class="linenos">184</span></a>                <span class="n">probs</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fit_objs_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-185"><a href="#SimpleMultitaskClassifier.predict_proba-185"><span class="linenos">185</span></a>
</span><span id="SimpleMultitaskClassifier.predict_proba-186"><a href="#SimpleMultitaskClassifier.predict_proba-186"><span class="linenos">186</span></a>        <span class="n">expit_raw_probs</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>
</span><span id="SimpleMultitaskClassifier.predict_proba-187"><a href="#SimpleMultitaskClassifier.predict_proba-187"><span class="linenos">187</span></a>
</span><span id="SimpleMultitaskClassifier.predict_proba-188"><a href="#SimpleMultitaskClassifier.predict_proba-188"><span class="linenos">188</span></a>        <span class="k">return</span> <span class="n">expit_raw_probs</span> <span class="o">/</span> <span class="n">expit_raw_probs</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Predict probabilities for test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters
</code></pre>

<p>Returns:</p>

<pre><code>probability estimates for test data: {array-like}
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="Optimizer">
                            <input id="Optimizer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Optimizer</span>:

                <label class="view-source-button" for="Optimizer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Optimizer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Optimizer-9"><a href="#Optimizer-9"><span class="linenos">  9</span></a><span class="k">class</span> <span class="nc">Optimizer</span><span class="p">:</span>
</span><span id="Optimizer-10"><a href="#Optimizer-10"><span class="linenos"> 10</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Optimizer class</span>
</span><span id="Optimizer-11"><a href="#Optimizer-11"><span class="linenos"> 11</span></a>
</span><span id="Optimizer-12"><a href="#Optimizer-12"><span class="linenos"> 12</span></a><span class="sd">    Attributes:</span>
</span><span id="Optimizer-13"><a href="#Optimizer-13"><span class="linenos"> 13</span></a>
</span><span id="Optimizer-14"><a href="#Optimizer-14"><span class="linenos"> 14</span></a><span class="sd">        type_optim: str</span>
</span><span id="Optimizer-15"><a href="#Optimizer-15"><span class="linenos"> 15</span></a><span class="sd">            type of optimizer, (currently) either &#39;sgd&#39; (stochastic minibatch gradient descent)</span>
</span><span id="Optimizer-16"><a href="#Optimizer-16"><span class="linenos"> 16</span></a><span class="sd">            or &#39;scd&#39; (stochastic minibatch coordinate descent)</span>
</span><span id="Optimizer-17"><a href="#Optimizer-17"><span class="linenos"> 17</span></a>
</span><span id="Optimizer-18"><a href="#Optimizer-18"><span class="linenos"> 18</span></a><span class="sd">        num_iters: int</span>
</span><span id="Optimizer-19"><a href="#Optimizer-19"><span class="linenos"> 19</span></a><span class="sd">            number of iterations of the optimizer</span>
</span><span id="Optimizer-20"><a href="#Optimizer-20"><span class="linenos"> 20</span></a>
</span><span id="Optimizer-21"><a href="#Optimizer-21"><span class="linenos"> 21</span></a><span class="sd">        learning_rate: float</span>
</span><span id="Optimizer-22"><a href="#Optimizer-22"><span class="linenos"> 22</span></a><span class="sd">            step size</span>
</span><span id="Optimizer-23"><a href="#Optimizer-23"><span class="linenos"> 23</span></a>
</span><span id="Optimizer-24"><a href="#Optimizer-24"><span class="linenos"> 24</span></a><span class="sd">        batch_prop: float</span>
</span><span id="Optimizer-25"><a href="#Optimizer-25"><span class="linenos"> 25</span></a><span class="sd">            proportion of the initial data used at each optimization step</span>
</span><span id="Optimizer-26"><a href="#Optimizer-26"><span class="linenos"> 26</span></a>
</span><span id="Optimizer-27"><a href="#Optimizer-27"><span class="linenos"> 27</span></a><span class="sd">        learning_method: str</span>
</span><span id="Optimizer-28"><a href="#Optimizer-28"><span class="linenos"> 28</span></a><span class="sd">            &quot;poly&quot; - learning rate decreasing as a polynomial function</span>
</span><span id="Optimizer-29"><a href="#Optimizer-29"><span class="linenos"> 29</span></a><span class="sd">            of # of iterations (default)</span>
</span><span id="Optimizer-30"><a href="#Optimizer-30"><span class="linenos"> 30</span></a><span class="sd">            &quot;exp&quot; - learning rate decreasing as an exponential function</span>
</span><span id="Optimizer-31"><a href="#Optimizer-31"><span class="linenos"> 31</span></a><span class="sd">            of # of iterations</span>
</span><span id="Optimizer-32"><a href="#Optimizer-32"><span class="linenos"> 32</span></a><span class="sd">            &quot;momentum&quot; - gradient descent using momentum</span>
</span><span id="Optimizer-33"><a href="#Optimizer-33"><span class="linenos"> 33</span></a>
</span><span id="Optimizer-34"><a href="#Optimizer-34"><span class="linenos"> 34</span></a><span class="sd">        randomization: str</span>
</span><span id="Optimizer-35"><a href="#Optimizer-35"><span class="linenos"> 35</span></a><span class="sd">            type of randomization applied at each step</span>
</span><span id="Optimizer-36"><a href="#Optimizer-36"><span class="linenos"> 36</span></a><span class="sd">            &quot;strat&quot; - stratified subsampling (default)</span>
</span><span id="Optimizer-37"><a href="#Optimizer-37"><span class="linenos"> 37</span></a><span class="sd">            &quot;shuffle&quot; - random subsampling</span>
</span><span id="Optimizer-38"><a href="#Optimizer-38"><span class="linenos"> 38</span></a>
</span><span id="Optimizer-39"><a href="#Optimizer-39"><span class="linenos"> 39</span></a><span class="sd">        mass: float</span>
</span><span id="Optimizer-40"><a href="#Optimizer-40"><span class="linenos"> 40</span></a><span class="sd">            mass on velocity, for `method` == &quot;momentum&quot;</span>
</span><span id="Optimizer-41"><a href="#Optimizer-41"><span class="linenos"> 41</span></a>
</span><span id="Optimizer-42"><a href="#Optimizer-42"><span class="linenos"> 42</span></a><span class="sd">        decay: float</span>
</span><span id="Optimizer-43"><a href="#Optimizer-43"><span class="linenos"> 43</span></a><span class="sd">            coefficient of decrease of the learning rate for</span>
</span><span id="Optimizer-44"><a href="#Optimizer-44"><span class="linenos"> 44</span></a><span class="sd">            `method` == &quot;poly&quot; and `method` == &quot;exp&quot;</span>
</span><span id="Optimizer-45"><a href="#Optimizer-45"><span class="linenos"> 45</span></a>
</span><span id="Optimizer-46"><a href="#Optimizer-46"><span class="linenos"> 46</span></a><span class="sd">        tolerance: float</span>
</span><span id="Optimizer-47"><a href="#Optimizer-47"><span class="linenos"> 47</span></a><span class="sd">            early stopping parameter (convergence of loss function)</span>
</span><span id="Optimizer-48"><a href="#Optimizer-48"><span class="linenos"> 48</span></a>
</span><span id="Optimizer-49"><a href="#Optimizer-49"><span class="linenos"> 49</span></a><span class="sd">        verbose: int</span>
</span><span id="Optimizer-50"><a href="#Optimizer-50"><span class="linenos"> 50</span></a><span class="sd">            controls verbosity of gradient descent</span>
</span><span id="Optimizer-51"><a href="#Optimizer-51"><span class="linenos"> 51</span></a><span class="sd">            0 - nothing is printed</span>
</span><span id="Optimizer-52"><a href="#Optimizer-52"><span class="linenos"> 52</span></a><span class="sd">            1 - a progress bar is printed</span>
</span><span id="Optimizer-53"><a href="#Optimizer-53"><span class="linenos"> 53</span></a><span class="sd">            2 - successive loss function values are printed</span>
</span><span id="Optimizer-54"><a href="#Optimizer-54"><span class="linenos"> 54</span></a>
</span><span id="Optimizer-55"><a href="#Optimizer-55"><span class="linenos"> 55</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Optimizer-56"><a href="#Optimizer-56"><span class="linenos"> 56</span></a>
</span><span id="Optimizer-57"><a href="#Optimizer-57"><span class="linenos"> 57</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="Optimizer-58"><a href="#Optimizer-58"><span class="linenos"> 58</span></a>
</span><span id="Optimizer-59"><a href="#Optimizer-59"><span class="linenos"> 59</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Optimizer-60"><a href="#Optimizer-60"><span class="linenos"> 60</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Optimizer-61"><a href="#Optimizer-61"><span class="linenos"> 61</span></a>        <span class="n">type_optim</span><span class="o">=</span><span class="s2">&quot;sgd&quot;</span><span class="p">,</span>
</span><span id="Optimizer-62"><a href="#Optimizer-62"><span class="linenos"> 62</span></a>        <span class="n">num_iters</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
</span><span id="Optimizer-63"><a href="#Optimizer-63"><span class="linenos"> 63</span></a>        <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="Optimizer-64"><a href="#Optimizer-64"><span class="linenos"> 64</span></a>        <span class="n">batch_prop</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
</span><span id="Optimizer-65"><a href="#Optimizer-65"><span class="linenos"> 65</span></a>        <span class="n">learning_method</span><span class="o">=</span><span class="s2">&quot;momentum&quot;</span><span class="p">,</span>
</span><span id="Optimizer-66"><a href="#Optimizer-66"><span class="linenos"> 66</span></a>        <span class="n">randomization</span><span class="o">=</span><span class="s2">&quot;strat&quot;</span><span class="p">,</span>
</span><span id="Optimizer-67"><a href="#Optimizer-67"><span class="linenos"> 67</span></a>        <span class="n">mass</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
</span><span id="Optimizer-68"><a href="#Optimizer-68"><span class="linenos"> 68</span></a>        <span class="n">decay</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="Optimizer-69"><a href="#Optimizer-69"><span class="linenos"> 69</span></a>        <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
</span><span id="Optimizer-70"><a href="#Optimizer-70"><span class="linenos"> 70</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Optimizer-71"><a href="#Optimizer-71"><span class="linenos"> 71</span></a>    <span class="p">):</span>
</span><span id="Optimizer-72"><a href="#Optimizer-72"><span class="linenos"> 72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_optim</span> <span class="o">=</span> <span class="n">type_optim</span>
</span><span id="Optimizer-73"><a href="#Optimizer-73"><span class="linenos"> 73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">num_iters</span> <span class="o">=</span> <span class="n">num_iters</span>
</span><span id="Optimizer-74"><a href="#Optimizer-74"><span class="linenos"> 74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">learning_rate</span>
</span><span id="Optimizer-75"><a href="#Optimizer-75"><span class="linenos"> 75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">batch_prop</span> <span class="o">=</span> <span class="n">batch_prop</span>
</span><span id="Optimizer-76"><a href="#Optimizer-76"><span class="linenos"> 76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">learning_method</span> <span class="o">=</span> <span class="n">learning_method</span>
</span><span id="Optimizer-77"><a href="#Optimizer-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">randomization</span> <span class="o">=</span> <span class="n">randomization</span>
</span><span id="Optimizer-78"><a href="#Optimizer-78"><span class="linenos"> 78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="n">mass</span>
</span><span id="Optimizer-79"><a href="#Optimizer-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">decay</span> <span class="o">=</span> <span class="n">decay</span>
</span><span id="Optimizer-80"><a href="#Optimizer-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="n">tolerance</span>
</span><span id="Optimizer-81"><a href="#Optimizer-81"><span class="linenos"> 81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="Optimizer-82"><a href="#Optimizer-82"><span class="linenos"> 82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">opt</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Optimizer-83"><a href="#Optimizer-83"><span class="linenos"> 83</span></a>
</span><span id="Optimizer-84"><a href="#Optimizer-84"><span class="linenos"> 84</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loss_func</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Optimizer-85"><a href="#Optimizer-85"><span class="linenos"> 85</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit GLM model to training data (X, y).</span>
</span><span id="Optimizer-86"><a href="#Optimizer-86"><span class="linenos"> 86</span></a>
</span><span id="Optimizer-87"><a href="#Optimizer-87"><span class="linenos"> 87</span></a><span class="sd">        Args:</span>
</span><span id="Optimizer-88"><a href="#Optimizer-88"><span class="linenos"> 88</span></a>
</span><span id="Optimizer-89"><a href="#Optimizer-89"><span class="linenos"> 89</span></a><span class="sd">            loss_func: loss function</span>
</span><span id="Optimizer-90"><a href="#Optimizer-90"><span class="linenos"> 90</span></a>
</span><span id="Optimizer-91"><a href="#Optimizer-91"><span class="linenos"> 91</span></a><span class="sd">            response: array-like, shape = [n_samples]</span>
</span><span id="Optimizer-92"><a href="#Optimizer-92"><span class="linenos"> 92</span></a><span class="sd">            target variable (used for subsampling)</span>
</span><span id="Optimizer-93"><a href="#Optimizer-93"><span class="linenos"> 93</span></a>
</span><span id="Optimizer-94"><a href="#Optimizer-94"><span class="linenos"> 94</span></a><span class="sd">            x0: array-like, shape = [n_features]</span>
</span><span id="Optimizer-95"><a href="#Optimizer-95"><span class="linenos"> 95</span></a><span class="sd">                initial value provided to the optimizer</span>
</span><span id="Optimizer-96"><a href="#Optimizer-96"><span class="linenos"> 96</span></a>
</span><span id="Optimizer-97"><a href="#Optimizer-97"><span class="linenos"> 97</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Optimizer-98"><a href="#Optimizer-98"><span class="linenos"> 98</span></a><span class="sd">                    loss function</span>
</span><span id="Optimizer-99"><a href="#Optimizer-99"><span class="linenos"> 99</span></a>
</span><span id="Optimizer-100"><a href="#Optimizer-100"><span class="linenos">100</span></a><span class="sd">        Returns:</span>
</span><span id="Optimizer-101"><a href="#Optimizer-101"><span class="linenos">101</span></a>
</span><span id="Optimizer-102"><a href="#Optimizer-102"><span class="linenos">102</span></a><span class="sd">            self: object</span>
</span><span id="Optimizer-103"><a href="#Optimizer-103"><span class="linenos">103</span></a>
</span><span id="Optimizer-104"><a href="#Optimizer-104"><span class="linenos">104</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Optimizer-105"><a href="#Optimizer-105"><span class="linenos">105</span></a>
</span><span id="Optimizer-106"><a href="#Optimizer-106"><span class="linenos">106</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_optim</span> <span class="o">==</span> <span class="s2">&quot;scd&quot;</span><span class="p">:</span>
</span><span id="Optimizer-107"><a href="#Optimizer-107"><span class="linenos">107</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">scd</span><span class="p">(</span>
</span><span id="Optimizer-108"><a href="#Optimizer-108"><span class="linenos">108</span></a>                <span class="n">loss_func</span><span class="p">,</span>
</span><span id="Optimizer-109"><a href="#Optimizer-109"><span class="linenos">109</span></a>                <span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span>
</span><span id="Optimizer-110"><a href="#Optimizer-110"><span class="linenos">110</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span>
</span><span id="Optimizer-111"><a href="#Optimizer-111"><span class="linenos">111</span></a>                <span class="n">num_iters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_iters</span><span class="p">,</span>
</span><span id="Optimizer-112"><a href="#Optimizer-112"><span class="linenos">112</span></a>                <span class="n">batch_prop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_prop</span><span class="p">,</span>
</span><span id="Optimizer-113"><a href="#Optimizer-113"><span class="linenos">113</span></a>                <span class="n">learning_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span><span class="p">,</span>
</span><span id="Optimizer-114"><a href="#Optimizer-114"><span class="linenos">114</span></a>                <span class="n">learning_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_method</span><span class="p">,</span>
</span><span id="Optimizer-115"><a href="#Optimizer-115"><span class="linenos">115</span></a>                <span class="n">mass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span>
</span><span id="Optimizer-116"><a href="#Optimizer-116"><span class="linenos">116</span></a>                <span class="n">decay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decay</span><span class="p">,</span>
</span><span id="Optimizer-117"><a href="#Optimizer-117"><span class="linenos">117</span></a>                <span class="n">randomization</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">randomization</span><span class="p">,</span>
</span><span id="Optimizer-118"><a href="#Optimizer-118"><span class="linenos">118</span></a>                <span class="n">tolerance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span><span class="p">,</span>
</span><span id="Optimizer-119"><a href="#Optimizer-119"><span class="linenos">119</span></a>                <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="Optimizer-120"><a href="#Optimizer-120"><span class="linenos">120</span></a>                <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Optimizer-121"><a href="#Optimizer-121"><span class="linenos">121</span></a>            <span class="p">)</span>
</span><span id="Optimizer-122"><a href="#Optimizer-122"><span class="linenos">122</span></a>
</span><span id="Optimizer-123"><a href="#Optimizer-123"><span class="linenos">123</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_optim</span> <span class="o">==</span> <span class="s2">&quot;sgd&quot;</span><span class="p">:</span>
</span><span id="Optimizer-124"><a href="#Optimizer-124"><span class="linenos">124</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">sgd</span><span class="p">(</span>
</span><span id="Optimizer-125"><a href="#Optimizer-125"><span class="linenos">125</span></a>                <span class="n">loss_func</span><span class="p">,</span>
</span><span id="Optimizer-126"><a href="#Optimizer-126"><span class="linenos">126</span></a>                <span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span>
</span><span id="Optimizer-127"><a href="#Optimizer-127"><span class="linenos">127</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span>
</span><span id="Optimizer-128"><a href="#Optimizer-128"><span class="linenos">128</span></a>                <span class="n">num_iters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_iters</span><span class="p">,</span>
</span><span id="Optimizer-129"><a href="#Optimizer-129"><span class="linenos">129</span></a>                <span class="n">batch_prop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_prop</span><span class="p">,</span>
</span><span id="Optimizer-130"><a href="#Optimizer-130"><span class="linenos">130</span></a>                <span class="n">learning_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span><span class="p">,</span>
</span><span id="Optimizer-131"><a href="#Optimizer-131"><span class="linenos">131</span></a>                <span class="n">learning_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_method</span><span class="p">,</span>
</span><span id="Optimizer-132"><a href="#Optimizer-132"><span class="linenos">132</span></a>                <span class="n">mass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span>
</span><span id="Optimizer-133"><a href="#Optimizer-133"><span class="linenos">133</span></a>                <span class="n">decay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decay</span><span class="p">,</span>
</span><span id="Optimizer-134"><a href="#Optimizer-134"><span class="linenos">134</span></a>                <span class="n">randomization</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">randomization</span><span class="p">,</span>
</span><span id="Optimizer-135"><a href="#Optimizer-135"><span class="linenos">135</span></a>                <span class="n">tolerance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span><span class="p">,</span>
</span><span id="Optimizer-136"><a href="#Optimizer-136"><span class="linenos">136</span></a>                <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="Optimizer-137"><a href="#Optimizer-137"><span class="linenos">137</span></a>                <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Optimizer-138"><a href="#Optimizer-138"><span class="linenos">138</span></a>            <span class="p">)</span>
</span><span id="Optimizer-139"><a href="#Optimizer-139"><span class="linenos">139</span></a>
</span><span id="Optimizer-140"><a href="#Optimizer-140"><span class="linenos">140</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Optimizer-141"><a href="#Optimizer-141"><span class="linenos">141</span></a>
</span><span id="Optimizer-142"><a href="#Optimizer-142"><span class="linenos">142</span></a>    <span class="k">def</span> <span class="nf">one_hot_encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">):</span>
</span><span id="Optimizer-143"><a href="#Optimizer-143"><span class="linenos">143</span></a>        <span class="k">return</span> <span class="n">one_hot_encode</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Optimizer class</p>

<p>Attributes:</p>

<pre><code>type_optim: str
    type of optimizer, (currently) either 'sgd' (stochastic minibatch gradient descent)
    or 'scd' (stochastic minibatch coordinate descent)

num_iters: int
    number of iterations of the optimizer

learning_rate: float
    step size

batch_prop: float
    proportion of the initial data used at each optimization step

learning_method: str
    "poly" - learning rate decreasing as a polynomial function
    of # of iterations (default)
    "exp" - learning rate decreasing as an exponential function
    of # of iterations
    "momentum" - gradient descent using momentum

randomization: str
    type of randomization applied at each step
    "strat" - stratified subsampling (default)
    "shuffle" - random subsampling

mass: float
    mass on velocity, for `method` == "momentum"

decay: float
    coefficient of decrease of the learning rate for
    `method` == "poly" and `method` == "exp"

tolerance: float
    early stopping parameter (convergence of loss function)

verbose: int
    controls verbosity of gradient descent
    0 - nothing is printed
    1 - a progress bar is printed
    2 - successive loss function values are printed
</code></pre>
</div>


                                <div id="Optimizer.fit" class="classattr">
                                            <input id="Optimizer.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">loss_func</span>, </span><span class="param"><span class="n">response</span>, </span><span class="param"><span class="n">x0</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Optimizer.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Optimizer.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Optimizer.fit-84"><a href="#Optimizer.fit-84"><span class="linenos"> 84</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loss_func</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Optimizer.fit-85"><a href="#Optimizer.fit-85"><span class="linenos"> 85</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit GLM model to training data (X, y).</span>
</span><span id="Optimizer.fit-86"><a href="#Optimizer.fit-86"><span class="linenos"> 86</span></a>
</span><span id="Optimizer.fit-87"><a href="#Optimizer.fit-87"><span class="linenos"> 87</span></a><span class="sd">        Args:</span>
</span><span id="Optimizer.fit-88"><a href="#Optimizer.fit-88"><span class="linenos"> 88</span></a>
</span><span id="Optimizer.fit-89"><a href="#Optimizer.fit-89"><span class="linenos"> 89</span></a><span class="sd">            loss_func: loss function</span>
</span><span id="Optimizer.fit-90"><a href="#Optimizer.fit-90"><span class="linenos"> 90</span></a>
</span><span id="Optimizer.fit-91"><a href="#Optimizer.fit-91"><span class="linenos"> 91</span></a><span class="sd">            response: array-like, shape = [n_samples]</span>
</span><span id="Optimizer.fit-92"><a href="#Optimizer.fit-92"><span class="linenos"> 92</span></a><span class="sd">            target variable (used for subsampling)</span>
</span><span id="Optimizer.fit-93"><a href="#Optimizer.fit-93"><span class="linenos"> 93</span></a>
</span><span id="Optimizer.fit-94"><a href="#Optimizer.fit-94"><span class="linenos"> 94</span></a><span class="sd">            x0: array-like, shape = [n_features]</span>
</span><span id="Optimizer.fit-95"><a href="#Optimizer.fit-95"><span class="linenos"> 95</span></a><span class="sd">                initial value provided to the optimizer</span>
</span><span id="Optimizer.fit-96"><a href="#Optimizer.fit-96"><span class="linenos"> 96</span></a>
</span><span id="Optimizer.fit-97"><a href="#Optimizer.fit-97"><span class="linenos"> 97</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Optimizer.fit-98"><a href="#Optimizer.fit-98"><span class="linenos"> 98</span></a><span class="sd">                    loss function</span>
</span><span id="Optimizer.fit-99"><a href="#Optimizer.fit-99"><span class="linenos"> 99</span></a>
</span><span id="Optimizer.fit-100"><a href="#Optimizer.fit-100"><span class="linenos">100</span></a><span class="sd">        Returns:</span>
</span><span id="Optimizer.fit-101"><a href="#Optimizer.fit-101"><span class="linenos">101</span></a>
</span><span id="Optimizer.fit-102"><a href="#Optimizer.fit-102"><span class="linenos">102</span></a><span class="sd">            self: object</span>
</span><span id="Optimizer.fit-103"><a href="#Optimizer.fit-103"><span class="linenos">103</span></a>
</span><span id="Optimizer.fit-104"><a href="#Optimizer.fit-104"><span class="linenos">104</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Optimizer.fit-105"><a href="#Optimizer.fit-105"><span class="linenos">105</span></a>
</span><span id="Optimizer.fit-106"><a href="#Optimizer.fit-106"><span class="linenos">106</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_optim</span> <span class="o">==</span> <span class="s2">&quot;scd&quot;</span><span class="p">:</span>
</span><span id="Optimizer.fit-107"><a href="#Optimizer.fit-107"><span class="linenos">107</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">scd</span><span class="p">(</span>
</span><span id="Optimizer.fit-108"><a href="#Optimizer.fit-108"><span class="linenos">108</span></a>                <span class="n">loss_func</span><span class="p">,</span>
</span><span id="Optimizer.fit-109"><a href="#Optimizer.fit-109"><span class="linenos">109</span></a>                <span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span>
</span><span id="Optimizer.fit-110"><a href="#Optimizer.fit-110"><span class="linenos">110</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span>
</span><span id="Optimizer.fit-111"><a href="#Optimizer.fit-111"><span class="linenos">111</span></a>                <span class="n">num_iters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_iters</span><span class="p">,</span>
</span><span id="Optimizer.fit-112"><a href="#Optimizer.fit-112"><span class="linenos">112</span></a>                <span class="n">batch_prop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_prop</span><span class="p">,</span>
</span><span id="Optimizer.fit-113"><a href="#Optimizer.fit-113"><span class="linenos">113</span></a>                <span class="n">learning_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span><span class="p">,</span>
</span><span id="Optimizer.fit-114"><a href="#Optimizer.fit-114"><span class="linenos">114</span></a>                <span class="n">learning_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_method</span><span class="p">,</span>
</span><span id="Optimizer.fit-115"><a href="#Optimizer.fit-115"><span class="linenos">115</span></a>                <span class="n">mass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span>
</span><span id="Optimizer.fit-116"><a href="#Optimizer.fit-116"><span class="linenos">116</span></a>                <span class="n">decay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decay</span><span class="p">,</span>
</span><span id="Optimizer.fit-117"><a href="#Optimizer.fit-117"><span class="linenos">117</span></a>                <span class="n">randomization</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">randomization</span><span class="p">,</span>
</span><span id="Optimizer.fit-118"><a href="#Optimizer.fit-118"><span class="linenos">118</span></a>                <span class="n">tolerance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span><span class="p">,</span>
</span><span id="Optimizer.fit-119"><a href="#Optimizer.fit-119"><span class="linenos">119</span></a>                <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="Optimizer.fit-120"><a href="#Optimizer.fit-120"><span class="linenos">120</span></a>                <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Optimizer.fit-121"><a href="#Optimizer.fit-121"><span class="linenos">121</span></a>            <span class="p">)</span>
</span><span id="Optimizer.fit-122"><a href="#Optimizer.fit-122"><span class="linenos">122</span></a>
</span><span id="Optimizer.fit-123"><a href="#Optimizer.fit-123"><span class="linenos">123</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_optim</span> <span class="o">==</span> <span class="s2">&quot;sgd&quot;</span><span class="p">:</span>
</span><span id="Optimizer.fit-124"><a href="#Optimizer.fit-124"><span class="linenos">124</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">sgd</span><span class="p">(</span>
</span><span id="Optimizer.fit-125"><a href="#Optimizer.fit-125"><span class="linenos">125</span></a>                <span class="n">loss_func</span><span class="p">,</span>
</span><span id="Optimizer.fit-126"><a href="#Optimizer.fit-126"><span class="linenos">126</span></a>                <span class="n">response</span><span class="o">=</span><span class="n">response</span><span class="p">,</span>
</span><span id="Optimizer.fit-127"><a href="#Optimizer.fit-127"><span class="linenos">127</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span>
</span><span id="Optimizer.fit-128"><a href="#Optimizer.fit-128"><span class="linenos">128</span></a>                <span class="n">num_iters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_iters</span><span class="p">,</span>
</span><span id="Optimizer.fit-129"><a href="#Optimizer.fit-129"><span class="linenos">129</span></a>                <span class="n">batch_prop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_prop</span><span class="p">,</span>
</span><span id="Optimizer.fit-130"><a href="#Optimizer.fit-130"><span class="linenos">130</span></a>                <span class="n">learning_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span><span class="p">,</span>
</span><span id="Optimizer.fit-131"><a href="#Optimizer.fit-131"><span class="linenos">131</span></a>                <span class="n">learning_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">learning_method</span><span class="p">,</span>
</span><span id="Optimizer.fit-132"><a href="#Optimizer.fit-132"><span class="linenos">132</span></a>                <span class="n">mass</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span>
</span><span id="Optimizer.fit-133"><a href="#Optimizer.fit-133"><span class="linenos">133</span></a>                <span class="n">decay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">decay</span><span class="p">,</span>
</span><span id="Optimizer.fit-134"><a href="#Optimizer.fit-134"><span class="linenos">134</span></a>                <span class="n">randomization</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">randomization</span><span class="p">,</span>
</span><span id="Optimizer.fit-135"><a href="#Optimizer.fit-135"><span class="linenos">135</span></a>                <span class="n">tolerance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span><span class="p">,</span>
</span><span id="Optimizer.fit-136"><a href="#Optimizer.fit-136"><span class="linenos">136</span></a>                <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="Optimizer.fit-137"><a href="#Optimizer.fit-137"><span class="linenos">137</span></a>                <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Optimizer.fit-138"><a href="#Optimizer.fit-138"><span class="linenos">138</span></a>            <span class="p">)</span>
</span><span id="Optimizer.fit-139"><a href="#Optimizer.fit-139"><span class="linenos">139</span></a>
</span><span id="Optimizer.fit-140"><a href="#Optimizer.fit-140"><span class="linenos">140</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit GLM model to training data (X, y).</p>

<p>Args:</p>

<pre><code>loss_func: loss function

response: array-like, shape = [n_samples]
target variable (used for subsampling)

x0: array-like, shape = [n_features]
    initial value provided to the optimizer

**kwargs: additional parameters to be passed to
        loss function
</code></pre>

<p>Returns:</p>

<pre><code>self: object
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="RandomBagRegressor">
                            <input id="RandomBagRegressor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">RandomBagRegressor</span><wbr>(<span class="base">nnetsauce.randombag.bag.RandomBag</span>, <span class="base">sklearn.base.RegressorMixin</span>):

                <label class="view-source-button" for="RandomBagRegressor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RandomBagRegressor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RandomBagRegressor-18"><a href="#RandomBagRegressor-18"><span class="linenos"> 18</span></a><span class="k">class</span> <span class="nc">RandomBagRegressor</span><span class="p">(</span><span class="n">RandomBag</span><span class="p">,</span> <span class="n">RegressorMixin</span><span class="p">):</span>
</span><span id="RandomBagRegressor-19"><a href="#RandomBagRegressor-19"><span class="linenos"> 19</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Randomized &#39;Bagging&#39; Regression model</span>
</span><span id="RandomBagRegressor-20"><a href="#RandomBagRegressor-20"><span class="linenos"> 20</span></a>
</span><span id="RandomBagRegressor-21"><a href="#RandomBagRegressor-21"><span class="linenos"> 21</span></a><span class="sd">    Parameters:</span>
</span><span id="RandomBagRegressor-22"><a href="#RandomBagRegressor-22"><span class="linenos"> 22</span></a>
</span><span id="RandomBagRegressor-23"><a href="#RandomBagRegressor-23"><span class="linenos"> 23</span></a><span class="sd">        obj: object</span>
</span><span id="RandomBagRegressor-24"><a href="#RandomBagRegressor-24"><span class="linenos"> 24</span></a><span class="sd">            any object containing a method fit (obj.fit()) and a method predict</span>
</span><span id="RandomBagRegressor-25"><a href="#RandomBagRegressor-25"><span class="linenos"> 25</span></a><span class="sd">            (obj.predict())</span>
</span><span id="RandomBagRegressor-26"><a href="#RandomBagRegressor-26"><span class="linenos"> 26</span></a>
</span><span id="RandomBagRegressor-27"><a href="#RandomBagRegressor-27"><span class="linenos"> 27</span></a><span class="sd">        n_estimators: int</span>
</span><span id="RandomBagRegressor-28"><a href="#RandomBagRegressor-28"><span class="linenos"> 28</span></a><span class="sd">            number of boosting iterations</span>
</span><span id="RandomBagRegressor-29"><a href="#RandomBagRegressor-29"><span class="linenos"> 29</span></a>
</span><span id="RandomBagRegressor-30"><a href="#RandomBagRegressor-30"><span class="linenos"> 30</span></a><span class="sd">        n_hidden_features: int</span>
</span><span id="RandomBagRegressor-31"><a href="#RandomBagRegressor-31"><span class="linenos"> 31</span></a><span class="sd">            number of nodes in the hidden layer</span>
</span><span id="RandomBagRegressor-32"><a href="#RandomBagRegressor-32"><span class="linenos"> 32</span></a>
</span><span id="RandomBagRegressor-33"><a href="#RandomBagRegressor-33"><span class="linenos"> 33</span></a><span class="sd">        activation_name: str</span>
</span><span id="RandomBagRegressor-34"><a href="#RandomBagRegressor-34"><span class="linenos"> 34</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;</span>
</span><span id="RandomBagRegressor-35"><a href="#RandomBagRegressor-35"><span class="linenos"> 35</span></a>
</span><span id="RandomBagRegressor-36"><a href="#RandomBagRegressor-36"><span class="linenos"> 36</span></a><span class="sd">        a: float</span>
</span><span id="RandomBagRegressor-37"><a href="#RandomBagRegressor-37"><span class="linenos"> 37</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function</span>
</span><span id="RandomBagRegressor-38"><a href="#RandomBagRegressor-38"><span class="linenos"> 38</span></a>
</span><span id="RandomBagRegressor-39"><a href="#RandomBagRegressor-39"><span class="linenos"> 39</span></a><span class="sd">        nodes_sim: str</span>
</span><span id="RandomBagRegressor-40"><a href="#RandomBagRegressor-40"><span class="linenos"> 40</span></a><span class="sd">            type of simulation for the nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;,</span>
</span><span id="RandomBagRegressor-41"><a href="#RandomBagRegressor-41"><span class="linenos"> 41</span></a><span class="sd">            &#39;uniform&#39;</span>
</span><span id="RandomBagRegressor-42"><a href="#RandomBagRegressor-42"><span class="linenos"> 42</span></a>
</span><span id="RandomBagRegressor-43"><a href="#RandomBagRegressor-43"><span class="linenos"> 43</span></a><span class="sd">        bias: boolean</span>
</span><span id="RandomBagRegressor-44"><a href="#RandomBagRegressor-44"><span class="linenos"> 44</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or not</span>
</span><span id="RandomBagRegressor-45"><a href="#RandomBagRegressor-45"><span class="linenos"> 45</span></a><span class="sd">            (False)</span>
</span><span id="RandomBagRegressor-46"><a href="#RandomBagRegressor-46"><span class="linenos"> 46</span></a>
</span><span id="RandomBagRegressor-47"><a href="#RandomBagRegressor-47"><span class="linenos"> 47</span></a><span class="sd">        dropout: float</span>
</span><span id="RandomBagRegressor-48"><a href="#RandomBagRegressor-48"><span class="linenos"> 48</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="RandomBagRegressor-49"><a href="#RandomBagRegressor-49"><span class="linenos"> 49</span></a><span class="sd">            of the training</span>
</span><span id="RandomBagRegressor-50"><a href="#RandomBagRegressor-50"><span class="linenos"> 50</span></a>
</span><span id="RandomBagRegressor-51"><a href="#RandomBagRegressor-51"><span class="linenos"> 51</span></a><span class="sd">        direct_link: boolean</span>
</span><span id="RandomBagRegressor-52"><a href="#RandomBagRegressor-52"><span class="linenos"> 52</span></a><span class="sd">            indicates if the original predictors are included (True) in model&#39;&#39;s</span>
</span><span id="RandomBagRegressor-53"><a href="#RandomBagRegressor-53"><span class="linenos"> 53</span></a><span class="sd">            fitting or not (False)</span>
</span><span id="RandomBagRegressor-54"><a href="#RandomBagRegressor-54"><span class="linenos"> 54</span></a>
</span><span id="RandomBagRegressor-55"><a href="#RandomBagRegressor-55"><span class="linenos"> 55</span></a><span class="sd">        n_clusters: int</span>
</span><span id="RandomBagRegressor-56"><a href="#RandomBagRegressor-56"><span class="linenos"> 56</span></a><span class="sd">            number of clusters for &#39;kmeans&#39; or &#39;gmm&#39; clustering (could be 0:</span>
</span><span id="RandomBagRegressor-57"><a href="#RandomBagRegressor-57"><span class="linenos"> 57</span></a><span class="sd">                no clustering)</span>
</span><span id="RandomBagRegressor-58"><a href="#RandomBagRegressor-58"><span class="linenos"> 58</span></a>
</span><span id="RandomBagRegressor-59"><a href="#RandomBagRegressor-59"><span class="linenos"> 59</span></a><span class="sd">        cluster_encode: bool</span>
</span><span id="RandomBagRegressor-60"><a href="#RandomBagRegressor-60"><span class="linenos"> 60</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot)</span>
</span><span id="RandomBagRegressor-61"><a href="#RandomBagRegressor-61"><span class="linenos"> 61</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding</span>
</span><span id="RandomBagRegressor-62"><a href="#RandomBagRegressor-62"><span class="linenos"> 62</span></a>
</span><span id="RandomBagRegressor-63"><a href="#RandomBagRegressor-63"><span class="linenos"> 63</span></a><span class="sd">        type_clust: str</span>
</span><span id="RandomBagRegressor-64"><a href="#RandomBagRegressor-64"><span class="linenos"> 64</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian</span>
</span><span id="RandomBagRegressor-65"><a href="#RandomBagRegressor-65"><span class="linenos"> 65</span></a><span class="sd">            Mixture Model (&#39;gmm&#39;)</span>
</span><span id="RandomBagRegressor-66"><a href="#RandomBagRegressor-66"><span class="linenos"> 66</span></a>
</span><span id="RandomBagRegressor-67"><a href="#RandomBagRegressor-67"><span class="linenos"> 67</span></a><span class="sd">        type_scaling: a tuple of 3 strings</span>
</span><span id="RandomBagRegressor-68"><a href="#RandomBagRegressor-68"><span class="linenos"> 68</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="RandomBagRegressor-69"><a href="#RandomBagRegressor-69"><span class="linenos"> 69</span></a><span class="sd">            (and when relevant).</span>
</span><span id="RandomBagRegressor-70"><a href="#RandomBagRegressor-70"><span class="linenos"> 70</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;)</span>
</span><span id="RandomBagRegressor-71"><a href="#RandomBagRegressor-71"><span class="linenos"> 71</span></a>
</span><span id="RandomBagRegressor-72"><a href="#RandomBagRegressor-72"><span class="linenos"> 72</span></a><span class="sd">        col_sample: float</span>
</span><span id="RandomBagRegressor-73"><a href="#RandomBagRegressor-73"><span class="linenos"> 73</span></a><span class="sd">            percentage of covariates randomly chosen for training</span>
</span><span id="RandomBagRegressor-74"><a href="#RandomBagRegressor-74"><span class="linenos"> 74</span></a>
</span><span id="RandomBagRegressor-75"><a href="#RandomBagRegressor-75"><span class="linenos"> 75</span></a><span class="sd">        row_sample: float</span>
</span><span id="RandomBagRegressor-76"><a href="#RandomBagRegressor-76"><span class="linenos"> 76</span></a><span class="sd">            percentage of rows chosen for training, by stratified bootstrapping</span>
</span><span id="RandomBagRegressor-77"><a href="#RandomBagRegressor-77"><span class="linenos"> 77</span></a>
</span><span id="RandomBagRegressor-78"><a href="#RandomBagRegressor-78"><span class="linenos"> 78</span></a><span class="sd">        seed: int</span>
</span><span id="RandomBagRegressor-79"><a href="#RandomBagRegressor-79"><span class="linenos"> 79</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39;</span>
</span><span id="RandomBagRegressor-80"><a href="#RandomBagRegressor-80"><span class="linenos"> 80</span></a>
</span><span id="RandomBagRegressor-81"><a href="#RandomBagRegressor-81"><span class="linenos"> 81</span></a><span class="sd">        backend: str</span>
</span><span id="RandomBagRegressor-82"><a href="#RandomBagRegressor-82"><span class="linenos"> 82</span></a><span class="sd">            &quot;cpu&quot; or &quot;gpu&quot; or &quot;tpu&quot;</span>
</span><span id="RandomBagRegressor-83"><a href="#RandomBagRegressor-83"><span class="linenos"> 83</span></a>
</span><span id="RandomBagRegressor-84"><a href="#RandomBagRegressor-84"><span class="linenos"> 84</span></a><span class="sd">    Attributes:</span>
</span><span id="RandomBagRegressor-85"><a href="#RandomBagRegressor-85"><span class="linenos"> 85</span></a>
</span><span id="RandomBagRegressor-86"><a href="#RandomBagRegressor-86"><span class="linenos"> 86</span></a><span class="sd">        voter_: dict</span>
</span><span id="RandomBagRegressor-87"><a href="#RandomBagRegressor-87"><span class="linenos"> 87</span></a><span class="sd">            dictionary containing all the fitted base-learners</span>
</span><span id="RandomBagRegressor-88"><a href="#RandomBagRegressor-88"><span class="linenos"> 88</span></a>
</span><span id="RandomBagRegressor-89"><a href="#RandomBagRegressor-89"><span class="linenos"> 89</span></a>
</span><span id="RandomBagRegressor-90"><a href="#RandomBagRegressor-90"><span class="linenos"> 90</span></a><span class="sd">    Examples:</span>
</span><span id="RandomBagRegressor-91"><a href="#RandomBagRegressor-91"><span class="linenos"> 91</span></a>
</span><span id="RandomBagRegressor-92"><a href="#RandomBagRegressor-92"><span class="linenos"> 92</span></a><span class="sd">    ```python</span>
</span><span id="RandomBagRegressor-93"><a href="#RandomBagRegressor-93"><span class="linenos"> 93</span></a><span class="sd">    import numpy as np</span>
</span><span id="RandomBagRegressor-94"><a href="#RandomBagRegressor-94"><span class="linenos"> 94</span></a><span class="sd">    import nnetsauce as ns</span>
</span><span id="RandomBagRegressor-95"><a href="#RandomBagRegressor-95"><span class="linenos"> 95</span></a><span class="sd">    from sklearn.datasets import fetch_california_housing</span>
</span><span id="RandomBagRegressor-96"><a href="#RandomBagRegressor-96"><span class="linenos"> 96</span></a><span class="sd">    from sklearn.tree import DecisionTreeRegressor</span>
</span><span id="RandomBagRegressor-97"><a href="#RandomBagRegressor-97"><span class="linenos"> 97</span></a><span class="sd">    from sklearn.model_selection import train_test_split</span>
</span><span id="RandomBagRegressor-98"><a href="#RandomBagRegressor-98"><span class="linenos"> 98</span></a>
</span><span id="RandomBagRegressor-99"><a href="#RandomBagRegressor-99"><span class="linenos"> 99</span></a><span class="sd">    X, y = fetch_california_housing(return_X_y=True, as_frame=False)</span>
</span><span id="RandomBagRegressor-100"><a href="#RandomBagRegressor-100"><span class="linenos">100</span></a>
</span><span id="RandomBagRegressor-101"><a href="#RandomBagRegressor-101"><span class="linenos">101</span></a><span class="sd">    # split data into training test and test set</span>
</span><span id="RandomBagRegressor-102"><a href="#RandomBagRegressor-102"><span class="linenos">102</span></a><span class="sd">    X_train, X_test, y_train, y_test = train_test_split(X, y,</span>
</span><span id="RandomBagRegressor-103"><a href="#RandomBagRegressor-103"><span class="linenos">103</span></a><span class="sd">                                                        test_size=0.2, random_state=13)</span>
</span><span id="RandomBagRegressor-104"><a href="#RandomBagRegressor-104"><span class="linenos">104</span></a>
</span><span id="RandomBagRegressor-105"><a href="#RandomBagRegressor-105"><span class="linenos">105</span></a><span class="sd">    # Requires further tuning</span>
</span><span id="RandomBagRegressor-106"><a href="#RandomBagRegressor-106"><span class="linenos">106</span></a><span class="sd">    obj = DecisionTreeRegressor(max_depth=3, random_state=123)</span>
</span><span id="RandomBagRegressor-107"><a href="#RandomBagRegressor-107"><span class="linenos">107</span></a><span class="sd">    obj2 = ns.RandomBagRegressor(obj=obj, direct_link=False,</span>
</span><span id="RandomBagRegressor-108"><a href="#RandomBagRegressor-108"><span class="linenos">108</span></a><span class="sd">                                n_estimators=50,</span>
</span><span id="RandomBagRegressor-109"><a href="#RandomBagRegressor-109"><span class="linenos">109</span></a><span class="sd">                                col_sample=0.9, row_sample=0.9,</span>
</span><span id="RandomBagRegressor-110"><a href="#RandomBagRegressor-110"><span class="linenos">110</span></a><span class="sd">                                dropout=0, n_clusters=0, verbose=1)</span>
</span><span id="RandomBagRegressor-111"><a href="#RandomBagRegressor-111"><span class="linenos">111</span></a>
</span><span id="RandomBagRegressor-112"><a href="#RandomBagRegressor-112"><span class="linenos">112</span></a><span class="sd">    obj2.fit(X_train, y_train)</span>
</span><span id="RandomBagRegressor-113"><a href="#RandomBagRegressor-113"><span class="linenos">113</span></a>
</span><span id="RandomBagRegressor-114"><a href="#RandomBagRegressor-114"><span class="linenos">114</span></a><span class="sd">    print(np.sqrt(obj2.score(X_test, y_test))) # RMSE</span>
</span><span id="RandomBagRegressor-115"><a href="#RandomBagRegressor-115"><span class="linenos">115</span></a>
</span><span id="RandomBagRegressor-116"><a href="#RandomBagRegressor-116"><span class="linenos">116</span></a><span class="sd">    ```</span>
</span><span id="RandomBagRegressor-117"><a href="#RandomBagRegressor-117"><span class="linenos">117</span></a>
</span><span id="RandomBagRegressor-118"><a href="#RandomBagRegressor-118"><span class="linenos">118</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="RandomBagRegressor-119"><a href="#RandomBagRegressor-119"><span class="linenos">119</span></a>
</span><span id="RandomBagRegressor-120"><a href="#RandomBagRegressor-120"><span class="linenos">120</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="RandomBagRegressor-121"><a href="#RandomBagRegressor-121"><span class="linenos">121</span></a>
</span><span id="RandomBagRegressor-122"><a href="#RandomBagRegressor-122"><span class="linenos">122</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="RandomBagRegressor-123"><a href="#RandomBagRegressor-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="RandomBagRegressor-124"><a href="#RandomBagRegressor-124"><span class="linenos">124</span></a>        <span class="n">obj</span><span class="p">,</span>
</span><span id="RandomBagRegressor-125"><a href="#RandomBagRegressor-125"><span class="linenos">125</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="RandomBagRegressor-126"><a href="#RandomBagRegressor-126"><span class="linenos">126</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="RandomBagRegressor-127"><a href="#RandomBagRegressor-127"><span class="linenos">127</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="RandomBagRegressor-128"><a href="#RandomBagRegressor-128"><span class="linenos">128</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="RandomBagRegressor-129"><a href="#RandomBagRegressor-129"><span class="linenos">129</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="RandomBagRegressor-130"><a href="#RandomBagRegressor-130"><span class="linenos">130</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="RandomBagRegressor-131"><a href="#RandomBagRegressor-131"><span class="linenos">131</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="RandomBagRegressor-132"><a href="#RandomBagRegressor-132"><span class="linenos">132</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="RandomBagRegressor-133"><a href="#RandomBagRegressor-133"><span class="linenos">133</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="RandomBagRegressor-134"><a href="#RandomBagRegressor-134"><span class="linenos">134</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="RandomBagRegressor-135"><a href="#RandomBagRegressor-135"><span class="linenos">135</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="RandomBagRegressor-136"><a href="#RandomBagRegressor-136"><span class="linenos">136</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="RandomBagRegressor-137"><a href="#RandomBagRegressor-137"><span class="linenos">137</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="RandomBagRegressor-138"><a href="#RandomBagRegressor-138"><span class="linenos">138</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="RandomBagRegressor-139"><a href="#RandomBagRegressor-139"><span class="linenos">139</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="RandomBagRegressor-140"><a href="#RandomBagRegressor-140"><span class="linenos">140</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="RandomBagRegressor-141"><a href="#RandomBagRegressor-141"><span class="linenos">141</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="RandomBagRegressor-142"><a href="#RandomBagRegressor-142"><span class="linenos">142</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="RandomBagRegressor-143"><a href="#RandomBagRegressor-143"><span class="linenos">143</span></a>    <span class="p">):</span>
</span><span id="RandomBagRegressor-144"><a href="#RandomBagRegressor-144"><span class="linenos">144</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="RandomBagRegressor-145"><a href="#RandomBagRegressor-145"><span class="linenos">145</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="RandomBagRegressor-146"><a href="#RandomBagRegressor-146"><span class="linenos">146</span></a>            <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span>
</span><span id="RandomBagRegressor-147"><a href="#RandomBagRegressor-147"><span class="linenos">147</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="RandomBagRegressor-148"><a href="#RandomBagRegressor-148"><span class="linenos">148</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="RandomBagRegressor-149"><a href="#RandomBagRegressor-149"><span class="linenos">149</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="RandomBagRegressor-150"><a href="#RandomBagRegressor-150"><span class="linenos">150</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="RandomBagRegressor-151"><a href="#RandomBagRegressor-151"><span class="linenos">151</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="RandomBagRegressor-152"><a href="#RandomBagRegressor-152"><span class="linenos">152</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="RandomBagRegressor-153"><a href="#RandomBagRegressor-153"><span class="linenos">153</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="RandomBagRegressor-154"><a href="#RandomBagRegressor-154"><span class="linenos">154</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="RandomBagRegressor-155"><a href="#RandomBagRegressor-155"><span class="linenos">155</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="RandomBagRegressor-156"><a href="#RandomBagRegressor-156"><span class="linenos">156</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="RandomBagRegressor-157"><a href="#RandomBagRegressor-157"><span class="linenos">157</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="RandomBagRegressor-158"><a href="#RandomBagRegressor-158"><span class="linenos">158</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="RandomBagRegressor-159"><a href="#RandomBagRegressor-159"><span class="linenos">159</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="RandomBagRegressor-160"><a href="#RandomBagRegressor-160"><span class="linenos">160</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="RandomBagRegressor-161"><a href="#RandomBagRegressor-161"><span class="linenos">161</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="RandomBagRegressor-162"><a href="#RandomBagRegressor-162"><span class="linenos">162</span></a>        <span class="p">)</span>
</span><span id="RandomBagRegressor-163"><a href="#RandomBagRegressor-163"><span class="linenos">163</span></a>
</span><span id="RandomBagRegressor-164"><a href="#RandomBagRegressor-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_fit</span> <span class="o">=</span> <span class="s2">&quot;regression&quot;</span>
</span><span id="RandomBagRegressor-165"><a href="#RandomBagRegressor-165"><span class="linenos">165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="RandomBagRegressor-166"><a href="#RandomBagRegressor-166"><span class="linenos">166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="RandomBagRegressor-167"><a href="#RandomBagRegressor-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">voter_</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="RandomBagRegressor-168"><a href="#RandomBagRegressor-168"><span class="linenos">168</span></a>
</span><span id="RandomBagRegressor-169"><a href="#RandomBagRegressor-169"><span class="linenos">169</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="RandomBagRegressor-170"><a href="#RandomBagRegressor-170"><span class="linenos">170</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Random &#39;Bagging&#39; model to training data (X, y).</span>
</span><span id="RandomBagRegressor-171"><a href="#RandomBagRegressor-171"><span class="linenos">171</span></a>
</span><span id="RandomBagRegressor-172"><a href="#RandomBagRegressor-172"><span class="linenos">172</span></a><span class="sd">        Args:</span>
</span><span id="RandomBagRegressor-173"><a href="#RandomBagRegressor-173"><span class="linenos">173</span></a>
</span><span id="RandomBagRegressor-174"><a href="#RandomBagRegressor-174"><span class="linenos">174</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="RandomBagRegressor-175"><a href="#RandomBagRegressor-175"><span class="linenos">175</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="RandomBagRegressor-176"><a href="#RandomBagRegressor-176"><span class="linenos">176</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="RandomBagRegressor-177"><a href="#RandomBagRegressor-177"><span class="linenos">177</span></a>
</span><span id="RandomBagRegressor-178"><a href="#RandomBagRegressor-178"><span class="linenos">178</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="RandomBagRegressor-179"><a href="#RandomBagRegressor-179"><span class="linenos">179</span></a><span class="sd">                Target values.</span>
</span><span id="RandomBagRegressor-180"><a href="#RandomBagRegressor-180"><span class="linenos">180</span></a>
</span><span id="RandomBagRegressor-181"><a href="#RandomBagRegressor-181"><span class="linenos">181</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="RandomBagRegressor-182"><a href="#RandomBagRegressor-182"><span class="linenos">182</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="RandomBagRegressor-183"><a href="#RandomBagRegressor-183"><span class="linenos">183</span></a>
</span><span id="RandomBagRegressor-184"><a href="#RandomBagRegressor-184"><span class="linenos">184</span></a><span class="sd">        Returns:</span>
</span><span id="RandomBagRegressor-185"><a href="#RandomBagRegressor-185"><span class="linenos">185</span></a>
</span><span id="RandomBagRegressor-186"><a href="#RandomBagRegressor-186"><span class="linenos">186</span></a><span class="sd">            self: object</span>
</span><span id="RandomBagRegressor-187"><a href="#RandomBagRegressor-187"><span class="linenos">187</span></a>
</span><span id="RandomBagRegressor-188"><a href="#RandomBagRegressor-188"><span class="linenos">188</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RandomBagRegressor-189"><a href="#RandomBagRegressor-189"><span class="linenos">189</span></a>
</span><span id="RandomBagRegressor-190"><a href="#RandomBagRegressor-190"><span class="linenos">190</span></a>        <span class="n">base_learner</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="RandomBagRegressor-191"><a href="#RandomBagRegressor-191"><span class="linenos">191</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span>
</span><span id="RandomBagRegressor-192"><a href="#RandomBagRegressor-192"><span class="linenos">192</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="RandomBagRegressor-193"><a href="#RandomBagRegressor-193"><span class="linenos">193</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="RandomBagRegressor-194"><a href="#RandomBagRegressor-194"><span class="linenos">194</span></a>            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="RandomBagRegressor-195"><a href="#RandomBagRegressor-195"><span class="linenos">195</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="RandomBagRegressor-196"><a href="#RandomBagRegressor-196"><span class="linenos">196</span></a>            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="RandomBagRegressor-197"><a href="#RandomBagRegressor-197"><span class="linenos">197</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="RandomBagRegressor-198"><a href="#RandomBagRegressor-198"><span class="linenos">198</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="RandomBagRegressor-199"><a href="#RandomBagRegressor-199"><span class="linenos">199</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="RandomBagRegressor-200"><a href="#RandomBagRegressor-200"><span class="linenos">200</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="RandomBagRegressor-201"><a href="#RandomBagRegressor-201"><span class="linenos">201</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="RandomBagRegressor-202"><a href="#RandomBagRegressor-202"><span class="linenos">202</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="RandomBagRegressor-203"><a href="#RandomBagRegressor-203"><span class="linenos">203</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="RandomBagRegressor-204"><a href="#RandomBagRegressor-204"><span class="linenos">204</span></a>            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="RandomBagRegressor-205"><a href="#RandomBagRegressor-205"><span class="linenos">205</span></a>        <span class="p">)</span>
</span><span id="RandomBagRegressor-206"><a href="#RandomBagRegressor-206"><span class="linenos">206</span></a>
</span><span id="RandomBagRegressor-207"><a href="#RandomBagRegressor-207"><span class="linenos">207</span></a>        <span class="c1"># 1 - Sequential training -----</span>
</span><span id="RandomBagRegressor-208"><a href="#RandomBagRegressor-208"><span class="linenos">208</span></a>
</span><span id="RandomBagRegressor-209"><a href="#RandomBagRegressor-209"><span class="linenos">209</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RandomBagRegressor-210"><a href="#RandomBagRegressor-210"><span class="linenos">210</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">voter_</span> <span class="o">=</span> <span class="n">rbagloop_regression</span><span class="p">(</span>
</span><span id="RandomBagRegressor-211"><a href="#RandomBagRegressor-211"><span class="linenos">211</span></a>                <span class="n">base_learner</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed</span>
</span><span id="RandomBagRegressor-212"><a href="#RandomBagRegressor-212"><span class="linenos">212</span></a>            <span class="p">)</span>
</span><span id="RandomBagRegressor-213"><a href="#RandomBagRegressor-213"><span class="linenos">213</span></a>
</span><span id="RandomBagRegressor-214"><a href="#RandomBagRegressor-214"><span class="linenos">214</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">)</span>
</span><span id="RandomBagRegressor-215"><a href="#RandomBagRegressor-215"><span class="linenos">215</span></a>
</span><span id="RandomBagRegressor-216"><a href="#RandomBagRegressor-216"><span class="linenos">216</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="RandomBagRegressor-217"><a href="#RandomBagRegressor-217"><span class="linenos">217</span></a>
</span><span id="RandomBagRegressor-218"><a href="#RandomBagRegressor-218"><span class="linenos">218</span></a>        <span class="c1"># 2 - Parallel training -----</span>
</span><span id="RandomBagRegressor-219"><a href="#RandomBagRegressor-219"><span class="linenos">219</span></a>        <span class="c1"># buggy</span>
</span><span id="RandomBagRegressor-220"><a href="#RandomBagRegressor-220"><span class="linenos">220</span></a>        <span class="c1"># if self.n_jobs is not None:</span>
</span><span id="RandomBagRegressor-221"><a href="#RandomBagRegressor-221"><span class="linenos">221</span></a>        <span class="k">def</span> <span class="nf">fit_estimators</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="RandomBagRegressor-222"><a href="#RandomBagRegressor-222"><span class="linenos">222</span></a>            <span class="n">base_learner__</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">base_learner</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</span><span id="RandomBagRegressor-223"><a href="#RandomBagRegressor-223"><span class="linenos">223</span></a>            <span class="n">base_learner__</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="n">m</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
</span><span id="RandomBagRegressor-224"><a href="#RandomBagRegressor-224"><span class="linenos">224</span></a>            <span class="n">base_learner__</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="RandomBagRegressor-225"><a href="#RandomBagRegressor-225"><span class="linenos">225</span></a>            <span class="k">return</span> <span class="n">base_learner__</span>
</span><span id="RandomBagRegressor-226"><a href="#RandomBagRegressor-226"><span class="linenos">226</span></a>
</span><span id="RandomBagRegressor-227"><a href="#RandomBagRegressor-227"><span class="linenos">227</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="RandomBagRegressor-228"><a href="#RandomBagRegressor-228"><span class="linenos">228</span></a>            <span class="n">voters_list</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)(</span>
</span><span id="RandomBagRegressor-229"><a href="#RandomBagRegressor-229"><span class="linenos">229</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="n">fit_estimators</span><span class="p">)(</span><span class="n">m</span><span class="p">)</span>
</span><span id="RandomBagRegressor-230"><a href="#RandomBagRegressor-230"><span class="linenos">230</span></a>                <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">))</span>
</span><span id="RandomBagRegressor-231"><a href="#RandomBagRegressor-231"><span class="linenos">231</span></a>            <span class="p">)</span>
</span><span id="RandomBagRegressor-232"><a href="#RandomBagRegressor-232"><span class="linenos">232</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RandomBagRegressor-233"><a href="#RandomBagRegressor-233"><span class="linenos">233</span></a>            <span class="n">voters_list</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)(</span>
</span><span id="RandomBagRegressor-234"><a href="#RandomBagRegressor-234"><span class="linenos">234</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="n">fit_estimators</span><span class="p">)(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="RandomBagRegressor-235"><a href="#RandomBagRegressor-235"><span class="linenos">235</span></a>            <span class="p">)</span>
</span><span id="RandomBagRegressor-236"><a href="#RandomBagRegressor-236"><span class="linenos">236</span></a>
</span><span id="RandomBagRegressor-237"><a href="#RandomBagRegressor-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">voter_</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">elt</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">elt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">voters_list</span><span class="p">)}</span>
</span><span id="RandomBagRegressor-238"><a href="#RandomBagRegressor-238"><span class="linenos">238</span></a>
</span><span id="RandomBagRegressor-239"><a href="#RandomBagRegressor-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">)</span>
</span><span id="RandomBagRegressor-240"><a href="#RandomBagRegressor-240"><span class="linenos">240</span></a>
</span><span id="RandomBagRegressor-241"><a href="#RandomBagRegressor-241"><span class="linenos">241</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="RandomBagRegressor-242"><a href="#RandomBagRegressor-242"><span class="linenos">242</span></a>
</span><span id="RandomBagRegressor-243"><a href="#RandomBagRegressor-243"><span class="linenos">243</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="RandomBagRegressor-244"><a href="#RandomBagRegressor-244"><span class="linenos">244</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict for test data X.</span>
</span><span id="RandomBagRegressor-245"><a href="#RandomBagRegressor-245"><span class="linenos">245</span></a>
</span><span id="RandomBagRegressor-246"><a href="#RandomBagRegressor-246"><span class="linenos">246</span></a><span class="sd">        Args:</span>
</span><span id="RandomBagRegressor-247"><a href="#RandomBagRegressor-247"><span class="linenos">247</span></a>
</span><span id="RandomBagRegressor-248"><a href="#RandomBagRegressor-248"><span class="linenos">248</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="RandomBagRegressor-249"><a href="#RandomBagRegressor-249"><span class="linenos">249</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="RandomBagRegressor-250"><a href="#RandomBagRegressor-250"><span class="linenos">250</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="RandomBagRegressor-251"><a href="#RandomBagRegressor-251"><span class="linenos">251</span></a>
</span><span id="RandomBagRegressor-252"><a href="#RandomBagRegressor-252"><span class="linenos">252</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="RandomBagRegressor-253"><a href="#RandomBagRegressor-253"><span class="linenos">253</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="RandomBagRegressor-254"><a href="#RandomBagRegressor-254"><span class="linenos">254</span></a>
</span><span id="RandomBagRegressor-255"><a href="#RandomBagRegressor-255"><span class="linenos">255</span></a><span class="sd">        Returns:</span>
</span><span id="RandomBagRegressor-256"><a href="#RandomBagRegressor-256"><span class="linenos">256</span></a>
</span><span id="RandomBagRegressor-257"><a href="#RandomBagRegressor-257"><span class="linenos">257</span></a><span class="sd">            estimates for test data: {array-like}</span>
</span><span id="RandomBagRegressor-258"><a href="#RandomBagRegressor-258"><span class="linenos">258</span></a>
</span><span id="RandomBagRegressor-259"><a href="#RandomBagRegressor-259"><span class="linenos">259</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RandomBagRegressor-260"><a href="#RandomBagRegressor-260"><span class="linenos">260</span></a>
</span><span id="RandomBagRegressor-261"><a href="#RandomBagRegressor-261"><span class="linenos">261</span></a>        <span class="k">def</span> <span class="nf">calculate_preds</span><span class="p">(</span><span class="n">voter</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="RandomBagRegressor-262"><a href="#RandomBagRegressor-262"><span class="linenos">262</span></a>            <span class="n">ensemble_preds</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="RandomBagRegressor-263"><a href="#RandomBagRegressor-263"><span class="linenos">263</span></a>
</span><span id="RandomBagRegressor-264"><a href="#RandomBagRegressor-264"><span class="linenos">264</span></a>            <span class="n">n_iter</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">voter</span><span class="p">)</span>
</span><span id="RandomBagRegressor-265"><a href="#RandomBagRegressor-265"><span class="linenos">265</span></a>
</span><span id="RandomBagRegressor-266"><a href="#RandomBagRegressor-266"><span class="linenos">266</span></a>            <span class="k">assert</span> <span class="n">n_iter</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;no estimator found in `RandomBag` ensemble&quot;</span>
</span><span id="RandomBagRegressor-267"><a href="#RandomBagRegressor-267"><span class="linenos">267</span></a>
</span><span id="RandomBagRegressor-268"><a href="#RandomBagRegressor-268"><span class="linenos">268</span></a>            <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RandomBagRegressor-269"><a href="#RandomBagRegressor-269"><span class="linenos">269</span></a>                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">elt</span> <span class="ow">in</span> <span class="n">voter</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="RandomBagRegressor-270"><a href="#RandomBagRegressor-270"><span class="linenos">270</span></a>                    <span class="n">ensemble_preds</span> <span class="o">+=</span> <span class="n">elt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="RandomBagRegressor-271"><a href="#RandomBagRegressor-271"><span class="linenos">271</span></a>
</span><span id="RandomBagRegressor-272"><a href="#RandomBagRegressor-272"><span class="linenos">272</span></a>                <span class="k">return</span> <span class="n">ensemble_preds</span> <span class="o">/</span> <span class="n">n_iter</span>
</span><span id="RandomBagRegressor-273"><a href="#RandomBagRegressor-273"><span class="linenos">273</span></a>
</span><span id="RandomBagRegressor-274"><a href="#RandomBagRegressor-274"><span class="linenos">274</span></a>            <span class="c1"># if weights is not None:</span>
</span><span id="RandomBagRegressor-275"><a href="#RandomBagRegressor-275"><span class="linenos">275</span></a>            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">elt</span> <span class="ow">in</span> <span class="n">voter</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="RandomBagRegressor-276"><a href="#RandomBagRegressor-276"><span class="linenos">276</span></a>                <span class="n">ensemble_preds</span> <span class="o">+=</span> <span class="n">weights</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">elt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="RandomBagRegressor-277"><a href="#RandomBagRegressor-277"><span class="linenos">277</span></a>
</span><span id="RandomBagRegressor-278"><a href="#RandomBagRegressor-278"><span class="linenos">278</span></a>            <span class="k">return</span> <span class="n">ensemble_preds</span>
</span><span id="RandomBagRegressor-279"><a href="#RandomBagRegressor-279"><span class="linenos">279</span></a>
</span><span id="RandomBagRegressor-280"><a href="#RandomBagRegressor-280"><span class="linenos">280</span></a>        <span class="c1"># end calculate_preds ----</span>
</span><span id="RandomBagRegressor-281"><a href="#RandomBagRegressor-281"><span class="linenos">281</span></a>
</span><span id="RandomBagRegressor-282"><a href="#RandomBagRegressor-282"><span class="linenos">282</span></a>        <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RandomBagRegressor-283"><a href="#RandomBagRegressor-283"><span class="linenos">283</span></a>            <span class="k">return</span> <span class="n">calculate_preds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">)</span>
</span><span id="RandomBagRegressor-284"><a href="#RandomBagRegressor-284"><span class="linenos">284</span></a>
</span><span id="RandomBagRegressor-285"><a href="#RandomBagRegressor-285"><span class="linenos">285</span></a>        <span class="c1"># if weights is not None:</span>
</span><span id="RandomBagRegressor-286"><a href="#RandomBagRegressor-286"><span class="linenos">286</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span>
</span><span id="RandomBagRegressor-287"><a href="#RandomBagRegressor-287"><span class="linenos">287</span></a>
</span><span id="RandomBagRegressor-288"><a href="#RandomBagRegressor-288"><span class="linenos">288</span></a>        <span class="k">return</span> <span class="n">calculate_preds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Randomized 'Bagging' Regression model</p>

<p>Parameters:</p>

<pre><code>obj: object
    any object containing a method fit (obj.fit()) and a method predict
    (obj.predict())

n_estimators: int
    number of boosting iterations

n_hidden_features: int
    number of nodes in the hidden layer

activation_name: str
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'

a: float
    hyperparameter for 'prelu' or 'elu' activation function

nodes_sim: str
    type of simulation for the nodes: 'sobol', 'hammersley', 'halton',
    'uniform'

bias: boolean
    indicates if the hidden layer contains a bias term (True) or not
    (False)

dropout: float
    regularization parameter; (random) percentage of nodes dropped out
    of the training

direct_link: boolean
    indicates if the original predictors are included (True) in model''s
    fitting or not (False)

n_clusters: int
    number of clusters for 'kmeans' or 'gmm' clustering (could be 0:
        no clustering)

cluster_encode: bool
    defines how the variable containing clusters is treated (default is one-hot)
    if `False`, then labels are used, without one-hot encoding

type_clust: str
    type of clustering method: currently k-means ('kmeans') or Gaussian
    Mixture Model ('gmm')

type_scaling: a tuple of 3 strings
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax')

col_sample: float
    percentage of covariates randomly chosen for training

row_sample: float
    percentage of rows chosen for training, by stratified bootstrapping

seed: int
    reproducibility seed for nodes_sim=='uniform'

backend: str
    "cpu" or "gpu" or "tpu"
</code></pre>

<p>Attributes:</p>

<pre><code>voter_: dict
    dictionary containing all the fitted base-learners
</code></pre>

<p>Examples:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_california_housing</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">fetch_california_housing</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_frame</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># split data into training test and test set</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                                                    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>

<span class="c1"># Requires further tuning</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">obj2</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">RandomBagRegressor</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">direct_link</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
                            <span class="n">col_sample</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">row_sample</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                            <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">obj2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">obj2</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span> <span class="c1"># RMSE</span>
</code></pre>
</div>
</div>


                                <div id="RandomBagRegressor.fit" class="classattr">
                                            <input id="RandomBagRegressor.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RandomBagRegressor.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RandomBagRegressor.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RandomBagRegressor.fit-169"><a href="#RandomBagRegressor.fit-169"><span class="linenos">169</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="RandomBagRegressor.fit-170"><a href="#RandomBagRegressor.fit-170"><span class="linenos">170</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Random &#39;Bagging&#39; model to training data (X, y).</span>
</span><span id="RandomBagRegressor.fit-171"><a href="#RandomBagRegressor.fit-171"><span class="linenos">171</span></a>
</span><span id="RandomBagRegressor.fit-172"><a href="#RandomBagRegressor.fit-172"><span class="linenos">172</span></a><span class="sd">        Args:</span>
</span><span id="RandomBagRegressor.fit-173"><a href="#RandomBagRegressor.fit-173"><span class="linenos">173</span></a>
</span><span id="RandomBagRegressor.fit-174"><a href="#RandomBagRegressor.fit-174"><span class="linenos">174</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="RandomBagRegressor.fit-175"><a href="#RandomBagRegressor.fit-175"><span class="linenos">175</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="RandomBagRegressor.fit-176"><a href="#RandomBagRegressor.fit-176"><span class="linenos">176</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="RandomBagRegressor.fit-177"><a href="#RandomBagRegressor.fit-177"><span class="linenos">177</span></a>
</span><span id="RandomBagRegressor.fit-178"><a href="#RandomBagRegressor.fit-178"><span class="linenos">178</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="RandomBagRegressor.fit-179"><a href="#RandomBagRegressor.fit-179"><span class="linenos">179</span></a><span class="sd">                Target values.</span>
</span><span id="RandomBagRegressor.fit-180"><a href="#RandomBagRegressor.fit-180"><span class="linenos">180</span></a>
</span><span id="RandomBagRegressor.fit-181"><a href="#RandomBagRegressor.fit-181"><span class="linenos">181</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="RandomBagRegressor.fit-182"><a href="#RandomBagRegressor.fit-182"><span class="linenos">182</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="RandomBagRegressor.fit-183"><a href="#RandomBagRegressor.fit-183"><span class="linenos">183</span></a>
</span><span id="RandomBagRegressor.fit-184"><a href="#RandomBagRegressor.fit-184"><span class="linenos">184</span></a><span class="sd">        Returns:</span>
</span><span id="RandomBagRegressor.fit-185"><a href="#RandomBagRegressor.fit-185"><span class="linenos">185</span></a>
</span><span id="RandomBagRegressor.fit-186"><a href="#RandomBagRegressor.fit-186"><span class="linenos">186</span></a><span class="sd">            self: object</span>
</span><span id="RandomBagRegressor.fit-187"><a href="#RandomBagRegressor.fit-187"><span class="linenos">187</span></a>
</span><span id="RandomBagRegressor.fit-188"><a href="#RandomBagRegressor.fit-188"><span class="linenos">188</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RandomBagRegressor.fit-189"><a href="#RandomBagRegressor.fit-189"><span class="linenos">189</span></a>
</span><span id="RandomBagRegressor.fit-190"><a href="#RandomBagRegressor.fit-190"><span class="linenos">190</span></a>        <span class="n">base_learner</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="RandomBagRegressor.fit-191"><a href="#RandomBagRegressor.fit-191"><span class="linenos">191</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span>
</span><span id="RandomBagRegressor.fit-192"><a href="#RandomBagRegressor.fit-192"><span class="linenos">192</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="RandomBagRegressor.fit-193"><a href="#RandomBagRegressor.fit-193"><span class="linenos">193</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="RandomBagRegressor.fit-194"><a href="#RandomBagRegressor.fit-194"><span class="linenos">194</span></a>            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="RandomBagRegressor.fit-195"><a href="#RandomBagRegressor.fit-195"><span class="linenos">195</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="RandomBagRegressor.fit-196"><a href="#RandomBagRegressor.fit-196"><span class="linenos">196</span></a>            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="RandomBagRegressor.fit-197"><a href="#RandomBagRegressor.fit-197"><span class="linenos">197</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="RandomBagRegressor.fit-198"><a href="#RandomBagRegressor.fit-198"><span class="linenos">198</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="RandomBagRegressor.fit-199"><a href="#RandomBagRegressor.fit-199"><span class="linenos">199</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="RandomBagRegressor.fit-200"><a href="#RandomBagRegressor.fit-200"><span class="linenos">200</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="RandomBagRegressor.fit-201"><a href="#RandomBagRegressor.fit-201"><span class="linenos">201</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="RandomBagRegressor.fit-202"><a href="#RandomBagRegressor.fit-202"><span class="linenos">202</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="RandomBagRegressor.fit-203"><a href="#RandomBagRegressor.fit-203"><span class="linenos">203</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="RandomBagRegressor.fit-204"><a href="#RandomBagRegressor.fit-204"><span class="linenos">204</span></a>            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="RandomBagRegressor.fit-205"><a href="#RandomBagRegressor.fit-205"><span class="linenos">205</span></a>        <span class="p">)</span>
</span><span id="RandomBagRegressor.fit-206"><a href="#RandomBagRegressor.fit-206"><span class="linenos">206</span></a>
</span><span id="RandomBagRegressor.fit-207"><a href="#RandomBagRegressor.fit-207"><span class="linenos">207</span></a>        <span class="c1"># 1 - Sequential training -----</span>
</span><span id="RandomBagRegressor.fit-208"><a href="#RandomBagRegressor.fit-208"><span class="linenos">208</span></a>
</span><span id="RandomBagRegressor.fit-209"><a href="#RandomBagRegressor.fit-209"><span class="linenos">209</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RandomBagRegressor.fit-210"><a href="#RandomBagRegressor.fit-210"><span class="linenos">210</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">voter_</span> <span class="o">=</span> <span class="n">rbagloop_regression</span><span class="p">(</span>
</span><span id="RandomBagRegressor.fit-211"><a href="#RandomBagRegressor.fit-211"><span class="linenos">211</span></a>                <span class="n">base_learner</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed</span>
</span><span id="RandomBagRegressor.fit-212"><a href="#RandomBagRegressor.fit-212"><span class="linenos">212</span></a>            <span class="p">)</span>
</span><span id="RandomBagRegressor.fit-213"><a href="#RandomBagRegressor.fit-213"><span class="linenos">213</span></a>
</span><span id="RandomBagRegressor.fit-214"><a href="#RandomBagRegressor.fit-214"><span class="linenos">214</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">)</span>
</span><span id="RandomBagRegressor.fit-215"><a href="#RandomBagRegressor.fit-215"><span class="linenos">215</span></a>
</span><span id="RandomBagRegressor.fit-216"><a href="#RandomBagRegressor.fit-216"><span class="linenos">216</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="RandomBagRegressor.fit-217"><a href="#RandomBagRegressor.fit-217"><span class="linenos">217</span></a>
</span><span id="RandomBagRegressor.fit-218"><a href="#RandomBagRegressor.fit-218"><span class="linenos">218</span></a>        <span class="c1"># 2 - Parallel training -----</span>
</span><span id="RandomBagRegressor.fit-219"><a href="#RandomBagRegressor.fit-219"><span class="linenos">219</span></a>        <span class="c1"># buggy</span>
</span><span id="RandomBagRegressor.fit-220"><a href="#RandomBagRegressor.fit-220"><span class="linenos">220</span></a>        <span class="c1"># if self.n_jobs is not None:</span>
</span><span id="RandomBagRegressor.fit-221"><a href="#RandomBagRegressor.fit-221"><span class="linenos">221</span></a>        <span class="k">def</span> <span class="nf">fit_estimators</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="RandomBagRegressor.fit-222"><a href="#RandomBagRegressor.fit-222"><span class="linenos">222</span></a>            <span class="n">base_learner__</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">base_learner</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</span><span id="RandomBagRegressor.fit-223"><a href="#RandomBagRegressor.fit-223"><span class="linenos">223</span></a>            <span class="n">base_learner__</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="n">m</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
</span><span id="RandomBagRegressor.fit-224"><a href="#RandomBagRegressor.fit-224"><span class="linenos">224</span></a>            <span class="n">base_learner__</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="RandomBagRegressor.fit-225"><a href="#RandomBagRegressor.fit-225"><span class="linenos">225</span></a>            <span class="k">return</span> <span class="n">base_learner__</span>
</span><span id="RandomBagRegressor.fit-226"><a href="#RandomBagRegressor.fit-226"><span class="linenos">226</span></a>
</span><span id="RandomBagRegressor.fit-227"><a href="#RandomBagRegressor.fit-227"><span class="linenos">227</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="RandomBagRegressor.fit-228"><a href="#RandomBagRegressor.fit-228"><span class="linenos">228</span></a>            <span class="n">voters_list</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)(</span>
</span><span id="RandomBagRegressor.fit-229"><a href="#RandomBagRegressor.fit-229"><span class="linenos">229</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="n">fit_estimators</span><span class="p">)(</span><span class="n">m</span><span class="p">)</span>
</span><span id="RandomBagRegressor.fit-230"><a href="#RandomBagRegressor.fit-230"><span class="linenos">230</span></a>                <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">))</span>
</span><span id="RandomBagRegressor.fit-231"><a href="#RandomBagRegressor.fit-231"><span class="linenos">231</span></a>            <span class="p">)</span>
</span><span id="RandomBagRegressor.fit-232"><a href="#RandomBagRegressor.fit-232"><span class="linenos">232</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RandomBagRegressor.fit-233"><a href="#RandomBagRegressor.fit-233"><span class="linenos">233</span></a>            <span class="n">voters_list</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)(</span>
</span><span id="RandomBagRegressor.fit-234"><a href="#RandomBagRegressor.fit-234"><span class="linenos">234</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="n">fit_estimators</span><span class="p">)(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="RandomBagRegressor.fit-235"><a href="#RandomBagRegressor.fit-235"><span class="linenos">235</span></a>            <span class="p">)</span>
</span><span id="RandomBagRegressor.fit-236"><a href="#RandomBagRegressor.fit-236"><span class="linenos">236</span></a>
</span><span id="RandomBagRegressor.fit-237"><a href="#RandomBagRegressor.fit-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">voter_</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">elt</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">elt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">voters_list</span><span class="p">)}</span>
</span><span id="RandomBagRegressor.fit-238"><a href="#RandomBagRegressor.fit-238"><span class="linenos">238</span></a>
</span><span id="RandomBagRegressor.fit-239"><a href="#RandomBagRegressor.fit-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">)</span>
</span><span id="RandomBagRegressor.fit-240"><a href="#RandomBagRegressor.fit-240"><span class="linenos">240</span></a>
</span><span id="RandomBagRegressor.fit-241"><a href="#RandomBagRegressor.fit-241"><span class="linenos">241</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit Random 'Bagging' model to training data (X, y).</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

y: array-like, shape = [n_samples]
    Target values.

**kwargs: additional parameters to be passed to
        self.cook_training_set or self.obj.fit
</code></pre>

<p>Returns:</p>

<pre><code>self: object
</code></pre>
</div>


                                </div>
                                <div id="RandomBagRegressor.predict" class="classattr">
                                            <input id="RandomBagRegressor.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">weights</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RandomBagRegressor.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RandomBagRegressor.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RandomBagRegressor.predict-243"><a href="#RandomBagRegressor.predict-243"><span class="linenos">243</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="RandomBagRegressor.predict-244"><a href="#RandomBagRegressor.predict-244"><span class="linenos">244</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict for test data X.</span>
</span><span id="RandomBagRegressor.predict-245"><a href="#RandomBagRegressor.predict-245"><span class="linenos">245</span></a>
</span><span id="RandomBagRegressor.predict-246"><a href="#RandomBagRegressor.predict-246"><span class="linenos">246</span></a><span class="sd">        Args:</span>
</span><span id="RandomBagRegressor.predict-247"><a href="#RandomBagRegressor.predict-247"><span class="linenos">247</span></a>
</span><span id="RandomBagRegressor.predict-248"><a href="#RandomBagRegressor.predict-248"><span class="linenos">248</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="RandomBagRegressor.predict-249"><a href="#RandomBagRegressor.predict-249"><span class="linenos">249</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="RandomBagRegressor.predict-250"><a href="#RandomBagRegressor.predict-250"><span class="linenos">250</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="RandomBagRegressor.predict-251"><a href="#RandomBagRegressor.predict-251"><span class="linenos">251</span></a>
</span><span id="RandomBagRegressor.predict-252"><a href="#RandomBagRegressor.predict-252"><span class="linenos">252</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="RandomBagRegressor.predict-253"><a href="#RandomBagRegressor.predict-253"><span class="linenos">253</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="RandomBagRegressor.predict-254"><a href="#RandomBagRegressor.predict-254"><span class="linenos">254</span></a>
</span><span id="RandomBagRegressor.predict-255"><a href="#RandomBagRegressor.predict-255"><span class="linenos">255</span></a><span class="sd">        Returns:</span>
</span><span id="RandomBagRegressor.predict-256"><a href="#RandomBagRegressor.predict-256"><span class="linenos">256</span></a>
</span><span id="RandomBagRegressor.predict-257"><a href="#RandomBagRegressor.predict-257"><span class="linenos">257</span></a><span class="sd">            estimates for test data: {array-like}</span>
</span><span id="RandomBagRegressor.predict-258"><a href="#RandomBagRegressor.predict-258"><span class="linenos">258</span></a>
</span><span id="RandomBagRegressor.predict-259"><a href="#RandomBagRegressor.predict-259"><span class="linenos">259</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RandomBagRegressor.predict-260"><a href="#RandomBagRegressor.predict-260"><span class="linenos">260</span></a>
</span><span id="RandomBagRegressor.predict-261"><a href="#RandomBagRegressor.predict-261"><span class="linenos">261</span></a>        <span class="k">def</span> <span class="nf">calculate_preds</span><span class="p">(</span><span class="n">voter</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="RandomBagRegressor.predict-262"><a href="#RandomBagRegressor.predict-262"><span class="linenos">262</span></a>            <span class="n">ensemble_preds</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="RandomBagRegressor.predict-263"><a href="#RandomBagRegressor.predict-263"><span class="linenos">263</span></a>
</span><span id="RandomBagRegressor.predict-264"><a href="#RandomBagRegressor.predict-264"><span class="linenos">264</span></a>            <span class="n">n_iter</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">voter</span><span class="p">)</span>
</span><span id="RandomBagRegressor.predict-265"><a href="#RandomBagRegressor.predict-265"><span class="linenos">265</span></a>
</span><span id="RandomBagRegressor.predict-266"><a href="#RandomBagRegressor.predict-266"><span class="linenos">266</span></a>            <span class="k">assert</span> <span class="n">n_iter</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;no estimator found in `RandomBag` ensemble&quot;</span>
</span><span id="RandomBagRegressor.predict-267"><a href="#RandomBagRegressor.predict-267"><span class="linenos">267</span></a>
</span><span id="RandomBagRegressor.predict-268"><a href="#RandomBagRegressor.predict-268"><span class="linenos">268</span></a>            <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RandomBagRegressor.predict-269"><a href="#RandomBagRegressor.predict-269"><span class="linenos">269</span></a>                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">elt</span> <span class="ow">in</span> <span class="n">voter</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="RandomBagRegressor.predict-270"><a href="#RandomBagRegressor.predict-270"><span class="linenos">270</span></a>                    <span class="n">ensemble_preds</span> <span class="o">+=</span> <span class="n">elt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="RandomBagRegressor.predict-271"><a href="#RandomBagRegressor.predict-271"><span class="linenos">271</span></a>
</span><span id="RandomBagRegressor.predict-272"><a href="#RandomBagRegressor.predict-272"><span class="linenos">272</span></a>                <span class="k">return</span> <span class="n">ensemble_preds</span> <span class="o">/</span> <span class="n">n_iter</span>
</span><span id="RandomBagRegressor.predict-273"><a href="#RandomBagRegressor.predict-273"><span class="linenos">273</span></a>
</span><span id="RandomBagRegressor.predict-274"><a href="#RandomBagRegressor.predict-274"><span class="linenos">274</span></a>            <span class="c1"># if weights is not None:</span>
</span><span id="RandomBagRegressor.predict-275"><a href="#RandomBagRegressor.predict-275"><span class="linenos">275</span></a>            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">elt</span> <span class="ow">in</span> <span class="n">voter</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="RandomBagRegressor.predict-276"><a href="#RandomBagRegressor.predict-276"><span class="linenos">276</span></a>                <span class="n">ensemble_preds</span> <span class="o">+=</span> <span class="n">weights</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">elt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="RandomBagRegressor.predict-277"><a href="#RandomBagRegressor.predict-277"><span class="linenos">277</span></a>
</span><span id="RandomBagRegressor.predict-278"><a href="#RandomBagRegressor.predict-278"><span class="linenos">278</span></a>            <span class="k">return</span> <span class="n">ensemble_preds</span>
</span><span id="RandomBagRegressor.predict-279"><a href="#RandomBagRegressor.predict-279"><span class="linenos">279</span></a>
</span><span id="RandomBagRegressor.predict-280"><a href="#RandomBagRegressor.predict-280"><span class="linenos">280</span></a>        <span class="c1"># end calculate_preds ----</span>
</span><span id="RandomBagRegressor.predict-281"><a href="#RandomBagRegressor.predict-281"><span class="linenos">281</span></a>
</span><span id="RandomBagRegressor.predict-282"><a href="#RandomBagRegressor.predict-282"><span class="linenos">282</span></a>        <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RandomBagRegressor.predict-283"><a href="#RandomBagRegressor.predict-283"><span class="linenos">283</span></a>            <span class="k">return</span> <span class="n">calculate_preds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">)</span>
</span><span id="RandomBagRegressor.predict-284"><a href="#RandomBagRegressor.predict-284"><span class="linenos">284</span></a>
</span><span id="RandomBagRegressor.predict-285"><a href="#RandomBagRegressor.predict-285"><span class="linenos">285</span></a>        <span class="c1"># if weights is not None:</span>
</span><span id="RandomBagRegressor.predict-286"><a href="#RandomBagRegressor.predict-286"><span class="linenos">286</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span>
</span><span id="RandomBagRegressor.predict-287"><a href="#RandomBagRegressor.predict-287"><span class="linenos">287</span></a>
</span><span id="RandomBagRegressor.predict-288"><a href="#RandomBagRegressor.predict-288"><span class="linenos">288</span></a>        <span class="k">return</span> <span class="n">calculate_preds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict for test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>estimates for test data: {array-like}
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="RandomBagClassifier">
                            <input id="RandomBagClassifier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">RandomBagClassifier</span><wbr>(<span class="base">nnetsauce.randombag.bag.RandomBag</span>, <span class="base">sklearn.base.ClassifierMixin</span>):

                <label class="view-source-button" for="RandomBagClassifier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RandomBagClassifier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RandomBagClassifier-18"><a href="#RandomBagClassifier-18"><span class="linenos"> 18</span></a><span class="k">class</span> <span class="nc">RandomBagClassifier</span><span class="p">(</span><span class="n">RandomBag</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">):</span>
</span><span id="RandomBagClassifier-19"><a href="#RandomBagClassifier-19"><span class="linenos"> 19</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Randomized &#39;Bagging&#39; Classification model</span>
</span><span id="RandomBagClassifier-20"><a href="#RandomBagClassifier-20"><span class="linenos"> 20</span></a>
</span><span id="RandomBagClassifier-21"><a href="#RandomBagClassifier-21"><span class="linenos"> 21</span></a><span class="sd">    Parameters:</span>
</span><span id="RandomBagClassifier-22"><a href="#RandomBagClassifier-22"><span class="linenos"> 22</span></a>
</span><span id="RandomBagClassifier-23"><a href="#RandomBagClassifier-23"><span class="linenos"> 23</span></a><span class="sd">        obj: object</span>
</span><span id="RandomBagClassifier-24"><a href="#RandomBagClassifier-24"><span class="linenos"> 24</span></a><span class="sd">            any object containing a method fit (obj.fit()) and a method predict</span>
</span><span id="RandomBagClassifier-25"><a href="#RandomBagClassifier-25"><span class="linenos"> 25</span></a><span class="sd">            (obj.predict())</span>
</span><span id="RandomBagClassifier-26"><a href="#RandomBagClassifier-26"><span class="linenos"> 26</span></a>
</span><span id="RandomBagClassifier-27"><a href="#RandomBagClassifier-27"><span class="linenos"> 27</span></a><span class="sd">        n_estimators: int</span>
</span><span id="RandomBagClassifier-28"><a href="#RandomBagClassifier-28"><span class="linenos"> 28</span></a><span class="sd">            number of boosting iterations</span>
</span><span id="RandomBagClassifier-29"><a href="#RandomBagClassifier-29"><span class="linenos"> 29</span></a>
</span><span id="RandomBagClassifier-30"><a href="#RandomBagClassifier-30"><span class="linenos"> 30</span></a><span class="sd">        n_hidden_features: int</span>
</span><span id="RandomBagClassifier-31"><a href="#RandomBagClassifier-31"><span class="linenos"> 31</span></a><span class="sd">            number of nodes in the hidden layer</span>
</span><span id="RandomBagClassifier-32"><a href="#RandomBagClassifier-32"><span class="linenos"> 32</span></a>
</span><span id="RandomBagClassifier-33"><a href="#RandomBagClassifier-33"><span class="linenos"> 33</span></a><span class="sd">        activation_name: str</span>
</span><span id="RandomBagClassifier-34"><a href="#RandomBagClassifier-34"><span class="linenos"> 34</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;</span>
</span><span id="RandomBagClassifier-35"><a href="#RandomBagClassifier-35"><span class="linenos"> 35</span></a>
</span><span id="RandomBagClassifier-36"><a href="#RandomBagClassifier-36"><span class="linenos"> 36</span></a><span class="sd">        a: float</span>
</span><span id="RandomBagClassifier-37"><a href="#RandomBagClassifier-37"><span class="linenos"> 37</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function</span>
</span><span id="RandomBagClassifier-38"><a href="#RandomBagClassifier-38"><span class="linenos"> 38</span></a>
</span><span id="RandomBagClassifier-39"><a href="#RandomBagClassifier-39"><span class="linenos"> 39</span></a><span class="sd">        nodes_sim: str</span>
</span><span id="RandomBagClassifier-40"><a href="#RandomBagClassifier-40"><span class="linenos"> 40</span></a><span class="sd">            type of simulation for the nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;,</span>
</span><span id="RandomBagClassifier-41"><a href="#RandomBagClassifier-41"><span class="linenos"> 41</span></a><span class="sd">            &#39;uniform&#39;</span>
</span><span id="RandomBagClassifier-42"><a href="#RandomBagClassifier-42"><span class="linenos"> 42</span></a>
</span><span id="RandomBagClassifier-43"><a href="#RandomBagClassifier-43"><span class="linenos"> 43</span></a><span class="sd">        bias: boolean</span>
</span><span id="RandomBagClassifier-44"><a href="#RandomBagClassifier-44"><span class="linenos"> 44</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or not</span>
</span><span id="RandomBagClassifier-45"><a href="#RandomBagClassifier-45"><span class="linenos"> 45</span></a><span class="sd">            (False)</span>
</span><span id="RandomBagClassifier-46"><a href="#RandomBagClassifier-46"><span class="linenos"> 46</span></a>
</span><span id="RandomBagClassifier-47"><a href="#RandomBagClassifier-47"><span class="linenos"> 47</span></a><span class="sd">        dropout: float</span>
</span><span id="RandomBagClassifier-48"><a href="#RandomBagClassifier-48"><span class="linenos"> 48</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="RandomBagClassifier-49"><a href="#RandomBagClassifier-49"><span class="linenos"> 49</span></a><span class="sd">            of the training</span>
</span><span id="RandomBagClassifier-50"><a href="#RandomBagClassifier-50"><span class="linenos"> 50</span></a>
</span><span id="RandomBagClassifier-51"><a href="#RandomBagClassifier-51"><span class="linenos"> 51</span></a><span class="sd">        direct_link: boolean</span>
</span><span id="RandomBagClassifier-52"><a href="#RandomBagClassifier-52"><span class="linenos"> 52</span></a><span class="sd">            indicates if the original predictors are included (True) in model&#39;s</span>
</span><span id="RandomBagClassifier-53"><a href="#RandomBagClassifier-53"><span class="linenos"> 53</span></a><span class="sd">            fitting or not (False)</span>
</span><span id="RandomBagClassifier-54"><a href="#RandomBagClassifier-54"><span class="linenos"> 54</span></a>
</span><span id="RandomBagClassifier-55"><a href="#RandomBagClassifier-55"><span class="linenos"> 55</span></a><span class="sd">        n_clusters: int</span>
</span><span id="RandomBagClassifier-56"><a href="#RandomBagClassifier-56"><span class="linenos"> 56</span></a><span class="sd">            number of clusters for &#39;kmeans&#39; or &#39;gmm&#39; clustering (could be 0:</span>
</span><span id="RandomBagClassifier-57"><a href="#RandomBagClassifier-57"><span class="linenos"> 57</span></a><span class="sd">                no clustering)</span>
</span><span id="RandomBagClassifier-58"><a href="#RandomBagClassifier-58"><span class="linenos"> 58</span></a>
</span><span id="RandomBagClassifier-59"><a href="#RandomBagClassifier-59"><span class="linenos"> 59</span></a><span class="sd">        cluster_encode: bool</span>
</span><span id="RandomBagClassifier-60"><a href="#RandomBagClassifier-60"><span class="linenos"> 60</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot)</span>
</span><span id="RandomBagClassifier-61"><a href="#RandomBagClassifier-61"><span class="linenos"> 61</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding</span>
</span><span id="RandomBagClassifier-62"><a href="#RandomBagClassifier-62"><span class="linenos"> 62</span></a>
</span><span id="RandomBagClassifier-63"><a href="#RandomBagClassifier-63"><span class="linenos"> 63</span></a><span class="sd">        type_clust: str</span>
</span><span id="RandomBagClassifier-64"><a href="#RandomBagClassifier-64"><span class="linenos"> 64</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian</span>
</span><span id="RandomBagClassifier-65"><a href="#RandomBagClassifier-65"><span class="linenos"> 65</span></a><span class="sd">            Mixture Model (&#39;gmm&#39;)</span>
</span><span id="RandomBagClassifier-66"><a href="#RandomBagClassifier-66"><span class="linenos"> 66</span></a>
</span><span id="RandomBagClassifier-67"><a href="#RandomBagClassifier-67"><span class="linenos"> 67</span></a><span class="sd">        type_scaling: a tuple of 3 strings</span>
</span><span id="RandomBagClassifier-68"><a href="#RandomBagClassifier-68"><span class="linenos"> 68</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="RandomBagClassifier-69"><a href="#RandomBagClassifier-69"><span class="linenos"> 69</span></a><span class="sd">            (and when relevant).</span>
</span><span id="RandomBagClassifier-70"><a href="#RandomBagClassifier-70"><span class="linenos"> 70</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;)</span>
</span><span id="RandomBagClassifier-71"><a href="#RandomBagClassifier-71"><span class="linenos"> 71</span></a>
</span><span id="RandomBagClassifier-72"><a href="#RandomBagClassifier-72"><span class="linenos"> 72</span></a><span class="sd">        col_sample: float</span>
</span><span id="RandomBagClassifier-73"><a href="#RandomBagClassifier-73"><span class="linenos"> 73</span></a><span class="sd">            percentage of covariates randomly chosen for training</span>
</span><span id="RandomBagClassifier-74"><a href="#RandomBagClassifier-74"><span class="linenos"> 74</span></a>
</span><span id="RandomBagClassifier-75"><a href="#RandomBagClassifier-75"><span class="linenos"> 75</span></a><span class="sd">        row_sample: float</span>
</span><span id="RandomBagClassifier-76"><a href="#RandomBagClassifier-76"><span class="linenos"> 76</span></a><span class="sd">            percentage of rows chosen for training, by stratified bootstrapping</span>
</span><span id="RandomBagClassifier-77"><a href="#RandomBagClassifier-77"><span class="linenos"> 77</span></a>
</span><span id="RandomBagClassifier-78"><a href="#RandomBagClassifier-78"><span class="linenos"> 78</span></a><span class="sd">        seed: int</span>
</span><span id="RandomBagClassifier-79"><a href="#RandomBagClassifier-79"><span class="linenos"> 79</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39;</span>
</span><span id="RandomBagClassifier-80"><a href="#RandomBagClassifier-80"><span class="linenos"> 80</span></a>
</span><span id="RandomBagClassifier-81"><a href="#RandomBagClassifier-81"><span class="linenos"> 81</span></a><span class="sd">        backend: str</span>
</span><span id="RandomBagClassifier-82"><a href="#RandomBagClassifier-82"><span class="linenos"> 82</span></a><span class="sd">            &quot;cpu&quot; or &quot;gpu&quot; or &quot;tpu&quot;</span>
</span><span id="RandomBagClassifier-83"><a href="#RandomBagClassifier-83"><span class="linenos"> 83</span></a>
</span><span id="RandomBagClassifier-84"><a href="#RandomBagClassifier-84"><span class="linenos"> 84</span></a><span class="sd">    Attributes:</span>
</span><span id="RandomBagClassifier-85"><a href="#RandomBagClassifier-85"><span class="linenos"> 85</span></a>
</span><span id="RandomBagClassifier-86"><a href="#RandomBagClassifier-86"><span class="linenos"> 86</span></a><span class="sd">        voter_: dict</span>
</span><span id="RandomBagClassifier-87"><a href="#RandomBagClassifier-87"><span class="linenos"> 87</span></a><span class="sd">            dictionary containing all the fitted base-learners</span>
</span><span id="RandomBagClassifier-88"><a href="#RandomBagClassifier-88"><span class="linenos"> 88</span></a>
</span><span id="RandomBagClassifier-89"><a href="#RandomBagClassifier-89"><span class="linenos"> 89</span></a>
</span><span id="RandomBagClassifier-90"><a href="#RandomBagClassifier-90"><span class="linenos"> 90</span></a><span class="sd">    Examples:</span>
</span><span id="RandomBagClassifier-91"><a href="#RandomBagClassifier-91"><span class="linenos"> 91</span></a>
</span><span id="RandomBagClassifier-92"><a href="#RandomBagClassifier-92"><span class="linenos"> 92</span></a><span class="sd">    See also [https://github.com/Techtonique/nnetsauce/blob/master/examples/randombag_classification.py](https://github.com/Techtonique/nnetsauce/blob/master/examples/randombag_classification.py)</span>
</span><span id="RandomBagClassifier-93"><a href="#RandomBagClassifier-93"><span class="linenos"> 93</span></a>
</span><span id="RandomBagClassifier-94"><a href="#RandomBagClassifier-94"><span class="linenos"> 94</span></a><span class="sd">    ```python</span>
</span><span id="RandomBagClassifier-95"><a href="#RandomBagClassifier-95"><span class="linenos"> 95</span></a><span class="sd">    import nnetsauce as ns</span>
</span><span id="RandomBagClassifier-96"><a href="#RandomBagClassifier-96"><span class="linenos"> 96</span></a><span class="sd">    from sklearn.datasets import load_breast_cancer</span>
</span><span id="RandomBagClassifier-97"><a href="#RandomBagClassifier-97"><span class="linenos"> 97</span></a><span class="sd">    from sklearn.tree import DecisionTreeClassifier</span>
</span><span id="RandomBagClassifier-98"><a href="#RandomBagClassifier-98"><span class="linenos"> 98</span></a><span class="sd">    from sklearn.model_selection import train_test_split</span>
</span><span id="RandomBagClassifier-99"><a href="#RandomBagClassifier-99"><span class="linenos"> 99</span></a><span class="sd">    from sklearn import metrics</span>
</span><span id="RandomBagClassifier-100"><a href="#RandomBagClassifier-100"><span class="linenos">100</span></a><span class="sd">    from time import time</span>
</span><span id="RandomBagClassifier-101"><a href="#RandomBagClassifier-101"><span class="linenos">101</span></a>
</span><span id="RandomBagClassifier-102"><a href="#RandomBagClassifier-102"><span class="linenos">102</span></a>
</span><span id="RandomBagClassifier-103"><a href="#RandomBagClassifier-103"><span class="linenos">103</span></a><span class="sd">    breast_cancer = load_breast_cancer()</span>
</span><span id="RandomBagClassifier-104"><a href="#RandomBagClassifier-104"><span class="linenos">104</span></a><span class="sd">    Z = breast_cancer.data</span>
</span><span id="RandomBagClassifier-105"><a href="#RandomBagClassifier-105"><span class="linenos">105</span></a><span class="sd">    t = breast_cancer.target</span>
</span><span id="RandomBagClassifier-106"><a href="#RandomBagClassifier-106"><span class="linenos">106</span></a><span class="sd">    np.random.seed(123)</span>
</span><span id="RandomBagClassifier-107"><a href="#RandomBagClassifier-107"><span class="linenos">107</span></a><span class="sd">    X_train, X_test, y_train, y_test = train_test_split(Z, t, test_size=0.2)</span>
</span><span id="RandomBagClassifier-108"><a href="#RandomBagClassifier-108"><span class="linenos">108</span></a>
</span><span id="RandomBagClassifier-109"><a href="#RandomBagClassifier-109"><span class="linenos">109</span></a><span class="sd">    # decision tree</span>
</span><span id="RandomBagClassifier-110"><a href="#RandomBagClassifier-110"><span class="linenos">110</span></a><span class="sd">    clf = DecisionTreeClassifier(max_depth=2, random_state=123)</span>
</span><span id="RandomBagClassifier-111"><a href="#RandomBagClassifier-111"><span class="linenos">111</span></a><span class="sd">    fit_obj = ns.RandomBagClassifier(clf, n_hidden_features=2,</span>
</span><span id="RandomBagClassifier-112"><a href="#RandomBagClassifier-112"><span class="linenos">112</span></a><span class="sd">                                    direct_link=True,</span>
</span><span id="RandomBagClassifier-113"><a href="#RandomBagClassifier-113"><span class="linenos">113</span></a><span class="sd">                                    n_estimators=100,</span>
</span><span id="RandomBagClassifier-114"><a href="#RandomBagClassifier-114"><span class="linenos">114</span></a><span class="sd">                                    col_sample=0.9, row_sample=0.9,</span>
</span><span id="RandomBagClassifier-115"><a href="#RandomBagClassifier-115"><span class="linenos">115</span></a><span class="sd">                                    dropout=0.3, n_clusters=0, verbose=1)</span>
</span><span id="RandomBagClassifier-116"><a href="#RandomBagClassifier-116"><span class="linenos">116</span></a>
</span><span id="RandomBagClassifier-117"><a href="#RandomBagClassifier-117"><span class="linenos">117</span></a><span class="sd">    start = time()</span>
</span><span id="RandomBagClassifier-118"><a href="#RandomBagClassifier-118"><span class="linenos">118</span></a><span class="sd">    fit_obj.fit(X_train, y_train)</span>
</span><span id="RandomBagClassifier-119"><a href="#RandomBagClassifier-119"><span class="linenos">119</span></a><span class="sd">    print(f&quot;Elapsed {time() - start}&quot;)</span>
</span><span id="RandomBagClassifier-120"><a href="#RandomBagClassifier-120"><span class="linenos">120</span></a>
</span><span id="RandomBagClassifier-121"><a href="#RandomBagClassifier-121"><span class="linenos">121</span></a><span class="sd">    print(fit_obj.score(X_test, y_test))</span>
</span><span id="RandomBagClassifier-122"><a href="#RandomBagClassifier-122"><span class="linenos">122</span></a><span class="sd">    print(fit_obj.score(X_test, y_test, scoring=&quot;roc_auc&quot;))</span>
</span><span id="RandomBagClassifier-123"><a href="#RandomBagClassifier-123"><span class="linenos">123</span></a>
</span><span id="RandomBagClassifier-124"><a href="#RandomBagClassifier-124"><span class="linenos">124</span></a><span class="sd">    start = time()</span>
</span><span id="RandomBagClassifier-125"><a href="#RandomBagClassifier-125"><span class="linenos">125</span></a><span class="sd">    preds = fit_obj.predict(X_test)</span>
</span><span id="RandomBagClassifier-126"><a href="#RandomBagClassifier-126"><span class="linenos">126</span></a><span class="sd">    print(f&quot;Elapsed {time() - start}&quot;)</span>
</span><span id="RandomBagClassifier-127"><a href="#RandomBagClassifier-127"><span class="linenos">127</span></a><span class="sd">    print(metrics.classification_report(preds, y_test))</span>
</span><span id="RandomBagClassifier-128"><a href="#RandomBagClassifier-128"><span class="linenos">128</span></a><span class="sd">    ```</span>
</span><span id="RandomBagClassifier-129"><a href="#RandomBagClassifier-129"><span class="linenos">129</span></a>
</span><span id="RandomBagClassifier-130"><a href="#RandomBagClassifier-130"><span class="linenos">130</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="RandomBagClassifier-131"><a href="#RandomBagClassifier-131"><span class="linenos">131</span></a>
</span><span id="RandomBagClassifier-132"><a href="#RandomBagClassifier-132"><span class="linenos">132</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="RandomBagClassifier-133"><a href="#RandomBagClassifier-133"><span class="linenos">133</span></a>
</span><span id="RandomBagClassifier-134"><a href="#RandomBagClassifier-134"><span class="linenos">134</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="RandomBagClassifier-135"><a href="#RandomBagClassifier-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="RandomBagClassifier-136"><a href="#RandomBagClassifier-136"><span class="linenos">136</span></a>        <span class="n">obj</span><span class="p">,</span>
</span><span id="RandomBagClassifier-137"><a href="#RandomBagClassifier-137"><span class="linenos">137</span></a>        <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="RandomBagClassifier-138"><a href="#RandomBagClassifier-138"><span class="linenos">138</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="RandomBagClassifier-139"><a href="#RandomBagClassifier-139"><span class="linenos">139</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="RandomBagClassifier-140"><a href="#RandomBagClassifier-140"><span class="linenos">140</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="RandomBagClassifier-141"><a href="#RandomBagClassifier-141"><span class="linenos">141</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="RandomBagClassifier-142"><a href="#RandomBagClassifier-142"><span class="linenos">142</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="RandomBagClassifier-143"><a href="#RandomBagClassifier-143"><span class="linenos">143</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="RandomBagClassifier-144"><a href="#RandomBagClassifier-144"><span class="linenos">144</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="RandomBagClassifier-145"><a href="#RandomBagClassifier-145"><span class="linenos">145</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="RandomBagClassifier-146"><a href="#RandomBagClassifier-146"><span class="linenos">146</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="RandomBagClassifier-147"><a href="#RandomBagClassifier-147"><span class="linenos">147</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="RandomBagClassifier-148"><a href="#RandomBagClassifier-148"><span class="linenos">148</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="RandomBagClassifier-149"><a href="#RandomBagClassifier-149"><span class="linenos">149</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="RandomBagClassifier-150"><a href="#RandomBagClassifier-150"><span class="linenos">150</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="RandomBagClassifier-151"><a href="#RandomBagClassifier-151"><span class="linenos">151</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="RandomBagClassifier-152"><a href="#RandomBagClassifier-152"><span class="linenos">152</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="RandomBagClassifier-153"><a href="#RandomBagClassifier-153"><span class="linenos">153</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="RandomBagClassifier-154"><a href="#RandomBagClassifier-154"><span class="linenos">154</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="RandomBagClassifier-155"><a href="#RandomBagClassifier-155"><span class="linenos">155</span></a>    <span class="p">):</span>
</span><span id="RandomBagClassifier-156"><a href="#RandomBagClassifier-156"><span class="linenos">156</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="RandomBagClassifier-157"><a href="#RandomBagClassifier-157"><span class="linenos">157</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="RandomBagClassifier-158"><a href="#RandomBagClassifier-158"><span class="linenos">158</span></a>            <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span>
</span><span id="RandomBagClassifier-159"><a href="#RandomBagClassifier-159"><span class="linenos">159</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="RandomBagClassifier-160"><a href="#RandomBagClassifier-160"><span class="linenos">160</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="RandomBagClassifier-161"><a href="#RandomBagClassifier-161"><span class="linenos">161</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="RandomBagClassifier-162"><a href="#RandomBagClassifier-162"><span class="linenos">162</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="RandomBagClassifier-163"><a href="#RandomBagClassifier-163"><span class="linenos">163</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="RandomBagClassifier-164"><a href="#RandomBagClassifier-164"><span class="linenos">164</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="RandomBagClassifier-165"><a href="#RandomBagClassifier-165"><span class="linenos">165</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="RandomBagClassifier-166"><a href="#RandomBagClassifier-166"><span class="linenos">166</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="RandomBagClassifier-167"><a href="#RandomBagClassifier-167"><span class="linenos">167</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="RandomBagClassifier-168"><a href="#RandomBagClassifier-168"><span class="linenos">168</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="RandomBagClassifier-169"><a href="#RandomBagClassifier-169"><span class="linenos">169</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="RandomBagClassifier-170"><a href="#RandomBagClassifier-170"><span class="linenos">170</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="RandomBagClassifier-171"><a href="#RandomBagClassifier-171"><span class="linenos">171</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="RandomBagClassifier-172"><a href="#RandomBagClassifier-172"><span class="linenos">172</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="RandomBagClassifier-173"><a href="#RandomBagClassifier-173"><span class="linenos">173</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="RandomBagClassifier-174"><a href="#RandomBagClassifier-174"><span class="linenos">174</span></a>        <span class="p">)</span>
</span><span id="RandomBagClassifier-175"><a href="#RandomBagClassifier-175"><span class="linenos">175</span></a>
</span><span id="RandomBagClassifier-176"><a href="#RandomBagClassifier-176"><span class="linenos">176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_fit</span> <span class="o">=</span> <span class="s2">&quot;classification&quot;</span>
</span><span id="RandomBagClassifier-177"><a href="#RandomBagClassifier-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="RandomBagClassifier-178"><a href="#RandomBagClassifier-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="RandomBagClassifier-179"><a href="#RandomBagClassifier-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">voter_</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="RandomBagClassifier-180"><a href="#RandomBagClassifier-180"><span class="linenos">180</span></a>
</span><span id="RandomBagClassifier-181"><a href="#RandomBagClassifier-181"><span class="linenos">181</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="RandomBagClassifier-182"><a href="#RandomBagClassifier-182"><span class="linenos">182</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Random &#39;Bagging&#39; model to training data (X, y).</span>
</span><span id="RandomBagClassifier-183"><a href="#RandomBagClassifier-183"><span class="linenos">183</span></a>
</span><span id="RandomBagClassifier-184"><a href="#RandomBagClassifier-184"><span class="linenos">184</span></a><span class="sd">        Args:</span>
</span><span id="RandomBagClassifier-185"><a href="#RandomBagClassifier-185"><span class="linenos">185</span></a>
</span><span id="RandomBagClassifier-186"><a href="#RandomBagClassifier-186"><span class="linenos">186</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="RandomBagClassifier-187"><a href="#RandomBagClassifier-187"><span class="linenos">187</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="RandomBagClassifier-188"><a href="#RandomBagClassifier-188"><span class="linenos">188</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="RandomBagClassifier-189"><a href="#RandomBagClassifier-189"><span class="linenos">189</span></a>
</span><span id="RandomBagClassifier-190"><a href="#RandomBagClassifier-190"><span class="linenos">190</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="RandomBagClassifier-191"><a href="#RandomBagClassifier-191"><span class="linenos">191</span></a><span class="sd">                Target values.</span>
</span><span id="RandomBagClassifier-192"><a href="#RandomBagClassifier-192"><span class="linenos">192</span></a>
</span><span id="RandomBagClassifier-193"><a href="#RandomBagClassifier-193"><span class="linenos">193</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="RandomBagClassifier-194"><a href="#RandomBagClassifier-194"><span class="linenos">194</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="RandomBagClassifier-195"><a href="#RandomBagClassifier-195"><span class="linenos">195</span></a>
</span><span id="RandomBagClassifier-196"><a href="#RandomBagClassifier-196"><span class="linenos">196</span></a><span class="sd">        Returns:</span>
</span><span id="RandomBagClassifier-197"><a href="#RandomBagClassifier-197"><span class="linenos">197</span></a>
</span><span id="RandomBagClassifier-198"><a href="#RandomBagClassifier-198"><span class="linenos">198</span></a><span class="sd">            self: object</span>
</span><span id="RandomBagClassifier-199"><a href="#RandomBagClassifier-199"><span class="linenos">199</span></a>
</span><span id="RandomBagClassifier-200"><a href="#RandomBagClassifier-200"><span class="linenos">200</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RandomBagClassifier-201"><a href="#RandomBagClassifier-201"><span class="linenos">201</span></a>
</span><span id="RandomBagClassifier-202"><a href="#RandomBagClassifier-202"><span class="linenos">202</span></a>        <span class="k">assert</span> <span class="n">mx</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s2">&quot;y must contain only integers&quot;</span>
</span><span id="RandomBagClassifier-203"><a href="#RandomBagClassifier-203"><span class="linenos">203</span></a>
</span><span id="RandomBagClassifier-204"><a href="#RandomBagClassifier-204"><span class="linenos">204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="RandomBagClassifier-205"><a href="#RandomBagClassifier-205"><span class="linenos">205</span></a>
</span><span id="RandomBagClassifier-206"><a href="#RandomBagClassifier-206"><span class="linenos">206</span></a>        <span class="c1"># training</span>
</span><span id="RandomBagClassifier-207"><a href="#RandomBagClassifier-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="RandomBagClassifier-208"><a href="#RandomBagClassifier-208"><span class="linenos">208</span></a>
</span><span id="RandomBagClassifier-209"><a href="#RandomBagClassifier-209"><span class="linenos">209</span></a>        <span class="n">base_learner</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="RandomBagClassifier-210"><a href="#RandomBagClassifier-210"><span class="linenos">210</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span>
</span><span id="RandomBagClassifier-211"><a href="#RandomBagClassifier-211"><span class="linenos">211</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="RandomBagClassifier-212"><a href="#RandomBagClassifier-212"><span class="linenos">212</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="RandomBagClassifier-213"><a href="#RandomBagClassifier-213"><span class="linenos">213</span></a>            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="RandomBagClassifier-214"><a href="#RandomBagClassifier-214"><span class="linenos">214</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="RandomBagClassifier-215"><a href="#RandomBagClassifier-215"><span class="linenos">215</span></a>            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="RandomBagClassifier-216"><a href="#RandomBagClassifier-216"><span class="linenos">216</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="RandomBagClassifier-217"><a href="#RandomBagClassifier-217"><span class="linenos">217</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="RandomBagClassifier-218"><a href="#RandomBagClassifier-218"><span class="linenos">218</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="RandomBagClassifier-219"><a href="#RandomBagClassifier-219"><span class="linenos">219</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="RandomBagClassifier-220"><a href="#RandomBagClassifier-220"><span class="linenos">220</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="RandomBagClassifier-221"><a href="#RandomBagClassifier-221"><span class="linenos">221</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="RandomBagClassifier-222"><a href="#RandomBagClassifier-222"><span class="linenos">222</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="RandomBagClassifier-223"><a href="#RandomBagClassifier-223"><span class="linenos">223</span></a>            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="RandomBagClassifier-224"><a href="#RandomBagClassifier-224"><span class="linenos">224</span></a>        <span class="p">)</span>
</span><span id="RandomBagClassifier-225"><a href="#RandomBagClassifier-225"><span class="linenos">225</span></a>
</span><span id="RandomBagClassifier-226"><a href="#RandomBagClassifier-226"><span class="linenos">226</span></a>        <span class="c1"># 1 - Sequential training -----</span>
</span><span id="RandomBagClassifier-227"><a href="#RandomBagClassifier-227"><span class="linenos">227</span></a>
</span><span id="RandomBagClassifier-228"><a href="#RandomBagClassifier-228"><span class="linenos">228</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RandomBagClassifier-229"><a href="#RandomBagClassifier-229"><span class="linenos">229</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">voter_</span> <span class="o">=</span> <span class="n">rbagloop_classification</span><span class="p">(</span>
</span><span id="RandomBagClassifier-230"><a href="#RandomBagClassifier-230"><span class="linenos">230</span></a>                <span class="n">base_learner</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed</span>
</span><span id="RandomBagClassifier-231"><a href="#RandomBagClassifier-231"><span class="linenos">231</span></a>            <span class="p">)</span>
</span><span id="RandomBagClassifier-232"><a href="#RandomBagClassifier-232"><span class="linenos">232</span></a>
</span><span id="RandomBagClassifier-233"><a href="#RandomBagClassifier-233"><span class="linenos">233</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">)</span>
</span><span id="RandomBagClassifier-234"><a href="#RandomBagClassifier-234"><span class="linenos">234</span></a>
</span><span id="RandomBagClassifier-235"><a href="#RandomBagClassifier-235"><span class="linenos">235</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="RandomBagClassifier-236"><a href="#RandomBagClassifier-236"><span class="linenos">236</span></a>
</span><span id="RandomBagClassifier-237"><a href="#RandomBagClassifier-237"><span class="linenos">237</span></a>        <span class="c1"># 2 - Parallel training -----</span>
</span><span id="RandomBagClassifier-238"><a href="#RandomBagClassifier-238"><span class="linenos">238</span></a>        <span class="c1"># buggy</span>
</span><span id="RandomBagClassifier-239"><a href="#RandomBagClassifier-239"><span class="linenos">239</span></a>        <span class="c1"># if self.n_jobs is not None:</span>
</span><span id="RandomBagClassifier-240"><a href="#RandomBagClassifier-240"><span class="linenos">240</span></a>        <span class="k">def</span> <span class="nf">fit_estimators</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="RandomBagClassifier-241"><a href="#RandomBagClassifier-241"><span class="linenos">241</span></a>            <span class="n">base_learner__</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">base_learner</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</span><span id="RandomBagClassifier-242"><a href="#RandomBagClassifier-242"><span class="linenos">242</span></a>            <span class="n">base_learner__</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="n">m</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
</span><span id="RandomBagClassifier-243"><a href="#RandomBagClassifier-243"><span class="linenos">243</span></a>            <span class="n">base_learner__</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="RandomBagClassifier-244"><a href="#RandomBagClassifier-244"><span class="linenos">244</span></a>            <span class="k">return</span> <span class="n">base_learner__</span>
</span><span id="RandomBagClassifier-245"><a href="#RandomBagClassifier-245"><span class="linenos">245</span></a>
</span><span id="RandomBagClassifier-246"><a href="#RandomBagClassifier-246"><span class="linenos">246</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="RandomBagClassifier-247"><a href="#RandomBagClassifier-247"><span class="linenos">247</span></a>            <span class="n">voters_list</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)(</span>
</span><span id="RandomBagClassifier-248"><a href="#RandomBagClassifier-248"><span class="linenos">248</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="n">fit_estimators</span><span class="p">)(</span><span class="n">m</span><span class="p">)</span>
</span><span id="RandomBagClassifier-249"><a href="#RandomBagClassifier-249"><span class="linenos">249</span></a>                <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">))</span>
</span><span id="RandomBagClassifier-250"><a href="#RandomBagClassifier-250"><span class="linenos">250</span></a>            <span class="p">)</span>
</span><span id="RandomBagClassifier-251"><a href="#RandomBagClassifier-251"><span class="linenos">251</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RandomBagClassifier-252"><a href="#RandomBagClassifier-252"><span class="linenos">252</span></a>            <span class="n">voters_list</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)(</span>
</span><span id="RandomBagClassifier-253"><a href="#RandomBagClassifier-253"><span class="linenos">253</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="n">fit_estimators</span><span class="p">)(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="RandomBagClassifier-254"><a href="#RandomBagClassifier-254"><span class="linenos">254</span></a>            <span class="p">)</span>
</span><span id="RandomBagClassifier-255"><a href="#RandomBagClassifier-255"><span class="linenos">255</span></a>
</span><span id="RandomBagClassifier-256"><a href="#RandomBagClassifier-256"><span class="linenos">256</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">voter_</span> <span class="o">=</span> <span class="p">{</span><span class="n">idx</span><span class="p">:</span> <span class="n">elt</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">elt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">voters_list</span><span class="p">)}</span>
</span><span id="RandomBagClassifier-257"><a href="#RandomBagClassifier-257"><span class="linenos">257</span></a>
</span><span id="RandomBagClassifier-258"><a href="#RandomBagClassifier-258"><span class="linenos">258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">)</span>
</span><span id="RandomBagClassifier-259"><a href="#RandomBagClassifier-259"><span class="linenos">259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="RandomBagClassifier-260"><a href="#RandomBagClassifier-260"><span class="linenos">260</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="RandomBagClassifier-261"><a href="#RandomBagClassifier-261"><span class="linenos">261</span></a>
</span><span id="RandomBagClassifier-262"><a href="#RandomBagClassifier-262"><span class="linenos">262</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="RandomBagClassifier-263"><a href="#RandomBagClassifier-263"><span class="linenos">263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="RandomBagClassifier-264"><a href="#RandomBagClassifier-264"><span class="linenos">264</span></a>
</span><span id="RandomBagClassifier-265"><a href="#RandomBagClassifier-265"><span class="linenos">265</span></a><span class="sd">        Args:</span>
</span><span id="RandomBagClassifier-266"><a href="#RandomBagClassifier-266"><span class="linenos">266</span></a>
</span><span id="RandomBagClassifier-267"><a href="#RandomBagClassifier-267"><span class="linenos">267</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="RandomBagClassifier-268"><a href="#RandomBagClassifier-268"><span class="linenos">268</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="RandomBagClassifier-269"><a href="#RandomBagClassifier-269"><span class="linenos">269</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="RandomBagClassifier-270"><a href="#RandomBagClassifier-270"><span class="linenos">270</span></a>
</span><span id="RandomBagClassifier-271"><a href="#RandomBagClassifier-271"><span class="linenos">271</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="RandomBagClassifier-272"><a href="#RandomBagClassifier-272"><span class="linenos">272</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="RandomBagClassifier-273"><a href="#RandomBagClassifier-273"><span class="linenos">273</span></a>
</span><span id="RandomBagClassifier-274"><a href="#RandomBagClassifier-274"><span class="linenos">274</span></a><span class="sd">        Returns:</span>
</span><span id="RandomBagClassifier-275"><a href="#RandomBagClassifier-275"><span class="linenos">275</span></a>
</span><span id="RandomBagClassifier-276"><a href="#RandomBagClassifier-276"><span class="linenos">276</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="RandomBagClassifier-277"><a href="#RandomBagClassifier-277"><span class="linenos">277</span></a>
</span><span id="RandomBagClassifier-278"><a href="#RandomBagClassifier-278"><span class="linenos">278</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RandomBagClassifier-279"><a href="#RandomBagClassifier-279"><span class="linenos">279</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="RandomBagClassifier-280"><a href="#RandomBagClassifier-280"><span class="linenos">280</span></a>
</span><span id="RandomBagClassifier-281"><a href="#RandomBagClassifier-281"><span class="linenos">281</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="RandomBagClassifier-282"><a href="#RandomBagClassifier-282"><span class="linenos">282</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probabilities for test data X.</span>
</span><span id="RandomBagClassifier-283"><a href="#RandomBagClassifier-283"><span class="linenos">283</span></a>
</span><span id="RandomBagClassifier-284"><a href="#RandomBagClassifier-284"><span class="linenos">284</span></a><span class="sd">        Args:</span>
</span><span id="RandomBagClassifier-285"><a href="#RandomBagClassifier-285"><span class="linenos">285</span></a>
</span><span id="RandomBagClassifier-286"><a href="#RandomBagClassifier-286"><span class="linenos">286</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="RandomBagClassifier-287"><a href="#RandomBagClassifier-287"><span class="linenos">287</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="RandomBagClassifier-288"><a href="#RandomBagClassifier-288"><span class="linenos">288</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="RandomBagClassifier-289"><a href="#RandomBagClassifier-289"><span class="linenos">289</span></a>
</span><span id="RandomBagClassifier-290"><a href="#RandomBagClassifier-290"><span class="linenos">290</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="RandomBagClassifier-291"><a href="#RandomBagClassifier-291"><span class="linenos">291</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="RandomBagClassifier-292"><a href="#RandomBagClassifier-292"><span class="linenos">292</span></a>
</span><span id="RandomBagClassifier-293"><a href="#RandomBagClassifier-293"><span class="linenos">293</span></a><span class="sd">        Returns:</span>
</span><span id="RandomBagClassifier-294"><a href="#RandomBagClassifier-294"><span class="linenos">294</span></a>
</span><span id="RandomBagClassifier-295"><a href="#RandomBagClassifier-295"><span class="linenos">295</span></a><span class="sd">            probability estimates for test data: {array-like}</span>
</span><span id="RandomBagClassifier-296"><a href="#RandomBagClassifier-296"><span class="linenos">296</span></a>
</span><span id="RandomBagClassifier-297"><a href="#RandomBagClassifier-297"><span class="linenos">297</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RandomBagClassifier-298"><a href="#RandomBagClassifier-298"><span class="linenos">298</span></a>
</span><span id="RandomBagClassifier-299"><a href="#RandomBagClassifier-299"><span class="linenos">299</span></a>        <span class="k">def</span> <span class="nf">calculate_probas</span><span class="p">(</span><span class="n">voter</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="RandomBagClassifier-300"><a href="#RandomBagClassifier-300"><span class="linenos">300</span></a>            <span class="n">ensemble_proba</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="RandomBagClassifier-301"><a href="#RandomBagClassifier-301"><span class="linenos">301</span></a>
</span><span id="RandomBagClassifier-302"><a href="#RandomBagClassifier-302"><span class="linenos">302</span></a>            <span class="n">n_iter</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">voter</span><span class="p">)</span>
</span><span id="RandomBagClassifier-303"><a href="#RandomBagClassifier-303"><span class="linenos">303</span></a>
</span><span id="RandomBagClassifier-304"><a href="#RandomBagClassifier-304"><span class="linenos">304</span></a>            <span class="k">assert</span> <span class="n">n_iter</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;no estimator found in `RandomBag` ensemble&quot;</span>
</span><span id="RandomBagClassifier-305"><a href="#RandomBagClassifier-305"><span class="linenos">305</span></a>
</span><span id="RandomBagClassifier-306"><a href="#RandomBagClassifier-306"><span class="linenos">306</span></a>            <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RandomBagClassifier-307"><a href="#RandomBagClassifier-307"><span class="linenos">307</span></a>                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">elt</span> <span class="ow">in</span> <span class="n">voter</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="RandomBagClassifier-308"><a href="#RandomBagClassifier-308"><span class="linenos">308</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="RandomBagClassifier-309"><a href="#RandomBagClassifier-309"><span class="linenos">309</span></a>                        <span class="n">ensemble_proba</span> <span class="o">+=</span> <span class="n">elt</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="RandomBagClassifier-310"><a href="#RandomBagClassifier-310"><span class="linenos">310</span></a>
</span><span id="RandomBagClassifier-311"><a href="#RandomBagClassifier-311"><span class="linenos">311</span></a>                        <span class="c1"># if verbose == 1:</span>
</span><span id="RandomBagClassifier-312"><a href="#RandomBagClassifier-312"><span class="linenos">312</span></a>                        <span class="c1">#    pbar.update(idx)</span>
</span><span id="RandomBagClassifier-313"><a href="#RandomBagClassifier-313"><span class="linenos">313</span></a>
</span><span id="RandomBagClassifier-314"><a href="#RandomBagClassifier-314"><span class="linenos">314</span></a>                    <span class="k">except</span><span class="p">:</span>
</span><span id="RandomBagClassifier-315"><a href="#RandomBagClassifier-315"><span class="linenos">315</span></a>                        <span class="k">continue</span>
</span><span id="RandomBagClassifier-316"><a href="#RandomBagClassifier-316"><span class="linenos">316</span></a>
</span><span id="RandomBagClassifier-317"><a href="#RandomBagClassifier-317"><span class="linenos">317</span></a>                <span class="c1"># if verbose == 1:</span>
</span><span id="RandomBagClassifier-318"><a href="#RandomBagClassifier-318"><span class="linenos">318</span></a>                <span class="c1">#    pbar.update(n_iter)</span>
</span><span id="RandomBagClassifier-319"><a href="#RandomBagClassifier-319"><span class="linenos">319</span></a>
</span><span id="RandomBagClassifier-320"><a href="#RandomBagClassifier-320"><span class="linenos">320</span></a>                <span class="k">return</span> <span class="n">ensemble_proba</span> <span class="o">/</span> <span class="n">n_iter</span>
</span><span id="RandomBagClassifier-321"><a href="#RandomBagClassifier-321"><span class="linenos">321</span></a>
</span><span id="RandomBagClassifier-322"><a href="#RandomBagClassifier-322"><span class="linenos">322</span></a>            <span class="c1"># if weights is not None:</span>
</span><span id="RandomBagClassifier-323"><a href="#RandomBagClassifier-323"><span class="linenos">323</span></a>            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">elt</span> <span class="ow">in</span> <span class="n">voter</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="RandomBagClassifier-324"><a href="#RandomBagClassifier-324"><span class="linenos">324</span></a>                <span class="n">ensemble_proba</span> <span class="o">+=</span> <span class="n">weights</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">elt</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="RandomBagClassifier-325"><a href="#RandomBagClassifier-325"><span class="linenos">325</span></a>
</span><span id="RandomBagClassifier-326"><a href="#RandomBagClassifier-326"><span class="linenos">326</span></a>                <span class="c1"># if verbose == 1:</span>
</span><span id="RandomBagClassifier-327"><a href="#RandomBagClassifier-327"><span class="linenos">327</span></a>                <span class="c1">#    pbar.update(idx)</span>
</span><span id="RandomBagClassifier-328"><a href="#RandomBagClassifier-328"><span class="linenos">328</span></a>
</span><span id="RandomBagClassifier-329"><a href="#RandomBagClassifier-329"><span class="linenos">329</span></a>            <span class="c1"># if verbose == 1:</span>
</span><span id="RandomBagClassifier-330"><a href="#RandomBagClassifier-330"><span class="linenos">330</span></a>            <span class="c1">#    pbar.update(n_iter)</span>
</span><span id="RandomBagClassifier-331"><a href="#RandomBagClassifier-331"><span class="linenos">331</span></a>
</span><span id="RandomBagClassifier-332"><a href="#RandomBagClassifier-332"><span class="linenos">332</span></a>            <span class="k">return</span> <span class="n">ensemble_proba</span>
</span><span id="RandomBagClassifier-333"><a href="#RandomBagClassifier-333"><span class="linenos">333</span></a>
</span><span id="RandomBagClassifier-334"><a href="#RandomBagClassifier-334"><span class="linenos">334</span></a>        <span class="c1"># end calculate_probas ----</span>
</span><span id="RandomBagClassifier-335"><a href="#RandomBagClassifier-335"><span class="linenos">335</span></a>
</span><span id="RandomBagClassifier-336"><a href="#RandomBagClassifier-336"><span class="linenos">336</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RandomBagClassifier-337"><a href="#RandomBagClassifier-337"><span class="linenos">337</span></a>            <span class="c1"># if self.verbose == 1:</span>
</span><span id="RandomBagClassifier-338"><a href="#RandomBagClassifier-338"><span class="linenos">338</span></a>            <span class="c1">#    pbar = Progbar(self.n_estimators)</span>
</span><span id="RandomBagClassifier-339"><a href="#RandomBagClassifier-339"><span class="linenos">339</span></a>
</span><span id="RandomBagClassifier-340"><a href="#RandomBagClassifier-340"><span class="linenos">340</span></a>            <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RandomBagClassifier-341"><a href="#RandomBagClassifier-341"><span class="linenos">341</span></a>                <span class="k">return</span> <span class="n">calculate_probas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="RandomBagClassifier-342"><a href="#RandomBagClassifier-342"><span class="linenos">342</span></a>
</span><span id="RandomBagClassifier-343"><a href="#RandomBagClassifier-343"><span class="linenos">343</span></a>            <span class="c1"># if weights is not None:</span>
</span><span id="RandomBagClassifier-344"><a href="#RandomBagClassifier-344"><span class="linenos">344</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span>
</span><span id="RandomBagClassifier-345"><a href="#RandomBagClassifier-345"><span class="linenos">345</span></a>
</span><span id="RandomBagClassifier-346"><a href="#RandomBagClassifier-346"><span class="linenos">346</span></a>            <span class="k">return</span> <span class="n">calculate_probas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="RandomBagClassifier-347"><a href="#RandomBagClassifier-347"><span class="linenos">347</span></a>
</span><span id="RandomBagClassifier-348"><a href="#RandomBagClassifier-348"><span class="linenos">348</span></a>        <span class="c1"># if self.n_jobs is not None:</span>
</span><span id="RandomBagClassifier-349"><a href="#RandomBagClassifier-349"><span class="linenos">349</span></a>        <span class="k">def</span> <span class="nf">predict_estimator</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="RandomBagClassifier-350"><a href="#RandomBagClassifier-350"><span class="linenos">350</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="RandomBagClassifier-351"><a href="#RandomBagClassifier-351"><span class="linenos">351</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="RandomBagClassifier-352"><a href="#RandomBagClassifier-352"><span class="linenos">352</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="RandomBagClassifier-353"><a href="#RandomBagClassifier-353"><span class="linenos">353</span></a>                <span class="k">pass</span>
</span><span id="RandomBagClassifier-354"><a href="#RandomBagClassifier-354"><span class="linenos">354</span></a>
</span><span id="RandomBagClassifier-355"><a href="#RandomBagClassifier-355"><span class="linenos">355</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="RandomBagClassifier-356"><a href="#RandomBagClassifier-356"><span class="linenos">356</span></a>            <span class="n">preds</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)(</span>
</span><span id="RandomBagClassifier-357"><a href="#RandomBagClassifier-357"><span class="linenos">357</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="n">predict_estimator</span><span class="p">)(</span><span class="n">m</span><span class="p">)</span>
</span><span id="RandomBagClassifier-358"><a href="#RandomBagClassifier-358"><span class="linenos">358</span></a>                <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">))</span>
</span><span id="RandomBagClassifier-359"><a href="#RandomBagClassifier-359"><span class="linenos">359</span></a>            <span class="p">)</span>
</span><span id="RandomBagClassifier-360"><a href="#RandomBagClassifier-360"><span class="linenos">360</span></a>
</span><span id="RandomBagClassifier-361"><a href="#RandomBagClassifier-361"><span class="linenos">361</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RandomBagClassifier-362"><a href="#RandomBagClassifier-362"><span class="linenos">362</span></a>            <span class="n">preds</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)(</span>
</span><span id="RandomBagClassifier-363"><a href="#RandomBagClassifier-363"><span class="linenos">363</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="n">predict_estimator</span><span class="p">)(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="RandomBagClassifier-364"><a href="#RandomBagClassifier-364"><span class="linenos">364</span></a>            <span class="p">)</span>
</span><span id="RandomBagClassifier-365"><a href="#RandomBagClassifier-365"><span class="linenos">365</span></a>
</span><span id="RandomBagClassifier-366"><a href="#RandomBagClassifier-366"><span class="linenos">366</span></a>        <span class="n">ensemble_proba</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="RandomBagClassifier-367"><a href="#RandomBagClassifier-367"><span class="linenos">367</span></a>
</span><span id="RandomBagClassifier-368"><a href="#RandomBagClassifier-368"><span class="linenos">368</span></a>        <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RandomBagClassifier-369"><a href="#RandomBagClassifier-369"><span class="linenos">369</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="RandomBagClassifier-370"><a href="#RandomBagClassifier-370"><span class="linenos">370</span></a>                <span class="n">ensemble_proba</span> <span class="o">+=</span> <span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="RandomBagClassifier-371"><a href="#RandomBagClassifier-371"><span class="linenos">371</span></a>
</span><span id="RandomBagClassifier-372"><a href="#RandomBagClassifier-372"><span class="linenos">372</span></a>            <span class="k">return</span> <span class="n">ensemble_proba</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="RandomBagClassifier-373"><a href="#RandomBagClassifier-373"><span class="linenos">373</span></a>
</span><span id="RandomBagClassifier-374"><a href="#RandomBagClassifier-374"><span class="linenos">374</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="RandomBagClassifier-375"><a href="#RandomBagClassifier-375"><span class="linenos">375</span></a>            <span class="n">ensemble_proba</span> <span class="o">+=</span> <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="RandomBagClassifier-376"><a href="#RandomBagClassifier-376"><span class="linenos">376</span></a>
</span><span id="RandomBagClassifier-377"><a href="#RandomBagClassifier-377"><span class="linenos">377</span></a>        <span class="k">return</span> <span class="n">ensemble_proba</span>
</span></pre></div>


            <div class="docstring"><p>Randomized 'Bagging' Classification model</p>

<p>Parameters:</p>

<pre><code>obj: object
    any object containing a method fit (obj.fit()) and a method predict
    (obj.predict())

n_estimators: int
    number of boosting iterations

n_hidden_features: int
    number of nodes in the hidden layer

activation_name: str
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'

a: float
    hyperparameter for 'prelu' or 'elu' activation function

nodes_sim: str
    type of simulation for the nodes: 'sobol', 'hammersley', 'halton',
    'uniform'

bias: boolean
    indicates if the hidden layer contains a bias term (True) or not
    (False)

dropout: float
    regularization parameter; (random) percentage of nodes dropped out
    of the training

direct_link: boolean
    indicates if the original predictors are included (True) in model's
    fitting or not (False)

n_clusters: int
    number of clusters for 'kmeans' or 'gmm' clustering (could be 0:
        no clustering)

cluster_encode: bool
    defines how the variable containing clusters is treated (default is one-hot)
    if `False`, then labels are used, without one-hot encoding

type_clust: str
    type of clustering method: currently k-means ('kmeans') or Gaussian
    Mixture Model ('gmm')

type_scaling: a tuple of 3 strings
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax')

col_sample: float
    percentage of covariates randomly chosen for training

row_sample: float
    percentage of rows chosen for training, by stratified bootstrapping

seed: int
    reproducibility seed for nodes_sim=='uniform'

backend: str
    "cpu" or "gpu" or "tpu"
</code></pre>

<p>Attributes:</p>

<pre><code>voter_: dict
    dictionary containing all the fitted base-learners
</code></pre>

<p>Examples:</p>

<p>See also <a href="https://github.com/Techtonique/nnetsauce/blob/master/examples/randombag_classification.py">https://github.com/Techtonique/nnetsauce/blob/master/examples/randombag_classification.py</a></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>


<span class="n">breast_cancer</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">breast_cancer</span><span class="o">.</span><span class="n">data</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">breast_cancer</span><span class="o">.</span><span class="n">target</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># decision tree</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">fit_obj</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">RandomBagClassifier</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                <span class="n">col_sample</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">row_sample</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>
                                <span class="n">dropout</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">fit_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Elapsed </span><span class="si">{</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fit_obj</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fit_obj</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;roc_auc&quot;</span><span class="p">))</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Elapsed </span><span class="si">{</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</code></pre>
</div>
</div>


                                <div id="RandomBagClassifier.fit" class="classattr">
                                            <input id="RandomBagClassifier.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RandomBagClassifier.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RandomBagClassifier.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RandomBagClassifier.fit-181"><a href="#RandomBagClassifier.fit-181"><span class="linenos">181</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="RandomBagClassifier.fit-182"><a href="#RandomBagClassifier.fit-182"><span class="linenos">182</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Random &#39;Bagging&#39; model to training data (X, y).</span>
</span><span id="RandomBagClassifier.fit-183"><a href="#RandomBagClassifier.fit-183"><span class="linenos">183</span></a>
</span><span id="RandomBagClassifier.fit-184"><a href="#RandomBagClassifier.fit-184"><span class="linenos">184</span></a><span class="sd">        Args:</span>
</span><span id="RandomBagClassifier.fit-185"><a href="#RandomBagClassifier.fit-185"><span class="linenos">185</span></a>
</span><span id="RandomBagClassifier.fit-186"><a href="#RandomBagClassifier.fit-186"><span class="linenos">186</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="RandomBagClassifier.fit-187"><a href="#RandomBagClassifier.fit-187"><span class="linenos">187</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="RandomBagClassifier.fit-188"><a href="#RandomBagClassifier.fit-188"><span class="linenos">188</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="RandomBagClassifier.fit-189"><a href="#RandomBagClassifier.fit-189"><span class="linenos">189</span></a>
</span><span id="RandomBagClassifier.fit-190"><a href="#RandomBagClassifier.fit-190"><span class="linenos">190</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="RandomBagClassifier.fit-191"><a href="#RandomBagClassifier.fit-191"><span class="linenos">191</span></a><span class="sd">                Target values.</span>
</span><span id="RandomBagClassifier.fit-192"><a href="#RandomBagClassifier.fit-192"><span class="linenos">192</span></a>
</span><span id="RandomBagClassifier.fit-193"><a href="#RandomBagClassifier.fit-193"><span class="linenos">193</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="RandomBagClassifier.fit-194"><a href="#RandomBagClassifier.fit-194"><span class="linenos">194</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="RandomBagClassifier.fit-195"><a href="#RandomBagClassifier.fit-195"><span class="linenos">195</span></a>
</span><span id="RandomBagClassifier.fit-196"><a href="#RandomBagClassifier.fit-196"><span class="linenos">196</span></a><span class="sd">        Returns:</span>
</span><span id="RandomBagClassifier.fit-197"><a href="#RandomBagClassifier.fit-197"><span class="linenos">197</span></a>
</span><span id="RandomBagClassifier.fit-198"><a href="#RandomBagClassifier.fit-198"><span class="linenos">198</span></a><span class="sd">            self: object</span>
</span><span id="RandomBagClassifier.fit-199"><a href="#RandomBagClassifier.fit-199"><span class="linenos">199</span></a>
</span><span id="RandomBagClassifier.fit-200"><a href="#RandomBagClassifier.fit-200"><span class="linenos">200</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RandomBagClassifier.fit-201"><a href="#RandomBagClassifier.fit-201"><span class="linenos">201</span></a>
</span><span id="RandomBagClassifier.fit-202"><a href="#RandomBagClassifier.fit-202"><span class="linenos">202</span></a>        <span class="k">assert</span> <span class="n">mx</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s2">&quot;y must contain only integers&quot;</span>
</span><span id="RandomBagClassifier.fit-203"><a href="#RandomBagClassifier.fit-203"><span class="linenos">203</span></a>
</span><span id="RandomBagClassifier.fit-204"><a href="#RandomBagClassifier.fit-204"><span class="linenos">204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="RandomBagClassifier.fit-205"><a href="#RandomBagClassifier.fit-205"><span class="linenos">205</span></a>
</span><span id="RandomBagClassifier.fit-206"><a href="#RandomBagClassifier.fit-206"><span class="linenos">206</span></a>        <span class="c1"># training</span>
</span><span id="RandomBagClassifier.fit-207"><a href="#RandomBagClassifier.fit-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="RandomBagClassifier.fit-208"><a href="#RandomBagClassifier.fit-208"><span class="linenos">208</span></a>
</span><span id="RandomBagClassifier.fit-209"><a href="#RandomBagClassifier.fit-209"><span class="linenos">209</span></a>        <span class="n">base_learner</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="RandomBagClassifier.fit-210"><a href="#RandomBagClassifier.fit-210"><span class="linenos">210</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span>
</span><span id="RandomBagClassifier.fit-211"><a href="#RandomBagClassifier.fit-211"><span class="linenos">211</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="RandomBagClassifier.fit-212"><a href="#RandomBagClassifier.fit-212"><span class="linenos">212</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="RandomBagClassifier.fit-213"><a href="#RandomBagClassifier.fit-213"><span class="linenos">213</span></a>            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="RandomBagClassifier.fit-214"><a href="#RandomBagClassifier.fit-214"><span class="linenos">214</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="RandomBagClassifier.fit-215"><a href="#RandomBagClassifier.fit-215"><span class="linenos">215</span></a>            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="RandomBagClassifier.fit-216"><a href="#RandomBagClassifier.fit-216"><span class="linenos">216</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="RandomBagClassifier.fit-217"><a href="#RandomBagClassifier.fit-217"><span class="linenos">217</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="RandomBagClassifier.fit-218"><a href="#RandomBagClassifier.fit-218"><span class="linenos">218</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="RandomBagClassifier.fit-219"><a href="#RandomBagClassifier.fit-219"><span class="linenos">219</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="RandomBagClassifier.fit-220"><a href="#RandomBagClassifier.fit-220"><span class="linenos">220</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="RandomBagClassifier.fit-221"><a href="#RandomBagClassifier.fit-221"><span class="linenos">221</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="RandomBagClassifier.fit-222"><a href="#RandomBagClassifier.fit-222"><span class="linenos">222</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="RandomBagClassifier.fit-223"><a href="#RandomBagClassifier.fit-223"><span class="linenos">223</span></a>            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="RandomBagClassifier.fit-224"><a href="#RandomBagClassifier.fit-224"><span class="linenos">224</span></a>        <span class="p">)</span>
</span><span id="RandomBagClassifier.fit-225"><a href="#RandomBagClassifier.fit-225"><span class="linenos">225</span></a>
</span><span id="RandomBagClassifier.fit-226"><a href="#RandomBagClassifier.fit-226"><span class="linenos">226</span></a>        <span class="c1"># 1 - Sequential training -----</span>
</span><span id="RandomBagClassifier.fit-227"><a href="#RandomBagClassifier.fit-227"><span class="linenos">227</span></a>
</span><span id="RandomBagClassifier.fit-228"><a href="#RandomBagClassifier.fit-228"><span class="linenos">228</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RandomBagClassifier.fit-229"><a href="#RandomBagClassifier.fit-229"><span class="linenos">229</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">voter_</span> <span class="o">=</span> <span class="n">rbagloop_classification</span><span class="p">(</span>
</span><span id="RandomBagClassifier.fit-230"><a href="#RandomBagClassifier.fit-230"><span class="linenos">230</span></a>                <span class="n">base_learner</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed</span>
</span><span id="RandomBagClassifier.fit-231"><a href="#RandomBagClassifier.fit-231"><span class="linenos">231</span></a>            <span class="p">)</span>
</span><span id="RandomBagClassifier.fit-232"><a href="#RandomBagClassifier.fit-232"><span class="linenos">232</span></a>
</span><span id="RandomBagClassifier.fit-233"><a href="#RandomBagClassifier.fit-233"><span class="linenos">233</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">)</span>
</span><span id="RandomBagClassifier.fit-234"><a href="#RandomBagClassifier.fit-234"><span class="linenos">234</span></a>
</span><span id="RandomBagClassifier.fit-235"><a href="#RandomBagClassifier.fit-235"><span class="linenos">235</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="RandomBagClassifier.fit-236"><a href="#RandomBagClassifier.fit-236"><span class="linenos">236</span></a>
</span><span id="RandomBagClassifier.fit-237"><a href="#RandomBagClassifier.fit-237"><span class="linenos">237</span></a>        <span class="c1"># 2 - Parallel training -----</span>
</span><span id="RandomBagClassifier.fit-238"><a href="#RandomBagClassifier.fit-238"><span class="linenos">238</span></a>        <span class="c1"># buggy</span>
</span><span id="RandomBagClassifier.fit-239"><a href="#RandomBagClassifier.fit-239"><span class="linenos">239</span></a>        <span class="c1"># if self.n_jobs is not None:</span>
</span><span id="RandomBagClassifier.fit-240"><a href="#RandomBagClassifier.fit-240"><span class="linenos">240</span></a>        <span class="k">def</span> <span class="nf">fit_estimators</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="RandomBagClassifier.fit-241"><a href="#RandomBagClassifier.fit-241"><span class="linenos">241</span></a>            <span class="n">base_learner__</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">base_learner</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</span><span id="RandomBagClassifier.fit-242"><a href="#RandomBagClassifier.fit-242"><span class="linenos">242</span></a>            <span class="n">base_learner__</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">+</span> <span class="n">m</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
</span><span id="RandomBagClassifier.fit-243"><a href="#RandomBagClassifier.fit-243"><span class="linenos">243</span></a>            <span class="n">base_learner__</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="RandomBagClassifier.fit-244"><a href="#RandomBagClassifier.fit-244"><span class="linenos">244</span></a>            <span class="k">return</span> <span class="n">base_learner__</span>
</span><span id="RandomBagClassifier.fit-245"><a href="#RandomBagClassifier.fit-245"><span class="linenos">245</span></a>
</span><span id="RandomBagClassifier.fit-246"><a href="#RandomBagClassifier.fit-246"><span class="linenos">246</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="RandomBagClassifier.fit-247"><a href="#RandomBagClassifier.fit-247"><span class="linenos">247</span></a>            <span class="n">voters_list</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)(</span>
</span><span id="RandomBagClassifier.fit-248"><a href="#RandomBagClassifier.fit-248"><span class="linenos">248</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="n">fit_estimators</span><span class="p">)(</span><span class="n">m</span><span class="p">)</span>
</span><span id="RandomBagClassifier.fit-249"><a href="#RandomBagClassifier.fit-249"><span class="linenos">249</span></a>                <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">))</span>
</span><span id="RandomBagClassifier.fit-250"><a href="#RandomBagClassifier.fit-250"><span class="linenos">250</span></a>            <span class="p">)</span>
</span><span id="RandomBagClassifier.fit-251"><a href="#RandomBagClassifier.fit-251"><span class="linenos">251</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RandomBagClassifier.fit-252"><a href="#RandomBagClassifier.fit-252"><span class="linenos">252</span></a>            <span class="n">voters_list</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)(</span>
</span><span id="RandomBagClassifier.fit-253"><a href="#RandomBagClassifier.fit-253"><span class="linenos">253</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="n">fit_estimators</span><span class="p">)(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="RandomBagClassifier.fit-254"><a href="#RandomBagClassifier.fit-254"><span class="linenos">254</span></a>            <span class="p">)</span>
</span><span id="RandomBagClassifier.fit-255"><a href="#RandomBagClassifier.fit-255"><span class="linenos">255</span></a>
</span><span id="RandomBagClassifier.fit-256"><a href="#RandomBagClassifier.fit-256"><span class="linenos">256</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">voter_</span> <span class="o">=</span> <span class="p">{</span><span class="n">idx</span><span class="p">:</span> <span class="n">elt</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">elt</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">voters_list</span><span class="p">)}</span>
</span><span id="RandomBagClassifier.fit-257"><a href="#RandomBagClassifier.fit-257"><span class="linenos">257</span></a>
</span><span id="RandomBagClassifier.fit-258"><a href="#RandomBagClassifier.fit-258"><span class="linenos">258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">)</span>
</span><span id="RandomBagClassifier.fit-259"><a href="#RandomBagClassifier.fit-259"><span class="linenos">259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="RandomBagClassifier.fit-260"><a href="#RandomBagClassifier.fit-260"><span class="linenos">260</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit Random 'Bagging' model to training data (X, y).</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

y: array-like, shape = [n_samples]
    Target values.

**kwargs: additional parameters to be passed to
        self.cook_training_set or self.obj.fit
</code></pre>

<p>Returns:</p>

<pre><code>self: object
</code></pre>
</div>


                                </div>
                                <div id="RandomBagClassifier.predict" class="classattr">
                                            <input id="RandomBagClassifier.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">weights</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RandomBagClassifier.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RandomBagClassifier.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RandomBagClassifier.predict-262"><a href="#RandomBagClassifier.predict-262"><span class="linenos">262</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="RandomBagClassifier.predict-263"><a href="#RandomBagClassifier.predict-263"><span class="linenos">263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="RandomBagClassifier.predict-264"><a href="#RandomBagClassifier.predict-264"><span class="linenos">264</span></a>
</span><span id="RandomBagClassifier.predict-265"><a href="#RandomBagClassifier.predict-265"><span class="linenos">265</span></a><span class="sd">        Args:</span>
</span><span id="RandomBagClassifier.predict-266"><a href="#RandomBagClassifier.predict-266"><span class="linenos">266</span></a>
</span><span id="RandomBagClassifier.predict-267"><a href="#RandomBagClassifier.predict-267"><span class="linenos">267</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="RandomBagClassifier.predict-268"><a href="#RandomBagClassifier.predict-268"><span class="linenos">268</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="RandomBagClassifier.predict-269"><a href="#RandomBagClassifier.predict-269"><span class="linenos">269</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="RandomBagClassifier.predict-270"><a href="#RandomBagClassifier.predict-270"><span class="linenos">270</span></a>
</span><span id="RandomBagClassifier.predict-271"><a href="#RandomBagClassifier.predict-271"><span class="linenos">271</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="RandomBagClassifier.predict-272"><a href="#RandomBagClassifier.predict-272"><span class="linenos">272</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="RandomBagClassifier.predict-273"><a href="#RandomBagClassifier.predict-273"><span class="linenos">273</span></a>
</span><span id="RandomBagClassifier.predict-274"><a href="#RandomBagClassifier.predict-274"><span class="linenos">274</span></a><span class="sd">        Returns:</span>
</span><span id="RandomBagClassifier.predict-275"><a href="#RandomBagClassifier.predict-275"><span class="linenos">275</span></a>
</span><span id="RandomBagClassifier.predict-276"><a href="#RandomBagClassifier.predict-276"><span class="linenos">276</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="RandomBagClassifier.predict-277"><a href="#RandomBagClassifier.predict-277"><span class="linenos">277</span></a>
</span><span id="RandomBagClassifier.predict-278"><a href="#RandomBagClassifier.predict-278"><span class="linenos">278</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RandomBagClassifier.predict-279"><a href="#RandomBagClassifier.predict-279"><span class="linenos">279</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>model predictions: {array-like}
</code></pre>
</div>


                                </div>
                                <div id="RandomBagClassifier.predict_proba" class="classattr">
                                            <input id="RandomBagClassifier.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">weights</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="RandomBagClassifier.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RandomBagClassifier.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="RandomBagClassifier.predict_proba-281"><a href="#RandomBagClassifier.predict_proba-281"><span class="linenos">281</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="RandomBagClassifier.predict_proba-282"><a href="#RandomBagClassifier.predict_proba-282"><span class="linenos">282</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probabilities for test data X.</span>
</span><span id="RandomBagClassifier.predict_proba-283"><a href="#RandomBagClassifier.predict_proba-283"><span class="linenos">283</span></a>
</span><span id="RandomBagClassifier.predict_proba-284"><a href="#RandomBagClassifier.predict_proba-284"><span class="linenos">284</span></a><span class="sd">        Args:</span>
</span><span id="RandomBagClassifier.predict_proba-285"><a href="#RandomBagClassifier.predict_proba-285"><span class="linenos">285</span></a>
</span><span id="RandomBagClassifier.predict_proba-286"><a href="#RandomBagClassifier.predict_proba-286"><span class="linenos">286</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="RandomBagClassifier.predict_proba-287"><a href="#RandomBagClassifier.predict_proba-287"><span class="linenos">287</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="RandomBagClassifier.predict_proba-288"><a href="#RandomBagClassifier.predict_proba-288"><span class="linenos">288</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="RandomBagClassifier.predict_proba-289"><a href="#RandomBagClassifier.predict_proba-289"><span class="linenos">289</span></a>
</span><span id="RandomBagClassifier.predict_proba-290"><a href="#RandomBagClassifier.predict_proba-290"><span class="linenos">290</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="RandomBagClassifier.predict_proba-291"><a href="#RandomBagClassifier.predict_proba-291"><span class="linenos">291</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="RandomBagClassifier.predict_proba-292"><a href="#RandomBagClassifier.predict_proba-292"><span class="linenos">292</span></a>
</span><span id="RandomBagClassifier.predict_proba-293"><a href="#RandomBagClassifier.predict_proba-293"><span class="linenos">293</span></a><span class="sd">        Returns:</span>
</span><span id="RandomBagClassifier.predict_proba-294"><a href="#RandomBagClassifier.predict_proba-294"><span class="linenos">294</span></a>
</span><span id="RandomBagClassifier.predict_proba-295"><a href="#RandomBagClassifier.predict_proba-295"><span class="linenos">295</span></a><span class="sd">            probability estimates for test data: {array-like}</span>
</span><span id="RandomBagClassifier.predict_proba-296"><a href="#RandomBagClassifier.predict_proba-296"><span class="linenos">296</span></a>
</span><span id="RandomBagClassifier.predict_proba-297"><a href="#RandomBagClassifier.predict_proba-297"><span class="linenos">297</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="RandomBagClassifier.predict_proba-298"><a href="#RandomBagClassifier.predict_proba-298"><span class="linenos">298</span></a>
</span><span id="RandomBagClassifier.predict_proba-299"><a href="#RandomBagClassifier.predict_proba-299"><span class="linenos">299</span></a>        <span class="k">def</span> <span class="nf">calculate_probas</span><span class="p">(</span><span class="n">voter</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="RandomBagClassifier.predict_proba-300"><a href="#RandomBagClassifier.predict_proba-300"><span class="linenos">300</span></a>            <span class="n">ensemble_proba</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="RandomBagClassifier.predict_proba-301"><a href="#RandomBagClassifier.predict_proba-301"><span class="linenos">301</span></a>
</span><span id="RandomBagClassifier.predict_proba-302"><a href="#RandomBagClassifier.predict_proba-302"><span class="linenos">302</span></a>            <span class="n">n_iter</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">voter</span><span class="p">)</span>
</span><span id="RandomBagClassifier.predict_proba-303"><a href="#RandomBagClassifier.predict_proba-303"><span class="linenos">303</span></a>
</span><span id="RandomBagClassifier.predict_proba-304"><a href="#RandomBagClassifier.predict_proba-304"><span class="linenos">304</span></a>            <span class="k">assert</span> <span class="n">n_iter</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;no estimator found in `RandomBag` ensemble&quot;</span>
</span><span id="RandomBagClassifier.predict_proba-305"><a href="#RandomBagClassifier.predict_proba-305"><span class="linenos">305</span></a>
</span><span id="RandomBagClassifier.predict_proba-306"><a href="#RandomBagClassifier.predict_proba-306"><span class="linenos">306</span></a>            <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RandomBagClassifier.predict_proba-307"><a href="#RandomBagClassifier.predict_proba-307"><span class="linenos">307</span></a>                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">elt</span> <span class="ow">in</span> <span class="n">voter</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="RandomBagClassifier.predict_proba-308"><a href="#RandomBagClassifier.predict_proba-308"><span class="linenos">308</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="RandomBagClassifier.predict_proba-309"><a href="#RandomBagClassifier.predict_proba-309"><span class="linenos">309</span></a>                        <span class="n">ensemble_proba</span> <span class="o">+=</span> <span class="n">elt</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="RandomBagClassifier.predict_proba-310"><a href="#RandomBagClassifier.predict_proba-310"><span class="linenos">310</span></a>
</span><span id="RandomBagClassifier.predict_proba-311"><a href="#RandomBagClassifier.predict_proba-311"><span class="linenos">311</span></a>                        <span class="c1"># if verbose == 1:</span>
</span><span id="RandomBagClassifier.predict_proba-312"><a href="#RandomBagClassifier.predict_proba-312"><span class="linenos">312</span></a>                        <span class="c1">#    pbar.update(idx)</span>
</span><span id="RandomBagClassifier.predict_proba-313"><a href="#RandomBagClassifier.predict_proba-313"><span class="linenos">313</span></a>
</span><span id="RandomBagClassifier.predict_proba-314"><a href="#RandomBagClassifier.predict_proba-314"><span class="linenos">314</span></a>                    <span class="k">except</span><span class="p">:</span>
</span><span id="RandomBagClassifier.predict_proba-315"><a href="#RandomBagClassifier.predict_proba-315"><span class="linenos">315</span></a>                        <span class="k">continue</span>
</span><span id="RandomBagClassifier.predict_proba-316"><a href="#RandomBagClassifier.predict_proba-316"><span class="linenos">316</span></a>
</span><span id="RandomBagClassifier.predict_proba-317"><a href="#RandomBagClassifier.predict_proba-317"><span class="linenos">317</span></a>                <span class="c1"># if verbose == 1:</span>
</span><span id="RandomBagClassifier.predict_proba-318"><a href="#RandomBagClassifier.predict_proba-318"><span class="linenos">318</span></a>                <span class="c1">#    pbar.update(n_iter)</span>
</span><span id="RandomBagClassifier.predict_proba-319"><a href="#RandomBagClassifier.predict_proba-319"><span class="linenos">319</span></a>
</span><span id="RandomBagClassifier.predict_proba-320"><a href="#RandomBagClassifier.predict_proba-320"><span class="linenos">320</span></a>                <span class="k">return</span> <span class="n">ensemble_proba</span> <span class="o">/</span> <span class="n">n_iter</span>
</span><span id="RandomBagClassifier.predict_proba-321"><a href="#RandomBagClassifier.predict_proba-321"><span class="linenos">321</span></a>
</span><span id="RandomBagClassifier.predict_proba-322"><a href="#RandomBagClassifier.predict_proba-322"><span class="linenos">322</span></a>            <span class="c1"># if weights is not None:</span>
</span><span id="RandomBagClassifier.predict_proba-323"><a href="#RandomBagClassifier.predict_proba-323"><span class="linenos">323</span></a>            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">elt</span> <span class="ow">in</span> <span class="n">voter</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="RandomBagClassifier.predict_proba-324"><a href="#RandomBagClassifier.predict_proba-324"><span class="linenos">324</span></a>                <span class="n">ensemble_proba</span> <span class="o">+=</span> <span class="n">weights</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">elt</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="RandomBagClassifier.predict_proba-325"><a href="#RandomBagClassifier.predict_proba-325"><span class="linenos">325</span></a>
</span><span id="RandomBagClassifier.predict_proba-326"><a href="#RandomBagClassifier.predict_proba-326"><span class="linenos">326</span></a>                <span class="c1"># if verbose == 1:</span>
</span><span id="RandomBagClassifier.predict_proba-327"><a href="#RandomBagClassifier.predict_proba-327"><span class="linenos">327</span></a>                <span class="c1">#    pbar.update(idx)</span>
</span><span id="RandomBagClassifier.predict_proba-328"><a href="#RandomBagClassifier.predict_proba-328"><span class="linenos">328</span></a>
</span><span id="RandomBagClassifier.predict_proba-329"><a href="#RandomBagClassifier.predict_proba-329"><span class="linenos">329</span></a>            <span class="c1"># if verbose == 1:</span>
</span><span id="RandomBagClassifier.predict_proba-330"><a href="#RandomBagClassifier.predict_proba-330"><span class="linenos">330</span></a>            <span class="c1">#    pbar.update(n_iter)</span>
</span><span id="RandomBagClassifier.predict_proba-331"><a href="#RandomBagClassifier.predict_proba-331"><span class="linenos">331</span></a>
</span><span id="RandomBagClassifier.predict_proba-332"><a href="#RandomBagClassifier.predict_proba-332"><span class="linenos">332</span></a>            <span class="k">return</span> <span class="n">ensemble_proba</span>
</span><span id="RandomBagClassifier.predict_proba-333"><a href="#RandomBagClassifier.predict_proba-333"><span class="linenos">333</span></a>
</span><span id="RandomBagClassifier.predict_proba-334"><a href="#RandomBagClassifier.predict_proba-334"><span class="linenos">334</span></a>        <span class="c1"># end calculate_probas ----</span>
</span><span id="RandomBagClassifier.predict_proba-335"><a href="#RandomBagClassifier.predict_proba-335"><span class="linenos">335</span></a>
</span><span id="RandomBagClassifier.predict_proba-336"><a href="#RandomBagClassifier.predict_proba-336"><span class="linenos">336</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RandomBagClassifier.predict_proba-337"><a href="#RandomBagClassifier.predict_proba-337"><span class="linenos">337</span></a>            <span class="c1"># if self.verbose == 1:</span>
</span><span id="RandomBagClassifier.predict_proba-338"><a href="#RandomBagClassifier.predict_proba-338"><span class="linenos">338</span></a>            <span class="c1">#    pbar = Progbar(self.n_estimators)</span>
</span><span id="RandomBagClassifier.predict_proba-339"><a href="#RandomBagClassifier.predict_proba-339"><span class="linenos">339</span></a>
</span><span id="RandomBagClassifier.predict_proba-340"><a href="#RandomBagClassifier.predict_proba-340"><span class="linenos">340</span></a>            <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RandomBagClassifier.predict_proba-341"><a href="#RandomBagClassifier.predict_proba-341"><span class="linenos">341</span></a>                <span class="k">return</span> <span class="n">calculate_probas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="RandomBagClassifier.predict_proba-342"><a href="#RandomBagClassifier.predict_proba-342"><span class="linenos">342</span></a>
</span><span id="RandomBagClassifier.predict_proba-343"><a href="#RandomBagClassifier.predict_proba-343"><span class="linenos">343</span></a>            <span class="c1"># if weights is not None:</span>
</span><span id="RandomBagClassifier.predict_proba-344"><a href="#RandomBagClassifier.predict_proba-344"><span class="linenos">344</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span>
</span><span id="RandomBagClassifier.predict_proba-345"><a href="#RandomBagClassifier.predict_proba-345"><span class="linenos">345</span></a>
</span><span id="RandomBagClassifier.predict_proba-346"><a href="#RandomBagClassifier.predict_proba-346"><span class="linenos">346</span></a>            <span class="k">return</span> <span class="n">calculate_probas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
</span><span id="RandomBagClassifier.predict_proba-347"><a href="#RandomBagClassifier.predict_proba-347"><span class="linenos">347</span></a>
</span><span id="RandomBagClassifier.predict_proba-348"><a href="#RandomBagClassifier.predict_proba-348"><span class="linenos">348</span></a>        <span class="c1"># if self.n_jobs is not None:</span>
</span><span id="RandomBagClassifier.predict_proba-349"><a href="#RandomBagClassifier.predict_proba-349"><span class="linenos">349</span></a>        <span class="k">def</span> <span class="nf">predict_estimator</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="RandomBagClassifier.predict_proba-350"><a href="#RandomBagClassifier.predict_proba-350"><span class="linenos">350</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="RandomBagClassifier.predict_proba-351"><a href="#RandomBagClassifier.predict_proba-351"><span class="linenos">351</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">voter_</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span><span id="RandomBagClassifier.predict_proba-352"><a href="#RandomBagClassifier.predict_proba-352"><span class="linenos">352</span></a>            <span class="k">except</span><span class="p">:</span>
</span><span id="RandomBagClassifier.predict_proba-353"><a href="#RandomBagClassifier.predict_proba-353"><span class="linenos">353</span></a>                <span class="k">pass</span>
</span><span id="RandomBagClassifier.predict_proba-354"><a href="#RandomBagClassifier.predict_proba-354"><span class="linenos">354</span></a>
</span><span id="RandomBagClassifier.predict_proba-355"><a href="#RandomBagClassifier.predict_proba-355"><span class="linenos">355</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="RandomBagClassifier.predict_proba-356"><a href="#RandomBagClassifier.predict_proba-356"><span class="linenos">356</span></a>            <span class="n">preds</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)(</span>
</span><span id="RandomBagClassifier.predict_proba-357"><a href="#RandomBagClassifier.predict_proba-357"><span class="linenos">357</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="n">predict_estimator</span><span class="p">)(</span><span class="n">m</span><span class="p">)</span>
</span><span id="RandomBagClassifier.predict_proba-358"><a href="#RandomBagClassifier.predict_proba-358"><span class="linenos">358</span></a>                <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">))</span>
</span><span id="RandomBagClassifier.predict_proba-359"><a href="#RandomBagClassifier.predict_proba-359"><span class="linenos">359</span></a>            <span class="p">)</span>
</span><span id="RandomBagClassifier.predict_proba-360"><a href="#RandomBagClassifier.predict_proba-360"><span class="linenos">360</span></a>
</span><span id="RandomBagClassifier.predict_proba-361"><a href="#RandomBagClassifier.predict_proba-361"><span class="linenos">361</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RandomBagClassifier.predict_proba-362"><a href="#RandomBagClassifier.predict_proba-362"><span class="linenos">362</span></a>            <span class="n">preds</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">prefer</span><span class="o">=</span><span class="s2">&quot;threads&quot;</span><span class="p">)(</span>
</span><span id="RandomBagClassifier.predict_proba-363"><a href="#RandomBagClassifier.predict_proba-363"><span class="linenos">363</span></a>                <span class="n">delayed</span><span class="p">(</span><span class="n">predict_estimator</span><span class="p">)(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">)</span>
</span><span id="RandomBagClassifier.predict_proba-364"><a href="#RandomBagClassifier.predict_proba-364"><span class="linenos">364</span></a>            <span class="p">)</span>
</span><span id="RandomBagClassifier.predict_proba-365"><a href="#RandomBagClassifier.predict_proba-365"><span class="linenos">365</span></a>
</span><span id="RandomBagClassifier.predict_proba-366"><a href="#RandomBagClassifier.predict_proba-366"><span class="linenos">366</span></a>        <span class="n">ensemble_proba</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="RandomBagClassifier.predict_proba-367"><a href="#RandomBagClassifier.predict_proba-367"><span class="linenos">367</span></a>
</span><span id="RandomBagClassifier.predict_proba-368"><a href="#RandomBagClassifier.predict_proba-368"><span class="linenos">368</span></a>        <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="RandomBagClassifier.predict_proba-369"><a href="#RandomBagClassifier.predict_proba-369"><span class="linenos">369</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="RandomBagClassifier.predict_proba-370"><a href="#RandomBagClassifier.predict_proba-370"><span class="linenos">370</span></a>                <span class="n">ensemble_proba</span> <span class="o">+=</span> <span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="RandomBagClassifier.predict_proba-371"><a href="#RandomBagClassifier.predict_proba-371"><span class="linenos">371</span></a>
</span><span id="RandomBagClassifier.predict_proba-372"><a href="#RandomBagClassifier.predict_proba-372"><span class="linenos">372</span></a>            <span class="k">return</span> <span class="n">ensemble_proba</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span>
</span><span id="RandomBagClassifier.predict_proba-373"><a href="#RandomBagClassifier.predict_proba-373"><span class="linenos">373</span></a>
</span><span id="RandomBagClassifier.predict_proba-374"><a href="#RandomBagClassifier.predict_proba-374"><span class="linenos">374</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_estimators</span><span class="p">):</span>
</span><span id="RandomBagClassifier.predict_proba-375"><a href="#RandomBagClassifier.predict_proba-375"><span class="linenos">375</span></a>            <span class="n">ensemble_proba</span> <span class="o">+=</span> <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">preds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="RandomBagClassifier.predict_proba-376"><a href="#RandomBagClassifier.predict_proba-376"><span class="linenos">376</span></a>
</span><span id="RandomBagClassifier.predict_proba-377"><a href="#RandomBagClassifier.predict_proba-377"><span class="linenos">377</span></a>        <span class="k">return</span> <span class="n">ensemble_proba</span>
</span></pre></div>


            <div class="docstring"><p>Predict probabilities for test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>probability estimates for test data: {array-like}
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="Ridge2Regressor">
                            <input id="Ridge2Regressor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Ridge2Regressor</span><wbr>(<span class="base">nnetsauce.ridge2.ridge2.Ridge2</span>, <span class="base">sklearn.base.RegressorMixin</span>):

                <label class="view-source-button" for="Ridge2Regressor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Ridge2Regressor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Ridge2Regressor-21"><a href="#Ridge2Regressor-21"><span class="linenos"> 21</span></a><span class="k">class</span> <span class="nc">Ridge2Regressor</span><span class="p">(</span><span class="n">Ridge2</span><span class="p">,</span> <span class="n">RegressorMixin</span><span class="p">):</span>
</span><span id="Ridge2Regressor-22"><a href="#Ridge2Regressor-22"><span class="linenos"> 22</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Ridge regression with 2 regularization parameters derived from class Ridge</span>
</span><span id="Ridge2Regressor-23"><a href="#Ridge2Regressor-23"><span class="linenos"> 23</span></a>
</span><span id="Ridge2Regressor-24"><a href="#Ridge2Regressor-24"><span class="linenos"> 24</span></a><span class="sd">    Parameters:</span>
</span><span id="Ridge2Regressor-25"><a href="#Ridge2Regressor-25"><span class="linenos"> 25</span></a>
</span><span id="Ridge2Regressor-26"><a href="#Ridge2Regressor-26"><span class="linenos"> 26</span></a><span class="sd">        n_hidden_features: int</span>
</span><span id="Ridge2Regressor-27"><a href="#Ridge2Regressor-27"><span class="linenos"> 27</span></a><span class="sd">            number of nodes in the hidden layer</span>
</span><span id="Ridge2Regressor-28"><a href="#Ridge2Regressor-28"><span class="linenos"> 28</span></a>
</span><span id="Ridge2Regressor-29"><a href="#Ridge2Regressor-29"><span class="linenos"> 29</span></a><span class="sd">        activation_name: str</span>
</span><span id="Ridge2Regressor-30"><a href="#Ridge2Regressor-30"><span class="linenos"> 30</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;</span>
</span><span id="Ridge2Regressor-31"><a href="#Ridge2Regressor-31"><span class="linenos"> 31</span></a>
</span><span id="Ridge2Regressor-32"><a href="#Ridge2Regressor-32"><span class="linenos"> 32</span></a><span class="sd">        a: float</span>
</span><span id="Ridge2Regressor-33"><a href="#Ridge2Regressor-33"><span class="linenos"> 33</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function</span>
</span><span id="Ridge2Regressor-34"><a href="#Ridge2Regressor-34"><span class="linenos"> 34</span></a>
</span><span id="Ridge2Regressor-35"><a href="#Ridge2Regressor-35"><span class="linenos"> 35</span></a><span class="sd">        nodes_sim: str</span>
</span><span id="Ridge2Regressor-36"><a href="#Ridge2Regressor-36"><span class="linenos"> 36</span></a><span class="sd">            type of simulation for the nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;,</span>
</span><span id="Ridge2Regressor-37"><a href="#Ridge2Regressor-37"><span class="linenos"> 37</span></a><span class="sd">            &#39;uniform&#39;</span>
</span><span id="Ridge2Regressor-38"><a href="#Ridge2Regressor-38"><span class="linenos"> 38</span></a>
</span><span id="Ridge2Regressor-39"><a href="#Ridge2Regressor-39"><span class="linenos"> 39</span></a><span class="sd">        bias: boolean</span>
</span><span id="Ridge2Regressor-40"><a href="#Ridge2Regressor-40"><span class="linenos"> 40</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or not</span>
</span><span id="Ridge2Regressor-41"><a href="#Ridge2Regressor-41"><span class="linenos"> 41</span></a><span class="sd">            (False)</span>
</span><span id="Ridge2Regressor-42"><a href="#Ridge2Regressor-42"><span class="linenos"> 42</span></a>
</span><span id="Ridge2Regressor-43"><a href="#Ridge2Regressor-43"><span class="linenos"> 43</span></a><span class="sd">        dropout: float</span>
</span><span id="Ridge2Regressor-44"><a href="#Ridge2Regressor-44"><span class="linenos"> 44</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="Ridge2Regressor-45"><a href="#Ridge2Regressor-45"><span class="linenos"> 45</span></a><span class="sd">            of the training</span>
</span><span id="Ridge2Regressor-46"><a href="#Ridge2Regressor-46"><span class="linenos"> 46</span></a>
</span><span id="Ridge2Regressor-47"><a href="#Ridge2Regressor-47"><span class="linenos"> 47</span></a><span class="sd">        n_clusters: int</span>
</span><span id="Ridge2Regressor-48"><a href="#Ridge2Regressor-48"><span class="linenos"> 48</span></a><span class="sd">            number of clusters for &#39;kmeans&#39; or &#39;gmm&#39; clustering (could be 0:</span>
</span><span id="Ridge2Regressor-49"><a href="#Ridge2Regressor-49"><span class="linenos"> 49</span></a><span class="sd">                no clustering)</span>
</span><span id="Ridge2Regressor-50"><a href="#Ridge2Regressor-50"><span class="linenos"> 50</span></a>
</span><span id="Ridge2Regressor-51"><a href="#Ridge2Regressor-51"><span class="linenos"> 51</span></a><span class="sd">        cluster_encode: bool</span>
</span><span id="Ridge2Regressor-52"><a href="#Ridge2Regressor-52"><span class="linenos"> 52</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot)</span>
</span><span id="Ridge2Regressor-53"><a href="#Ridge2Regressor-53"><span class="linenos"> 53</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding</span>
</span><span id="Ridge2Regressor-54"><a href="#Ridge2Regressor-54"><span class="linenos"> 54</span></a>
</span><span id="Ridge2Regressor-55"><a href="#Ridge2Regressor-55"><span class="linenos"> 55</span></a><span class="sd">        type_clust: str</span>
</span><span id="Ridge2Regressor-56"><a href="#Ridge2Regressor-56"><span class="linenos"> 56</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian</span>
</span><span id="Ridge2Regressor-57"><a href="#Ridge2Regressor-57"><span class="linenos"> 57</span></a><span class="sd">            Mixture Model (&#39;gmm&#39;)</span>
</span><span id="Ridge2Regressor-58"><a href="#Ridge2Regressor-58"><span class="linenos"> 58</span></a>
</span><span id="Ridge2Regressor-59"><a href="#Ridge2Regressor-59"><span class="linenos"> 59</span></a><span class="sd">        type_scaling: a tuple of 3 strings</span>
</span><span id="Ridge2Regressor-60"><a href="#Ridge2Regressor-60"><span class="linenos"> 60</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="Ridge2Regressor-61"><a href="#Ridge2Regressor-61"><span class="linenos"> 61</span></a><span class="sd">            (and when relevant).</span>
</span><span id="Ridge2Regressor-62"><a href="#Ridge2Regressor-62"><span class="linenos"> 62</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;)</span>
</span><span id="Ridge2Regressor-63"><a href="#Ridge2Regressor-63"><span class="linenos"> 63</span></a>
</span><span id="Ridge2Regressor-64"><a href="#Ridge2Regressor-64"><span class="linenos"> 64</span></a><span class="sd">        lambda1: float</span>
</span><span id="Ridge2Regressor-65"><a href="#Ridge2Regressor-65"><span class="linenos"> 65</span></a><span class="sd">            regularization parameter on direct link</span>
</span><span id="Ridge2Regressor-66"><a href="#Ridge2Regressor-66"><span class="linenos"> 66</span></a>
</span><span id="Ridge2Regressor-67"><a href="#Ridge2Regressor-67"><span class="linenos"> 67</span></a><span class="sd">        lambda2: float</span>
</span><span id="Ridge2Regressor-68"><a href="#Ridge2Regressor-68"><span class="linenos"> 68</span></a><span class="sd">            regularization parameter on hidden layer</span>
</span><span id="Ridge2Regressor-69"><a href="#Ridge2Regressor-69"><span class="linenos"> 69</span></a>
</span><span id="Ridge2Regressor-70"><a href="#Ridge2Regressor-70"><span class="linenos"> 70</span></a><span class="sd">        seed: int</span>
</span><span id="Ridge2Regressor-71"><a href="#Ridge2Regressor-71"><span class="linenos"> 71</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39;</span>
</span><span id="Ridge2Regressor-72"><a href="#Ridge2Regressor-72"><span class="linenos"> 72</span></a>
</span><span id="Ridge2Regressor-73"><a href="#Ridge2Regressor-73"><span class="linenos"> 73</span></a><span class="sd">        backend: str</span>
</span><span id="Ridge2Regressor-74"><a href="#Ridge2Regressor-74"><span class="linenos"> 74</span></a><span class="sd">            &#39;cpu&#39; or &#39;gpu&#39; or &#39;tpu&#39;</span>
</span><span id="Ridge2Regressor-75"><a href="#Ridge2Regressor-75"><span class="linenos"> 75</span></a>
</span><span id="Ridge2Regressor-76"><a href="#Ridge2Regressor-76"><span class="linenos"> 76</span></a><span class="sd">    Attributes:</span>
</span><span id="Ridge2Regressor-77"><a href="#Ridge2Regressor-77"><span class="linenos"> 77</span></a>
</span><span id="Ridge2Regressor-78"><a href="#Ridge2Regressor-78"><span class="linenos"> 78</span></a><span class="sd">        beta_: {array-like}</span>
</span><span id="Ridge2Regressor-79"><a href="#Ridge2Regressor-79"><span class="linenos"> 79</span></a><span class="sd">            regression coefficients</span>
</span><span id="Ridge2Regressor-80"><a href="#Ridge2Regressor-80"><span class="linenos"> 80</span></a>
</span><span id="Ridge2Regressor-81"><a href="#Ridge2Regressor-81"><span class="linenos"> 81</span></a><span class="sd">        y_mean_: float</span>
</span><span id="Ridge2Regressor-82"><a href="#Ridge2Regressor-82"><span class="linenos"> 82</span></a><span class="sd">            average response</span>
</span><span id="Ridge2Regressor-83"><a href="#Ridge2Regressor-83"><span class="linenos"> 83</span></a>
</span><span id="Ridge2Regressor-84"><a href="#Ridge2Regressor-84"><span class="linenos"> 84</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Ridge2Regressor-85"><a href="#Ridge2Regressor-85"><span class="linenos"> 85</span></a>
</span><span id="Ridge2Regressor-86"><a href="#Ridge2Regressor-86"><span class="linenos"> 86</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="Ridge2Regressor-87"><a href="#Ridge2Regressor-87"><span class="linenos"> 87</span></a>
</span><span id="Ridge2Regressor-88"><a href="#Ridge2Regressor-88"><span class="linenos"> 88</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Ridge2Regressor-89"><a href="#Ridge2Regressor-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Ridge2Regressor-90"><a href="#Ridge2Regressor-90"><span class="linenos"> 90</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="Ridge2Regressor-91"><a href="#Ridge2Regressor-91"><span class="linenos"> 91</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="Ridge2Regressor-92"><a href="#Ridge2Regressor-92"><span class="linenos"> 92</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="Ridge2Regressor-93"><a href="#Ridge2Regressor-93"><span class="linenos"> 93</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="Ridge2Regressor-94"><a href="#Ridge2Regressor-94"><span class="linenos"> 94</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Ridge2Regressor-95"><a href="#Ridge2Regressor-95"><span class="linenos"> 95</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Ridge2Regressor-96"><a href="#Ridge2Regressor-96"><span class="linenos"> 96</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="Ridge2Regressor-97"><a href="#Ridge2Regressor-97"><span class="linenos"> 97</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Ridge2Regressor-98"><a href="#Ridge2Regressor-98"><span class="linenos"> 98</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="Ridge2Regressor-99"><a href="#Ridge2Regressor-99"><span class="linenos"> 99</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="Ridge2Regressor-100"><a href="#Ridge2Regressor-100"><span class="linenos">100</span></a>        <span class="n">lambda1</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="Ridge2Regressor-101"><a href="#Ridge2Regressor-101"><span class="linenos">101</span></a>        <span class="n">lambda2</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="Ridge2Regressor-102"><a href="#Ridge2Regressor-102"><span class="linenos">102</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="Ridge2Regressor-103"><a href="#Ridge2Regressor-103"><span class="linenos">103</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="Ridge2Regressor-104"><a href="#Ridge2Regressor-104"><span class="linenos">104</span></a>    <span class="p">):</span>
</span><span id="Ridge2Regressor-105"><a href="#Ridge2Regressor-105"><span class="linenos">105</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Ridge2Regressor-106"><a href="#Ridge2Regressor-106"><span class="linenos">106</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Ridge2Regressor-107"><a href="#Ridge2Regressor-107"><span class="linenos">107</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="Ridge2Regressor-108"><a href="#Ridge2Regressor-108"><span class="linenos">108</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="Ridge2Regressor-109"><a href="#Ridge2Regressor-109"><span class="linenos">109</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="Ridge2Regressor-110"><a href="#Ridge2Regressor-110"><span class="linenos">110</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="Ridge2Regressor-111"><a href="#Ridge2Regressor-111"><span class="linenos">111</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="Ridge2Regressor-112"><a href="#Ridge2Regressor-112"><span class="linenos">112</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="Ridge2Regressor-113"><a href="#Ridge2Regressor-113"><span class="linenos">113</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="Ridge2Regressor-114"><a href="#Ridge2Regressor-114"><span class="linenos">114</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="Ridge2Regressor-115"><a href="#Ridge2Regressor-115"><span class="linenos">115</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="Ridge2Regressor-116"><a href="#Ridge2Regressor-116"><span class="linenos">116</span></a>            <span class="n">lambda1</span><span class="o">=</span><span class="n">lambda1</span><span class="p">,</span>
</span><span id="Ridge2Regressor-117"><a href="#Ridge2Regressor-117"><span class="linenos">117</span></a>            <span class="n">lambda2</span><span class="o">=</span><span class="n">lambda2</span><span class="p">,</span>
</span><span id="Ridge2Regressor-118"><a href="#Ridge2Regressor-118"><span class="linenos">118</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Ridge2Regressor-119"><a href="#Ridge2Regressor-119"><span class="linenos">119</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Regressor-120"><a href="#Ridge2Regressor-120"><span class="linenos">120</span></a>        <span class="p">)</span>
</span><span id="Ridge2Regressor-121"><a href="#Ridge2Regressor-121"><span class="linenos">121</span></a>
</span><span id="Ridge2Regressor-122"><a href="#Ridge2Regressor-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_fit</span> <span class="o">=</span> <span class="s2">&quot;regression&quot;</span>
</span><span id="Ridge2Regressor-123"><a href="#Ridge2Regressor-123"><span class="linenos">123</span></a>
</span><span id="Ridge2Regressor-124"><a href="#Ridge2Regressor-124"><span class="linenos">124</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2Regressor-125"><a href="#Ridge2Regressor-125"><span class="linenos">125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Ridge model to training data (X, y).</span>
</span><span id="Ridge2Regressor-126"><a href="#Ridge2Regressor-126"><span class="linenos">126</span></a>
</span><span id="Ridge2Regressor-127"><a href="#Ridge2Regressor-127"><span class="linenos">127</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2Regressor-128"><a href="#Ridge2Regressor-128"><span class="linenos">128</span></a>
</span><span id="Ridge2Regressor-129"><a href="#Ridge2Regressor-129"><span class="linenos">129</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2Regressor-130"><a href="#Ridge2Regressor-130"><span class="linenos">130</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2Regressor-131"><a href="#Ridge2Regressor-131"><span class="linenos">131</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2Regressor-132"><a href="#Ridge2Regressor-132"><span class="linenos">132</span></a>
</span><span id="Ridge2Regressor-133"><a href="#Ridge2Regressor-133"><span class="linenos">133</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="Ridge2Regressor-134"><a href="#Ridge2Regressor-134"><span class="linenos">134</span></a><span class="sd">                Target values.</span>
</span><span id="Ridge2Regressor-135"><a href="#Ridge2Regressor-135"><span class="linenos">135</span></a>
</span><span id="Ridge2Regressor-136"><a href="#Ridge2Regressor-136"><span class="linenos">136</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2Regressor-137"><a href="#Ridge2Regressor-137"><span class="linenos">137</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="Ridge2Regressor-138"><a href="#Ridge2Regressor-138"><span class="linenos">138</span></a>
</span><span id="Ridge2Regressor-139"><a href="#Ridge2Regressor-139"><span class="linenos">139</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2Regressor-140"><a href="#Ridge2Regressor-140"><span class="linenos">140</span></a>
</span><span id="Ridge2Regressor-141"><a href="#Ridge2Regressor-141"><span class="linenos">141</span></a><span class="sd">            self: object</span>
</span><span id="Ridge2Regressor-142"><a href="#Ridge2Regressor-142"><span class="linenos">142</span></a>
</span><span id="Ridge2Regressor-143"><a href="#Ridge2Regressor-143"><span class="linenos">143</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2Regressor-144"><a href="#Ridge2Regressor-144"><span class="linenos">144</span></a>
</span><span id="Ridge2Regressor-145"><a href="#Ridge2Regressor-145"><span class="linenos">145</span></a>        <span class="n">sys_platform</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
</span><span id="Ridge2Regressor-146"><a href="#Ridge2Regressor-146"><span class="linenos">146</span></a>
</span><span id="Ridge2Regressor-147"><a href="#Ridge2Regressor-147"><span class="linenos">147</span></a>        <span class="n">centered_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Ridge2Regressor-148"><a href="#Ridge2Regressor-148"><span class="linenos">148</span></a>
</span><span id="Ridge2Regressor-149"><a href="#Ridge2Regressor-149"><span class="linenos">149</span></a>        <span class="n">n_X</span><span class="p">,</span> <span class="n">p_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="Ridge2Regressor-150"><a href="#Ridge2Regressor-150"><span class="linenos">150</span></a>        <span class="n">n_Z</span><span class="p">,</span> <span class="n">p_Z</span> <span class="o">=</span> <span class="n">scaled_Z</span><span class="o">.</span><span class="n">shape</span>
</span><span id="Ridge2Regressor-151"><a href="#Ridge2Regressor-151"><span class="linenos">151</span></a>
</span><span id="Ridge2Regressor-152"><a href="#Ridge2Regressor-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Ridge2Regressor-153"><a href="#Ridge2Regressor-153"><span class="linenos">153</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode_clusters</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Ridge2Regressor-154"><a href="#Ridge2Regressor-154"><span class="linenos">154</span></a>                <span class="n">n_features</span> <span class="o">=</span> <span class="n">p_X</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span>
</span><span id="Ridge2Regressor-155"><a href="#Ridge2Regressor-155"><span class="linenos">155</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2Regressor-156"><a href="#Ridge2Regressor-156"><span class="linenos">156</span></a>                <span class="n">n_features</span> <span class="o">=</span> <span class="n">p_X</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Ridge2Regressor-157"><a href="#Ridge2Regressor-157"><span class="linenos">157</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2Regressor-158"><a href="#Ridge2Regressor-158"><span class="linenos">158</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">p_X</span>
</span><span id="Ridge2Regressor-159"><a href="#Ridge2Regressor-159"><span class="linenos">159</span></a>
</span><span id="Ridge2Regressor-160"><a href="#Ridge2Regressor-160"><span class="linenos">160</span></a>        <span class="n">X_</span> <span class="o">=</span> <span class="n">scaled_Z</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">n_features</span><span class="p">]</span>
</span><span id="Ridge2Regressor-161"><a href="#Ridge2Regressor-161"><span class="linenos">161</span></a>        <span class="n">Phi_X_</span> <span class="o">=</span> <span class="n">scaled_Z</span><span class="p">[:,</span> <span class="n">n_features</span><span class="p">:</span><span class="n">p_Z</span><span class="p">]</span>
</span><span id="Ridge2Regressor-162"><a href="#Ridge2Regressor-162"><span class="linenos">162</span></a>
</span><span id="Ridge2Regressor-163"><a href="#Ridge2Regressor-163"><span class="linenos">163</span></a>        <span class="n">B</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span>
</span><span id="Ridge2Regressor-164"><a href="#Ridge2Regressor-164"><span class="linenos">164</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)</span>
</span><span id="Ridge2Regressor-165"><a href="#Ridge2Regressor-165"><span class="linenos">165</span></a>        <span class="p">)</span>
</span><span id="Ridge2Regressor-166"><a href="#Ridge2Regressor-166"><span class="linenos">166</span></a>        <span class="n">C</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Phi_X_</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">X_</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2Regressor-167"><a href="#Ridge2Regressor-167"><span class="linenos">167</span></a>        <span class="n">D</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span>
</span><span id="Ridge2Regressor-168"><a href="#Ridge2Regressor-168"><span class="linenos">168</span></a>            <span class="n">x</span><span class="o">=</span><span class="n">Phi_X_</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span>
</span><span id="Ridge2Regressor-169"><a href="#Ridge2Regressor-169"><span class="linenos">169</span></a>        <span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Phi_X_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="Ridge2Regressor-170"><a href="#Ridge2Regressor-170"><span class="linenos">170</span></a>
</span><span id="Ridge2Regressor-171"><a href="#Ridge2Regressor-171"><span class="linenos">171</span></a>        <span class="k">if</span> <span class="n">sys_platform</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Linux&quot;</span><span class="p">,</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">):</span>
</span><span id="Ridge2Regressor-172"><a href="#Ridge2Regressor-172"><span class="linenos">172</span></a>            <span class="n">B_inv</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span> <span class="k">else</span> <span class="n">jpinv</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</span><span id="Ridge2Regressor-173"><a href="#Ridge2Regressor-173"><span class="linenos">173</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2Regressor-174"><a href="#Ridge2Regressor-174"><span class="linenos">174</span></a>            <span class="n">B_inv</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</span><span id="Ridge2Regressor-175"><a href="#Ridge2Regressor-175"><span class="linenos">175</span></a>
</span><span id="Ridge2Regressor-176"><a href="#Ridge2Regressor-176"><span class="linenos">176</span></a>        <span class="n">W</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">B_inv</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2Regressor-177"><a href="#Ridge2Regressor-177"><span class="linenos">177</span></a>        <span class="n">S_mat</span> <span class="o">=</span> <span class="n">D</span> <span class="o">-</span> <span class="n">mo</span><span class="o">.</span><span class="n">tcrossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2Regressor-178"><a href="#Ridge2Regressor-178"><span class="linenos">178</span></a>
</span><span id="Ridge2Regressor-179"><a href="#Ridge2Regressor-179"><span class="linenos">179</span></a>        <span class="k">if</span> <span class="n">sys_platform</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Linux&quot;</span><span class="p">,</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">):</span>
</span><span id="Ridge2Regressor-180"><a href="#Ridge2Regressor-180"><span class="linenos">180</span></a>            <span class="n">S_inv</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">S_mat</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span> <span class="k">else</span> <span class="n">jpinv</span><span class="p">(</span><span class="n">S_mat</span><span class="p">)</span>
</span><span id="Ridge2Regressor-181"><a href="#Ridge2Regressor-181"><span class="linenos">181</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2Regressor-182"><a href="#Ridge2Regressor-182"><span class="linenos">182</span></a>            <span class="n">S_inv</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">S_mat</span><span class="p">)</span>
</span><span id="Ridge2Regressor-183"><a href="#Ridge2Regressor-183"><span class="linenos">183</span></a>
</span><span id="Ridge2Regressor-184"><a href="#Ridge2Regressor-184"><span class="linenos">184</span></a>        <span class="n">Y</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">S_inv</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2Regressor-185"><a href="#Ridge2Regressor-185"><span class="linenos">185</span></a>        <span class="n">inv</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="Ridge2Regressor-186"><a href="#Ridge2Regressor-186"><span class="linenos">186</span></a>            <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span>
</span><span id="Ridge2Regressor-187"><a href="#Ridge2Regressor-187"><span class="linenos">187</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">B_inv</span> <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="Ridge2Regressor-188"><a href="#Ridge2Regressor-188"><span class="linenos">188</span></a>                <span class="n">y</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Y</span><span class="p">),</span>
</span><span id="Ridge2Regressor-189"><a href="#Ridge2Regressor-189"><span class="linenos">189</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Regressor-190"><a href="#Ridge2Regressor-190"><span class="linenos">190</span></a>            <span class="p">),</span>
</span><span id="Ridge2Regressor-191"><a href="#Ridge2Regressor-191"><span class="linenos">191</span></a>            <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="n">Y</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">S_inv</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="Ridge2Regressor-192"><a href="#Ridge2Regressor-192"><span class="linenos">192</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Regressor-193"><a href="#Ridge2Regressor-193"><span class="linenos">193</span></a>        <span class="p">)</span>
</span><span id="Ridge2Regressor-194"><a href="#Ridge2Regressor-194"><span class="linenos">194</span></a>
</span><span id="Ridge2Regressor-195"><a href="#Ridge2Regressor-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Ridge2Regressor-196"><a href="#Ridge2Regressor-196"><span class="linenos">196</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">inv</span><span class="p">,</span>
</span><span id="Ridge2Regressor-197"><a href="#Ridge2Regressor-197"><span class="linenos">197</span></a>            <span class="n">b</span><span class="o">=</span><span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">centered_y</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="Ridge2Regressor-198"><a href="#Ridge2Regressor-198"><span class="linenos">198</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Regressor-199"><a href="#Ridge2Regressor-199"><span class="linenos">199</span></a>        <span class="p">)</span>
</span><span id="Ridge2Regressor-200"><a href="#Ridge2Regressor-200"><span class="linenos">200</span></a>
</span><span id="Ridge2Regressor-201"><a href="#Ridge2Regressor-201"><span class="linenos">201</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Ridge2Regressor-202"><a href="#Ridge2Regressor-202"><span class="linenos">202</span></a>
</span><span id="Ridge2Regressor-203"><a href="#Ridge2Regressor-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2Regressor-204"><a href="#Ridge2Regressor-204"><span class="linenos">204</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="Ridge2Regressor-205"><a href="#Ridge2Regressor-205"><span class="linenos">205</span></a>
</span><span id="Ridge2Regressor-206"><a href="#Ridge2Regressor-206"><span class="linenos">206</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2Regressor-207"><a href="#Ridge2Regressor-207"><span class="linenos">207</span></a>
</span><span id="Ridge2Regressor-208"><a href="#Ridge2Regressor-208"><span class="linenos">208</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2Regressor-209"><a href="#Ridge2Regressor-209"><span class="linenos">209</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2Regressor-210"><a href="#Ridge2Regressor-210"><span class="linenos">210</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2Regressor-211"><a href="#Ridge2Regressor-211"><span class="linenos">211</span></a>
</span><span id="Ridge2Regressor-212"><a href="#Ridge2Regressor-212"><span class="linenos">212</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2Regressor-213"><a href="#Ridge2Regressor-213"><span class="linenos">213</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="Ridge2Regressor-214"><a href="#Ridge2Regressor-214"><span class="linenos">214</span></a>
</span><span id="Ridge2Regressor-215"><a href="#Ridge2Regressor-215"><span class="linenos">215</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2Regressor-216"><a href="#Ridge2Regressor-216"><span class="linenos">216</span></a>
</span><span id="Ridge2Regressor-217"><a href="#Ridge2Regressor-217"><span class="linenos">217</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="Ridge2Regressor-218"><a href="#Ridge2Regressor-218"><span class="linenos">218</span></a>
</span><span id="Ridge2Regressor-219"><a href="#Ridge2Regressor-219"><span class="linenos">219</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2Regressor-220"><a href="#Ridge2Regressor-220"><span class="linenos">220</span></a>
</span><span id="Ridge2Regressor-221"><a href="#Ridge2Regressor-221"><span class="linenos">221</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Ridge2Regressor-222"><a href="#Ridge2Regressor-222"><span class="linenos">222</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Ridge2Regressor-223"><a href="#Ridge2Regressor-223"><span class="linenos">223</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="Ridge2Regressor-224"><a href="#Ridge2Regressor-224"><span class="linenos">224</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="Ridge2Regressor-225"><a href="#Ridge2Regressor-225"><span class="linenos">225</span></a>                <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="Ridge2Regressor-226"><a href="#Ridge2Regressor-226"><span class="linenos">226</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Regressor-227"><a href="#Ridge2Regressor-227"><span class="linenos">227</span></a>            <span class="p">)</span>
</span><span id="Ridge2Regressor-228"><a href="#Ridge2Regressor-228"><span class="linenos">228</span></a>
</span><span id="Ridge2Regressor-229"><a href="#Ridge2Regressor-229"><span class="linenos">229</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="Ridge2Regressor-230"><a href="#Ridge2Regressor-230"><span class="linenos">230</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span>
</span><span id="Ridge2Regressor-231"><a href="#Ridge2Regressor-231"><span class="linenos">231</span></a>                <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Ridge2Regressor-232"><a href="#Ridge2Regressor-232"><span class="linenos">232</span></a>                    <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="Ridge2Regressor-233"><a href="#Ridge2Regressor-233"><span class="linenos">233</span></a>                    <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="Ridge2Regressor-234"><a href="#Ridge2Regressor-234"><span class="linenos">234</span></a>                    <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Regressor-235"><a href="#Ridge2Regressor-235"><span class="linenos">235</span></a>                <span class="p">)</span>
</span><span id="Ridge2Regressor-236"><a href="#Ridge2Regressor-236"><span class="linenos">236</span></a>            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Ridge2Regressor-237"><a href="#Ridge2Regressor-237"><span class="linenos">237</span></a>
</span><span id="Ridge2Regressor-238"><a href="#Ridge2Regressor-238"><span class="linenos">238</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Ridge2Regressor-239"><a href="#Ridge2Regressor-239"><span class="linenos">239</span></a>            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="Ridge2Regressor-240"><a href="#Ridge2Regressor-240"><span class="linenos">240</span></a>            <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="Ridge2Regressor-241"><a href="#Ridge2Regressor-241"><span class="linenos">241</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Regressor-242"><a href="#Ridge2Regressor-242"><span class="linenos">242</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Ridge regression with 2 regularization parameters derived from class Ridge</p>

<p>Parameters:</p>

<pre><code>n_hidden_features: int
    number of nodes in the hidden layer

activation_name: str
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'

a: float
    hyperparameter for 'prelu' or 'elu' activation function

nodes_sim: str
    type of simulation for the nodes: 'sobol', 'hammersley', 'halton',
    'uniform'

bias: boolean
    indicates if the hidden layer contains a bias term (True) or not
    (False)

dropout: float
    regularization parameter; (random) percentage of nodes dropped out
    of the training

n_clusters: int
    number of clusters for 'kmeans' or 'gmm' clustering (could be 0:
        no clustering)

cluster_encode: bool
    defines how the variable containing clusters is treated (default is one-hot)
    if `False`, then labels are used, without one-hot encoding

type_clust: str
    type of clustering method: currently k-means ('kmeans') or Gaussian
    Mixture Model ('gmm')

type_scaling: a tuple of 3 strings
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax')

lambda1: float
    regularization parameter on direct link

lambda2: float
    regularization parameter on hidden layer

seed: int
    reproducibility seed for nodes_sim=='uniform'

backend: str
    'cpu' or 'gpu' or 'tpu'
</code></pre>

<p>Attributes:</p>

<pre><code>beta_: {array-like}
    regression coefficients

y_mean_: float
    average response
</code></pre>
</div>


                                <div id="Ridge2Regressor.fit" class="classattr">
                                            <input id="Ridge2Regressor.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Ridge2Regressor.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Ridge2Regressor.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Ridge2Regressor.fit-124"><a href="#Ridge2Regressor.fit-124"><span class="linenos">124</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2Regressor.fit-125"><a href="#Ridge2Regressor.fit-125"><span class="linenos">125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Ridge model to training data (X, y).</span>
</span><span id="Ridge2Regressor.fit-126"><a href="#Ridge2Regressor.fit-126"><span class="linenos">126</span></a>
</span><span id="Ridge2Regressor.fit-127"><a href="#Ridge2Regressor.fit-127"><span class="linenos">127</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2Regressor.fit-128"><a href="#Ridge2Regressor.fit-128"><span class="linenos">128</span></a>
</span><span id="Ridge2Regressor.fit-129"><a href="#Ridge2Regressor.fit-129"><span class="linenos">129</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2Regressor.fit-130"><a href="#Ridge2Regressor.fit-130"><span class="linenos">130</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2Regressor.fit-131"><a href="#Ridge2Regressor.fit-131"><span class="linenos">131</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2Regressor.fit-132"><a href="#Ridge2Regressor.fit-132"><span class="linenos">132</span></a>
</span><span id="Ridge2Regressor.fit-133"><a href="#Ridge2Regressor.fit-133"><span class="linenos">133</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="Ridge2Regressor.fit-134"><a href="#Ridge2Regressor.fit-134"><span class="linenos">134</span></a><span class="sd">                Target values.</span>
</span><span id="Ridge2Regressor.fit-135"><a href="#Ridge2Regressor.fit-135"><span class="linenos">135</span></a>
</span><span id="Ridge2Regressor.fit-136"><a href="#Ridge2Regressor.fit-136"><span class="linenos">136</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2Regressor.fit-137"><a href="#Ridge2Regressor.fit-137"><span class="linenos">137</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="Ridge2Regressor.fit-138"><a href="#Ridge2Regressor.fit-138"><span class="linenos">138</span></a>
</span><span id="Ridge2Regressor.fit-139"><a href="#Ridge2Regressor.fit-139"><span class="linenos">139</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2Regressor.fit-140"><a href="#Ridge2Regressor.fit-140"><span class="linenos">140</span></a>
</span><span id="Ridge2Regressor.fit-141"><a href="#Ridge2Regressor.fit-141"><span class="linenos">141</span></a><span class="sd">            self: object</span>
</span><span id="Ridge2Regressor.fit-142"><a href="#Ridge2Regressor.fit-142"><span class="linenos">142</span></a>
</span><span id="Ridge2Regressor.fit-143"><a href="#Ridge2Regressor.fit-143"><span class="linenos">143</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2Regressor.fit-144"><a href="#Ridge2Regressor.fit-144"><span class="linenos">144</span></a>
</span><span id="Ridge2Regressor.fit-145"><a href="#Ridge2Regressor.fit-145"><span class="linenos">145</span></a>        <span class="n">sys_platform</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
</span><span id="Ridge2Regressor.fit-146"><a href="#Ridge2Regressor.fit-146"><span class="linenos">146</span></a>
</span><span id="Ridge2Regressor.fit-147"><a href="#Ridge2Regressor.fit-147"><span class="linenos">147</span></a>        <span class="n">centered_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Ridge2Regressor.fit-148"><a href="#Ridge2Regressor.fit-148"><span class="linenos">148</span></a>
</span><span id="Ridge2Regressor.fit-149"><a href="#Ridge2Regressor.fit-149"><span class="linenos">149</span></a>        <span class="n">n_X</span><span class="p">,</span> <span class="n">p_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="Ridge2Regressor.fit-150"><a href="#Ridge2Regressor.fit-150"><span class="linenos">150</span></a>        <span class="n">n_Z</span><span class="p">,</span> <span class="n">p_Z</span> <span class="o">=</span> <span class="n">scaled_Z</span><span class="o">.</span><span class="n">shape</span>
</span><span id="Ridge2Regressor.fit-151"><a href="#Ridge2Regressor.fit-151"><span class="linenos">151</span></a>
</span><span id="Ridge2Regressor.fit-152"><a href="#Ridge2Regressor.fit-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Ridge2Regressor.fit-153"><a href="#Ridge2Regressor.fit-153"><span class="linenos">153</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode_clusters</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Ridge2Regressor.fit-154"><a href="#Ridge2Regressor.fit-154"><span class="linenos">154</span></a>                <span class="n">n_features</span> <span class="o">=</span> <span class="n">p_X</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span>
</span><span id="Ridge2Regressor.fit-155"><a href="#Ridge2Regressor.fit-155"><span class="linenos">155</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2Regressor.fit-156"><a href="#Ridge2Regressor.fit-156"><span class="linenos">156</span></a>                <span class="n">n_features</span> <span class="o">=</span> <span class="n">p_X</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Ridge2Regressor.fit-157"><a href="#Ridge2Regressor.fit-157"><span class="linenos">157</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2Regressor.fit-158"><a href="#Ridge2Regressor.fit-158"><span class="linenos">158</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">p_X</span>
</span><span id="Ridge2Regressor.fit-159"><a href="#Ridge2Regressor.fit-159"><span class="linenos">159</span></a>
</span><span id="Ridge2Regressor.fit-160"><a href="#Ridge2Regressor.fit-160"><span class="linenos">160</span></a>        <span class="n">X_</span> <span class="o">=</span> <span class="n">scaled_Z</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">n_features</span><span class="p">]</span>
</span><span id="Ridge2Regressor.fit-161"><a href="#Ridge2Regressor.fit-161"><span class="linenos">161</span></a>        <span class="n">Phi_X_</span> <span class="o">=</span> <span class="n">scaled_Z</span><span class="p">[:,</span> <span class="n">n_features</span><span class="p">:</span><span class="n">p_Z</span><span class="p">]</span>
</span><span id="Ridge2Regressor.fit-162"><a href="#Ridge2Regressor.fit-162"><span class="linenos">162</span></a>
</span><span id="Ridge2Regressor.fit-163"><a href="#Ridge2Regressor.fit-163"><span class="linenos">163</span></a>        <span class="n">B</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span>
</span><span id="Ridge2Regressor.fit-164"><a href="#Ridge2Regressor.fit-164"><span class="linenos">164</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)</span>
</span><span id="Ridge2Regressor.fit-165"><a href="#Ridge2Regressor.fit-165"><span class="linenos">165</span></a>        <span class="p">)</span>
</span><span id="Ridge2Regressor.fit-166"><a href="#Ridge2Regressor.fit-166"><span class="linenos">166</span></a>        <span class="n">C</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Phi_X_</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">X_</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2Regressor.fit-167"><a href="#Ridge2Regressor.fit-167"><span class="linenos">167</span></a>        <span class="n">D</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span>
</span><span id="Ridge2Regressor.fit-168"><a href="#Ridge2Regressor.fit-168"><span class="linenos">168</span></a>            <span class="n">x</span><span class="o">=</span><span class="n">Phi_X_</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span>
</span><span id="Ridge2Regressor.fit-169"><a href="#Ridge2Regressor.fit-169"><span class="linenos">169</span></a>        <span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Phi_X_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="Ridge2Regressor.fit-170"><a href="#Ridge2Regressor.fit-170"><span class="linenos">170</span></a>
</span><span id="Ridge2Regressor.fit-171"><a href="#Ridge2Regressor.fit-171"><span class="linenos">171</span></a>        <span class="k">if</span> <span class="n">sys_platform</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Linux&quot;</span><span class="p">,</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">):</span>
</span><span id="Ridge2Regressor.fit-172"><a href="#Ridge2Regressor.fit-172"><span class="linenos">172</span></a>            <span class="n">B_inv</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span> <span class="k">else</span> <span class="n">jpinv</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</span><span id="Ridge2Regressor.fit-173"><a href="#Ridge2Regressor.fit-173"><span class="linenos">173</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2Regressor.fit-174"><a href="#Ridge2Regressor.fit-174"><span class="linenos">174</span></a>            <span class="n">B_inv</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</span><span id="Ridge2Regressor.fit-175"><a href="#Ridge2Regressor.fit-175"><span class="linenos">175</span></a>
</span><span id="Ridge2Regressor.fit-176"><a href="#Ridge2Regressor.fit-176"><span class="linenos">176</span></a>        <span class="n">W</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">B_inv</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2Regressor.fit-177"><a href="#Ridge2Regressor.fit-177"><span class="linenos">177</span></a>        <span class="n">S_mat</span> <span class="o">=</span> <span class="n">D</span> <span class="o">-</span> <span class="n">mo</span><span class="o">.</span><span class="n">tcrossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2Regressor.fit-178"><a href="#Ridge2Regressor.fit-178"><span class="linenos">178</span></a>
</span><span id="Ridge2Regressor.fit-179"><a href="#Ridge2Regressor.fit-179"><span class="linenos">179</span></a>        <span class="k">if</span> <span class="n">sys_platform</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Linux&quot;</span><span class="p">,</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">):</span>
</span><span id="Ridge2Regressor.fit-180"><a href="#Ridge2Regressor.fit-180"><span class="linenos">180</span></a>            <span class="n">S_inv</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">S_mat</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span> <span class="k">else</span> <span class="n">jpinv</span><span class="p">(</span><span class="n">S_mat</span><span class="p">)</span>
</span><span id="Ridge2Regressor.fit-181"><a href="#Ridge2Regressor.fit-181"><span class="linenos">181</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2Regressor.fit-182"><a href="#Ridge2Regressor.fit-182"><span class="linenos">182</span></a>            <span class="n">S_inv</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">S_mat</span><span class="p">)</span>
</span><span id="Ridge2Regressor.fit-183"><a href="#Ridge2Regressor.fit-183"><span class="linenos">183</span></a>
</span><span id="Ridge2Regressor.fit-184"><a href="#Ridge2Regressor.fit-184"><span class="linenos">184</span></a>        <span class="n">Y</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">S_inv</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2Regressor.fit-185"><a href="#Ridge2Regressor.fit-185"><span class="linenos">185</span></a>        <span class="n">inv</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="Ridge2Regressor.fit-186"><a href="#Ridge2Regressor.fit-186"><span class="linenos">186</span></a>            <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span>
</span><span id="Ridge2Regressor.fit-187"><a href="#Ridge2Regressor.fit-187"><span class="linenos">187</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">B_inv</span> <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="Ridge2Regressor.fit-188"><a href="#Ridge2Regressor.fit-188"><span class="linenos">188</span></a>                <span class="n">y</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Y</span><span class="p">),</span>
</span><span id="Ridge2Regressor.fit-189"><a href="#Ridge2Regressor.fit-189"><span class="linenos">189</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Regressor.fit-190"><a href="#Ridge2Regressor.fit-190"><span class="linenos">190</span></a>            <span class="p">),</span>
</span><span id="Ridge2Regressor.fit-191"><a href="#Ridge2Regressor.fit-191"><span class="linenos">191</span></a>            <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="n">Y</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">S_inv</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="Ridge2Regressor.fit-192"><a href="#Ridge2Regressor.fit-192"><span class="linenos">192</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Regressor.fit-193"><a href="#Ridge2Regressor.fit-193"><span class="linenos">193</span></a>        <span class="p">)</span>
</span><span id="Ridge2Regressor.fit-194"><a href="#Ridge2Regressor.fit-194"><span class="linenos">194</span></a>
</span><span id="Ridge2Regressor.fit-195"><a href="#Ridge2Regressor.fit-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Ridge2Regressor.fit-196"><a href="#Ridge2Regressor.fit-196"><span class="linenos">196</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">inv</span><span class="p">,</span>
</span><span id="Ridge2Regressor.fit-197"><a href="#Ridge2Regressor.fit-197"><span class="linenos">197</span></a>            <span class="n">b</span><span class="o">=</span><span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">centered_y</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="Ridge2Regressor.fit-198"><a href="#Ridge2Regressor.fit-198"><span class="linenos">198</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Regressor.fit-199"><a href="#Ridge2Regressor.fit-199"><span class="linenos">199</span></a>        <span class="p">)</span>
</span><span id="Ridge2Regressor.fit-200"><a href="#Ridge2Regressor.fit-200"><span class="linenos">200</span></a>
</span><span id="Ridge2Regressor.fit-201"><a href="#Ridge2Regressor.fit-201"><span class="linenos">201</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit Ridge model to training data (X, y).</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

y: array-like, shape = [n_samples]
    Target values.

**kwargs: additional parameters to be passed to
        self.cook_training_set or self.obj.fit
</code></pre>

<p>Returns:</p>

<pre><code>self: object
</code></pre>
</div>


                                </div>
                                <div id="Ridge2Regressor.predict" class="classattr">
                                            <input id="Ridge2Regressor.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Ridge2Regressor.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Ridge2Regressor.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Ridge2Regressor.predict-203"><a href="#Ridge2Regressor.predict-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2Regressor.predict-204"><a href="#Ridge2Regressor.predict-204"><span class="linenos">204</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="Ridge2Regressor.predict-205"><a href="#Ridge2Regressor.predict-205"><span class="linenos">205</span></a>
</span><span id="Ridge2Regressor.predict-206"><a href="#Ridge2Regressor.predict-206"><span class="linenos">206</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2Regressor.predict-207"><a href="#Ridge2Regressor.predict-207"><span class="linenos">207</span></a>
</span><span id="Ridge2Regressor.predict-208"><a href="#Ridge2Regressor.predict-208"><span class="linenos">208</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2Regressor.predict-209"><a href="#Ridge2Regressor.predict-209"><span class="linenos">209</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2Regressor.predict-210"><a href="#Ridge2Regressor.predict-210"><span class="linenos">210</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2Regressor.predict-211"><a href="#Ridge2Regressor.predict-211"><span class="linenos">211</span></a>
</span><span id="Ridge2Regressor.predict-212"><a href="#Ridge2Regressor.predict-212"><span class="linenos">212</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2Regressor.predict-213"><a href="#Ridge2Regressor.predict-213"><span class="linenos">213</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="Ridge2Regressor.predict-214"><a href="#Ridge2Regressor.predict-214"><span class="linenos">214</span></a>
</span><span id="Ridge2Regressor.predict-215"><a href="#Ridge2Regressor.predict-215"><span class="linenos">215</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2Regressor.predict-216"><a href="#Ridge2Regressor.predict-216"><span class="linenos">216</span></a>
</span><span id="Ridge2Regressor.predict-217"><a href="#Ridge2Regressor.predict-217"><span class="linenos">217</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="Ridge2Regressor.predict-218"><a href="#Ridge2Regressor.predict-218"><span class="linenos">218</span></a>
</span><span id="Ridge2Regressor.predict-219"><a href="#Ridge2Regressor.predict-219"><span class="linenos">219</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2Regressor.predict-220"><a href="#Ridge2Regressor.predict-220"><span class="linenos">220</span></a>
</span><span id="Ridge2Regressor.predict-221"><a href="#Ridge2Regressor.predict-221"><span class="linenos">221</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Ridge2Regressor.predict-222"><a href="#Ridge2Regressor.predict-222"><span class="linenos">222</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Ridge2Regressor.predict-223"><a href="#Ridge2Regressor.predict-223"><span class="linenos">223</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="Ridge2Regressor.predict-224"><a href="#Ridge2Regressor.predict-224"><span class="linenos">224</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="Ridge2Regressor.predict-225"><a href="#Ridge2Regressor.predict-225"><span class="linenos">225</span></a>                <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="Ridge2Regressor.predict-226"><a href="#Ridge2Regressor.predict-226"><span class="linenos">226</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Regressor.predict-227"><a href="#Ridge2Regressor.predict-227"><span class="linenos">227</span></a>            <span class="p">)</span>
</span><span id="Ridge2Regressor.predict-228"><a href="#Ridge2Regressor.predict-228"><span class="linenos">228</span></a>
</span><span id="Ridge2Regressor.predict-229"><a href="#Ridge2Regressor.predict-229"><span class="linenos">229</span></a>            <span class="k">return</span> <span class="p">(</span>
</span><span id="Ridge2Regressor.predict-230"><a href="#Ridge2Regressor.predict-230"><span class="linenos">230</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span>
</span><span id="Ridge2Regressor.predict-231"><a href="#Ridge2Regressor.predict-231"><span class="linenos">231</span></a>                <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Ridge2Regressor.predict-232"><a href="#Ridge2Regressor.predict-232"><span class="linenos">232</span></a>                    <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="Ridge2Regressor.predict-233"><a href="#Ridge2Regressor.predict-233"><span class="linenos">233</span></a>                    <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="Ridge2Regressor.predict-234"><a href="#Ridge2Regressor.predict-234"><span class="linenos">234</span></a>                    <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Regressor.predict-235"><a href="#Ridge2Regressor.predict-235"><span class="linenos">235</span></a>                <span class="p">)</span>
</span><span id="Ridge2Regressor.predict-236"><a href="#Ridge2Regressor.predict-236"><span class="linenos">236</span></a>            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Ridge2Regressor.predict-237"><a href="#Ridge2Regressor.predict-237"><span class="linenos">237</span></a>
</span><span id="Ridge2Regressor.predict-238"><a href="#Ridge2Regressor.predict-238"><span class="linenos">238</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_mean_</span> <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Ridge2Regressor.predict-239"><a href="#Ridge2Regressor.predict-239"><span class="linenos">239</span></a>            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="Ridge2Regressor.predict-240"><a href="#Ridge2Regressor.predict-240"><span class="linenos">240</span></a>            <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span>
</span><span id="Ridge2Regressor.predict-241"><a href="#Ridge2Regressor.predict-241"><span class="linenos">241</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Regressor.predict-242"><a href="#Ridge2Regressor.predict-242"><span class="linenos">242</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>model predictions: {array-like}
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="Ridge2Classifier">
                            <input id="Ridge2Classifier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Ridge2Classifier</span><wbr>(<span class="base">nnetsauce.ridge2.ridge2.Ridge2</span>, <span class="base">sklearn.base.ClassifierMixin</span>):

                <label class="view-source-button" for="Ridge2Classifier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Ridge2Classifier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Ridge2Classifier-18"><a href="#Ridge2Classifier-18"><span class="linenos"> 18</span></a><span class="k">class</span> <span class="nc">Ridge2Classifier</span><span class="p">(</span><span class="n">Ridge2</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">):</span>
</span><span id="Ridge2Classifier-19"><a href="#Ridge2Classifier-19"><span class="linenos"> 19</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Multinomial logit classification with 2 regularization parameters</span>
</span><span id="Ridge2Classifier-20"><a href="#Ridge2Classifier-20"><span class="linenos"> 20</span></a>
</span><span id="Ridge2Classifier-21"><a href="#Ridge2Classifier-21"><span class="linenos"> 21</span></a><span class="sd">    Parameters:</span>
</span><span id="Ridge2Classifier-22"><a href="#Ridge2Classifier-22"><span class="linenos"> 22</span></a>
</span><span id="Ridge2Classifier-23"><a href="#Ridge2Classifier-23"><span class="linenos"> 23</span></a><span class="sd">        n_hidden_features: int</span>
</span><span id="Ridge2Classifier-24"><a href="#Ridge2Classifier-24"><span class="linenos"> 24</span></a><span class="sd">            number of nodes in the hidden layer</span>
</span><span id="Ridge2Classifier-25"><a href="#Ridge2Classifier-25"><span class="linenos"> 25</span></a>
</span><span id="Ridge2Classifier-26"><a href="#Ridge2Classifier-26"><span class="linenos"> 26</span></a><span class="sd">        activation_name: str</span>
</span><span id="Ridge2Classifier-27"><a href="#Ridge2Classifier-27"><span class="linenos"> 27</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;</span>
</span><span id="Ridge2Classifier-28"><a href="#Ridge2Classifier-28"><span class="linenos"> 28</span></a>
</span><span id="Ridge2Classifier-29"><a href="#Ridge2Classifier-29"><span class="linenos"> 29</span></a><span class="sd">        a: float</span>
</span><span id="Ridge2Classifier-30"><a href="#Ridge2Classifier-30"><span class="linenos"> 30</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function</span>
</span><span id="Ridge2Classifier-31"><a href="#Ridge2Classifier-31"><span class="linenos"> 31</span></a>
</span><span id="Ridge2Classifier-32"><a href="#Ridge2Classifier-32"><span class="linenos"> 32</span></a><span class="sd">        nodes_sim: str</span>
</span><span id="Ridge2Classifier-33"><a href="#Ridge2Classifier-33"><span class="linenos"> 33</span></a><span class="sd">            type of simulation for the nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;,</span>
</span><span id="Ridge2Classifier-34"><a href="#Ridge2Classifier-34"><span class="linenos"> 34</span></a><span class="sd">            &#39;uniform&#39;</span>
</span><span id="Ridge2Classifier-35"><a href="#Ridge2Classifier-35"><span class="linenos"> 35</span></a>
</span><span id="Ridge2Classifier-36"><a href="#Ridge2Classifier-36"><span class="linenos"> 36</span></a><span class="sd">        bias: boolean</span>
</span><span id="Ridge2Classifier-37"><a href="#Ridge2Classifier-37"><span class="linenos"> 37</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or not</span>
</span><span id="Ridge2Classifier-38"><a href="#Ridge2Classifier-38"><span class="linenos"> 38</span></a><span class="sd">            (False)</span>
</span><span id="Ridge2Classifier-39"><a href="#Ridge2Classifier-39"><span class="linenos"> 39</span></a>
</span><span id="Ridge2Classifier-40"><a href="#Ridge2Classifier-40"><span class="linenos"> 40</span></a><span class="sd">        dropout: float</span>
</span><span id="Ridge2Classifier-41"><a href="#Ridge2Classifier-41"><span class="linenos"> 41</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="Ridge2Classifier-42"><a href="#Ridge2Classifier-42"><span class="linenos"> 42</span></a><span class="sd">            of the training</span>
</span><span id="Ridge2Classifier-43"><a href="#Ridge2Classifier-43"><span class="linenos"> 43</span></a>
</span><span id="Ridge2Classifier-44"><a href="#Ridge2Classifier-44"><span class="linenos"> 44</span></a><span class="sd">        direct_link: boolean</span>
</span><span id="Ridge2Classifier-45"><a href="#Ridge2Classifier-45"><span class="linenos"> 45</span></a><span class="sd">            indicates if the original predictors are included (True) in model&#39;s</span>
</span><span id="Ridge2Classifier-46"><a href="#Ridge2Classifier-46"><span class="linenos"> 46</span></a><span class="sd">            fitting or not (False)</span>
</span><span id="Ridge2Classifier-47"><a href="#Ridge2Classifier-47"><span class="linenos"> 47</span></a>
</span><span id="Ridge2Classifier-48"><a href="#Ridge2Classifier-48"><span class="linenos"> 48</span></a><span class="sd">        n_clusters: int</span>
</span><span id="Ridge2Classifier-49"><a href="#Ridge2Classifier-49"><span class="linenos"> 49</span></a><span class="sd">            number of clusters for &#39;kmeans&#39; or &#39;gmm&#39; clustering (could be 0:</span>
</span><span id="Ridge2Classifier-50"><a href="#Ridge2Classifier-50"><span class="linenos"> 50</span></a><span class="sd">                no clustering)</span>
</span><span id="Ridge2Classifier-51"><a href="#Ridge2Classifier-51"><span class="linenos"> 51</span></a>
</span><span id="Ridge2Classifier-52"><a href="#Ridge2Classifier-52"><span class="linenos"> 52</span></a><span class="sd">        cluster_encode: bool</span>
</span><span id="Ridge2Classifier-53"><a href="#Ridge2Classifier-53"><span class="linenos"> 53</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot)</span>
</span><span id="Ridge2Classifier-54"><a href="#Ridge2Classifier-54"><span class="linenos"> 54</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding</span>
</span><span id="Ridge2Classifier-55"><a href="#Ridge2Classifier-55"><span class="linenos"> 55</span></a>
</span><span id="Ridge2Classifier-56"><a href="#Ridge2Classifier-56"><span class="linenos"> 56</span></a><span class="sd">        type_clust: str</span>
</span><span id="Ridge2Classifier-57"><a href="#Ridge2Classifier-57"><span class="linenos"> 57</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian</span>
</span><span id="Ridge2Classifier-58"><a href="#Ridge2Classifier-58"><span class="linenos"> 58</span></a><span class="sd">            Mixture Model (&#39;gmm&#39;)</span>
</span><span id="Ridge2Classifier-59"><a href="#Ridge2Classifier-59"><span class="linenos"> 59</span></a>
</span><span id="Ridge2Classifier-60"><a href="#Ridge2Classifier-60"><span class="linenos"> 60</span></a><span class="sd">        type_scaling: a tuple of 3 strings</span>
</span><span id="Ridge2Classifier-61"><a href="#Ridge2Classifier-61"><span class="linenos"> 61</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="Ridge2Classifier-62"><a href="#Ridge2Classifier-62"><span class="linenos"> 62</span></a><span class="sd">            (and when relevant).</span>
</span><span id="Ridge2Classifier-63"><a href="#Ridge2Classifier-63"><span class="linenos"> 63</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;)</span>
</span><span id="Ridge2Classifier-64"><a href="#Ridge2Classifier-64"><span class="linenos"> 64</span></a>
</span><span id="Ridge2Classifier-65"><a href="#Ridge2Classifier-65"><span class="linenos"> 65</span></a><span class="sd">        lambda1: float</span>
</span><span id="Ridge2Classifier-66"><a href="#Ridge2Classifier-66"><span class="linenos"> 66</span></a><span class="sd">            regularization parameter on direct link</span>
</span><span id="Ridge2Classifier-67"><a href="#Ridge2Classifier-67"><span class="linenos"> 67</span></a>
</span><span id="Ridge2Classifier-68"><a href="#Ridge2Classifier-68"><span class="linenos"> 68</span></a><span class="sd">        lambda2: float</span>
</span><span id="Ridge2Classifier-69"><a href="#Ridge2Classifier-69"><span class="linenos"> 69</span></a><span class="sd">            regularization parameter on hidden layer</span>
</span><span id="Ridge2Classifier-70"><a href="#Ridge2Classifier-70"><span class="linenos"> 70</span></a>
</span><span id="Ridge2Classifier-71"><a href="#Ridge2Classifier-71"><span class="linenos"> 71</span></a><span class="sd">        solver: str</span>
</span><span id="Ridge2Classifier-72"><a href="#Ridge2Classifier-72"><span class="linenos"> 72</span></a><span class="sd">            optimization function &quot;L-BFGS-B&quot;,  &quot;Newton-CG&quot;,</span>
</span><span id="Ridge2Classifier-73"><a href="#Ridge2Classifier-73"><span class="linenos"> 73</span></a><span class="sd">            &quot;trust-ncg&quot;, &quot;L-BFGS-B-lstsq&quot;, &quot;Newton-CG-lstsq&quot;,</span>
</span><span id="Ridge2Classifier-74"><a href="#Ridge2Classifier-74"><span class="linenos"> 74</span></a><span class="sd">            &quot;trust-ncg-lstsq&quot; (see scipy.optimize.minimize)</span>
</span><span id="Ridge2Classifier-75"><a href="#Ridge2Classifier-75"><span class="linenos"> 75</span></a><span class="sd">            When using &quot;L-BFGS-B-lstsq&quot;, &quot;Newton-CG-lstsq&quot;, or &quot;trust-ncg-lstsq&quot;,</span>
</span><span id="Ridge2Classifier-76"><a href="#Ridge2Classifier-76"><span class="linenos"> 76</span></a><span class="sd">            the initial value for the optimization is set to the least squares solution</span>
</span><span id="Ridge2Classifier-77"><a href="#Ridge2Classifier-77"><span class="linenos"> 77</span></a>
</span><span id="Ridge2Classifier-78"><a href="#Ridge2Classifier-78"><span class="linenos"> 78</span></a><span class="sd">        seed: int</span>
</span><span id="Ridge2Classifier-79"><a href="#Ridge2Classifier-79"><span class="linenos"> 79</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39;</span>
</span><span id="Ridge2Classifier-80"><a href="#Ridge2Classifier-80"><span class="linenos"> 80</span></a>
</span><span id="Ridge2Classifier-81"><a href="#Ridge2Classifier-81"><span class="linenos"> 81</span></a><span class="sd">        backend: str</span>
</span><span id="Ridge2Classifier-82"><a href="#Ridge2Classifier-82"><span class="linenos"> 82</span></a><span class="sd">            &quot;cpu&quot; or &quot;gpu&quot; or &quot;tpu&quot;</span>
</span><span id="Ridge2Classifier-83"><a href="#Ridge2Classifier-83"><span class="linenos"> 83</span></a>
</span><span id="Ridge2Classifier-84"><a href="#Ridge2Classifier-84"><span class="linenos"> 84</span></a><span class="sd">    Attributes:</span>
</span><span id="Ridge2Classifier-85"><a href="#Ridge2Classifier-85"><span class="linenos"> 85</span></a>
</span><span id="Ridge2Classifier-86"><a href="#Ridge2Classifier-86"><span class="linenos"> 86</span></a><span class="sd">        beta_: {array-like}</span>
</span><span id="Ridge2Classifier-87"><a href="#Ridge2Classifier-87"><span class="linenos"> 87</span></a><span class="sd">            regression coefficients</span>
</span><span id="Ridge2Classifier-88"><a href="#Ridge2Classifier-88"><span class="linenos"> 88</span></a>
</span><span id="Ridge2Classifier-89"><a href="#Ridge2Classifier-89"><span class="linenos"> 89</span></a><span class="sd">        classes_: {array-like}</span>
</span><span id="Ridge2Classifier-90"><a href="#Ridge2Classifier-90"><span class="linenos"> 90</span></a><span class="sd">            unique classes in the target variable</span>
</span><span id="Ridge2Classifier-91"><a href="#Ridge2Classifier-91"><span class="linenos"> 91</span></a>
</span><span id="Ridge2Classifier-92"><a href="#Ridge2Classifier-92"><span class="linenos"> 92</span></a><span class="sd">        minloglik_: float</span>
</span><span id="Ridge2Classifier-93"><a href="#Ridge2Classifier-93"><span class="linenos"> 93</span></a><span class="sd">            minimum value of the negative log-likelihood</span>
</span><span id="Ridge2Classifier-94"><a href="#Ridge2Classifier-94"><span class="linenos"> 94</span></a>
</span><span id="Ridge2Classifier-95"><a href="#Ridge2Classifier-95"><span class="linenos"> 95</span></a><span class="sd">    Examples:</span>
</span><span id="Ridge2Classifier-96"><a href="#Ridge2Classifier-96"><span class="linenos"> 96</span></a>
</span><span id="Ridge2Classifier-97"><a href="#Ridge2Classifier-97"><span class="linenos"> 97</span></a><span class="sd">    See also [https://github.com/Techtonique/nnetsauce/blob/master/examples/ridge_classification.py](https://github.com/Techtonique/nnetsauce/blob/master/examples/ridge_classification.py)</span>
</span><span id="Ridge2Classifier-98"><a href="#Ridge2Classifier-98"><span class="linenos"> 98</span></a>
</span><span id="Ridge2Classifier-99"><a href="#Ridge2Classifier-99"><span class="linenos"> 99</span></a><span class="sd">    ```python</span>
</span><span id="Ridge2Classifier-100"><a href="#Ridge2Classifier-100"><span class="linenos">100</span></a><span class="sd">    import nnetsauce as ns</span>
</span><span id="Ridge2Classifier-101"><a href="#Ridge2Classifier-101"><span class="linenos">101</span></a><span class="sd">    import numpy as np</span>
</span><span id="Ridge2Classifier-102"><a href="#Ridge2Classifier-102"><span class="linenos">102</span></a><span class="sd">    from sklearn.datasets import load_breast_cancer</span>
</span><span id="Ridge2Classifier-103"><a href="#Ridge2Classifier-103"><span class="linenos">103</span></a><span class="sd">    from sklearn.model_selection import train_test_split</span>
</span><span id="Ridge2Classifier-104"><a href="#Ridge2Classifier-104"><span class="linenos">104</span></a><span class="sd">    from time import time</span>
</span><span id="Ridge2Classifier-105"><a href="#Ridge2Classifier-105"><span class="linenos">105</span></a>
</span><span id="Ridge2Classifier-106"><a href="#Ridge2Classifier-106"><span class="linenos">106</span></a>
</span><span id="Ridge2Classifier-107"><a href="#Ridge2Classifier-107"><span class="linenos">107</span></a><span class="sd">    breast_cancer = load_breast_cancer()</span>
</span><span id="Ridge2Classifier-108"><a href="#Ridge2Classifier-108"><span class="linenos">108</span></a><span class="sd">    X = breast_cancer.data</span>
</span><span id="Ridge2Classifier-109"><a href="#Ridge2Classifier-109"><span class="linenos">109</span></a><span class="sd">    y = breast_cancer.target</span>
</span><span id="Ridge2Classifier-110"><a href="#Ridge2Classifier-110"><span class="linenos">110</span></a>
</span><span id="Ridge2Classifier-111"><a href="#Ridge2Classifier-111"><span class="linenos">111</span></a><span class="sd">    # split data into training test and test set</span>
</span><span id="Ridge2Classifier-112"><a href="#Ridge2Classifier-112"><span class="linenos">112</span></a><span class="sd">    np.random.seed(123)</span>
</span><span id="Ridge2Classifier-113"><a href="#Ridge2Classifier-113"><span class="linenos">113</span></a><span class="sd">    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)</span>
</span><span id="Ridge2Classifier-114"><a href="#Ridge2Classifier-114"><span class="linenos">114</span></a>
</span><span id="Ridge2Classifier-115"><a href="#Ridge2Classifier-115"><span class="linenos">115</span></a><span class="sd">    # create the model with nnetsauce</span>
</span><span id="Ridge2Classifier-116"><a href="#Ridge2Classifier-116"><span class="linenos">116</span></a><span class="sd">    fit_obj = ns.Ridge2Classifier(lambda1 = 6.90185578e+04,</span>
</span><span id="Ridge2Classifier-117"><a href="#Ridge2Classifier-117"><span class="linenos">117</span></a><span class="sd">                                lambda2 = 3.17392781e+02,</span>
</span><span id="Ridge2Classifier-118"><a href="#Ridge2Classifier-118"><span class="linenos">118</span></a><span class="sd">                                n_hidden_features=95,</span>
</span><span id="Ridge2Classifier-119"><a href="#Ridge2Classifier-119"><span class="linenos">119</span></a><span class="sd">                                n_clusters=2,</span>
</span><span id="Ridge2Classifier-120"><a href="#Ridge2Classifier-120"><span class="linenos">120</span></a><span class="sd">                                dropout = 3.62817383e-01,</span>
</span><span id="Ridge2Classifier-121"><a href="#Ridge2Classifier-121"><span class="linenos">121</span></a><span class="sd">                                type_clust = &quot;gmm&quot;)</span>
</span><span id="Ridge2Classifier-122"><a href="#Ridge2Classifier-122"><span class="linenos">122</span></a>
</span><span id="Ridge2Classifier-123"><a href="#Ridge2Classifier-123"><span class="linenos">123</span></a><span class="sd">    # fit the model on training set</span>
</span><span id="Ridge2Classifier-124"><a href="#Ridge2Classifier-124"><span class="linenos">124</span></a><span class="sd">    start = time()</span>
</span><span id="Ridge2Classifier-125"><a href="#Ridge2Classifier-125"><span class="linenos">125</span></a><span class="sd">    fit_obj.fit(X_train, y_train)</span>
</span><span id="Ridge2Classifier-126"><a href="#Ridge2Classifier-126"><span class="linenos">126</span></a><span class="sd">    print(f&quot;Elapsed {time() - start}&quot;)</span>
</span><span id="Ridge2Classifier-127"><a href="#Ridge2Classifier-127"><span class="linenos">127</span></a>
</span><span id="Ridge2Classifier-128"><a href="#Ridge2Classifier-128"><span class="linenos">128</span></a><span class="sd">    # get the accuracy on test set</span>
</span><span id="Ridge2Classifier-129"><a href="#Ridge2Classifier-129"><span class="linenos">129</span></a><span class="sd">    start = time()</span>
</span><span id="Ridge2Classifier-130"><a href="#Ridge2Classifier-130"><span class="linenos">130</span></a><span class="sd">    print(fit_obj.score(X_test, y_test))</span>
</span><span id="Ridge2Classifier-131"><a href="#Ridge2Classifier-131"><span class="linenos">131</span></a><span class="sd">    print(f&quot;Elapsed {time() - start}&quot;)</span>
</span><span id="Ridge2Classifier-132"><a href="#Ridge2Classifier-132"><span class="linenos">132</span></a>
</span><span id="Ridge2Classifier-133"><a href="#Ridge2Classifier-133"><span class="linenos">133</span></a><span class="sd">    # get area under the curve on test set (auc)</span>
</span><span id="Ridge2Classifier-134"><a href="#Ridge2Classifier-134"><span class="linenos">134</span></a><span class="sd">    print(fit_obj.score(X_test, y_test, scoring=&quot;roc_auc&quot;))</span>
</span><span id="Ridge2Classifier-135"><a href="#Ridge2Classifier-135"><span class="linenos">135</span></a><span class="sd">    ```</span>
</span><span id="Ridge2Classifier-136"><a href="#Ridge2Classifier-136"><span class="linenos">136</span></a>
</span><span id="Ridge2Classifier-137"><a href="#Ridge2Classifier-137"><span class="linenos">137</span></a>
</span><span id="Ridge2Classifier-138"><a href="#Ridge2Classifier-138"><span class="linenos">138</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Ridge2Classifier-139"><a href="#Ridge2Classifier-139"><span class="linenos">139</span></a>
</span><span id="Ridge2Classifier-140"><a href="#Ridge2Classifier-140"><span class="linenos">140</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="Ridge2Classifier-141"><a href="#Ridge2Classifier-141"><span class="linenos">141</span></a>
</span><span id="Ridge2Classifier-142"><a href="#Ridge2Classifier-142"><span class="linenos">142</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Ridge2Classifier-143"><a href="#Ridge2Classifier-143"><span class="linenos">143</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Ridge2Classifier-144"><a href="#Ridge2Classifier-144"><span class="linenos">144</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="Ridge2Classifier-145"><a href="#Ridge2Classifier-145"><span class="linenos">145</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="Ridge2Classifier-146"><a href="#Ridge2Classifier-146"><span class="linenos">146</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="Ridge2Classifier-147"><a href="#Ridge2Classifier-147"><span class="linenos">147</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="Ridge2Classifier-148"><a href="#Ridge2Classifier-148"><span class="linenos">148</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Ridge2Classifier-149"><a href="#Ridge2Classifier-149"><span class="linenos">149</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Ridge2Classifier-150"><a href="#Ridge2Classifier-150"><span class="linenos">150</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Ridge2Classifier-151"><a href="#Ridge2Classifier-151"><span class="linenos">151</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="Ridge2Classifier-152"><a href="#Ridge2Classifier-152"><span class="linenos">152</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Ridge2Classifier-153"><a href="#Ridge2Classifier-153"><span class="linenos">153</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="Ridge2Classifier-154"><a href="#Ridge2Classifier-154"><span class="linenos">154</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="Ridge2Classifier-155"><a href="#Ridge2Classifier-155"><span class="linenos">155</span></a>        <span class="n">lambda1</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="Ridge2Classifier-156"><a href="#Ridge2Classifier-156"><span class="linenos">156</span></a>        <span class="n">lambda2</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="Ridge2Classifier-157"><a href="#Ridge2Classifier-157"><span class="linenos">157</span></a>        <span class="n">solver</span><span class="o">=</span><span class="s2">&quot;L-BFGS-B&quot;</span><span class="p">,</span>
</span><span id="Ridge2Classifier-158"><a href="#Ridge2Classifier-158"><span class="linenos">158</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="Ridge2Classifier-159"><a href="#Ridge2Classifier-159"><span class="linenos">159</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="Ridge2Classifier-160"><a href="#Ridge2Classifier-160"><span class="linenos">160</span></a>    <span class="p">):</span>
</span><span id="Ridge2Classifier-161"><a href="#Ridge2Classifier-161"><span class="linenos">161</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Ridge2Classifier-162"><a href="#Ridge2Classifier-162"><span class="linenos">162</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Ridge2Classifier-163"><a href="#Ridge2Classifier-163"><span class="linenos">163</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="Ridge2Classifier-164"><a href="#Ridge2Classifier-164"><span class="linenos">164</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="Ridge2Classifier-165"><a href="#Ridge2Classifier-165"><span class="linenos">165</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="Ridge2Classifier-166"><a href="#Ridge2Classifier-166"><span class="linenos">166</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="Ridge2Classifier-167"><a href="#Ridge2Classifier-167"><span class="linenos">167</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="Ridge2Classifier-168"><a href="#Ridge2Classifier-168"><span class="linenos">168</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="Ridge2Classifier-169"><a href="#Ridge2Classifier-169"><span class="linenos">169</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="Ridge2Classifier-170"><a href="#Ridge2Classifier-170"><span class="linenos">170</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="Ridge2Classifier-171"><a href="#Ridge2Classifier-171"><span class="linenos">171</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="Ridge2Classifier-172"><a href="#Ridge2Classifier-172"><span class="linenos">172</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="Ridge2Classifier-173"><a href="#Ridge2Classifier-173"><span class="linenos">173</span></a>            <span class="n">lambda1</span><span class="o">=</span><span class="n">lambda1</span><span class="p">,</span>
</span><span id="Ridge2Classifier-174"><a href="#Ridge2Classifier-174"><span class="linenos">174</span></a>            <span class="n">lambda2</span><span class="o">=</span><span class="n">lambda2</span><span class="p">,</span>
</span><span id="Ridge2Classifier-175"><a href="#Ridge2Classifier-175"><span class="linenos">175</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Ridge2Classifier-176"><a href="#Ridge2Classifier-176"><span class="linenos">176</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Classifier-177"><a href="#Ridge2Classifier-177"><span class="linenos">177</span></a>        <span class="p">)</span>
</span><span id="Ridge2Classifier-178"><a href="#Ridge2Classifier-178"><span class="linenos">178</span></a>
</span><span id="Ridge2Classifier-179"><a href="#Ridge2Classifier-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_fit</span> <span class="o">=</span> <span class="s2">&quot;classification&quot;</span>
</span><span id="Ridge2Classifier-180"><a href="#Ridge2Classifier-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="o">=</span> <span class="n">solver</span>
</span><span id="Ridge2Classifier-181"><a href="#Ridge2Classifier-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Ridge2Classifier-182"><a href="#Ridge2Classifier-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Ridge2Classifier-183"><a href="#Ridge2Classifier-183"><span class="linenos">183</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">minloglik_</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Ridge2Classifier-184"><a href="#Ridge2Classifier-184"><span class="linenos">184</span></a>
</span><span id="Ridge2Classifier-185"><a href="#Ridge2Classifier-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="nf">loglik</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2Classifier-186"><a href="#Ridge2Classifier-186"><span class="linenos">186</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Log-likelihood for training data (X, Y).</span>
</span><span id="Ridge2Classifier-187"><a href="#Ridge2Classifier-187"><span class="linenos">187</span></a>
</span><span id="Ridge2Classifier-188"><a href="#Ridge2Classifier-188"><span class="linenos">188</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2Classifier-189"><a href="#Ridge2Classifier-189"><span class="linenos">189</span></a>
</span><span id="Ridge2Classifier-190"><a href="#Ridge2Classifier-190"><span class="linenos">190</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2Classifier-191"><a href="#Ridge2Classifier-191"><span class="linenos">191</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2Classifier-192"><a href="#Ridge2Classifier-192"><span class="linenos">192</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2Classifier-193"><a href="#Ridge2Classifier-193"><span class="linenos">193</span></a>
</span><span id="Ridge2Classifier-194"><a href="#Ridge2Classifier-194"><span class="linenos">194</span></a><span class="sd">            Y: array-like, shape = [n_samples]</span>
</span><span id="Ridge2Classifier-195"><a href="#Ridge2Classifier-195"><span class="linenos">195</span></a><span class="sd">                One-hot encode target values.</span>
</span><span id="Ridge2Classifier-196"><a href="#Ridge2Classifier-196"><span class="linenos">196</span></a>
</span><span id="Ridge2Classifier-197"><a href="#Ridge2Classifier-197"><span class="linenos">197</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2Classifier-198"><a href="#Ridge2Classifier-198"><span class="linenos">198</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="Ridge2Classifier-199"><a href="#Ridge2Classifier-199"><span class="linenos">199</span></a>
</span><span id="Ridge2Classifier-200"><a href="#Ridge2Classifier-200"><span class="linenos">200</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2Classifier-201"><a href="#Ridge2Classifier-201"><span class="linenos">201</span></a>
</span><span id="Ridge2Classifier-202"><a href="#Ridge2Classifier-202"><span class="linenos">202</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2Classifier-203"><a href="#Ridge2Classifier-203"><span class="linenos">203</span></a>
</span><span id="Ridge2Classifier-204"><a href="#Ridge2Classifier-204"><span class="linenos">204</span></a>        <span class="k">def</span> <span class="nf">loglik_grad_hess</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">XB</span><span class="p">,</span> <span class="n">hessian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2Classifier-205"><a href="#Ridge2Classifier-205"><span class="linenos">205</span></a>            <span class="c1"># nobs, n_classes</span>
</span><span id="Ridge2Classifier-206"><a href="#Ridge2Classifier-206"><span class="linenos">206</span></a>            <span class="n">n</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">shape</span>
</span><span id="Ridge2Classifier-207"><a href="#Ridge2Classifier-207"><span class="linenos">207</span></a>
</span><span id="Ridge2Classifier-208"><a href="#Ridge2Classifier-208"><span class="linenos">208</span></a>            <span class="c1"># total number of covariates</span>
</span><span id="Ridge2Classifier-209"><a href="#Ridge2Classifier-209"><span class="linenos">209</span></a>            <span class="n">p</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Ridge2Classifier-210"><a href="#Ridge2Classifier-210"><span class="linenos">210</span></a>
</span><span id="Ridge2Classifier-211"><a href="#Ridge2Classifier-211"><span class="linenos">211</span></a>            <span class="c1"># initial number of covariates</span>
</span><span id="Ridge2Classifier-212"><a href="#Ridge2Classifier-212"><span class="linenos">212</span></a>            <span class="n">init_p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span>
</span><span id="Ridge2Classifier-213"><a href="#Ridge2Classifier-213"><span class="linenos">213</span></a>
</span><span id="Ridge2Classifier-214"><a href="#Ridge2Classifier-214"><span class="linenos">214</span></a>            <span class="n">max_double</span> <span class="o">=</span> <span class="mf">709.0</span>
</span><span id="Ridge2Classifier-215"><a href="#Ridge2Classifier-215"><span class="linenos">215</span></a>            <span class="n">XB</span><span class="p">[</span><span class="n">XB</span> <span class="o">&gt;</span> <span class="n">max_double</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_double</span>
</span><span id="Ridge2Classifier-216"><a href="#Ridge2Classifier-216"><span class="linenos">216</span></a>            <span class="n">exp_XB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">XB</span><span class="p">)</span>
</span><span id="Ridge2Classifier-217"><a href="#Ridge2Classifier-217"><span class="linenos">217</span></a>            <span class="n">probs</span> <span class="o">=</span> <span class="n">exp_XB</span> <span class="o">/</span> <span class="n">exp_XB</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="Ridge2Classifier-218"><a href="#Ridge2Classifier-218"><span class="linenos">218</span></a>
</span><span id="Ridge2Classifier-219"><a href="#Ridge2Classifier-219"><span class="linenos">219</span></a>            <span class="c1"># gradient -----</span>
</span><span id="Ridge2Classifier-220"><a href="#Ridge2Classifier-220"><span class="linenos">220</span></a>            <span class="c1"># (Y - p) -&gt; (n, K)</span>
</span><span id="Ridge2Classifier-221"><a href="#Ridge2Classifier-221"><span class="linenos">221</span></a>            <span class="c1"># X -&gt; (n, p)</span>
</span><span id="Ridge2Classifier-222"><a href="#Ridge2Classifier-222"><span class="linenos">222</span></a>            <span class="c1"># (K, n) %*% (n, p) -&gt; (K, p)</span>
</span><span id="Ridge2Classifier-223"><a href="#Ridge2Classifier-223"><span class="linenos">223</span></a>            <span class="k">if</span> <span class="n">hessian</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="Ridge2Classifier-224"><a href="#Ridge2Classifier-224"><span class="linenos">224</span></a>                <span class="n">grad</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Ridge2Classifier-225"><a href="#Ridge2Classifier-225"><span class="linenos">225</span></a>                    <span class="o">-</span><span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Ridge2Classifier-226"><a href="#Ridge2Classifier-226"><span class="linenos">226</span></a>                        <span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">probs</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span>
</span><span id="Ridge2Classifier-227"><a href="#Ridge2Classifier-227"><span class="linenos">227</span></a>                    <span class="p">)</span>
</span><span id="Ridge2Classifier-228"><a href="#Ridge2Classifier-228"><span class="linenos">228</span></a>                    <span class="o">/</span> <span class="n">n</span>
</span><span id="Ridge2Classifier-229"><a href="#Ridge2Classifier-229"><span class="linenos">229</span></a>                <span class="p">)</span>
</span><span id="Ridge2Classifier-230"><a href="#Ridge2Classifier-230"><span class="linenos">230</span></a>                <span class="n">grad</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span> <span class="o">*</span> <span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">init_p</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="Ridge2Classifier-231"><a href="#Ridge2Classifier-231"><span class="linenos">231</span></a>                <span class="n">grad</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span> <span class="o">*</span> <span class="n">B</span><span class="p">[</span><span class="n">init_p</span><span class="p">:</span><span class="n">p</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="Ridge2Classifier-232"><a href="#Ridge2Classifier-232"><span class="linenos">232</span></a>
</span><span id="Ridge2Classifier-233"><a href="#Ridge2Classifier-233"><span class="linenos">233</span></a>                <span class="k">return</span> <span class="n">grad</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span><span id="Ridge2Classifier-234"><a href="#Ridge2Classifier-234"><span class="linenos">234</span></a>
</span><span id="Ridge2Classifier-235"><a href="#Ridge2Classifier-235"><span class="linenos">235</span></a>            <span class="c1"># hessian -----</span>
</span><span id="Ridge2Classifier-236"><a href="#Ridge2Classifier-236"><span class="linenos">236</span></a>            <span class="k">if</span> <span class="n">hessian</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Ridge2Classifier-237"><a href="#Ridge2Classifier-237"><span class="linenos">237</span></a>                <span class="n">Kp</span> <span class="o">=</span> <span class="n">K</span> <span class="o">*</span> <span class="n">p</span>
</span><span id="Ridge2Classifier-238"><a href="#Ridge2Classifier-238"><span class="linenos">238</span></a>                <span class="n">hess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Kp</span><span class="p">,</span> <span class="n">Kp</span><span class="p">),</span> <span class="nb">float</span><span class="p">)</span>
</span><span id="Ridge2Classifier-239"><a href="#Ridge2Classifier-239"><span class="linenos">239</span></a>                <span class="k">for</span> <span class="n">k1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
</span><span id="Ridge2Classifier-240"><a href="#Ridge2Classifier-240"><span class="linenos">240</span></a>                    <span class="n">x_index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">k1</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span>
</span><span id="Ridge2Classifier-241"><a href="#Ridge2Classifier-241"><span class="linenos">241</span></a>                    <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k1</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
</span><span id="Ridge2Classifier-242"><a href="#Ridge2Classifier-242"><span class="linenos">242</span></a>                        <span class="n">y_index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">k2</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="n">k2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span>
</span><span id="Ridge2Classifier-243"><a href="#Ridge2Classifier-243"><span class="linenos">243</span></a>                        <span class="n">H_sub</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="Ridge2Classifier-244"><a href="#Ridge2Classifier-244"><span class="linenos">244</span></a>                            <span class="o">-</span><span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Ridge2Classifier-245"><a href="#Ridge2Classifier-245"><span class="linenos">245</span></a>                                <span class="n">a</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="Ridge2Classifier-246"><a href="#Ridge2Classifier-246"><span class="linenos">246</span></a>                                <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">probs</span><span class="p">[:,</span> <span class="n">k1</span><span class="p">]</span> <span class="o">*</span> <span class="n">probs</span><span class="p">[:,</span> <span class="n">k2</span><span class="p">])[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">,</span>
</span><span id="Ridge2Classifier-247"><a href="#Ridge2Classifier-247"><span class="linenos">247</span></a>                                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Classifier-248"><a href="#Ridge2Classifier-248"><span class="linenos">248</span></a>                            <span class="p">)</span>
</span><span id="Ridge2Classifier-249"><a href="#Ridge2Classifier-249"><span class="linenos">249</span></a>                            <span class="o">/</span> <span class="n">n</span>
</span><span id="Ridge2Classifier-250"><a href="#Ridge2Classifier-250"><span class="linenos">250</span></a>                        <span class="p">)</span>  <span class="c1"># do not store</span>
</span><span id="Ridge2Classifier-251"><a href="#Ridge2Classifier-251"><span class="linenos">251</span></a>                        <span class="n">hess</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">x_index</span><span class="p">,</span> <span class="n">y_index</span><span class="p">)]</span> <span class="o">=</span> <span class="n">hess</span><span class="p">[</span>
</span><span id="Ridge2Classifier-252"><a href="#Ridge2Classifier-252"><span class="linenos">252</span></a>                            <span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">y_index</span><span class="p">,</span> <span class="n">x_index</span><span class="p">)</span>
</span><span id="Ridge2Classifier-253"><a href="#Ridge2Classifier-253"><span class="linenos">253</span></a>                        <span class="p">]</span> <span class="o">=</span> <span class="n">H_sub</span>
</span><span id="Ridge2Classifier-254"><a href="#Ridge2Classifier-254"><span class="linenos">254</span></a>
</span><span id="Ridge2Classifier-255"><a href="#Ridge2Classifier-255"><span class="linenos">255</span></a>                <span class="k">return</span> <span class="n">hess</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">Kp</span><span class="p">)</span>
</span><span id="Ridge2Classifier-256"><a href="#Ridge2Classifier-256"><span class="linenos">256</span></a>
</span><span id="Ridge2Classifier-257"><a href="#Ridge2Classifier-257"><span class="linenos">257</span></a>        <span class="c1"># total number of covariates</span>
</span><span id="Ridge2Classifier-258"><a href="#Ridge2Classifier-258"><span class="linenos">258</span></a>        <span class="n">p</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Ridge2Classifier-259"><a href="#Ridge2Classifier-259"><span class="linenos">259</span></a>
</span><span id="Ridge2Classifier-260"><a href="#Ridge2Classifier-260"><span class="linenos">260</span></a>        <span class="c1"># initial number of covariates</span>
</span><span id="Ridge2Classifier-261"><a href="#Ridge2Classifier-261"><span class="linenos">261</span></a>        <span class="n">init_p</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span>
</span><span id="Ridge2Classifier-262"><a href="#Ridge2Classifier-262"><span class="linenos">262</span></a>
</span><span id="Ridge2Classifier-263"><a href="#Ridge2Classifier-263"><span class="linenos">263</span></a>        <span class="c1"># log-likelihood (1st return)</span>
</span><span id="Ridge2Classifier-264"><a href="#Ridge2Classifier-264"><span class="linenos">264</span></a>        <span class="k">def</span> <span class="nf">loglik_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="Ridge2Classifier-265"><a href="#Ridge2Classifier-265"><span class="linenos">265</span></a>            <span class="c1"># (p, K)</span>
</span><span id="Ridge2Classifier-266"><a href="#Ridge2Classifier-266"><span class="linenos">266</span></a>            <span class="n">B</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="Ridge2Classifier-267"><a href="#Ridge2Classifier-267"><span class="linenos">267</span></a>
</span><span id="Ridge2Classifier-268"><a href="#Ridge2Classifier-268"><span class="linenos">268</span></a>            <span class="c1"># (n, K)</span>
</span><span id="Ridge2Classifier-269"><a href="#Ridge2Classifier-269"><span class="linenos">269</span></a>            <span class="n">XB</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2Classifier-270"><a href="#Ridge2Classifier-270"><span class="linenos">270</span></a>
</span><span id="Ridge2Classifier-271"><a href="#Ridge2Classifier-271"><span class="linenos">271</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Y</span> <span class="o">*</span> <span class="n">XB</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">logsumexp</span><span class="p">(</span><span class="n">XB</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</span><span id="Ridge2Classifier-272"><a href="#Ridge2Classifier-272"><span class="linenos">272</span></a>
</span><span id="Ridge2Classifier-273"><a href="#Ridge2Classifier-273"><span class="linenos">273</span></a>            <span class="n">res</span> <span class="o">+=</span> <span class="p">(</span>
</span><span id="Ridge2Classifier-274"><a href="#Ridge2Classifier-274"><span class="linenos">274</span></a>                <span class="mf">0.5</span>
</span><span id="Ridge2Classifier-275"><a href="#Ridge2Classifier-275"><span class="linenos">275</span></a>                <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span>
</span><span id="Ridge2Classifier-276"><a href="#Ridge2Classifier-276"><span class="linenos">276</span></a>                <span class="o">*</span> <span class="n">mo</span><span class="o">.</span><span class="n">squared_norm</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">init_p</span><span class="p">,</span> <span class="p">:],</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2Classifier-277"><a href="#Ridge2Classifier-277"><span class="linenos">277</span></a>            <span class="p">)</span>
</span><span id="Ridge2Classifier-278"><a href="#Ridge2Classifier-278"><span class="linenos">278</span></a>            <span class="n">res</span> <span class="o">+=</span> <span class="p">(</span>
</span><span id="Ridge2Classifier-279"><a href="#Ridge2Classifier-279"><span class="linenos">279</span></a>                <span class="mf">0.5</span>
</span><span id="Ridge2Classifier-280"><a href="#Ridge2Classifier-280"><span class="linenos">280</span></a>                <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span>
</span><span id="Ridge2Classifier-281"><a href="#Ridge2Classifier-281"><span class="linenos">281</span></a>                <span class="o">*</span> <span class="n">mo</span><span class="o">.</span><span class="n">squared_norm</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">init_p</span><span class="p">:</span><span class="n">p</span><span class="p">,</span> <span class="p">:],</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2Classifier-282"><a href="#Ridge2Classifier-282"><span class="linenos">282</span></a>            <span class="p">)</span>
</span><span id="Ridge2Classifier-283"><a href="#Ridge2Classifier-283"><span class="linenos">283</span></a>
</span><span id="Ridge2Classifier-284"><a href="#Ridge2Classifier-284"><span class="linenos">284</span></a>            <span class="k">return</span> <span class="n">res</span>
</span><span id="Ridge2Classifier-285"><a href="#Ridge2Classifier-285"><span class="linenos">285</span></a>
</span><span id="Ridge2Classifier-286"><a href="#Ridge2Classifier-286"><span class="linenos">286</span></a>        <span class="c1"># gradient of log-likelihood</span>
</span><span id="Ridge2Classifier-287"><a href="#Ridge2Classifier-287"><span class="linenos">287</span></a>        <span class="k">def</span> <span class="nf">grad_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="Ridge2Classifier-288"><a href="#Ridge2Classifier-288"><span class="linenos">288</span></a>            <span class="c1"># (p, K)</span>
</span><span id="Ridge2Classifier-289"><a href="#Ridge2Classifier-289"><span class="linenos">289</span></a>            <span class="n">B</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="Ridge2Classifier-290"><a href="#Ridge2Classifier-290"><span class="linenos">290</span></a>
</span><span id="Ridge2Classifier-291"><a href="#Ridge2Classifier-291"><span class="linenos">291</span></a>            <span class="k">return</span> <span class="n">loglik_grad_hess</span><span class="p">(</span>
</span><span id="Ridge2Classifier-292"><a href="#Ridge2Classifier-292"><span class="linenos">292</span></a>                <span class="n">Y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
</span><span id="Ridge2Classifier-293"><a href="#Ridge2Classifier-293"><span class="linenos">293</span></a>                <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
</span><span id="Ridge2Classifier-294"><a href="#Ridge2Classifier-294"><span class="linenos">294</span></a>                <span class="n">B</span><span class="o">=</span><span class="n">B</span><span class="p">,</span>
</span><span id="Ridge2Classifier-295"><a href="#Ridge2Classifier-295"><span class="linenos">295</span></a>                <span class="n">XB</span><span class="o">=</span><span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="Ridge2Classifier-296"><a href="#Ridge2Classifier-296"><span class="linenos">296</span></a>                <span class="n">hessian</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="Ridge2Classifier-297"><a href="#Ridge2Classifier-297"><span class="linenos">297</span></a>                <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Ridge2Classifier-298"><a href="#Ridge2Classifier-298"><span class="linenos">298</span></a>            <span class="p">)</span>
</span><span id="Ridge2Classifier-299"><a href="#Ridge2Classifier-299"><span class="linenos">299</span></a>
</span><span id="Ridge2Classifier-300"><a href="#Ridge2Classifier-300"><span class="linenos">300</span></a>        <span class="c1"># hessian of log-likelihood</span>
</span><span id="Ridge2Classifier-301"><a href="#Ridge2Classifier-301"><span class="linenos">301</span></a>        <span class="k">def</span> <span class="nf">hessian_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="Ridge2Classifier-302"><a href="#Ridge2Classifier-302"><span class="linenos">302</span></a>            <span class="c1"># (p, K)</span>
</span><span id="Ridge2Classifier-303"><a href="#Ridge2Classifier-303"><span class="linenos">303</span></a>            <span class="n">B</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="Ridge2Classifier-304"><a href="#Ridge2Classifier-304"><span class="linenos">304</span></a>
</span><span id="Ridge2Classifier-305"><a href="#Ridge2Classifier-305"><span class="linenos">305</span></a>            <span class="k">return</span> <span class="n">loglik_grad_hess</span><span class="p">(</span>
</span><span id="Ridge2Classifier-306"><a href="#Ridge2Classifier-306"><span class="linenos">306</span></a>                <span class="n">Y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span>
</span><span id="Ridge2Classifier-307"><a href="#Ridge2Classifier-307"><span class="linenos">307</span></a>                <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span>
</span><span id="Ridge2Classifier-308"><a href="#Ridge2Classifier-308"><span class="linenos">308</span></a>                <span class="n">B</span><span class="o">=</span><span class="n">B</span><span class="p">,</span>
</span><span id="Ridge2Classifier-309"><a href="#Ridge2Classifier-309"><span class="linenos">309</span></a>                <span class="n">XB</span><span class="o">=</span><span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="Ridge2Classifier-310"><a href="#Ridge2Classifier-310"><span class="linenos">310</span></a>                <span class="n">hessian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Ridge2Classifier-311"><a href="#Ridge2Classifier-311"><span class="linenos">311</span></a>                <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Ridge2Classifier-312"><a href="#Ridge2Classifier-312"><span class="linenos">312</span></a>            <span class="p">)</span>
</span><span id="Ridge2Classifier-313"><a href="#Ridge2Classifier-313"><span class="linenos">313</span></a>
</span><span id="Ridge2Classifier-314"><a href="#Ridge2Classifier-314"><span class="linenos">314</span></a>        <span class="k">return</span> <span class="n">loglik_func</span><span class="p">,</span> <span class="n">grad_func</span><span class="p">,</span> <span class="n">hessian_func</span>
</span><span id="Ridge2Classifier-315"><a href="#Ridge2Classifier-315"><span class="linenos">315</span></a>
</span><span id="Ridge2Classifier-316"><a href="#Ridge2Classifier-316"><span class="linenos">316</span></a>    <span class="c1"># newton-cg</span>
</span><span id="Ridge2Classifier-317"><a href="#Ridge2Classifier-317"><span class="linenos">317</span></a>    <span class="c1"># L-BFGS-B</span>
</span><span id="Ridge2Classifier-318"><a href="#Ridge2Classifier-318"><span class="linenos">318</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2Classifier-319"><a href="#Ridge2Classifier-319"><span class="linenos">319</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Ridge model to training data (X, y).</span>
</span><span id="Ridge2Classifier-320"><a href="#Ridge2Classifier-320"><span class="linenos">320</span></a>
</span><span id="Ridge2Classifier-321"><a href="#Ridge2Classifier-321"><span class="linenos">321</span></a><span class="sd">        for beta: regression coeffs (beta11, ..., beta1p, ..., betaK1, ..., betaKp)</span>
</span><span id="Ridge2Classifier-322"><a href="#Ridge2Classifier-322"><span class="linenos">322</span></a><span class="sd">        for K classes and p covariates.</span>
</span><span id="Ridge2Classifier-323"><a href="#Ridge2Classifier-323"><span class="linenos">323</span></a>
</span><span id="Ridge2Classifier-324"><a href="#Ridge2Classifier-324"><span class="linenos">324</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2Classifier-325"><a href="#Ridge2Classifier-325"><span class="linenos">325</span></a>
</span><span id="Ridge2Classifier-326"><a href="#Ridge2Classifier-326"><span class="linenos">326</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2Classifier-327"><a href="#Ridge2Classifier-327"><span class="linenos">327</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2Classifier-328"><a href="#Ridge2Classifier-328"><span class="linenos">328</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2Classifier-329"><a href="#Ridge2Classifier-329"><span class="linenos">329</span></a>
</span><span id="Ridge2Classifier-330"><a href="#Ridge2Classifier-330"><span class="linenos">330</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="Ridge2Classifier-331"><a href="#Ridge2Classifier-331"><span class="linenos">331</span></a><span class="sd">                Target values.</span>
</span><span id="Ridge2Classifier-332"><a href="#Ridge2Classifier-332"><span class="linenos">332</span></a>
</span><span id="Ridge2Classifier-333"><a href="#Ridge2Classifier-333"><span class="linenos">333</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2Classifier-334"><a href="#Ridge2Classifier-334"><span class="linenos">334</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="Ridge2Classifier-335"><a href="#Ridge2Classifier-335"><span class="linenos">335</span></a>
</span><span id="Ridge2Classifier-336"><a href="#Ridge2Classifier-336"><span class="linenos">336</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2Classifier-337"><a href="#Ridge2Classifier-337"><span class="linenos">337</span></a>
</span><span id="Ridge2Classifier-338"><a href="#Ridge2Classifier-338"><span class="linenos">338</span></a><span class="sd">            self: object</span>
</span><span id="Ridge2Classifier-339"><a href="#Ridge2Classifier-339"><span class="linenos">339</span></a>
</span><span id="Ridge2Classifier-340"><a href="#Ridge2Classifier-340"><span class="linenos">340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2Classifier-341"><a href="#Ridge2Classifier-341"><span class="linenos">341</span></a>
</span><span id="Ridge2Classifier-342"><a href="#Ridge2Classifier-342"><span class="linenos">342</span></a>        <span class="k">assert</span> <span class="n">mx</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s2">&quot;y must contain only integers&quot;</span>
</span><span id="Ridge2Classifier-343"><a href="#Ridge2Classifier-343"><span class="linenos">343</span></a>
</span><span id="Ridge2Classifier-344"><a href="#Ridge2Classifier-344"><span class="linenos">344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="Ridge2Classifier-345"><a href="#Ridge2Classifier-345"><span class="linenos">345</span></a>
</span><span id="Ridge2Classifier-346"><a href="#Ridge2Classifier-346"><span class="linenos">346</span></a>        <span class="n">output_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Ridge2Classifier-347"><a href="#Ridge2Classifier-347"><span class="linenos">347</span></a>
</span><span id="Ridge2Classifier-348"><a href="#Ridge2Classifier-348"><span class="linenos">348</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="Ridge2Classifier-349"><a href="#Ridge2Classifier-349"><span class="linenos">349</span></a>
</span><span id="Ridge2Classifier-350"><a href="#Ridge2Classifier-350"><span class="linenos">350</span></a>        <span class="n">Y</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">one_hot_encode2</span><span class="p">(</span><span class="n">output_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">)</span>
</span><span id="Ridge2Classifier-351"><a href="#Ridge2Classifier-351"><span class="linenos">351</span></a>
</span><span id="Ridge2Classifier-352"><a href="#Ridge2Classifier-352"><span class="linenos">352</span></a>        <span class="c1"># optimize for beta, minimize self.loglik (maximize loglik) -----</span>
</span><span id="Ridge2Classifier-353"><a href="#Ridge2Classifier-353"><span class="linenos">353</span></a>        <span class="n">loglik_func</span><span class="p">,</span> <span class="n">grad_func</span><span class="p">,</span> <span class="n">hessian_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loglik</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
</span><span id="Ridge2Classifier-354"><a href="#Ridge2Classifier-354"><span class="linenos">354</span></a>
</span><span id="Ridge2Classifier-355"><a href="#Ridge2Classifier-355"><span class="linenos">355</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="o">==</span> <span class="s2">&quot;L-BFGS-B&quot;</span><span class="p">:</span>
</span><span id="Ridge2Classifier-356"><a href="#Ridge2Classifier-356"><span class="linenos">356</span></a>            <span class="n">opt</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
</span><span id="Ridge2Classifier-357"><a href="#Ridge2Classifier-357"><span class="linenos">357</span></a>                <span class="n">fun</span><span class="o">=</span><span class="n">loglik_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier-358"><a href="#Ridge2Classifier-358"><span class="linenos">358</span></a>                <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">scaled_Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">),</span>
</span><span id="Ridge2Classifier-359"><a href="#Ridge2Classifier-359"><span class="linenos">359</span></a>                <span class="n">jac</span><span class="o">=</span><span class="n">grad_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier-360"><a href="#Ridge2Classifier-360"><span class="linenos">360</span></a>                <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="p">,</span>
</span><span id="Ridge2Classifier-361"><a href="#Ridge2Classifier-361"><span class="linenos">361</span></a>            <span class="p">)</span>
</span><span id="Ridge2Classifier-362"><a href="#Ridge2Classifier-362"><span class="linenos">362</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">x</span>
</span><span id="Ridge2Classifier-363"><a href="#Ridge2Classifier-363"><span class="linenos">363</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minloglik_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fun</span>
</span><span id="Ridge2Classifier-364"><a href="#Ridge2Classifier-364"><span class="linenos">364</span></a>
</span><span id="Ridge2Classifier-365"><a href="#Ridge2Classifier-365"><span class="linenos">365</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Newton-CG&quot;</span><span class="p">,</span> <span class="s2">&quot;trust-ncg&quot;</span><span class="p">):</span>
</span><span id="Ridge2Classifier-366"><a href="#Ridge2Classifier-366"><span class="linenos">366</span></a>            <span class="n">opt</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
</span><span id="Ridge2Classifier-367"><a href="#Ridge2Classifier-367"><span class="linenos">367</span></a>                <span class="n">fun</span><span class="o">=</span><span class="n">loglik_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier-368"><a href="#Ridge2Classifier-368"><span class="linenos">368</span></a>                <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">scaled_Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">),</span>
</span><span id="Ridge2Classifier-369"><a href="#Ridge2Classifier-369"><span class="linenos">369</span></a>                <span class="n">jac</span><span class="o">=</span><span class="n">grad_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier-370"><a href="#Ridge2Classifier-370"><span class="linenos">370</span></a>                <span class="n">hess</span><span class="o">=</span><span class="n">hessian_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier-371"><a href="#Ridge2Classifier-371"><span class="linenos">371</span></a>                <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="p">,</span>
</span><span id="Ridge2Classifier-372"><a href="#Ridge2Classifier-372"><span class="linenos">372</span></a>            <span class="p">)</span>
</span><span id="Ridge2Classifier-373"><a href="#Ridge2Classifier-373"><span class="linenos">373</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">x</span>
</span><span id="Ridge2Classifier-374"><a href="#Ridge2Classifier-374"><span class="linenos">374</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minloglik_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fun</span>
</span><span id="Ridge2Classifier-375"><a href="#Ridge2Classifier-375"><span class="linenos">375</span></a>
</span><span id="Ridge2Classifier-376"><a href="#Ridge2Classifier-376"><span class="linenos">376</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="o">==</span> <span class="s2">&quot;L-BFGS-B-lstsq&quot;</span><span class="p">:</span>
</span><span id="Ridge2Classifier-377"><a href="#Ridge2Classifier-377"><span class="linenos">377</span></a>            <span class="n">opt</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
</span><span id="Ridge2Classifier-378"><a href="#Ridge2Classifier-378"><span class="linenos">378</span></a>                <span class="n">fun</span><span class="o">=</span><span class="n">loglik_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier-379"><a href="#Ridge2Classifier-379"><span class="linenos">379</span></a>                <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span>
</span><span id="Ridge2Classifier-380"><a href="#Ridge2Classifier-380"><span class="linenos">380</span></a>                    <span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span>
</span><span id="Ridge2Classifier-381"><a href="#Ridge2Classifier-381"><span class="linenos">381</span></a>                <span class="p">),</span>
</span><span id="Ridge2Classifier-382"><a href="#Ridge2Classifier-382"><span class="linenos">382</span></a>                <span class="n">jac</span><span class="o">=</span><span class="n">grad_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier-383"><a href="#Ridge2Classifier-383"><span class="linenos">383</span></a>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;L-BFGS-B&quot;</span><span class="p">,</span>
</span><span id="Ridge2Classifier-384"><a href="#Ridge2Classifier-384"><span class="linenos">384</span></a>            <span class="p">)</span>
</span><span id="Ridge2Classifier-385"><a href="#Ridge2Classifier-385"><span class="linenos">385</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">x</span>
</span><span id="Ridge2Classifier-386"><a href="#Ridge2Classifier-386"><span class="linenos">386</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minloglik_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fun</span>
</span><span id="Ridge2Classifier-387"><a href="#Ridge2Classifier-387"><span class="linenos">387</span></a>
</span><span id="Ridge2Classifier-388"><a href="#Ridge2Classifier-388"><span class="linenos">388</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="ow">in</span> <span class="s2">&quot;Newton-CG-lstsq&quot;</span><span class="p">:</span>
</span><span id="Ridge2Classifier-389"><a href="#Ridge2Classifier-389"><span class="linenos">389</span></a>            <span class="n">opt</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
</span><span id="Ridge2Classifier-390"><a href="#Ridge2Classifier-390"><span class="linenos">390</span></a>                <span class="n">fun</span><span class="o">=</span><span class="n">loglik_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier-391"><a href="#Ridge2Classifier-391"><span class="linenos">391</span></a>                <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span>
</span><span id="Ridge2Classifier-392"><a href="#Ridge2Classifier-392"><span class="linenos">392</span></a>                    <span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span>
</span><span id="Ridge2Classifier-393"><a href="#Ridge2Classifier-393"><span class="linenos">393</span></a>                <span class="p">),</span>
</span><span id="Ridge2Classifier-394"><a href="#Ridge2Classifier-394"><span class="linenos">394</span></a>                <span class="n">jac</span><span class="o">=</span><span class="n">grad_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier-395"><a href="#Ridge2Classifier-395"><span class="linenos">395</span></a>                <span class="n">hess</span><span class="o">=</span><span class="n">hessian_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier-396"><a href="#Ridge2Classifier-396"><span class="linenos">396</span></a>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Newton-CG&quot;</span><span class="p">,</span>
</span><span id="Ridge2Classifier-397"><a href="#Ridge2Classifier-397"><span class="linenos">397</span></a>            <span class="p">)</span>
</span><span id="Ridge2Classifier-398"><a href="#Ridge2Classifier-398"><span class="linenos">398</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">x</span>
</span><span id="Ridge2Classifier-399"><a href="#Ridge2Classifier-399"><span class="linenos">399</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minloglik_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fun</span>
</span><span id="Ridge2Classifier-400"><a href="#Ridge2Classifier-400"><span class="linenos">400</span></a>
</span><span id="Ridge2Classifier-401"><a href="#Ridge2Classifier-401"><span class="linenos">401</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="ow">in</span> <span class="s2">&quot;trust-ncg-lstsq&quot;</span><span class="p">:</span>
</span><span id="Ridge2Classifier-402"><a href="#Ridge2Classifier-402"><span class="linenos">402</span></a>            <span class="n">opt</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
</span><span id="Ridge2Classifier-403"><a href="#Ridge2Classifier-403"><span class="linenos">403</span></a>                <span class="n">fun</span><span class="o">=</span><span class="n">loglik_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier-404"><a href="#Ridge2Classifier-404"><span class="linenos">404</span></a>                <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span>
</span><span id="Ridge2Classifier-405"><a href="#Ridge2Classifier-405"><span class="linenos">405</span></a>                    <span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span>
</span><span id="Ridge2Classifier-406"><a href="#Ridge2Classifier-406"><span class="linenos">406</span></a>                <span class="p">),</span>
</span><span id="Ridge2Classifier-407"><a href="#Ridge2Classifier-407"><span class="linenos">407</span></a>                <span class="n">jac</span><span class="o">=</span><span class="n">grad_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier-408"><a href="#Ridge2Classifier-408"><span class="linenos">408</span></a>                <span class="n">hess</span><span class="o">=</span><span class="n">hessian_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier-409"><a href="#Ridge2Classifier-409"><span class="linenos">409</span></a>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;trust-ncg&quot;</span><span class="p">,</span>
</span><span id="Ridge2Classifier-410"><a href="#Ridge2Classifier-410"><span class="linenos">410</span></a>            <span class="p">)</span>
</span><span id="Ridge2Classifier-411"><a href="#Ridge2Classifier-411"><span class="linenos">411</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">x</span>
</span><span id="Ridge2Classifier-412"><a href="#Ridge2Classifier-412"><span class="linenos">412</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minloglik_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fun</span>
</span><span id="Ridge2Classifier-413"><a href="#Ridge2Classifier-413"><span class="linenos">413</span></a>
</span><span id="Ridge2Classifier-414"><a href="#Ridge2Classifier-414"><span class="linenos">414</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="Ridge2Classifier-415"><a href="#Ridge2Classifier-415"><span class="linenos">415</span></a>
</span><span id="Ridge2Classifier-416"><a href="#Ridge2Classifier-416"><span class="linenos">416</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Ridge2Classifier-417"><a href="#Ridge2Classifier-417"><span class="linenos">417</span></a>
</span><span id="Ridge2Classifier-418"><a href="#Ridge2Classifier-418"><span class="linenos">418</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2Classifier-419"><a href="#Ridge2Classifier-419"><span class="linenos">419</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="Ridge2Classifier-420"><a href="#Ridge2Classifier-420"><span class="linenos">420</span></a>
</span><span id="Ridge2Classifier-421"><a href="#Ridge2Classifier-421"><span class="linenos">421</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2Classifier-422"><a href="#Ridge2Classifier-422"><span class="linenos">422</span></a>
</span><span id="Ridge2Classifier-423"><a href="#Ridge2Classifier-423"><span class="linenos">423</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2Classifier-424"><a href="#Ridge2Classifier-424"><span class="linenos">424</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2Classifier-425"><a href="#Ridge2Classifier-425"><span class="linenos">425</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2Classifier-426"><a href="#Ridge2Classifier-426"><span class="linenos">426</span></a>
</span><span id="Ridge2Classifier-427"><a href="#Ridge2Classifier-427"><span class="linenos">427</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2Classifier-428"><a href="#Ridge2Classifier-428"><span class="linenos">428</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="Ridge2Classifier-429"><a href="#Ridge2Classifier-429"><span class="linenos">429</span></a>
</span><span id="Ridge2Classifier-430"><a href="#Ridge2Classifier-430"><span class="linenos">430</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2Classifier-431"><a href="#Ridge2Classifier-431"><span class="linenos">431</span></a>
</span><span id="Ridge2Classifier-432"><a href="#Ridge2Classifier-432"><span class="linenos">432</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="Ridge2Classifier-433"><a href="#Ridge2Classifier-433"><span class="linenos">433</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2Classifier-434"><a href="#Ridge2Classifier-434"><span class="linenos">434</span></a>
</span><span id="Ridge2Classifier-435"><a href="#Ridge2Classifier-435"><span class="linenos">435</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Ridge2Classifier-436"><a href="#Ridge2Classifier-436"><span class="linenos">436</span></a>
</span><span id="Ridge2Classifier-437"><a href="#Ridge2Classifier-437"><span class="linenos">437</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2Classifier-438"><a href="#Ridge2Classifier-438"><span class="linenos">438</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probabilities for test data X.</span>
</span><span id="Ridge2Classifier-439"><a href="#Ridge2Classifier-439"><span class="linenos">439</span></a>
</span><span id="Ridge2Classifier-440"><a href="#Ridge2Classifier-440"><span class="linenos">440</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2Classifier-441"><a href="#Ridge2Classifier-441"><span class="linenos">441</span></a>
</span><span id="Ridge2Classifier-442"><a href="#Ridge2Classifier-442"><span class="linenos">442</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2Classifier-443"><a href="#Ridge2Classifier-443"><span class="linenos">443</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2Classifier-444"><a href="#Ridge2Classifier-444"><span class="linenos">444</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2Classifier-445"><a href="#Ridge2Classifier-445"><span class="linenos">445</span></a>
</span><span id="Ridge2Classifier-446"><a href="#Ridge2Classifier-446"><span class="linenos">446</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2Classifier-447"><a href="#Ridge2Classifier-447"><span class="linenos">447</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="Ridge2Classifier-448"><a href="#Ridge2Classifier-448"><span class="linenos">448</span></a>
</span><span id="Ridge2Classifier-449"><a href="#Ridge2Classifier-449"><span class="linenos">449</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2Classifier-450"><a href="#Ridge2Classifier-450"><span class="linenos">450</span></a>
</span><span id="Ridge2Classifier-451"><a href="#Ridge2Classifier-451"><span class="linenos">451</span></a><span class="sd">            probability estimates for test data: {array-like}</span>
</span><span id="Ridge2Classifier-452"><a href="#Ridge2Classifier-452"><span class="linenos">452</span></a>
</span><span id="Ridge2Classifier-453"><a href="#Ridge2Classifier-453"><span class="linenos">453</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2Classifier-454"><a href="#Ridge2Classifier-454"><span class="linenos">454</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Ridge2Classifier-455"><a href="#Ridge2Classifier-455"><span class="linenos">455</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Ridge2Classifier-456"><a href="#Ridge2Classifier-456"><span class="linenos">456</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="Ridge2Classifier-457"><a href="#Ridge2Classifier-457"><span class="linenos">457</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="Ridge2Classifier-458"><a href="#Ridge2Classifier-458"><span class="linenos">458</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="Ridge2Classifier-459"><a href="#Ridge2Classifier-459"><span class="linenos">459</span></a>            <span class="p">)</span>
</span><span id="Ridge2Classifier-460"><a href="#Ridge2Classifier-460"><span class="linenos">460</span></a>
</span><span id="Ridge2Classifier-461"><a href="#Ridge2Classifier-461"><span class="linenos">461</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Ridge2Classifier-462"><a href="#Ridge2Classifier-462"><span class="linenos">462</span></a>
</span><span id="Ridge2Classifier-463"><a href="#Ridge2Classifier-463"><span class="linenos">463</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2Classifier-464"><a href="#Ridge2Classifier-464"><span class="linenos">464</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Ridge2Classifier-465"><a href="#Ridge2Classifier-465"><span class="linenos">465</span></a>
</span><span id="Ridge2Classifier-466"><a href="#Ridge2Classifier-466"><span class="linenos">466</span></a>        <span class="n">ZB</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Ridge2Classifier-467"><a href="#Ridge2Classifier-467"><span class="linenos">467</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span>
</span><span id="Ridge2Classifier-468"><a href="#Ridge2Classifier-468"><span class="linenos">468</span></a>            <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="Ridge2Classifier-469"><a href="#Ridge2Classifier-469"><span class="linenos">469</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">,</span>
</span><span id="Ridge2Classifier-470"><a href="#Ridge2Classifier-470"><span class="linenos">470</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="Ridge2Classifier-471"><a href="#Ridge2Classifier-471"><span class="linenos">471</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="Ridge2Classifier-472"><a href="#Ridge2Classifier-472"><span class="linenos">472</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Classifier-473"><a href="#Ridge2Classifier-473"><span class="linenos">473</span></a>        <span class="p">)</span>
</span><span id="Ridge2Classifier-474"><a href="#Ridge2Classifier-474"><span class="linenos">474</span></a>
</span><span id="Ridge2Classifier-475"><a href="#Ridge2Classifier-475"><span class="linenos">475</span></a>        <span class="n">exp_ZB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ZB</span><span class="p">)</span>
</span><span id="Ridge2Classifier-476"><a href="#Ridge2Classifier-476"><span class="linenos">476</span></a>
</span><span id="Ridge2Classifier-477"><a href="#Ridge2Classifier-477"><span class="linenos">477</span></a>        <span class="k">return</span> <span class="n">exp_ZB</span> <span class="o">/</span> <span class="n">exp_ZB</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Multinomial logit classification with 2 regularization parameters</p>

<p>Parameters:</p>

<pre><code>n_hidden_features: int
    number of nodes in the hidden layer

activation_name: str
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'

a: float
    hyperparameter for 'prelu' or 'elu' activation function

nodes_sim: str
    type of simulation for the nodes: 'sobol', 'hammersley', 'halton',
    'uniform'

bias: boolean
    indicates if the hidden layer contains a bias term (True) or not
    (False)

dropout: float
    regularization parameter; (random) percentage of nodes dropped out
    of the training

direct_link: boolean
    indicates if the original predictors are included (True) in model's
    fitting or not (False)

n_clusters: int
    number of clusters for 'kmeans' or 'gmm' clustering (could be 0:
        no clustering)

cluster_encode: bool
    defines how the variable containing clusters is treated (default is one-hot)
    if `False`, then labels are used, without one-hot encoding

type_clust: str
    type of clustering method: currently k-means ('kmeans') or Gaussian
    Mixture Model ('gmm')

type_scaling: a tuple of 3 strings
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax')

lambda1: float
    regularization parameter on direct link

lambda2: float
    regularization parameter on hidden layer

solver: str
    optimization function "L-BFGS-B",  "Newton-CG",
    "trust-ncg", "L-BFGS-B-lstsq", "Newton-CG-lstsq",
    "trust-ncg-lstsq" (see scipy.optimize.minimize)
    When using "L-BFGS-B-lstsq", "Newton-CG-lstsq", or "trust-ncg-lstsq",
    the initial value for the optimization is set to the least squares solution

seed: int
    reproducibility seed for nodes_sim=='uniform'

backend: str
    "cpu" or "gpu" or "tpu"
</code></pre>

<p>Attributes:</p>

<pre><code>beta_: {array-like}
    regression coefficients

classes_: {array-like}
    unique classes in the target variable

minloglik_: float
    minimum value of the negative log-likelihood
</code></pre>

<p>Examples:</p>

<p>See also <a href="https://github.com/Techtonique/nnetsauce/blob/master/examples/ridge_classification.py">https://github.com/Techtonique/nnetsauce/blob/master/examples/ridge_classification.py</a></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>


<span class="n">breast_cancer</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">breast_cancer</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">breast_cancer</span><span class="o">.</span><span class="n">target</span>

<span class="c1"># split data into training test and test set</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># create the model with nnetsauce</span>
<span class="n">fit_obj</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">Ridge2Classifier</span><span class="p">(</span><span class="n">lambda1</span> <span class="o">=</span> <span class="mf">6.90185578e+04</span><span class="p">,</span>
                            <span class="n">lambda2</span> <span class="o">=</span> <span class="mf">3.17392781e+02</span><span class="p">,</span>
                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">95</span><span class="p">,</span>
                            <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">dropout</span> <span class="o">=</span> <span class="mf">3.62817383e-01</span><span class="p">,</span>
                            <span class="n">type_clust</span> <span class="o">=</span> <span class="s2">&quot;gmm&quot;</span><span class="p">)</span>

<span class="c1"># fit the model on training set</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">fit_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Elapsed </span><span class="si">{</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># get the accuracy on test set</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fit_obj</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Elapsed </span><span class="si">{</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># get area under the curve on test set (auc)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fit_obj</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;roc_auc&quot;</span><span class="p">))</span>
</code></pre>
</div>
</div>


                                <div id="Ridge2Classifier.fit" class="classattr">
                                            <input id="Ridge2Classifier.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Ridge2Classifier.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Ridge2Classifier.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Ridge2Classifier.fit-318"><a href="#Ridge2Classifier.fit-318"><span class="linenos">318</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2Classifier.fit-319"><a href="#Ridge2Classifier.fit-319"><span class="linenos">319</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Ridge model to training data (X, y).</span>
</span><span id="Ridge2Classifier.fit-320"><a href="#Ridge2Classifier.fit-320"><span class="linenos">320</span></a>
</span><span id="Ridge2Classifier.fit-321"><a href="#Ridge2Classifier.fit-321"><span class="linenos">321</span></a><span class="sd">        for beta: regression coeffs (beta11, ..., beta1p, ..., betaK1, ..., betaKp)</span>
</span><span id="Ridge2Classifier.fit-322"><a href="#Ridge2Classifier.fit-322"><span class="linenos">322</span></a><span class="sd">        for K classes and p covariates.</span>
</span><span id="Ridge2Classifier.fit-323"><a href="#Ridge2Classifier.fit-323"><span class="linenos">323</span></a>
</span><span id="Ridge2Classifier.fit-324"><a href="#Ridge2Classifier.fit-324"><span class="linenos">324</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2Classifier.fit-325"><a href="#Ridge2Classifier.fit-325"><span class="linenos">325</span></a>
</span><span id="Ridge2Classifier.fit-326"><a href="#Ridge2Classifier.fit-326"><span class="linenos">326</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2Classifier.fit-327"><a href="#Ridge2Classifier.fit-327"><span class="linenos">327</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2Classifier.fit-328"><a href="#Ridge2Classifier.fit-328"><span class="linenos">328</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2Classifier.fit-329"><a href="#Ridge2Classifier.fit-329"><span class="linenos">329</span></a>
</span><span id="Ridge2Classifier.fit-330"><a href="#Ridge2Classifier.fit-330"><span class="linenos">330</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="Ridge2Classifier.fit-331"><a href="#Ridge2Classifier.fit-331"><span class="linenos">331</span></a><span class="sd">                Target values.</span>
</span><span id="Ridge2Classifier.fit-332"><a href="#Ridge2Classifier.fit-332"><span class="linenos">332</span></a>
</span><span id="Ridge2Classifier.fit-333"><a href="#Ridge2Classifier.fit-333"><span class="linenos">333</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2Classifier.fit-334"><a href="#Ridge2Classifier.fit-334"><span class="linenos">334</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="Ridge2Classifier.fit-335"><a href="#Ridge2Classifier.fit-335"><span class="linenos">335</span></a>
</span><span id="Ridge2Classifier.fit-336"><a href="#Ridge2Classifier.fit-336"><span class="linenos">336</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2Classifier.fit-337"><a href="#Ridge2Classifier.fit-337"><span class="linenos">337</span></a>
</span><span id="Ridge2Classifier.fit-338"><a href="#Ridge2Classifier.fit-338"><span class="linenos">338</span></a><span class="sd">            self: object</span>
</span><span id="Ridge2Classifier.fit-339"><a href="#Ridge2Classifier.fit-339"><span class="linenos">339</span></a>
</span><span id="Ridge2Classifier.fit-340"><a href="#Ridge2Classifier.fit-340"><span class="linenos">340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2Classifier.fit-341"><a href="#Ridge2Classifier.fit-341"><span class="linenos">341</span></a>
</span><span id="Ridge2Classifier.fit-342"><a href="#Ridge2Classifier.fit-342"><span class="linenos">342</span></a>        <span class="k">assert</span> <span class="n">mx</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s2">&quot;y must contain only integers&quot;</span>
</span><span id="Ridge2Classifier.fit-343"><a href="#Ridge2Classifier.fit-343"><span class="linenos">343</span></a>
</span><span id="Ridge2Classifier.fit-344"><a href="#Ridge2Classifier.fit-344"><span class="linenos">344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="Ridge2Classifier.fit-345"><a href="#Ridge2Classifier.fit-345"><span class="linenos">345</span></a>
</span><span id="Ridge2Classifier.fit-346"><a href="#Ridge2Classifier.fit-346"><span class="linenos">346</span></a>        <span class="n">output_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Ridge2Classifier.fit-347"><a href="#Ridge2Classifier.fit-347"><span class="linenos">347</span></a>
</span><span id="Ridge2Classifier.fit-348"><a href="#Ridge2Classifier.fit-348"><span class="linenos">348</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="Ridge2Classifier.fit-349"><a href="#Ridge2Classifier.fit-349"><span class="linenos">349</span></a>
</span><span id="Ridge2Classifier.fit-350"><a href="#Ridge2Classifier.fit-350"><span class="linenos">350</span></a>        <span class="n">Y</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">one_hot_encode2</span><span class="p">(</span><span class="n">output_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">)</span>
</span><span id="Ridge2Classifier.fit-351"><a href="#Ridge2Classifier.fit-351"><span class="linenos">351</span></a>
</span><span id="Ridge2Classifier.fit-352"><a href="#Ridge2Classifier.fit-352"><span class="linenos">352</span></a>        <span class="c1"># optimize for beta, minimize self.loglik (maximize loglik) -----</span>
</span><span id="Ridge2Classifier.fit-353"><a href="#Ridge2Classifier.fit-353"><span class="linenos">353</span></a>        <span class="n">loglik_func</span><span class="p">,</span> <span class="n">grad_func</span><span class="p">,</span> <span class="n">hessian_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loglik</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
</span><span id="Ridge2Classifier.fit-354"><a href="#Ridge2Classifier.fit-354"><span class="linenos">354</span></a>
</span><span id="Ridge2Classifier.fit-355"><a href="#Ridge2Classifier.fit-355"><span class="linenos">355</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="o">==</span> <span class="s2">&quot;L-BFGS-B&quot;</span><span class="p">:</span>
</span><span id="Ridge2Classifier.fit-356"><a href="#Ridge2Classifier.fit-356"><span class="linenos">356</span></a>            <span class="n">opt</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
</span><span id="Ridge2Classifier.fit-357"><a href="#Ridge2Classifier.fit-357"><span class="linenos">357</span></a>                <span class="n">fun</span><span class="o">=</span><span class="n">loglik_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-358"><a href="#Ridge2Classifier.fit-358"><span class="linenos">358</span></a>                <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">scaled_Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">),</span>
</span><span id="Ridge2Classifier.fit-359"><a href="#Ridge2Classifier.fit-359"><span class="linenos">359</span></a>                <span class="n">jac</span><span class="o">=</span><span class="n">grad_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-360"><a href="#Ridge2Classifier.fit-360"><span class="linenos">360</span></a>                <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-361"><a href="#Ridge2Classifier.fit-361"><span class="linenos">361</span></a>            <span class="p">)</span>
</span><span id="Ridge2Classifier.fit-362"><a href="#Ridge2Classifier.fit-362"><span class="linenos">362</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">x</span>
</span><span id="Ridge2Classifier.fit-363"><a href="#Ridge2Classifier.fit-363"><span class="linenos">363</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minloglik_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fun</span>
</span><span id="Ridge2Classifier.fit-364"><a href="#Ridge2Classifier.fit-364"><span class="linenos">364</span></a>
</span><span id="Ridge2Classifier.fit-365"><a href="#Ridge2Classifier.fit-365"><span class="linenos">365</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Newton-CG&quot;</span><span class="p">,</span> <span class="s2">&quot;trust-ncg&quot;</span><span class="p">):</span>
</span><span id="Ridge2Classifier.fit-366"><a href="#Ridge2Classifier.fit-366"><span class="linenos">366</span></a>            <span class="n">opt</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
</span><span id="Ridge2Classifier.fit-367"><a href="#Ridge2Classifier.fit-367"><span class="linenos">367</span></a>                <span class="n">fun</span><span class="o">=</span><span class="n">loglik_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-368"><a href="#Ridge2Classifier.fit-368"><span class="linenos">368</span></a>                <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">scaled_Z</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">),</span>
</span><span id="Ridge2Classifier.fit-369"><a href="#Ridge2Classifier.fit-369"><span class="linenos">369</span></a>                <span class="n">jac</span><span class="o">=</span><span class="n">grad_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-370"><a href="#Ridge2Classifier.fit-370"><span class="linenos">370</span></a>                <span class="n">hess</span><span class="o">=</span><span class="n">hessian_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-371"><a href="#Ridge2Classifier.fit-371"><span class="linenos">371</span></a>                <span class="n">method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-372"><a href="#Ridge2Classifier.fit-372"><span class="linenos">372</span></a>            <span class="p">)</span>
</span><span id="Ridge2Classifier.fit-373"><a href="#Ridge2Classifier.fit-373"><span class="linenos">373</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">x</span>
</span><span id="Ridge2Classifier.fit-374"><a href="#Ridge2Classifier.fit-374"><span class="linenos">374</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minloglik_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fun</span>
</span><span id="Ridge2Classifier.fit-375"><a href="#Ridge2Classifier.fit-375"><span class="linenos">375</span></a>
</span><span id="Ridge2Classifier.fit-376"><a href="#Ridge2Classifier.fit-376"><span class="linenos">376</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="o">==</span> <span class="s2">&quot;L-BFGS-B-lstsq&quot;</span><span class="p">:</span>
</span><span id="Ridge2Classifier.fit-377"><a href="#Ridge2Classifier.fit-377"><span class="linenos">377</span></a>            <span class="n">opt</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
</span><span id="Ridge2Classifier.fit-378"><a href="#Ridge2Classifier.fit-378"><span class="linenos">378</span></a>                <span class="n">fun</span><span class="o">=</span><span class="n">loglik_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-379"><a href="#Ridge2Classifier.fit-379"><span class="linenos">379</span></a>                <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span>
</span><span id="Ridge2Classifier.fit-380"><a href="#Ridge2Classifier.fit-380"><span class="linenos">380</span></a>                    <span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span>
</span><span id="Ridge2Classifier.fit-381"><a href="#Ridge2Classifier.fit-381"><span class="linenos">381</span></a>                <span class="p">),</span>
</span><span id="Ridge2Classifier.fit-382"><a href="#Ridge2Classifier.fit-382"><span class="linenos">382</span></a>                <span class="n">jac</span><span class="o">=</span><span class="n">grad_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-383"><a href="#Ridge2Classifier.fit-383"><span class="linenos">383</span></a>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;L-BFGS-B&quot;</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-384"><a href="#Ridge2Classifier.fit-384"><span class="linenos">384</span></a>            <span class="p">)</span>
</span><span id="Ridge2Classifier.fit-385"><a href="#Ridge2Classifier.fit-385"><span class="linenos">385</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">x</span>
</span><span id="Ridge2Classifier.fit-386"><a href="#Ridge2Classifier.fit-386"><span class="linenos">386</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minloglik_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fun</span>
</span><span id="Ridge2Classifier.fit-387"><a href="#Ridge2Classifier.fit-387"><span class="linenos">387</span></a>
</span><span id="Ridge2Classifier.fit-388"><a href="#Ridge2Classifier.fit-388"><span class="linenos">388</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="ow">in</span> <span class="s2">&quot;Newton-CG-lstsq&quot;</span><span class="p">:</span>
</span><span id="Ridge2Classifier.fit-389"><a href="#Ridge2Classifier.fit-389"><span class="linenos">389</span></a>            <span class="n">opt</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
</span><span id="Ridge2Classifier.fit-390"><a href="#Ridge2Classifier.fit-390"><span class="linenos">390</span></a>                <span class="n">fun</span><span class="o">=</span><span class="n">loglik_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-391"><a href="#Ridge2Classifier.fit-391"><span class="linenos">391</span></a>                <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span>
</span><span id="Ridge2Classifier.fit-392"><a href="#Ridge2Classifier.fit-392"><span class="linenos">392</span></a>                    <span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span>
</span><span id="Ridge2Classifier.fit-393"><a href="#Ridge2Classifier.fit-393"><span class="linenos">393</span></a>                <span class="p">),</span>
</span><span id="Ridge2Classifier.fit-394"><a href="#Ridge2Classifier.fit-394"><span class="linenos">394</span></a>                <span class="n">jac</span><span class="o">=</span><span class="n">grad_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-395"><a href="#Ridge2Classifier.fit-395"><span class="linenos">395</span></a>                <span class="n">hess</span><span class="o">=</span><span class="n">hessian_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-396"><a href="#Ridge2Classifier.fit-396"><span class="linenos">396</span></a>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;Newton-CG&quot;</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-397"><a href="#Ridge2Classifier.fit-397"><span class="linenos">397</span></a>            <span class="p">)</span>
</span><span id="Ridge2Classifier.fit-398"><a href="#Ridge2Classifier.fit-398"><span class="linenos">398</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">x</span>
</span><span id="Ridge2Classifier.fit-399"><a href="#Ridge2Classifier.fit-399"><span class="linenos">399</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minloglik_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fun</span>
</span><span id="Ridge2Classifier.fit-400"><a href="#Ridge2Classifier.fit-400"><span class="linenos">400</span></a>
</span><span id="Ridge2Classifier.fit-401"><a href="#Ridge2Classifier.fit-401"><span class="linenos">401</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="ow">in</span> <span class="s2">&quot;trust-ncg-lstsq&quot;</span><span class="p">:</span>
</span><span id="Ridge2Classifier.fit-402"><a href="#Ridge2Classifier.fit-402"><span class="linenos">402</span></a>            <span class="n">opt</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
</span><span id="Ridge2Classifier.fit-403"><a href="#Ridge2Classifier.fit-403"><span class="linenos">403</span></a>                <span class="n">fun</span><span class="o">=</span><span class="n">loglik_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-404"><a href="#Ridge2Classifier.fit-404"><span class="linenos">404</span></a>                <span class="n">x0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span>
</span><span id="Ridge2Classifier.fit-405"><a href="#Ridge2Classifier.fit-405"><span class="linenos">405</span></a>                    <span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span>
</span><span id="Ridge2Classifier.fit-406"><a href="#Ridge2Classifier.fit-406"><span class="linenos">406</span></a>                <span class="p">),</span>
</span><span id="Ridge2Classifier.fit-407"><a href="#Ridge2Classifier.fit-407"><span class="linenos">407</span></a>                <span class="n">jac</span><span class="o">=</span><span class="n">grad_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-408"><a href="#Ridge2Classifier.fit-408"><span class="linenos">408</span></a>                <span class="n">hess</span><span class="o">=</span><span class="n">hessian_func</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-409"><a href="#Ridge2Classifier.fit-409"><span class="linenos">409</span></a>                <span class="n">method</span><span class="o">=</span><span class="s2">&quot;trust-ncg&quot;</span><span class="p">,</span>
</span><span id="Ridge2Classifier.fit-410"><a href="#Ridge2Classifier.fit-410"><span class="linenos">410</span></a>            <span class="p">)</span>
</span><span id="Ridge2Classifier.fit-411"><a href="#Ridge2Classifier.fit-411"><span class="linenos">411</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">x</span>
</span><span id="Ridge2Classifier.fit-412"><a href="#Ridge2Classifier.fit-412"><span class="linenos">412</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">minloglik_</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">fun</span>
</span><span id="Ridge2Classifier.fit-413"><a href="#Ridge2Classifier.fit-413"><span class="linenos">413</span></a>
</span><span id="Ridge2Classifier.fit-414"><a href="#Ridge2Classifier.fit-414"><span class="linenos">414</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="Ridge2Classifier.fit-415"><a href="#Ridge2Classifier.fit-415"><span class="linenos">415</span></a>
</span><span id="Ridge2Classifier.fit-416"><a href="#Ridge2Classifier.fit-416"><span class="linenos">416</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit Ridge model to training data (X, y).</p>

<p>for beta: regression coeffs (beta11, ..., beta1p, ..., betaK1, ..., betaKp)
for K classes and p covariates.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

y: array-like, shape = [n_samples]
    Target values.

**kwargs: additional parameters to be passed to
        self.cook_training_set or self.obj.fit
</code></pre>

<p>Returns:</p>

<pre><code>self: object
</code></pre>
</div>


                                </div>
                                <div id="Ridge2Classifier.predict" class="classattr">
                                            <input id="Ridge2Classifier.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Ridge2Classifier.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Ridge2Classifier.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Ridge2Classifier.predict-418"><a href="#Ridge2Classifier.predict-418"><span class="linenos">418</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2Classifier.predict-419"><a href="#Ridge2Classifier.predict-419"><span class="linenos">419</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="Ridge2Classifier.predict-420"><a href="#Ridge2Classifier.predict-420"><span class="linenos">420</span></a>
</span><span id="Ridge2Classifier.predict-421"><a href="#Ridge2Classifier.predict-421"><span class="linenos">421</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2Classifier.predict-422"><a href="#Ridge2Classifier.predict-422"><span class="linenos">422</span></a>
</span><span id="Ridge2Classifier.predict-423"><a href="#Ridge2Classifier.predict-423"><span class="linenos">423</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2Classifier.predict-424"><a href="#Ridge2Classifier.predict-424"><span class="linenos">424</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2Classifier.predict-425"><a href="#Ridge2Classifier.predict-425"><span class="linenos">425</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2Classifier.predict-426"><a href="#Ridge2Classifier.predict-426"><span class="linenos">426</span></a>
</span><span id="Ridge2Classifier.predict-427"><a href="#Ridge2Classifier.predict-427"><span class="linenos">427</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2Classifier.predict-428"><a href="#Ridge2Classifier.predict-428"><span class="linenos">428</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="Ridge2Classifier.predict-429"><a href="#Ridge2Classifier.predict-429"><span class="linenos">429</span></a>
</span><span id="Ridge2Classifier.predict-430"><a href="#Ridge2Classifier.predict-430"><span class="linenos">430</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2Classifier.predict-431"><a href="#Ridge2Classifier.predict-431"><span class="linenos">431</span></a>
</span><span id="Ridge2Classifier.predict-432"><a href="#Ridge2Classifier.predict-432"><span class="linenos">432</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="Ridge2Classifier.predict-433"><a href="#Ridge2Classifier.predict-433"><span class="linenos">433</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2Classifier.predict-434"><a href="#Ridge2Classifier.predict-434"><span class="linenos">434</span></a>
</span><span id="Ridge2Classifier.predict-435"><a href="#Ridge2Classifier.predict-435"><span class="linenos">435</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>model predictions: {array-like}
</code></pre>
</div>


                                </div>
                                <div id="Ridge2Classifier.predict_proba" class="classattr">
                                            <input id="Ridge2Classifier.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Ridge2Classifier.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Ridge2Classifier.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Ridge2Classifier.predict_proba-437"><a href="#Ridge2Classifier.predict_proba-437"><span class="linenos">437</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2Classifier.predict_proba-438"><a href="#Ridge2Classifier.predict_proba-438"><span class="linenos">438</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probabilities for test data X.</span>
</span><span id="Ridge2Classifier.predict_proba-439"><a href="#Ridge2Classifier.predict_proba-439"><span class="linenos">439</span></a>
</span><span id="Ridge2Classifier.predict_proba-440"><a href="#Ridge2Classifier.predict_proba-440"><span class="linenos">440</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2Classifier.predict_proba-441"><a href="#Ridge2Classifier.predict_proba-441"><span class="linenos">441</span></a>
</span><span id="Ridge2Classifier.predict_proba-442"><a href="#Ridge2Classifier.predict_proba-442"><span class="linenos">442</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2Classifier.predict_proba-443"><a href="#Ridge2Classifier.predict_proba-443"><span class="linenos">443</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2Classifier.predict_proba-444"><a href="#Ridge2Classifier.predict_proba-444"><span class="linenos">444</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2Classifier.predict_proba-445"><a href="#Ridge2Classifier.predict_proba-445"><span class="linenos">445</span></a>
</span><span id="Ridge2Classifier.predict_proba-446"><a href="#Ridge2Classifier.predict_proba-446"><span class="linenos">446</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2Classifier.predict_proba-447"><a href="#Ridge2Classifier.predict_proba-447"><span class="linenos">447</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="Ridge2Classifier.predict_proba-448"><a href="#Ridge2Classifier.predict_proba-448"><span class="linenos">448</span></a>
</span><span id="Ridge2Classifier.predict_proba-449"><a href="#Ridge2Classifier.predict_proba-449"><span class="linenos">449</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2Classifier.predict_proba-450"><a href="#Ridge2Classifier.predict_proba-450"><span class="linenos">450</span></a>
</span><span id="Ridge2Classifier.predict_proba-451"><a href="#Ridge2Classifier.predict_proba-451"><span class="linenos">451</span></a><span class="sd">            probability estimates for test data: {array-like}</span>
</span><span id="Ridge2Classifier.predict_proba-452"><a href="#Ridge2Classifier.predict_proba-452"><span class="linenos">452</span></a>
</span><span id="Ridge2Classifier.predict_proba-453"><a href="#Ridge2Classifier.predict_proba-453"><span class="linenos">453</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2Classifier.predict_proba-454"><a href="#Ridge2Classifier.predict_proba-454"><span class="linenos">454</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Ridge2Classifier.predict_proba-455"><a href="#Ridge2Classifier.predict_proba-455"><span class="linenos">455</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Ridge2Classifier.predict_proba-456"><a href="#Ridge2Classifier.predict_proba-456"><span class="linenos">456</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="Ridge2Classifier.predict_proba-457"><a href="#Ridge2Classifier.predict_proba-457"><span class="linenos">457</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="Ridge2Classifier.predict_proba-458"><a href="#Ridge2Classifier.predict_proba-458"><span class="linenos">458</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="Ridge2Classifier.predict_proba-459"><a href="#Ridge2Classifier.predict_proba-459"><span class="linenos">459</span></a>            <span class="p">)</span>
</span><span id="Ridge2Classifier.predict_proba-460"><a href="#Ridge2Classifier.predict_proba-460"><span class="linenos">460</span></a>
</span><span id="Ridge2Classifier.predict_proba-461"><a href="#Ridge2Classifier.predict_proba-461"><span class="linenos">461</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Ridge2Classifier.predict_proba-462"><a href="#Ridge2Classifier.predict_proba-462"><span class="linenos">462</span></a>
</span><span id="Ridge2Classifier.predict_proba-463"><a href="#Ridge2Classifier.predict_proba-463"><span class="linenos">463</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2Classifier.predict_proba-464"><a href="#Ridge2Classifier.predict_proba-464"><span class="linenos">464</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Ridge2Classifier.predict_proba-465"><a href="#Ridge2Classifier.predict_proba-465"><span class="linenos">465</span></a>
</span><span id="Ridge2Classifier.predict_proba-466"><a href="#Ridge2Classifier.predict_proba-466"><span class="linenos">466</span></a>        <span class="n">ZB</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Ridge2Classifier.predict_proba-467"><a href="#Ridge2Classifier.predict_proba-467"><span class="linenos">467</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span>
</span><span id="Ridge2Classifier.predict_proba-468"><a href="#Ridge2Classifier.predict_proba-468"><span class="linenos">468</span></a>            <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="Ridge2Classifier.predict_proba-469"><a href="#Ridge2Classifier.predict_proba-469"><span class="linenos">469</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">,</span>
</span><span id="Ridge2Classifier.predict_proba-470"><a href="#Ridge2Classifier.predict_proba-470"><span class="linenos">470</span></a>                <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="Ridge2Classifier.predict_proba-471"><a href="#Ridge2Classifier.predict_proba-471"><span class="linenos">471</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="Ridge2Classifier.predict_proba-472"><a href="#Ridge2Classifier.predict_proba-472"><span class="linenos">472</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2Classifier.predict_proba-473"><a href="#Ridge2Classifier.predict_proba-473"><span class="linenos">473</span></a>        <span class="p">)</span>
</span><span id="Ridge2Classifier.predict_proba-474"><a href="#Ridge2Classifier.predict_proba-474"><span class="linenos">474</span></a>
</span><span id="Ridge2Classifier.predict_proba-475"><a href="#Ridge2Classifier.predict_proba-475"><span class="linenos">475</span></a>        <span class="n">exp_ZB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ZB</span><span class="p">)</span>
</span><span id="Ridge2Classifier.predict_proba-476"><a href="#Ridge2Classifier.predict_proba-476"><span class="linenos">476</span></a>
</span><span id="Ridge2Classifier.predict_proba-477"><a href="#Ridge2Classifier.predict_proba-477"><span class="linenos">477</span></a>        <span class="k">return</span> <span class="n">exp_ZB</span> <span class="o">/</span> <span class="n">exp_ZB</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Predict probabilities for test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>probability estimates for test data: {array-like}
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="Ridge2MultitaskClassifier">
                            <input id="Ridge2MultitaskClassifier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Ridge2MultitaskClassifier</span><wbr>(<span class="base">nnetsauce.ridge2.ridge2.Ridge2</span>, <span class="base">sklearn.base.ClassifierMixin</span>):

                <label class="view-source-button" for="Ridge2MultitaskClassifier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Ridge2MultitaskClassifier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Ridge2MultitaskClassifier-21"><a href="#Ridge2MultitaskClassifier-21"><span class="linenos"> 21</span></a><span class="k">class</span> <span class="nc">Ridge2MultitaskClassifier</span><span class="p">(</span><span class="n">Ridge2</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">):</span>
</span><span id="Ridge2MultitaskClassifier-22"><a href="#Ridge2MultitaskClassifier-22"><span class="linenos"> 22</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Multitask Ridge classification with 2 regularization parameters</span>
</span><span id="Ridge2MultitaskClassifier-23"><a href="#Ridge2MultitaskClassifier-23"><span class="linenos"> 23</span></a>
</span><span id="Ridge2MultitaskClassifier-24"><a href="#Ridge2MultitaskClassifier-24"><span class="linenos"> 24</span></a><span class="sd">    Parameters:</span>
</span><span id="Ridge2MultitaskClassifier-25"><a href="#Ridge2MultitaskClassifier-25"><span class="linenos"> 25</span></a>
</span><span id="Ridge2MultitaskClassifier-26"><a href="#Ridge2MultitaskClassifier-26"><span class="linenos"> 26</span></a><span class="sd">        n_hidden_features: int</span>
</span><span id="Ridge2MultitaskClassifier-27"><a href="#Ridge2MultitaskClassifier-27"><span class="linenos"> 27</span></a><span class="sd">            number of nodes in the hidden layer</span>
</span><span id="Ridge2MultitaskClassifier-28"><a href="#Ridge2MultitaskClassifier-28"><span class="linenos"> 28</span></a>
</span><span id="Ridge2MultitaskClassifier-29"><a href="#Ridge2MultitaskClassifier-29"><span class="linenos"> 29</span></a><span class="sd">        activation_name: str</span>
</span><span id="Ridge2MultitaskClassifier-30"><a href="#Ridge2MultitaskClassifier-30"><span class="linenos"> 30</span></a><span class="sd">            activation function: &#39;relu&#39;, &#39;tanh&#39;, &#39;sigmoid&#39;, &#39;prelu&#39; or &#39;elu&#39;</span>
</span><span id="Ridge2MultitaskClassifier-31"><a href="#Ridge2MultitaskClassifier-31"><span class="linenos"> 31</span></a>
</span><span id="Ridge2MultitaskClassifier-32"><a href="#Ridge2MultitaskClassifier-32"><span class="linenos"> 32</span></a><span class="sd">        a: float</span>
</span><span id="Ridge2MultitaskClassifier-33"><a href="#Ridge2MultitaskClassifier-33"><span class="linenos"> 33</span></a><span class="sd">            hyperparameter for &#39;prelu&#39; or &#39;elu&#39; activation function</span>
</span><span id="Ridge2MultitaskClassifier-34"><a href="#Ridge2MultitaskClassifier-34"><span class="linenos"> 34</span></a>
</span><span id="Ridge2MultitaskClassifier-35"><a href="#Ridge2MultitaskClassifier-35"><span class="linenos"> 35</span></a><span class="sd">        nodes_sim: str</span>
</span><span id="Ridge2MultitaskClassifier-36"><a href="#Ridge2MultitaskClassifier-36"><span class="linenos"> 36</span></a><span class="sd">            type of simulation for the nodes: &#39;sobol&#39;, &#39;hammersley&#39;, &#39;halton&#39;,</span>
</span><span id="Ridge2MultitaskClassifier-37"><a href="#Ridge2MultitaskClassifier-37"><span class="linenos"> 37</span></a><span class="sd">            &#39;uniform&#39;</span>
</span><span id="Ridge2MultitaskClassifier-38"><a href="#Ridge2MultitaskClassifier-38"><span class="linenos"> 38</span></a>
</span><span id="Ridge2MultitaskClassifier-39"><a href="#Ridge2MultitaskClassifier-39"><span class="linenos"> 39</span></a><span class="sd">        bias: boolean</span>
</span><span id="Ridge2MultitaskClassifier-40"><a href="#Ridge2MultitaskClassifier-40"><span class="linenos"> 40</span></a><span class="sd">            indicates if the hidden layer contains a bias term (True) or not</span>
</span><span id="Ridge2MultitaskClassifier-41"><a href="#Ridge2MultitaskClassifier-41"><span class="linenos"> 41</span></a><span class="sd">            (False)</span>
</span><span id="Ridge2MultitaskClassifier-42"><a href="#Ridge2MultitaskClassifier-42"><span class="linenos"> 42</span></a>
</span><span id="Ridge2MultitaskClassifier-43"><a href="#Ridge2MultitaskClassifier-43"><span class="linenos"> 43</span></a><span class="sd">        dropout: float</span>
</span><span id="Ridge2MultitaskClassifier-44"><a href="#Ridge2MultitaskClassifier-44"><span class="linenos"> 44</span></a><span class="sd">            regularization parameter; (random) percentage of nodes dropped out</span>
</span><span id="Ridge2MultitaskClassifier-45"><a href="#Ridge2MultitaskClassifier-45"><span class="linenos"> 45</span></a><span class="sd">            of the training</span>
</span><span id="Ridge2MultitaskClassifier-46"><a href="#Ridge2MultitaskClassifier-46"><span class="linenos"> 46</span></a>
</span><span id="Ridge2MultitaskClassifier-47"><a href="#Ridge2MultitaskClassifier-47"><span class="linenos"> 47</span></a><span class="sd">        n_clusters: int</span>
</span><span id="Ridge2MultitaskClassifier-48"><a href="#Ridge2MultitaskClassifier-48"><span class="linenos"> 48</span></a><span class="sd">            number of clusters for &#39;kmeans&#39; or &#39;gmm&#39; clustering (could be 0:</span>
</span><span id="Ridge2MultitaskClassifier-49"><a href="#Ridge2MultitaskClassifier-49"><span class="linenos"> 49</span></a><span class="sd">                no clustering)</span>
</span><span id="Ridge2MultitaskClassifier-50"><a href="#Ridge2MultitaskClassifier-50"><span class="linenos"> 50</span></a>
</span><span id="Ridge2MultitaskClassifier-51"><a href="#Ridge2MultitaskClassifier-51"><span class="linenos"> 51</span></a><span class="sd">        cluster_encode: bool</span>
</span><span id="Ridge2MultitaskClassifier-52"><a href="#Ridge2MultitaskClassifier-52"><span class="linenos"> 52</span></a><span class="sd">            defines how the variable containing clusters is treated (default is one-hot)</span>
</span><span id="Ridge2MultitaskClassifier-53"><a href="#Ridge2MultitaskClassifier-53"><span class="linenos"> 53</span></a><span class="sd">            if `False`, then labels are used, without one-hot encoding</span>
</span><span id="Ridge2MultitaskClassifier-54"><a href="#Ridge2MultitaskClassifier-54"><span class="linenos"> 54</span></a>
</span><span id="Ridge2MultitaskClassifier-55"><a href="#Ridge2MultitaskClassifier-55"><span class="linenos"> 55</span></a><span class="sd">        type_clust: str</span>
</span><span id="Ridge2MultitaskClassifier-56"><a href="#Ridge2MultitaskClassifier-56"><span class="linenos"> 56</span></a><span class="sd">            type of clustering method: currently k-means (&#39;kmeans&#39;) or Gaussian</span>
</span><span id="Ridge2MultitaskClassifier-57"><a href="#Ridge2MultitaskClassifier-57"><span class="linenos"> 57</span></a><span class="sd">            Mixture Model (&#39;gmm&#39;)</span>
</span><span id="Ridge2MultitaskClassifier-58"><a href="#Ridge2MultitaskClassifier-58"><span class="linenos"> 58</span></a>
</span><span id="Ridge2MultitaskClassifier-59"><a href="#Ridge2MultitaskClassifier-59"><span class="linenos"> 59</span></a><span class="sd">        type_scaling: a tuple of 3 strings</span>
</span><span id="Ridge2MultitaskClassifier-60"><a href="#Ridge2MultitaskClassifier-60"><span class="linenos"> 60</span></a><span class="sd">            scaling methods for inputs, hidden layer, and clustering respectively</span>
</span><span id="Ridge2MultitaskClassifier-61"><a href="#Ridge2MultitaskClassifier-61"><span class="linenos"> 61</span></a><span class="sd">            (and when relevant).</span>
</span><span id="Ridge2MultitaskClassifier-62"><a href="#Ridge2MultitaskClassifier-62"><span class="linenos"> 62</span></a><span class="sd">            Currently available: standardization (&#39;std&#39;) or MinMax scaling (&#39;minmax&#39;)</span>
</span><span id="Ridge2MultitaskClassifier-63"><a href="#Ridge2MultitaskClassifier-63"><span class="linenos"> 63</span></a>
</span><span id="Ridge2MultitaskClassifier-64"><a href="#Ridge2MultitaskClassifier-64"><span class="linenos"> 64</span></a><span class="sd">        lambda1: float</span>
</span><span id="Ridge2MultitaskClassifier-65"><a href="#Ridge2MultitaskClassifier-65"><span class="linenos"> 65</span></a><span class="sd">            regularization parameter on direct link</span>
</span><span id="Ridge2MultitaskClassifier-66"><a href="#Ridge2MultitaskClassifier-66"><span class="linenos"> 66</span></a>
</span><span id="Ridge2MultitaskClassifier-67"><a href="#Ridge2MultitaskClassifier-67"><span class="linenos"> 67</span></a><span class="sd">        lambda2: float</span>
</span><span id="Ridge2MultitaskClassifier-68"><a href="#Ridge2MultitaskClassifier-68"><span class="linenos"> 68</span></a><span class="sd">            regularization parameter on hidden layer</span>
</span><span id="Ridge2MultitaskClassifier-69"><a href="#Ridge2MultitaskClassifier-69"><span class="linenos"> 69</span></a>
</span><span id="Ridge2MultitaskClassifier-70"><a href="#Ridge2MultitaskClassifier-70"><span class="linenos"> 70</span></a><span class="sd">        seed: int</span>
</span><span id="Ridge2MultitaskClassifier-71"><a href="#Ridge2MultitaskClassifier-71"><span class="linenos"> 71</span></a><span class="sd">            reproducibility seed for nodes_sim==&#39;uniform&#39;</span>
</span><span id="Ridge2MultitaskClassifier-72"><a href="#Ridge2MultitaskClassifier-72"><span class="linenos"> 72</span></a>
</span><span id="Ridge2MultitaskClassifier-73"><a href="#Ridge2MultitaskClassifier-73"><span class="linenos"> 73</span></a><span class="sd">        backend: str</span>
</span><span id="Ridge2MultitaskClassifier-74"><a href="#Ridge2MultitaskClassifier-74"><span class="linenos"> 74</span></a><span class="sd">            &quot;cpu&quot; or &quot;gpu&quot; or &quot;tpu&quot;</span>
</span><span id="Ridge2MultitaskClassifier-75"><a href="#Ridge2MultitaskClassifier-75"><span class="linenos"> 75</span></a>
</span><span id="Ridge2MultitaskClassifier-76"><a href="#Ridge2MultitaskClassifier-76"><span class="linenos"> 76</span></a><span class="sd">    Attributes:</span>
</span><span id="Ridge2MultitaskClassifier-77"><a href="#Ridge2MultitaskClassifier-77"><span class="linenos"> 77</span></a>
</span><span id="Ridge2MultitaskClassifier-78"><a href="#Ridge2MultitaskClassifier-78"><span class="linenos"> 78</span></a><span class="sd">        beta_: {array-like}</span>
</span><span id="Ridge2MultitaskClassifier-79"><a href="#Ridge2MultitaskClassifier-79"><span class="linenos"> 79</span></a><span class="sd">            regression coefficients</span>
</span><span id="Ridge2MultitaskClassifier-80"><a href="#Ridge2MultitaskClassifier-80"><span class="linenos"> 80</span></a>
</span><span id="Ridge2MultitaskClassifier-81"><a href="#Ridge2MultitaskClassifier-81"><span class="linenos"> 81</span></a><span class="sd">    Examples:</span>
</span><span id="Ridge2MultitaskClassifier-82"><a href="#Ridge2MultitaskClassifier-82"><span class="linenos"> 82</span></a>
</span><span id="Ridge2MultitaskClassifier-83"><a href="#Ridge2MultitaskClassifier-83"><span class="linenos"> 83</span></a><span class="sd">    See also [https://github.com/Techtonique/nnetsauce/blob/master/examples/ridgemtask_classification.py](https://github.com/Techtonique/nnetsauce/blob/master/examples/ridgemtask_classification.py)</span>
</span><span id="Ridge2MultitaskClassifier-84"><a href="#Ridge2MultitaskClassifier-84"><span class="linenos"> 84</span></a>
</span><span id="Ridge2MultitaskClassifier-85"><a href="#Ridge2MultitaskClassifier-85"><span class="linenos"> 85</span></a><span class="sd">    ```python</span>
</span><span id="Ridge2MultitaskClassifier-86"><a href="#Ridge2MultitaskClassifier-86"><span class="linenos"> 86</span></a><span class="sd">    import nnetsauce as ns</span>
</span><span id="Ridge2MultitaskClassifier-87"><a href="#Ridge2MultitaskClassifier-87"><span class="linenos"> 87</span></a><span class="sd">    import numpy as np</span>
</span><span id="Ridge2MultitaskClassifier-88"><a href="#Ridge2MultitaskClassifier-88"><span class="linenos"> 88</span></a><span class="sd">    from sklearn.datasets import load_breast_cancer</span>
</span><span id="Ridge2MultitaskClassifier-89"><a href="#Ridge2MultitaskClassifier-89"><span class="linenos"> 89</span></a><span class="sd">    from sklearn.model_selection import train_test_split</span>
</span><span id="Ridge2MultitaskClassifier-90"><a href="#Ridge2MultitaskClassifier-90"><span class="linenos"> 90</span></a><span class="sd">    from sklearn import metrics</span>
</span><span id="Ridge2MultitaskClassifier-91"><a href="#Ridge2MultitaskClassifier-91"><span class="linenos"> 91</span></a><span class="sd">    from time import time</span>
</span><span id="Ridge2MultitaskClassifier-92"><a href="#Ridge2MultitaskClassifier-92"><span class="linenos"> 92</span></a>
</span><span id="Ridge2MultitaskClassifier-93"><a href="#Ridge2MultitaskClassifier-93"><span class="linenos"> 93</span></a><span class="sd">    breast_cancer = load_breast_cancer()</span>
</span><span id="Ridge2MultitaskClassifier-94"><a href="#Ridge2MultitaskClassifier-94"><span class="linenos"> 94</span></a><span class="sd">    Z = breast_cancer.data</span>
</span><span id="Ridge2MultitaskClassifier-95"><a href="#Ridge2MultitaskClassifier-95"><span class="linenos"> 95</span></a><span class="sd">    t = breast_cancer.target</span>
</span><span id="Ridge2MultitaskClassifier-96"><a href="#Ridge2MultitaskClassifier-96"><span class="linenos"> 96</span></a><span class="sd">    np.random.seed(123)</span>
</span><span id="Ridge2MultitaskClassifier-97"><a href="#Ridge2MultitaskClassifier-97"><span class="linenos"> 97</span></a><span class="sd">    X_train, X_test, y_train, y_test = train_test_split(Z, t, test_size=0.2)</span>
</span><span id="Ridge2MultitaskClassifier-98"><a href="#Ridge2MultitaskClassifier-98"><span class="linenos"> 98</span></a>
</span><span id="Ridge2MultitaskClassifier-99"><a href="#Ridge2MultitaskClassifier-99"><span class="linenos"> 99</span></a><span class="sd">    fit_obj = ns.Ridge2MultitaskClassifier(n_hidden_features=int(9.83730469e+01),</span>
</span><span id="Ridge2MultitaskClassifier-100"><a href="#Ridge2MultitaskClassifier-100"><span class="linenos">100</span></a><span class="sd">                                    dropout=4.31054687e-01,</span>
</span><span id="Ridge2MultitaskClassifier-101"><a href="#Ridge2MultitaskClassifier-101"><span class="linenos">101</span></a><span class="sd">                                    n_clusters=int(1.71484375e+00),</span>
</span><span id="Ridge2MultitaskClassifier-102"><a href="#Ridge2MultitaskClassifier-102"><span class="linenos">102</span></a><span class="sd">                                    lambda1=1.24023438e+01, lambda2=7.30263672e+03)</span>
</span><span id="Ridge2MultitaskClassifier-103"><a href="#Ridge2MultitaskClassifier-103"><span class="linenos">103</span></a>
</span><span id="Ridge2MultitaskClassifier-104"><a href="#Ridge2MultitaskClassifier-104"><span class="linenos">104</span></a><span class="sd">    start = time()</span>
</span><span id="Ridge2MultitaskClassifier-105"><a href="#Ridge2MultitaskClassifier-105"><span class="linenos">105</span></a><span class="sd">    fit_obj.fit(X_train, y_train)</span>
</span><span id="Ridge2MultitaskClassifier-106"><a href="#Ridge2MultitaskClassifier-106"><span class="linenos">106</span></a><span class="sd">    print(f&quot;Elapsed {time() - start}&quot;)</span>
</span><span id="Ridge2MultitaskClassifier-107"><a href="#Ridge2MultitaskClassifier-107"><span class="linenos">107</span></a>
</span><span id="Ridge2MultitaskClassifier-108"><a href="#Ridge2MultitaskClassifier-108"><span class="linenos">108</span></a><span class="sd">    print(fit_obj.score(X_test, y_test))</span>
</span><span id="Ridge2MultitaskClassifier-109"><a href="#Ridge2MultitaskClassifier-109"><span class="linenos">109</span></a><span class="sd">    print(fit_obj.score(X_test, y_test, scoring=&quot;roc_auc&quot;))</span>
</span><span id="Ridge2MultitaskClassifier-110"><a href="#Ridge2MultitaskClassifier-110"><span class="linenos">110</span></a>
</span><span id="Ridge2MultitaskClassifier-111"><a href="#Ridge2MultitaskClassifier-111"><span class="linenos">111</span></a><span class="sd">    start = time()</span>
</span><span id="Ridge2MultitaskClassifier-112"><a href="#Ridge2MultitaskClassifier-112"><span class="linenos">112</span></a><span class="sd">    preds = fit_obj.predict(X_test)</span>
</span><span id="Ridge2MultitaskClassifier-113"><a href="#Ridge2MultitaskClassifier-113"><span class="linenos">113</span></a><span class="sd">    print(f&quot;Elapsed {time() - start}&quot;)</span>
</span><span id="Ridge2MultitaskClassifier-114"><a href="#Ridge2MultitaskClassifier-114"><span class="linenos">114</span></a><span class="sd">    print(metrics.classification_report(preds, y_test))</span>
</span><span id="Ridge2MultitaskClassifier-115"><a href="#Ridge2MultitaskClassifier-115"><span class="linenos">115</span></a><span class="sd">    ```</span>
</span><span id="Ridge2MultitaskClassifier-116"><a href="#Ridge2MultitaskClassifier-116"><span class="linenos">116</span></a>
</span><span id="Ridge2MultitaskClassifier-117"><a href="#Ridge2MultitaskClassifier-117"><span class="linenos">117</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Ridge2MultitaskClassifier-118"><a href="#Ridge2MultitaskClassifier-118"><span class="linenos">118</span></a>
</span><span id="Ridge2MultitaskClassifier-119"><a href="#Ridge2MultitaskClassifier-119"><span class="linenos">119</span></a>    <span class="c1"># construct the object -----</span>
</span><span id="Ridge2MultitaskClassifier-120"><a href="#Ridge2MultitaskClassifier-120"><span class="linenos">120</span></a>
</span><span id="Ridge2MultitaskClassifier-121"><a href="#Ridge2MultitaskClassifier-121"><span class="linenos">121</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="Ridge2MultitaskClassifier-122"><a href="#Ridge2MultitaskClassifier-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-123"><a href="#Ridge2MultitaskClassifier-123"><span class="linenos">123</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-124"><a href="#Ridge2MultitaskClassifier-124"><span class="linenos">124</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-125"><a href="#Ridge2MultitaskClassifier-125"><span class="linenos">125</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-126"><a href="#Ridge2MultitaskClassifier-126"><span class="linenos">126</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-127"><a href="#Ridge2MultitaskClassifier-127"><span class="linenos">127</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-128"><a href="#Ridge2MultitaskClassifier-128"><span class="linenos">128</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-129"><a href="#Ridge2MultitaskClassifier-129"><span class="linenos">129</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-130"><a href="#Ridge2MultitaskClassifier-130"><span class="linenos">130</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-131"><a href="#Ridge2MultitaskClassifier-131"><span class="linenos">131</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-132"><a href="#Ridge2MultitaskClassifier-132"><span class="linenos">132</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="Ridge2MultitaskClassifier-133"><a href="#Ridge2MultitaskClassifier-133"><span class="linenos">133</span></a>        <span class="n">lambda1</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-134"><a href="#Ridge2MultitaskClassifier-134"><span class="linenos">134</span></a>        <span class="n">lambda2</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-135"><a href="#Ridge2MultitaskClassifier-135"><span class="linenos">135</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-136"><a href="#Ridge2MultitaskClassifier-136"><span class="linenos">136</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-137"><a href="#Ridge2MultitaskClassifier-137"><span class="linenos">137</span></a>    <span class="p">):</span>
</span><span id="Ridge2MultitaskClassifier-138"><a href="#Ridge2MultitaskClassifier-138"><span class="linenos">138</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="Ridge2MultitaskClassifier-139"><a href="#Ridge2MultitaskClassifier-139"><span class="linenos">139</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-140"><a href="#Ridge2MultitaskClassifier-140"><span class="linenos">140</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-141"><a href="#Ridge2MultitaskClassifier-141"><span class="linenos">141</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-142"><a href="#Ridge2MultitaskClassifier-142"><span class="linenos">142</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-143"><a href="#Ridge2MultitaskClassifier-143"><span class="linenos">143</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-144"><a href="#Ridge2MultitaskClassifier-144"><span class="linenos">144</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-145"><a href="#Ridge2MultitaskClassifier-145"><span class="linenos">145</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-146"><a href="#Ridge2MultitaskClassifier-146"><span class="linenos">146</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-147"><a href="#Ridge2MultitaskClassifier-147"><span class="linenos">147</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-148"><a href="#Ridge2MultitaskClassifier-148"><span class="linenos">148</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-149"><a href="#Ridge2MultitaskClassifier-149"><span class="linenos">149</span></a>            <span class="n">lambda1</span><span class="o">=</span><span class="n">lambda1</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-150"><a href="#Ridge2MultitaskClassifier-150"><span class="linenos">150</span></a>            <span class="n">lambda2</span><span class="o">=</span><span class="n">lambda2</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-151"><a href="#Ridge2MultitaskClassifier-151"><span class="linenos">151</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-152"><a href="#Ridge2MultitaskClassifier-152"><span class="linenos">152</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-153"><a href="#Ridge2MultitaskClassifier-153"><span class="linenos">153</span></a>        <span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-154"><a href="#Ridge2MultitaskClassifier-154"><span class="linenos">154</span></a>
</span><span id="Ridge2MultitaskClassifier-155"><a href="#Ridge2MultitaskClassifier-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">type_fit</span> <span class="o">=</span> <span class="s2">&quot;regression&quot;</span>
</span><span id="Ridge2MultitaskClassifier-156"><a href="#Ridge2MultitaskClassifier-156"><span class="linenos">156</span></a>
</span><span id="Ridge2MultitaskClassifier-157"><a href="#Ridge2MultitaskClassifier-157"><span class="linenos">157</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2MultitaskClassifier-158"><a href="#Ridge2MultitaskClassifier-158"><span class="linenos">158</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Ridge model to training data (X, y).</span>
</span><span id="Ridge2MultitaskClassifier-159"><a href="#Ridge2MultitaskClassifier-159"><span class="linenos">159</span></a>
</span><span id="Ridge2MultitaskClassifier-160"><a href="#Ridge2MultitaskClassifier-160"><span class="linenos">160</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2MultitaskClassifier-161"><a href="#Ridge2MultitaskClassifier-161"><span class="linenos">161</span></a>
</span><span id="Ridge2MultitaskClassifier-162"><a href="#Ridge2MultitaskClassifier-162"><span class="linenos">162</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2MultitaskClassifier-163"><a href="#Ridge2MultitaskClassifier-163"><span class="linenos">163</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2MultitaskClassifier-164"><a href="#Ridge2MultitaskClassifier-164"><span class="linenos">164</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2MultitaskClassifier-165"><a href="#Ridge2MultitaskClassifier-165"><span class="linenos">165</span></a>
</span><span id="Ridge2MultitaskClassifier-166"><a href="#Ridge2MultitaskClassifier-166"><span class="linenos">166</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="Ridge2MultitaskClassifier-167"><a href="#Ridge2MultitaskClassifier-167"><span class="linenos">167</span></a><span class="sd">                Target values.</span>
</span><span id="Ridge2MultitaskClassifier-168"><a href="#Ridge2MultitaskClassifier-168"><span class="linenos">168</span></a>
</span><span id="Ridge2MultitaskClassifier-169"><a href="#Ridge2MultitaskClassifier-169"><span class="linenos">169</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2MultitaskClassifier-170"><a href="#Ridge2MultitaskClassifier-170"><span class="linenos">170</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="Ridge2MultitaskClassifier-171"><a href="#Ridge2MultitaskClassifier-171"><span class="linenos">171</span></a>
</span><span id="Ridge2MultitaskClassifier-172"><a href="#Ridge2MultitaskClassifier-172"><span class="linenos">172</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2MultitaskClassifier-173"><a href="#Ridge2MultitaskClassifier-173"><span class="linenos">173</span></a>
</span><span id="Ridge2MultitaskClassifier-174"><a href="#Ridge2MultitaskClassifier-174"><span class="linenos">174</span></a><span class="sd">            self: object</span>
</span><span id="Ridge2MultitaskClassifier-175"><a href="#Ridge2MultitaskClassifier-175"><span class="linenos">175</span></a>
</span><span id="Ridge2MultitaskClassifier-176"><a href="#Ridge2MultitaskClassifier-176"><span class="linenos">176</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2MultitaskClassifier-177"><a href="#Ridge2MultitaskClassifier-177"><span class="linenos">177</span></a>
</span><span id="Ridge2MultitaskClassifier-178"><a href="#Ridge2MultitaskClassifier-178"><span class="linenos">178</span></a>        <span class="n">sys_platform</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
</span><span id="Ridge2MultitaskClassifier-179"><a href="#Ridge2MultitaskClassifier-179"><span class="linenos">179</span></a>
</span><span id="Ridge2MultitaskClassifier-180"><a href="#Ridge2MultitaskClassifier-180"><span class="linenos">180</span></a>        <span class="k">assert</span> <span class="n">mx</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s2">&quot;y must contain only integers&quot;</span>
</span><span id="Ridge2MultitaskClassifier-181"><a href="#Ridge2MultitaskClassifier-181"><span class="linenos">181</span></a>
</span><span id="Ridge2MultitaskClassifier-182"><a href="#Ridge2MultitaskClassifier-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="Ridge2MultitaskClassifier-183"><a href="#Ridge2MultitaskClassifier-183"><span class="linenos">183</span></a>
</span><span id="Ridge2MultitaskClassifier-184"><a href="#Ridge2MultitaskClassifier-184"><span class="linenos">184</span></a>        <span class="n">output_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-185"><a href="#Ridge2MultitaskClassifier-185"><span class="linenos">185</span></a>
</span><span id="Ridge2MultitaskClassifier-186"><a href="#Ridge2MultitaskClassifier-186"><span class="linenos">186</span></a>        <span class="n">n_X</span><span class="p">,</span> <span class="n">p_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="Ridge2MultitaskClassifier-187"><a href="#Ridge2MultitaskClassifier-187"><span class="linenos">187</span></a>        <span class="n">n_Z</span><span class="p">,</span> <span class="n">p_Z</span> <span class="o">=</span> <span class="n">scaled_Z</span><span class="o">.</span><span class="n">shape</span>
</span><span id="Ridge2MultitaskClassifier-188"><a href="#Ridge2MultitaskClassifier-188"><span class="linenos">188</span></a>
</span><span id="Ridge2MultitaskClassifier-189"><a href="#Ridge2MultitaskClassifier-189"><span class="linenos">189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="Ridge2MultitaskClassifier-190"><a href="#Ridge2MultitaskClassifier-190"><span class="linenos">190</span></a>
</span><span id="Ridge2MultitaskClassifier-191"><a href="#Ridge2MultitaskClassifier-191"><span class="linenos">191</span></a>        <span class="c1"># multitask response</span>
</span><span id="Ridge2MultitaskClassifier-192"><a href="#Ridge2MultitaskClassifier-192"><span class="linenos">192</span></a>        <span class="n">Y</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">one_hot_encode2</span><span class="p">(</span><span class="n">output_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-193"><a href="#Ridge2MultitaskClassifier-193"><span class="linenos">193</span></a>
</span><span id="Ridge2MultitaskClassifier-194"><a href="#Ridge2MultitaskClassifier-194"><span class="linenos">194</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Ridge2MultitaskClassifier-195"><a href="#Ridge2MultitaskClassifier-195"><span class="linenos">195</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode_clusters</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Ridge2MultitaskClassifier-196"><a href="#Ridge2MultitaskClassifier-196"><span class="linenos">196</span></a>                <span class="n">n_features</span> <span class="o">=</span> <span class="n">p_X</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span>
</span><span id="Ridge2MultitaskClassifier-197"><a href="#Ridge2MultitaskClassifier-197"><span class="linenos">197</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2MultitaskClassifier-198"><a href="#Ridge2MultitaskClassifier-198"><span class="linenos">198</span></a>                <span class="n">n_features</span> <span class="o">=</span> <span class="n">p_X</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Ridge2MultitaskClassifier-199"><a href="#Ridge2MultitaskClassifier-199"><span class="linenos">199</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2MultitaskClassifier-200"><a href="#Ridge2MultitaskClassifier-200"><span class="linenos">200</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">p_X</span>
</span><span id="Ridge2MultitaskClassifier-201"><a href="#Ridge2MultitaskClassifier-201"><span class="linenos">201</span></a>
</span><span id="Ridge2MultitaskClassifier-202"><a href="#Ridge2MultitaskClassifier-202"><span class="linenos">202</span></a>        <span class="n">X_</span> <span class="o">=</span> <span class="n">scaled_Z</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">n_features</span><span class="p">]</span>
</span><span id="Ridge2MultitaskClassifier-203"><a href="#Ridge2MultitaskClassifier-203"><span class="linenos">203</span></a>        <span class="n">Phi_X_</span> <span class="o">=</span> <span class="n">scaled_Z</span><span class="p">[:,</span> <span class="n">n_features</span><span class="p">:</span><span class="n">p_Z</span><span class="p">]</span>
</span><span id="Ridge2MultitaskClassifier-204"><a href="#Ridge2MultitaskClassifier-204"><span class="linenos">204</span></a>
</span><span id="Ridge2MultitaskClassifier-205"><a href="#Ridge2MultitaskClassifier-205"><span class="linenos">205</span></a>        <span class="n">B</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span>
</span><span id="Ridge2MultitaskClassifier-206"><a href="#Ridge2MultitaskClassifier-206"><span class="linenos">206</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">X_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Ridge2MultitaskClassifier-207"><a href="#Ridge2MultitaskClassifier-207"><span class="linenos">207</span></a>        <span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-208"><a href="#Ridge2MultitaskClassifier-208"><span class="linenos">208</span></a>        <span class="n">C</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Phi_X_</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">X_</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-209"><a href="#Ridge2MultitaskClassifier-209"><span class="linenos">209</span></a>        <span class="n">D</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span>
</span><span id="Ridge2MultitaskClassifier-210"><a href="#Ridge2MultitaskClassifier-210"><span class="linenos">210</span></a>            <span class="n">x</span><span class="o">=</span><span class="n">Phi_X_</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span>
</span><span id="Ridge2MultitaskClassifier-211"><a href="#Ridge2MultitaskClassifier-211"><span class="linenos">211</span></a>        <span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Phi_X_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="Ridge2MultitaskClassifier-212"><a href="#Ridge2MultitaskClassifier-212"><span class="linenos">212</span></a>
</span><span id="Ridge2MultitaskClassifier-213"><a href="#Ridge2MultitaskClassifier-213"><span class="linenos">213</span></a>        <span class="k">if</span> <span class="n">sys_platform</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Linux&quot;</span><span class="p">,</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">):</span>
</span><span id="Ridge2MultitaskClassifier-214"><a href="#Ridge2MultitaskClassifier-214"><span class="linenos">214</span></a>            <span class="n">B_inv</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span> <span class="k">else</span> <span class="n">jpinv</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-215"><a href="#Ridge2MultitaskClassifier-215"><span class="linenos">215</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2MultitaskClassifier-216"><a href="#Ridge2MultitaskClassifier-216"><span class="linenos">216</span></a>            <span class="n">B_inv</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-217"><a href="#Ridge2MultitaskClassifier-217"><span class="linenos">217</span></a>
</span><span id="Ridge2MultitaskClassifier-218"><a href="#Ridge2MultitaskClassifier-218"><span class="linenos">218</span></a>        <span class="n">W</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">B_inv</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-219"><a href="#Ridge2MultitaskClassifier-219"><span class="linenos">219</span></a>        <span class="n">S_mat</span> <span class="o">=</span> <span class="n">D</span> <span class="o">-</span> <span class="n">mo</span><span class="o">.</span><span class="n">tcrossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-220"><a href="#Ridge2MultitaskClassifier-220"><span class="linenos">220</span></a>
</span><span id="Ridge2MultitaskClassifier-221"><a href="#Ridge2MultitaskClassifier-221"><span class="linenos">221</span></a>        <span class="k">if</span> <span class="n">sys_platform</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Linux&quot;</span><span class="p">,</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">):</span>
</span><span id="Ridge2MultitaskClassifier-222"><a href="#Ridge2MultitaskClassifier-222"><span class="linenos">222</span></a>            <span class="n">S_inv</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">S_mat</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span> <span class="k">else</span> <span class="n">jpinv</span><span class="p">(</span><span class="n">S_mat</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-223"><a href="#Ridge2MultitaskClassifier-223"><span class="linenos">223</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2MultitaskClassifier-224"><a href="#Ridge2MultitaskClassifier-224"><span class="linenos">224</span></a>            <span class="n">S_inv</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">S_mat</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-225"><a href="#Ridge2MultitaskClassifier-225"><span class="linenos">225</span></a>
</span><span id="Ridge2MultitaskClassifier-226"><a href="#Ridge2MultitaskClassifier-226"><span class="linenos">226</span></a>        <span class="n">Y2</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">S_inv</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-227"><a href="#Ridge2MultitaskClassifier-227"><span class="linenos">227</span></a>        <span class="n">inv</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="Ridge2MultitaskClassifier-228"><a href="#Ridge2MultitaskClassifier-228"><span class="linenos">228</span></a>            <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span>
</span><span id="Ridge2MultitaskClassifier-229"><a href="#Ridge2MultitaskClassifier-229"><span class="linenos">229</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">B_inv</span> <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y2</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="Ridge2MultitaskClassifier-230"><a href="#Ridge2MultitaskClassifier-230"><span class="linenos">230</span></a>                <span class="n">y</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Y2</span><span class="p">),</span>
</span><span id="Ridge2MultitaskClassifier-231"><a href="#Ridge2MultitaskClassifier-231"><span class="linenos">231</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-232"><a href="#Ridge2MultitaskClassifier-232"><span class="linenos">232</span></a>            <span class="p">),</span>
</span><span id="Ridge2MultitaskClassifier-233"><a href="#Ridge2MultitaskClassifier-233"><span class="linenos">233</span></a>            <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="n">Y2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">S_inv</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="Ridge2MultitaskClassifier-234"><a href="#Ridge2MultitaskClassifier-234"><span class="linenos">234</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-235"><a href="#Ridge2MultitaskClassifier-235"><span class="linenos">235</span></a>        <span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-236"><a href="#Ridge2MultitaskClassifier-236"><span class="linenos">236</span></a>
</span><span id="Ridge2MultitaskClassifier-237"><a href="#Ridge2MultitaskClassifier-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Ridge2MultitaskClassifier-238"><a href="#Ridge2MultitaskClassifier-238"><span class="linenos">238</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">inv</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-239"><a href="#Ridge2MultitaskClassifier-239"><span class="linenos">239</span></a>            <span class="n">b</span><span class="o">=</span><span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="Ridge2MultitaskClassifier-240"><a href="#Ridge2MultitaskClassifier-240"><span class="linenos">240</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-241"><a href="#Ridge2MultitaskClassifier-241"><span class="linenos">241</span></a>        <span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-242"><a href="#Ridge2MultitaskClassifier-242"><span class="linenos">242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-243"><a href="#Ridge2MultitaskClassifier-243"><span class="linenos">243</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Ridge2MultitaskClassifier-244"><a href="#Ridge2MultitaskClassifier-244"><span class="linenos">244</span></a>
</span><span id="Ridge2MultitaskClassifier-245"><a href="#Ridge2MultitaskClassifier-245"><span class="linenos">245</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2MultitaskClassifier-246"><a href="#Ridge2MultitaskClassifier-246"><span class="linenos">246</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="Ridge2MultitaskClassifier-247"><a href="#Ridge2MultitaskClassifier-247"><span class="linenos">247</span></a>
</span><span id="Ridge2MultitaskClassifier-248"><a href="#Ridge2MultitaskClassifier-248"><span class="linenos">248</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2MultitaskClassifier-249"><a href="#Ridge2MultitaskClassifier-249"><span class="linenos">249</span></a>
</span><span id="Ridge2MultitaskClassifier-250"><a href="#Ridge2MultitaskClassifier-250"><span class="linenos">250</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2MultitaskClassifier-251"><a href="#Ridge2MultitaskClassifier-251"><span class="linenos">251</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2MultitaskClassifier-252"><a href="#Ridge2MultitaskClassifier-252"><span class="linenos">252</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2MultitaskClassifier-253"><a href="#Ridge2MultitaskClassifier-253"><span class="linenos">253</span></a>
</span><span id="Ridge2MultitaskClassifier-254"><a href="#Ridge2MultitaskClassifier-254"><span class="linenos">254</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2MultitaskClassifier-255"><a href="#Ridge2MultitaskClassifier-255"><span class="linenos">255</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="Ridge2MultitaskClassifier-256"><a href="#Ridge2MultitaskClassifier-256"><span class="linenos">256</span></a>
</span><span id="Ridge2MultitaskClassifier-257"><a href="#Ridge2MultitaskClassifier-257"><span class="linenos">257</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2MultitaskClassifier-258"><a href="#Ridge2MultitaskClassifier-258"><span class="linenos">258</span></a>
</span><span id="Ridge2MultitaskClassifier-259"><a href="#Ridge2MultitaskClassifier-259"><span class="linenos">259</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="Ridge2MultitaskClassifier-260"><a href="#Ridge2MultitaskClassifier-260"><span class="linenos">260</span></a>
</span><span id="Ridge2MultitaskClassifier-261"><a href="#Ridge2MultitaskClassifier-261"><span class="linenos">261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2MultitaskClassifier-262"><a href="#Ridge2MultitaskClassifier-262"><span class="linenos">262</span></a>
</span><span id="Ridge2MultitaskClassifier-263"><a href="#Ridge2MultitaskClassifier-263"><span class="linenos">263</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-264"><a href="#Ridge2MultitaskClassifier-264"><span class="linenos">264</span></a>
</span><span id="Ridge2MultitaskClassifier-265"><a href="#Ridge2MultitaskClassifier-265"><span class="linenos">265</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2MultitaskClassifier-266"><a href="#Ridge2MultitaskClassifier-266"><span class="linenos">266</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probabilities for test data X.</span>
</span><span id="Ridge2MultitaskClassifier-267"><a href="#Ridge2MultitaskClassifier-267"><span class="linenos">267</span></a>
</span><span id="Ridge2MultitaskClassifier-268"><a href="#Ridge2MultitaskClassifier-268"><span class="linenos">268</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2MultitaskClassifier-269"><a href="#Ridge2MultitaskClassifier-269"><span class="linenos">269</span></a>
</span><span id="Ridge2MultitaskClassifier-270"><a href="#Ridge2MultitaskClassifier-270"><span class="linenos">270</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2MultitaskClassifier-271"><a href="#Ridge2MultitaskClassifier-271"><span class="linenos">271</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2MultitaskClassifier-272"><a href="#Ridge2MultitaskClassifier-272"><span class="linenos">272</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2MultitaskClassifier-273"><a href="#Ridge2MultitaskClassifier-273"><span class="linenos">273</span></a>
</span><span id="Ridge2MultitaskClassifier-274"><a href="#Ridge2MultitaskClassifier-274"><span class="linenos">274</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2MultitaskClassifier-275"><a href="#Ridge2MultitaskClassifier-275"><span class="linenos">275</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="Ridge2MultitaskClassifier-276"><a href="#Ridge2MultitaskClassifier-276"><span class="linenos">276</span></a>
</span><span id="Ridge2MultitaskClassifier-277"><a href="#Ridge2MultitaskClassifier-277"><span class="linenos">277</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2MultitaskClassifier-278"><a href="#Ridge2MultitaskClassifier-278"><span class="linenos">278</span></a>
</span><span id="Ridge2MultitaskClassifier-279"><a href="#Ridge2MultitaskClassifier-279"><span class="linenos">279</span></a><span class="sd">            probability estimates for test data: {array-like}</span>
</span><span id="Ridge2MultitaskClassifier-280"><a href="#Ridge2MultitaskClassifier-280"><span class="linenos">280</span></a>
</span><span id="Ridge2MultitaskClassifier-281"><a href="#Ridge2MultitaskClassifier-281"><span class="linenos">281</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2MultitaskClassifier-282"><a href="#Ridge2MultitaskClassifier-282"><span class="linenos">282</span></a>
</span><span id="Ridge2MultitaskClassifier-283"><a href="#Ridge2MultitaskClassifier-283"><span class="linenos">283</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Ridge2MultitaskClassifier-284"><a href="#Ridge2MultitaskClassifier-284"><span class="linenos">284</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Ridge2MultitaskClassifier-285"><a href="#Ridge2MultitaskClassifier-285"><span class="linenos">285</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="Ridge2MultitaskClassifier-286"><a href="#Ridge2MultitaskClassifier-286"><span class="linenos">286</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="Ridge2MultitaskClassifier-287"><a href="#Ridge2MultitaskClassifier-287"><span class="linenos">287</span></a>                <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="Ridge2MultitaskClassifier-288"><a href="#Ridge2MultitaskClassifier-288"><span class="linenos">288</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier-289"><a href="#Ridge2MultitaskClassifier-289"><span class="linenos">289</span></a>            <span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-290"><a href="#Ridge2MultitaskClassifier-290"><span class="linenos">290</span></a>
</span><span id="Ridge2MultitaskClassifier-291"><a href="#Ridge2MultitaskClassifier-291"><span class="linenos">291</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-292"><a href="#Ridge2MultitaskClassifier-292"><span class="linenos">292</span></a>
</span><span id="Ridge2MultitaskClassifier-293"><a href="#Ridge2MultitaskClassifier-293"><span class="linenos">293</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2MultitaskClassifier-294"><a href="#Ridge2MultitaskClassifier-294"><span class="linenos">294</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-295"><a href="#Ridge2MultitaskClassifier-295"><span class="linenos">295</span></a>
</span><span id="Ridge2MultitaskClassifier-296"><a href="#Ridge2MultitaskClassifier-296"><span class="linenos">296</span></a>        <span class="n">ZB</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-297"><a href="#Ridge2MultitaskClassifier-297"><span class="linenos">297</span></a>
</span><span id="Ridge2MultitaskClassifier-298"><a href="#Ridge2MultitaskClassifier-298"><span class="linenos">298</span></a>        <span class="n">exp_ZB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ZB</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier-299"><a href="#Ridge2MultitaskClassifier-299"><span class="linenos">299</span></a>
</span><span id="Ridge2MultitaskClassifier-300"><a href="#Ridge2MultitaskClassifier-300"><span class="linenos">300</span></a>        <span class="k">return</span> <span class="n">exp_ZB</span> <span class="o">/</span> <span class="n">exp_ZB</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Multitask Ridge classification with 2 regularization parameters</p>

<p>Parameters:</p>

<pre><code>n_hidden_features: int
    number of nodes in the hidden layer

activation_name: str
    activation function: 'relu', 'tanh', 'sigmoid', 'prelu' or 'elu'

a: float
    hyperparameter for 'prelu' or 'elu' activation function

nodes_sim: str
    type of simulation for the nodes: 'sobol', 'hammersley', 'halton',
    'uniform'

bias: boolean
    indicates if the hidden layer contains a bias term (True) or not
    (False)

dropout: float
    regularization parameter; (random) percentage of nodes dropped out
    of the training

n_clusters: int
    number of clusters for 'kmeans' or 'gmm' clustering (could be 0:
        no clustering)

cluster_encode: bool
    defines how the variable containing clusters is treated (default is one-hot)
    if `False`, then labels are used, without one-hot encoding

type_clust: str
    type of clustering method: currently k-means ('kmeans') or Gaussian
    Mixture Model ('gmm')

type_scaling: a tuple of 3 strings
    scaling methods for inputs, hidden layer, and clustering respectively
    (and when relevant).
    Currently available: standardization ('std') or MinMax scaling ('minmax')

lambda1: float
    regularization parameter on direct link

lambda2: float
    regularization parameter on hidden layer

seed: int
    reproducibility seed for nodes_sim=='uniform'

backend: str
    "cpu" or "gpu" or "tpu"
</code></pre>

<p>Attributes:</p>

<pre><code>beta_: {array-like}
    regression coefficients
</code></pre>

<p>Examples:</p>

<p>See also <a href="https://github.com/Techtonique/nnetsauce/blob/master/examples/ridgemtask_classification.py">https://github.com/Techtonique/nnetsauce/blob/master/examples/ridgemtask_classification.py</a></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>

<span class="n">breast_cancer</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">breast_cancer</span><span class="o">.</span><span class="n">data</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">breast_cancer</span><span class="o">.</span><span class="n">target</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">fit_obj</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">Ridge2MultitaskClassifier</span><span class="p">(</span><span class="n">n_hidden_features</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">9.83730469e+01</span><span class="p">),</span>
                                <span class="n">dropout</span><span class="o">=</span><span class="mf">4.31054687e-01</span><span class="p">,</span>
                                <span class="n">n_clusters</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">1.71484375e+00</span><span class="p">),</span>
                                <span class="n">lambda1</span><span class="o">=</span><span class="mf">1.24023438e+01</span><span class="p">,</span> <span class="n">lambda2</span><span class="o">=</span><span class="mf">7.30263672e+03</span><span class="p">)</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">fit_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Elapsed </span><span class="si">{</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fit_obj</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fit_obj</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;roc_auc&quot;</span><span class="p">))</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">fit_obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Elapsed </span><span class="si">{</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</code></pre>
</div>
</div>


                                <div id="Ridge2MultitaskClassifier.fit" class="classattr">
                                            <input id="Ridge2MultitaskClassifier.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Ridge2MultitaskClassifier.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Ridge2MultitaskClassifier.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Ridge2MultitaskClassifier.fit-157"><a href="#Ridge2MultitaskClassifier.fit-157"><span class="linenos">157</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2MultitaskClassifier.fit-158"><a href="#Ridge2MultitaskClassifier.fit-158"><span class="linenos">158</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Ridge model to training data (X, y).</span>
</span><span id="Ridge2MultitaskClassifier.fit-159"><a href="#Ridge2MultitaskClassifier.fit-159"><span class="linenos">159</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-160"><a href="#Ridge2MultitaskClassifier.fit-160"><span class="linenos">160</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2MultitaskClassifier.fit-161"><a href="#Ridge2MultitaskClassifier.fit-161"><span class="linenos">161</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-162"><a href="#Ridge2MultitaskClassifier.fit-162"><span class="linenos">162</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2MultitaskClassifier.fit-163"><a href="#Ridge2MultitaskClassifier.fit-163"><span class="linenos">163</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2MultitaskClassifier.fit-164"><a href="#Ridge2MultitaskClassifier.fit-164"><span class="linenos">164</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2MultitaskClassifier.fit-165"><a href="#Ridge2MultitaskClassifier.fit-165"><span class="linenos">165</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-166"><a href="#Ridge2MultitaskClassifier.fit-166"><span class="linenos">166</span></a><span class="sd">            y: array-like, shape = [n_samples]</span>
</span><span id="Ridge2MultitaskClassifier.fit-167"><a href="#Ridge2MultitaskClassifier.fit-167"><span class="linenos">167</span></a><span class="sd">                Target values.</span>
</span><span id="Ridge2MultitaskClassifier.fit-168"><a href="#Ridge2MultitaskClassifier.fit-168"><span class="linenos">168</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-169"><a href="#Ridge2MultitaskClassifier.fit-169"><span class="linenos">169</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2MultitaskClassifier.fit-170"><a href="#Ridge2MultitaskClassifier.fit-170"><span class="linenos">170</span></a><span class="sd">                    self.cook_training_set or self.obj.fit</span>
</span><span id="Ridge2MultitaskClassifier.fit-171"><a href="#Ridge2MultitaskClassifier.fit-171"><span class="linenos">171</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-172"><a href="#Ridge2MultitaskClassifier.fit-172"><span class="linenos">172</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2MultitaskClassifier.fit-173"><a href="#Ridge2MultitaskClassifier.fit-173"><span class="linenos">173</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-174"><a href="#Ridge2MultitaskClassifier.fit-174"><span class="linenos">174</span></a><span class="sd">            self: object</span>
</span><span id="Ridge2MultitaskClassifier.fit-175"><a href="#Ridge2MultitaskClassifier.fit-175"><span class="linenos">175</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-176"><a href="#Ridge2MultitaskClassifier.fit-176"><span class="linenos">176</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2MultitaskClassifier.fit-177"><a href="#Ridge2MultitaskClassifier.fit-177"><span class="linenos">177</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-178"><a href="#Ridge2MultitaskClassifier.fit-178"><span class="linenos">178</span></a>        <span class="n">sys_platform</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
</span><span id="Ridge2MultitaskClassifier.fit-179"><a href="#Ridge2MultitaskClassifier.fit-179"><span class="linenos">179</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-180"><a href="#Ridge2MultitaskClassifier.fit-180"><span class="linenos">180</span></a>        <span class="k">assert</span> <span class="n">mx</span><span class="o">.</span><span class="n">is_factor</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s2">&quot;y must contain only integers&quot;</span>
</span><span id="Ridge2MultitaskClassifier.fit-181"><a href="#Ridge2MultitaskClassifier.fit-181"><span class="linenos">181</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-182"><a href="#Ridge2MultitaskClassifier.fit-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>  <span class="c1"># for compatibility with sklearn</span>
</span><span id="Ridge2MultitaskClassifier.fit-183"><a href="#Ridge2MultitaskClassifier.fit-183"><span class="linenos">183</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-184"><a href="#Ridge2MultitaskClassifier.fit-184"><span class="linenos">184</span></a>        <span class="n">output_y</span><span class="p">,</span> <span class="n">scaled_Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_training_set</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.fit-185"><a href="#Ridge2MultitaskClassifier.fit-185"><span class="linenos">185</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-186"><a href="#Ridge2MultitaskClassifier.fit-186"><span class="linenos">186</span></a>        <span class="n">n_X</span><span class="p">,</span> <span class="n">p_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="Ridge2MultitaskClassifier.fit-187"><a href="#Ridge2MultitaskClassifier.fit-187"><span class="linenos">187</span></a>        <span class="n">n_Z</span><span class="p">,</span> <span class="n">p_Z</span> <span class="o">=</span> <span class="n">scaled_Z</span><span class="o">.</span><span class="n">shape</span>
</span><span id="Ridge2MultitaskClassifier.fit-188"><a href="#Ridge2MultitaskClassifier.fit-188"><span class="linenos">188</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-189"><a href="#Ridge2MultitaskClassifier.fit-189"><span class="linenos">189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span><span id="Ridge2MultitaskClassifier.fit-190"><a href="#Ridge2MultitaskClassifier.fit-190"><span class="linenos">190</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-191"><a href="#Ridge2MultitaskClassifier.fit-191"><span class="linenos">191</span></a>        <span class="c1"># multitask response</span>
</span><span id="Ridge2MultitaskClassifier.fit-192"><a href="#Ridge2MultitaskClassifier.fit-192"><span class="linenos">192</span></a>        <span class="n">Y</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">one_hot_encode2</span><span class="p">(</span><span class="n">output_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_classes</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.fit-193"><a href="#Ridge2MultitaskClassifier.fit-193"><span class="linenos">193</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-194"><a href="#Ridge2MultitaskClassifier.fit-194"><span class="linenos">194</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Ridge2MultitaskClassifier.fit-195"><a href="#Ridge2MultitaskClassifier.fit-195"><span class="linenos">195</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode_clusters</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Ridge2MultitaskClassifier.fit-196"><a href="#Ridge2MultitaskClassifier.fit-196"><span class="linenos">196</span></a>                <span class="n">n_features</span> <span class="o">=</span> <span class="n">p_X</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span>
</span><span id="Ridge2MultitaskClassifier.fit-197"><a href="#Ridge2MultitaskClassifier.fit-197"><span class="linenos">197</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2MultitaskClassifier.fit-198"><a href="#Ridge2MultitaskClassifier.fit-198"><span class="linenos">198</span></a>                <span class="n">n_features</span> <span class="o">=</span> <span class="n">p_X</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Ridge2MultitaskClassifier.fit-199"><a href="#Ridge2MultitaskClassifier.fit-199"><span class="linenos">199</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2MultitaskClassifier.fit-200"><a href="#Ridge2MultitaskClassifier.fit-200"><span class="linenos">200</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">p_X</span>
</span><span id="Ridge2MultitaskClassifier.fit-201"><a href="#Ridge2MultitaskClassifier.fit-201"><span class="linenos">201</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-202"><a href="#Ridge2MultitaskClassifier.fit-202"><span class="linenos">202</span></a>        <span class="n">X_</span> <span class="o">=</span> <span class="n">scaled_Z</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">n_features</span><span class="p">]</span>
</span><span id="Ridge2MultitaskClassifier.fit-203"><a href="#Ridge2MultitaskClassifier.fit-203"><span class="linenos">203</span></a>        <span class="n">Phi_X_</span> <span class="o">=</span> <span class="n">scaled_Z</span><span class="p">[:,</span> <span class="n">n_features</span><span class="p">:</span><span class="n">p_Z</span><span class="p">]</span>
</span><span id="Ridge2MultitaskClassifier.fit-204"><a href="#Ridge2MultitaskClassifier.fit-204"><span class="linenos">204</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-205"><a href="#Ridge2MultitaskClassifier.fit-205"><span class="linenos">205</span></a>        <span class="n">B</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span>
</span><span id="Ridge2MultitaskClassifier.fit-206"><a href="#Ridge2MultitaskClassifier.fit-206"><span class="linenos">206</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">X_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Ridge2MultitaskClassifier.fit-207"><a href="#Ridge2MultitaskClassifier.fit-207"><span class="linenos">207</span></a>        <span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.fit-208"><a href="#Ridge2MultitaskClassifier.fit-208"><span class="linenos">208</span></a>        <span class="n">C</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Phi_X_</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">X_</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.fit-209"><a href="#Ridge2MultitaskClassifier.fit-209"><span class="linenos">209</span></a>        <span class="n">D</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span>
</span><span id="Ridge2MultitaskClassifier.fit-210"><a href="#Ridge2MultitaskClassifier.fit-210"><span class="linenos">210</span></a>            <span class="n">x</span><span class="o">=</span><span class="n">Phi_X_</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span>
</span><span id="Ridge2MultitaskClassifier.fit-211"><a href="#Ridge2MultitaskClassifier.fit-211"><span class="linenos">211</span></a>        <span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">lambda2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Phi_X_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="Ridge2MultitaskClassifier.fit-212"><a href="#Ridge2MultitaskClassifier.fit-212"><span class="linenos">212</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-213"><a href="#Ridge2MultitaskClassifier.fit-213"><span class="linenos">213</span></a>        <span class="k">if</span> <span class="n">sys_platform</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Linux&quot;</span><span class="p">,</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">):</span>
</span><span id="Ridge2MultitaskClassifier.fit-214"><a href="#Ridge2MultitaskClassifier.fit-214"><span class="linenos">214</span></a>            <span class="n">B_inv</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span> <span class="k">else</span> <span class="n">jpinv</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.fit-215"><a href="#Ridge2MultitaskClassifier.fit-215"><span class="linenos">215</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2MultitaskClassifier.fit-216"><a href="#Ridge2MultitaskClassifier.fit-216"><span class="linenos">216</span></a>            <span class="n">B_inv</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.fit-217"><a href="#Ridge2MultitaskClassifier.fit-217"><span class="linenos">217</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-218"><a href="#Ridge2MultitaskClassifier.fit-218"><span class="linenos">218</span></a>        <span class="n">W</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">B_inv</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.fit-219"><a href="#Ridge2MultitaskClassifier.fit-219"><span class="linenos">219</span></a>        <span class="n">S_mat</span> <span class="o">=</span> <span class="n">D</span> <span class="o">-</span> <span class="n">mo</span><span class="o">.</span><span class="n">tcrossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.fit-220"><a href="#Ridge2MultitaskClassifier.fit-220"><span class="linenos">220</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-221"><a href="#Ridge2MultitaskClassifier.fit-221"><span class="linenos">221</span></a>        <span class="k">if</span> <span class="n">sys_platform</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Linux&quot;</span><span class="p">,</span> <span class="s2">&quot;Darwin&quot;</span><span class="p">):</span>
</span><span id="Ridge2MultitaskClassifier.fit-222"><a href="#Ridge2MultitaskClassifier.fit-222"><span class="linenos">222</span></a>            <span class="n">S_inv</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">S_mat</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cpu&quot;</span> <span class="k">else</span> <span class="n">jpinv</span><span class="p">(</span><span class="n">S_mat</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.fit-223"><a href="#Ridge2MultitaskClassifier.fit-223"><span class="linenos">223</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2MultitaskClassifier.fit-224"><a href="#Ridge2MultitaskClassifier.fit-224"><span class="linenos">224</span></a>            <span class="n">S_inv</span> <span class="o">=</span> <span class="n">pinv</span><span class="p">(</span><span class="n">S_mat</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.fit-225"><a href="#Ridge2MultitaskClassifier.fit-225"><span class="linenos">225</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-226"><a href="#Ridge2MultitaskClassifier.fit-226"><span class="linenos">226</span></a>        <span class="n">Y2</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">S_inv</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.fit-227"><a href="#Ridge2MultitaskClassifier.fit-227"><span class="linenos">227</span></a>        <span class="n">inv</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="Ridge2MultitaskClassifier.fit-228"><a href="#Ridge2MultitaskClassifier.fit-228"><span class="linenos">228</span></a>            <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span>
</span><span id="Ridge2MultitaskClassifier.fit-229"><a href="#Ridge2MultitaskClassifier.fit-229"><span class="linenos">229</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">B_inv</span> <span class="o">+</span> <span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y2</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="Ridge2MultitaskClassifier.fit-230"><a href="#Ridge2MultitaskClassifier.fit-230"><span class="linenos">230</span></a>                <span class="n">y</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">Y2</span><span class="p">),</span>
</span><span id="Ridge2MultitaskClassifier.fit-231"><a href="#Ridge2MultitaskClassifier.fit-231"><span class="linenos">231</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier.fit-232"><a href="#Ridge2MultitaskClassifier.fit-232"><span class="linenos">232</span></a>            <span class="p">),</span>
</span><span id="Ridge2MultitaskClassifier.fit-233"><a href="#Ridge2MultitaskClassifier.fit-233"><span class="linenos">233</span></a>            <span class="n">mo</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="n">Y2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">S_inv</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="Ridge2MultitaskClassifier.fit-234"><a href="#Ridge2MultitaskClassifier.fit-234"><span class="linenos">234</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier.fit-235"><a href="#Ridge2MultitaskClassifier.fit-235"><span class="linenos">235</span></a>        <span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.fit-236"><a href="#Ridge2MultitaskClassifier.fit-236"><span class="linenos">236</span></a>
</span><span id="Ridge2MultitaskClassifier.fit-237"><a href="#Ridge2MultitaskClassifier.fit-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span>
</span><span id="Ridge2MultitaskClassifier.fit-238"><a href="#Ridge2MultitaskClassifier.fit-238"><span class="linenos">238</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">inv</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier.fit-239"><a href="#Ridge2MultitaskClassifier.fit-239"><span class="linenos">239</span></a>            <span class="n">b</span><span class="o">=</span><span class="n">mo</span><span class="o">.</span><span class="n">crossprod</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">scaled_Z</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">),</span>
</span><span id="Ridge2MultitaskClassifier.fit-240"><a href="#Ridge2MultitaskClassifier.fit-240"><span class="linenos">240</span></a>            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier.fit-241"><a href="#Ridge2MultitaskClassifier.fit-241"><span class="linenos">241</span></a>        <span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.fit-242"><a href="#Ridge2MultitaskClassifier.fit-242"><span class="linenos">242</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.fit-243"><a href="#Ridge2MultitaskClassifier.fit-243"><span class="linenos">243</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit Ridge model to training data (X, y).</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

y: array-like, shape = [n_samples]
    Target values.

**kwargs: additional parameters to be passed to
        self.cook_training_set or self.obj.fit
</code></pre>

<p>Returns:</p>

<pre><code>self: object
</code></pre>
</div>


                                </div>
                                <div id="Ridge2MultitaskClassifier.predict" class="classattr">
                                            <input id="Ridge2MultitaskClassifier.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Ridge2MultitaskClassifier.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Ridge2MultitaskClassifier.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Ridge2MultitaskClassifier.predict-245"><a href="#Ridge2MultitaskClassifier.predict-245"><span class="linenos">245</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2MultitaskClassifier.predict-246"><a href="#Ridge2MultitaskClassifier.predict-246"><span class="linenos">246</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict test data X.</span>
</span><span id="Ridge2MultitaskClassifier.predict-247"><a href="#Ridge2MultitaskClassifier.predict-247"><span class="linenos">247</span></a>
</span><span id="Ridge2MultitaskClassifier.predict-248"><a href="#Ridge2MultitaskClassifier.predict-248"><span class="linenos">248</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2MultitaskClassifier.predict-249"><a href="#Ridge2MultitaskClassifier.predict-249"><span class="linenos">249</span></a>
</span><span id="Ridge2MultitaskClassifier.predict-250"><a href="#Ridge2MultitaskClassifier.predict-250"><span class="linenos">250</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2MultitaskClassifier.predict-251"><a href="#Ridge2MultitaskClassifier.predict-251"><span class="linenos">251</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2MultitaskClassifier.predict-252"><a href="#Ridge2MultitaskClassifier.predict-252"><span class="linenos">252</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2MultitaskClassifier.predict-253"><a href="#Ridge2MultitaskClassifier.predict-253"><span class="linenos">253</span></a>
</span><span id="Ridge2MultitaskClassifier.predict-254"><a href="#Ridge2MultitaskClassifier.predict-254"><span class="linenos">254</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2MultitaskClassifier.predict-255"><a href="#Ridge2MultitaskClassifier.predict-255"><span class="linenos">255</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="Ridge2MultitaskClassifier.predict-256"><a href="#Ridge2MultitaskClassifier.predict-256"><span class="linenos">256</span></a>
</span><span id="Ridge2MultitaskClassifier.predict-257"><a href="#Ridge2MultitaskClassifier.predict-257"><span class="linenos">257</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2MultitaskClassifier.predict-258"><a href="#Ridge2MultitaskClassifier.predict-258"><span class="linenos">258</span></a>
</span><span id="Ridge2MultitaskClassifier.predict-259"><a href="#Ridge2MultitaskClassifier.predict-259"><span class="linenos">259</span></a><span class="sd">            model predictions: {array-like}</span>
</span><span id="Ridge2MultitaskClassifier.predict-260"><a href="#Ridge2MultitaskClassifier.predict-260"><span class="linenos">260</span></a>
</span><span id="Ridge2MultitaskClassifier.predict-261"><a href="#Ridge2MultitaskClassifier.predict-261"><span class="linenos">261</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2MultitaskClassifier.predict-262"><a href="#Ridge2MultitaskClassifier.predict-262"><span class="linenos">262</span></a>
</span><span id="Ridge2MultitaskClassifier.predict-263"><a href="#Ridge2MultitaskClassifier.predict-263"><span class="linenos">263</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>model predictions: {array-like}
</code></pre>
</div>


                                </div>
                                <div id="Ridge2MultitaskClassifier.predict_proba" class="classattr">
                                            <input id="Ridge2MultitaskClassifier.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Ridge2MultitaskClassifier.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Ridge2MultitaskClassifier.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Ridge2MultitaskClassifier.predict_proba-265"><a href="#Ridge2MultitaskClassifier.predict_proba-265"><span class="linenos">265</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-266"><a href="#Ridge2MultitaskClassifier.predict_proba-266"><span class="linenos">266</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict probabilities for test data X.</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-267"><a href="#Ridge2MultitaskClassifier.predict_proba-267"><span class="linenos">267</span></a>
</span><span id="Ridge2MultitaskClassifier.predict_proba-268"><a href="#Ridge2MultitaskClassifier.predict_proba-268"><span class="linenos">268</span></a><span class="sd">        Args:</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-269"><a href="#Ridge2MultitaskClassifier.predict_proba-269"><span class="linenos">269</span></a>
</span><span id="Ridge2MultitaskClassifier.predict_proba-270"><a href="#Ridge2MultitaskClassifier.predict_proba-270"><span class="linenos">270</span></a><span class="sd">            X: {array-like}, shape = [n_samples, n_features]</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-271"><a href="#Ridge2MultitaskClassifier.predict_proba-271"><span class="linenos">271</span></a><span class="sd">                Training vectors, where n_samples is the number</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-272"><a href="#Ridge2MultitaskClassifier.predict_proba-272"><span class="linenos">272</span></a><span class="sd">                of samples and n_features is the number of features.</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-273"><a href="#Ridge2MultitaskClassifier.predict_proba-273"><span class="linenos">273</span></a>
</span><span id="Ridge2MultitaskClassifier.predict_proba-274"><a href="#Ridge2MultitaskClassifier.predict_proba-274"><span class="linenos">274</span></a><span class="sd">            **kwargs: additional parameters to be passed to</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-275"><a href="#Ridge2MultitaskClassifier.predict_proba-275"><span class="linenos">275</span></a><span class="sd">                    self.cook_test_set</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-276"><a href="#Ridge2MultitaskClassifier.predict_proba-276"><span class="linenos">276</span></a>
</span><span id="Ridge2MultitaskClassifier.predict_proba-277"><a href="#Ridge2MultitaskClassifier.predict_proba-277"><span class="linenos">277</span></a><span class="sd">        Returns:</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-278"><a href="#Ridge2MultitaskClassifier.predict_proba-278"><span class="linenos">278</span></a>
</span><span id="Ridge2MultitaskClassifier.predict_proba-279"><a href="#Ridge2MultitaskClassifier.predict_proba-279"><span class="linenos">279</span></a><span class="sd">            probability estimates for test data: {array-like}</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-280"><a href="#Ridge2MultitaskClassifier.predict_proba-280"><span class="linenos">280</span></a>
</span><span id="Ridge2MultitaskClassifier.predict_proba-281"><a href="#Ridge2MultitaskClassifier.predict_proba-281"><span class="linenos">281</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-282"><a href="#Ridge2MultitaskClassifier.predict_proba-282"><span class="linenos">282</span></a>
</span><span id="Ridge2MultitaskClassifier.predict_proba-283"><a href="#Ridge2MultitaskClassifier.predict_proba-283"><span class="linenos">283</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-284"><a href="#Ridge2MultitaskClassifier.predict_proba-284"><span class="linenos">284</span></a>            <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-285"><a href="#Ridge2MultitaskClassifier.predict_proba-285"><span class="linenos">285</span></a>            <span class="n">new_X</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-286"><a href="#Ridge2MultitaskClassifier.predict_proba-286"><span class="linenos">286</span></a>                <span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-287"><a href="#Ridge2MultitaskClassifier.predict_proba-287"><span class="linenos">287</span></a>                <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">),</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-288"><a href="#Ridge2MultitaskClassifier.predict_proba-288"><span class="linenos">288</span></a>                <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-289"><a href="#Ridge2MultitaskClassifier.predict_proba-289"><span class="linenos">289</span></a>            <span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-290"><a href="#Ridge2MultitaskClassifier.predict_proba-290"><span class="linenos">290</span></a>
</span><span id="Ridge2MultitaskClassifier.predict_proba-291"><a href="#Ridge2MultitaskClassifier.predict_proba-291"><span class="linenos">291</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">new_X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-292"><a href="#Ridge2MultitaskClassifier.predict_proba-292"><span class="linenos">292</span></a>
</span><span id="Ridge2MultitaskClassifier.predict_proba-293"><a href="#Ridge2MultitaskClassifier.predict_proba-293"><span class="linenos">293</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-294"><a href="#Ridge2MultitaskClassifier.predict_proba-294"><span class="linenos">294</span></a>            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cook_test_set</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-295"><a href="#Ridge2MultitaskClassifier.predict_proba-295"><span class="linenos">295</span></a>
</span><span id="Ridge2MultitaskClassifier.predict_proba-296"><a href="#Ridge2MultitaskClassifier.predict_proba-296"><span class="linenos">296</span></a>        <span class="n">ZB</span> <span class="o">=</span> <span class="n">mo</span><span class="o">.</span><span class="n">safe_sparse_dot</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">Z</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-297"><a href="#Ridge2MultitaskClassifier.predict_proba-297"><span class="linenos">297</span></a>
</span><span id="Ridge2MultitaskClassifier.predict_proba-298"><a href="#Ridge2MultitaskClassifier.predict_proba-298"><span class="linenos">298</span></a>        <span class="n">exp_ZB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ZB</span><span class="p">)</span>
</span><span id="Ridge2MultitaskClassifier.predict_proba-299"><a href="#Ridge2MultitaskClassifier.predict_proba-299"><span class="linenos">299</span></a>
</span><span id="Ridge2MultitaskClassifier.predict_proba-300"><a href="#Ridge2MultitaskClassifier.predict_proba-300"><span class="linenos">300</span></a>        <span class="k">return</span> <span class="n">exp_ZB</span> <span class="o">/</span> <span class="n">exp_ZB</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Predict probabilities for test data X.</p>

<p>Args:</p>

<pre><code>X: {array-like}, shape = [n_samples, n_features]
    Training vectors, where n_samples is the number
    of samples and n_features is the number of features.

**kwargs: additional parameters to be passed to
        self.cook_test_set
</code></pre>

<p>Returns:</p>

<pre><code>probability estimates for test data: {array-like}
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="SubSampler">
                            <input id="SubSampler-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">SubSampler</span>:

                <label class="view-source-button" for="SubSampler-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SubSampler"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SubSampler-6"><a href="#SubSampler-6"><span class="linenos"> 6</span></a><span class="k">class</span> <span class="nc">SubSampler</span><span class="p">:</span>
</span><span id="SubSampler-7"><a href="#SubSampler-7"><span class="linenos"> 7</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Subsampling class.</span>
</span><span id="SubSampler-8"><a href="#SubSampler-8"><span class="linenos"> 8</span></a>
</span><span id="SubSampler-9"><a href="#SubSampler-9"><span class="linenos"> 9</span></a><span class="sd">    Attributes:</span>
</span><span id="SubSampler-10"><a href="#SubSampler-10"><span class="linenos">10</span></a>
</span><span id="SubSampler-11"><a href="#SubSampler-11"><span class="linenos">11</span></a><span class="sd">       y: array-like, shape = [n_samples]</span>
</span><span id="SubSampler-12"><a href="#SubSampler-12"><span class="linenos">12</span></a><span class="sd">           Target values.</span>
</span><span id="SubSampler-13"><a href="#SubSampler-13"><span class="linenos">13</span></a>
</span><span id="SubSampler-14"><a href="#SubSampler-14"><span class="linenos">14</span></a><span class="sd">       row_sample: double</span>
</span><span id="SubSampler-15"><a href="#SubSampler-15"><span class="linenos">15</span></a><span class="sd">           subsampling fraction</span>
</span><span id="SubSampler-16"><a href="#SubSampler-16"><span class="linenos">16</span></a>
</span><span id="SubSampler-17"><a href="#SubSampler-17"><span class="linenos">17</span></a><span class="sd">       n_samples: int</span>
</span><span id="SubSampler-18"><a href="#SubSampler-18"><span class="linenos">18</span></a><span class="sd">            subsampling by using the number of rows (supersedes row_sample)</span>
</span><span id="SubSampler-19"><a href="#SubSampler-19"><span class="linenos">19</span></a>
</span><span id="SubSampler-20"><a href="#SubSampler-20"><span class="linenos">20</span></a><span class="sd">       seed: int</span>
</span><span id="SubSampler-21"><a href="#SubSampler-21"><span class="linenos">21</span></a><span class="sd">           reproductibility seed</span>
</span><span id="SubSampler-22"><a href="#SubSampler-22"><span class="linenos">22</span></a>
</span><span id="SubSampler-23"><a href="#SubSampler-23"><span class="linenos">23</span></a><span class="sd">       n_jobs: int</span>
</span><span id="SubSampler-24"><a href="#SubSampler-24"><span class="linenos">24</span></a><span class="sd">            number of jobs to run in parallel</span>
</span><span id="SubSampler-25"><a href="#SubSampler-25"><span class="linenos">25</span></a>
</span><span id="SubSampler-26"><a href="#SubSampler-26"><span class="linenos">26</span></a><span class="sd">       verbose: bool</span>
</span><span id="SubSampler-27"><a href="#SubSampler-27"><span class="linenos">27</span></a><span class="sd">            print progress messages and bars</span>
</span><span id="SubSampler-28"><a href="#SubSampler-28"><span class="linenos">28</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="SubSampler-29"><a href="#SubSampler-29"><span class="linenos">29</span></a>
</span><span id="SubSampler-30"><a href="#SubSampler-30"><span class="linenos">30</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="SubSampler-31"><a href="#SubSampler-31"><span class="linenos">31</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="SubSampler-32"><a href="#SubSampler-32"><span class="linenos">32</span></a>        <span class="n">y</span><span class="p">,</span>
</span><span id="SubSampler-33"><a href="#SubSampler-33"><span class="linenos">33</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
</span><span id="SubSampler-34"><a href="#SubSampler-34"><span class="linenos">34</span></a>        <span class="n">n_samples</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="SubSampler-35"><a href="#SubSampler-35"><span class="linenos">35</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="SubSampler-36"><a href="#SubSampler-36"><span class="linenos">36</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="SubSampler-37"><a href="#SubSampler-37"><span class="linenos">37</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="SubSampler-38"><a href="#SubSampler-38"><span class="linenos">38</span></a>    <span class="p">):</span>
</span><span id="SubSampler-39"><a href="#SubSampler-39"><span class="linenos">39</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</span><span id="SubSampler-40"><a href="#SubSampler-40"><span class="linenos">40</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">=</span> <span class="n">n_samples</span>
</span><span id="SubSampler-41"><a href="#SubSampler-41"><span class="linenos">41</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="SubSampler-42"><a href="#SubSampler-42"><span class="linenos">42</span></a>            <span class="k">assert</span> <span class="p">(</span>
</span><span id="SubSampler-43"><a href="#SubSampler-43"><span class="linenos">43</span></a>                <span class="n">row_sample</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">row_sample</span> <span class="o">&gt;=</span> <span class="mi">0</span>
</span><span id="SubSampler-44"><a href="#SubSampler-44"><span class="linenos">44</span></a>            <span class="p">),</span> <span class="s2">&quot;&#39;row_sample&#39; must be provided, plus &lt; 1 and &gt;= 0&quot;</span>
</span><span id="SubSampler-45"><a href="#SubSampler-45"><span class="linenos">45</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span> <span class="o">=</span> <span class="n">row_sample</span>
</span><span id="SubSampler-46"><a href="#SubSampler-46"><span class="linenos">46</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="SubSampler-47"><a href="#SubSampler-47"><span class="linenos">47</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="s2">&quot;&#39;n_samples&#39; must be &lt; len(y)&quot;</span>
</span><span id="SubSampler-48"><a href="#SubSampler-48"><span class="linenos">48</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="SubSampler-49"><a href="#SubSampler-49"><span class="linenos">49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
</span><span id="SubSampler-50"><a href="#SubSampler-50"><span class="linenos">50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="SubSampler-51"><a href="#SubSampler-51"><span class="linenos">51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="SubSampler-52"><a href="#SubSampler-52"><span class="linenos">52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="SubSampler-53"><a href="#SubSampler-53"><span class="linenos">53</span></a>
</span><span id="SubSampler-54"><a href="#SubSampler-54"><span class="linenos">54</span></a>    <span class="k">def</span> <span class="nf">subsample</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SubSampler-55"><a href="#SubSampler-55"><span class="linenos">55</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns indices of subsampled input data.</span>
</span><span id="SubSampler-56"><a href="#SubSampler-56"><span class="linenos">56</span></a>
</span><span id="SubSampler-57"><a href="#SubSampler-57"><span class="linenos">57</span></a><span class="sd">        Examples:</span>
</span><span id="SubSampler-58"><a href="#SubSampler-58"><span class="linenos">58</span></a>
</span><span id="SubSampler-59"><a href="#SubSampler-59"><span class="linenos">59</span></a><span class="sd">        &lt;ul&gt;</span>
</span><span id="SubSampler-60"><a href="#SubSampler-60"><span class="linenos">60</span></a><span class="sd">            &lt;li&gt; &lt;a href=&quot;https://github.com/Techtonique/nnetsauce/blob/master/nnetsauce/demo/thierrymoudiki_20240105_subsampling.ipynb&quot;&gt;20240105_subsampling.ipynb&lt;/a&gt; &lt;/li&gt;</span>
</span><span id="SubSampler-61"><a href="#SubSampler-61"><span class="linenos">61</span></a><span class="sd">            &lt;li&gt; &lt;a href=&quot;https://github.com/Techtonique/nnetsauce/blob/master/nnetsauce/demo/thierrymoudiki_20240131_subsampling_nsamples.ipynb&quot;&gt;20240131_subsampling_nsamples.ipynb&lt;/a&gt; &lt;/li&gt;</span>
</span><span id="SubSampler-62"><a href="#SubSampler-62"><span class="linenos">62</span></a><span class="sd">        &lt;/ul&gt;</span>
</span><span id="SubSampler-63"><a href="#SubSampler-63"><span class="linenos">63</span></a>
</span><span id="SubSampler-64"><a href="#SubSampler-64"><span class="linenos">64</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SubSampler-65"><a href="#SubSampler-65"><span class="linenos">65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="n">dosubsample</span><span class="p">(</span>
</span><span id="SubSampler-66"><a href="#SubSampler-66"><span class="linenos">66</span></a>            <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="SubSampler-67"><a href="#SubSampler-67"><span class="linenos">67</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="SubSampler-68"><a href="#SubSampler-68"><span class="linenos">68</span></a>            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="SubSampler-69"><a href="#SubSampler-69"><span class="linenos">69</span></a>            <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span>
</span><span id="SubSampler-70"><a href="#SubSampler-70"><span class="linenos">70</span></a>            <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="SubSampler-71"><a href="#SubSampler-71"><span class="linenos">71</span></a>        <span class="p">)</span>
</span><span id="SubSampler-72"><a href="#SubSampler-72"><span class="linenos">72</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span>
</span></pre></div>


            <div class="docstring"><p>Subsampling class.</p>

<p>Attributes:</p>

<p>y: array-like, shape = [n_samples]
       Target values.</p>

<p>row_sample: double
       subsampling fraction</p>

<p>n_samples: int
        subsampling by using the number of rows (supersedes row_sample)</p>

<p>seed: int
       reproductibility seed</p>

<p>n_jobs: int
        number of jobs to run in parallel</p>

<p>verbose: bool
        print progress messages and bars</p>
</div>


                                <div id="SubSampler.subsample" class="classattr">
                                            <input id="SubSampler.subsample-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">subsample</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="SubSampler.subsample-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#SubSampler.subsample"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="SubSampler.subsample-54"><a href="#SubSampler.subsample-54"><span class="linenos">54</span></a>    <span class="k">def</span> <span class="nf">subsample</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="SubSampler.subsample-55"><a href="#SubSampler.subsample-55"><span class="linenos">55</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns indices of subsampled input data.</span>
</span><span id="SubSampler.subsample-56"><a href="#SubSampler.subsample-56"><span class="linenos">56</span></a>
</span><span id="SubSampler.subsample-57"><a href="#SubSampler.subsample-57"><span class="linenos">57</span></a><span class="sd">        Examples:</span>
</span><span id="SubSampler.subsample-58"><a href="#SubSampler.subsample-58"><span class="linenos">58</span></a>
</span><span id="SubSampler.subsample-59"><a href="#SubSampler.subsample-59"><span class="linenos">59</span></a><span class="sd">        &lt;ul&gt;</span>
</span><span id="SubSampler.subsample-60"><a href="#SubSampler.subsample-60"><span class="linenos">60</span></a><span class="sd">            &lt;li&gt; &lt;a href=&quot;https://github.com/Techtonique/nnetsauce/blob/master/nnetsauce/demo/thierrymoudiki_20240105_subsampling.ipynb&quot;&gt;20240105_subsampling.ipynb&lt;/a&gt; &lt;/li&gt;</span>
</span><span id="SubSampler.subsample-61"><a href="#SubSampler.subsample-61"><span class="linenos">61</span></a><span class="sd">            &lt;li&gt; &lt;a href=&quot;https://github.com/Techtonique/nnetsauce/blob/master/nnetsauce/demo/thierrymoudiki_20240131_subsampling_nsamples.ipynb&quot;&gt;20240131_subsampling_nsamples.ipynb&lt;/a&gt; &lt;/li&gt;</span>
</span><span id="SubSampler.subsample-62"><a href="#SubSampler.subsample-62"><span class="linenos">62</span></a><span class="sd">        &lt;/ul&gt;</span>
</span><span id="SubSampler.subsample-63"><a href="#SubSampler.subsample-63"><span class="linenos">63</span></a>
</span><span id="SubSampler.subsample-64"><a href="#SubSampler.subsample-64"><span class="linenos">64</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="SubSampler.subsample-65"><a href="#SubSampler.subsample-65"><span class="linenos">65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="n">dosubsample</span><span class="p">(</span>
</span><span id="SubSampler.subsample-66"><a href="#SubSampler.subsample-66"><span class="linenos">66</span></a>            <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
</span><span id="SubSampler.subsample-67"><a href="#SubSampler.subsample-67"><span class="linenos">67</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="SubSampler.subsample-68"><a href="#SubSampler.subsample-68"><span class="linenos">68</span></a>            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="SubSampler.subsample-69"><a href="#SubSampler.subsample-69"><span class="linenos">69</span></a>            <span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">,</span>
</span><span id="SubSampler.subsample-70"><a href="#SubSampler.subsample-70"><span class="linenos">70</span></a>            <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span>
</span><span id="SubSampler.subsample-71"><a href="#SubSampler.subsample-71"><span class="linenos">71</span></a>        <span class="p">)</span>
</span><span id="SubSampler.subsample-72"><a href="#SubSampler.subsample-72"><span class="linenos">72</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices</span>
</span></pre></div>


            <div class="docstring"><p>Returns indices of subsampled input data.</p>

<p>Examples:</p>

<ul>
    <li> <a href="https://github.com/Techtonique/nnetsauce/blob/master/nnetsauce/demo/thierrymoudiki_20240105_subsampling.ipynb">20240105_subsampling.ipynb</a> </li>
    <li> <a href="https://github.com/Techtonique/nnetsauce/blob/master/nnetsauce/demo/thierrymoudiki_20240131_subsampling_nsamples.ipynb">20240131_subsampling_nsamples.ipynb</a> </li>
</ul>
</div>


                                </div>
                        
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>