<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.4.0"/>
    <title>nnetsauce.lazypredict API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! theme.css */:root{--pdoc-background:#212529;}.pdoc{--text:#f7f7f7;--muted:#9d9d9d;--link:#58a6ff;--link-hover:#3989ff;--code:#333;--active:#555;--accent:#343434;--accent2:#555;--nav-hover:rgba(0, 0, 0, 0.1);--name:#77C1FF;--def:#0cdd0c;--annotation:#00c037;}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#49483e}.pdoc-code{background:#272822; color:#f8f8f2}.pdoc-code .c{color:#75715e}.pdoc-code .err{color:#960050; background-color:#1e0010}.pdoc-code .esc{color:#f8f8f2}.pdoc-code .g{color:#f8f8f2}.pdoc-code .k{color:#66d9ef}.pdoc-code .l{color:#ae81ff}.pdoc-code .n{color:#f8f8f2}.pdoc-code .o{color:#f92672}.pdoc-code .x{color:#f8f8f2}.pdoc-code .p{color:#f8f8f2}.pdoc-code .ch{color:#75715e}.pdoc-code .cm{color:#75715e}.pdoc-code .cp{color:#75715e}.pdoc-code .cpf{color:#75715e}.pdoc-code .c1{color:#75715e}.pdoc-code .cs{color:#75715e}.pdoc-code .gd{color:#f92672}.pdoc-code .ge{color:#f8f8f2; font-style:italic}.pdoc-code .gr{color:#f8f8f2}.pdoc-code .gh{color:#f8f8f2}.pdoc-code .gi{color:#a6e22e}.pdoc-code .go{color:#66d9ef}.pdoc-code .gp{color:#f92672; font-weight:bold}.pdoc-code .gs{color:#f8f8f2; font-weight:bold}.pdoc-code .gu{color:#75715e}.pdoc-code .gt{color:#f8f8f2}.pdoc-code .kc{color:#66d9ef}.pdoc-code .kd{color:#66d9ef}.pdoc-code .kn{color:#f92672}.pdoc-code .kp{color:#66d9ef}.pdoc-code .kr{color:#66d9ef}.pdoc-code .kt{color:#66d9ef}.pdoc-code .ld{color:#e6db74}.pdoc-code .m{color:#ae81ff}.pdoc-code .s{color:#e6db74}.pdoc-code .na{color:#a6e22e}.pdoc-code .nb{color:#f8f8f2}.pdoc-code .nc{color:#a6e22e}.pdoc-code .no{color:#66d9ef}.pdoc-code .nd{color:#a6e22e}.pdoc-code .ni{color:#f8f8f2}.pdoc-code .ne{color:#a6e22e}.pdoc-code .nf{color:#a6e22e}.pdoc-code .nl{color:#f8f8f2}.pdoc-code .nn{color:#f8f8f2}.pdoc-code .nx{color:#a6e22e}.pdoc-code .py{color:#f8f8f2}.pdoc-code .nt{color:#f92672}.pdoc-code .nv{color:#f8f8f2}.pdoc-code .ow{color:#f92672}.pdoc-code .w{color:#f8f8f2}.pdoc-code .mb{color:#ae81ff}.pdoc-code .mf{color:#ae81ff}.pdoc-code .mh{color:#ae81ff}.pdoc-code .mi{color:#ae81ff}.pdoc-code .mo{color:#ae81ff}.pdoc-code .sa{color:#e6db74}.pdoc-code .sb{color:#e6db74}.pdoc-code .sc{color:#e6db74}.pdoc-code .dl{color:#e6db74}.pdoc-code .sd{color:#e6db74}.pdoc-code .s2{color:#e6db74}.pdoc-code .se{color:#ae81ff}.pdoc-code .sh{color:#e6db74}.pdoc-code .si{color:#e6db74}.pdoc-code .sx{color:#e6db74}.pdoc-code .sr{color:#e6db74}.pdoc-code .s1{color:#e6db74}.pdoc-code .ss{color:#e6db74}.pdoc-code .bp{color:#f8f8f2}.pdoc-code .fm{color:#a6e22e}.pdoc-code .vc{color:#f8f8f2}.pdoc-code .vg{color:#f8f8f2}.pdoc-code .vi{color:#f8f8f2}.pdoc-code .vm{color:#f8f8f2}</style>
    <style>/*! theme.css */:root{--pdoc-background:#212529;}.pdoc{--text:#f7f7f7;--muted:#9d9d9d;--link:#58a6ff;--link-hover:#3989ff;--code:#333;--active:#555;--accent:#343434;--accent2:#555;--nav-hover:rgba(0, 0, 0, 0.1);--name:#77C1FF;--def:#0cdd0c;--annotation:#00c037;}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#49483e}.pdoc-code{background:#272822; color:#f8f8f2}.pdoc-code .c{color:#75715e}.pdoc-code .err{color:#960050; background-color:#1e0010}.pdoc-code .esc{color:#f8f8f2}.pdoc-code .g{color:#f8f8f2}.pdoc-code .k{color:#66d9ef}.pdoc-code .l{color:#ae81ff}.pdoc-code .n{color:#f8f8f2}.pdoc-code .o{color:#f92672}.pdoc-code .x{color:#f8f8f2}.pdoc-code .p{color:#f8f8f2}.pdoc-code .ch{color:#75715e}.pdoc-code .cm{color:#75715e}.pdoc-code .cp{color:#75715e}.pdoc-code .cpf{color:#75715e}.pdoc-code .c1{color:#75715e}.pdoc-code .cs{color:#75715e}.pdoc-code .gd{color:#f92672}.pdoc-code .ge{color:#f8f8f2; font-style:italic}.pdoc-code .gr{color:#f8f8f2}.pdoc-code .gh{color:#f8f8f2}.pdoc-code .gi{color:#a6e22e}.pdoc-code .go{color:#66d9ef}.pdoc-code .gp{color:#f92672; font-weight:bold}.pdoc-code .gs{color:#f8f8f2; font-weight:bold}.pdoc-code .gu{color:#75715e}.pdoc-code .gt{color:#f8f8f2}.pdoc-code .kc{color:#66d9ef}.pdoc-code .kd{color:#66d9ef}.pdoc-code .kn{color:#f92672}.pdoc-code .kp{color:#66d9ef}.pdoc-code .kr{color:#66d9ef}.pdoc-code .kt{color:#66d9ef}.pdoc-code .ld{color:#e6db74}.pdoc-code .m{color:#ae81ff}.pdoc-code .s{color:#e6db74}.pdoc-code .na{color:#a6e22e}.pdoc-code .nb{color:#f8f8f2}.pdoc-code .nc{color:#a6e22e}.pdoc-code .no{color:#66d9ef}.pdoc-code .nd{color:#a6e22e}.pdoc-code .ni{color:#f8f8f2}.pdoc-code .ne{color:#a6e22e}.pdoc-code .nf{color:#a6e22e}.pdoc-code .nl{color:#f8f8f2}.pdoc-code .nn{color:#f8f8f2}.pdoc-code .nx{color:#a6e22e}.pdoc-code .py{color:#f8f8f2}.pdoc-code .nt{color:#f92672}.pdoc-code .nv{color:#f8f8f2}.pdoc-code .ow{color:#f92672}.pdoc-code .w{color:#f8f8f2}.pdoc-code .mb{color:#ae81ff}.pdoc-code .mf{color:#ae81ff}.pdoc-code .mh{color:#ae81ff}.pdoc-code .mi{color:#ae81ff}.pdoc-code .mo{color:#ae81ff}.pdoc-code .sa{color:#e6db74}.pdoc-code .sb{color:#e6db74}.pdoc-code .sc{color:#e6db74}.pdoc-code .dl{color:#e6db74}.pdoc-code .sd{color:#e6db74}.pdoc-code .s2{color:#e6db74}.pdoc-code .se{color:#ae81ff}.pdoc-code .sh{color:#e6db74}.pdoc-code .si{color:#e6db74}.pdoc-code .sx{color:#e6db74}.pdoc-code .sr{color:#e6db74}.pdoc-code .s1{color:#e6db74}.pdoc-code .ss{color:#e6db74}.pdoc-code .bp{color:#f8f8f2}.pdoc-code .fm{color:#a6e22e}.pdoc-code .vc{color:#f8f8f2}.pdoc-code .vg{color:#f8f8f2}.pdoc-code .vi{color:#f8f8f2}.pdoc-code .vm{color:#f8f8f2}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../nnetsauce.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;nnetsauce</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>            
                <ul class="memberlist">
            <li>
                    <a class="class" href="#LazyClassifier">LazyClassifier</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#LazyRegressor">LazyRegressor</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#LazyMTS">LazyMTS</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#LazyDeepClassifier">LazyDeepClassifier</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#LazyDeepRegressor">LazyDeepRegressor</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
            <li>
                    <a class="class" href="#LazyDeepMTS">LazyDeepMTS</a>
                            <ul class="memberlist">
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                        <li>
                        </li>
                </ul>

                
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../nnetsauce.html">nnetsauce</a><wbr>.lazypredict    </h1>

                
                        <input id="mod-lazypredict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-lazypredict-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="kn">from</span> <span class="nn">.lazyClassifier</span> <span class="kn">import</span> <span class="n">LazyClassifier</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a><span class="kn">from</span> <span class="nn">.lazyRegressor</span> <span class="kn">import</span> <span class="n">LazyRegressor</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="kn">from</span> <span class="nn">.lazyMTS</span> <span class="kn">import</span> <span class="n">LazyMTS</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="kn">from</span> <span class="nn">.lazydeepClassifier</span> <span class="kn">import</span> <span class="n">LazyDeepClassifier</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="kn">from</span> <span class="nn">.lazydeepRegressor</span> <span class="kn">import</span> <span class="n">LazyDeepRegressor</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="kn">from</span> <span class="nn">.lazydeepMTS</span> <span class="kn">import</span> <span class="n">LazyDeepMTS</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a>    <span class="s2">&quot;LazyClassifier&quot;</span><span class="p">,</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>    <span class="s2">&quot;LazyRegressor&quot;</span><span class="p">,</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a>    <span class="s2">&quot;LazyMTS&quot;</span><span class="p">,</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a>    <span class="s2">&quot;LazyDeepClassifier&quot;</span><span class="p">,</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a>    <span class="s2">&quot;LazyDeepRegressor&quot;</span><span class="p">,</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a>    <span class="s2">&quot;LazyDeepMTS&quot;</span><span class="p">,</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="LazyClassifier">
                            <input id="LazyClassifier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LazyClassifier</span><wbr>(<span class="base">nnetsauce.custom.custom.Custom</span>, <span class="base">sklearn.base.ClassifierMixin</span>):

                <label class="view-source-button" for="LazyClassifier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyClassifier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyClassifier-67"><a href="#LazyClassifier-67"><span class="linenos"> 67</span></a><span class="k">class</span> <span class="nc">LazyClassifier</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">):</span>
</span><span id="LazyClassifier-68"><a href="#LazyClassifier-68"><span class="linenos"> 68</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyClassifier-69"><a href="#LazyClassifier-69"><span class="linenos"> 69</span></a>
</span><span id="LazyClassifier-70"><a href="#LazyClassifier-70"><span class="linenos"> 70</span></a><span class="sd">        Fitting -- almost -- all the classification algorithms with nnetsauce&#39;s</span>
</span><span id="LazyClassifier-71"><a href="#LazyClassifier-71"><span class="linenos"> 71</span></a><span class="sd">        CustomClassifier and returning their scores.</span>
</span><span id="LazyClassifier-72"><a href="#LazyClassifier-72"><span class="linenos"> 72</span></a>
</span><span id="LazyClassifier-73"><a href="#LazyClassifier-73"><span class="linenos"> 73</span></a><span class="sd">    Parameters:</span>
</span><span id="LazyClassifier-74"><a href="#LazyClassifier-74"><span class="linenos"> 74</span></a>
</span><span id="LazyClassifier-75"><a href="#LazyClassifier-75"><span class="linenos"> 75</span></a><span class="sd">        verbose: int, optional (default=0)</span>
</span><span id="LazyClassifier-76"><a href="#LazyClassifier-76"><span class="linenos"> 76</span></a><span class="sd">            Any positive number for verbosity.</span>
</span><span id="LazyClassifier-77"><a href="#LazyClassifier-77"><span class="linenos"> 77</span></a>
</span><span id="LazyClassifier-78"><a href="#LazyClassifier-78"><span class="linenos"> 78</span></a><span class="sd">        ignore_warnings: bool, optional (default=True)</span>
</span><span id="LazyClassifier-79"><a href="#LazyClassifier-79"><span class="linenos"> 79</span></a><span class="sd">            When set to True, warnings related to algorithms that were not</span>
</span><span id="LazyClassifier-80"><a href="#LazyClassifier-80"><span class="linenos"> 80</span></a><span class="sd">            run are ignored.</span>
</span><span id="LazyClassifier-81"><a href="#LazyClassifier-81"><span class="linenos"> 81</span></a>
</span><span id="LazyClassifier-82"><a href="#LazyClassifier-82"><span class="linenos"> 82</span></a><span class="sd">        custom_metric: function, optional (default=None)</span>
</span><span id="LazyClassifier-83"><a href="#LazyClassifier-83"><span class="linenos"> 83</span></a><span class="sd">            When function is provided, models are evaluated based on the</span>
</span><span id="LazyClassifier-84"><a href="#LazyClassifier-84"><span class="linenos"> 84</span></a><span class="sd">            custom evaluation metric provided.</span>
</span><span id="LazyClassifier-85"><a href="#LazyClassifier-85"><span class="linenos"> 85</span></a>
</span><span id="LazyClassifier-86"><a href="#LazyClassifier-86"><span class="linenos"> 86</span></a><span class="sd">        predictions: bool, optional (default=False)</span>
</span><span id="LazyClassifier-87"><a href="#LazyClassifier-87"><span class="linenos"> 87</span></a><span class="sd">            When set to True, the predictions of all the models models are</span>
</span><span id="LazyClassifier-88"><a href="#LazyClassifier-88"><span class="linenos"> 88</span></a><span class="sd">            returned as data frame.</span>
</span><span id="LazyClassifier-89"><a href="#LazyClassifier-89"><span class="linenos"> 89</span></a>
</span><span id="LazyClassifier-90"><a href="#LazyClassifier-90"><span class="linenos"> 90</span></a><span class="sd">        sort_by: string, optional (default=&#39;Accuracy&#39;)</span>
</span><span id="LazyClassifier-91"><a href="#LazyClassifier-91"><span class="linenos"> 91</span></a><span class="sd">            Sort models by a metric. Available options are &#39;Accuracy&#39;,</span>
</span><span id="LazyClassifier-92"><a href="#LazyClassifier-92"><span class="linenos"> 92</span></a><span class="sd">            &#39;Balanced Accuracy&#39;, &#39;ROC AUC&#39;, &#39;F1 Score&#39; or a custom metric</span>
</span><span id="LazyClassifier-93"><a href="#LazyClassifier-93"><span class="linenos"> 93</span></a><span class="sd">            identified by its name and provided by custom_metric.</span>
</span><span id="LazyClassifier-94"><a href="#LazyClassifier-94"><span class="linenos"> 94</span></a>
</span><span id="LazyClassifier-95"><a href="#LazyClassifier-95"><span class="linenos"> 95</span></a><span class="sd">        random_state: int, optional (default=42)</span>
</span><span id="LazyClassifier-96"><a href="#LazyClassifier-96"><span class="linenos"> 96</span></a><span class="sd">            Reproducibiility seed.</span>
</span><span id="LazyClassifier-97"><a href="#LazyClassifier-97"><span class="linenos"> 97</span></a>
</span><span id="LazyClassifier-98"><a href="#LazyClassifier-98"><span class="linenos"> 98</span></a><span class="sd">        estimators: list, optional (default=&#39;all&#39;)</span>
</span><span id="LazyClassifier-99"><a href="#LazyClassifier-99"><span class="linenos"> 99</span></a><span class="sd">            list of Estimators names or just &#39;all&#39; for &gt; 90</span>
</span><span id="LazyClassifier-100"><a href="#LazyClassifier-100"><span class="linenos">100</span></a><span class="sd">            classifiers (default=&#39;all&#39;)</span>
</span><span id="LazyClassifier-101"><a href="#LazyClassifier-101"><span class="linenos">101</span></a>
</span><span id="LazyClassifier-102"><a href="#LazyClassifier-102"><span class="linenos">102</span></a><span class="sd">        preprocess: bool, preprocessing is done when set to True</span>
</span><span id="LazyClassifier-103"><a href="#LazyClassifier-103"><span class="linenos">103</span></a>
</span><span id="LazyClassifier-104"><a href="#LazyClassifier-104"><span class="linenos">104</span></a><span class="sd">        n_jobs: int, when possible, run in parallel</span>
</span><span id="LazyClassifier-105"><a href="#LazyClassifier-105"><span class="linenos">105</span></a><span class="sd">            For now, only used by individual models that support it.</span>
</span><span id="LazyClassifier-106"><a href="#LazyClassifier-106"><span class="linenos">106</span></a>
</span><span id="LazyClassifier-107"><a href="#LazyClassifier-107"><span class="linenos">107</span></a><span class="sd">        All the other parameters are the same as CustomClassifier&#39;s.</span>
</span><span id="LazyClassifier-108"><a href="#LazyClassifier-108"><span class="linenos">108</span></a>
</span><span id="LazyClassifier-109"><a href="#LazyClassifier-109"><span class="linenos">109</span></a><span class="sd">    Examples:</span>
</span><span id="LazyClassifier-110"><a href="#LazyClassifier-110"><span class="linenos">110</span></a>
</span><span id="LazyClassifier-111"><a href="#LazyClassifier-111"><span class="linenos">111</span></a><span class="sd">        ```python</span>
</span><span id="LazyClassifier-112"><a href="#LazyClassifier-112"><span class="linenos">112</span></a><span class="sd">        import nnetsauce as ns</span>
</span><span id="LazyClassifier-113"><a href="#LazyClassifier-113"><span class="linenos">113</span></a><span class="sd">        from sklearn.datasets import load_breast_cancer</span>
</span><span id="LazyClassifier-114"><a href="#LazyClassifier-114"><span class="linenos">114</span></a><span class="sd">        from sklearn.model_selection import train_test_split</span>
</span><span id="LazyClassifier-115"><a href="#LazyClassifier-115"><span class="linenos">115</span></a><span class="sd">        data = load_breast_cancer()</span>
</span><span id="LazyClassifier-116"><a href="#LazyClassifier-116"><span class="linenos">116</span></a><span class="sd">        X = data.data</span>
</span><span id="LazyClassifier-117"><a href="#LazyClassifier-117"><span class="linenos">117</span></a><span class="sd">        y= data.target</span>
</span><span id="LazyClassifier-118"><a href="#LazyClassifier-118"><span class="linenos">118</span></a><span class="sd">        X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=.2,</span>
</span><span id="LazyClassifier-119"><a href="#LazyClassifier-119"><span class="linenos">119</span></a><span class="sd">        random_state=123)</span>
</span><span id="LazyClassifier-120"><a href="#LazyClassifier-120"><span class="linenos">120</span></a><span class="sd">        clf = ns.LazyClassifier(verbose=0, ignore_warnings=True)</span>
</span><span id="LazyClassifier-121"><a href="#LazyClassifier-121"><span class="linenos">121</span></a><span class="sd">        models, predictions = clf.fit(X_train, X_test, y_train, y_test)</span>
</span><span id="LazyClassifier-122"><a href="#LazyClassifier-122"><span class="linenos">122</span></a><span class="sd">        model_dictionary = clf.provide_models(X_train,X_test,y_train,y_test)</span>
</span><span id="LazyClassifier-123"><a href="#LazyClassifier-123"><span class="linenos">123</span></a><span class="sd">        print(models)</span>
</span><span id="LazyClassifier-124"><a href="#LazyClassifier-124"><span class="linenos">124</span></a><span class="sd">        ```</span>
</span><span id="LazyClassifier-125"><a href="#LazyClassifier-125"><span class="linenos">125</span></a>
</span><span id="LazyClassifier-126"><a href="#LazyClassifier-126"><span class="linenos">126</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LazyClassifier-127"><a href="#LazyClassifier-127"><span class="linenos">127</span></a>
</span><span id="LazyClassifier-128"><a href="#LazyClassifier-128"><span class="linenos">128</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyClassifier-129"><a href="#LazyClassifier-129"><span class="linenos">129</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="LazyClassifier-130"><a href="#LazyClassifier-130"><span class="linenos">130</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyClassifier-131"><a href="#LazyClassifier-131"><span class="linenos">131</span></a>        <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyClassifier-132"><a href="#LazyClassifier-132"><span class="linenos">132</span></a>        <span class="n">custom_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyClassifier-133"><a href="#LazyClassifier-133"><span class="linenos">133</span></a>        <span class="n">predictions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyClassifier-134"><a href="#LazyClassifier-134"><span class="linenos">134</span></a>        <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-135"><a href="#LazyClassifier-135"><span class="linenos">135</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="LazyClassifier-136"><a href="#LazyClassifier-136"><span class="linenos">136</span></a>        <span class="n">estimators</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-137"><a href="#LazyClassifier-137"><span class="linenos">137</span></a>        <span class="n">preprocess</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyClassifier-138"><a href="#LazyClassifier-138"><span class="linenos">138</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyClassifier-139"><a href="#LazyClassifier-139"><span class="linenos">139</span></a>        <span class="c1"># CustomClassifier attributes</span>
</span><span id="LazyClassifier-140"><a href="#LazyClassifier-140"><span class="linenos">140</span></a>        <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyClassifier-141"><a href="#LazyClassifier-141"><span class="linenos">141</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="LazyClassifier-142"><a href="#LazyClassifier-142"><span class="linenos">142</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-143"><a href="#LazyClassifier-143"><span class="linenos">143</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="LazyClassifier-144"><a href="#LazyClassifier-144"><span class="linenos">144</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-145"><a href="#LazyClassifier-145"><span class="linenos">145</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyClassifier-146"><a href="#LazyClassifier-146"><span class="linenos">146</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyClassifier-147"><a href="#LazyClassifier-147"><span class="linenos">147</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyClassifier-148"><a href="#LazyClassifier-148"><span class="linenos">148</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="LazyClassifier-149"><a href="#LazyClassifier-149"><span class="linenos">149</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyClassifier-150"><a href="#LazyClassifier-150"><span class="linenos">150</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-151"><a href="#LazyClassifier-151"><span class="linenos">151</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="LazyClassifier-152"><a href="#LazyClassifier-152"><span class="linenos">152</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyClassifier-153"><a href="#LazyClassifier-153"><span class="linenos">153</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyClassifier-154"><a href="#LazyClassifier-154"><span class="linenos">154</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="LazyClassifier-155"><a href="#LazyClassifier-155"><span class="linenos">155</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-156"><a href="#LazyClassifier-156"><span class="linenos">156</span></a>    <span class="p">):</span>
</span><span id="LazyClassifier-157"><a href="#LazyClassifier-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="LazyClassifier-158"><a href="#LazyClassifier-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="o">=</span> <span class="n">ignore_warnings</span>
</span><span id="LazyClassifier-159"><a href="#LazyClassifier-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="o">=</span> <span class="n">custom_metric</span>
</span><span id="LazyClassifier-160"><a href="#LazyClassifier-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span>
</span><span id="LazyClassifier-161"><a href="#LazyClassifier-161"><span class="linenos">161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sort_by</span> <span class="o">=</span> <span class="n">sort_by</span>
</span><span id="LazyClassifier-162"><a href="#LazyClassifier-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyClassifier-163"><a href="#LazyClassifier-163"><span class="linenos">163</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="LazyClassifier-164"><a href="#LazyClassifier-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">=</span> <span class="n">estimators</span>
</span><span id="LazyClassifier-165"><a href="#LazyClassifier-165"><span class="linenos">165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="o">=</span> <span class="n">preprocess</span>
</span><span id="LazyClassifier-166"><a href="#LazyClassifier-166"><span class="linenos">166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="LazyClassifier-167"><a href="#LazyClassifier-167"><span class="linenos">167</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyClassifier-168"><a href="#LazyClassifier-168"><span class="linenos">168</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="LazyClassifier-169"><a href="#LazyClassifier-169"><span class="linenos">169</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier-170"><a href="#LazyClassifier-170"><span class="linenos">170</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier-171"><a href="#LazyClassifier-171"><span class="linenos">171</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier-172"><a href="#LazyClassifier-172"><span class="linenos">172</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier-173"><a href="#LazyClassifier-173"><span class="linenos">173</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier-174"><a href="#LazyClassifier-174"><span class="linenos">174</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier-175"><a href="#LazyClassifier-175"><span class="linenos">175</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier-176"><a href="#LazyClassifier-176"><span class="linenos">176</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier-177"><a href="#LazyClassifier-177"><span class="linenos">177</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier-178"><a href="#LazyClassifier-178"><span class="linenos">178</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier-179"><a href="#LazyClassifier-179"><span class="linenos">179</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier-180"><a href="#LazyClassifier-180"><span class="linenos">180</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-181"><a href="#LazyClassifier-181"><span class="linenos">181</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-182"><a href="#LazyClassifier-182"><span class="linenos">182</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier-183"><a href="#LazyClassifier-183"><span class="linenos">183</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier-184"><a href="#LazyClassifier-184"><span class="linenos">184</span></a>        <span class="p">)</span>
</span><span id="LazyClassifier-185"><a href="#LazyClassifier-185"><span class="linenos">185</span></a>
</span><span id="LazyClassifier-186"><a href="#LazyClassifier-186"><span class="linenos">186</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyClassifier-187"><a href="#LazyClassifier-187"><span class="linenos">187</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit classifiers to X_train and y_train, predict and score on X_test,</span>
</span><span id="LazyClassifier-188"><a href="#LazyClassifier-188"><span class="linenos">188</span></a><span class="sd">        y_test.</span>
</span><span id="LazyClassifier-189"><a href="#LazyClassifier-189"><span class="linenos">189</span></a>
</span><span id="LazyClassifier-190"><a href="#LazyClassifier-190"><span class="linenos">190</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyClassifier-191"><a href="#LazyClassifier-191"><span class="linenos">191</span></a>
</span><span id="LazyClassifier-192"><a href="#LazyClassifier-192"><span class="linenos">192</span></a><span class="sd">            X_train: array-like,</span>
</span><span id="LazyClassifier-193"><a href="#LazyClassifier-193"><span class="linenos">193</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier-194"><a href="#LazyClassifier-194"><span class="linenos">194</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyClassifier-195"><a href="#LazyClassifier-195"><span class="linenos">195</span></a>
</span><span id="LazyClassifier-196"><a href="#LazyClassifier-196"><span class="linenos">196</span></a><span class="sd">            X_test: array-like,</span>
</span><span id="LazyClassifier-197"><a href="#LazyClassifier-197"><span class="linenos">197</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier-198"><a href="#LazyClassifier-198"><span class="linenos">198</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyClassifier-199"><a href="#LazyClassifier-199"><span class="linenos">199</span></a>
</span><span id="LazyClassifier-200"><a href="#LazyClassifier-200"><span class="linenos">200</span></a><span class="sd">            y_train: array-like,</span>
</span><span id="LazyClassifier-201"><a href="#LazyClassifier-201"><span class="linenos">201</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier-202"><a href="#LazyClassifier-202"><span class="linenos">202</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyClassifier-203"><a href="#LazyClassifier-203"><span class="linenos">203</span></a>
</span><span id="LazyClassifier-204"><a href="#LazyClassifier-204"><span class="linenos">204</span></a><span class="sd">            y_test: array-like,</span>
</span><span id="LazyClassifier-205"><a href="#LazyClassifier-205"><span class="linenos">205</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier-206"><a href="#LazyClassifier-206"><span class="linenos">206</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyClassifier-207"><a href="#LazyClassifier-207"><span class="linenos">207</span></a>
</span><span id="LazyClassifier-208"><a href="#LazyClassifier-208"><span class="linenos">208</span></a><span class="sd">        Returns:</span>
</span><span id="LazyClassifier-209"><a href="#LazyClassifier-209"><span class="linenos">209</span></a>
</span><span id="LazyClassifier-210"><a href="#LazyClassifier-210"><span class="linenos">210</span></a><span class="sd">            scores: Pandas DataFrame</span>
</span><span id="LazyClassifier-211"><a href="#LazyClassifier-211"><span class="linenos">211</span></a><span class="sd">                Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyClassifier-212"><a href="#LazyClassifier-212"><span class="linenos">212</span></a>
</span><span id="LazyClassifier-213"><a href="#LazyClassifier-213"><span class="linenos">213</span></a><span class="sd">            predictions: Pandas DataFrame</span>
</span><span id="LazyClassifier-214"><a href="#LazyClassifier-214"><span class="linenos">214</span></a><span class="sd">                Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyClassifier-215"><a href="#LazyClassifier-215"><span class="linenos">215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyClassifier-216"><a href="#LazyClassifier-216"><span class="linenos">216</span></a>        <span class="n">Accuracy</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier-217"><a href="#LazyClassifier-217"><span class="linenos">217</span></a>        <span class="n">B_Accuracy</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier-218"><a href="#LazyClassifier-218"><span class="linenos">218</span></a>        <span class="n">ROC_AUC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier-219"><a href="#LazyClassifier-219"><span class="linenos">219</span></a>        <span class="n">F1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier-220"><a href="#LazyClassifier-220"><span class="linenos">220</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier-221"><a href="#LazyClassifier-221"><span class="linenos">221</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier-222"><a href="#LazyClassifier-222"><span class="linenos">222</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyClassifier-223"><a href="#LazyClassifier-223"><span class="linenos">223</span></a>
</span><span id="LazyClassifier-224"><a href="#LazyClassifier-224"><span class="linenos">224</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier-225"><a href="#LazyClassifier-225"><span class="linenos">225</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier-226"><a href="#LazyClassifier-226"><span class="linenos">226</span></a>
</span><span id="LazyClassifier-227"><a href="#LazyClassifier-227"><span class="linenos">227</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyClassifier-228"><a href="#LazyClassifier-228"><span class="linenos">228</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyClassifier-229"><a href="#LazyClassifier-229"><span class="linenos">229</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyClassifier-230"><a href="#LazyClassifier-230"><span class="linenos">230</span></a>
</span><span id="LazyClassifier-231"><a href="#LazyClassifier-231"><span class="linenos">231</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyClassifier-232"><a href="#LazyClassifier-232"><span class="linenos">232</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyClassifier-233"><a href="#LazyClassifier-233"><span class="linenos">233</span></a>
</span><span id="LazyClassifier-234"><a href="#LazyClassifier-234"><span class="linenos">234</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyClassifier-235"><a href="#LazyClassifier-235"><span class="linenos">235</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyClassifier-236"><a href="#LazyClassifier-236"><span class="linenos">236</span></a>        <span class="p">)</span>
</span><span id="LazyClassifier-237"><a href="#LazyClassifier-237"><span class="linenos">237</span></a>
</span><span id="LazyClassifier-238"><a href="#LazyClassifier-238"><span class="linenos">238</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyClassifier-239"><a href="#LazyClassifier-239"><span class="linenos">239</span></a>
</span><span id="LazyClassifier-240"><a href="#LazyClassifier-240"><span class="linenos">240</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyClassifier-241"><a href="#LazyClassifier-241"><span class="linenos">241</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyClassifier-242"><a href="#LazyClassifier-242"><span class="linenos">242</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyClassifier-243"><a href="#LazyClassifier-243"><span class="linenos">243</span></a>                    <span class="p">(</span>
</span><span id="LazyClassifier-244"><a href="#LazyClassifier-244"><span class="linenos">244</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-245"><a href="#LazyClassifier-245"><span class="linenos">245</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyClassifier-246"><a href="#LazyClassifier-246"><span class="linenos">246</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyClassifier-247"><a href="#LazyClassifier-247"><span class="linenos">247</span></a>                    <span class="p">),</span>
</span><span id="LazyClassifier-248"><a href="#LazyClassifier-248"><span class="linenos">248</span></a>                    <span class="p">(</span>
</span><span id="LazyClassifier-249"><a href="#LazyClassifier-249"><span class="linenos">249</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-250"><a href="#LazyClassifier-250"><span class="linenos">250</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyClassifier-251"><a href="#LazyClassifier-251"><span class="linenos">251</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyClassifier-252"><a href="#LazyClassifier-252"><span class="linenos">252</span></a>                    <span class="p">),</span>
</span><span id="LazyClassifier-253"><a href="#LazyClassifier-253"><span class="linenos">253</span></a>                <span class="p">]</span>
</span><span id="LazyClassifier-254"><a href="#LazyClassifier-254"><span class="linenos">254</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier-255"><a href="#LazyClassifier-255"><span class="linenos">255</span></a>
</span><span id="LazyClassifier-256"><a href="#LazyClassifier-256"><span class="linenos">256</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyClassifier-257"><a href="#LazyClassifier-257"><span class="linenos">257</span></a>
</span><span id="LazyClassifier-258"><a href="#LazyClassifier-258"><span class="linenos">258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyClassifier-259"><a href="#LazyClassifier-259"><span class="linenos">259</span></a>                <span class="n">CLASSIFIERS</span> <span class="o">+</span> <span class="n">MULTITASKCLASSIFIERS</span> <span class="o">+</span> <span class="n">SIMPLEMULTITASKCLASSIFIERS</span>
</span><span id="LazyClassifier-260"><a href="#LazyClassifier-260"><span class="linenos">260</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier-261"><a href="#LazyClassifier-261"><span class="linenos">261</span></a>
</span><span id="LazyClassifier-262"><a href="#LazyClassifier-262"><span class="linenos">262</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># list custom estimators, by their names</span>
</span><span id="LazyClassifier-263"><a href="#LazyClassifier-263"><span class="linenos">263</span></a>
</span><span id="LazyClassifier-264"><a href="#LazyClassifier-264"><span class="linenos">264</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyClassifier-265"><a href="#LazyClassifier-265"><span class="linenos">265</span></a>                <span class="p">[</span>
</span><span id="LazyClassifier-266"><a href="#LazyClassifier-266"><span class="linenos">266</span></a>                    <span class="p">(</span><span class="s2">&quot;CustomClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyClassifier-267"><a href="#LazyClassifier-267"><span class="linenos">267</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyClassifier-268"><a href="#LazyClassifier-268"><span class="linenos">268</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier-269"><a href="#LazyClassifier-269"><span class="linenos">269</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ClassifierMixin</span><span class="p">)</span>
</span><span id="LazyClassifier-270"><a href="#LazyClassifier-270"><span class="linenos">270</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyClassifier-271"><a href="#LazyClassifier-271"><span class="linenos">271</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier-272"><a href="#LazyClassifier-272"><span class="linenos">272</span></a>                <span class="p">]</span>
</span><span id="LazyClassifier-273"><a href="#LazyClassifier-273"><span class="linenos">273</span></a>                <span class="o">+</span> <span class="p">[</span>
</span><span id="LazyClassifier-274"><a href="#LazyClassifier-274"><span class="linenos">274</span></a>                    <span class="p">(</span>
</span><span id="LazyClassifier-275"><a href="#LazyClassifier-275"><span class="linenos">275</span></a>                        <span class="s2">&quot;MultitaskClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-276"><a href="#LazyClassifier-276"><span class="linenos">276</span></a>                        <span class="n">partial</span><span class="p">(</span><span class="n">MultitaskClassifier</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">]()),</span>
</span><span id="LazyClassifier-277"><a href="#LazyClassifier-277"><span class="linenos">277</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier-278"><a href="#LazyClassifier-278"><span class="linenos">278</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyClassifier-279"><a href="#LazyClassifier-279"><span class="linenos">279</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier-280"><a href="#LazyClassifier-280"><span class="linenos">280</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyClassifier-281"><a href="#LazyClassifier-281"><span class="linenos">281</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyClassifier-282"><a href="#LazyClassifier-282"><span class="linenos">282</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier-283"><a href="#LazyClassifier-283"><span class="linenos">283</span></a>                <span class="p">]</span>
</span><span id="LazyClassifier-284"><a href="#LazyClassifier-284"><span class="linenos">284</span></a>                <span class="o">+</span> <span class="p">[</span>
</span><span id="LazyClassifier-285"><a href="#LazyClassifier-285"><span class="linenos">285</span></a>                    <span class="p">(</span>
</span><span id="LazyClassifier-286"><a href="#LazyClassifier-286"><span class="linenos">286</span></a>                        <span class="s2">&quot;SimpleMultitaskClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-287"><a href="#LazyClassifier-287"><span class="linenos">287</span></a>                        <span class="n">partial</span><span class="p">(</span><span class="n">SimpleMultitaskClassifier</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">]()),</span>
</span><span id="LazyClassifier-288"><a href="#LazyClassifier-288"><span class="linenos">288</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier-289"><a href="#LazyClassifier-289"><span class="linenos">289</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyClassifier-290"><a href="#LazyClassifier-290"><span class="linenos">290</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier-291"><a href="#LazyClassifier-291"><span class="linenos">291</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyClassifier-292"><a href="#LazyClassifier-292"><span class="linenos">292</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyClassifier-293"><a href="#LazyClassifier-293"><span class="linenos">293</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier-294"><a href="#LazyClassifier-294"><span class="linenos">294</span></a>                <span class="p">]</span>
</span><span id="LazyClassifier-295"><a href="#LazyClassifier-295"><span class="linenos">295</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier-296"><a href="#LazyClassifier-296"><span class="linenos">296</span></a>
</span><span id="LazyClassifier-297"><a href="#LazyClassifier-297"><span class="linenos">297</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyClassifier-298"><a href="#LazyClassifier-298"><span class="linenos">298</span></a>
</span><span id="LazyClassifier-299"><a href="#LazyClassifier-299"><span class="linenos">299</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyClassifier-300"><a href="#LazyClassifier-300"><span class="linenos">300</span></a>
</span><span id="LazyClassifier-301"><a href="#LazyClassifier-301"><span class="linenos">301</span></a>                <span class="n">other_args</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyClassifier-302"><a href="#LazyClassifier-302"><span class="linenos">302</span></a>                    <span class="p">{}</span>
</span><span id="LazyClassifier-303"><a href="#LazyClassifier-303"><span class="linenos">303</span></a>                <span class="p">)</span>  <span class="c1"># use this trick for `random_state` too --&gt; refactor</span>
</span><span id="LazyClassifier-304"><a href="#LazyClassifier-304"><span class="linenos">304</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier-305"><a href="#LazyClassifier-305"><span class="linenos">305</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier-306"><a href="#LazyClassifier-306"><span class="linenos">306</span></a>                        <span class="s2">&quot;n_jobs&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="LazyClassifier-307"><a href="#LazyClassifier-307"><span class="linenos">307</span></a>                        <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;LogisticRegression&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="LazyClassifier-308"><a href="#LazyClassifier-308"><span class="linenos">308</span></a>                    <span class="p">):</span>
</span><span id="LazyClassifier-309"><a href="#LazyClassifier-309"><span class="linenos">309</span></a>                        <span class="n">other_args</span><span class="p">[</span><span class="s2">&quot;n_jobs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span>
</span><span id="LazyClassifier-310"><a href="#LazyClassifier-310"><span class="linenos">310</span></a>                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="LazyClassifier-311"><a href="#LazyClassifier-311"><span class="linenos">311</span></a>                    <span class="k">pass</span>
</span><span id="LazyClassifier-312"><a href="#LazyClassifier-312"><span class="linenos">312</span></a>
</span><span id="LazyClassifier-313"><a href="#LazyClassifier-313"><span class="linenos">313</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyClassifier-314"><a href="#LazyClassifier-314"><span class="linenos">314</span></a>
</span><span id="LazyClassifier-315"><a href="#LazyClassifier-315"><span class="linenos">315</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier-316"><a href="#LazyClassifier-316"><span class="linenos">316</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyClassifier-317"><a href="#LazyClassifier-317"><span class="linenos">317</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyClassifier-318"><a href="#LazyClassifier-318"><span class="linenos">318</span></a>                            <span class="p">[</span>
</span><span id="LazyClassifier-319"><a href="#LazyClassifier-319"><span class="linenos">319</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyClassifier-320"><a href="#LazyClassifier-320"><span class="linenos">320</span></a>                                <span class="p">(</span>
</span><span id="LazyClassifier-321"><a href="#LazyClassifier-321"><span class="linenos">321</span></a>                                    <span class="s2">&quot;classifier&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-322"><a href="#LazyClassifier-322"><span class="linenos">322</span></a>                                    <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyClassifier-323"><a href="#LazyClassifier-323"><span class="linenos">323</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyClassifier-324"><a href="#LazyClassifier-324"><span class="linenos">324</span></a>                                            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="LazyClassifier-325"><a href="#LazyClassifier-325"><span class="linenos">325</span></a>                                            <span class="o">**</span><span class="n">other_args</span>
</span><span id="LazyClassifier-326"><a href="#LazyClassifier-326"><span class="linenos">326</span></a>                                        <span class="p">),</span>
</span><span id="LazyClassifier-327"><a href="#LazyClassifier-327"><span class="linenos">327</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier-328"><a href="#LazyClassifier-328"><span class="linenos">328</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier-329"><a href="#LazyClassifier-329"><span class="linenos">329</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier-330"><a href="#LazyClassifier-330"><span class="linenos">330</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier-331"><a href="#LazyClassifier-331"><span class="linenos">331</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier-332"><a href="#LazyClassifier-332"><span class="linenos">332</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier-333"><a href="#LazyClassifier-333"><span class="linenos">333</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier-334"><a href="#LazyClassifier-334"><span class="linenos">334</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier-335"><a href="#LazyClassifier-335"><span class="linenos">335</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier-336"><a href="#LazyClassifier-336"><span class="linenos">336</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier-337"><a href="#LazyClassifier-337"><span class="linenos">337</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier-338"><a href="#LazyClassifier-338"><span class="linenos">338</span></a>                                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-339"><a href="#LazyClassifier-339"><span class="linenos">339</span></a>                                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-340"><a href="#LazyClassifier-340"><span class="linenos">340</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier-341"><a href="#LazyClassifier-341"><span class="linenos">341</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier-342"><a href="#LazyClassifier-342"><span class="linenos">342</span></a>                                    <span class="p">),</span>
</span><span id="LazyClassifier-343"><a href="#LazyClassifier-343"><span class="linenos">343</span></a>                                <span class="p">),</span>
</span><span id="LazyClassifier-344"><a href="#LazyClassifier-344"><span class="linenos">344</span></a>                            <span class="p">]</span>
</span><span id="LazyClassifier-345"><a href="#LazyClassifier-345"><span class="linenos">345</span></a>                        <span class="p">)</span>
</span><span id="LazyClassifier-346"><a href="#LazyClassifier-346"><span class="linenos">346</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier-347"><a href="#LazyClassifier-347"><span class="linenos">347</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyClassifier-348"><a href="#LazyClassifier-348"><span class="linenos">348</span></a>                            <span class="p">[</span>
</span><span id="LazyClassifier-349"><a href="#LazyClassifier-349"><span class="linenos">349</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyClassifier-350"><a href="#LazyClassifier-350"><span class="linenos">350</span></a>                                <span class="p">(</span>
</span><span id="LazyClassifier-351"><a href="#LazyClassifier-351"><span class="linenos">351</span></a>                                    <span class="s2">&quot;classifier&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier-352"><a href="#LazyClassifier-352"><span class="linenos">352</span></a>                                    <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyClassifier-353"><a href="#LazyClassifier-353"><span class="linenos">353</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">other_args</span><span class="p">),</span>
</span><span id="LazyClassifier-354"><a href="#LazyClassifier-354"><span class="linenos">354</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier-355"><a href="#LazyClassifier-355"><span class="linenos">355</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier-356"><a href="#LazyClassifier-356"><span class="linenos">356</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier-357"><a href="#LazyClassifier-357"><span class="linenos">357</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier-358"><a href="#LazyClassifier-358"><span class="linenos">358</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier-359"><a href="#LazyClassifier-359"><span class="linenos">359</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier-360"><a href="#LazyClassifier-360"><span class="linenos">360</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier-361"><a href="#LazyClassifier-361"><span class="linenos">361</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier-362"><a href="#LazyClassifier-362"><span class="linenos">362</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier-363"><a href="#LazyClassifier-363"><span class="linenos">363</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier-364"><a href="#LazyClassifier-364"><span class="linenos">364</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier-365"><a href="#LazyClassifier-365"><span class="linenos">365</span></a>                                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-366"><a href="#LazyClassifier-366"><span class="linenos">366</span></a>                                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-367"><a href="#LazyClassifier-367"><span class="linenos">367</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier-368"><a href="#LazyClassifier-368"><span class="linenos">368</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier-369"><a href="#LazyClassifier-369"><span class="linenos">369</span></a>                                    <span class="p">),</span>
</span><span id="LazyClassifier-370"><a href="#LazyClassifier-370"><span class="linenos">370</span></a>                                <span class="p">),</span>
</span><span id="LazyClassifier-371"><a href="#LazyClassifier-371"><span class="linenos">371</span></a>                            <span class="p">]</span>
</span><span id="LazyClassifier-372"><a href="#LazyClassifier-372"><span class="linenos">372</span></a>                        <span class="p">)</span>
</span><span id="LazyClassifier-373"><a href="#LazyClassifier-373"><span class="linenos">373</span></a>
</span><span id="LazyClassifier-374"><a href="#LazyClassifier-374"><span class="linenos">374</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyClassifier-375"><a href="#LazyClassifier-375"><span class="linenos">375</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyClassifier-376"><a href="#LazyClassifier-376"><span class="linenos">376</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyClassifier-377"><a href="#LazyClassifier-377"><span class="linenos">377</span></a>                    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="LazyClassifier-378"><a href="#LazyClassifier-378"><span class="linenos">378</span></a>                    <span class="n">b_accuracy</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier-379"><a href="#LazyClassifier-379"><span class="linenos">379</span></a>                    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
</span><span id="LazyClassifier-380"><a href="#LazyClassifier-380"><span class="linenos">380</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier-381"><a href="#LazyClassifier-381"><span class="linenos">381</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier-382"><a href="#LazyClassifier-382"><span class="linenos">382</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier-383"><a href="#LazyClassifier-383"><span class="linenos">383</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LazyClassifier-384"><a href="#LazyClassifier-384"><span class="linenos">384</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyClassifier-385"><a href="#LazyClassifier-385"><span class="linenos">385</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROC AUC couldn&#39;t be calculated for &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
</span><span id="LazyClassifier-386"><a href="#LazyClassifier-386"><span class="linenos">386</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyClassifier-387"><a href="#LazyClassifier-387"><span class="linenos">387</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyClassifier-388"><a href="#LazyClassifier-388"><span class="linenos">388</span></a>                    <span class="n">Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</span><span id="LazyClassifier-389"><a href="#LazyClassifier-389"><span class="linenos">389</span></a>                    <span class="n">B_Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_accuracy</span><span class="p">)</span>
</span><span id="LazyClassifier-390"><a href="#LazyClassifier-390"><span class="linenos">390</span></a>                    <span class="n">ROC_AUC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">)</span>
</span><span id="LazyClassifier-391"><a href="#LazyClassifier-391"><span class="linenos">391</span></a>                    <span class="n">F1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="LazyClassifier-392"><a href="#LazyClassifier-392"><span class="linenos">392</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyClassifier-393"><a href="#LazyClassifier-393"><span class="linenos">393</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier-394"><a href="#LazyClassifier-394"><span class="linenos">394</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier-395"><a href="#LazyClassifier-395"><span class="linenos">395</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyClassifier-396"><a href="#LazyClassifier-396"><span class="linenos">396</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyClassifier-397"><a href="#LazyClassifier-397"><span class="linenos">397</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier-398"><a href="#LazyClassifier-398"><span class="linenos">398</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyClassifier-399"><a href="#LazyClassifier-399"><span class="linenos">399</span></a>                                <span class="p">{</span>
</span><span id="LazyClassifier-400"><a href="#LazyClassifier-400"><span class="linenos">400</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyClassifier-401"><a href="#LazyClassifier-401"><span class="linenos">401</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-402"><a href="#LazyClassifier-402"><span class="linenos">402</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-403"><a href="#LazyClassifier-403"><span class="linenos">403</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyClassifier-404"><a href="#LazyClassifier-404"><span class="linenos">404</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyClassifier-405"><a href="#LazyClassifier-405"><span class="linenos">405</span></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">custom_metric</span><span class="p">,</span>
</span><span id="LazyClassifier-406"><a href="#LazyClassifier-406"><span class="linenos">406</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyClassifier-407"><a href="#LazyClassifier-407"><span class="linenos">407</span></a>                                <span class="p">}</span>
</span><span id="LazyClassifier-408"><a href="#LazyClassifier-408"><span class="linenos">408</span></a>                            <span class="p">)</span>
</span><span id="LazyClassifier-409"><a href="#LazyClassifier-409"><span class="linenos">409</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier-410"><a href="#LazyClassifier-410"><span class="linenos">410</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyClassifier-411"><a href="#LazyClassifier-411"><span class="linenos">411</span></a>                                <span class="p">{</span>
</span><span id="LazyClassifier-412"><a href="#LazyClassifier-412"><span class="linenos">412</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyClassifier-413"><a href="#LazyClassifier-413"><span class="linenos">413</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-414"><a href="#LazyClassifier-414"><span class="linenos">414</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-415"><a href="#LazyClassifier-415"><span class="linenos">415</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyClassifier-416"><a href="#LazyClassifier-416"><span class="linenos">416</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyClassifier-417"><a href="#LazyClassifier-417"><span class="linenos">417</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyClassifier-418"><a href="#LazyClassifier-418"><span class="linenos">418</span></a>                                <span class="p">}</span>
</span><span id="LazyClassifier-419"><a href="#LazyClassifier-419"><span class="linenos">419</span></a>                            <span class="p">)</span>
</span><span id="LazyClassifier-420"><a href="#LazyClassifier-420"><span class="linenos">420</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyClassifier-421"><a href="#LazyClassifier-421"><span class="linenos">421</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyClassifier-422"><a href="#LazyClassifier-422"><span class="linenos">422</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier-423"><a href="#LazyClassifier-423"><span class="linenos">423</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyClassifier-424"><a href="#LazyClassifier-424"><span class="linenos">424</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyClassifier-425"><a href="#LazyClassifier-425"><span class="linenos">425</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyClassifier-426"><a href="#LazyClassifier-426"><span class="linenos">426</span></a>                <span class="k">finally</span><span class="p">:</span>
</span><span id="LazyClassifier-427"><a href="#LazyClassifier-427"><span class="linenos">427</span></a>                    <span class="k">continue</span>
</span><span id="LazyClassifier-428"><a href="#LazyClassifier-428"><span class="linenos">428</span></a>
</span><span id="LazyClassifier-429"><a href="#LazyClassifier-429"><span class="linenos">429</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if self.preprocess is True:</span>
</span><span id="LazyClassifier-430"><a href="#LazyClassifier-430"><span class="linenos">430</span></a>
</span><span id="LazyClassifier-431"><a href="#LazyClassifier-431"><span class="linenos">431</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyClassifier-432"><a href="#LazyClassifier-432"><span class="linenos">432</span></a>                <span class="n">other_args</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyClassifier-433"><a href="#LazyClassifier-433"><span class="linenos">433</span></a>                    <span class="p">{}</span>
</span><span id="LazyClassifier-434"><a href="#LazyClassifier-434"><span class="linenos">434</span></a>                <span class="p">)</span>  <span class="c1"># use this trick for `random_state` too --&gt; refactor</span>
</span><span id="LazyClassifier-435"><a href="#LazyClassifier-435"><span class="linenos">435</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier-436"><a href="#LazyClassifier-436"><span class="linenos">436</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier-437"><a href="#LazyClassifier-437"><span class="linenos">437</span></a>                        <span class="s2">&quot;n_jobs&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="LazyClassifier-438"><a href="#LazyClassifier-438"><span class="linenos">438</span></a>                        <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;LogisticRegression&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="LazyClassifier-439"><a href="#LazyClassifier-439"><span class="linenos">439</span></a>                    <span class="p">):</span>
</span><span id="LazyClassifier-440"><a href="#LazyClassifier-440"><span class="linenos">440</span></a>                        <span class="n">other_args</span><span class="p">[</span><span class="s2">&quot;n_jobs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span>
</span><span id="LazyClassifier-441"><a href="#LazyClassifier-441"><span class="linenos">441</span></a>                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="LazyClassifier-442"><a href="#LazyClassifier-442"><span class="linenos">442</span></a>                    <span class="k">pass</span>
</span><span id="LazyClassifier-443"><a href="#LazyClassifier-443"><span class="linenos">443</span></a>
</span><span id="LazyClassifier-444"><a href="#LazyClassifier-444"><span class="linenos">444</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyClassifier-445"><a href="#LazyClassifier-445"><span class="linenos">445</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier-446"><a href="#LazyClassifier-446"><span class="linenos">446</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyClassifier-447"><a href="#LazyClassifier-447"><span class="linenos">447</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyClassifier-448"><a href="#LazyClassifier-448"><span class="linenos">448</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyClassifier-449"><a href="#LazyClassifier-449"><span class="linenos">449</span></a>                                <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span> <span class="o">**</span><span class="n">other_args</span>
</span><span id="LazyClassifier-450"><a href="#LazyClassifier-450"><span class="linenos">450</span></a>                            <span class="p">),</span>
</span><span id="LazyClassifier-451"><a href="#LazyClassifier-451"><span class="linenos">451</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier-452"><a href="#LazyClassifier-452"><span class="linenos">452</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier-453"><a href="#LazyClassifier-453"><span class="linenos">453</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier-454"><a href="#LazyClassifier-454"><span class="linenos">454</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier-455"><a href="#LazyClassifier-455"><span class="linenos">455</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier-456"><a href="#LazyClassifier-456"><span class="linenos">456</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier-457"><a href="#LazyClassifier-457"><span class="linenos">457</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier-458"><a href="#LazyClassifier-458"><span class="linenos">458</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier-459"><a href="#LazyClassifier-459"><span class="linenos">459</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier-460"><a href="#LazyClassifier-460"><span class="linenos">460</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier-461"><a href="#LazyClassifier-461"><span class="linenos">461</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier-462"><a href="#LazyClassifier-462"><span class="linenos">462</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-463"><a href="#LazyClassifier-463"><span class="linenos">463</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-464"><a href="#LazyClassifier-464"><span class="linenos">464</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier-465"><a href="#LazyClassifier-465"><span class="linenos">465</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier-466"><a href="#LazyClassifier-466"><span class="linenos">466</span></a>                        <span class="p">)</span>
</span><span id="LazyClassifier-467"><a href="#LazyClassifier-467"><span class="linenos">467</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier-468"><a href="#LazyClassifier-468"><span class="linenos">468</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyClassifier-469"><a href="#LazyClassifier-469"><span class="linenos">469</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">other_args</span><span class="p">),</span>
</span><span id="LazyClassifier-470"><a href="#LazyClassifier-470"><span class="linenos">470</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier-471"><a href="#LazyClassifier-471"><span class="linenos">471</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier-472"><a href="#LazyClassifier-472"><span class="linenos">472</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier-473"><a href="#LazyClassifier-473"><span class="linenos">473</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier-474"><a href="#LazyClassifier-474"><span class="linenos">474</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier-475"><a href="#LazyClassifier-475"><span class="linenos">475</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier-476"><a href="#LazyClassifier-476"><span class="linenos">476</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier-477"><a href="#LazyClassifier-477"><span class="linenos">477</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier-478"><a href="#LazyClassifier-478"><span class="linenos">478</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier-479"><a href="#LazyClassifier-479"><span class="linenos">479</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier-480"><a href="#LazyClassifier-480"><span class="linenos">480</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier-481"><a href="#LazyClassifier-481"><span class="linenos">481</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-482"><a href="#LazyClassifier-482"><span class="linenos">482</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier-483"><a href="#LazyClassifier-483"><span class="linenos">483</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier-484"><a href="#LazyClassifier-484"><span class="linenos">484</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier-485"><a href="#LazyClassifier-485"><span class="linenos">485</span></a>                        <span class="p">)</span>
</span><span id="LazyClassifier-486"><a href="#LazyClassifier-486"><span class="linenos">486</span></a>
</span><span id="LazyClassifier-487"><a href="#LazyClassifier-487"><span class="linenos">487</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyClassifier-488"><a href="#LazyClassifier-488"><span class="linenos">488</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyClassifier-489"><a href="#LazyClassifier-489"><span class="linenos">489</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyClassifier-490"><a href="#LazyClassifier-490"><span class="linenos">490</span></a>                    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="LazyClassifier-491"><a href="#LazyClassifier-491"><span class="linenos">491</span></a>                    <span class="n">b_accuracy</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier-492"><a href="#LazyClassifier-492"><span class="linenos">492</span></a>                    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
</span><span id="LazyClassifier-493"><a href="#LazyClassifier-493"><span class="linenos">493</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier-494"><a href="#LazyClassifier-494"><span class="linenos">494</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier-495"><a href="#LazyClassifier-495"><span class="linenos">495</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier-496"><a href="#LazyClassifier-496"><span class="linenos">496</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LazyClassifier-497"><a href="#LazyClassifier-497"><span class="linenos">497</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyClassifier-498"><a href="#LazyClassifier-498"><span class="linenos">498</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROC AUC couldn&#39;t be calculated for &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
</span><span id="LazyClassifier-499"><a href="#LazyClassifier-499"><span class="linenos">499</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyClassifier-500"><a href="#LazyClassifier-500"><span class="linenos">500</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyClassifier-501"><a href="#LazyClassifier-501"><span class="linenos">501</span></a>                    <span class="n">Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</span><span id="LazyClassifier-502"><a href="#LazyClassifier-502"><span class="linenos">502</span></a>                    <span class="n">B_Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_accuracy</span><span class="p">)</span>
</span><span id="LazyClassifier-503"><a href="#LazyClassifier-503"><span class="linenos">503</span></a>                    <span class="n">ROC_AUC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">)</span>
</span><span id="LazyClassifier-504"><a href="#LazyClassifier-504"><span class="linenos">504</span></a>                    <span class="n">F1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="LazyClassifier-505"><a href="#LazyClassifier-505"><span class="linenos">505</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyClassifier-506"><a href="#LazyClassifier-506"><span class="linenos">506</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier-507"><a href="#LazyClassifier-507"><span class="linenos">507</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier-508"><a href="#LazyClassifier-508"><span class="linenos">508</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyClassifier-509"><a href="#LazyClassifier-509"><span class="linenos">509</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyClassifier-510"><a href="#LazyClassifier-510"><span class="linenos">510</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier-511"><a href="#LazyClassifier-511"><span class="linenos">511</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyClassifier-512"><a href="#LazyClassifier-512"><span class="linenos">512</span></a>                                <span class="p">{</span>
</span><span id="LazyClassifier-513"><a href="#LazyClassifier-513"><span class="linenos">513</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyClassifier-514"><a href="#LazyClassifier-514"><span class="linenos">514</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-515"><a href="#LazyClassifier-515"><span class="linenos">515</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-516"><a href="#LazyClassifier-516"><span class="linenos">516</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyClassifier-517"><a href="#LazyClassifier-517"><span class="linenos">517</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyClassifier-518"><a href="#LazyClassifier-518"><span class="linenos">518</span></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">custom_metric</span><span class="p">,</span>
</span><span id="LazyClassifier-519"><a href="#LazyClassifier-519"><span class="linenos">519</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyClassifier-520"><a href="#LazyClassifier-520"><span class="linenos">520</span></a>                                <span class="p">}</span>
</span><span id="LazyClassifier-521"><a href="#LazyClassifier-521"><span class="linenos">521</span></a>                            <span class="p">)</span>
</span><span id="LazyClassifier-522"><a href="#LazyClassifier-522"><span class="linenos">522</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier-523"><a href="#LazyClassifier-523"><span class="linenos">523</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyClassifier-524"><a href="#LazyClassifier-524"><span class="linenos">524</span></a>                                <span class="p">{</span>
</span><span id="LazyClassifier-525"><a href="#LazyClassifier-525"><span class="linenos">525</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyClassifier-526"><a href="#LazyClassifier-526"><span class="linenos">526</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-527"><a href="#LazyClassifier-527"><span class="linenos">527</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-528"><a href="#LazyClassifier-528"><span class="linenos">528</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyClassifier-529"><a href="#LazyClassifier-529"><span class="linenos">529</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyClassifier-530"><a href="#LazyClassifier-530"><span class="linenos">530</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyClassifier-531"><a href="#LazyClassifier-531"><span class="linenos">531</span></a>                                <span class="p">}</span>
</span><span id="LazyClassifier-532"><a href="#LazyClassifier-532"><span class="linenos">532</span></a>                            <span class="p">)</span>
</span><span id="LazyClassifier-533"><a href="#LazyClassifier-533"><span class="linenos">533</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyClassifier-534"><a href="#LazyClassifier-534"><span class="linenos">534</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyClassifier-535"><a href="#LazyClassifier-535"><span class="linenos">535</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier-536"><a href="#LazyClassifier-536"><span class="linenos">536</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyClassifier-537"><a href="#LazyClassifier-537"><span class="linenos">537</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyClassifier-538"><a href="#LazyClassifier-538"><span class="linenos">538</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyClassifier-539"><a href="#LazyClassifier-539"><span class="linenos">539</span></a>                <span class="k">finally</span><span class="p">:</span>
</span><span id="LazyClassifier-540"><a href="#LazyClassifier-540"><span class="linenos">540</span></a>                    <span class="k">continue</span>
</span><span id="LazyClassifier-541"><a href="#LazyClassifier-541"><span class="linenos">541</span></a>
</span><span id="LazyClassifier-542"><a href="#LazyClassifier-542"><span class="linenos">542</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier-543"><a href="#LazyClassifier-543"><span class="linenos">543</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="LazyClassifier-544"><a href="#LazyClassifier-544"><span class="linenos">544</span></a>                <span class="p">{</span>
</span><span id="LazyClassifier-545"><a href="#LazyClassifier-545"><span class="linenos">545</span></a>                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyClassifier-546"><a href="#LazyClassifier-546"><span class="linenos">546</span></a>                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-547"><a href="#LazyClassifier-547"><span class="linenos">547</span></a>                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">B_Accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-548"><a href="#LazyClassifier-548"><span class="linenos">548</span></a>                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">ROC_AUC</span><span class="p">,</span>
</span><span id="LazyClassifier-549"><a href="#LazyClassifier-549"><span class="linenos">549</span></a>                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span>
</span><span id="LazyClassifier-550"><a href="#LazyClassifier-550"><span class="linenos">550</span></a>                    <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyClassifier-551"><a href="#LazyClassifier-551"><span class="linenos">551</span></a>                <span class="p">}</span>
</span><span id="LazyClassifier-552"><a href="#LazyClassifier-552"><span class="linenos">552</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier-553"><a href="#LazyClassifier-553"><span class="linenos">553</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier-554"><a href="#LazyClassifier-554"><span class="linenos">554</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="LazyClassifier-555"><a href="#LazyClassifier-555"><span class="linenos">555</span></a>                <span class="p">{</span>
</span><span id="LazyClassifier-556"><a href="#LazyClassifier-556"><span class="linenos">556</span></a>                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyClassifier-557"><a href="#LazyClassifier-557"><span class="linenos">557</span></a>                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-558"><a href="#LazyClassifier-558"><span class="linenos">558</span></a>                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">B_Accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier-559"><a href="#LazyClassifier-559"><span class="linenos">559</span></a>                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">ROC_AUC</span><span class="p">,</span>
</span><span id="LazyClassifier-560"><a href="#LazyClassifier-560"><span class="linenos">560</span></a>                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span>
</span><span id="LazyClassifier-561"><a href="#LazyClassifier-561"><span class="linenos">561</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">CUSTOM_METRIC</span><span class="p">,</span>
</span><span id="LazyClassifier-562"><a href="#LazyClassifier-562"><span class="linenos">562</span></a>                    <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyClassifier-563"><a href="#LazyClassifier-563"><span class="linenos">563</span></a>                <span class="p">}</span>
</span><span id="LazyClassifier-564"><a href="#LazyClassifier-564"><span class="linenos">564</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier-565"><a href="#LazyClassifier-565"><span class="linenos">565</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_by</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyClassifier-566"><a href="#LazyClassifier-566"><span class="linenos">566</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyClassifier-567"><a href="#LazyClassifier-567"><span class="linenos">567</span></a>        <span class="p">)</span>
</span><span id="LazyClassifier-568"><a href="#LazyClassifier-568"><span class="linenos">568</span></a>
</span><span id="LazyClassifier-569"><a href="#LazyClassifier-569"><span class="linenos">569</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyClassifier-570"><a href="#LazyClassifier-570"><span class="linenos">570</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyClassifier-571"><a href="#LazyClassifier-571"><span class="linenos">571</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span><span id="LazyClassifier-572"><a href="#LazyClassifier-572"><span class="linenos">572</span></a>
</span><span id="LazyClassifier-573"><a href="#LazyClassifier-573"><span class="linenos">573</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyClassifier-574"><a href="#LazyClassifier-574"><span class="linenos">574</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all the model objects trained. If fit hasn&#39;t been called yet,</span>
</span><span id="LazyClassifier-575"><a href="#LazyClassifier-575"><span class="linenos">575</span></a><span class="sd">        then it&#39;s called to return the models.</span>
</span><span id="LazyClassifier-576"><a href="#LazyClassifier-576"><span class="linenos">576</span></a>
</span><span id="LazyClassifier-577"><a href="#LazyClassifier-577"><span class="linenos">577</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyClassifier-578"><a href="#LazyClassifier-578"><span class="linenos">578</span></a>
</span><span id="LazyClassifier-579"><a href="#LazyClassifier-579"><span class="linenos">579</span></a><span class="sd">        X_train: array-like,</span>
</span><span id="LazyClassifier-580"><a href="#LazyClassifier-580"><span class="linenos">580</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier-581"><a href="#LazyClassifier-581"><span class="linenos">581</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyClassifier-582"><a href="#LazyClassifier-582"><span class="linenos">582</span></a>
</span><span id="LazyClassifier-583"><a href="#LazyClassifier-583"><span class="linenos">583</span></a><span class="sd">        X_test: array-like,</span>
</span><span id="LazyClassifier-584"><a href="#LazyClassifier-584"><span class="linenos">584</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier-585"><a href="#LazyClassifier-585"><span class="linenos">585</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyClassifier-586"><a href="#LazyClassifier-586"><span class="linenos">586</span></a>
</span><span id="LazyClassifier-587"><a href="#LazyClassifier-587"><span class="linenos">587</span></a><span class="sd">        y_train: array-like,</span>
</span><span id="LazyClassifier-588"><a href="#LazyClassifier-588"><span class="linenos">588</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier-589"><a href="#LazyClassifier-589"><span class="linenos">589</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyClassifier-590"><a href="#LazyClassifier-590"><span class="linenos">590</span></a>
</span><span id="LazyClassifier-591"><a href="#LazyClassifier-591"><span class="linenos">591</span></a><span class="sd">        y_test: array-like,</span>
</span><span id="LazyClassifier-592"><a href="#LazyClassifier-592"><span class="linenos">592</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier-593"><a href="#LazyClassifier-593"><span class="linenos">593</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyClassifier-594"><a href="#LazyClassifier-594"><span class="linenos">594</span></a>
</span><span id="LazyClassifier-595"><a href="#LazyClassifier-595"><span class="linenos">595</span></a><span class="sd">        Returns:</span>
</span><span id="LazyClassifier-596"><a href="#LazyClassifier-596"><span class="linenos">596</span></a>
</span><span id="LazyClassifier-597"><a href="#LazyClassifier-597"><span class="linenos">597</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyClassifier-598"><a href="#LazyClassifier-598"><span class="linenos">598</span></a><span class="sd">                Returns a dictionary with each model&#39;s pipeline as value</span>
</span><span id="LazyClassifier-599"><a href="#LazyClassifier-599"><span class="linenos">599</span></a><span class="sd">                and key = name of the model.</span>
</span><span id="LazyClassifier-600"><a href="#LazyClassifier-600"><span class="linenos">600</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyClassifier-601"><a href="#LazyClassifier-601"><span class="linenos">601</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyClassifier-602"><a href="#LazyClassifier-602"><span class="linenos">602</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span><span id="LazyClassifier-603"><a href="#LazyClassifier-603"><span class="linenos">603</span></a>
</span><span id="LazyClassifier-604"><a href="#LazyClassifier-604"><span class="linenos">604</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>Fitting -- almost -- all the classification algorithms with nnetsauce's
    CustomClassifier and returning their scores.</p>

<p>Parameters:</p>

<pre><code>verbose: int, optional (default=0)
    Any positive number for verbosity.

ignore_warnings: bool, optional (default=True)
    When set to True, warnings related to algorithms that were not
    run are ignored.

custom_metric: function, optional (default=None)
    When function is provided, models are evaluated based on the
    custom evaluation metric provided.

predictions: bool, optional (default=False)
    When set to True, the predictions of all the models models are
    returned as data frame.

sort_by: string, optional (default='Accuracy')
    Sort models by a metric. Available options are 'Accuracy',
    'Balanced Accuracy', 'ROC AUC', 'F1 Score' or a custom metric
    identified by its name and provided by custom_metric.

random_state: int, optional (default=42)
    Reproducibiility seed.

estimators: list, optional (default='all')
    list of Estimators names or just 'all' for &gt; 90
    classifiers (default='all')

preprocess: bool, preprocessing is done when set to True

n_jobs: int, when possible, run in parallel
    For now, only used by individual models that support it.

All the other parameters are the same as CustomClassifier's.
</code></pre>

<p>Examples:
    <div class="pdoc-code codehilite">
    <pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
    <span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
    <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>
    <span class="n">y</span><span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">target</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">LazyClassifier</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">models</span><span class="p">,</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="n">model_dictionary</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">provide_models</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">models</span><span class="p">)</span>
    </code></pre>
    </div></p>
</div>


                                <div id="LazyClassifier.fit" class="classattr">
                                            <input id="LazyClassifier.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">y_train</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyClassifier.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyClassifier.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyClassifier.fit-186"><a href="#LazyClassifier.fit-186"><span class="linenos">186</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyClassifier.fit-187"><a href="#LazyClassifier.fit-187"><span class="linenos">187</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit classifiers to X_train and y_train, predict and score on X_test,</span>
</span><span id="LazyClassifier.fit-188"><a href="#LazyClassifier.fit-188"><span class="linenos">188</span></a><span class="sd">        y_test.</span>
</span><span id="LazyClassifier.fit-189"><a href="#LazyClassifier.fit-189"><span class="linenos">189</span></a>
</span><span id="LazyClassifier.fit-190"><a href="#LazyClassifier.fit-190"><span class="linenos">190</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyClassifier.fit-191"><a href="#LazyClassifier.fit-191"><span class="linenos">191</span></a>
</span><span id="LazyClassifier.fit-192"><a href="#LazyClassifier.fit-192"><span class="linenos">192</span></a><span class="sd">            X_train: array-like,</span>
</span><span id="LazyClassifier.fit-193"><a href="#LazyClassifier.fit-193"><span class="linenos">193</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier.fit-194"><a href="#LazyClassifier.fit-194"><span class="linenos">194</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyClassifier.fit-195"><a href="#LazyClassifier.fit-195"><span class="linenos">195</span></a>
</span><span id="LazyClassifier.fit-196"><a href="#LazyClassifier.fit-196"><span class="linenos">196</span></a><span class="sd">            X_test: array-like,</span>
</span><span id="LazyClassifier.fit-197"><a href="#LazyClassifier.fit-197"><span class="linenos">197</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier.fit-198"><a href="#LazyClassifier.fit-198"><span class="linenos">198</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyClassifier.fit-199"><a href="#LazyClassifier.fit-199"><span class="linenos">199</span></a>
</span><span id="LazyClassifier.fit-200"><a href="#LazyClassifier.fit-200"><span class="linenos">200</span></a><span class="sd">            y_train: array-like,</span>
</span><span id="LazyClassifier.fit-201"><a href="#LazyClassifier.fit-201"><span class="linenos">201</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier.fit-202"><a href="#LazyClassifier.fit-202"><span class="linenos">202</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyClassifier.fit-203"><a href="#LazyClassifier.fit-203"><span class="linenos">203</span></a>
</span><span id="LazyClassifier.fit-204"><a href="#LazyClassifier.fit-204"><span class="linenos">204</span></a><span class="sd">            y_test: array-like,</span>
</span><span id="LazyClassifier.fit-205"><a href="#LazyClassifier.fit-205"><span class="linenos">205</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier.fit-206"><a href="#LazyClassifier.fit-206"><span class="linenos">206</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyClassifier.fit-207"><a href="#LazyClassifier.fit-207"><span class="linenos">207</span></a>
</span><span id="LazyClassifier.fit-208"><a href="#LazyClassifier.fit-208"><span class="linenos">208</span></a><span class="sd">        Returns:</span>
</span><span id="LazyClassifier.fit-209"><a href="#LazyClassifier.fit-209"><span class="linenos">209</span></a>
</span><span id="LazyClassifier.fit-210"><a href="#LazyClassifier.fit-210"><span class="linenos">210</span></a><span class="sd">            scores: Pandas DataFrame</span>
</span><span id="LazyClassifier.fit-211"><a href="#LazyClassifier.fit-211"><span class="linenos">211</span></a><span class="sd">                Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyClassifier.fit-212"><a href="#LazyClassifier.fit-212"><span class="linenos">212</span></a>
</span><span id="LazyClassifier.fit-213"><a href="#LazyClassifier.fit-213"><span class="linenos">213</span></a><span class="sd">            predictions: Pandas DataFrame</span>
</span><span id="LazyClassifier.fit-214"><a href="#LazyClassifier.fit-214"><span class="linenos">214</span></a><span class="sd">                Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyClassifier.fit-215"><a href="#LazyClassifier.fit-215"><span class="linenos">215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyClassifier.fit-216"><a href="#LazyClassifier.fit-216"><span class="linenos">216</span></a>        <span class="n">Accuracy</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier.fit-217"><a href="#LazyClassifier.fit-217"><span class="linenos">217</span></a>        <span class="n">B_Accuracy</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier.fit-218"><a href="#LazyClassifier.fit-218"><span class="linenos">218</span></a>        <span class="n">ROC_AUC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier.fit-219"><a href="#LazyClassifier.fit-219"><span class="linenos">219</span></a>        <span class="n">F1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier.fit-220"><a href="#LazyClassifier.fit-220"><span class="linenos">220</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier.fit-221"><a href="#LazyClassifier.fit-221"><span class="linenos">221</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier.fit-222"><a href="#LazyClassifier.fit-222"><span class="linenos">222</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyClassifier.fit-223"><a href="#LazyClassifier.fit-223"><span class="linenos">223</span></a>
</span><span id="LazyClassifier.fit-224"><a href="#LazyClassifier.fit-224"><span class="linenos">224</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-225"><a href="#LazyClassifier.fit-225"><span class="linenos">225</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyClassifier.fit-226"><a href="#LazyClassifier.fit-226"><span class="linenos">226</span></a>
</span><span id="LazyClassifier.fit-227"><a href="#LazyClassifier.fit-227"><span class="linenos">227</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyClassifier.fit-228"><a href="#LazyClassifier.fit-228"><span class="linenos">228</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-229"><a href="#LazyClassifier.fit-229"><span class="linenos">229</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-230"><a href="#LazyClassifier.fit-230"><span class="linenos">230</span></a>
</span><span id="LazyClassifier.fit-231"><a href="#LazyClassifier.fit-231"><span class="linenos">231</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyClassifier.fit-232"><a href="#LazyClassifier.fit-232"><span class="linenos">232</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyClassifier.fit-233"><a href="#LazyClassifier.fit-233"><span class="linenos">233</span></a>
</span><span id="LazyClassifier.fit-234"><a href="#LazyClassifier.fit-234"><span class="linenos">234</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-235"><a href="#LazyClassifier.fit-235"><span class="linenos">235</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyClassifier.fit-236"><a href="#LazyClassifier.fit-236"><span class="linenos">236</span></a>        <span class="p">)</span>
</span><span id="LazyClassifier.fit-237"><a href="#LazyClassifier.fit-237"><span class="linenos">237</span></a>
</span><span id="LazyClassifier.fit-238"><a href="#LazyClassifier.fit-238"><span class="linenos">238</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-239"><a href="#LazyClassifier.fit-239"><span class="linenos">239</span></a>
</span><span id="LazyClassifier.fit-240"><a href="#LazyClassifier.fit-240"><span class="linenos">240</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-241"><a href="#LazyClassifier.fit-241"><span class="linenos">241</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyClassifier.fit-242"><a href="#LazyClassifier.fit-242"><span class="linenos">242</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyClassifier.fit-243"><a href="#LazyClassifier.fit-243"><span class="linenos">243</span></a>                    <span class="p">(</span>
</span><span id="LazyClassifier.fit-244"><a href="#LazyClassifier.fit-244"><span class="linenos">244</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-245"><a href="#LazyClassifier.fit-245"><span class="linenos">245</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-246"><a href="#LazyClassifier.fit-246"><span class="linenos">246</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-247"><a href="#LazyClassifier.fit-247"><span class="linenos">247</span></a>                    <span class="p">),</span>
</span><span id="LazyClassifier.fit-248"><a href="#LazyClassifier.fit-248"><span class="linenos">248</span></a>                    <span class="p">(</span>
</span><span id="LazyClassifier.fit-249"><a href="#LazyClassifier.fit-249"><span class="linenos">249</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-250"><a href="#LazyClassifier.fit-250"><span class="linenos">250</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-251"><a href="#LazyClassifier.fit-251"><span class="linenos">251</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-252"><a href="#LazyClassifier.fit-252"><span class="linenos">252</span></a>                    <span class="p">),</span>
</span><span id="LazyClassifier.fit-253"><a href="#LazyClassifier.fit-253"><span class="linenos">253</span></a>                <span class="p">]</span>
</span><span id="LazyClassifier.fit-254"><a href="#LazyClassifier.fit-254"><span class="linenos">254</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier.fit-255"><a href="#LazyClassifier.fit-255"><span class="linenos">255</span></a>
</span><span id="LazyClassifier.fit-256"><a href="#LazyClassifier.fit-256"><span class="linenos">256</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-257"><a href="#LazyClassifier.fit-257"><span class="linenos">257</span></a>
</span><span id="LazyClassifier.fit-258"><a href="#LazyClassifier.fit-258"><span class="linenos">258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-259"><a href="#LazyClassifier.fit-259"><span class="linenos">259</span></a>                <span class="n">CLASSIFIERS</span> <span class="o">+</span> <span class="n">MULTITASKCLASSIFIERS</span> <span class="o">+</span> <span class="n">SIMPLEMULTITASKCLASSIFIERS</span>
</span><span id="LazyClassifier.fit-260"><a href="#LazyClassifier.fit-260"><span class="linenos">260</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier.fit-261"><a href="#LazyClassifier.fit-261"><span class="linenos">261</span></a>
</span><span id="LazyClassifier.fit-262"><a href="#LazyClassifier.fit-262"><span class="linenos">262</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># list custom estimators, by their names</span>
</span><span id="LazyClassifier.fit-263"><a href="#LazyClassifier.fit-263"><span class="linenos">263</span></a>
</span><span id="LazyClassifier.fit-264"><a href="#LazyClassifier.fit-264"><span class="linenos">264</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-265"><a href="#LazyClassifier.fit-265"><span class="linenos">265</span></a>                <span class="p">[</span>
</span><span id="LazyClassifier.fit-266"><a href="#LazyClassifier.fit-266"><span class="linenos">266</span></a>                    <span class="p">(</span><span class="s2">&quot;CustomClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyClassifier.fit-267"><a href="#LazyClassifier.fit-267"><span class="linenos">267</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyClassifier.fit-268"><a href="#LazyClassifier.fit-268"><span class="linenos">268</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-269"><a href="#LazyClassifier.fit-269"><span class="linenos">269</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ClassifierMixin</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-270"><a href="#LazyClassifier.fit-270"><span class="linenos">270</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-271"><a href="#LazyClassifier.fit-271"><span class="linenos">271</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier.fit-272"><a href="#LazyClassifier.fit-272"><span class="linenos">272</span></a>                <span class="p">]</span>
</span><span id="LazyClassifier.fit-273"><a href="#LazyClassifier.fit-273"><span class="linenos">273</span></a>                <span class="o">+</span> <span class="p">[</span>
</span><span id="LazyClassifier.fit-274"><a href="#LazyClassifier.fit-274"><span class="linenos">274</span></a>                    <span class="p">(</span>
</span><span id="LazyClassifier.fit-275"><a href="#LazyClassifier.fit-275"><span class="linenos">275</span></a>                        <span class="s2">&quot;MultitaskClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-276"><a href="#LazyClassifier.fit-276"><span class="linenos">276</span></a>                        <span class="n">partial</span><span class="p">(</span><span class="n">MultitaskClassifier</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">]()),</span>
</span><span id="LazyClassifier.fit-277"><a href="#LazyClassifier.fit-277"><span class="linenos">277</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier.fit-278"><a href="#LazyClassifier.fit-278"><span class="linenos">278</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyClassifier.fit-279"><a href="#LazyClassifier.fit-279"><span class="linenos">279</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-280"><a href="#LazyClassifier.fit-280"><span class="linenos">280</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-281"><a href="#LazyClassifier.fit-281"><span class="linenos">281</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-282"><a href="#LazyClassifier.fit-282"><span class="linenos">282</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier.fit-283"><a href="#LazyClassifier.fit-283"><span class="linenos">283</span></a>                <span class="p">]</span>
</span><span id="LazyClassifier.fit-284"><a href="#LazyClassifier.fit-284"><span class="linenos">284</span></a>                <span class="o">+</span> <span class="p">[</span>
</span><span id="LazyClassifier.fit-285"><a href="#LazyClassifier.fit-285"><span class="linenos">285</span></a>                    <span class="p">(</span>
</span><span id="LazyClassifier.fit-286"><a href="#LazyClassifier.fit-286"><span class="linenos">286</span></a>                        <span class="s2">&quot;SimpleMultitaskClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-287"><a href="#LazyClassifier.fit-287"><span class="linenos">287</span></a>                        <span class="n">partial</span><span class="p">(</span><span class="n">SimpleMultitaskClassifier</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">]()),</span>
</span><span id="LazyClassifier.fit-288"><a href="#LazyClassifier.fit-288"><span class="linenos">288</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier.fit-289"><a href="#LazyClassifier.fit-289"><span class="linenos">289</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyClassifier.fit-290"><a href="#LazyClassifier.fit-290"><span class="linenos">290</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-291"><a href="#LazyClassifier.fit-291"><span class="linenos">291</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-292"><a href="#LazyClassifier.fit-292"><span class="linenos">292</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-293"><a href="#LazyClassifier.fit-293"><span class="linenos">293</span></a>                    <span class="p">)</span>
</span><span id="LazyClassifier.fit-294"><a href="#LazyClassifier.fit-294"><span class="linenos">294</span></a>                <span class="p">]</span>
</span><span id="LazyClassifier.fit-295"><a href="#LazyClassifier.fit-295"><span class="linenos">295</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier.fit-296"><a href="#LazyClassifier.fit-296"><span class="linenos">296</span></a>
</span><span id="LazyClassifier.fit-297"><a href="#LazyClassifier.fit-297"><span class="linenos">297</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-298"><a href="#LazyClassifier.fit-298"><span class="linenos">298</span></a>
</span><span id="LazyClassifier.fit-299"><a href="#LazyClassifier.fit-299"><span class="linenos">299</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyClassifier.fit-300"><a href="#LazyClassifier.fit-300"><span class="linenos">300</span></a>
</span><span id="LazyClassifier.fit-301"><a href="#LazyClassifier.fit-301"><span class="linenos">301</span></a>                <span class="n">other_args</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-302"><a href="#LazyClassifier.fit-302"><span class="linenos">302</span></a>                    <span class="p">{}</span>
</span><span id="LazyClassifier.fit-303"><a href="#LazyClassifier.fit-303"><span class="linenos">303</span></a>                <span class="p">)</span>  <span class="c1"># use this trick for `random_state` too --&gt; refactor</span>
</span><span id="LazyClassifier.fit-304"><a href="#LazyClassifier.fit-304"><span class="linenos">304</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-305"><a href="#LazyClassifier.fit-305"><span class="linenos">305</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-306"><a href="#LazyClassifier.fit-306"><span class="linenos">306</span></a>                        <span class="s2">&quot;n_jobs&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="LazyClassifier.fit-307"><a href="#LazyClassifier.fit-307"><span class="linenos">307</span></a>                        <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;LogisticRegression&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="LazyClassifier.fit-308"><a href="#LazyClassifier.fit-308"><span class="linenos">308</span></a>                    <span class="p">):</span>
</span><span id="LazyClassifier.fit-309"><a href="#LazyClassifier.fit-309"><span class="linenos">309</span></a>                        <span class="n">other_args</span><span class="p">[</span><span class="s2">&quot;n_jobs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span>
</span><span id="LazyClassifier.fit-310"><a href="#LazyClassifier.fit-310"><span class="linenos">310</span></a>                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-311"><a href="#LazyClassifier.fit-311"><span class="linenos">311</span></a>                    <span class="k">pass</span>
</span><span id="LazyClassifier.fit-312"><a href="#LazyClassifier.fit-312"><span class="linenos">312</span></a>
</span><span id="LazyClassifier.fit-313"><a href="#LazyClassifier.fit-313"><span class="linenos">313</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyClassifier.fit-314"><a href="#LazyClassifier.fit-314"><span class="linenos">314</span></a>
</span><span id="LazyClassifier.fit-315"><a href="#LazyClassifier.fit-315"><span class="linenos">315</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-316"><a href="#LazyClassifier.fit-316"><span class="linenos">316</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyClassifier.fit-317"><a href="#LazyClassifier.fit-317"><span class="linenos">317</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-318"><a href="#LazyClassifier.fit-318"><span class="linenos">318</span></a>                            <span class="p">[</span>
</span><span id="LazyClassifier.fit-319"><a href="#LazyClassifier.fit-319"><span class="linenos">319</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyClassifier.fit-320"><a href="#LazyClassifier.fit-320"><span class="linenos">320</span></a>                                <span class="p">(</span>
</span><span id="LazyClassifier.fit-321"><a href="#LazyClassifier.fit-321"><span class="linenos">321</span></a>                                    <span class="s2">&quot;classifier&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-322"><a href="#LazyClassifier.fit-322"><span class="linenos">322</span></a>                                    <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-323"><a href="#LazyClassifier.fit-323"><span class="linenos">323</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-324"><a href="#LazyClassifier.fit-324"><span class="linenos">324</span></a>                                            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-325"><a href="#LazyClassifier.fit-325"><span class="linenos">325</span></a>                                            <span class="o">**</span><span class="n">other_args</span>
</span><span id="LazyClassifier.fit-326"><a href="#LazyClassifier.fit-326"><span class="linenos">326</span></a>                                        <span class="p">),</span>
</span><span id="LazyClassifier.fit-327"><a href="#LazyClassifier.fit-327"><span class="linenos">327</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-328"><a href="#LazyClassifier.fit-328"><span class="linenos">328</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-329"><a href="#LazyClassifier.fit-329"><span class="linenos">329</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-330"><a href="#LazyClassifier.fit-330"><span class="linenos">330</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-331"><a href="#LazyClassifier.fit-331"><span class="linenos">331</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-332"><a href="#LazyClassifier.fit-332"><span class="linenos">332</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-333"><a href="#LazyClassifier.fit-333"><span class="linenos">333</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-334"><a href="#LazyClassifier.fit-334"><span class="linenos">334</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-335"><a href="#LazyClassifier.fit-335"><span class="linenos">335</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-336"><a href="#LazyClassifier.fit-336"><span class="linenos">336</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-337"><a href="#LazyClassifier.fit-337"><span class="linenos">337</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-338"><a href="#LazyClassifier.fit-338"><span class="linenos">338</span></a>                                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-339"><a href="#LazyClassifier.fit-339"><span class="linenos">339</span></a>                                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-340"><a href="#LazyClassifier.fit-340"><span class="linenos">340</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-341"><a href="#LazyClassifier.fit-341"><span class="linenos">341</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-342"><a href="#LazyClassifier.fit-342"><span class="linenos">342</span></a>                                    <span class="p">),</span>
</span><span id="LazyClassifier.fit-343"><a href="#LazyClassifier.fit-343"><span class="linenos">343</span></a>                                <span class="p">),</span>
</span><span id="LazyClassifier.fit-344"><a href="#LazyClassifier.fit-344"><span class="linenos">344</span></a>                            <span class="p">]</span>
</span><span id="LazyClassifier.fit-345"><a href="#LazyClassifier.fit-345"><span class="linenos">345</span></a>                        <span class="p">)</span>
</span><span id="LazyClassifier.fit-346"><a href="#LazyClassifier.fit-346"><span class="linenos">346</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-347"><a href="#LazyClassifier.fit-347"><span class="linenos">347</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-348"><a href="#LazyClassifier.fit-348"><span class="linenos">348</span></a>                            <span class="p">[</span>
</span><span id="LazyClassifier.fit-349"><a href="#LazyClassifier.fit-349"><span class="linenos">349</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyClassifier.fit-350"><a href="#LazyClassifier.fit-350"><span class="linenos">350</span></a>                                <span class="p">(</span>
</span><span id="LazyClassifier.fit-351"><a href="#LazyClassifier.fit-351"><span class="linenos">351</span></a>                                    <span class="s2">&quot;classifier&quot;</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-352"><a href="#LazyClassifier.fit-352"><span class="linenos">352</span></a>                                    <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-353"><a href="#LazyClassifier.fit-353"><span class="linenos">353</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">other_args</span><span class="p">),</span>
</span><span id="LazyClassifier.fit-354"><a href="#LazyClassifier.fit-354"><span class="linenos">354</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-355"><a href="#LazyClassifier.fit-355"><span class="linenos">355</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-356"><a href="#LazyClassifier.fit-356"><span class="linenos">356</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-357"><a href="#LazyClassifier.fit-357"><span class="linenos">357</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-358"><a href="#LazyClassifier.fit-358"><span class="linenos">358</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-359"><a href="#LazyClassifier.fit-359"><span class="linenos">359</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-360"><a href="#LazyClassifier.fit-360"><span class="linenos">360</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-361"><a href="#LazyClassifier.fit-361"><span class="linenos">361</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-362"><a href="#LazyClassifier.fit-362"><span class="linenos">362</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-363"><a href="#LazyClassifier.fit-363"><span class="linenos">363</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-364"><a href="#LazyClassifier.fit-364"><span class="linenos">364</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-365"><a href="#LazyClassifier.fit-365"><span class="linenos">365</span></a>                                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-366"><a href="#LazyClassifier.fit-366"><span class="linenos">366</span></a>                                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-367"><a href="#LazyClassifier.fit-367"><span class="linenos">367</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-368"><a href="#LazyClassifier.fit-368"><span class="linenos">368</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-369"><a href="#LazyClassifier.fit-369"><span class="linenos">369</span></a>                                    <span class="p">),</span>
</span><span id="LazyClassifier.fit-370"><a href="#LazyClassifier.fit-370"><span class="linenos">370</span></a>                                <span class="p">),</span>
</span><span id="LazyClassifier.fit-371"><a href="#LazyClassifier.fit-371"><span class="linenos">371</span></a>                            <span class="p">]</span>
</span><span id="LazyClassifier.fit-372"><a href="#LazyClassifier.fit-372"><span class="linenos">372</span></a>                        <span class="p">)</span>
</span><span id="LazyClassifier.fit-373"><a href="#LazyClassifier.fit-373"><span class="linenos">373</span></a>
</span><span id="LazyClassifier.fit-374"><a href="#LazyClassifier.fit-374"><span class="linenos">374</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-375"><a href="#LazyClassifier.fit-375"><span class="linenos">375</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyClassifier.fit-376"><a href="#LazyClassifier.fit-376"><span class="linenos">376</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-377"><a href="#LazyClassifier.fit-377"><span class="linenos">377</span></a>                    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-378"><a href="#LazyClassifier.fit-378"><span class="linenos">378</span></a>                    <span class="n">b_accuracy</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-379"><a href="#LazyClassifier.fit-379"><span class="linenos">379</span></a>                    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-380"><a href="#LazyClassifier.fit-380"><span class="linenos">380</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-381"><a href="#LazyClassifier.fit-381"><span class="linenos">381</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-382"><a href="#LazyClassifier.fit-382"><span class="linenos">382</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-383"><a href="#LazyClassifier.fit-383"><span class="linenos">383</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LazyClassifier.fit-384"><a href="#LazyClassifier.fit-384"><span class="linenos">384</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-385"><a href="#LazyClassifier.fit-385"><span class="linenos">385</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROC AUC couldn&#39;t be calculated for &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-386"><a href="#LazyClassifier.fit-386"><span class="linenos">386</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-387"><a href="#LazyClassifier.fit-387"><span class="linenos">387</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-388"><a href="#LazyClassifier.fit-388"><span class="linenos">388</span></a>                    <span class="n">Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-389"><a href="#LazyClassifier.fit-389"><span class="linenos">389</span></a>                    <span class="n">B_Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_accuracy</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-390"><a href="#LazyClassifier.fit-390"><span class="linenos">390</span></a>                    <span class="n">ROC_AUC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-391"><a href="#LazyClassifier.fit-391"><span class="linenos">391</span></a>                    <span class="n">F1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-392"><a href="#LazyClassifier.fit-392"><span class="linenos">392</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-393"><a href="#LazyClassifier.fit-393"><span class="linenos">393</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-394"><a href="#LazyClassifier.fit-394"><span class="linenos">394</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-395"><a href="#LazyClassifier.fit-395"><span class="linenos">395</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-396"><a href="#LazyClassifier.fit-396"><span class="linenos">396</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-397"><a href="#LazyClassifier.fit-397"><span class="linenos">397</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-398"><a href="#LazyClassifier.fit-398"><span class="linenos">398</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-399"><a href="#LazyClassifier.fit-399"><span class="linenos">399</span></a>                                <span class="p">{</span>
</span><span id="LazyClassifier.fit-400"><a href="#LazyClassifier.fit-400"><span class="linenos">400</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-401"><a href="#LazyClassifier.fit-401"><span class="linenos">401</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-402"><a href="#LazyClassifier.fit-402"><span class="linenos">402</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-403"><a href="#LazyClassifier.fit-403"><span class="linenos">403</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-404"><a href="#LazyClassifier.fit-404"><span class="linenos">404</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-405"><a href="#LazyClassifier.fit-405"><span class="linenos">405</span></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">custom_metric</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-406"><a href="#LazyClassifier.fit-406"><span class="linenos">406</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-407"><a href="#LazyClassifier.fit-407"><span class="linenos">407</span></a>                                <span class="p">}</span>
</span><span id="LazyClassifier.fit-408"><a href="#LazyClassifier.fit-408"><span class="linenos">408</span></a>                            <span class="p">)</span>
</span><span id="LazyClassifier.fit-409"><a href="#LazyClassifier.fit-409"><span class="linenos">409</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-410"><a href="#LazyClassifier.fit-410"><span class="linenos">410</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-411"><a href="#LazyClassifier.fit-411"><span class="linenos">411</span></a>                                <span class="p">{</span>
</span><span id="LazyClassifier.fit-412"><a href="#LazyClassifier.fit-412"><span class="linenos">412</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-413"><a href="#LazyClassifier.fit-413"><span class="linenos">413</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-414"><a href="#LazyClassifier.fit-414"><span class="linenos">414</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-415"><a href="#LazyClassifier.fit-415"><span class="linenos">415</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-416"><a href="#LazyClassifier.fit-416"><span class="linenos">416</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-417"><a href="#LazyClassifier.fit-417"><span class="linenos">417</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-418"><a href="#LazyClassifier.fit-418"><span class="linenos">418</span></a>                                <span class="p">}</span>
</span><span id="LazyClassifier.fit-419"><a href="#LazyClassifier.fit-419"><span class="linenos">419</span></a>                            <span class="p">)</span>
</span><span id="LazyClassifier.fit-420"><a href="#LazyClassifier.fit-420"><span class="linenos">420</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-421"><a href="#LazyClassifier.fit-421"><span class="linenos">421</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyClassifier.fit-422"><a href="#LazyClassifier.fit-422"><span class="linenos">422</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-423"><a href="#LazyClassifier.fit-423"><span class="linenos">423</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-424"><a href="#LazyClassifier.fit-424"><span class="linenos">424</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-425"><a href="#LazyClassifier.fit-425"><span class="linenos">425</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-426"><a href="#LazyClassifier.fit-426"><span class="linenos">426</span></a>                <span class="k">finally</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-427"><a href="#LazyClassifier.fit-427"><span class="linenos">427</span></a>                    <span class="k">continue</span>
</span><span id="LazyClassifier.fit-428"><a href="#LazyClassifier.fit-428"><span class="linenos">428</span></a>
</span><span id="LazyClassifier.fit-429"><a href="#LazyClassifier.fit-429"><span class="linenos">429</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># if self.preprocess is True:</span>
</span><span id="LazyClassifier.fit-430"><a href="#LazyClassifier.fit-430"><span class="linenos">430</span></a>
</span><span id="LazyClassifier.fit-431"><a href="#LazyClassifier.fit-431"><span class="linenos">431</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyClassifier.fit-432"><a href="#LazyClassifier.fit-432"><span class="linenos">432</span></a>                <span class="n">other_args</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-433"><a href="#LazyClassifier.fit-433"><span class="linenos">433</span></a>                    <span class="p">{}</span>
</span><span id="LazyClassifier.fit-434"><a href="#LazyClassifier.fit-434"><span class="linenos">434</span></a>                <span class="p">)</span>  <span class="c1"># use this trick for `random_state` too --&gt; refactor</span>
</span><span id="LazyClassifier.fit-435"><a href="#LazyClassifier.fit-435"><span class="linenos">435</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-436"><a href="#LazyClassifier.fit-436"><span class="linenos">436</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyClassifier.fit-437"><a href="#LazyClassifier.fit-437"><span class="linenos">437</span></a>                        <span class="s2">&quot;n_jobs&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="LazyClassifier.fit-438"><a href="#LazyClassifier.fit-438"><span class="linenos">438</span></a>                        <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;LogisticRegression&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="LazyClassifier.fit-439"><a href="#LazyClassifier.fit-439"><span class="linenos">439</span></a>                    <span class="p">):</span>
</span><span id="LazyClassifier.fit-440"><a href="#LazyClassifier.fit-440"><span class="linenos">440</span></a>                        <span class="n">other_args</span><span class="p">[</span><span class="s2">&quot;n_jobs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span>
</span><span id="LazyClassifier.fit-441"><a href="#LazyClassifier.fit-441"><span class="linenos">441</span></a>                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-442"><a href="#LazyClassifier.fit-442"><span class="linenos">442</span></a>                    <span class="k">pass</span>
</span><span id="LazyClassifier.fit-443"><a href="#LazyClassifier.fit-443"><span class="linenos">443</span></a>
</span><span id="LazyClassifier.fit-444"><a href="#LazyClassifier.fit-444"><span class="linenos">444</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyClassifier.fit-445"><a href="#LazyClassifier.fit-445"><span class="linenos">445</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-446"><a href="#LazyClassifier.fit-446"><span class="linenos">446</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyClassifier.fit-447"><a href="#LazyClassifier.fit-447"><span class="linenos">447</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-448"><a href="#LazyClassifier.fit-448"><span class="linenos">448</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-449"><a href="#LazyClassifier.fit-449"><span class="linenos">449</span></a>                                <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span> <span class="o">**</span><span class="n">other_args</span>
</span><span id="LazyClassifier.fit-450"><a href="#LazyClassifier.fit-450"><span class="linenos">450</span></a>                            <span class="p">),</span>
</span><span id="LazyClassifier.fit-451"><a href="#LazyClassifier.fit-451"><span class="linenos">451</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-452"><a href="#LazyClassifier.fit-452"><span class="linenos">452</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-453"><a href="#LazyClassifier.fit-453"><span class="linenos">453</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-454"><a href="#LazyClassifier.fit-454"><span class="linenos">454</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-455"><a href="#LazyClassifier.fit-455"><span class="linenos">455</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-456"><a href="#LazyClassifier.fit-456"><span class="linenos">456</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-457"><a href="#LazyClassifier.fit-457"><span class="linenos">457</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-458"><a href="#LazyClassifier.fit-458"><span class="linenos">458</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-459"><a href="#LazyClassifier.fit-459"><span class="linenos">459</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-460"><a href="#LazyClassifier.fit-460"><span class="linenos">460</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-461"><a href="#LazyClassifier.fit-461"><span class="linenos">461</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-462"><a href="#LazyClassifier.fit-462"><span class="linenos">462</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-463"><a href="#LazyClassifier.fit-463"><span class="linenos">463</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-464"><a href="#LazyClassifier.fit-464"><span class="linenos">464</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-465"><a href="#LazyClassifier.fit-465"><span class="linenos">465</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-466"><a href="#LazyClassifier.fit-466"><span class="linenos">466</span></a>                        <span class="p">)</span>
</span><span id="LazyClassifier.fit-467"><a href="#LazyClassifier.fit-467"><span class="linenos">467</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-468"><a href="#LazyClassifier.fit-468"><span class="linenos">468</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-469"><a href="#LazyClassifier.fit-469"><span class="linenos">469</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">other_args</span><span class="p">),</span>
</span><span id="LazyClassifier.fit-470"><a href="#LazyClassifier.fit-470"><span class="linenos">470</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-471"><a href="#LazyClassifier.fit-471"><span class="linenos">471</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-472"><a href="#LazyClassifier.fit-472"><span class="linenos">472</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-473"><a href="#LazyClassifier.fit-473"><span class="linenos">473</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-474"><a href="#LazyClassifier.fit-474"><span class="linenos">474</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-475"><a href="#LazyClassifier.fit-475"><span class="linenos">475</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-476"><a href="#LazyClassifier.fit-476"><span class="linenos">476</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-477"><a href="#LazyClassifier.fit-477"><span class="linenos">477</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-478"><a href="#LazyClassifier.fit-478"><span class="linenos">478</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-479"><a href="#LazyClassifier.fit-479"><span class="linenos">479</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-480"><a href="#LazyClassifier.fit-480"><span class="linenos">480</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-481"><a href="#LazyClassifier.fit-481"><span class="linenos">481</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-482"><a href="#LazyClassifier.fit-482"><span class="linenos">482</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-483"><a href="#LazyClassifier.fit-483"><span class="linenos">483</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-484"><a href="#LazyClassifier.fit-484"><span class="linenos">484</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-485"><a href="#LazyClassifier.fit-485"><span class="linenos">485</span></a>                        <span class="p">)</span>
</span><span id="LazyClassifier.fit-486"><a href="#LazyClassifier.fit-486"><span class="linenos">486</span></a>
</span><span id="LazyClassifier.fit-487"><a href="#LazyClassifier.fit-487"><span class="linenos">487</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-488"><a href="#LazyClassifier.fit-488"><span class="linenos">488</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyClassifier.fit-489"><a href="#LazyClassifier.fit-489"><span class="linenos">489</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-490"><a href="#LazyClassifier.fit-490"><span class="linenos">490</span></a>                    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-491"><a href="#LazyClassifier.fit-491"><span class="linenos">491</span></a>                    <span class="n">b_accuracy</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-492"><a href="#LazyClassifier.fit-492"><span class="linenos">492</span></a>                    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-493"><a href="#LazyClassifier.fit-493"><span class="linenos">493</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-494"><a href="#LazyClassifier.fit-494"><span class="linenos">494</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-495"><a href="#LazyClassifier.fit-495"><span class="linenos">495</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-496"><a href="#LazyClassifier.fit-496"><span class="linenos">496</span></a>                        <span class="n">roc_auc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LazyClassifier.fit-497"><a href="#LazyClassifier.fit-497"><span class="linenos">497</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-498"><a href="#LazyClassifier.fit-498"><span class="linenos">498</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROC AUC couldn&#39;t be calculated for &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-499"><a href="#LazyClassifier.fit-499"><span class="linenos">499</span></a>                            <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-500"><a href="#LazyClassifier.fit-500"><span class="linenos">500</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-501"><a href="#LazyClassifier.fit-501"><span class="linenos">501</span></a>                    <span class="n">Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-502"><a href="#LazyClassifier.fit-502"><span class="linenos">502</span></a>                    <span class="n">B_Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_accuracy</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-503"><a href="#LazyClassifier.fit-503"><span class="linenos">503</span></a>                    <span class="n">ROC_AUC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-504"><a href="#LazyClassifier.fit-504"><span class="linenos">504</span></a>                    <span class="n">F1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-505"><a href="#LazyClassifier.fit-505"><span class="linenos">505</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-506"><a href="#LazyClassifier.fit-506"><span class="linenos">506</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-507"><a href="#LazyClassifier.fit-507"><span class="linenos">507</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-508"><a href="#LazyClassifier.fit-508"><span class="linenos">508</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-509"><a href="#LazyClassifier.fit-509"><span class="linenos">509</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-510"><a href="#LazyClassifier.fit-510"><span class="linenos">510</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-511"><a href="#LazyClassifier.fit-511"><span class="linenos">511</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-512"><a href="#LazyClassifier.fit-512"><span class="linenos">512</span></a>                                <span class="p">{</span>
</span><span id="LazyClassifier.fit-513"><a href="#LazyClassifier.fit-513"><span class="linenos">513</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-514"><a href="#LazyClassifier.fit-514"><span class="linenos">514</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-515"><a href="#LazyClassifier.fit-515"><span class="linenos">515</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-516"><a href="#LazyClassifier.fit-516"><span class="linenos">516</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-517"><a href="#LazyClassifier.fit-517"><span class="linenos">517</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-518"><a href="#LazyClassifier.fit-518"><span class="linenos">518</span></a>                                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">custom_metric</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-519"><a href="#LazyClassifier.fit-519"><span class="linenos">519</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-520"><a href="#LazyClassifier.fit-520"><span class="linenos">520</span></a>                                <span class="p">}</span>
</span><span id="LazyClassifier.fit-521"><a href="#LazyClassifier.fit-521"><span class="linenos">521</span></a>                            <span class="p">)</span>
</span><span id="LazyClassifier.fit-522"><a href="#LazyClassifier.fit-522"><span class="linenos">522</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-523"><a href="#LazyClassifier.fit-523"><span class="linenos">523</span></a>                            <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-524"><a href="#LazyClassifier.fit-524"><span class="linenos">524</span></a>                                <span class="p">{</span>
</span><span id="LazyClassifier.fit-525"><a href="#LazyClassifier.fit-525"><span class="linenos">525</span></a>                                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-526"><a href="#LazyClassifier.fit-526"><span class="linenos">526</span></a>                                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-527"><a href="#LazyClassifier.fit-527"><span class="linenos">527</span></a>                                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-528"><a href="#LazyClassifier.fit-528"><span class="linenos">528</span></a>                                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-529"><a href="#LazyClassifier.fit-529"><span class="linenos">529</span></a>                                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-530"><a href="#LazyClassifier.fit-530"><span class="linenos">530</span></a>                                    <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-531"><a href="#LazyClassifier.fit-531"><span class="linenos">531</span></a>                                <span class="p">}</span>
</span><span id="LazyClassifier.fit-532"><a href="#LazyClassifier.fit-532"><span class="linenos">532</span></a>                            <span class="p">)</span>
</span><span id="LazyClassifier.fit-533"><a href="#LazyClassifier.fit-533"><span class="linenos">533</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-534"><a href="#LazyClassifier.fit-534"><span class="linenos">534</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyClassifier.fit-535"><a href="#LazyClassifier.fit-535"><span class="linenos">535</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-536"><a href="#LazyClassifier.fit-536"><span class="linenos">536</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-537"><a href="#LazyClassifier.fit-537"><span class="linenos">537</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-538"><a href="#LazyClassifier.fit-538"><span class="linenos">538</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-539"><a href="#LazyClassifier.fit-539"><span class="linenos">539</span></a>                <span class="k">finally</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-540"><a href="#LazyClassifier.fit-540"><span class="linenos">540</span></a>                    <span class="k">continue</span>
</span><span id="LazyClassifier.fit-541"><a href="#LazyClassifier.fit-541"><span class="linenos">541</span></a>
</span><span id="LazyClassifier.fit-542"><a href="#LazyClassifier.fit-542"><span class="linenos">542</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-543"><a href="#LazyClassifier.fit-543"><span class="linenos">543</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-544"><a href="#LazyClassifier.fit-544"><span class="linenos">544</span></a>                <span class="p">{</span>
</span><span id="LazyClassifier.fit-545"><a href="#LazyClassifier.fit-545"><span class="linenos">545</span></a>                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-546"><a href="#LazyClassifier.fit-546"><span class="linenos">546</span></a>                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-547"><a href="#LazyClassifier.fit-547"><span class="linenos">547</span></a>                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">B_Accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-548"><a href="#LazyClassifier.fit-548"><span class="linenos">548</span></a>                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">ROC_AUC</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-549"><a href="#LazyClassifier.fit-549"><span class="linenos">549</span></a>                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-550"><a href="#LazyClassifier.fit-550"><span class="linenos">550</span></a>                    <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-551"><a href="#LazyClassifier.fit-551"><span class="linenos">551</span></a>                <span class="p">}</span>
</span><span id="LazyClassifier.fit-552"><a href="#LazyClassifier.fit-552"><span class="linenos">552</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier.fit-553"><a href="#LazyClassifier.fit-553"><span class="linenos">553</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-554"><a href="#LazyClassifier.fit-554"><span class="linenos">554</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-555"><a href="#LazyClassifier.fit-555"><span class="linenos">555</span></a>                <span class="p">{</span>
</span><span id="LazyClassifier.fit-556"><a href="#LazyClassifier.fit-556"><span class="linenos">556</span></a>                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-557"><a href="#LazyClassifier.fit-557"><span class="linenos">557</span></a>                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-558"><a href="#LazyClassifier.fit-558"><span class="linenos">558</span></a>                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">B_Accuracy</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-559"><a href="#LazyClassifier.fit-559"><span class="linenos">559</span></a>                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">ROC_AUC</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-560"><a href="#LazyClassifier.fit-560"><span class="linenos">560</span></a>                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-561"><a href="#LazyClassifier.fit-561"><span class="linenos">561</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">CUSTOM_METRIC</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-562"><a href="#LazyClassifier.fit-562"><span class="linenos">562</span></a>                    <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyClassifier.fit-563"><a href="#LazyClassifier.fit-563"><span class="linenos">563</span></a>                <span class="p">}</span>
</span><span id="LazyClassifier.fit-564"><a href="#LazyClassifier.fit-564"><span class="linenos">564</span></a>            <span class="p">)</span>
</span><span id="LazyClassifier.fit-565"><a href="#LazyClassifier.fit-565"><span class="linenos">565</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_by</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyClassifier.fit-566"><a href="#LazyClassifier.fit-566"><span class="linenos">566</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyClassifier.fit-567"><a href="#LazyClassifier.fit-567"><span class="linenos">567</span></a>        <span class="p">)</span>
</span><span id="LazyClassifier.fit-568"><a href="#LazyClassifier.fit-568"><span class="linenos">568</span></a>
</span><span id="LazyClassifier.fit-569"><a href="#LazyClassifier.fit-569"><span class="linenos">569</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyClassifier.fit-570"><a href="#LazyClassifier.fit-570"><span class="linenos">570</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyClassifier.fit-571"><a href="#LazyClassifier.fit-571"><span class="linenos">571</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span></pre></div>


            <div class="docstring"><p>Fit classifiers to X_train and y_train, predict and score on X_test,
y_test.</p>

<p>Parameters:</p>

<pre><code>X_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.

y_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

y_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.
</code></pre>

<p>Returns:</p>

<pre><code>scores: Pandas DataFrame
    Returns metrics of all the models in a Pandas DataFrame.

predictions: Pandas DataFrame
    Returns predictions of all the models in a Pandas DataFrame.
</code></pre>
</div>


                                </div>
                                <div id="LazyClassifier.provide_models" class="classattr">
                                            <input id="LazyClassifier.provide_models-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">provide_models</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">y_train</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyClassifier.provide_models-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyClassifier.provide_models"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyClassifier.provide_models-573"><a href="#LazyClassifier.provide_models-573"><span class="linenos">573</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyClassifier.provide_models-574"><a href="#LazyClassifier.provide_models-574"><span class="linenos">574</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all the model objects trained. If fit hasn&#39;t been called yet,</span>
</span><span id="LazyClassifier.provide_models-575"><a href="#LazyClassifier.provide_models-575"><span class="linenos">575</span></a><span class="sd">        then it&#39;s called to return the models.</span>
</span><span id="LazyClassifier.provide_models-576"><a href="#LazyClassifier.provide_models-576"><span class="linenos">576</span></a>
</span><span id="LazyClassifier.provide_models-577"><a href="#LazyClassifier.provide_models-577"><span class="linenos">577</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyClassifier.provide_models-578"><a href="#LazyClassifier.provide_models-578"><span class="linenos">578</span></a>
</span><span id="LazyClassifier.provide_models-579"><a href="#LazyClassifier.provide_models-579"><span class="linenos">579</span></a><span class="sd">        X_train: array-like,</span>
</span><span id="LazyClassifier.provide_models-580"><a href="#LazyClassifier.provide_models-580"><span class="linenos">580</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier.provide_models-581"><a href="#LazyClassifier.provide_models-581"><span class="linenos">581</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyClassifier.provide_models-582"><a href="#LazyClassifier.provide_models-582"><span class="linenos">582</span></a>
</span><span id="LazyClassifier.provide_models-583"><a href="#LazyClassifier.provide_models-583"><span class="linenos">583</span></a><span class="sd">        X_test: array-like,</span>
</span><span id="LazyClassifier.provide_models-584"><a href="#LazyClassifier.provide_models-584"><span class="linenos">584</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier.provide_models-585"><a href="#LazyClassifier.provide_models-585"><span class="linenos">585</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyClassifier.provide_models-586"><a href="#LazyClassifier.provide_models-586"><span class="linenos">586</span></a>
</span><span id="LazyClassifier.provide_models-587"><a href="#LazyClassifier.provide_models-587"><span class="linenos">587</span></a><span class="sd">        y_train: array-like,</span>
</span><span id="LazyClassifier.provide_models-588"><a href="#LazyClassifier.provide_models-588"><span class="linenos">588</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier.provide_models-589"><a href="#LazyClassifier.provide_models-589"><span class="linenos">589</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyClassifier.provide_models-590"><a href="#LazyClassifier.provide_models-590"><span class="linenos">590</span></a>
</span><span id="LazyClassifier.provide_models-591"><a href="#LazyClassifier.provide_models-591"><span class="linenos">591</span></a><span class="sd">        y_test: array-like,</span>
</span><span id="LazyClassifier.provide_models-592"><a href="#LazyClassifier.provide_models-592"><span class="linenos">592</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyClassifier.provide_models-593"><a href="#LazyClassifier.provide_models-593"><span class="linenos">593</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyClassifier.provide_models-594"><a href="#LazyClassifier.provide_models-594"><span class="linenos">594</span></a>
</span><span id="LazyClassifier.provide_models-595"><a href="#LazyClassifier.provide_models-595"><span class="linenos">595</span></a><span class="sd">        Returns:</span>
</span><span id="LazyClassifier.provide_models-596"><a href="#LazyClassifier.provide_models-596"><span class="linenos">596</span></a>
</span><span id="LazyClassifier.provide_models-597"><a href="#LazyClassifier.provide_models-597"><span class="linenos">597</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyClassifier.provide_models-598"><a href="#LazyClassifier.provide_models-598"><span class="linenos">598</span></a><span class="sd">                Returns a dictionary with each model&#39;s pipeline as value</span>
</span><span id="LazyClassifier.provide_models-599"><a href="#LazyClassifier.provide_models-599"><span class="linenos">599</span></a><span class="sd">                and key = name of the model.</span>
</span><span id="LazyClassifier.provide_models-600"><a href="#LazyClassifier.provide_models-600"><span class="linenos">600</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyClassifier.provide_models-601"><a href="#LazyClassifier.provide_models-601"><span class="linenos">601</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyClassifier.provide_models-602"><a href="#LazyClassifier.provide_models-602"><span class="linenos">602</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span><span id="LazyClassifier.provide_models-603"><a href="#LazyClassifier.provide_models-603"><span class="linenos">603</span></a>
</span><span id="LazyClassifier.provide_models-604"><a href="#LazyClassifier.provide_models-604"><span class="linenos">604</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>Returns all the model objects trained. If fit hasn't been called yet,
then it's called to return the models.</p>

<p>Parameters:</p>

<p>X_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.</p>

<p>X_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.</p>

<p>y_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.</p>

<p>y_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.</p>

<p>Returns:</p>

<pre><code>models: dict-object,
    Returns a dictionary with each model's pipeline as value
    and key = name of the model.
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="LazyRegressor">
                            <input id="LazyRegressor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LazyRegressor</span><wbr>(<span class="base">nnetsauce.custom.custom.Custom</span>, <span class="base">sklearn.base.RegressorMixin</span>):

                <label class="view-source-button" for="LazyRegressor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyRegressor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyRegressor-68"><a href="#LazyRegressor-68"><span class="linenos"> 68</span></a><span class="k">class</span> <span class="nc">LazyRegressor</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">RegressorMixin</span><span class="p">):</span>
</span><span id="LazyRegressor-69"><a href="#LazyRegressor-69"><span class="linenos"> 69</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyRegressor-70"><a href="#LazyRegressor-70"><span class="linenos"> 70</span></a>
</span><span id="LazyRegressor-71"><a href="#LazyRegressor-71"><span class="linenos"> 71</span></a><span class="sd">    Fitting a collection of regression models using nnetsauce&#39;s CustomRegressor</span>
</span><span id="LazyRegressor-72"><a href="#LazyRegressor-72"><span class="linenos"> 72</span></a>
</span><span id="LazyRegressor-73"><a href="#LazyRegressor-73"><span class="linenos"> 73</span></a><span class="sd">    Parameters:</span>
</span><span id="LazyRegressor-74"><a href="#LazyRegressor-74"><span class="linenos"> 74</span></a>
</span><span id="LazyRegressor-75"><a href="#LazyRegressor-75"><span class="linenos"> 75</span></a><span class="sd">        verbose: int, optional (default=0)</span>
</span><span id="LazyRegressor-76"><a href="#LazyRegressor-76"><span class="linenos"> 76</span></a><span class="sd">            Any positive number for verbosity.</span>
</span><span id="LazyRegressor-77"><a href="#LazyRegressor-77"><span class="linenos"> 77</span></a>
</span><span id="LazyRegressor-78"><a href="#LazyRegressor-78"><span class="linenos"> 78</span></a><span class="sd">        ignore_warnings: bool, optional (default=True)</span>
</span><span id="LazyRegressor-79"><a href="#LazyRegressor-79"><span class="linenos"> 79</span></a><span class="sd">            When set to True, the warning related to algorigms that are not able to run are ignored.</span>
</span><span id="LazyRegressor-80"><a href="#LazyRegressor-80"><span class="linenos"> 80</span></a>
</span><span id="LazyRegressor-81"><a href="#LazyRegressor-81"><span class="linenos"> 81</span></a><span class="sd">        custom_metric: function, optional (default=None)</span>
</span><span id="LazyRegressor-82"><a href="#LazyRegressor-82"><span class="linenos"> 82</span></a><span class="sd">            When function is provided, models are evaluated based on the custom evaluation metric provided.</span>
</span><span id="LazyRegressor-83"><a href="#LazyRegressor-83"><span class="linenos"> 83</span></a>
</span><span id="LazyRegressor-84"><a href="#LazyRegressor-84"><span class="linenos"> 84</span></a><span class="sd">        predictions: bool, optional (default=False)</span>
</span><span id="LazyRegressor-85"><a href="#LazyRegressor-85"><span class="linenos"> 85</span></a><span class="sd">            When set to True, the predictions of all the models models are returned as dataframe.</span>
</span><span id="LazyRegressor-86"><a href="#LazyRegressor-86"><span class="linenos"> 86</span></a>
</span><span id="LazyRegressor-87"><a href="#LazyRegressor-87"><span class="linenos"> 87</span></a><span class="sd">        sort_by: string, optional (default=&#39;Accuracy&#39;)</span>
</span><span id="LazyRegressor-88"><a href="#LazyRegressor-88"><span class="linenos"> 88</span></a><span class="sd">            Sort models by a metric. Available options are &#39;Accuracy&#39;, &#39;Balanced Accuracy&#39;, &#39;ROC AUC&#39;, &#39;F1 Score&#39;</span>
</span><span id="LazyRegressor-89"><a href="#LazyRegressor-89"><span class="linenos"> 89</span></a><span class="sd">            or a custom metric identified by its name and provided by custom_metric.</span>
</span><span id="LazyRegressor-90"><a href="#LazyRegressor-90"><span class="linenos"> 90</span></a>
</span><span id="LazyRegressor-91"><a href="#LazyRegressor-91"><span class="linenos"> 91</span></a><span class="sd">        random_state: int, optional (default=42)</span>
</span><span id="LazyRegressor-92"><a href="#LazyRegressor-92"><span class="linenos"> 92</span></a><span class="sd">            Reproducibiility seed.</span>
</span><span id="LazyRegressor-93"><a href="#LazyRegressor-93"><span class="linenos"> 93</span></a>
</span><span id="LazyRegressor-94"><a href="#LazyRegressor-94"><span class="linenos"> 94</span></a><span class="sd">        estimators: list, optional (default=&#39;all&#39;)</span>
</span><span id="LazyRegressor-95"><a href="#LazyRegressor-95"><span class="linenos"> 95</span></a><span class="sd">            a list of Estimators names or just &#39;all&#39; (default=&#39;all&#39;)</span>
</span><span id="LazyRegressor-96"><a href="#LazyRegressor-96"><span class="linenos"> 96</span></a>
</span><span id="LazyRegressor-97"><a href="#LazyRegressor-97"><span class="linenos"> 97</span></a><span class="sd">        preprocess: bool, preprocessing is done when set to True</span>
</span><span id="LazyRegressor-98"><a href="#LazyRegressor-98"><span class="linenos"> 98</span></a>
</span><span id="LazyRegressor-99"><a href="#LazyRegressor-99"><span class="linenos"> 99</span></a><span class="sd">        n_jobs : int, when possible, run in parallel</span>
</span><span id="LazyRegressor-100"><a href="#LazyRegressor-100"><span class="linenos">100</span></a><span class="sd">            For now, only used by individual models that support it.</span>
</span><span id="LazyRegressor-101"><a href="#LazyRegressor-101"><span class="linenos">101</span></a>
</span><span id="LazyRegressor-102"><a href="#LazyRegressor-102"><span class="linenos">102</span></a><span class="sd">        n_layers: int, optional (default=3)</span>
</span><span id="LazyRegressor-103"><a href="#LazyRegressor-103"><span class="linenos">103</span></a><span class="sd">            Number of layers of CustomRegressors to be used.</span>
</span><span id="LazyRegressor-104"><a href="#LazyRegressor-104"><span class="linenos">104</span></a>
</span><span id="LazyRegressor-105"><a href="#LazyRegressor-105"><span class="linenos">105</span></a><span class="sd">        All the other parameters are the same as CustomRegressor&#39;s.</span>
</span><span id="LazyRegressor-106"><a href="#LazyRegressor-106"><span class="linenos">106</span></a>
</span><span id="LazyRegressor-107"><a href="#LazyRegressor-107"><span class="linenos">107</span></a><span class="sd">    Examples:</span>
</span><span id="LazyRegressor-108"><a href="#LazyRegressor-108"><span class="linenos">108</span></a><span class="sd">        ```python</span>
</span><span id="LazyRegressor-109"><a href="#LazyRegressor-109"><span class="linenos">109</span></a><span class="sd">        import nnetsauce as ns</span>
</span><span id="LazyRegressor-110"><a href="#LazyRegressor-110"><span class="linenos">110</span></a><span class="sd">        from sklearn.datasets import load_diabetes</span>
</span><span id="LazyRegressor-111"><a href="#LazyRegressor-111"><span class="linenos">111</span></a><span class="sd">        from sklearn.model_selection import train_test_split</span>
</span><span id="LazyRegressor-112"><a href="#LazyRegressor-112"><span class="linenos">112</span></a><span class="sd">        data = load_diabetes()</span>
</span><span id="LazyRegressor-113"><a href="#LazyRegressor-113"><span class="linenos">113</span></a><span class="sd">        X = data.data</span>
</span><span id="LazyRegressor-114"><a href="#LazyRegressor-114"><span class="linenos">114</span></a><span class="sd">        y= data.target</span>
</span><span id="LazyRegressor-115"><a href="#LazyRegressor-115"><span class="linenos">115</span></a><span class="sd">        X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=.2, random_state=123)</span>
</span><span id="LazyRegressor-116"><a href="#LazyRegressor-116"><span class="linenos">116</span></a><span class="sd">        regr = ns.LazyRegressor(verbose=0, ignore_warnings=True)</span>
</span><span id="LazyRegressor-117"><a href="#LazyRegressor-117"><span class="linenos">117</span></a><span class="sd">        models, predictions = clf.fit(X_train, X_test, y_train, y_test)</span>
</span><span id="LazyRegressor-118"><a href="#LazyRegressor-118"><span class="linenos">118</span></a><span class="sd">        model_dictionary = clf.provide_models(X_train,X_test,y_train,y_test)</span>
</span><span id="LazyRegressor-119"><a href="#LazyRegressor-119"><span class="linenos">119</span></a><span class="sd">        print(models)</span>
</span><span id="LazyRegressor-120"><a href="#LazyRegressor-120"><span class="linenos">120</span></a><span class="sd">        ```</span>
</span><span id="LazyRegressor-121"><a href="#LazyRegressor-121"><span class="linenos">121</span></a>
</span><span id="LazyRegressor-122"><a href="#LazyRegressor-122"><span class="linenos">122</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LazyRegressor-123"><a href="#LazyRegressor-123"><span class="linenos">123</span></a>
</span><span id="LazyRegressor-124"><a href="#LazyRegressor-124"><span class="linenos">124</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyRegressor-125"><a href="#LazyRegressor-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="LazyRegressor-126"><a href="#LazyRegressor-126"><span class="linenos">126</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyRegressor-127"><a href="#LazyRegressor-127"><span class="linenos">127</span></a>        <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyRegressor-128"><a href="#LazyRegressor-128"><span class="linenos">128</span></a>        <span class="n">custom_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyRegressor-129"><a href="#LazyRegressor-129"><span class="linenos">129</span></a>        <span class="n">predictions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyRegressor-130"><a href="#LazyRegressor-130"><span class="linenos">130</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="LazyRegressor-131"><a href="#LazyRegressor-131"><span class="linenos">131</span></a>        <span class="n">estimators</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-132"><a href="#LazyRegressor-132"><span class="linenos">132</span></a>        <span class="n">preprocess</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyRegressor-133"><a href="#LazyRegressor-133"><span class="linenos">133</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyRegressor-134"><a href="#LazyRegressor-134"><span class="linenos">134</span></a>        <span class="c1"># CustomRegressor attributes</span>
</span><span id="LazyRegressor-135"><a href="#LazyRegressor-135"><span class="linenos">135</span></a>        <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyRegressor-136"><a href="#LazyRegressor-136"><span class="linenos">136</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="LazyRegressor-137"><a href="#LazyRegressor-137"><span class="linenos">137</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-138"><a href="#LazyRegressor-138"><span class="linenos">138</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="LazyRegressor-139"><a href="#LazyRegressor-139"><span class="linenos">139</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-140"><a href="#LazyRegressor-140"><span class="linenos">140</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyRegressor-141"><a href="#LazyRegressor-141"><span class="linenos">141</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyRegressor-142"><a href="#LazyRegressor-142"><span class="linenos">142</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyRegressor-143"><a href="#LazyRegressor-143"><span class="linenos">143</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="LazyRegressor-144"><a href="#LazyRegressor-144"><span class="linenos">144</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyRegressor-145"><a href="#LazyRegressor-145"><span class="linenos">145</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-146"><a href="#LazyRegressor-146"><span class="linenos">146</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="LazyRegressor-147"><a href="#LazyRegressor-147"><span class="linenos">147</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyRegressor-148"><a href="#LazyRegressor-148"><span class="linenos">148</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyRegressor-149"><a href="#LazyRegressor-149"><span class="linenos">149</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="LazyRegressor-150"><a href="#LazyRegressor-150"><span class="linenos">150</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-151"><a href="#LazyRegressor-151"><span class="linenos">151</span></a>    <span class="p">):</span>
</span><span id="LazyRegressor-152"><a href="#LazyRegressor-152"><span class="linenos">152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="LazyRegressor-153"><a href="#LazyRegressor-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="o">=</span> <span class="n">ignore_warnings</span>
</span><span id="LazyRegressor-154"><a href="#LazyRegressor-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="o">=</span> <span class="n">custom_metric</span>
</span><span id="LazyRegressor-155"><a href="#LazyRegressor-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span>
</span><span id="LazyRegressor-156"><a href="#LazyRegressor-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyRegressor-157"><a href="#LazyRegressor-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="LazyRegressor-158"><a href="#LazyRegressor-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">=</span> <span class="n">estimators</span>
</span><span id="LazyRegressor-159"><a href="#LazyRegressor-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="o">=</span> <span class="n">preprocess</span>
</span><span id="LazyRegressor-160"><a href="#LazyRegressor-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="LazyRegressor-161"><a href="#LazyRegressor-161"><span class="linenos">161</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyRegressor-162"><a href="#LazyRegressor-162"><span class="linenos">162</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="LazyRegressor-163"><a href="#LazyRegressor-163"><span class="linenos">163</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor-164"><a href="#LazyRegressor-164"><span class="linenos">164</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor-165"><a href="#LazyRegressor-165"><span class="linenos">165</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor-166"><a href="#LazyRegressor-166"><span class="linenos">166</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor-167"><a href="#LazyRegressor-167"><span class="linenos">167</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor-168"><a href="#LazyRegressor-168"><span class="linenos">168</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor-169"><a href="#LazyRegressor-169"><span class="linenos">169</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor-170"><a href="#LazyRegressor-170"><span class="linenos">170</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor-171"><a href="#LazyRegressor-171"><span class="linenos">171</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor-172"><a href="#LazyRegressor-172"><span class="linenos">172</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor-173"><a href="#LazyRegressor-173"><span class="linenos">173</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor-174"><a href="#LazyRegressor-174"><span class="linenos">174</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-175"><a href="#LazyRegressor-175"><span class="linenos">175</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-176"><a href="#LazyRegressor-176"><span class="linenos">176</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor-177"><a href="#LazyRegressor-177"><span class="linenos">177</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor-178"><a href="#LazyRegressor-178"><span class="linenos">178</span></a>        <span class="p">)</span>
</span><span id="LazyRegressor-179"><a href="#LazyRegressor-179"><span class="linenos">179</span></a>
</span><span id="LazyRegressor-180"><a href="#LazyRegressor-180"><span class="linenos">180</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyRegressor-181"><a href="#LazyRegressor-181"><span class="linenos">181</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X_train and y_train, predict and score on X_test, y_test.</span>
</span><span id="LazyRegressor-182"><a href="#LazyRegressor-182"><span class="linenos">182</span></a>
</span><span id="LazyRegressor-183"><a href="#LazyRegressor-183"><span class="linenos">183</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyRegressor-184"><a href="#LazyRegressor-184"><span class="linenos">184</span></a>
</span><span id="LazyRegressor-185"><a href="#LazyRegressor-185"><span class="linenos">185</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyRegressor-186"><a href="#LazyRegressor-186"><span class="linenos">186</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor-187"><a href="#LazyRegressor-187"><span class="linenos">187</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyRegressor-188"><a href="#LazyRegressor-188"><span class="linenos">188</span></a>
</span><span id="LazyRegressor-189"><a href="#LazyRegressor-189"><span class="linenos">189</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyRegressor-190"><a href="#LazyRegressor-190"><span class="linenos">190</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor-191"><a href="#LazyRegressor-191"><span class="linenos">191</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyRegressor-192"><a href="#LazyRegressor-192"><span class="linenos">192</span></a>
</span><span id="LazyRegressor-193"><a href="#LazyRegressor-193"><span class="linenos">193</span></a><span class="sd">            y_train : array-like,</span>
</span><span id="LazyRegressor-194"><a href="#LazyRegressor-194"><span class="linenos">194</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor-195"><a href="#LazyRegressor-195"><span class="linenos">195</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyRegressor-196"><a href="#LazyRegressor-196"><span class="linenos">196</span></a>
</span><span id="LazyRegressor-197"><a href="#LazyRegressor-197"><span class="linenos">197</span></a><span class="sd">            y_test : array-like,</span>
</span><span id="LazyRegressor-198"><a href="#LazyRegressor-198"><span class="linenos">198</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor-199"><a href="#LazyRegressor-199"><span class="linenos">199</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyRegressor-200"><a href="#LazyRegressor-200"><span class="linenos">200</span></a>
</span><span id="LazyRegressor-201"><a href="#LazyRegressor-201"><span class="linenos">201</span></a><span class="sd">        Returns:</span>
</span><span id="LazyRegressor-202"><a href="#LazyRegressor-202"><span class="linenos">202</span></a>
</span><span id="LazyRegressor-203"><a href="#LazyRegressor-203"><span class="linenos">203</span></a><span class="sd">        scores : Pandas DataFrame</span>
</span><span id="LazyRegressor-204"><a href="#LazyRegressor-204"><span class="linenos">204</span></a><span class="sd">            Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyRegressor-205"><a href="#LazyRegressor-205"><span class="linenos">205</span></a>
</span><span id="LazyRegressor-206"><a href="#LazyRegressor-206"><span class="linenos">206</span></a><span class="sd">        predictions : Pandas DataFrame</span>
</span><span id="LazyRegressor-207"><a href="#LazyRegressor-207"><span class="linenos">207</span></a><span class="sd">            Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyRegressor-208"><a href="#LazyRegressor-208"><span class="linenos">208</span></a>
</span><span id="LazyRegressor-209"><a href="#LazyRegressor-209"><span class="linenos">209</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyRegressor-210"><a href="#LazyRegressor-210"><span class="linenos">210</span></a>        <span class="n">R2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor-211"><a href="#LazyRegressor-211"><span class="linenos">211</span></a>        <span class="n">ADJR2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor-212"><a href="#LazyRegressor-212"><span class="linenos">212</span></a>        <span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor-213"><a href="#LazyRegressor-213"><span class="linenos">213</span></a>        <span class="c1"># WIN = []</span>
</span><span id="LazyRegressor-214"><a href="#LazyRegressor-214"><span class="linenos">214</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor-215"><a href="#LazyRegressor-215"><span class="linenos">215</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor-216"><a href="#LazyRegressor-216"><span class="linenos">216</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyRegressor-217"><a href="#LazyRegressor-217"><span class="linenos">217</span></a>
</span><span id="LazyRegressor-218"><a href="#LazyRegressor-218"><span class="linenos">218</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor-219"><a href="#LazyRegressor-219"><span class="linenos">219</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor-220"><a href="#LazyRegressor-220"><span class="linenos">220</span></a>
</span><span id="LazyRegressor-221"><a href="#LazyRegressor-221"><span class="linenos">221</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyRegressor-222"><a href="#LazyRegressor-222"><span class="linenos">222</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyRegressor-223"><a href="#LazyRegressor-223"><span class="linenos">223</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyRegressor-224"><a href="#LazyRegressor-224"><span class="linenos">224</span></a>
</span><span id="LazyRegressor-225"><a href="#LazyRegressor-225"><span class="linenos">225</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyRegressor-226"><a href="#LazyRegressor-226"><span class="linenos">226</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyRegressor-227"><a href="#LazyRegressor-227"><span class="linenos">227</span></a>
</span><span id="LazyRegressor-228"><a href="#LazyRegressor-228"><span class="linenos">228</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyRegressor-229"><a href="#LazyRegressor-229"><span class="linenos">229</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyRegressor-230"><a href="#LazyRegressor-230"><span class="linenos">230</span></a>        <span class="p">)</span>
</span><span id="LazyRegressor-231"><a href="#LazyRegressor-231"><span class="linenos">231</span></a>
</span><span id="LazyRegressor-232"><a href="#LazyRegressor-232"><span class="linenos">232</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyRegressor-233"><a href="#LazyRegressor-233"><span class="linenos">233</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyRegressor-234"><a href="#LazyRegressor-234"><span class="linenos">234</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyRegressor-235"><a href="#LazyRegressor-235"><span class="linenos">235</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyRegressor-236"><a href="#LazyRegressor-236"><span class="linenos">236</span></a>                    <span class="p">(</span>
</span><span id="LazyRegressor-237"><a href="#LazyRegressor-237"><span class="linenos">237</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-238"><a href="#LazyRegressor-238"><span class="linenos">238</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyRegressor-239"><a href="#LazyRegressor-239"><span class="linenos">239</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyRegressor-240"><a href="#LazyRegressor-240"><span class="linenos">240</span></a>                    <span class="p">),</span>
</span><span id="LazyRegressor-241"><a href="#LazyRegressor-241"><span class="linenos">241</span></a>                    <span class="p">(</span>
</span><span id="LazyRegressor-242"><a href="#LazyRegressor-242"><span class="linenos">242</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-243"><a href="#LazyRegressor-243"><span class="linenos">243</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyRegressor-244"><a href="#LazyRegressor-244"><span class="linenos">244</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyRegressor-245"><a href="#LazyRegressor-245"><span class="linenos">245</span></a>                    <span class="p">),</span>
</span><span id="LazyRegressor-246"><a href="#LazyRegressor-246"><span class="linenos">246</span></a>                <span class="p">]</span>
</span><span id="LazyRegressor-247"><a href="#LazyRegressor-247"><span class="linenos">247</span></a>            <span class="p">)</span>
</span><span id="LazyRegressor-248"><a href="#LazyRegressor-248"><span class="linenos">248</span></a>
</span><span id="LazyRegressor-249"><a href="#LazyRegressor-249"><span class="linenos">249</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyRegressor-250"><a href="#LazyRegressor-250"><span class="linenos">250</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="n">REGRESSORS</span>
</span><span id="LazyRegressor-251"><a href="#LazyRegressor-251"><span class="linenos">251</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyRegressor-252"><a href="#LazyRegressor-252"><span class="linenos">252</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyRegressor-253"><a href="#LazyRegressor-253"><span class="linenos">253</span></a>                <span class="p">(</span><span class="s2">&quot;CustomRegressor(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyRegressor-254"><a href="#LazyRegressor-254"><span class="linenos">254</span></a>                <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyRegressor-255"><a href="#LazyRegressor-255"><span class="linenos">255</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyRegressor-256"><a href="#LazyRegressor-256"><span class="linenos">256</span></a>                    <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyRegressor-257"><a href="#LazyRegressor-257"><span class="linenos">257</span></a>                    <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyRegressor-258"><a href="#LazyRegressor-258"><span class="linenos">258</span></a>                <span class="p">)</span>
</span><span id="LazyRegressor-259"><a href="#LazyRegressor-259"><span class="linenos">259</span></a>            <span class="p">]</span>
</span><span id="LazyRegressor-260"><a href="#LazyRegressor-260"><span class="linenos">260</span></a>
</span><span id="LazyRegressor-261"><a href="#LazyRegressor-261"><span class="linenos">261</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyRegressor-262"><a href="#LazyRegressor-262"><span class="linenos">262</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyRegressor-263"><a href="#LazyRegressor-263"><span class="linenos">263</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyRegressor-264"><a href="#LazyRegressor-264"><span class="linenos">264</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyRegressor-265"><a href="#LazyRegressor-265"><span class="linenos">265</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyRegressor-266"><a href="#LazyRegressor-266"><span class="linenos">266</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyRegressor-267"><a href="#LazyRegressor-267"><span class="linenos">267</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyRegressor-268"><a href="#LazyRegressor-268"><span class="linenos">268</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyRegressor-269"><a href="#LazyRegressor-269"><span class="linenos">269</span></a>                                <span class="p">(</span>
</span><span id="LazyRegressor-270"><a href="#LazyRegressor-270"><span class="linenos">270</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-271"><a href="#LazyRegressor-271"><span class="linenos">271</span></a>                                    <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyRegressor-272"><a href="#LazyRegressor-272"><span class="linenos">272</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyRegressor-273"><a href="#LazyRegressor-273"><span class="linenos">273</span></a>                                            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span>
</span><span id="LazyRegressor-274"><a href="#LazyRegressor-274"><span class="linenos">274</span></a>                                        <span class="p">),</span>
</span><span id="LazyRegressor-275"><a href="#LazyRegressor-275"><span class="linenos">275</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor-276"><a href="#LazyRegressor-276"><span class="linenos">276</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor-277"><a href="#LazyRegressor-277"><span class="linenos">277</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor-278"><a href="#LazyRegressor-278"><span class="linenos">278</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor-279"><a href="#LazyRegressor-279"><span class="linenos">279</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor-280"><a href="#LazyRegressor-280"><span class="linenos">280</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor-281"><a href="#LazyRegressor-281"><span class="linenos">281</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor-282"><a href="#LazyRegressor-282"><span class="linenos">282</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor-283"><a href="#LazyRegressor-283"><span class="linenos">283</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor-284"><a href="#LazyRegressor-284"><span class="linenos">284</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor-285"><a href="#LazyRegressor-285"><span class="linenos">285</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor-286"><a href="#LazyRegressor-286"><span class="linenos">286</span></a>                                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-287"><a href="#LazyRegressor-287"><span class="linenos">287</span></a>                                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-288"><a href="#LazyRegressor-288"><span class="linenos">288</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor-289"><a href="#LazyRegressor-289"><span class="linenos">289</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor-290"><a href="#LazyRegressor-290"><span class="linenos">290</span></a>                                    <span class="p">),</span>
</span><span id="LazyRegressor-291"><a href="#LazyRegressor-291"><span class="linenos">291</span></a>                                <span class="p">),</span>
</span><span id="LazyRegressor-292"><a href="#LazyRegressor-292"><span class="linenos">292</span></a>                            <span class="p">]</span>
</span><span id="LazyRegressor-293"><a href="#LazyRegressor-293"><span class="linenos">293</span></a>                        <span class="p">)</span>
</span><span id="LazyRegressor-294"><a href="#LazyRegressor-294"><span class="linenos">294</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyRegressor-295"><a href="#LazyRegressor-295"><span class="linenos">295</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyRegressor-296"><a href="#LazyRegressor-296"><span class="linenos">296</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyRegressor-297"><a href="#LazyRegressor-297"><span class="linenos">297</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyRegressor-298"><a href="#LazyRegressor-298"><span class="linenos">298</span></a>                                <span class="p">(</span>
</span><span id="LazyRegressor-299"><a href="#LazyRegressor-299"><span class="linenos">299</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor-300"><a href="#LazyRegressor-300"><span class="linenos">300</span></a>                                    <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyRegressor-301"><a href="#LazyRegressor-301"><span class="linenos">301</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyRegressor-302"><a href="#LazyRegressor-302"><span class="linenos">302</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor-303"><a href="#LazyRegressor-303"><span class="linenos">303</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor-304"><a href="#LazyRegressor-304"><span class="linenos">304</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor-305"><a href="#LazyRegressor-305"><span class="linenos">305</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor-306"><a href="#LazyRegressor-306"><span class="linenos">306</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor-307"><a href="#LazyRegressor-307"><span class="linenos">307</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor-308"><a href="#LazyRegressor-308"><span class="linenos">308</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor-309"><a href="#LazyRegressor-309"><span class="linenos">309</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor-310"><a href="#LazyRegressor-310"><span class="linenos">310</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor-311"><a href="#LazyRegressor-311"><span class="linenos">311</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor-312"><a href="#LazyRegressor-312"><span class="linenos">312</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor-313"><a href="#LazyRegressor-313"><span class="linenos">313</span></a>                                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-314"><a href="#LazyRegressor-314"><span class="linenos">314</span></a>                                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-315"><a href="#LazyRegressor-315"><span class="linenos">315</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor-316"><a href="#LazyRegressor-316"><span class="linenos">316</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor-317"><a href="#LazyRegressor-317"><span class="linenos">317</span></a>                                    <span class="p">),</span>
</span><span id="LazyRegressor-318"><a href="#LazyRegressor-318"><span class="linenos">318</span></a>                                <span class="p">),</span>
</span><span id="LazyRegressor-319"><a href="#LazyRegressor-319"><span class="linenos">319</span></a>                            <span class="p">]</span>
</span><span id="LazyRegressor-320"><a href="#LazyRegressor-320"><span class="linenos">320</span></a>                        <span class="p">)</span>
</span><span id="LazyRegressor-321"><a href="#LazyRegressor-321"><span class="linenos">321</span></a>
</span><span id="LazyRegressor-322"><a href="#LazyRegressor-322"><span class="linenos">322</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyRegressor-323"><a href="#LazyRegressor-323"><span class="linenos">323</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyRegressor-324"><a href="#LazyRegressor-324"><span class="linenos">324</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyRegressor-325"><a href="#LazyRegressor-325"><span class="linenos">325</span></a>
</span><span id="LazyRegressor-326"><a href="#LazyRegressor-326"><span class="linenos">326</span></a>                    <span class="n">r_squared</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyRegressor-327"><a href="#LazyRegressor-327"><span class="linenos">327</span></a>                    <span class="n">adj_rsquared</span> <span class="o">=</span> <span class="n">adjusted_rsquared</span><span class="p">(</span>
</span><span id="LazyRegressor-328"><a href="#LazyRegressor-328"><span class="linenos">328</span></a>                        <span class="n">r_squared</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LazyRegressor-329"><a href="#LazyRegressor-329"><span class="linenos">329</span></a>                    <span class="p">)</span>
</span><span id="LazyRegressor-330"><a href="#LazyRegressor-330"><span class="linenos">330</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyRegressor-331"><a href="#LazyRegressor-331"><span class="linenos">331</span></a>
</span><span id="LazyRegressor-332"><a href="#LazyRegressor-332"><span class="linenos">332</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyRegressor-333"><a href="#LazyRegressor-333"><span class="linenos">333</span></a>                    <span class="n">R2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_squared</span><span class="p">)</span>
</span><span id="LazyRegressor-334"><a href="#LazyRegressor-334"><span class="linenos">334</span></a>                    <span class="n">ADJR2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_rsquared</span><span class="p">)</span>
</span><span id="LazyRegressor-335"><a href="#LazyRegressor-335"><span class="linenos">335</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyRegressor-336"><a href="#LazyRegressor-336"><span class="linenos">336</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyRegressor-337"><a href="#LazyRegressor-337"><span class="linenos">337</span></a>
</span><span id="LazyRegressor-338"><a href="#LazyRegressor-338"><span class="linenos">338</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor-339"><a href="#LazyRegressor-339"><span class="linenos">339</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyRegressor-340"><a href="#LazyRegressor-340"><span class="linenos">340</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyRegressor-341"><a href="#LazyRegressor-341"><span class="linenos">341</span></a>
</span><span id="LazyRegressor-342"><a href="#LazyRegressor-342"><span class="linenos">342</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyRegressor-343"><a href="#LazyRegressor-343"><span class="linenos">343</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyRegressor-344"><a href="#LazyRegressor-344"><span class="linenos">344</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyRegressor-345"><a href="#LazyRegressor-345"><span class="linenos">345</span></a>                            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">r_squared</span><span class="p">,</span>
</span><span id="LazyRegressor-346"><a href="#LazyRegressor-346"><span class="linenos">346</span></a>                            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">adj_rsquared</span><span class="p">,</span>
</span><span id="LazyRegressor-347"><a href="#LazyRegressor-347"><span class="linenos">347</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyRegressor-348"><a href="#LazyRegressor-348"><span class="linenos">348</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyRegressor-349"><a href="#LazyRegressor-349"><span class="linenos">349</span></a>                        <span class="p">}</span>
</span><span id="LazyRegressor-350"><a href="#LazyRegressor-350"><span class="linenos">350</span></a>
</span><span id="LazyRegressor-351"><a href="#LazyRegressor-351"><span class="linenos">351</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor-352"><a href="#LazyRegressor-352"><span class="linenos">352</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyRegressor-353"><a href="#LazyRegressor-353"><span class="linenos">353</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyRegressor-354"><a href="#LazyRegressor-354"><span class="linenos">354</span></a>                            <span class="p">)</span>
</span><span id="LazyRegressor-355"><a href="#LazyRegressor-355"><span class="linenos">355</span></a>
</span><span id="LazyRegressor-356"><a href="#LazyRegressor-356"><span class="linenos">356</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyRegressor-357"><a href="#LazyRegressor-357"><span class="linenos">357</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyRegressor-358"><a href="#LazyRegressor-358"><span class="linenos">358</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyRegressor-359"><a href="#LazyRegressor-359"><span class="linenos">359</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyRegressor-360"><a href="#LazyRegressor-360"><span class="linenos">360</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyRegressor-361"><a href="#LazyRegressor-361"><span class="linenos">361</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyRegressor-362"><a href="#LazyRegressor-362"><span class="linenos">362</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyRegressor-363"><a href="#LazyRegressor-363"><span class="linenos">363</span></a>
</span><span id="LazyRegressor-364"><a href="#LazyRegressor-364"><span class="linenos">364</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyRegressor-365"><a href="#LazyRegressor-365"><span class="linenos">365</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyRegressor-366"><a href="#LazyRegressor-366"><span class="linenos">366</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyRegressor-367"><a href="#LazyRegressor-367"><span class="linenos">367</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyRegressor-368"><a href="#LazyRegressor-368"><span class="linenos">368</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyRegressor-369"><a href="#LazyRegressor-369"><span class="linenos">369</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyRegressor-370"><a href="#LazyRegressor-370"><span class="linenos">370</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">),</span>
</span><span id="LazyRegressor-371"><a href="#LazyRegressor-371"><span class="linenos">371</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor-372"><a href="#LazyRegressor-372"><span class="linenos">372</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor-373"><a href="#LazyRegressor-373"><span class="linenos">373</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor-374"><a href="#LazyRegressor-374"><span class="linenos">374</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor-375"><a href="#LazyRegressor-375"><span class="linenos">375</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor-376"><a href="#LazyRegressor-376"><span class="linenos">376</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor-377"><a href="#LazyRegressor-377"><span class="linenos">377</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor-378"><a href="#LazyRegressor-378"><span class="linenos">378</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor-379"><a href="#LazyRegressor-379"><span class="linenos">379</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor-380"><a href="#LazyRegressor-380"><span class="linenos">380</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor-381"><a href="#LazyRegressor-381"><span class="linenos">381</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor-382"><a href="#LazyRegressor-382"><span class="linenos">382</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-383"><a href="#LazyRegressor-383"><span class="linenos">383</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-384"><a href="#LazyRegressor-384"><span class="linenos">384</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor-385"><a href="#LazyRegressor-385"><span class="linenos">385</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor-386"><a href="#LazyRegressor-386"><span class="linenos">386</span></a>                        <span class="p">)</span>
</span><span id="LazyRegressor-387"><a href="#LazyRegressor-387"><span class="linenos">387</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyRegressor-388"><a href="#LazyRegressor-388"><span class="linenos">388</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyRegressor-389"><a href="#LazyRegressor-389"><span class="linenos">389</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyRegressor-390"><a href="#LazyRegressor-390"><span class="linenos">390</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor-391"><a href="#LazyRegressor-391"><span class="linenos">391</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor-392"><a href="#LazyRegressor-392"><span class="linenos">392</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor-393"><a href="#LazyRegressor-393"><span class="linenos">393</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor-394"><a href="#LazyRegressor-394"><span class="linenos">394</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor-395"><a href="#LazyRegressor-395"><span class="linenos">395</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor-396"><a href="#LazyRegressor-396"><span class="linenos">396</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor-397"><a href="#LazyRegressor-397"><span class="linenos">397</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor-398"><a href="#LazyRegressor-398"><span class="linenos">398</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor-399"><a href="#LazyRegressor-399"><span class="linenos">399</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor-400"><a href="#LazyRegressor-400"><span class="linenos">400</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor-401"><a href="#LazyRegressor-401"><span class="linenos">401</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-402"><a href="#LazyRegressor-402"><span class="linenos">402</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor-403"><a href="#LazyRegressor-403"><span class="linenos">403</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor-404"><a href="#LazyRegressor-404"><span class="linenos">404</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor-405"><a href="#LazyRegressor-405"><span class="linenos">405</span></a>                        <span class="p">)</span>
</span><span id="LazyRegressor-406"><a href="#LazyRegressor-406"><span class="linenos">406</span></a>
</span><span id="LazyRegressor-407"><a href="#LazyRegressor-407"><span class="linenos">407</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyRegressor-408"><a href="#LazyRegressor-408"><span class="linenos">408</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyRegressor-409"><a href="#LazyRegressor-409"><span class="linenos">409</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyRegressor-410"><a href="#LazyRegressor-410"><span class="linenos">410</span></a>
</span><span id="LazyRegressor-411"><a href="#LazyRegressor-411"><span class="linenos">411</span></a>                    <span class="n">r_squared</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyRegressor-412"><a href="#LazyRegressor-412"><span class="linenos">412</span></a>                    <span class="n">adj_rsquared</span> <span class="o">=</span> <span class="n">adjusted_rsquared</span><span class="p">(</span>
</span><span id="LazyRegressor-413"><a href="#LazyRegressor-413"><span class="linenos">413</span></a>                        <span class="n">r_squared</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LazyRegressor-414"><a href="#LazyRegressor-414"><span class="linenos">414</span></a>                    <span class="p">)</span>
</span><span id="LazyRegressor-415"><a href="#LazyRegressor-415"><span class="linenos">415</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyRegressor-416"><a href="#LazyRegressor-416"><span class="linenos">416</span></a>
</span><span id="LazyRegressor-417"><a href="#LazyRegressor-417"><span class="linenos">417</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyRegressor-418"><a href="#LazyRegressor-418"><span class="linenos">418</span></a>                    <span class="n">R2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_squared</span><span class="p">)</span>
</span><span id="LazyRegressor-419"><a href="#LazyRegressor-419"><span class="linenos">419</span></a>                    <span class="n">ADJR2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_rsquared</span><span class="p">)</span>
</span><span id="LazyRegressor-420"><a href="#LazyRegressor-420"><span class="linenos">420</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyRegressor-421"><a href="#LazyRegressor-421"><span class="linenos">421</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyRegressor-422"><a href="#LazyRegressor-422"><span class="linenos">422</span></a>
</span><span id="LazyRegressor-423"><a href="#LazyRegressor-423"><span class="linenos">423</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor-424"><a href="#LazyRegressor-424"><span class="linenos">424</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyRegressor-425"><a href="#LazyRegressor-425"><span class="linenos">425</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyRegressor-426"><a href="#LazyRegressor-426"><span class="linenos">426</span></a>
</span><span id="LazyRegressor-427"><a href="#LazyRegressor-427"><span class="linenos">427</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyRegressor-428"><a href="#LazyRegressor-428"><span class="linenos">428</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyRegressor-429"><a href="#LazyRegressor-429"><span class="linenos">429</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyRegressor-430"><a href="#LazyRegressor-430"><span class="linenos">430</span></a>                            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">r_squared</span><span class="p">,</span>
</span><span id="LazyRegressor-431"><a href="#LazyRegressor-431"><span class="linenos">431</span></a>                            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">adj_rsquared</span><span class="p">,</span>
</span><span id="LazyRegressor-432"><a href="#LazyRegressor-432"><span class="linenos">432</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyRegressor-433"><a href="#LazyRegressor-433"><span class="linenos">433</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyRegressor-434"><a href="#LazyRegressor-434"><span class="linenos">434</span></a>                        <span class="p">}</span>
</span><span id="LazyRegressor-435"><a href="#LazyRegressor-435"><span class="linenos">435</span></a>
</span><span id="LazyRegressor-436"><a href="#LazyRegressor-436"><span class="linenos">436</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor-437"><a href="#LazyRegressor-437"><span class="linenos">437</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyRegressor-438"><a href="#LazyRegressor-438"><span class="linenos">438</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyRegressor-439"><a href="#LazyRegressor-439"><span class="linenos">439</span></a>                            <span class="p">)</span>
</span><span id="LazyRegressor-440"><a href="#LazyRegressor-440"><span class="linenos">440</span></a>
</span><span id="LazyRegressor-441"><a href="#LazyRegressor-441"><span class="linenos">441</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyRegressor-442"><a href="#LazyRegressor-442"><span class="linenos">442</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyRegressor-443"><a href="#LazyRegressor-443"><span class="linenos">443</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyRegressor-444"><a href="#LazyRegressor-444"><span class="linenos">444</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyRegressor-445"><a href="#LazyRegressor-445"><span class="linenos">445</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyRegressor-446"><a href="#LazyRegressor-446"><span class="linenos">446</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyRegressor-447"><a href="#LazyRegressor-447"><span class="linenos">447</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyRegressor-448"><a href="#LazyRegressor-448"><span class="linenos">448</span></a>
</span><span id="LazyRegressor-449"><a href="#LazyRegressor-449"><span class="linenos">449</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyRegressor-450"><a href="#LazyRegressor-450"><span class="linenos">450</span></a>            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyRegressor-451"><a href="#LazyRegressor-451"><span class="linenos">451</span></a>            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">ADJR2</span><span class="p">,</span>
</span><span id="LazyRegressor-452"><a href="#LazyRegressor-452"><span class="linenos">452</span></a>            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">R2</span><span class="p">,</span>
</span><span id="LazyRegressor-453"><a href="#LazyRegressor-453"><span class="linenos">453</span></a>            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyRegressor-454"><a href="#LazyRegressor-454"><span class="linenos">454</span></a>            <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyRegressor-455"><a href="#LazyRegressor-455"><span class="linenos">455</span></a>        <span class="p">}</span>
</span><span id="LazyRegressor-456"><a href="#LazyRegressor-456"><span class="linenos">456</span></a>
</span><span id="LazyRegressor-457"><a href="#LazyRegressor-457"><span class="linenos">457</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor-458"><a href="#LazyRegressor-458"><span class="linenos">458</span></a>            <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">CUSTOM_METRIC</span>
</span><span id="LazyRegressor-459"><a href="#LazyRegressor-459"><span class="linenos">459</span></a>
</span><span id="LazyRegressor-460"><a href="#LazyRegressor-460"><span class="linenos">460</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LazyRegressor-461"><a href="#LazyRegressor-461"><span class="linenos">461</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyRegressor-462"><a href="#LazyRegressor-462"><span class="linenos">462</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyRegressor-463"><a href="#LazyRegressor-463"><span class="linenos">463</span></a>        <span class="p">)</span>
</span><span id="LazyRegressor-464"><a href="#LazyRegressor-464"><span class="linenos">464</span></a>
</span><span id="LazyRegressor-465"><a href="#LazyRegressor-465"><span class="linenos">465</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyRegressor-466"><a href="#LazyRegressor-466"><span class="linenos">466</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyRegressor-467"><a href="#LazyRegressor-467"><span class="linenos">467</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span><span id="LazyRegressor-468"><a href="#LazyRegressor-468"><span class="linenos">468</span></a>
</span><span id="LazyRegressor-469"><a href="#LazyRegressor-469"><span class="linenos">469</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyRegressor-470"><a href="#LazyRegressor-470"><span class="linenos">470</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyRegressor-471"><a href="#LazyRegressor-471"><span class="linenos">471</span></a><span class="sd">        This function returns all the model objects trained in fit function.</span>
</span><span id="LazyRegressor-472"><a href="#LazyRegressor-472"><span class="linenos">472</span></a><span class="sd">        If fit is not called already, then we call fit and then return the models.</span>
</span><span id="LazyRegressor-473"><a href="#LazyRegressor-473"><span class="linenos">473</span></a><span class="sd">        Parameters</span>
</span><span id="LazyRegressor-474"><a href="#LazyRegressor-474"><span class="linenos">474</span></a><span class="sd">        ----------</span>
</span><span id="LazyRegressor-475"><a href="#LazyRegressor-475"><span class="linenos">475</span></a><span class="sd">        X_train : array-like,</span>
</span><span id="LazyRegressor-476"><a href="#LazyRegressor-476"><span class="linenos">476</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor-477"><a href="#LazyRegressor-477"><span class="linenos">477</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyRegressor-478"><a href="#LazyRegressor-478"><span class="linenos">478</span></a><span class="sd">        X_test : array-like,</span>
</span><span id="LazyRegressor-479"><a href="#LazyRegressor-479"><span class="linenos">479</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor-480"><a href="#LazyRegressor-480"><span class="linenos">480</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyRegressor-481"><a href="#LazyRegressor-481"><span class="linenos">481</span></a><span class="sd">        y_train : array-like,</span>
</span><span id="LazyRegressor-482"><a href="#LazyRegressor-482"><span class="linenos">482</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor-483"><a href="#LazyRegressor-483"><span class="linenos">483</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyRegressor-484"><a href="#LazyRegressor-484"><span class="linenos">484</span></a><span class="sd">        y_test : array-like,</span>
</span><span id="LazyRegressor-485"><a href="#LazyRegressor-485"><span class="linenos">485</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor-486"><a href="#LazyRegressor-486"><span class="linenos">486</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyRegressor-487"><a href="#LazyRegressor-487"><span class="linenos">487</span></a><span class="sd">        Returns</span>
</span><span id="LazyRegressor-488"><a href="#LazyRegressor-488"><span class="linenos">488</span></a><span class="sd">        -------</span>
</span><span id="LazyRegressor-489"><a href="#LazyRegressor-489"><span class="linenos">489</span></a><span class="sd">        models: dict-object,</span>
</span><span id="LazyRegressor-490"><a href="#LazyRegressor-490"><span class="linenos">490</span></a><span class="sd">            Returns a dictionary with each model pipeline as value</span>
</span><span id="LazyRegressor-491"><a href="#LazyRegressor-491"><span class="linenos">491</span></a><span class="sd">            with key as name of models.</span>
</span><span id="LazyRegressor-492"><a href="#LazyRegressor-492"><span class="linenos">492</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyRegressor-493"><a href="#LazyRegressor-493"><span class="linenos">493</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyRegressor-494"><a href="#LazyRegressor-494"><span class="linenos">494</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span><span id="LazyRegressor-495"><a href="#LazyRegressor-495"><span class="linenos">495</span></a>
</span><span id="LazyRegressor-496"><a href="#LazyRegressor-496"><span class="linenos">496</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>Fitting a collection of regression models using nnetsauce's CustomRegressor</p>

<p>Parameters:</p>

<pre><code>verbose: int, optional (default=0)
    Any positive number for verbosity.

ignore_warnings: bool, optional (default=True)
    When set to True, the warning related to algorigms that are not able to run are ignored.

custom_metric: function, optional (default=None)
    When function is provided, models are evaluated based on the custom evaluation metric provided.

predictions: bool, optional (default=False)
    When set to True, the predictions of all the models models are returned as dataframe.

sort_by: string, optional (default='Accuracy')
    Sort models by a metric. Available options are 'Accuracy', 'Balanced Accuracy', 'ROC AUC', 'F1 Score'
    or a custom metric identified by its name and provided by custom_metric.

random_state: int, optional (default=42)
    Reproducibiility seed.

estimators: list, optional (default='all')
    a list of Estimators names or just 'all' (default='all')

preprocess: bool, preprocessing is done when set to True

n_jobs : int, when possible, run in parallel
    For now, only used by individual models that support it.

n_layers: int, optional (default=3)
    Number of layers of CustomRegressors to be used.

All the other parameters are the same as CustomRegressor's.
</code></pre>

<p>Examples:
    <div class="pdoc-code codehilite">
    <pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
    <span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_diabetes</span>
    <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_diabetes</span><span class="p">()</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>
    <span class="n">y</span><span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">target</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
    <span class="n">regr</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">LazyRegressor</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">models</span><span class="p">,</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="n">model_dictionary</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">provide_models</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">models</span><span class="p">)</span>
    </code></pre>
    </div></p>
</div>


                                <div id="LazyRegressor.fit" class="classattr">
                                            <input id="LazyRegressor.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">y_train</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyRegressor.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyRegressor.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyRegressor.fit-180"><a href="#LazyRegressor.fit-180"><span class="linenos">180</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyRegressor.fit-181"><a href="#LazyRegressor.fit-181"><span class="linenos">181</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X_train and y_train, predict and score on X_test, y_test.</span>
</span><span id="LazyRegressor.fit-182"><a href="#LazyRegressor.fit-182"><span class="linenos">182</span></a>
</span><span id="LazyRegressor.fit-183"><a href="#LazyRegressor.fit-183"><span class="linenos">183</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyRegressor.fit-184"><a href="#LazyRegressor.fit-184"><span class="linenos">184</span></a>
</span><span id="LazyRegressor.fit-185"><a href="#LazyRegressor.fit-185"><span class="linenos">185</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyRegressor.fit-186"><a href="#LazyRegressor.fit-186"><span class="linenos">186</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor.fit-187"><a href="#LazyRegressor.fit-187"><span class="linenos">187</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyRegressor.fit-188"><a href="#LazyRegressor.fit-188"><span class="linenos">188</span></a>
</span><span id="LazyRegressor.fit-189"><a href="#LazyRegressor.fit-189"><span class="linenos">189</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyRegressor.fit-190"><a href="#LazyRegressor.fit-190"><span class="linenos">190</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor.fit-191"><a href="#LazyRegressor.fit-191"><span class="linenos">191</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyRegressor.fit-192"><a href="#LazyRegressor.fit-192"><span class="linenos">192</span></a>
</span><span id="LazyRegressor.fit-193"><a href="#LazyRegressor.fit-193"><span class="linenos">193</span></a><span class="sd">            y_train : array-like,</span>
</span><span id="LazyRegressor.fit-194"><a href="#LazyRegressor.fit-194"><span class="linenos">194</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor.fit-195"><a href="#LazyRegressor.fit-195"><span class="linenos">195</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyRegressor.fit-196"><a href="#LazyRegressor.fit-196"><span class="linenos">196</span></a>
</span><span id="LazyRegressor.fit-197"><a href="#LazyRegressor.fit-197"><span class="linenos">197</span></a><span class="sd">            y_test : array-like,</span>
</span><span id="LazyRegressor.fit-198"><a href="#LazyRegressor.fit-198"><span class="linenos">198</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor.fit-199"><a href="#LazyRegressor.fit-199"><span class="linenos">199</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyRegressor.fit-200"><a href="#LazyRegressor.fit-200"><span class="linenos">200</span></a>
</span><span id="LazyRegressor.fit-201"><a href="#LazyRegressor.fit-201"><span class="linenos">201</span></a><span class="sd">        Returns:</span>
</span><span id="LazyRegressor.fit-202"><a href="#LazyRegressor.fit-202"><span class="linenos">202</span></a>
</span><span id="LazyRegressor.fit-203"><a href="#LazyRegressor.fit-203"><span class="linenos">203</span></a><span class="sd">        scores : Pandas DataFrame</span>
</span><span id="LazyRegressor.fit-204"><a href="#LazyRegressor.fit-204"><span class="linenos">204</span></a><span class="sd">            Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyRegressor.fit-205"><a href="#LazyRegressor.fit-205"><span class="linenos">205</span></a>
</span><span id="LazyRegressor.fit-206"><a href="#LazyRegressor.fit-206"><span class="linenos">206</span></a><span class="sd">        predictions : Pandas DataFrame</span>
</span><span id="LazyRegressor.fit-207"><a href="#LazyRegressor.fit-207"><span class="linenos">207</span></a><span class="sd">            Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyRegressor.fit-208"><a href="#LazyRegressor.fit-208"><span class="linenos">208</span></a>
</span><span id="LazyRegressor.fit-209"><a href="#LazyRegressor.fit-209"><span class="linenos">209</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyRegressor.fit-210"><a href="#LazyRegressor.fit-210"><span class="linenos">210</span></a>        <span class="n">R2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor.fit-211"><a href="#LazyRegressor.fit-211"><span class="linenos">211</span></a>        <span class="n">ADJR2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor.fit-212"><a href="#LazyRegressor.fit-212"><span class="linenos">212</span></a>        <span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor.fit-213"><a href="#LazyRegressor.fit-213"><span class="linenos">213</span></a>        <span class="c1"># WIN = []</span>
</span><span id="LazyRegressor.fit-214"><a href="#LazyRegressor.fit-214"><span class="linenos">214</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor.fit-215"><a href="#LazyRegressor.fit-215"><span class="linenos">215</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor.fit-216"><a href="#LazyRegressor.fit-216"><span class="linenos">216</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyRegressor.fit-217"><a href="#LazyRegressor.fit-217"><span class="linenos">217</span></a>
</span><span id="LazyRegressor.fit-218"><a href="#LazyRegressor.fit-218"><span class="linenos">218</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-219"><a href="#LazyRegressor.fit-219"><span class="linenos">219</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyRegressor.fit-220"><a href="#LazyRegressor.fit-220"><span class="linenos">220</span></a>
</span><span id="LazyRegressor.fit-221"><a href="#LazyRegressor.fit-221"><span class="linenos">221</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyRegressor.fit-222"><a href="#LazyRegressor.fit-222"><span class="linenos">222</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-223"><a href="#LazyRegressor.fit-223"><span class="linenos">223</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-224"><a href="#LazyRegressor.fit-224"><span class="linenos">224</span></a>
</span><span id="LazyRegressor.fit-225"><a href="#LazyRegressor.fit-225"><span class="linenos">225</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyRegressor.fit-226"><a href="#LazyRegressor.fit-226"><span class="linenos">226</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyRegressor.fit-227"><a href="#LazyRegressor.fit-227"><span class="linenos">227</span></a>
</span><span id="LazyRegressor.fit-228"><a href="#LazyRegressor.fit-228"><span class="linenos">228</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-229"><a href="#LazyRegressor.fit-229"><span class="linenos">229</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyRegressor.fit-230"><a href="#LazyRegressor.fit-230"><span class="linenos">230</span></a>        <span class="p">)</span>
</span><span id="LazyRegressor.fit-231"><a href="#LazyRegressor.fit-231"><span class="linenos">231</span></a>
</span><span id="LazyRegressor.fit-232"><a href="#LazyRegressor.fit-232"><span class="linenos">232</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-233"><a href="#LazyRegressor.fit-233"><span class="linenos">233</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-234"><a href="#LazyRegressor.fit-234"><span class="linenos">234</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyRegressor.fit-235"><a href="#LazyRegressor.fit-235"><span class="linenos">235</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyRegressor.fit-236"><a href="#LazyRegressor.fit-236"><span class="linenos">236</span></a>                    <span class="p">(</span>
</span><span id="LazyRegressor.fit-237"><a href="#LazyRegressor.fit-237"><span class="linenos">237</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-238"><a href="#LazyRegressor.fit-238"><span class="linenos">238</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-239"><a href="#LazyRegressor.fit-239"><span class="linenos">239</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-240"><a href="#LazyRegressor.fit-240"><span class="linenos">240</span></a>                    <span class="p">),</span>
</span><span id="LazyRegressor.fit-241"><a href="#LazyRegressor.fit-241"><span class="linenos">241</span></a>                    <span class="p">(</span>
</span><span id="LazyRegressor.fit-242"><a href="#LazyRegressor.fit-242"><span class="linenos">242</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-243"><a href="#LazyRegressor.fit-243"><span class="linenos">243</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-244"><a href="#LazyRegressor.fit-244"><span class="linenos">244</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-245"><a href="#LazyRegressor.fit-245"><span class="linenos">245</span></a>                    <span class="p">),</span>
</span><span id="LazyRegressor.fit-246"><a href="#LazyRegressor.fit-246"><span class="linenos">246</span></a>                <span class="p">]</span>
</span><span id="LazyRegressor.fit-247"><a href="#LazyRegressor.fit-247"><span class="linenos">247</span></a>            <span class="p">)</span>
</span><span id="LazyRegressor.fit-248"><a href="#LazyRegressor.fit-248"><span class="linenos">248</span></a>
</span><span id="LazyRegressor.fit-249"><a href="#LazyRegressor.fit-249"><span class="linenos">249</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-250"><a href="#LazyRegressor.fit-250"><span class="linenos">250</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="n">REGRESSORS</span>
</span><span id="LazyRegressor.fit-251"><a href="#LazyRegressor.fit-251"><span class="linenos">251</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-252"><a href="#LazyRegressor.fit-252"><span class="linenos">252</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyRegressor.fit-253"><a href="#LazyRegressor.fit-253"><span class="linenos">253</span></a>                <span class="p">(</span><span class="s2">&quot;CustomRegressor(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyRegressor.fit-254"><a href="#LazyRegressor.fit-254"><span class="linenos">254</span></a>                <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyRegressor.fit-255"><a href="#LazyRegressor.fit-255"><span class="linenos">255</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyRegressor.fit-256"><a href="#LazyRegressor.fit-256"><span class="linenos">256</span></a>                    <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-257"><a href="#LazyRegressor.fit-257"><span class="linenos">257</span></a>                    <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-258"><a href="#LazyRegressor.fit-258"><span class="linenos">258</span></a>                <span class="p">)</span>
</span><span id="LazyRegressor.fit-259"><a href="#LazyRegressor.fit-259"><span class="linenos">259</span></a>            <span class="p">]</span>
</span><span id="LazyRegressor.fit-260"><a href="#LazyRegressor.fit-260"><span class="linenos">260</span></a>
</span><span id="LazyRegressor.fit-261"><a href="#LazyRegressor.fit-261"><span class="linenos">261</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-262"><a href="#LazyRegressor.fit-262"><span class="linenos">262</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyRegressor.fit-263"><a href="#LazyRegressor.fit-263"><span class="linenos">263</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyRegressor.fit-264"><a href="#LazyRegressor.fit-264"><span class="linenos">264</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-265"><a href="#LazyRegressor.fit-265"><span class="linenos">265</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyRegressor.fit-266"><a href="#LazyRegressor.fit-266"><span class="linenos">266</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-267"><a href="#LazyRegressor.fit-267"><span class="linenos">267</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyRegressor.fit-268"><a href="#LazyRegressor.fit-268"><span class="linenos">268</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyRegressor.fit-269"><a href="#LazyRegressor.fit-269"><span class="linenos">269</span></a>                                <span class="p">(</span>
</span><span id="LazyRegressor.fit-270"><a href="#LazyRegressor.fit-270"><span class="linenos">270</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-271"><a href="#LazyRegressor.fit-271"><span class="linenos">271</span></a>                                    <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-272"><a href="#LazyRegressor.fit-272"><span class="linenos">272</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-273"><a href="#LazyRegressor.fit-273"><span class="linenos">273</span></a>                                            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span>
</span><span id="LazyRegressor.fit-274"><a href="#LazyRegressor.fit-274"><span class="linenos">274</span></a>                                        <span class="p">),</span>
</span><span id="LazyRegressor.fit-275"><a href="#LazyRegressor.fit-275"><span class="linenos">275</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-276"><a href="#LazyRegressor.fit-276"><span class="linenos">276</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-277"><a href="#LazyRegressor.fit-277"><span class="linenos">277</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-278"><a href="#LazyRegressor.fit-278"><span class="linenos">278</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-279"><a href="#LazyRegressor.fit-279"><span class="linenos">279</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-280"><a href="#LazyRegressor.fit-280"><span class="linenos">280</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-281"><a href="#LazyRegressor.fit-281"><span class="linenos">281</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-282"><a href="#LazyRegressor.fit-282"><span class="linenos">282</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-283"><a href="#LazyRegressor.fit-283"><span class="linenos">283</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-284"><a href="#LazyRegressor.fit-284"><span class="linenos">284</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-285"><a href="#LazyRegressor.fit-285"><span class="linenos">285</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-286"><a href="#LazyRegressor.fit-286"><span class="linenos">286</span></a>                                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-287"><a href="#LazyRegressor.fit-287"><span class="linenos">287</span></a>                                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-288"><a href="#LazyRegressor.fit-288"><span class="linenos">288</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-289"><a href="#LazyRegressor.fit-289"><span class="linenos">289</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-290"><a href="#LazyRegressor.fit-290"><span class="linenos">290</span></a>                                    <span class="p">),</span>
</span><span id="LazyRegressor.fit-291"><a href="#LazyRegressor.fit-291"><span class="linenos">291</span></a>                                <span class="p">),</span>
</span><span id="LazyRegressor.fit-292"><a href="#LazyRegressor.fit-292"><span class="linenos">292</span></a>                            <span class="p">]</span>
</span><span id="LazyRegressor.fit-293"><a href="#LazyRegressor.fit-293"><span class="linenos">293</span></a>                        <span class="p">)</span>
</span><span id="LazyRegressor.fit-294"><a href="#LazyRegressor.fit-294"><span class="linenos">294</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-295"><a href="#LazyRegressor.fit-295"><span class="linenos">295</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-296"><a href="#LazyRegressor.fit-296"><span class="linenos">296</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyRegressor.fit-297"><a href="#LazyRegressor.fit-297"><span class="linenos">297</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyRegressor.fit-298"><a href="#LazyRegressor.fit-298"><span class="linenos">298</span></a>                                <span class="p">(</span>
</span><span id="LazyRegressor.fit-299"><a href="#LazyRegressor.fit-299"><span class="linenos">299</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-300"><a href="#LazyRegressor.fit-300"><span class="linenos">300</span></a>                                    <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-301"><a href="#LazyRegressor.fit-301"><span class="linenos">301</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyRegressor.fit-302"><a href="#LazyRegressor.fit-302"><span class="linenos">302</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-303"><a href="#LazyRegressor.fit-303"><span class="linenos">303</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-304"><a href="#LazyRegressor.fit-304"><span class="linenos">304</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-305"><a href="#LazyRegressor.fit-305"><span class="linenos">305</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-306"><a href="#LazyRegressor.fit-306"><span class="linenos">306</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-307"><a href="#LazyRegressor.fit-307"><span class="linenos">307</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-308"><a href="#LazyRegressor.fit-308"><span class="linenos">308</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-309"><a href="#LazyRegressor.fit-309"><span class="linenos">309</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-310"><a href="#LazyRegressor.fit-310"><span class="linenos">310</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-311"><a href="#LazyRegressor.fit-311"><span class="linenos">311</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-312"><a href="#LazyRegressor.fit-312"><span class="linenos">312</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-313"><a href="#LazyRegressor.fit-313"><span class="linenos">313</span></a>                                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-314"><a href="#LazyRegressor.fit-314"><span class="linenos">314</span></a>                                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-315"><a href="#LazyRegressor.fit-315"><span class="linenos">315</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-316"><a href="#LazyRegressor.fit-316"><span class="linenos">316</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-317"><a href="#LazyRegressor.fit-317"><span class="linenos">317</span></a>                                    <span class="p">),</span>
</span><span id="LazyRegressor.fit-318"><a href="#LazyRegressor.fit-318"><span class="linenos">318</span></a>                                <span class="p">),</span>
</span><span id="LazyRegressor.fit-319"><a href="#LazyRegressor.fit-319"><span class="linenos">319</span></a>                            <span class="p">]</span>
</span><span id="LazyRegressor.fit-320"><a href="#LazyRegressor.fit-320"><span class="linenos">320</span></a>                        <span class="p">)</span>
</span><span id="LazyRegressor.fit-321"><a href="#LazyRegressor.fit-321"><span class="linenos">321</span></a>
</span><span id="LazyRegressor.fit-322"><a href="#LazyRegressor.fit-322"><span class="linenos">322</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-323"><a href="#LazyRegressor.fit-323"><span class="linenos">323</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyRegressor.fit-324"><a href="#LazyRegressor.fit-324"><span class="linenos">324</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-325"><a href="#LazyRegressor.fit-325"><span class="linenos">325</span></a>
</span><span id="LazyRegressor.fit-326"><a href="#LazyRegressor.fit-326"><span class="linenos">326</span></a>                    <span class="n">r_squared</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-327"><a href="#LazyRegressor.fit-327"><span class="linenos">327</span></a>                    <span class="n">adj_rsquared</span> <span class="o">=</span> <span class="n">adjusted_rsquared</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-328"><a href="#LazyRegressor.fit-328"><span class="linenos">328</span></a>                        <span class="n">r_squared</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LazyRegressor.fit-329"><a href="#LazyRegressor.fit-329"><span class="linenos">329</span></a>                    <span class="p">)</span>
</span><span id="LazyRegressor.fit-330"><a href="#LazyRegressor.fit-330"><span class="linenos">330</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-331"><a href="#LazyRegressor.fit-331"><span class="linenos">331</span></a>
</span><span id="LazyRegressor.fit-332"><a href="#LazyRegressor.fit-332"><span class="linenos">332</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-333"><a href="#LazyRegressor.fit-333"><span class="linenos">333</span></a>                    <span class="n">R2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_squared</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-334"><a href="#LazyRegressor.fit-334"><span class="linenos">334</span></a>                    <span class="n">ADJR2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_rsquared</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-335"><a href="#LazyRegressor.fit-335"><span class="linenos">335</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-336"><a href="#LazyRegressor.fit-336"><span class="linenos">336</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-337"><a href="#LazyRegressor.fit-337"><span class="linenos">337</span></a>
</span><span id="LazyRegressor.fit-338"><a href="#LazyRegressor.fit-338"><span class="linenos">338</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-339"><a href="#LazyRegressor.fit-339"><span class="linenos">339</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-340"><a href="#LazyRegressor.fit-340"><span class="linenos">340</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-341"><a href="#LazyRegressor.fit-341"><span class="linenos">341</span></a>
</span><span id="LazyRegressor.fit-342"><a href="#LazyRegressor.fit-342"><span class="linenos">342</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-343"><a href="#LazyRegressor.fit-343"><span class="linenos">343</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyRegressor.fit-344"><a href="#LazyRegressor.fit-344"><span class="linenos">344</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-345"><a href="#LazyRegressor.fit-345"><span class="linenos">345</span></a>                            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">r_squared</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-346"><a href="#LazyRegressor.fit-346"><span class="linenos">346</span></a>                            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">adj_rsquared</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-347"><a href="#LazyRegressor.fit-347"><span class="linenos">347</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-348"><a href="#LazyRegressor.fit-348"><span class="linenos">348</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-349"><a href="#LazyRegressor.fit-349"><span class="linenos">349</span></a>                        <span class="p">}</span>
</span><span id="LazyRegressor.fit-350"><a href="#LazyRegressor.fit-350"><span class="linenos">350</span></a>
</span><span id="LazyRegressor.fit-351"><a href="#LazyRegressor.fit-351"><span class="linenos">351</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-352"><a href="#LazyRegressor.fit-352"><span class="linenos">352</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyRegressor.fit-353"><a href="#LazyRegressor.fit-353"><span class="linenos">353</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyRegressor.fit-354"><a href="#LazyRegressor.fit-354"><span class="linenos">354</span></a>                            <span class="p">)</span>
</span><span id="LazyRegressor.fit-355"><a href="#LazyRegressor.fit-355"><span class="linenos">355</span></a>
</span><span id="LazyRegressor.fit-356"><a href="#LazyRegressor.fit-356"><span class="linenos">356</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-357"><a href="#LazyRegressor.fit-357"><span class="linenos">357</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-358"><a href="#LazyRegressor.fit-358"><span class="linenos">358</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyRegressor.fit-359"><a href="#LazyRegressor.fit-359"><span class="linenos">359</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-360"><a href="#LazyRegressor.fit-360"><span class="linenos">360</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-361"><a href="#LazyRegressor.fit-361"><span class="linenos">361</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-362"><a href="#LazyRegressor.fit-362"><span class="linenos">362</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-363"><a href="#LazyRegressor.fit-363"><span class="linenos">363</span></a>
</span><span id="LazyRegressor.fit-364"><a href="#LazyRegressor.fit-364"><span class="linenos">364</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-365"><a href="#LazyRegressor.fit-365"><span class="linenos">365</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyRegressor.fit-366"><a href="#LazyRegressor.fit-366"><span class="linenos">366</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyRegressor.fit-367"><a href="#LazyRegressor.fit-367"><span class="linenos">367</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-368"><a href="#LazyRegressor.fit-368"><span class="linenos">368</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyRegressor.fit-369"><a href="#LazyRegressor.fit-369"><span class="linenos">369</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-370"><a href="#LazyRegressor.fit-370"><span class="linenos">370</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">),</span>
</span><span id="LazyRegressor.fit-371"><a href="#LazyRegressor.fit-371"><span class="linenos">371</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-372"><a href="#LazyRegressor.fit-372"><span class="linenos">372</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-373"><a href="#LazyRegressor.fit-373"><span class="linenos">373</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-374"><a href="#LazyRegressor.fit-374"><span class="linenos">374</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-375"><a href="#LazyRegressor.fit-375"><span class="linenos">375</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-376"><a href="#LazyRegressor.fit-376"><span class="linenos">376</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-377"><a href="#LazyRegressor.fit-377"><span class="linenos">377</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-378"><a href="#LazyRegressor.fit-378"><span class="linenos">378</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-379"><a href="#LazyRegressor.fit-379"><span class="linenos">379</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-380"><a href="#LazyRegressor.fit-380"><span class="linenos">380</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-381"><a href="#LazyRegressor.fit-381"><span class="linenos">381</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-382"><a href="#LazyRegressor.fit-382"><span class="linenos">382</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-383"><a href="#LazyRegressor.fit-383"><span class="linenos">383</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-384"><a href="#LazyRegressor.fit-384"><span class="linenos">384</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-385"><a href="#LazyRegressor.fit-385"><span class="linenos">385</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-386"><a href="#LazyRegressor.fit-386"><span class="linenos">386</span></a>                        <span class="p">)</span>
</span><span id="LazyRegressor.fit-387"><a href="#LazyRegressor.fit-387"><span class="linenos">387</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-388"><a href="#LazyRegressor.fit-388"><span class="linenos">388</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-389"><a href="#LazyRegressor.fit-389"><span class="linenos">389</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyRegressor.fit-390"><a href="#LazyRegressor.fit-390"><span class="linenos">390</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-391"><a href="#LazyRegressor.fit-391"><span class="linenos">391</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-392"><a href="#LazyRegressor.fit-392"><span class="linenos">392</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-393"><a href="#LazyRegressor.fit-393"><span class="linenos">393</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-394"><a href="#LazyRegressor.fit-394"><span class="linenos">394</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-395"><a href="#LazyRegressor.fit-395"><span class="linenos">395</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-396"><a href="#LazyRegressor.fit-396"><span class="linenos">396</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-397"><a href="#LazyRegressor.fit-397"><span class="linenos">397</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-398"><a href="#LazyRegressor.fit-398"><span class="linenos">398</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-399"><a href="#LazyRegressor.fit-399"><span class="linenos">399</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-400"><a href="#LazyRegressor.fit-400"><span class="linenos">400</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-401"><a href="#LazyRegressor.fit-401"><span class="linenos">401</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-402"><a href="#LazyRegressor.fit-402"><span class="linenos">402</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-403"><a href="#LazyRegressor.fit-403"><span class="linenos">403</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-404"><a href="#LazyRegressor.fit-404"><span class="linenos">404</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-405"><a href="#LazyRegressor.fit-405"><span class="linenos">405</span></a>                        <span class="p">)</span>
</span><span id="LazyRegressor.fit-406"><a href="#LazyRegressor.fit-406"><span class="linenos">406</span></a>
</span><span id="LazyRegressor.fit-407"><a href="#LazyRegressor.fit-407"><span class="linenos">407</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-408"><a href="#LazyRegressor.fit-408"><span class="linenos">408</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyRegressor.fit-409"><a href="#LazyRegressor.fit-409"><span class="linenos">409</span></a>                    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-410"><a href="#LazyRegressor.fit-410"><span class="linenos">410</span></a>
</span><span id="LazyRegressor.fit-411"><a href="#LazyRegressor.fit-411"><span class="linenos">411</span></a>                    <span class="n">r_squared</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-412"><a href="#LazyRegressor.fit-412"><span class="linenos">412</span></a>                    <span class="n">adj_rsquared</span> <span class="o">=</span> <span class="n">adjusted_rsquared</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-413"><a href="#LazyRegressor.fit-413"><span class="linenos">413</span></a>                        <span class="n">r_squared</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LazyRegressor.fit-414"><a href="#LazyRegressor.fit-414"><span class="linenos">414</span></a>                    <span class="p">)</span>
</span><span id="LazyRegressor.fit-415"><a href="#LazyRegressor.fit-415"><span class="linenos">415</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-416"><a href="#LazyRegressor.fit-416"><span class="linenos">416</span></a>
</span><span id="LazyRegressor.fit-417"><a href="#LazyRegressor.fit-417"><span class="linenos">417</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-418"><a href="#LazyRegressor.fit-418"><span class="linenos">418</span></a>                    <span class="n">R2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_squared</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-419"><a href="#LazyRegressor.fit-419"><span class="linenos">419</span></a>                    <span class="n">ADJR2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_rsquared</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-420"><a href="#LazyRegressor.fit-420"><span class="linenos">420</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-421"><a href="#LazyRegressor.fit-421"><span class="linenos">421</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-422"><a href="#LazyRegressor.fit-422"><span class="linenos">422</span></a>
</span><span id="LazyRegressor.fit-423"><a href="#LazyRegressor.fit-423"><span class="linenos">423</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-424"><a href="#LazyRegressor.fit-424"><span class="linenos">424</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-425"><a href="#LazyRegressor.fit-425"><span class="linenos">425</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-426"><a href="#LazyRegressor.fit-426"><span class="linenos">426</span></a>
</span><span id="LazyRegressor.fit-427"><a href="#LazyRegressor.fit-427"><span class="linenos">427</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-428"><a href="#LazyRegressor.fit-428"><span class="linenos">428</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyRegressor.fit-429"><a href="#LazyRegressor.fit-429"><span class="linenos">429</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-430"><a href="#LazyRegressor.fit-430"><span class="linenos">430</span></a>                            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">r_squared</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-431"><a href="#LazyRegressor.fit-431"><span class="linenos">431</span></a>                            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">adj_rsquared</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-432"><a href="#LazyRegressor.fit-432"><span class="linenos">432</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-433"><a href="#LazyRegressor.fit-433"><span class="linenos">433</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-434"><a href="#LazyRegressor.fit-434"><span class="linenos">434</span></a>                        <span class="p">}</span>
</span><span id="LazyRegressor.fit-435"><a href="#LazyRegressor.fit-435"><span class="linenos">435</span></a>
</span><span id="LazyRegressor.fit-436"><a href="#LazyRegressor.fit-436"><span class="linenos">436</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-437"><a href="#LazyRegressor.fit-437"><span class="linenos">437</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyRegressor.fit-438"><a href="#LazyRegressor.fit-438"><span class="linenos">438</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyRegressor.fit-439"><a href="#LazyRegressor.fit-439"><span class="linenos">439</span></a>                            <span class="p">)</span>
</span><span id="LazyRegressor.fit-440"><a href="#LazyRegressor.fit-440"><span class="linenos">440</span></a>
</span><span id="LazyRegressor.fit-441"><a href="#LazyRegressor.fit-441"><span class="linenos">441</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-442"><a href="#LazyRegressor.fit-442"><span class="linenos">442</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-443"><a href="#LazyRegressor.fit-443"><span class="linenos">443</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyRegressor.fit-444"><a href="#LazyRegressor.fit-444"><span class="linenos">444</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-445"><a href="#LazyRegressor.fit-445"><span class="linenos">445</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-446"><a href="#LazyRegressor.fit-446"><span class="linenos">446</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-447"><a href="#LazyRegressor.fit-447"><span class="linenos">447</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-448"><a href="#LazyRegressor.fit-448"><span class="linenos">448</span></a>
</span><span id="LazyRegressor.fit-449"><a href="#LazyRegressor.fit-449"><span class="linenos">449</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyRegressor.fit-450"><a href="#LazyRegressor.fit-450"><span class="linenos">450</span></a>            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-451"><a href="#LazyRegressor.fit-451"><span class="linenos">451</span></a>            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">ADJR2</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-452"><a href="#LazyRegressor.fit-452"><span class="linenos">452</span></a>            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">R2</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-453"><a href="#LazyRegressor.fit-453"><span class="linenos">453</span></a>            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-454"><a href="#LazyRegressor.fit-454"><span class="linenos">454</span></a>            <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyRegressor.fit-455"><a href="#LazyRegressor.fit-455"><span class="linenos">455</span></a>        <span class="p">}</span>
</span><span id="LazyRegressor.fit-456"><a href="#LazyRegressor.fit-456"><span class="linenos">456</span></a>
</span><span id="LazyRegressor.fit-457"><a href="#LazyRegressor.fit-457"><span class="linenos">457</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-458"><a href="#LazyRegressor.fit-458"><span class="linenos">458</span></a>            <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">CUSTOM_METRIC</span>
</span><span id="LazyRegressor.fit-459"><a href="#LazyRegressor.fit-459"><span class="linenos">459</span></a>
</span><span id="LazyRegressor.fit-460"><a href="#LazyRegressor.fit-460"><span class="linenos">460</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-461"><a href="#LazyRegressor.fit-461"><span class="linenos">461</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyRegressor.fit-462"><a href="#LazyRegressor.fit-462"><span class="linenos">462</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyRegressor.fit-463"><a href="#LazyRegressor.fit-463"><span class="linenos">463</span></a>        <span class="p">)</span>
</span><span id="LazyRegressor.fit-464"><a href="#LazyRegressor.fit-464"><span class="linenos">464</span></a>
</span><span id="LazyRegressor.fit-465"><a href="#LazyRegressor.fit-465"><span class="linenos">465</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyRegressor.fit-466"><a href="#LazyRegressor.fit-466"><span class="linenos">466</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyRegressor.fit-467"><a href="#LazyRegressor.fit-467"><span class="linenos">467</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span></pre></div>


            <div class="docstring"><p>Fit Regression algorithms to X_train and y_train, predict and score on X_test, y_test.</p>

<p>Parameters:</p>

<pre><code>X_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.

y_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

y_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.
</code></pre>

<p>Returns:</p>

<p>scores : Pandas DataFrame
    Returns metrics of all the models in a Pandas DataFrame.</p>

<p>predictions : Pandas DataFrame
    Returns predictions of all the models in a Pandas DataFrame.</p>
</div>


                                </div>
                                <div id="LazyRegressor.provide_models" class="classattr">
                                            <input id="LazyRegressor.provide_models-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">provide_models</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">y_train</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyRegressor.provide_models-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyRegressor.provide_models"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyRegressor.provide_models-469"><a href="#LazyRegressor.provide_models-469"><span class="linenos">469</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyRegressor.provide_models-470"><a href="#LazyRegressor.provide_models-470"><span class="linenos">470</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyRegressor.provide_models-471"><a href="#LazyRegressor.provide_models-471"><span class="linenos">471</span></a><span class="sd">        This function returns all the model objects trained in fit function.</span>
</span><span id="LazyRegressor.provide_models-472"><a href="#LazyRegressor.provide_models-472"><span class="linenos">472</span></a><span class="sd">        If fit is not called already, then we call fit and then return the models.</span>
</span><span id="LazyRegressor.provide_models-473"><a href="#LazyRegressor.provide_models-473"><span class="linenos">473</span></a><span class="sd">        Parameters</span>
</span><span id="LazyRegressor.provide_models-474"><a href="#LazyRegressor.provide_models-474"><span class="linenos">474</span></a><span class="sd">        ----------</span>
</span><span id="LazyRegressor.provide_models-475"><a href="#LazyRegressor.provide_models-475"><span class="linenos">475</span></a><span class="sd">        X_train : array-like,</span>
</span><span id="LazyRegressor.provide_models-476"><a href="#LazyRegressor.provide_models-476"><span class="linenos">476</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor.provide_models-477"><a href="#LazyRegressor.provide_models-477"><span class="linenos">477</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyRegressor.provide_models-478"><a href="#LazyRegressor.provide_models-478"><span class="linenos">478</span></a><span class="sd">        X_test : array-like,</span>
</span><span id="LazyRegressor.provide_models-479"><a href="#LazyRegressor.provide_models-479"><span class="linenos">479</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor.provide_models-480"><a href="#LazyRegressor.provide_models-480"><span class="linenos">480</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyRegressor.provide_models-481"><a href="#LazyRegressor.provide_models-481"><span class="linenos">481</span></a><span class="sd">        y_train : array-like,</span>
</span><span id="LazyRegressor.provide_models-482"><a href="#LazyRegressor.provide_models-482"><span class="linenos">482</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor.provide_models-483"><a href="#LazyRegressor.provide_models-483"><span class="linenos">483</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyRegressor.provide_models-484"><a href="#LazyRegressor.provide_models-484"><span class="linenos">484</span></a><span class="sd">        y_test : array-like,</span>
</span><span id="LazyRegressor.provide_models-485"><a href="#LazyRegressor.provide_models-485"><span class="linenos">485</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyRegressor.provide_models-486"><a href="#LazyRegressor.provide_models-486"><span class="linenos">486</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyRegressor.provide_models-487"><a href="#LazyRegressor.provide_models-487"><span class="linenos">487</span></a><span class="sd">        Returns</span>
</span><span id="LazyRegressor.provide_models-488"><a href="#LazyRegressor.provide_models-488"><span class="linenos">488</span></a><span class="sd">        -------</span>
</span><span id="LazyRegressor.provide_models-489"><a href="#LazyRegressor.provide_models-489"><span class="linenos">489</span></a><span class="sd">        models: dict-object,</span>
</span><span id="LazyRegressor.provide_models-490"><a href="#LazyRegressor.provide_models-490"><span class="linenos">490</span></a><span class="sd">            Returns a dictionary with each model pipeline as value</span>
</span><span id="LazyRegressor.provide_models-491"><a href="#LazyRegressor.provide_models-491"><span class="linenos">491</span></a><span class="sd">            with key as name of models.</span>
</span><span id="LazyRegressor.provide_models-492"><a href="#LazyRegressor.provide_models-492"><span class="linenos">492</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyRegressor.provide_models-493"><a href="#LazyRegressor.provide_models-493"><span class="linenos">493</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyRegressor.provide_models-494"><a href="#LazyRegressor.provide_models-494"><span class="linenos">494</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span><span id="LazyRegressor.provide_models-495"><a href="#LazyRegressor.provide_models-495"><span class="linenos">495</span></a>
</span><span id="LazyRegressor.provide_models-496"><a href="#LazyRegressor.provide_models-496"><span class="linenos">496</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>This function returns all the model objects trained in fit function.
If fit is not called already, then we call fit and then return the models.</p>

<h2 id="parameters">Parameters</h2>

<p>X_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.
X_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.
y_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.
y_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.</p>

<h2 id="returns">Returns</h2>

<p>models: dict-object,
    Returns a dictionary with each model pipeline as value
    with key as name of models.</p>
</div>


                                </div>
                        
                </section>
                <section id="LazyMTS">
                            <input id="LazyMTS-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LazyMTS</span><wbr>(<span class="base">nnetsauce.mts.mts.MTS</span>):

                <label class="view-source-button" for="LazyMTS-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyMTS"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyMTS-75"><a href="#LazyMTS-75"><span class="linenos"> 75</span></a><span class="k">class</span> <span class="nc">LazyMTS</span><span class="p">(</span><span class="n">MTS</span><span class="p">):</span>
</span><span id="LazyMTS-76"><a href="#LazyMTS-76"><span class="linenos"> 76</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyMTS-77"><a href="#LazyMTS-77"><span class="linenos"> 77</span></a>
</span><span id="LazyMTS-78"><a href="#LazyMTS-78"><span class="linenos"> 78</span></a><span class="sd">    Fitting -- almost -- all the regression algorithms with layers of</span>
</span><span id="LazyMTS-79"><a href="#LazyMTS-79"><span class="linenos"> 79</span></a><span class="sd">    nnetsauce&#39;s CustomRegressor to multivariate time series</span>
</span><span id="LazyMTS-80"><a href="#LazyMTS-80"><span class="linenos"> 80</span></a><span class="sd">    and returning their scores.</span>
</span><span id="LazyMTS-81"><a href="#LazyMTS-81"><span class="linenos"> 81</span></a>
</span><span id="LazyMTS-82"><a href="#LazyMTS-82"><span class="linenos"> 82</span></a><span class="sd">    Parameters:</span>
</span><span id="LazyMTS-83"><a href="#LazyMTS-83"><span class="linenos"> 83</span></a>
</span><span id="LazyMTS-84"><a href="#LazyMTS-84"><span class="linenos"> 84</span></a><span class="sd">        verbose: int, optional (default=0)</span>
</span><span id="LazyMTS-85"><a href="#LazyMTS-85"><span class="linenos"> 85</span></a><span class="sd">            Any positive number for verbosity.</span>
</span><span id="LazyMTS-86"><a href="#LazyMTS-86"><span class="linenos"> 86</span></a>
</span><span id="LazyMTS-87"><a href="#LazyMTS-87"><span class="linenos"> 87</span></a><span class="sd">        ignore_warnings: bool, optional (default=True)</span>
</span><span id="LazyMTS-88"><a href="#LazyMTS-88"><span class="linenos"> 88</span></a><span class="sd">            When set to True, the warning related to algorigms that are not</span>
</span><span id="LazyMTS-89"><a href="#LazyMTS-89"><span class="linenos"> 89</span></a><span class="sd">            able to run are ignored.</span>
</span><span id="LazyMTS-90"><a href="#LazyMTS-90"><span class="linenos"> 90</span></a>
</span><span id="LazyMTS-91"><a href="#LazyMTS-91"><span class="linenos"> 91</span></a><span class="sd">        custom_metric: function, optional (default=None)</span>
</span><span id="LazyMTS-92"><a href="#LazyMTS-92"><span class="linenos"> 92</span></a><span class="sd">            When function is provided, models are evaluated based on the custom</span>
</span><span id="LazyMTS-93"><a href="#LazyMTS-93"><span class="linenos"> 93</span></a><span class="sd">              evaluation metric provided.</span>
</span><span id="LazyMTS-94"><a href="#LazyMTS-94"><span class="linenos"> 94</span></a>
</span><span id="LazyMTS-95"><a href="#LazyMTS-95"><span class="linenos"> 95</span></a><span class="sd">        predictions: bool, optional (default=False)</span>
</span><span id="LazyMTS-96"><a href="#LazyMTS-96"><span class="linenos"> 96</span></a><span class="sd">            When set to True, the predictions of all the models models are returned as dataframe.</span>
</span><span id="LazyMTS-97"><a href="#LazyMTS-97"><span class="linenos"> 97</span></a>
</span><span id="LazyMTS-98"><a href="#LazyMTS-98"><span class="linenos"> 98</span></a><span class="sd">        sort_by: string, optional (default=&#39;RMSE&#39;)</span>
</span><span id="LazyMTS-99"><a href="#LazyMTS-99"><span class="linenos"> 99</span></a><span class="sd">            Sort models by a metric. Available options are &#39;RMSE&#39;, &#39;MAE&#39;, &#39;MPL&#39;, &#39;MPE&#39;, &#39;MAPE&#39;,</span>
</span><span id="LazyMTS-100"><a href="#LazyMTS-100"><span class="linenos">100</span></a><span class="sd">            &#39;R-Squared&#39;, &#39;Adjusted R-Squared&#39; or a custom metric identified by its name and</span>
</span><span id="LazyMTS-101"><a href="#LazyMTS-101"><span class="linenos">101</span></a><span class="sd">            provided by custom_metric.</span>
</span><span id="LazyMTS-102"><a href="#LazyMTS-102"><span class="linenos">102</span></a>
</span><span id="LazyMTS-103"><a href="#LazyMTS-103"><span class="linenos">103</span></a><span class="sd">        random_state: int, optional (default=42)</span>
</span><span id="LazyMTS-104"><a href="#LazyMTS-104"><span class="linenos">104</span></a><span class="sd">            Reproducibiility seed.</span>
</span><span id="LazyMTS-105"><a href="#LazyMTS-105"><span class="linenos">105</span></a>
</span><span id="LazyMTS-106"><a href="#LazyMTS-106"><span class="linenos">106</span></a><span class="sd">        estimators: list, optional (default=&#39;all&#39;)</span>
</span><span id="LazyMTS-107"><a href="#LazyMTS-107"><span class="linenos">107</span></a><span class="sd">            list of Estimators (regression algorithms) names or just &#39;all&#39; (default=&#39;all&#39;)</span>
</span><span id="LazyMTS-108"><a href="#LazyMTS-108"><span class="linenos">108</span></a>
</span><span id="LazyMTS-109"><a href="#LazyMTS-109"><span class="linenos">109</span></a><span class="sd">        preprocess: bool, preprocessing is done when set to True</span>
</span><span id="LazyMTS-110"><a href="#LazyMTS-110"><span class="linenos">110</span></a>
</span><span id="LazyMTS-111"><a href="#LazyMTS-111"><span class="linenos">111</span></a><span class="sd">        n_jobs : int, when possible, run in parallel</span>
</span><span id="LazyMTS-112"><a href="#LazyMTS-112"><span class="linenos">112</span></a><span class="sd">            For now, only used by individual models that support it.</span>
</span><span id="LazyMTS-113"><a href="#LazyMTS-113"><span class="linenos">113</span></a>
</span><span id="LazyMTS-114"><a href="#LazyMTS-114"><span class="linenos">114</span></a><span class="sd">        n_layers: int, optional (default=3)</span>
</span><span id="LazyMTS-115"><a href="#LazyMTS-115"><span class="linenos">115</span></a><span class="sd">            Number of layers of CustomRegressors to be used.</span>
</span><span id="LazyMTS-116"><a href="#LazyMTS-116"><span class="linenos">116</span></a>
</span><span id="LazyMTS-117"><a href="#LazyMTS-117"><span class="linenos">117</span></a><span class="sd">        All the other parameters are the same as MTS&#39;s.</span>
</span><span id="LazyMTS-118"><a href="#LazyMTS-118"><span class="linenos">118</span></a>
</span><span id="LazyMTS-119"><a href="#LazyMTS-119"><span class="linenos">119</span></a><span class="sd">    Examples:</span>
</span><span id="LazyMTS-120"><a href="#LazyMTS-120"><span class="linenos">120</span></a>
</span><span id="LazyMTS-121"><a href="#LazyMTS-121"><span class="linenos">121</span></a><span class="sd">        See https://thierrymoudiki.github.io/blog/2023/10/29/python/quasirandomizednn/MTS-LazyPredict</span>
</span><span id="LazyMTS-122"><a href="#LazyMTS-122"><span class="linenos">122</span></a>
</span><span id="LazyMTS-123"><a href="#LazyMTS-123"><span class="linenos">123</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LazyMTS-124"><a href="#LazyMTS-124"><span class="linenos">124</span></a>
</span><span id="LazyMTS-125"><a href="#LazyMTS-125"><span class="linenos">125</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyMTS-126"><a href="#LazyMTS-126"><span class="linenos">126</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="LazyMTS-127"><a href="#LazyMTS-127"><span class="linenos">127</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyMTS-128"><a href="#LazyMTS-128"><span class="linenos">128</span></a>        <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyMTS-129"><a href="#LazyMTS-129"><span class="linenos">129</span></a>        <span class="n">custom_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyMTS-130"><a href="#LazyMTS-130"><span class="linenos">130</span></a>        <span class="n">predictions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyMTS-131"><a href="#LazyMTS-131"><span class="linenos">131</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="LazyMTS-132"><a href="#LazyMTS-132"><span class="linenos">132</span></a>        <span class="n">estimators</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-133"><a href="#LazyMTS-133"><span class="linenos">133</span></a>        <span class="n">preprocess</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyMTS-134"><a href="#LazyMTS-134"><span class="linenos">134</span></a>        <span class="c1"># MTS attributes</span>
</span><span id="LazyMTS-135"><a href="#LazyMTS-135"><span class="linenos">135</span></a>        <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyMTS-136"><a href="#LazyMTS-136"><span class="linenos">136</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="LazyMTS-137"><a href="#LazyMTS-137"><span class="linenos">137</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-138"><a href="#LazyMTS-138"><span class="linenos">138</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="LazyMTS-139"><a href="#LazyMTS-139"><span class="linenos">139</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-140"><a href="#LazyMTS-140"><span class="linenos">140</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyMTS-141"><a href="#LazyMTS-141"><span class="linenos">141</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyMTS-142"><a href="#LazyMTS-142"><span class="linenos">142</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyMTS-143"><a href="#LazyMTS-143"><span class="linenos">143</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="LazyMTS-144"><a href="#LazyMTS-144"><span class="linenos">144</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyMTS-145"><a href="#LazyMTS-145"><span class="linenos">145</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-146"><a href="#LazyMTS-146"><span class="linenos">146</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="LazyMTS-147"><a href="#LazyMTS-147"><span class="linenos">147</span></a>        <span class="n">lags</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyMTS-148"><a href="#LazyMTS-148"><span class="linenos">148</span></a>        <span class="n">replications</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyMTS-149"><a href="#LazyMTS-149"><span class="linenos">149</span></a>        <span class="n">kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyMTS-150"><a href="#LazyMTS-150"><span class="linenos">150</span></a>        <span class="n">agg</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-151"><a href="#LazyMTS-151"><span class="linenos">151</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="LazyMTS-152"><a href="#LazyMTS-152"><span class="linenos">152</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-153"><a href="#LazyMTS-153"><span class="linenos">153</span></a>        <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyMTS-154"><a href="#LazyMTS-154"><span class="linenos">154</span></a>    <span class="p">):</span>
</span><span id="LazyMTS-155"><a href="#LazyMTS-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="LazyMTS-156"><a href="#LazyMTS-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="o">=</span> <span class="n">ignore_warnings</span>
</span><span id="LazyMTS-157"><a href="#LazyMTS-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="o">=</span> <span class="n">custom_metric</span>
</span><span id="LazyMTS-158"><a href="#LazyMTS-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span>
</span><span id="LazyMTS-159"><a href="#LazyMTS-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyMTS-160"><a href="#LazyMTS-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="LazyMTS-161"><a href="#LazyMTS-161"><span class="linenos">161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">=</span> <span class="n">estimators</span>
</span><span id="LazyMTS-162"><a href="#LazyMTS-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="o">=</span> <span class="n">preprocess</span>
</span><span id="LazyMTS-163"><a href="#LazyMTS-163"><span class="linenos">163</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyMTS-164"><a href="#LazyMTS-164"><span class="linenos">164</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="LazyMTS-165"><a href="#LazyMTS-165"><span class="linenos">165</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS-166"><a href="#LazyMTS-166"><span class="linenos">166</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS-167"><a href="#LazyMTS-167"><span class="linenos">167</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS-168"><a href="#LazyMTS-168"><span class="linenos">168</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS-169"><a href="#LazyMTS-169"><span class="linenos">169</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS-170"><a href="#LazyMTS-170"><span class="linenos">170</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS-171"><a href="#LazyMTS-171"><span class="linenos">171</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS-172"><a href="#LazyMTS-172"><span class="linenos">172</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS-173"><a href="#LazyMTS-173"><span class="linenos">173</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS-174"><a href="#LazyMTS-174"><span class="linenos">174</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS-175"><a href="#LazyMTS-175"><span class="linenos">175</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS-176"><a href="#LazyMTS-176"><span class="linenos">176</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS-177"><a href="#LazyMTS-177"><span class="linenos">177</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS-178"><a href="#LazyMTS-178"><span class="linenos">178</span></a>            <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS-179"><a href="#LazyMTS-179"><span class="linenos">179</span></a>            <span class="n">replications</span><span class="o">=</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS-180"><a href="#LazyMTS-180"><span class="linenos">180</span></a>            <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS-181"><a href="#LazyMTS-181"><span class="linenos">181</span></a>            <span class="n">agg</span><span class="o">=</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS-182"><a href="#LazyMTS-182"><span class="linenos">182</span></a>            <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS-183"><a href="#LazyMTS-183"><span class="linenos">183</span></a>        <span class="p">)</span>
</span><span id="LazyMTS-184"><a href="#LazyMTS-184"><span class="linenos">184</span></a>
</span><span id="LazyMTS-185"><a href="#LazyMTS-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">xreg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="LazyMTS-186"><a href="#LazyMTS-186"><span class="linenos">186</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X_train, predict and score on X_test.</span>
</span><span id="LazyMTS-187"><a href="#LazyMTS-187"><span class="linenos">187</span></a>
</span><span id="LazyMTS-188"><a href="#LazyMTS-188"><span class="linenos">188</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyMTS-189"><a href="#LazyMTS-189"><span class="linenos">189</span></a>
</span><span id="LazyMTS-190"><a href="#LazyMTS-190"><span class="linenos">190</span></a><span class="sd">            X_train: array-like,</span>
</span><span id="LazyMTS-191"><a href="#LazyMTS-191"><span class="linenos">191</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyMTS-192"><a href="#LazyMTS-192"><span class="linenos">192</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyMTS-193"><a href="#LazyMTS-193"><span class="linenos">193</span></a>
</span><span id="LazyMTS-194"><a href="#LazyMTS-194"><span class="linenos">194</span></a><span class="sd">            X_test: array-like,</span>
</span><span id="LazyMTS-195"><a href="#LazyMTS-195"><span class="linenos">195</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyMTS-196"><a href="#LazyMTS-196"><span class="linenos">196</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyMTS-197"><a href="#LazyMTS-197"><span class="linenos">197</span></a>
</span><span id="LazyMTS-198"><a href="#LazyMTS-198"><span class="linenos">198</span></a><span class="sd">            xreg: array-like, optional (default=None)</span>
</span><span id="LazyMTS-199"><a href="#LazyMTS-199"><span class="linenos">199</span></a><span class="sd">                Additional (external) regressors to be passed to self.obj</span>
</span><span id="LazyMTS-200"><a href="#LazyMTS-200"><span class="linenos">200</span></a><span class="sd">                xreg must be in &#39;increasing&#39; order (most recent observations last)</span>
</span><span id="LazyMTS-201"><a href="#LazyMTS-201"><span class="linenos">201</span></a>
</span><span id="LazyMTS-202"><a href="#LazyMTS-202"><span class="linenos">202</span></a><span class="sd">        Returns:</span>
</span><span id="LazyMTS-203"><a href="#LazyMTS-203"><span class="linenos">203</span></a>
</span><span id="LazyMTS-204"><a href="#LazyMTS-204"><span class="linenos">204</span></a><span class="sd">            scores: Pandas DataFrame</span>
</span><span id="LazyMTS-205"><a href="#LazyMTS-205"><span class="linenos">205</span></a><span class="sd">                Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyMTS-206"><a href="#LazyMTS-206"><span class="linenos">206</span></a>
</span><span id="LazyMTS-207"><a href="#LazyMTS-207"><span class="linenos">207</span></a><span class="sd">            predictions: Pandas DataFrame</span>
</span><span id="LazyMTS-208"><a href="#LazyMTS-208"><span class="linenos">208</span></a><span class="sd">                Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyMTS-209"><a href="#LazyMTS-209"><span class="linenos">209</span></a>
</span><span id="LazyMTS-210"><a href="#LazyMTS-210"><span class="linenos">210</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyMTS-211"><a href="#LazyMTS-211"><span class="linenos">211</span></a>        <span class="n">R2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-212"><a href="#LazyMTS-212"><span class="linenos">212</span></a>        <span class="n">ADJR2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-213"><a href="#LazyMTS-213"><span class="linenos">213</span></a>        <span class="n">ME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-214"><a href="#LazyMTS-214"><span class="linenos">214</span></a>        <span class="n">MPL</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-215"><a href="#LazyMTS-215"><span class="linenos">215</span></a>        <span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-216"><a href="#LazyMTS-216"><span class="linenos">216</span></a>        <span class="n">MAE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-217"><a href="#LazyMTS-217"><span class="linenos">217</span></a>        <span class="n">MPE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-218"><a href="#LazyMTS-218"><span class="linenos">218</span></a>        <span class="n">MAPE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-219"><a href="#LazyMTS-219"><span class="linenos">219</span></a>
</span><span id="LazyMTS-220"><a href="#LazyMTS-220"><span class="linenos">220</span></a>        <span class="c1"># WIN = []</span>
</span><span id="LazyMTS-221"><a href="#LazyMTS-221"><span class="linenos">221</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-222"><a href="#LazyMTS-222"><span class="linenos">222</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-223"><a href="#LazyMTS-223"><span class="linenos">223</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyMTS-224"><a href="#LazyMTS-224"><span class="linenos">224</span></a>
</span><span id="LazyMTS-225"><a href="#LazyMTS-225"><span class="linenos">225</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS-226"><a href="#LazyMTS-226"><span class="linenos">226</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS-227"><a href="#LazyMTS-227"><span class="linenos">227</span></a>
</span><span id="LazyMTS-228"><a href="#LazyMTS-228"><span class="linenos">228</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyMTS-229"><a href="#LazyMTS-229"><span class="linenos">229</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyMTS-230"><a href="#LazyMTS-230"><span class="linenos">230</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyMTS-231"><a href="#LazyMTS-231"><span class="linenos">231</span></a>
</span><span id="LazyMTS-232"><a href="#LazyMTS-232"><span class="linenos">232</span></a>        <span class="n">X_train</span> <span class="o">=</span> <span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyMTS-233"><a href="#LazyMTS-233"><span class="linenos">233</span></a>        <span class="n">X_test</span> <span class="o">=</span> <span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyMTS-234"><a href="#LazyMTS-234"><span class="linenos">234</span></a>
</span><span id="LazyMTS-235"><a href="#LazyMTS-235"><span class="linenos">235</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyMTS-236"><a href="#LazyMTS-236"><span class="linenos">236</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyMTS-237"><a href="#LazyMTS-237"><span class="linenos">237</span></a>
</span><span id="LazyMTS-238"><a href="#LazyMTS-238"><span class="linenos">238</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyMTS-239"><a href="#LazyMTS-239"><span class="linenos">239</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyMTS-240"><a href="#LazyMTS-240"><span class="linenos">240</span></a>        <span class="p">)</span>
</span><span id="LazyMTS-241"><a href="#LazyMTS-241"><span class="linenos">241</span></a>
</span><span id="LazyMTS-242"><a href="#LazyMTS-242"><span class="linenos">242</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span><span class="p">:</span>
</span><span id="LazyMTS-243"><a href="#LazyMTS-243"><span class="linenos">243</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyMTS-244"><a href="#LazyMTS-244"><span class="linenos">244</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyMTS-245"><a href="#LazyMTS-245"><span class="linenos">245</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyMTS-246"><a href="#LazyMTS-246"><span class="linenos">246</span></a>                    <span class="p">(</span>
</span><span id="LazyMTS-247"><a href="#LazyMTS-247"><span class="linenos">247</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-248"><a href="#LazyMTS-248"><span class="linenos">248</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyMTS-249"><a href="#LazyMTS-249"><span class="linenos">249</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyMTS-250"><a href="#LazyMTS-250"><span class="linenos">250</span></a>                    <span class="p">),</span>
</span><span id="LazyMTS-251"><a href="#LazyMTS-251"><span class="linenos">251</span></a>                    <span class="p">(</span>
</span><span id="LazyMTS-252"><a href="#LazyMTS-252"><span class="linenos">252</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-253"><a href="#LazyMTS-253"><span class="linenos">253</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyMTS-254"><a href="#LazyMTS-254"><span class="linenos">254</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyMTS-255"><a href="#LazyMTS-255"><span class="linenos">255</span></a>                    <span class="p">),</span>
</span><span id="LazyMTS-256"><a href="#LazyMTS-256"><span class="linenos">256</span></a>                <span class="p">]</span>
</span><span id="LazyMTS-257"><a href="#LazyMTS-257"><span class="linenos">257</span></a>            <span class="p">)</span>
</span><span id="LazyMTS-258"><a href="#LazyMTS-258"><span class="linenos">258</span></a>
</span><span id="LazyMTS-259"><a href="#LazyMTS-259"><span class="linenos">259</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyMTS-260"><a href="#LazyMTS-260"><span class="linenos">260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="n">REGRESSORSMTS</span>
</span><span id="LazyMTS-261"><a href="#LazyMTS-261"><span class="linenos">261</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS-262"><a href="#LazyMTS-262"><span class="linenos">262</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyMTS-263"><a href="#LazyMTS-263"><span class="linenos">263</span></a>                <span class="p">(</span><span class="s2">&quot;MTS(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyMTS-264"><a href="#LazyMTS-264"><span class="linenos">264</span></a>                <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyMTS-265"><a href="#LazyMTS-265"><span class="linenos">265</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyMTS-266"><a href="#LazyMTS-266"><span class="linenos">266</span></a>                    <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyMTS-267"><a href="#LazyMTS-267"><span class="linenos">267</span></a>                    <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyMTS-268"><a href="#LazyMTS-268"><span class="linenos">268</span></a>                <span class="p">)</span>
</span><span id="LazyMTS-269"><a href="#LazyMTS-269"><span class="linenos">269</span></a>            <span class="p">]</span>
</span><span id="LazyMTS-270"><a href="#LazyMTS-270"><span class="linenos">270</span></a>
</span><span id="LazyMTS-271"><a href="#LazyMTS-271"><span class="linenos">271</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyMTS-272"><a href="#LazyMTS-272"><span class="linenos">272</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyMTS-273"><a href="#LazyMTS-273"><span class="linenos">273</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyMTS-274"><a href="#LazyMTS-274"><span class="linenos">274</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyMTS-275"><a href="#LazyMTS-275"><span class="linenos">275</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyMTS-276"><a href="#LazyMTS-276"><span class="linenos">276</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyMTS-277"><a href="#LazyMTS-277"><span class="linenos">277</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyMTS-278"><a href="#LazyMTS-278"><span class="linenos">278</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyMTS-279"><a href="#LazyMTS-279"><span class="linenos">279</span></a>                                <span class="p">(</span>
</span><span id="LazyMTS-280"><a href="#LazyMTS-280"><span class="linenos">280</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-281"><a href="#LazyMTS-281"><span class="linenos">281</span></a>                                    <span class="n">MTS</span><span class="p">(</span>
</span><span id="LazyMTS-282"><a href="#LazyMTS-282"><span class="linenos">282</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyMTS-283"><a href="#LazyMTS-283"><span class="linenos">283</span></a>                                            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="LazyMTS-284"><a href="#LazyMTS-284"><span class="linenos">284</span></a>                                            <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyMTS-285"><a href="#LazyMTS-285"><span class="linenos">285</span></a>                                        <span class="p">),</span>
</span><span id="LazyMTS-286"><a href="#LazyMTS-286"><span class="linenos">286</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS-287"><a href="#LazyMTS-287"><span class="linenos">287</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS-288"><a href="#LazyMTS-288"><span class="linenos">288</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS-289"><a href="#LazyMTS-289"><span class="linenos">289</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS-290"><a href="#LazyMTS-290"><span class="linenos">290</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS-291"><a href="#LazyMTS-291"><span class="linenos">291</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS-292"><a href="#LazyMTS-292"><span class="linenos">292</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS-293"><a href="#LazyMTS-293"><span class="linenos">293</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS-294"><a href="#LazyMTS-294"><span class="linenos">294</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS-295"><a href="#LazyMTS-295"><span class="linenos">295</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS-296"><a href="#LazyMTS-296"><span class="linenos">296</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS-297"><a href="#LazyMTS-297"><span class="linenos">297</span></a>                                        <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS-298"><a href="#LazyMTS-298"><span class="linenos">298</span></a>                                        <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS-299"><a href="#LazyMTS-299"><span class="linenos">299</span></a>                                        <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS-300"><a href="#LazyMTS-300"><span class="linenos">300</span></a>                                        <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS-301"><a href="#LazyMTS-301"><span class="linenos">301</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS-302"><a href="#LazyMTS-302"><span class="linenos">302</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS-303"><a href="#LazyMTS-303"><span class="linenos">303</span></a>                                        <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS-304"><a href="#LazyMTS-304"><span class="linenos">304</span></a>                                    <span class="p">),</span>
</span><span id="LazyMTS-305"><a href="#LazyMTS-305"><span class="linenos">305</span></a>                                <span class="p">),</span>
</span><span id="LazyMTS-306"><a href="#LazyMTS-306"><span class="linenos">306</span></a>                            <span class="p">]</span>
</span><span id="LazyMTS-307"><a href="#LazyMTS-307"><span class="linenos">307</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS-308"><a href="#LazyMTS-308"><span class="linenos">308</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS-309"><a href="#LazyMTS-309"><span class="linenos">309</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyMTS-310"><a href="#LazyMTS-310"><span class="linenos">310</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyMTS-311"><a href="#LazyMTS-311"><span class="linenos">311</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyMTS-312"><a href="#LazyMTS-312"><span class="linenos">312</span></a>                                <span class="p">(</span>
</span><span id="LazyMTS-313"><a href="#LazyMTS-313"><span class="linenos">313</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyMTS-314"><a href="#LazyMTS-314"><span class="linenos">314</span></a>                                    <span class="n">MTS</span><span class="p">(</span>
</span><span id="LazyMTS-315"><a href="#LazyMTS-315"><span class="linenos">315</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyMTS-316"><a href="#LazyMTS-316"><span class="linenos">316</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS-317"><a href="#LazyMTS-317"><span class="linenos">317</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS-318"><a href="#LazyMTS-318"><span class="linenos">318</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS-319"><a href="#LazyMTS-319"><span class="linenos">319</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS-320"><a href="#LazyMTS-320"><span class="linenos">320</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS-321"><a href="#LazyMTS-321"><span class="linenos">321</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS-322"><a href="#LazyMTS-322"><span class="linenos">322</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS-323"><a href="#LazyMTS-323"><span class="linenos">323</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS-324"><a href="#LazyMTS-324"><span class="linenos">324</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS-325"><a href="#LazyMTS-325"><span class="linenos">325</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS-326"><a href="#LazyMTS-326"><span class="linenos">326</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS-327"><a href="#LazyMTS-327"><span class="linenos">327</span></a>                                        <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS-328"><a href="#LazyMTS-328"><span class="linenos">328</span></a>                                        <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS-329"><a href="#LazyMTS-329"><span class="linenos">329</span></a>                                        <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS-330"><a href="#LazyMTS-330"><span class="linenos">330</span></a>                                        <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS-331"><a href="#LazyMTS-331"><span class="linenos">331</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS-332"><a href="#LazyMTS-332"><span class="linenos">332</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS-333"><a href="#LazyMTS-333"><span class="linenos">333</span></a>                                        <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS-334"><a href="#LazyMTS-334"><span class="linenos">334</span></a>                                    <span class="p">),</span>
</span><span id="LazyMTS-335"><a href="#LazyMTS-335"><span class="linenos">335</span></a>                                <span class="p">),</span>
</span><span id="LazyMTS-336"><a href="#LazyMTS-336"><span class="linenos">336</span></a>                            <span class="p">]</span>
</span><span id="LazyMTS-337"><a href="#LazyMTS-337"><span class="linenos">337</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS-338"><a href="#LazyMTS-338"><span class="linenos">338</span></a>
</span><span id="LazyMTS-339"><a href="#LazyMTS-339"><span class="linenos">339</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="LazyMTS-340"><a href="#LazyMTS-340"><span class="linenos">340</span></a>                    <span class="c1"># pipe.fit(X_train, xreg=xreg)</span>
</span><span id="LazyMTS-341"><a href="#LazyMTS-341"><span class="linenos">341</span></a>
</span><span id="LazyMTS-342"><a href="#LazyMTS-342"><span class="linenos">342</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyMTS-343"><a href="#LazyMTS-343"><span class="linenos">343</span></a>
</span><span id="LazyMTS-344"><a href="#LazyMTS-344"><span class="linenos">344</span></a>                    <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">[</span><span class="s2">&quot;regressor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyMTS-345"><a href="#LazyMTS-345"><span class="linenos">345</span></a>                        <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyMTS-346"><a href="#LazyMTS-346"><span class="linenos">346</span></a>                    <span class="p">)</span>
</span><span id="LazyMTS-347"><a href="#LazyMTS-347"><span class="linenos">347</span></a>
</span><span id="LazyMTS-348"><a href="#LazyMTS-348"><span class="linenos">348</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyMTS-349"><a href="#LazyMTS-349"><span class="linenos">349</span></a>                    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS-350"><a href="#LazyMTS-350"><span class="linenos">350</span></a>                    <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS-351"><a href="#LazyMTS-351"><span class="linenos">351</span></a>
</span><span id="LazyMTS-352"><a href="#LazyMTS-352"><span class="linenos">352</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyMTS-353"><a href="#LazyMTS-353"><span class="linenos">353</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyMTS-354"><a href="#LazyMTS-354"><span class="linenos">354</span></a>                    <span class="n">MAE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</span><span id="LazyMTS-355"><a href="#LazyMTS-355"><span class="linenos">355</span></a>                    <span class="n">MPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpl</span><span class="p">)</span>
</span><span id="LazyMTS-356"><a href="#LazyMTS-356"><span class="linenos">356</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyMTS-357"><a href="#LazyMTS-357"><span class="linenos">357</span></a>
</span><span id="LazyMTS-358"><a href="#LazyMTS-358"><span class="linenos">358</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS-359"><a href="#LazyMTS-359"><span class="linenos">359</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS-360"><a href="#LazyMTS-360"><span class="linenos">360</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyMTS-361"><a href="#LazyMTS-361"><span class="linenos">361</span></a>
</span><span id="LazyMTS-362"><a href="#LazyMTS-362"><span class="linenos">362</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyMTS-363"><a href="#LazyMTS-363"><span class="linenos">363</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS-364"><a href="#LazyMTS-364"><span class="linenos">364</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyMTS-365"><a href="#LazyMTS-365"><span class="linenos">365</span></a>                            <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyMTS-366"><a href="#LazyMTS-366"><span class="linenos">366</span></a>                            <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyMTS-367"><a href="#LazyMTS-367"><span class="linenos">367</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyMTS-368"><a href="#LazyMTS-368"><span class="linenos">368</span></a>                            <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyMTS-369"><a href="#LazyMTS-369"><span class="linenos">369</span></a>                            <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyMTS-370"><a href="#LazyMTS-370"><span class="linenos">370</span></a>                            <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyMTS-371"><a href="#LazyMTS-371"><span class="linenos">371</span></a>                            <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyMTS-372"><a href="#LazyMTS-372"><span class="linenos">372</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyMTS-373"><a href="#LazyMTS-373"><span class="linenos">373</span></a>                        <span class="p">}</span>
</span><span id="LazyMTS-374"><a href="#LazyMTS-374"><span class="linenos">374</span></a>
</span><span id="LazyMTS-375"><a href="#LazyMTS-375"><span class="linenos">375</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS-376"><a href="#LazyMTS-376"><span class="linenos">376</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyMTS-377"><a href="#LazyMTS-377"><span class="linenos">377</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyMTS-378"><a href="#LazyMTS-378"><span class="linenos">378</span></a>                            <span class="p">)</span>
</span><span id="LazyMTS-379"><a href="#LazyMTS-379"><span class="linenos">379</span></a>
</span><span id="LazyMTS-380"><a href="#LazyMTS-380"><span class="linenos">380</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyMTS-381"><a href="#LazyMTS-381"><span class="linenos">381</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyMTS-382"><a href="#LazyMTS-382"><span class="linenos">382</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_pred</span>
</span><span id="LazyMTS-383"><a href="#LazyMTS-383"><span class="linenos">383</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyMTS-384"><a href="#LazyMTS-384"><span class="linenos">384</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyMTS-385"><a href="#LazyMTS-385"><span class="linenos">385</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyMTS-386"><a href="#LazyMTS-386"><span class="linenos">386</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyMTS-387"><a href="#LazyMTS-387"><span class="linenos">387</span></a>
</span><span id="LazyMTS-388"><a href="#LazyMTS-388"><span class="linenos">388</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># no preprocessing</span>
</span><span id="LazyMTS-389"><a href="#LazyMTS-389"><span class="linenos">389</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyMTS-390"><a href="#LazyMTS-390"><span class="linenos">390</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyMTS-391"><a href="#LazyMTS-391"><span class="linenos">391</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyMTS-392"><a href="#LazyMTS-392"><span class="linenos">392</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyMTS-393"><a href="#LazyMTS-393"><span class="linenos">393</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">MTS</span><span class="p">(</span>
</span><span id="LazyMTS-394"><a href="#LazyMTS-394"><span class="linenos">394</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyMTS-395"><a href="#LazyMTS-395"><span class="linenos">395</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS-396"><a href="#LazyMTS-396"><span class="linenos">396</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS-397"><a href="#LazyMTS-397"><span class="linenos">397</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS-398"><a href="#LazyMTS-398"><span class="linenos">398</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS-399"><a href="#LazyMTS-399"><span class="linenos">399</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS-400"><a href="#LazyMTS-400"><span class="linenos">400</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS-401"><a href="#LazyMTS-401"><span class="linenos">401</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS-402"><a href="#LazyMTS-402"><span class="linenos">402</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS-403"><a href="#LazyMTS-403"><span class="linenos">403</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS-404"><a href="#LazyMTS-404"><span class="linenos">404</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS-405"><a href="#LazyMTS-405"><span class="linenos">405</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS-406"><a href="#LazyMTS-406"><span class="linenos">406</span></a>                            <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS-407"><a href="#LazyMTS-407"><span class="linenos">407</span></a>                            <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS-408"><a href="#LazyMTS-408"><span class="linenos">408</span></a>                            <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS-409"><a href="#LazyMTS-409"><span class="linenos">409</span></a>                            <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS-410"><a href="#LazyMTS-410"><span class="linenos">410</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS-411"><a href="#LazyMTS-411"><span class="linenos">411</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS-412"><a href="#LazyMTS-412"><span class="linenos">412</span></a>                            <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS-413"><a href="#LazyMTS-413"><span class="linenos">413</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS-414"><a href="#LazyMTS-414"><span class="linenos">414</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS-415"><a href="#LazyMTS-415"><span class="linenos">415</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">MTS</span><span class="p">(</span>
</span><span id="LazyMTS-416"><a href="#LazyMTS-416"><span class="linenos">416</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyMTS-417"><a href="#LazyMTS-417"><span class="linenos">417</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS-418"><a href="#LazyMTS-418"><span class="linenos">418</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS-419"><a href="#LazyMTS-419"><span class="linenos">419</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS-420"><a href="#LazyMTS-420"><span class="linenos">420</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS-421"><a href="#LazyMTS-421"><span class="linenos">421</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS-422"><a href="#LazyMTS-422"><span class="linenos">422</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS-423"><a href="#LazyMTS-423"><span class="linenos">423</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS-424"><a href="#LazyMTS-424"><span class="linenos">424</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS-425"><a href="#LazyMTS-425"><span class="linenos">425</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS-426"><a href="#LazyMTS-426"><span class="linenos">426</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS-427"><a href="#LazyMTS-427"><span class="linenos">427</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS-428"><a href="#LazyMTS-428"><span class="linenos">428</span></a>                            <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS-429"><a href="#LazyMTS-429"><span class="linenos">429</span></a>                            <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS-430"><a href="#LazyMTS-430"><span class="linenos">430</span></a>                            <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS-431"><a href="#LazyMTS-431"><span class="linenos">431</span></a>                            <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS-432"><a href="#LazyMTS-432"><span class="linenos">432</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS-433"><a href="#LazyMTS-433"><span class="linenos">433</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS-434"><a href="#LazyMTS-434"><span class="linenos">434</span></a>                            <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS-435"><a href="#LazyMTS-435"><span class="linenos">435</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS-436"><a href="#LazyMTS-436"><span class="linenos">436</span></a>
</span><span id="LazyMTS-437"><a href="#LazyMTS-437"><span class="linenos">437</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">xreg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="LazyMTS-438"><a href="#LazyMTS-438"><span class="linenos">438</span></a>                    <span class="c1"># pipe.fit(X_train, xreg=xreg) # DO xreg like in `ahead`</span>
</span><span id="LazyMTS-439"><a href="#LazyMTS-439"><span class="linenos">439</span></a>
</span><span id="LazyMTS-440"><a href="#LazyMTS-440"><span class="linenos">440</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyMTS-441"><a href="#LazyMTS-441"><span class="linenos">441</span></a>
</span><span id="LazyMTS-442"><a href="#LazyMTS-442"><span class="linenos">442</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyMTS-443"><a href="#LazyMTS-443"><span class="linenos">443</span></a>                        <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">[</span><span class="s2">&quot;regressor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyMTS-444"><a href="#LazyMTS-444"><span class="linenos">444</span></a>                            <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyMTS-445"><a href="#LazyMTS-445"><span class="linenos">445</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS-446"><a href="#LazyMTS-446"><span class="linenos">446</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS-447"><a href="#LazyMTS-447"><span class="linenos">447</span></a>                        <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyMTS-448"><a href="#LazyMTS-448"><span class="linenos">448</span></a>                            <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyMTS-449"><a href="#LazyMTS-449"><span class="linenos">449</span></a>                        <span class="p">)</span>  <span class="c1"># X_pred = pipe.predict(h=X_test.shape[0], new_xreg=new_xreg) ## DO xreg like in `ahead`</span>
</span><span id="LazyMTS-450"><a href="#LazyMTS-450"><span class="linenos">450</span></a>
</span><span id="LazyMTS-451"><a href="#LazyMTS-451"><span class="linenos">451</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyMTS-452"><a href="#LazyMTS-452"><span class="linenos">452</span></a>                    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS-453"><a href="#LazyMTS-453"><span class="linenos">453</span></a>                    <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS-454"><a href="#LazyMTS-454"><span class="linenos">454</span></a>
</span><span id="LazyMTS-455"><a href="#LazyMTS-455"><span class="linenos">455</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyMTS-456"><a href="#LazyMTS-456"><span class="linenos">456</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyMTS-457"><a href="#LazyMTS-457"><span class="linenos">457</span></a>                    <span class="n">MAE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</span><span id="LazyMTS-458"><a href="#LazyMTS-458"><span class="linenos">458</span></a>                    <span class="n">MPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpl</span><span class="p">)</span>
</span><span id="LazyMTS-459"><a href="#LazyMTS-459"><span class="linenos">459</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyMTS-460"><a href="#LazyMTS-460"><span class="linenos">460</span></a>
</span><span id="LazyMTS-461"><a href="#LazyMTS-461"><span class="linenos">461</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS-462"><a href="#LazyMTS-462"><span class="linenos">462</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS-463"><a href="#LazyMTS-463"><span class="linenos">463</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyMTS-464"><a href="#LazyMTS-464"><span class="linenos">464</span></a>
</span><span id="LazyMTS-465"><a href="#LazyMTS-465"><span class="linenos">465</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyMTS-466"><a href="#LazyMTS-466"><span class="linenos">466</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS-467"><a href="#LazyMTS-467"><span class="linenos">467</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyMTS-468"><a href="#LazyMTS-468"><span class="linenos">468</span></a>                            <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyMTS-469"><a href="#LazyMTS-469"><span class="linenos">469</span></a>                            <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyMTS-470"><a href="#LazyMTS-470"><span class="linenos">470</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyMTS-471"><a href="#LazyMTS-471"><span class="linenos">471</span></a>                            <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyMTS-472"><a href="#LazyMTS-472"><span class="linenos">472</span></a>                            <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyMTS-473"><a href="#LazyMTS-473"><span class="linenos">473</span></a>                            <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyMTS-474"><a href="#LazyMTS-474"><span class="linenos">474</span></a>                            <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyMTS-475"><a href="#LazyMTS-475"><span class="linenos">475</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyMTS-476"><a href="#LazyMTS-476"><span class="linenos">476</span></a>                        <span class="p">}</span>
</span><span id="LazyMTS-477"><a href="#LazyMTS-477"><span class="linenos">477</span></a>
</span><span id="LazyMTS-478"><a href="#LazyMTS-478"><span class="linenos">478</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS-479"><a href="#LazyMTS-479"><span class="linenos">479</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyMTS-480"><a href="#LazyMTS-480"><span class="linenos">480</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyMTS-481"><a href="#LazyMTS-481"><span class="linenos">481</span></a>                            <span class="p">)</span>
</span><span id="LazyMTS-482"><a href="#LazyMTS-482"><span class="linenos">482</span></a>
</span><span id="LazyMTS-483"><a href="#LazyMTS-483"><span class="linenos">483</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyMTS-484"><a href="#LazyMTS-484"><span class="linenos">484</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyMTS-485"><a href="#LazyMTS-485"><span class="linenos">485</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_pred</span>
</span><span id="LazyMTS-486"><a href="#LazyMTS-486"><span class="linenos">486</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyMTS-487"><a href="#LazyMTS-487"><span class="linenos">487</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyMTS-488"><a href="#LazyMTS-488"><span class="linenos">488</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyMTS-489"><a href="#LazyMTS-489"><span class="linenos">489</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyMTS-490"><a href="#LazyMTS-490"><span class="linenos">490</span></a>
</span><span id="LazyMTS-491"><a href="#LazyMTS-491"><span class="linenos">491</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS-492"><a href="#LazyMTS-492"><span class="linenos">492</span></a>            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyMTS-493"><a href="#LazyMTS-493"><span class="linenos">493</span></a>            <span class="c1"># &quot;Adjusted R-Squared&quot;: ADJR2,</span>
</span><span id="LazyMTS-494"><a href="#LazyMTS-494"><span class="linenos">494</span></a>            <span class="c1"># &quot;R-Squared&quot;: R2,</span>
</span><span id="LazyMTS-495"><a href="#LazyMTS-495"><span class="linenos">495</span></a>            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyMTS-496"><a href="#LazyMTS-496"><span class="linenos">496</span></a>            <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">MAE</span><span class="p">,</span>
</span><span id="LazyMTS-497"><a href="#LazyMTS-497"><span class="linenos">497</span></a>            <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">MPL</span><span class="p">,</span>
</span><span id="LazyMTS-498"><a href="#LazyMTS-498"><span class="linenos">498</span></a>            <span class="c1"># &quot;MPE&quot;: MPE,</span>
</span><span id="LazyMTS-499"><a href="#LazyMTS-499"><span class="linenos">499</span></a>            <span class="c1"># &quot;MAPE&quot;: MAPE,</span>
</span><span id="LazyMTS-500"><a href="#LazyMTS-500"><span class="linenos">500</span></a>            <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyMTS-501"><a href="#LazyMTS-501"><span class="linenos">501</span></a>        <span class="p">}</span>
</span><span id="LazyMTS-502"><a href="#LazyMTS-502"><span class="linenos">502</span></a>
</span><span id="LazyMTS-503"><a href="#LazyMTS-503"><span class="linenos">503</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS-504"><a href="#LazyMTS-504"><span class="linenos">504</span></a>            <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">CUSTOM_METRIC</span>
</span><span id="LazyMTS-505"><a href="#LazyMTS-505"><span class="linenos">505</span></a>
</span><span id="LazyMTS-506"><a href="#LazyMTS-506"><span class="linenos">506</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LazyMTS-507"><a href="#LazyMTS-507"><span class="linenos">507</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyMTS-508"><a href="#LazyMTS-508"><span class="linenos">508</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyMTS-509"><a href="#LazyMTS-509"><span class="linenos">509</span></a>        <span class="p">)</span>
</span><span id="LazyMTS-510"><a href="#LazyMTS-510"><span class="linenos">510</span></a>
</span><span id="LazyMTS-511"><a href="#LazyMTS-511"><span class="linenos">511</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyMTS-512"><a href="#LazyMTS-512"><span class="linenos">512</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyMTS-513"><a href="#LazyMTS-513"><span class="linenos">513</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span><span id="LazyMTS-514"><a href="#LazyMTS-514"><span class="linenos">514</span></a>
</span><span id="LazyMTS-515"><a href="#LazyMTS-515"><span class="linenos">515</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">):</span>
</span><span id="LazyMTS-516"><a href="#LazyMTS-516"><span class="linenos">516</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyMTS-517"><a href="#LazyMTS-517"><span class="linenos">517</span></a><span class="sd">        This function returns all the model objects trained in fit function.</span>
</span><span id="LazyMTS-518"><a href="#LazyMTS-518"><span class="linenos">518</span></a><span class="sd">        If fit is not called already, then we call fit and then return the models.</span>
</span><span id="LazyMTS-519"><a href="#LazyMTS-519"><span class="linenos">519</span></a>
</span><span id="LazyMTS-520"><a href="#LazyMTS-520"><span class="linenos">520</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyMTS-521"><a href="#LazyMTS-521"><span class="linenos">521</span></a>
</span><span id="LazyMTS-522"><a href="#LazyMTS-522"><span class="linenos">522</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyMTS-523"><a href="#LazyMTS-523"><span class="linenos">523</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyMTS-524"><a href="#LazyMTS-524"><span class="linenos">524</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyMTS-525"><a href="#LazyMTS-525"><span class="linenos">525</span></a>
</span><span id="LazyMTS-526"><a href="#LazyMTS-526"><span class="linenos">526</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyMTS-527"><a href="#LazyMTS-527"><span class="linenos">527</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyMTS-528"><a href="#LazyMTS-528"><span class="linenos">528</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyMTS-529"><a href="#LazyMTS-529"><span class="linenos">529</span></a>
</span><span id="LazyMTS-530"><a href="#LazyMTS-530"><span class="linenos">530</span></a><span class="sd">        Returns:</span>
</span><span id="LazyMTS-531"><a href="#LazyMTS-531"><span class="linenos">531</span></a>
</span><span id="LazyMTS-532"><a href="#LazyMTS-532"><span class="linenos">532</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyMTS-533"><a href="#LazyMTS-533"><span class="linenos">533</span></a><span class="sd">                Returns a dictionary with each model pipeline as value</span>
</span><span id="LazyMTS-534"><a href="#LazyMTS-534"><span class="linenos">534</span></a><span class="sd">                with key as name of models.</span>
</span><span id="LazyMTS-535"><a href="#LazyMTS-535"><span class="linenos">535</span></a>
</span><span id="LazyMTS-536"><a href="#LazyMTS-536"><span class="linenos">536</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyMTS-537"><a href="#LazyMTS-537"><span class="linenos">537</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyMTS-538"><a href="#LazyMTS-538"><span class="linenos">538</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyMTS-539"><a href="#LazyMTS-539"><span class="linenos">539</span></a>
</span><span id="LazyMTS-540"><a href="#LazyMTS-540"><span class="linenos">540</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>Fitting -- almost -- all the regression algorithms with layers of
nnetsauce's CustomRegressor to multivariate time series
and returning their scores.</p>

<p>Parameters:</p>

<pre><code>verbose: int, optional (default=0)
    Any positive number for verbosity.

ignore_warnings: bool, optional (default=True)
    When set to True, the warning related to algorigms that are not
    able to run are ignored.

custom_metric: function, optional (default=None)
    When function is provided, models are evaluated based on the custom
      evaluation metric provided.

predictions: bool, optional (default=False)
    When set to True, the predictions of all the models models are returned as dataframe.

sort_by: string, optional (default='RMSE')
    Sort models by a metric. Available options are 'RMSE', 'MAE', 'MPL', 'MPE', 'MAPE',
    'R-Squared', 'Adjusted R-Squared' or a custom metric identified by its name and
    provided by custom_metric.

random_state: int, optional (default=42)
    Reproducibiility seed.

estimators: list, optional (default='all')
    list of Estimators (regression algorithms) names or just 'all' (default='all')

preprocess: bool, preprocessing is done when set to True

n_jobs : int, when possible, run in parallel
    For now, only used by individual models that support it.

n_layers: int, optional (default=3)
    Number of layers of CustomRegressors to be used.

All the other parameters are the same as MTS's.
</code></pre>

<p>Examples:</p>

<pre><code>See https://thierrymoudiki.github.io/blog/2023/10/29/python/quasirandomizednn/MTS-LazyPredict
</code></pre>
</div>


                                <div id="LazyMTS.fit" class="classattr">
                                            <input id="LazyMTS.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">xreg</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyMTS.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyMTS.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyMTS.fit-185"><a href="#LazyMTS.fit-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">xreg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="LazyMTS.fit-186"><a href="#LazyMTS.fit-186"><span class="linenos">186</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X_train, predict and score on X_test.</span>
</span><span id="LazyMTS.fit-187"><a href="#LazyMTS.fit-187"><span class="linenos">187</span></a>
</span><span id="LazyMTS.fit-188"><a href="#LazyMTS.fit-188"><span class="linenos">188</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyMTS.fit-189"><a href="#LazyMTS.fit-189"><span class="linenos">189</span></a>
</span><span id="LazyMTS.fit-190"><a href="#LazyMTS.fit-190"><span class="linenos">190</span></a><span class="sd">            X_train: array-like,</span>
</span><span id="LazyMTS.fit-191"><a href="#LazyMTS.fit-191"><span class="linenos">191</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyMTS.fit-192"><a href="#LazyMTS.fit-192"><span class="linenos">192</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyMTS.fit-193"><a href="#LazyMTS.fit-193"><span class="linenos">193</span></a>
</span><span id="LazyMTS.fit-194"><a href="#LazyMTS.fit-194"><span class="linenos">194</span></a><span class="sd">            X_test: array-like,</span>
</span><span id="LazyMTS.fit-195"><a href="#LazyMTS.fit-195"><span class="linenos">195</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyMTS.fit-196"><a href="#LazyMTS.fit-196"><span class="linenos">196</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyMTS.fit-197"><a href="#LazyMTS.fit-197"><span class="linenos">197</span></a>
</span><span id="LazyMTS.fit-198"><a href="#LazyMTS.fit-198"><span class="linenos">198</span></a><span class="sd">            xreg: array-like, optional (default=None)</span>
</span><span id="LazyMTS.fit-199"><a href="#LazyMTS.fit-199"><span class="linenos">199</span></a><span class="sd">                Additional (external) regressors to be passed to self.obj</span>
</span><span id="LazyMTS.fit-200"><a href="#LazyMTS.fit-200"><span class="linenos">200</span></a><span class="sd">                xreg must be in &#39;increasing&#39; order (most recent observations last)</span>
</span><span id="LazyMTS.fit-201"><a href="#LazyMTS.fit-201"><span class="linenos">201</span></a>
</span><span id="LazyMTS.fit-202"><a href="#LazyMTS.fit-202"><span class="linenos">202</span></a><span class="sd">        Returns:</span>
</span><span id="LazyMTS.fit-203"><a href="#LazyMTS.fit-203"><span class="linenos">203</span></a>
</span><span id="LazyMTS.fit-204"><a href="#LazyMTS.fit-204"><span class="linenos">204</span></a><span class="sd">            scores: Pandas DataFrame</span>
</span><span id="LazyMTS.fit-205"><a href="#LazyMTS.fit-205"><span class="linenos">205</span></a><span class="sd">                Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyMTS.fit-206"><a href="#LazyMTS.fit-206"><span class="linenos">206</span></a>
</span><span id="LazyMTS.fit-207"><a href="#LazyMTS.fit-207"><span class="linenos">207</span></a><span class="sd">            predictions: Pandas DataFrame</span>
</span><span id="LazyMTS.fit-208"><a href="#LazyMTS.fit-208"><span class="linenos">208</span></a><span class="sd">                Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyMTS.fit-209"><a href="#LazyMTS.fit-209"><span class="linenos">209</span></a>
</span><span id="LazyMTS.fit-210"><a href="#LazyMTS.fit-210"><span class="linenos">210</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyMTS.fit-211"><a href="#LazyMTS.fit-211"><span class="linenos">211</span></a>        <span class="n">R2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-212"><a href="#LazyMTS.fit-212"><span class="linenos">212</span></a>        <span class="n">ADJR2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-213"><a href="#LazyMTS.fit-213"><span class="linenos">213</span></a>        <span class="n">ME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-214"><a href="#LazyMTS.fit-214"><span class="linenos">214</span></a>        <span class="n">MPL</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-215"><a href="#LazyMTS.fit-215"><span class="linenos">215</span></a>        <span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-216"><a href="#LazyMTS.fit-216"><span class="linenos">216</span></a>        <span class="n">MAE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-217"><a href="#LazyMTS.fit-217"><span class="linenos">217</span></a>        <span class="n">MPE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-218"><a href="#LazyMTS.fit-218"><span class="linenos">218</span></a>        <span class="n">MAPE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-219"><a href="#LazyMTS.fit-219"><span class="linenos">219</span></a>
</span><span id="LazyMTS.fit-220"><a href="#LazyMTS.fit-220"><span class="linenos">220</span></a>        <span class="c1"># WIN = []</span>
</span><span id="LazyMTS.fit-221"><a href="#LazyMTS.fit-221"><span class="linenos">221</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-222"><a href="#LazyMTS.fit-222"><span class="linenos">222</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-223"><a href="#LazyMTS.fit-223"><span class="linenos">223</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyMTS.fit-224"><a href="#LazyMTS.fit-224"><span class="linenos">224</span></a>
</span><span id="LazyMTS.fit-225"><a href="#LazyMTS.fit-225"><span class="linenos">225</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS.fit-226"><a href="#LazyMTS.fit-226"><span class="linenos">226</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyMTS.fit-227"><a href="#LazyMTS.fit-227"><span class="linenos">227</span></a>
</span><span id="LazyMTS.fit-228"><a href="#LazyMTS.fit-228"><span class="linenos">228</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyMTS.fit-229"><a href="#LazyMTS.fit-229"><span class="linenos">229</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyMTS.fit-230"><a href="#LazyMTS.fit-230"><span class="linenos">230</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyMTS.fit-231"><a href="#LazyMTS.fit-231"><span class="linenos">231</span></a>
</span><span id="LazyMTS.fit-232"><a href="#LazyMTS.fit-232"><span class="linenos">232</span></a>        <span class="n">X_train</span> <span class="o">=</span> <span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyMTS.fit-233"><a href="#LazyMTS.fit-233"><span class="linenos">233</span></a>        <span class="n">X_test</span> <span class="o">=</span> <span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyMTS.fit-234"><a href="#LazyMTS.fit-234"><span class="linenos">234</span></a>
</span><span id="LazyMTS.fit-235"><a href="#LazyMTS.fit-235"><span class="linenos">235</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyMTS.fit-236"><a href="#LazyMTS.fit-236"><span class="linenos">236</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyMTS.fit-237"><a href="#LazyMTS.fit-237"><span class="linenos">237</span></a>
</span><span id="LazyMTS.fit-238"><a href="#LazyMTS.fit-238"><span class="linenos">238</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyMTS.fit-239"><a href="#LazyMTS.fit-239"><span class="linenos">239</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyMTS.fit-240"><a href="#LazyMTS.fit-240"><span class="linenos">240</span></a>        <span class="p">)</span>
</span><span id="LazyMTS.fit-241"><a href="#LazyMTS.fit-241"><span class="linenos">241</span></a>
</span><span id="LazyMTS.fit-242"><a href="#LazyMTS.fit-242"><span class="linenos">242</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span><span class="p">:</span>
</span><span id="LazyMTS.fit-243"><a href="#LazyMTS.fit-243"><span class="linenos">243</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyMTS.fit-244"><a href="#LazyMTS.fit-244"><span class="linenos">244</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyMTS.fit-245"><a href="#LazyMTS.fit-245"><span class="linenos">245</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyMTS.fit-246"><a href="#LazyMTS.fit-246"><span class="linenos">246</span></a>                    <span class="p">(</span>
</span><span id="LazyMTS.fit-247"><a href="#LazyMTS.fit-247"><span class="linenos">247</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyMTS.fit-248"><a href="#LazyMTS.fit-248"><span class="linenos">248</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyMTS.fit-249"><a href="#LazyMTS.fit-249"><span class="linenos">249</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyMTS.fit-250"><a href="#LazyMTS.fit-250"><span class="linenos">250</span></a>                    <span class="p">),</span>
</span><span id="LazyMTS.fit-251"><a href="#LazyMTS.fit-251"><span class="linenos">251</span></a>                    <span class="p">(</span>
</span><span id="LazyMTS.fit-252"><a href="#LazyMTS.fit-252"><span class="linenos">252</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyMTS.fit-253"><a href="#LazyMTS.fit-253"><span class="linenos">253</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyMTS.fit-254"><a href="#LazyMTS.fit-254"><span class="linenos">254</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyMTS.fit-255"><a href="#LazyMTS.fit-255"><span class="linenos">255</span></a>                    <span class="p">),</span>
</span><span id="LazyMTS.fit-256"><a href="#LazyMTS.fit-256"><span class="linenos">256</span></a>                <span class="p">]</span>
</span><span id="LazyMTS.fit-257"><a href="#LazyMTS.fit-257"><span class="linenos">257</span></a>            <span class="p">)</span>
</span><span id="LazyMTS.fit-258"><a href="#LazyMTS.fit-258"><span class="linenos">258</span></a>
</span><span id="LazyMTS.fit-259"><a href="#LazyMTS.fit-259"><span class="linenos">259</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyMTS.fit-260"><a href="#LazyMTS.fit-260"><span class="linenos">260</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="n">REGRESSORSMTS</span>
</span><span id="LazyMTS.fit-261"><a href="#LazyMTS.fit-261"><span class="linenos">261</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS.fit-262"><a href="#LazyMTS.fit-262"><span class="linenos">262</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyMTS.fit-263"><a href="#LazyMTS.fit-263"><span class="linenos">263</span></a>                <span class="p">(</span><span class="s2">&quot;MTS(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyMTS.fit-264"><a href="#LazyMTS.fit-264"><span class="linenos">264</span></a>                <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyMTS.fit-265"><a href="#LazyMTS.fit-265"><span class="linenos">265</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyMTS.fit-266"><a href="#LazyMTS.fit-266"><span class="linenos">266</span></a>                    <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyMTS.fit-267"><a href="#LazyMTS.fit-267"><span class="linenos">267</span></a>                    <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyMTS.fit-268"><a href="#LazyMTS.fit-268"><span class="linenos">268</span></a>                <span class="p">)</span>
</span><span id="LazyMTS.fit-269"><a href="#LazyMTS.fit-269"><span class="linenos">269</span></a>            <span class="p">]</span>
</span><span id="LazyMTS.fit-270"><a href="#LazyMTS.fit-270"><span class="linenos">270</span></a>
</span><span id="LazyMTS.fit-271"><a href="#LazyMTS.fit-271"><span class="linenos">271</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyMTS.fit-272"><a href="#LazyMTS.fit-272"><span class="linenos">272</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyMTS.fit-273"><a href="#LazyMTS.fit-273"><span class="linenos">273</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyMTS.fit-274"><a href="#LazyMTS.fit-274"><span class="linenos">274</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyMTS.fit-275"><a href="#LazyMTS.fit-275"><span class="linenos">275</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyMTS.fit-276"><a href="#LazyMTS.fit-276"><span class="linenos">276</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyMTS.fit-277"><a href="#LazyMTS.fit-277"><span class="linenos">277</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyMTS.fit-278"><a href="#LazyMTS.fit-278"><span class="linenos">278</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyMTS.fit-279"><a href="#LazyMTS.fit-279"><span class="linenos">279</span></a>                                <span class="p">(</span>
</span><span id="LazyMTS.fit-280"><a href="#LazyMTS.fit-280"><span class="linenos">280</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyMTS.fit-281"><a href="#LazyMTS.fit-281"><span class="linenos">281</span></a>                                    <span class="n">MTS</span><span class="p">(</span>
</span><span id="LazyMTS.fit-282"><a href="#LazyMTS.fit-282"><span class="linenos">282</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyMTS.fit-283"><a href="#LazyMTS.fit-283"><span class="linenos">283</span></a>                                            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="LazyMTS.fit-284"><a href="#LazyMTS.fit-284"><span class="linenos">284</span></a>                                            <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyMTS.fit-285"><a href="#LazyMTS.fit-285"><span class="linenos">285</span></a>                                        <span class="p">),</span>
</span><span id="LazyMTS.fit-286"><a href="#LazyMTS.fit-286"><span class="linenos">286</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS.fit-287"><a href="#LazyMTS.fit-287"><span class="linenos">287</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS.fit-288"><a href="#LazyMTS.fit-288"><span class="linenos">288</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS.fit-289"><a href="#LazyMTS.fit-289"><span class="linenos">289</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS.fit-290"><a href="#LazyMTS.fit-290"><span class="linenos">290</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS.fit-291"><a href="#LazyMTS.fit-291"><span class="linenos">291</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS.fit-292"><a href="#LazyMTS.fit-292"><span class="linenos">292</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS.fit-293"><a href="#LazyMTS.fit-293"><span class="linenos">293</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS.fit-294"><a href="#LazyMTS.fit-294"><span class="linenos">294</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS.fit-295"><a href="#LazyMTS.fit-295"><span class="linenos">295</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS.fit-296"><a href="#LazyMTS.fit-296"><span class="linenos">296</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS.fit-297"><a href="#LazyMTS.fit-297"><span class="linenos">297</span></a>                                        <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS.fit-298"><a href="#LazyMTS.fit-298"><span class="linenos">298</span></a>                                        <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS.fit-299"><a href="#LazyMTS.fit-299"><span class="linenos">299</span></a>                                        <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS.fit-300"><a href="#LazyMTS.fit-300"><span class="linenos">300</span></a>                                        <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS.fit-301"><a href="#LazyMTS.fit-301"><span class="linenos">301</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS.fit-302"><a href="#LazyMTS.fit-302"><span class="linenos">302</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS.fit-303"><a href="#LazyMTS.fit-303"><span class="linenos">303</span></a>                                        <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS.fit-304"><a href="#LazyMTS.fit-304"><span class="linenos">304</span></a>                                    <span class="p">),</span>
</span><span id="LazyMTS.fit-305"><a href="#LazyMTS.fit-305"><span class="linenos">305</span></a>                                <span class="p">),</span>
</span><span id="LazyMTS.fit-306"><a href="#LazyMTS.fit-306"><span class="linenos">306</span></a>                            <span class="p">]</span>
</span><span id="LazyMTS.fit-307"><a href="#LazyMTS.fit-307"><span class="linenos">307</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS.fit-308"><a href="#LazyMTS.fit-308"><span class="linenos">308</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS.fit-309"><a href="#LazyMTS.fit-309"><span class="linenos">309</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyMTS.fit-310"><a href="#LazyMTS.fit-310"><span class="linenos">310</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyMTS.fit-311"><a href="#LazyMTS.fit-311"><span class="linenos">311</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyMTS.fit-312"><a href="#LazyMTS.fit-312"><span class="linenos">312</span></a>                                <span class="p">(</span>
</span><span id="LazyMTS.fit-313"><a href="#LazyMTS.fit-313"><span class="linenos">313</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyMTS.fit-314"><a href="#LazyMTS.fit-314"><span class="linenos">314</span></a>                                    <span class="n">MTS</span><span class="p">(</span>
</span><span id="LazyMTS.fit-315"><a href="#LazyMTS.fit-315"><span class="linenos">315</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyMTS.fit-316"><a href="#LazyMTS.fit-316"><span class="linenos">316</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS.fit-317"><a href="#LazyMTS.fit-317"><span class="linenos">317</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS.fit-318"><a href="#LazyMTS.fit-318"><span class="linenos">318</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS.fit-319"><a href="#LazyMTS.fit-319"><span class="linenos">319</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS.fit-320"><a href="#LazyMTS.fit-320"><span class="linenos">320</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS.fit-321"><a href="#LazyMTS.fit-321"><span class="linenos">321</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS.fit-322"><a href="#LazyMTS.fit-322"><span class="linenos">322</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS.fit-323"><a href="#LazyMTS.fit-323"><span class="linenos">323</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS.fit-324"><a href="#LazyMTS.fit-324"><span class="linenos">324</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS.fit-325"><a href="#LazyMTS.fit-325"><span class="linenos">325</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS.fit-326"><a href="#LazyMTS.fit-326"><span class="linenos">326</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS.fit-327"><a href="#LazyMTS.fit-327"><span class="linenos">327</span></a>                                        <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS.fit-328"><a href="#LazyMTS.fit-328"><span class="linenos">328</span></a>                                        <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS.fit-329"><a href="#LazyMTS.fit-329"><span class="linenos">329</span></a>                                        <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS.fit-330"><a href="#LazyMTS.fit-330"><span class="linenos">330</span></a>                                        <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS.fit-331"><a href="#LazyMTS.fit-331"><span class="linenos">331</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS.fit-332"><a href="#LazyMTS.fit-332"><span class="linenos">332</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS.fit-333"><a href="#LazyMTS.fit-333"><span class="linenos">333</span></a>                                        <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS.fit-334"><a href="#LazyMTS.fit-334"><span class="linenos">334</span></a>                                    <span class="p">),</span>
</span><span id="LazyMTS.fit-335"><a href="#LazyMTS.fit-335"><span class="linenos">335</span></a>                                <span class="p">),</span>
</span><span id="LazyMTS.fit-336"><a href="#LazyMTS.fit-336"><span class="linenos">336</span></a>                            <span class="p">]</span>
</span><span id="LazyMTS.fit-337"><a href="#LazyMTS.fit-337"><span class="linenos">337</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS.fit-338"><a href="#LazyMTS.fit-338"><span class="linenos">338</span></a>
</span><span id="LazyMTS.fit-339"><a href="#LazyMTS.fit-339"><span class="linenos">339</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="LazyMTS.fit-340"><a href="#LazyMTS.fit-340"><span class="linenos">340</span></a>                    <span class="c1"># pipe.fit(X_train, xreg=xreg)</span>
</span><span id="LazyMTS.fit-341"><a href="#LazyMTS.fit-341"><span class="linenos">341</span></a>
</span><span id="LazyMTS.fit-342"><a href="#LazyMTS.fit-342"><span class="linenos">342</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyMTS.fit-343"><a href="#LazyMTS.fit-343"><span class="linenos">343</span></a>
</span><span id="LazyMTS.fit-344"><a href="#LazyMTS.fit-344"><span class="linenos">344</span></a>                    <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">[</span><span class="s2">&quot;regressor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyMTS.fit-345"><a href="#LazyMTS.fit-345"><span class="linenos">345</span></a>                        <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyMTS.fit-346"><a href="#LazyMTS.fit-346"><span class="linenos">346</span></a>                    <span class="p">)</span>
</span><span id="LazyMTS.fit-347"><a href="#LazyMTS.fit-347"><span class="linenos">347</span></a>
</span><span id="LazyMTS.fit-348"><a href="#LazyMTS.fit-348"><span class="linenos">348</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyMTS.fit-349"><a href="#LazyMTS.fit-349"><span class="linenos">349</span></a>                    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS.fit-350"><a href="#LazyMTS.fit-350"><span class="linenos">350</span></a>                    <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS.fit-351"><a href="#LazyMTS.fit-351"><span class="linenos">351</span></a>
</span><span id="LazyMTS.fit-352"><a href="#LazyMTS.fit-352"><span class="linenos">352</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyMTS.fit-353"><a href="#LazyMTS.fit-353"><span class="linenos">353</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyMTS.fit-354"><a href="#LazyMTS.fit-354"><span class="linenos">354</span></a>                    <span class="n">MAE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</span><span id="LazyMTS.fit-355"><a href="#LazyMTS.fit-355"><span class="linenos">355</span></a>                    <span class="n">MPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpl</span><span class="p">)</span>
</span><span id="LazyMTS.fit-356"><a href="#LazyMTS.fit-356"><span class="linenos">356</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyMTS.fit-357"><a href="#LazyMTS.fit-357"><span class="linenos">357</span></a>
</span><span id="LazyMTS.fit-358"><a href="#LazyMTS.fit-358"><span class="linenos">358</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS.fit-359"><a href="#LazyMTS.fit-359"><span class="linenos">359</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS.fit-360"><a href="#LazyMTS.fit-360"><span class="linenos">360</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyMTS.fit-361"><a href="#LazyMTS.fit-361"><span class="linenos">361</span></a>
</span><span id="LazyMTS.fit-362"><a href="#LazyMTS.fit-362"><span class="linenos">362</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyMTS.fit-363"><a href="#LazyMTS.fit-363"><span class="linenos">363</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS.fit-364"><a href="#LazyMTS.fit-364"><span class="linenos">364</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyMTS.fit-365"><a href="#LazyMTS.fit-365"><span class="linenos">365</span></a>                            <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyMTS.fit-366"><a href="#LazyMTS.fit-366"><span class="linenos">366</span></a>                            <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyMTS.fit-367"><a href="#LazyMTS.fit-367"><span class="linenos">367</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyMTS.fit-368"><a href="#LazyMTS.fit-368"><span class="linenos">368</span></a>                            <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyMTS.fit-369"><a href="#LazyMTS.fit-369"><span class="linenos">369</span></a>                            <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyMTS.fit-370"><a href="#LazyMTS.fit-370"><span class="linenos">370</span></a>                            <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyMTS.fit-371"><a href="#LazyMTS.fit-371"><span class="linenos">371</span></a>                            <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyMTS.fit-372"><a href="#LazyMTS.fit-372"><span class="linenos">372</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyMTS.fit-373"><a href="#LazyMTS.fit-373"><span class="linenos">373</span></a>                        <span class="p">}</span>
</span><span id="LazyMTS.fit-374"><a href="#LazyMTS.fit-374"><span class="linenos">374</span></a>
</span><span id="LazyMTS.fit-375"><a href="#LazyMTS.fit-375"><span class="linenos">375</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS.fit-376"><a href="#LazyMTS.fit-376"><span class="linenos">376</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyMTS.fit-377"><a href="#LazyMTS.fit-377"><span class="linenos">377</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyMTS.fit-378"><a href="#LazyMTS.fit-378"><span class="linenos">378</span></a>                            <span class="p">)</span>
</span><span id="LazyMTS.fit-379"><a href="#LazyMTS.fit-379"><span class="linenos">379</span></a>
</span><span id="LazyMTS.fit-380"><a href="#LazyMTS.fit-380"><span class="linenos">380</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyMTS.fit-381"><a href="#LazyMTS.fit-381"><span class="linenos">381</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyMTS.fit-382"><a href="#LazyMTS.fit-382"><span class="linenos">382</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_pred</span>
</span><span id="LazyMTS.fit-383"><a href="#LazyMTS.fit-383"><span class="linenos">383</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyMTS.fit-384"><a href="#LazyMTS.fit-384"><span class="linenos">384</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyMTS.fit-385"><a href="#LazyMTS.fit-385"><span class="linenos">385</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyMTS.fit-386"><a href="#LazyMTS.fit-386"><span class="linenos">386</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyMTS.fit-387"><a href="#LazyMTS.fit-387"><span class="linenos">387</span></a>
</span><span id="LazyMTS.fit-388"><a href="#LazyMTS.fit-388"><span class="linenos">388</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># no preprocessing</span>
</span><span id="LazyMTS.fit-389"><a href="#LazyMTS.fit-389"><span class="linenos">389</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyMTS.fit-390"><a href="#LazyMTS.fit-390"><span class="linenos">390</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyMTS.fit-391"><a href="#LazyMTS.fit-391"><span class="linenos">391</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyMTS.fit-392"><a href="#LazyMTS.fit-392"><span class="linenos">392</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyMTS.fit-393"><a href="#LazyMTS.fit-393"><span class="linenos">393</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">MTS</span><span class="p">(</span>
</span><span id="LazyMTS.fit-394"><a href="#LazyMTS.fit-394"><span class="linenos">394</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyMTS.fit-395"><a href="#LazyMTS.fit-395"><span class="linenos">395</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS.fit-396"><a href="#LazyMTS.fit-396"><span class="linenos">396</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS.fit-397"><a href="#LazyMTS.fit-397"><span class="linenos">397</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS.fit-398"><a href="#LazyMTS.fit-398"><span class="linenos">398</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS.fit-399"><a href="#LazyMTS.fit-399"><span class="linenos">399</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS.fit-400"><a href="#LazyMTS.fit-400"><span class="linenos">400</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS.fit-401"><a href="#LazyMTS.fit-401"><span class="linenos">401</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS.fit-402"><a href="#LazyMTS.fit-402"><span class="linenos">402</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS.fit-403"><a href="#LazyMTS.fit-403"><span class="linenos">403</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS.fit-404"><a href="#LazyMTS.fit-404"><span class="linenos">404</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS.fit-405"><a href="#LazyMTS.fit-405"><span class="linenos">405</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS.fit-406"><a href="#LazyMTS.fit-406"><span class="linenos">406</span></a>                            <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS.fit-407"><a href="#LazyMTS.fit-407"><span class="linenos">407</span></a>                            <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS.fit-408"><a href="#LazyMTS.fit-408"><span class="linenos">408</span></a>                            <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS.fit-409"><a href="#LazyMTS.fit-409"><span class="linenos">409</span></a>                            <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS.fit-410"><a href="#LazyMTS.fit-410"><span class="linenos">410</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS.fit-411"><a href="#LazyMTS.fit-411"><span class="linenos">411</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS.fit-412"><a href="#LazyMTS.fit-412"><span class="linenos">412</span></a>                            <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS.fit-413"><a href="#LazyMTS.fit-413"><span class="linenos">413</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS.fit-414"><a href="#LazyMTS.fit-414"><span class="linenos">414</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS.fit-415"><a href="#LazyMTS.fit-415"><span class="linenos">415</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">MTS</span><span class="p">(</span>
</span><span id="LazyMTS.fit-416"><a href="#LazyMTS.fit-416"><span class="linenos">416</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyMTS.fit-417"><a href="#LazyMTS.fit-417"><span class="linenos">417</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyMTS.fit-418"><a href="#LazyMTS.fit-418"><span class="linenos">418</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyMTS.fit-419"><a href="#LazyMTS.fit-419"><span class="linenos">419</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyMTS.fit-420"><a href="#LazyMTS.fit-420"><span class="linenos">420</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyMTS.fit-421"><a href="#LazyMTS.fit-421"><span class="linenos">421</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyMTS.fit-422"><a href="#LazyMTS.fit-422"><span class="linenos">422</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyMTS.fit-423"><a href="#LazyMTS.fit-423"><span class="linenos">423</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyMTS.fit-424"><a href="#LazyMTS.fit-424"><span class="linenos">424</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyMTS.fit-425"><a href="#LazyMTS.fit-425"><span class="linenos">425</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyMTS.fit-426"><a href="#LazyMTS.fit-426"><span class="linenos">426</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyMTS.fit-427"><a href="#LazyMTS.fit-427"><span class="linenos">427</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyMTS.fit-428"><a href="#LazyMTS.fit-428"><span class="linenos">428</span></a>                            <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyMTS.fit-429"><a href="#LazyMTS.fit-429"><span class="linenos">429</span></a>                            <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyMTS.fit-430"><a href="#LazyMTS.fit-430"><span class="linenos">430</span></a>                            <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyMTS.fit-431"><a href="#LazyMTS.fit-431"><span class="linenos">431</span></a>                            <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyMTS.fit-432"><a href="#LazyMTS.fit-432"><span class="linenos">432</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyMTS.fit-433"><a href="#LazyMTS.fit-433"><span class="linenos">433</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyMTS.fit-434"><a href="#LazyMTS.fit-434"><span class="linenos">434</span></a>                            <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyMTS.fit-435"><a href="#LazyMTS.fit-435"><span class="linenos">435</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS.fit-436"><a href="#LazyMTS.fit-436"><span class="linenos">436</span></a>
</span><span id="LazyMTS.fit-437"><a href="#LazyMTS.fit-437"><span class="linenos">437</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">xreg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="LazyMTS.fit-438"><a href="#LazyMTS.fit-438"><span class="linenos">438</span></a>                    <span class="c1"># pipe.fit(X_train, xreg=xreg) # DO xreg like in `ahead`</span>
</span><span id="LazyMTS.fit-439"><a href="#LazyMTS.fit-439"><span class="linenos">439</span></a>
</span><span id="LazyMTS.fit-440"><a href="#LazyMTS.fit-440"><span class="linenos">440</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyMTS.fit-441"><a href="#LazyMTS.fit-441"><span class="linenos">441</span></a>
</span><span id="LazyMTS.fit-442"><a href="#LazyMTS.fit-442"><span class="linenos">442</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyMTS.fit-443"><a href="#LazyMTS.fit-443"><span class="linenos">443</span></a>                        <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">[</span><span class="s2">&quot;regressor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyMTS.fit-444"><a href="#LazyMTS.fit-444"><span class="linenos">444</span></a>                            <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyMTS.fit-445"><a href="#LazyMTS.fit-445"><span class="linenos">445</span></a>                        <span class="p">)</span>
</span><span id="LazyMTS.fit-446"><a href="#LazyMTS.fit-446"><span class="linenos">446</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyMTS.fit-447"><a href="#LazyMTS.fit-447"><span class="linenos">447</span></a>                        <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyMTS.fit-448"><a href="#LazyMTS.fit-448"><span class="linenos">448</span></a>                            <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyMTS.fit-449"><a href="#LazyMTS.fit-449"><span class="linenos">449</span></a>                        <span class="p">)</span>  <span class="c1"># X_pred = pipe.predict(h=X_test.shape[0], new_xreg=new_xreg) ## DO xreg like in `ahead`</span>
</span><span id="LazyMTS.fit-450"><a href="#LazyMTS.fit-450"><span class="linenos">450</span></a>
</span><span id="LazyMTS.fit-451"><a href="#LazyMTS.fit-451"><span class="linenos">451</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyMTS.fit-452"><a href="#LazyMTS.fit-452"><span class="linenos">452</span></a>                    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS.fit-453"><a href="#LazyMTS.fit-453"><span class="linenos">453</span></a>                    <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS.fit-454"><a href="#LazyMTS.fit-454"><span class="linenos">454</span></a>
</span><span id="LazyMTS.fit-455"><a href="#LazyMTS.fit-455"><span class="linenos">455</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyMTS.fit-456"><a href="#LazyMTS.fit-456"><span class="linenos">456</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyMTS.fit-457"><a href="#LazyMTS.fit-457"><span class="linenos">457</span></a>                    <span class="n">MAE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</span><span id="LazyMTS.fit-458"><a href="#LazyMTS.fit-458"><span class="linenos">458</span></a>                    <span class="n">MPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpl</span><span class="p">)</span>
</span><span id="LazyMTS.fit-459"><a href="#LazyMTS.fit-459"><span class="linenos">459</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyMTS.fit-460"><a href="#LazyMTS.fit-460"><span class="linenos">460</span></a>
</span><span id="LazyMTS.fit-461"><a href="#LazyMTS.fit-461"><span class="linenos">461</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS.fit-462"><a href="#LazyMTS.fit-462"><span class="linenos">462</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyMTS.fit-463"><a href="#LazyMTS.fit-463"><span class="linenos">463</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyMTS.fit-464"><a href="#LazyMTS.fit-464"><span class="linenos">464</span></a>
</span><span id="LazyMTS.fit-465"><a href="#LazyMTS.fit-465"><span class="linenos">465</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyMTS.fit-466"><a href="#LazyMTS.fit-466"><span class="linenos">466</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS.fit-467"><a href="#LazyMTS.fit-467"><span class="linenos">467</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyMTS.fit-468"><a href="#LazyMTS.fit-468"><span class="linenos">468</span></a>                            <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyMTS.fit-469"><a href="#LazyMTS.fit-469"><span class="linenos">469</span></a>                            <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyMTS.fit-470"><a href="#LazyMTS.fit-470"><span class="linenos">470</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyMTS.fit-471"><a href="#LazyMTS.fit-471"><span class="linenos">471</span></a>                            <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyMTS.fit-472"><a href="#LazyMTS.fit-472"><span class="linenos">472</span></a>                            <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyMTS.fit-473"><a href="#LazyMTS.fit-473"><span class="linenos">473</span></a>                            <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyMTS.fit-474"><a href="#LazyMTS.fit-474"><span class="linenos">474</span></a>                            <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyMTS.fit-475"><a href="#LazyMTS.fit-475"><span class="linenos">475</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyMTS.fit-476"><a href="#LazyMTS.fit-476"><span class="linenos">476</span></a>                        <span class="p">}</span>
</span><span id="LazyMTS.fit-477"><a href="#LazyMTS.fit-477"><span class="linenos">477</span></a>
</span><span id="LazyMTS.fit-478"><a href="#LazyMTS.fit-478"><span class="linenos">478</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS.fit-479"><a href="#LazyMTS.fit-479"><span class="linenos">479</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyMTS.fit-480"><a href="#LazyMTS.fit-480"><span class="linenos">480</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyMTS.fit-481"><a href="#LazyMTS.fit-481"><span class="linenos">481</span></a>                            <span class="p">)</span>
</span><span id="LazyMTS.fit-482"><a href="#LazyMTS.fit-482"><span class="linenos">482</span></a>
</span><span id="LazyMTS.fit-483"><a href="#LazyMTS.fit-483"><span class="linenos">483</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyMTS.fit-484"><a href="#LazyMTS.fit-484"><span class="linenos">484</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyMTS.fit-485"><a href="#LazyMTS.fit-485"><span class="linenos">485</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_pred</span>
</span><span id="LazyMTS.fit-486"><a href="#LazyMTS.fit-486"><span class="linenos">486</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyMTS.fit-487"><a href="#LazyMTS.fit-487"><span class="linenos">487</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyMTS.fit-488"><a href="#LazyMTS.fit-488"><span class="linenos">488</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyMTS.fit-489"><a href="#LazyMTS.fit-489"><span class="linenos">489</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyMTS.fit-490"><a href="#LazyMTS.fit-490"><span class="linenos">490</span></a>
</span><span id="LazyMTS.fit-491"><a href="#LazyMTS.fit-491"><span class="linenos">491</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyMTS.fit-492"><a href="#LazyMTS.fit-492"><span class="linenos">492</span></a>            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyMTS.fit-493"><a href="#LazyMTS.fit-493"><span class="linenos">493</span></a>            <span class="c1"># &quot;Adjusted R-Squared&quot;: ADJR2,</span>
</span><span id="LazyMTS.fit-494"><a href="#LazyMTS.fit-494"><span class="linenos">494</span></a>            <span class="c1"># &quot;R-Squared&quot;: R2,</span>
</span><span id="LazyMTS.fit-495"><a href="#LazyMTS.fit-495"><span class="linenos">495</span></a>            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyMTS.fit-496"><a href="#LazyMTS.fit-496"><span class="linenos">496</span></a>            <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">MAE</span><span class="p">,</span>
</span><span id="LazyMTS.fit-497"><a href="#LazyMTS.fit-497"><span class="linenos">497</span></a>            <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">MPL</span><span class="p">,</span>
</span><span id="LazyMTS.fit-498"><a href="#LazyMTS.fit-498"><span class="linenos">498</span></a>            <span class="c1"># &quot;MPE&quot;: MPE,</span>
</span><span id="LazyMTS.fit-499"><a href="#LazyMTS.fit-499"><span class="linenos">499</span></a>            <span class="c1"># &quot;MAPE&quot;: MAPE,</span>
</span><span id="LazyMTS.fit-500"><a href="#LazyMTS.fit-500"><span class="linenos">500</span></a>            <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyMTS.fit-501"><a href="#LazyMTS.fit-501"><span class="linenos">501</span></a>        <span class="p">}</span>
</span><span id="LazyMTS.fit-502"><a href="#LazyMTS.fit-502"><span class="linenos">502</span></a>
</span><span id="LazyMTS.fit-503"><a href="#LazyMTS.fit-503"><span class="linenos">503</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyMTS.fit-504"><a href="#LazyMTS.fit-504"><span class="linenos">504</span></a>            <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">CUSTOM_METRIC</span>
</span><span id="LazyMTS.fit-505"><a href="#LazyMTS.fit-505"><span class="linenos">505</span></a>
</span><span id="LazyMTS.fit-506"><a href="#LazyMTS.fit-506"><span class="linenos">506</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LazyMTS.fit-507"><a href="#LazyMTS.fit-507"><span class="linenos">507</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyMTS.fit-508"><a href="#LazyMTS.fit-508"><span class="linenos">508</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyMTS.fit-509"><a href="#LazyMTS.fit-509"><span class="linenos">509</span></a>        <span class="p">)</span>
</span><span id="LazyMTS.fit-510"><a href="#LazyMTS.fit-510"><span class="linenos">510</span></a>
</span><span id="LazyMTS.fit-511"><a href="#LazyMTS.fit-511"><span class="linenos">511</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyMTS.fit-512"><a href="#LazyMTS.fit-512"><span class="linenos">512</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyMTS.fit-513"><a href="#LazyMTS.fit-513"><span class="linenos">513</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span></pre></div>


            <div class="docstring"><p>Fit Regression algorithms to X_train, predict and score on X_test.</p>

<p>Parameters:</p>

<pre><code>X_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.

xreg: array-like, optional (default=None)
    Additional (external) regressors to be passed to self.obj
    xreg must be in 'increasing' order (most recent observations last)
</code></pre>

<p>Returns:</p>

<pre><code>scores: Pandas DataFrame
    Returns metrics of all the models in a Pandas DataFrame.

predictions: Pandas DataFrame
    Returns predictions of all the models in a Pandas DataFrame.
</code></pre>
</div>


                                </div>
                                <div id="LazyMTS.provide_models" class="classattr">
                                            <input id="LazyMTS.provide_models-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">provide_models</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyMTS.provide_models-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyMTS.provide_models"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyMTS.provide_models-515"><a href="#LazyMTS.provide_models-515"><span class="linenos">515</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">):</span>
</span><span id="LazyMTS.provide_models-516"><a href="#LazyMTS.provide_models-516"><span class="linenos">516</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyMTS.provide_models-517"><a href="#LazyMTS.provide_models-517"><span class="linenos">517</span></a><span class="sd">        This function returns all the model objects trained in fit function.</span>
</span><span id="LazyMTS.provide_models-518"><a href="#LazyMTS.provide_models-518"><span class="linenos">518</span></a><span class="sd">        If fit is not called already, then we call fit and then return the models.</span>
</span><span id="LazyMTS.provide_models-519"><a href="#LazyMTS.provide_models-519"><span class="linenos">519</span></a>
</span><span id="LazyMTS.provide_models-520"><a href="#LazyMTS.provide_models-520"><span class="linenos">520</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyMTS.provide_models-521"><a href="#LazyMTS.provide_models-521"><span class="linenos">521</span></a>
</span><span id="LazyMTS.provide_models-522"><a href="#LazyMTS.provide_models-522"><span class="linenos">522</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyMTS.provide_models-523"><a href="#LazyMTS.provide_models-523"><span class="linenos">523</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyMTS.provide_models-524"><a href="#LazyMTS.provide_models-524"><span class="linenos">524</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyMTS.provide_models-525"><a href="#LazyMTS.provide_models-525"><span class="linenos">525</span></a>
</span><span id="LazyMTS.provide_models-526"><a href="#LazyMTS.provide_models-526"><span class="linenos">526</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyMTS.provide_models-527"><a href="#LazyMTS.provide_models-527"><span class="linenos">527</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyMTS.provide_models-528"><a href="#LazyMTS.provide_models-528"><span class="linenos">528</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyMTS.provide_models-529"><a href="#LazyMTS.provide_models-529"><span class="linenos">529</span></a>
</span><span id="LazyMTS.provide_models-530"><a href="#LazyMTS.provide_models-530"><span class="linenos">530</span></a><span class="sd">        Returns:</span>
</span><span id="LazyMTS.provide_models-531"><a href="#LazyMTS.provide_models-531"><span class="linenos">531</span></a>
</span><span id="LazyMTS.provide_models-532"><a href="#LazyMTS.provide_models-532"><span class="linenos">532</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyMTS.provide_models-533"><a href="#LazyMTS.provide_models-533"><span class="linenos">533</span></a><span class="sd">                Returns a dictionary with each model pipeline as value</span>
</span><span id="LazyMTS.provide_models-534"><a href="#LazyMTS.provide_models-534"><span class="linenos">534</span></a><span class="sd">                with key as name of models.</span>
</span><span id="LazyMTS.provide_models-535"><a href="#LazyMTS.provide_models-535"><span class="linenos">535</span></a>
</span><span id="LazyMTS.provide_models-536"><a href="#LazyMTS.provide_models-536"><span class="linenos">536</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyMTS.provide_models-537"><a href="#LazyMTS.provide_models-537"><span class="linenos">537</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyMTS.provide_models-538"><a href="#LazyMTS.provide_models-538"><span class="linenos">538</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyMTS.provide_models-539"><a href="#LazyMTS.provide_models-539"><span class="linenos">539</span></a>
</span><span id="LazyMTS.provide_models-540"><a href="#LazyMTS.provide_models-540"><span class="linenos">540</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>This function returns all the model objects trained in fit function.
If fit is not called already, then we call fit and then return the models.</p>

<p>Parameters:</p>

<pre><code>X_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.
</code></pre>

<p>Returns:</p>

<pre><code>models: dict-object,
    Returns a dictionary with each model pipeline as value
    with key as name of models.
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="LazyDeepClassifier">
                            <input id="LazyDeepClassifier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LazyDeepClassifier</span><wbr>(<span class="base">nnetsauce.custom.custom.Custom</span>, <span class="base">sklearn.base.ClassifierMixin</span>):

                <label class="view-source-button" for="LazyDeepClassifier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepClassifier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepClassifier-67"><a href="#LazyDeepClassifier-67"><span class="linenos"> 67</span></a><span class="k">class</span> <span class="nc">LazyDeepClassifier</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">):</span>
</span><span id="LazyDeepClassifier-68"><a href="#LazyDeepClassifier-68"><span class="linenos"> 68</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyDeepClassifier-69"><a href="#LazyDeepClassifier-69"><span class="linenos"> 69</span></a>
</span><span id="LazyDeepClassifier-70"><a href="#LazyDeepClassifier-70"><span class="linenos"> 70</span></a><span class="sd">    Fitting -- almost -- all the classification algorithms with layers of</span>
</span><span id="LazyDeepClassifier-71"><a href="#LazyDeepClassifier-71"><span class="linenos"> 71</span></a><span class="sd">    nnetsauce&#39;s CustomClassifier and returning their scores.</span>
</span><span id="LazyDeepClassifier-72"><a href="#LazyDeepClassifier-72"><span class="linenos"> 72</span></a>
</span><span id="LazyDeepClassifier-73"><a href="#LazyDeepClassifier-73"><span class="linenos"> 73</span></a><span class="sd">    Parameters:</span>
</span><span id="LazyDeepClassifier-74"><a href="#LazyDeepClassifier-74"><span class="linenos"> 74</span></a>
</span><span id="LazyDeepClassifier-75"><a href="#LazyDeepClassifier-75"><span class="linenos"> 75</span></a><span class="sd">        verbose: int, optional (default=0)</span>
</span><span id="LazyDeepClassifier-76"><a href="#LazyDeepClassifier-76"><span class="linenos"> 76</span></a><span class="sd">            Any positive number for verbosity.</span>
</span><span id="LazyDeepClassifier-77"><a href="#LazyDeepClassifier-77"><span class="linenos"> 77</span></a>
</span><span id="LazyDeepClassifier-78"><a href="#LazyDeepClassifier-78"><span class="linenos"> 78</span></a><span class="sd">        ignore_warnings: bool, optional (default=True)</span>
</span><span id="LazyDeepClassifier-79"><a href="#LazyDeepClassifier-79"><span class="linenos"> 79</span></a><span class="sd">            When set to True, the warning related to algorigms that are not</span>
</span><span id="LazyDeepClassifier-80"><a href="#LazyDeepClassifier-80"><span class="linenos"> 80</span></a><span class="sd">            able to run are ignored.</span>
</span><span id="LazyDeepClassifier-81"><a href="#LazyDeepClassifier-81"><span class="linenos"> 81</span></a>
</span><span id="LazyDeepClassifier-82"><a href="#LazyDeepClassifier-82"><span class="linenos"> 82</span></a><span class="sd">        custom_metric: function, optional (default=None)</span>
</span><span id="LazyDeepClassifier-83"><a href="#LazyDeepClassifier-83"><span class="linenos"> 83</span></a><span class="sd">            When function is provided, models are evaluated based on the custom</span>
</span><span id="LazyDeepClassifier-84"><a href="#LazyDeepClassifier-84"><span class="linenos"> 84</span></a><span class="sd">              evaluation metric provided.</span>
</span><span id="LazyDeepClassifier-85"><a href="#LazyDeepClassifier-85"><span class="linenos"> 85</span></a>
</span><span id="LazyDeepClassifier-86"><a href="#LazyDeepClassifier-86"><span class="linenos"> 86</span></a><span class="sd">        predictions: bool, optional (default=False)</span>
</span><span id="LazyDeepClassifier-87"><a href="#LazyDeepClassifier-87"><span class="linenos"> 87</span></a><span class="sd">            When set to True, the predictions of all the models models are</span>
</span><span id="LazyDeepClassifier-88"><a href="#LazyDeepClassifier-88"><span class="linenos"> 88</span></a><span class="sd">            returned as data frame.</span>
</span><span id="LazyDeepClassifier-89"><a href="#LazyDeepClassifier-89"><span class="linenos"> 89</span></a>
</span><span id="LazyDeepClassifier-90"><a href="#LazyDeepClassifier-90"><span class="linenos"> 90</span></a><span class="sd">        sort_by: string, optional (default=&#39;Accuracy&#39;)</span>
</span><span id="LazyDeepClassifier-91"><a href="#LazyDeepClassifier-91"><span class="linenos"> 91</span></a><span class="sd">            Sort models by a metric. Available options are &#39;Accuracy&#39;,</span>
</span><span id="LazyDeepClassifier-92"><a href="#LazyDeepClassifier-92"><span class="linenos"> 92</span></a><span class="sd">            &#39;Balanced Accuracy&#39;, &#39;ROC AUC&#39;, &#39;F1 Score&#39; or a custom metric</span>
</span><span id="LazyDeepClassifier-93"><a href="#LazyDeepClassifier-93"><span class="linenos"> 93</span></a><span class="sd">            identified by its name and provided by custom_metric.</span>
</span><span id="LazyDeepClassifier-94"><a href="#LazyDeepClassifier-94"><span class="linenos"> 94</span></a>
</span><span id="LazyDeepClassifier-95"><a href="#LazyDeepClassifier-95"><span class="linenos"> 95</span></a><span class="sd">        random_state: int, optional (default=42)</span>
</span><span id="LazyDeepClassifier-96"><a href="#LazyDeepClassifier-96"><span class="linenos"> 96</span></a><span class="sd">            Reproducibiility seed.</span>
</span><span id="LazyDeepClassifier-97"><a href="#LazyDeepClassifier-97"><span class="linenos"> 97</span></a>
</span><span id="LazyDeepClassifier-98"><a href="#LazyDeepClassifier-98"><span class="linenos"> 98</span></a><span class="sd">        estimators: list, optional (default=&#39;all&#39;)</span>
</span><span id="LazyDeepClassifier-99"><a href="#LazyDeepClassifier-99"><span class="linenos"> 99</span></a><span class="sd">            list of Estimators names or just &#39;all&#39; for &gt; 90 classifiers</span>
</span><span id="LazyDeepClassifier-100"><a href="#LazyDeepClassifier-100"><span class="linenos">100</span></a><span class="sd">            (default=&#39;all&#39;)</span>
</span><span id="LazyDeepClassifier-101"><a href="#LazyDeepClassifier-101"><span class="linenos">101</span></a>
</span><span id="LazyDeepClassifier-102"><a href="#LazyDeepClassifier-102"><span class="linenos">102</span></a><span class="sd">        preprocess: bool, preprocessing is done when set to True</span>
</span><span id="LazyDeepClassifier-103"><a href="#LazyDeepClassifier-103"><span class="linenos">103</span></a>
</span><span id="LazyDeepClassifier-104"><a href="#LazyDeepClassifier-104"><span class="linenos">104</span></a><span class="sd">        n_jobs: int, when possible, run in parallel</span>
</span><span id="LazyDeepClassifier-105"><a href="#LazyDeepClassifier-105"><span class="linenos">105</span></a><span class="sd">            For now, only used by individual models that support it.</span>
</span><span id="LazyDeepClassifier-106"><a href="#LazyDeepClassifier-106"><span class="linenos">106</span></a>
</span><span id="LazyDeepClassifier-107"><a href="#LazyDeepClassifier-107"><span class="linenos">107</span></a><span class="sd">        n_layers: int, optional (default=3)</span>
</span><span id="LazyDeepClassifier-108"><a href="#LazyDeepClassifier-108"><span class="linenos">108</span></a><span class="sd">            Number of layers of CustomClassifiers to be used.</span>
</span><span id="LazyDeepClassifier-109"><a href="#LazyDeepClassifier-109"><span class="linenos">109</span></a>
</span><span id="LazyDeepClassifier-110"><a href="#LazyDeepClassifier-110"><span class="linenos">110</span></a><span class="sd">        All the other parameters are the same as CustomClassifier&#39;s.</span>
</span><span id="LazyDeepClassifier-111"><a href="#LazyDeepClassifier-111"><span class="linenos">111</span></a>
</span><span id="LazyDeepClassifier-112"><a href="#LazyDeepClassifier-112"><span class="linenos">112</span></a>
</span><span id="LazyDeepClassifier-113"><a href="#LazyDeepClassifier-113"><span class="linenos">113</span></a><span class="sd">    Examples</span>
</span><span id="LazyDeepClassifier-114"><a href="#LazyDeepClassifier-114"><span class="linenos">114</span></a>
</span><span id="LazyDeepClassifier-115"><a href="#LazyDeepClassifier-115"><span class="linenos">115</span></a><span class="sd">        ```python</span>
</span><span id="LazyDeepClassifier-116"><a href="#LazyDeepClassifier-116"><span class="linenos">116</span></a><span class="sd">        import nnetsauce as ns</span>
</span><span id="LazyDeepClassifier-117"><a href="#LazyDeepClassifier-117"><span class="linenos">117</span></a><span class="sd">        from sklearn.datasets import load_breast_cancer</span>
</span><span id="LazyDeepClassifier-118"><a href="#LazyDeepClassifier-118"><span class="linenos">118</span></a><span class="sd">        from sklearn.model_selection import train_test_split</span>
</span><span id="LazyDeepClassifier-119"><a href="#LazyDeepClassifier-119"><span class="linenos">119</span></a><span class="sd">        data = load_breast_cancer()</span>
</span><span id="LazyDeepClassifier-120"><a href="#LazyDeepClassifier-120"><span class="linenos">120</span></a><span class="sd">        X = data.data</span>
</span><span id="LazyDeepClassifier-121"><a href="#LazyDeepClassifier-121"><span class="linenos">121</span></a><span class="sd">        y= data.target</span>
</span><span id="LazyDeepClassifier-122"><a href="#LazyDeepClassifier-122"><span class="linenos">122</span></a><span class="sd">        X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=.2,</span>
</span><span id="LazyDeepClassifier-123"><a href="#LazyDeepClassifier-123"><span class="linenos">123</span></a><span class="sd">            random_state=123)</span>
</span><span id="LazyDeepClassifier-124"><a href="#LazyDeepClassifier-124"><span class="linenos">124</span></a><span class="sd">        clf = ns.LazyDeepClassifier(verbose=0, ignore_warnings=True, custom_metric=None)</span>
</span><span id="LazyDeepClassifier-125"><a href="#LazyDeepClassifier-125"><span class="linenos">125</span></a><span class="sd">        models, predictions = clf.fit(X_train, X_test, y_train, y_test)</span>
</span><span id="LazyDeepClassifier-126"><a href="#LazyDeepClassifier-126"><span class="linenos">126</span></a><span class="sd">        model_dictionary = clf.provide_models(X_train,X_test,y_train,y_test)</span>
</span><span id="LazyDeepClassifier-127"><a href="#LazyDeepClassifier-127"><span class="linenos">127</span></a><span class="sd">        print(models)</span>
</span><span id="LazyDeepClassifier-128"><a href="#LazyDeepClassifier-128"><span class="linenos">128</span></a><span class="sd">        ```</span>
</span><span id="LazyDeepClassifier-129"><a href="#LazyDeepClassifier-129"><span class="linenos">129</span></a>
</span><span id="LazyDeepClassifier-130"><a href="#LazyDeepClassifier-130"><span class="linenos">130</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LazyDeepClassifier-131"><a href="#LazyDeepClassifier-131"><span class="linenos">131</span></a>
</span><span id="LazyDeepClassifier-132"><a href="#LazyDeepClassifier-132"><span class="linenos">132</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-133"><a href="#LazyDeepClassifier-133"><span class="linenos">133</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-134"><a href="#LazyDeepClassifier-134"><span class="linenos">134</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-135"><a href="#LazyDeepClassifier-135"><span class="linenos">135</span></a>        <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-136"><a href="#LazyDeepClassifier-136"><span class="linenos">136</span></a>        <span class="n">custom_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-137"><a href="#LazyDeepClassifier-137"><span class="linenos">137</span></a>        <span class="n">predictions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-138"><a href="#LazyDeepClassifier-138"><span class="linenos">138</span></a>        <span class="n">sort_by</span><span class="o">=</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-139"><a href="#LazyDeepClassifier-139"><span class="linenos">139</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-140"><a href="#LazyDeepClassifier-140"><span class="linenos">140</span></a>        <span class="n">estimators</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-141"><a href="#LazyDeepClassifier-141"><span class="linenos">141</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-142"><a href="#LazyDeepClassifier-142"><span class="linenos">142</span></a>        <span class="c1"># Defining depth</span>
</span><span id="LazyDeepClassifier-143"><a href="#LazyDeepClassifier-143"><span class="linenos">143</span></a>        <span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-144"><a href="#LazyDeepClassifier-144"><span class="linenos">144</span></a>        <span class="c1"># CustomClassifier attributes</span>
</span><span id="LazyDeepClassifier-145"><a href="#LazyDeepClassifier-145"><span class="linenos">145</span></a>        <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-146"><a href="#LazyDeepClassifier-146"><span class="linenos">146</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-147"><a href="#LazyDeepClassifier-147"><span class="linenos">147</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-148"><a href="#LazyDeepClassifier-148"><span class="linenos">148</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-149"><a href="#LazyDeepClassifier-149"><span class="linenos">149</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-150"><a href="#LazyDeepClassifier-150"><span class="linenos">150</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-151"><a href="#LazyDeepClassifier-151"><span class="linenos">151</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-152"><a href="#LazyDeepClassifier-152"><span class="linenos">152</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-153"><a href="#LazyDeepClassifier-153"><span class="linenos">153</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-154"><a href="#LazyDeepClassifier-154"><span class="linenos">154</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-155"><a href="#LazyDeepClassifier-155"><span class="linenos">155</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-156"><a href="#LazyDeepClassifier-156"><span class="linenos">156</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="LazyDeepClassifier-157"><a href="#LazyDeepClassifier-157"><span class="linenos">157</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-158"><a href="#LazyDeepClassifier-158"><span class="linenos">158</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-159"><a href="#LazyDeepClassifier-159"><span class="linenos">159</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-160"><a href="#LazyDeepClassifier-160"><span class="linenos">160</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-161"><a href="#LazyDeepClassifier-161"><span class="linenos">161</span></a>    <span class="p">):</span>
</span><span id="LazyDeepClassifier-162"><a href="#LazyDeepClassifier-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="LazyDeepClassifier-163"><a href="#LazyDeepClassifier-163"><span class="linenos">163</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="o">=</span> <span class="n">ignore_warnings</span>
</span><span id="LazyDeepClassifier-164"><a href="#LazyDeepClassifier-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="o">=</span> <span class="n">custom_metric</span>
</span><span id="LazyDeepClassifier-165"><a href="#LazyDeepClassifier-165"><span class="linenos">165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span>
</span><span id="LazyDeepClassifier-166"><a href="#LazyDeepClassifier-166"><span class="linenos">166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sort_by</span> <span class="o">=</span> <span class="n">sort_by</span>
</span><span id="LazyDeepClassifier-167"><a href="#LazyDeepClassifier-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepClassifier-168"><a href="#LazyDeepClassifier-168"><span class="linenos">168</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="LazyDeepClassifier-169"><a href="#LazyDeepClassifier-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">=</span> <span class="n">estimators</span>
</span><span id="LazyDeepClassifier-170"><a href="#LazyDeepClassifier-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">=</span> <span class="n">n_layers</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="LazyDeepClassifier-171"><a href="#LazyDeepClassifier-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="LazyDeepClassifier-172"><a href="#LazyDeepClassifier-172"><span class="linenos">172</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-173"><a href="#LazyDeepClassifier-173"><span class="linenos">173</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-174"><a href="#LazyDeepClassifier-174"><span class="linenos">174</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-175"><a href="#LazyDeepClassifier-175"><span class="linenos">175</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-176"><a href="#LazyDeepClassifier-176"><span class="linenos">176</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-177"><a href="#LazyDeepClassifier-177"><span class="linenos">177</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-178"><a href="#LazyDeepClassifier-178"><span class="linenos">178</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-179"><a href="#LazyDeepClassifier-179"><span class="linenos">179</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-180"><a href="#LazyDeepClassifier-180"><span class="linenos">180</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-181"><a href="#LazyDeepClassifier-181"><span class="linenos">181</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-182"><a href="#LazyDeepClassifier-182"><span class="linenos">182</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-183"><a href="#LazyDeepClassifier-183"><span class="linenos">183</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-184"><a href="#LazyDeepClassifier-184"><span class="linenos">184</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-185"><a href="#LazyDeepClassifier-185"><span class="linenos">185</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-186"><a href="#LazyDeepClassifier-186"><span class="linenos">186</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-187"><a href="#LazyDeepClassifier-187"><span class="linenos">187</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-188"><a href="#LazyDeepClassifier-188"><span class="linenos">188</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-189"><a href="#LazyDeepClassifier-189"><span class="linenos">189</span></a>        <span class="p">)</span>
</span><span id="LazyDeepClassifier-190"><a href="#LazyDeepClassifier-190"><span class="linenos">190</span></a>
</span><span id="LazyDeepClassifier-191"><a href="#LazyDeepClassifier-191"><span class="linenos">191</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyDeepClassifier-192"><a href="#LazyDeepClassifier-192"><span class="linenos">192</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit classifiers to X_train and y_train, predict and score on X_test,</span>
</span><span id="LazyDeepClassifier-193"><a href="#LazyDeepClassifier-193"><span class="linenos">193</span></a><span class="sd">        y_test.</span>
</span><span id="LazyDeepClassifier-194"><a href="#LazyDeepClassifier-194"><span class="linenos">194</span></a>
</span><span id="LazyDeepClassifier-195"><a href="#LazyDeepClassifier-195"><span class="linenos">195</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepClassifier-196"><a href="#LazyDeepClassifier-196"><span class="linenos">196</span></a>
</span><span id="LazyDeepClassifier-197"><a href="#LazyDeepClassifier-197"><span class="linenos">197</span></a><span class="sd">            X_train: array-like,</span>
</span><span id="LazyDeepClassifier-198"><a href="#LazyDeepClassifier-198"><span class="linenos">198</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier-199"><a href="#LazyDeepClassifier-199"><span class="linenos">199</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepClassifier-200"><a href="#LazyDeepClassifier-200"><span class="linenos">200</span></a>
</span><span id="LazyDeepClassifier-201"><a href="#LazyDeepClassifier-201"><span class="linenos">201</span></a><span class="sd">            X_test: array-like,</span>
</span><span id="LazyDeepClassifier-202"><a href="#LazyDeepClassifier-202"><span class="linenos">202</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier-203"><a href="#LazyDeepClassifier-203"><span class="linenos">203</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepClassifier-204"><a href="#LazyDeepClassifier-204"><span class="linenos">204</span></a>
</span><span id="LazyDeepClassifier-205"><a href="#LazyDeepClassifier-205"><span class="linenos">205</span></a><span class="sd">            y_train: array-like,</span>
</span><span id="LazyDeepClassifier-206"><a href="#LazyDeepClassifier-206"><span class="linenos">206</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier-207"><a href="#LazyDeepClassifier-207"><span class="linenos">207</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepClassifier-208"><a href="#LazyDeepClassifier-208"><span class="linenos">208</span></a>
</span><span id="LazyDeepClassifier-209"><a href="#LazyDeepClassifier-209"><span class="linenos">209</span></a><span class="sd">            y_test: array-like,</span>
</span><span id="LazyDeepClassifier-210"><a href="#LazyDeepClassifier-210"><span class="linenos">210</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier-211"><a href="#LazyDeepClassifier-211"><span class="linenos">211</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepClassifier-212"><a href="#LazyDeepClassifier-212"><span class="linenos">212</span></a>
</span><span id="LazyDeepClassifier-213"><a href="#LazyDeepClassifier-213"><span class="linenos">213</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepClassifier-214"><a href="#LazyDeepClassifier-214"><span class="linenos">214</span></a>
</span><span id="LazyDeepClassifier-215"><a href="#LazyDeepClassifier-215"><span class="linenos">215</span></a><span class="sd">            scores: Pandas DataFrame</span>
</span><span id="LazyDeepClassifier-216"><a href="#LazyDeepClassifier-216"><span class="linenos">216</span></a><span class="sd">                Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepClassifier-217"><a href="#LazyDeepClassifier-217"><span class="linenos">217</span></a>
</span><span id="LazyDeepClassifier-218"><a href="#LazyDeepClassifier-218"><span class="linenos">218</span></a><span class="sd">            predictions: Pandas DataFrame</span>
</span><span id="LazyDeepClassifier-219"><a href="#LazyDeepClassifier-219"><span class="linenos">219</span></a><span class="sd">                Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepClassifier-220"><a href="#LazyDeepClassifier-220"><span class="linenos">220</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepClassifier-221"><a href="#LazyDeepClassifier-221"><span class="linenos">221</span></a>        <span class="n">Accuracy</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier-222"><a href="#LazyDeepClassifier-222"><span class="linenos">222</span></a>        <span class="n">B_Accuracy</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier-223"><a href="#LazyDeepClassifier-223"><span class="linenos">223</span></a>        <span class="n">ROC_AUC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier-224"><a href="#LazyDeepClassifier-224"><span class="linenos">224</span></a>        <span class="n">F1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier-225"><a href="#LazyDeepClassifier-225"><span class="linenos">225</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier-226"><a href="#LazyDeepClassifier-226"><span class="linenos">226</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier-227"><a href="#LazyDeepClassifier-227"><span class="linenos">227</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepClassifier-228"><a href="#LazyDeepClassifier-228"><span class="linenos">228</span></a>
</span><span id="LazyDeepClassifier-229"><a href="#LazyDeepClassifier-229"><span class="linenos">229</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-230"><a href="#LazyDeepClassifier-230"><span class="linenos">230</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier-231"><a href="#LazyDeepClassifier-231"><span class="linenos">231</span></a>
</span><span id="LazyDeepClassifier-232"><a href="#LazyDeepClassifier-232"><span class="linenos">232</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyDeepClassifier-233"><a href="#LazyDeepClassifier-233"><span class="linenos">233</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-234"><a href="#LazyDeepClassifier-234"><span class="linenos">234</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-235"><a href="#LazyDeepClassifier-235"><span class="linenos">235</span></a>
</span><span id="LazyDeepClassifier-236"><a href="#LazyDeepClassifier-236"><span class="linenos">236</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepClassifier-237"><a href="#LazyDeepClassifier-237"><span class="linenos">237</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepClassifier-238"><a href="#LazyDeepClassifier-238"><span class="linenos">238</span></a>
</span><span id="LazyDeepClassifier-239"><a href="#LazyDeepClassifier-239"><span class="linenos">239</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-240"><a href="#LazyDeepClassifier-240"><span class="linenos">240</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyDeepClassifier-241"><a href="#LazyDeepClassifier-241"><span class="linenos">241</span></a>        <span class="p">)</span>
</span><span id="LazyDeepClassifier-242"><a href="#LazyDeepClassifier-242"><span class="linenos">242</span></a>
</span><span id="LazyDeepClassifier-243"><a href="#LazyDeepClassifier-243"><span class="linenos">243</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-244"><a href="#LazyDeepClassifier-244"><span class="linenos">244</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyDeepClassifier-245"><a href="#LazyDeepClassifier-245"><span class="linenos">245</span></a>                <span class="n">item</span>
</span><span id="LazyDeepClassifier-246"><a href="#LazyDeepClassifier-246"><span class="linenos">246</span></a>                <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="LazyDeepClassifier-247"><a href="#LazyDeepClassifier-247"><span class="linenos">247</span></a>                    <span class="n">DEEPCLASSIFIERS</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-248"><a href="#LazyDeepClassifier-248"><span class="linenos">248</span></a>                    <span class="n">DEEPMULTITASKCLASSIFIERS</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-249"><a href="#LazyDeepClassifier-249"><span class="linenos">249</span></a>                    <span class="n">DEEPSIMPLEMULTITASKCLASSIFIERS</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-250"><a href="#LazyDeepClassifier-250"><span class="linenos">250</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier-251"><a href="#LazyDeepClassifier-251"><span class="linenos">251</span></a>                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span>
</span><span id="LazyDeepClassifier-252"><a href="#LazyDeepClassifier-252"><span class="linenos">252</span></a>            <span class="p">]</span>
</span><span id="LazyDeepClassifier-253"><a href="#LazyDeepClassifier-253"><span class="linenos">253</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-254"><a href="#LazyDeepClassifier-254"><span class="linenos">254</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier-255"><a href="#LazyDeepClassifier-255"><span class="linenos">255</span></a>                <span class="p">[</span>
</span><span id="LazyDeepClassifier-256"><a href="#LazyDeepClassifier-256"><span class="linenos">256</span></a>                    <span class="p">(</span><span class="s2">&quot;DeepCustomClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyDeepClassifier-257"><a href="#LazyDeepClassifier-257"><span class="linenos">257</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepClassifier-258"><a href="#LazyDeepClassifier-258"><span class="linenos">258</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier-259"><a href="#LazyDeepClassifier-259"><span class="linenos">259</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ClassifierMixin</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-260"><a href="#LazyDeepClassifier-260"><span class="linenos">260</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-261"><a href="#LazyDeepClassifier-261"><span class="linenos">261</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier-262"><a href="#LazyDeepClassifier-262"><span class="linenos">262</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier-263"><a href="#LazyDeepClassifier-263"><span class="linenos">263</span></a>                <span class="o">+</span> <span class="p">[</span>
</span><span id="LazyDeepClassifier-264"><a href="#LazyDeepClassifier-264"><span class="linenos">264</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepClassifier-265"><a href="#LazyDeepClassifier-265"><span class="linenos">265</span></a>                        <span class="s2">&quot;DeepMultitaskClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-266"><a href="#LazyDeepClassifier-266"><span class="linenos">266</span></a>                        <span class="n">partial</span><span class="p">(</span><span class="n">MultitaskClassifier</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">]()),</span>
</span><span id="LazyDeepClassifier-267"><a href="#LazyDeepClassifier-267"><span class="linenos">267</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier-268"><a href="#LazyDeepClassifier-268"><span class="linenos">268</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepClassifier-269"><a href="#LazyDeepClassifier-269"><span class="linenos">269</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier-270"><a href="#LazyDeepClassifier-270"><span class="linenos">270</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-271"><a href="#LazyDeepClassifier-271"><span class="linenos">271</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-272"><a href="#LazyDeepClassifier-272"><span class="linenos">272</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier-273"><a href="#LazyDeepClassifier-273"><span class="linenos">273</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier-274"><a href="#LazyDeepClassifier-274"><span class="linenos">274</span></a>                <span class="o">+</span> <span class="p">[</span>
</span><span id="LazyDeepClassifier-275"><a href="#LazyDeepClassifier-275"><span class="linenos">275</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepClassifier-276"><a href="#LazyDeepClassifier-276"><span class="linenos">276</span></a>                        <span class="s2">&quot;DeepSimpleMultitaskClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-277"><a href="#LazyDeepClassifier-277"><span class="linenos">277</span></a>                        <span class="n">partial</span><span class="p">(</span><span class="n">SimpleMultitaskClassifier</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">]()),</span>
</span><span id="LazyDeepClassifier-278"><a href="#LazyDeepClassifier-278"><span class="linenos">278</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier-279"><a href="#LazyDeepClassifier-279"><span class="linenos">279</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepClassifier-280"><a href="#LazyDeepClassifier-280"><span class="linenos">280</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier-281"><a href="#LazyDeepClassifier-281"><span class="linenos">281</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-282"><a href="#LazyDeepClassifier-282"><span class="linenos">282</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-283"><a href="#LazyDeepClassifier-283"><span class="linenos">283</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier-284"><a href="#LazyDeepClassifier-284"><span class="linenos">284</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier-285"><a href="#LazyDeepClassifier-285"><span class="linenos">285</span></a>            <span class="p">)</span>
</span><span id="LazyDeepClassifier-286"><a href="#LazyDeepClassifier-286"><span class="linenos">286</span></a>
</span><span id="LazyDeepClassifier-287"><a href="#LazyDeepClassifier-287"><span class="linenos">287</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepClassifier-288"><a href="#LazyDeepClassifier-288"><span class="linenos">288</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepClassifier-289"><a href="#LazyDeepClassifier-289"><span class="linenos">289</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-290"><a href="#LazyDeepClassifier-290"><span class="linenos">290</span></a>                <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepClassifier-291"><a href="#LazyDeepClassifier-291"><span class="linenos">291</span></a>                    <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-292"><a href="#LazyDeepClassifier-292"><span class="linenos">292</span></a>                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">),</span>
</span><span id="LazyDeepClassifier-293"><a href="#LazyDeepClassifier-293"><span class="linenos">293</span></a>                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-294"><a href="#LazyDeepClassifier-294"><span class="linenos">294</span></a>                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-295"><a href="#LazyDeepClassifier-295"><span class="linenos">295</span></a>                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-296"><a href="#LazyDeepClassifier-296"><span class="linenos">296</span></a>                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-297"><a href="#LazyDeepClassifier-297"><span class="linenos">297</span></a>                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-298"><a href="#LazyDeepClassifier-298"><span class="linenos">298</span></a>                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-299"><a href="#LazyDeepClassifier-299"><span class="linenos">299</span></a>                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-300"><a href="#LazyDeepClassifier-300"><span class="linenos">300</span></a>                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-301"><a href="#LazyDeepClassifier-301"><span class="linenos">301</span></a>                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-302"><a href="#LazyDeepClassifier-302"><span class="linenos">302</span></a>                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-303"><a href="#LazyDeepClassifier-303"><span class="linenos">303</span></a>                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-304"><a href="#LazyDeepClassifier-304"><span class="linenos">304</span></a>                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-305"><a href="#LazyDeepClassifier-305"><span class="linenos">305</span></a>                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-306"><a href="#LazyDeepClassifier-306"><span class="linenos">306</span></a>                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-307"><a href="#LazyDeepClassifier-307"><span class="linenos">307</span></a>                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-308"><a href="#LazyDeepClassifier-308"><span class="linenos">308</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier-309"><a href="#LazyDeepClassifier-309"><span class="linenos">309</span></a>
</span><span id="LazyDeepClassifier-310"><a href="#LazyDeepClassifier-310"><span class="linenos">310</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-311"><a href="#LazyDeepClassifier-311"><span class="linenos">311</span></a>                    <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-312"><a href="#LazyDeepClassifier-312"><span class="linenos">312</span></a>                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyDeepClassifier-313"><a href="#LazyDeepClassifier-313"><span class="linenos">313</span></a>                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-314"><a href="#LazyDeepClassifier-314"><span class="linenos">314</span></a>                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-315"><a href="#LazyDeepClassifier-315"><span class="linenos">315</span></a>                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-316"><a href="#LazyDeepClassifier-316"><span class="linenos">316</span></a>                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-317"><a href="#LazyDeepClassifier-317"><span class="linenos">317</span></a>                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-318"><a href="#LazyDeepClassifier-318"><span class="linenos">318</span></a>                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-319"><a href="#LazyDeepClassifier-319"><span class="linenos">319</span></a>                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-320"><a href="#LazyDeepClassifier-320"><span class="linenos">320</span></a>                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-321"><a href="#LazyDeepClassifier-321"><span class="linenos">321</span></a>                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-322"><a href="#LazyDeepClassifier-322"><span class="linenos">322</span></a>                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-323"><a href="#LazyDeepClassifier-323"><span class="linenos">323</span></a>                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-324"><a href="#LazyDeepClassifier-324"><span class="linenos">324</span></a>                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-325"><a href="#LazyDeepClassifier-325"><span class="linenos">325</span></a>                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-326"><a href="#LazyDeepClassifier-326"><span class="linenos">326</span></a>                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-327"><a href="#LazyDeepClassifier-327"><span class="linenos">327</span></a>                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-328"><a href="#LazyDeepClassifier-328"><span class="linenos">328</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier-329"><a href="#LazyDeepClassifier-329"><span class="linenos">329</span></a>
</span><span id="LazyDeepClassifier-330"><a href="#LazyDeepClassifier-330"><span class="linenos">330</span></a>                <span class="n">layer_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-331"><a href="#LazyDeepClassifier-331"><span class="linenos">331</span></a>
</span><span id="LazyDeepClassifier-332"><a href="#LazyDeepClassifier-332"><span class="linenos">332</span></a>                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">):</span>
</span><span id="LazyDeepClassifier-333"><a href="#LazyDeepClassifier-333"><span class="linenos">333</span></a>                    <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-334"><a href="#LazyDeepClassifier-334"><span class="linenos">334</span></a>                        <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-335"><a href="#LazyDeepClassifier-335"><span class="linenos">335</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">layer_clf</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-336"><a href="#LazyDeepClassifier-336"><span class="linenos">336</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-337"><a href="#LazyDeepClassifier-337"><span class="linenos">337</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-338"><a href="#LazyDeepClassifier-338"><span class="linenos">338</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-339"><a href="#LazyDeepClassifier-339"><span class="linenos">339</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-340"><a href="#LazyDeepClassifier-340"><span class="linenos">340</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-341"><a href="#LazyDeepClassifier-341"><span class="linenos">341</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-342"><a href="#LazyDeepClassifier-342"><span class="linenos">342</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-343"><a href="#LazyDeepClassifier-343"><span class="linenos">343</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-344"><a href="#LazyDeepClassifier-344"><span class="linenos">344</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-345"><a href="#LazyDeepClassifier-345"><span class="linenos">345</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-346"><a href="#LazyDeepClassifier-346"><span class="linenos">346</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-347"><a href="#LazyDeepClassifier-347"><span class="linenos">347</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-348"><a href="#LazyDeepClassifier-348"><span class="linenos">348</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-349"><a href="#LazyDeepClassifier-349"><span class="linenos">349</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-350"><a href="#LazyDeepClassifier-350"><span class="linenos">350</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-351"><a href="#LazyDeepClassifier-351"><span class="linenos">351</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier-352"><a href="#LazyDeepClassifier-352"><span class="linenos">352</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier-353"><a href="#LazyDeepClassifier-353"><span class="linenos">353</span></a>
</span><span id="LazyDeepClassifier-354"><a href="#LazyDeepClassifier-354"><span class="linenos">354</span></a>                    <span class="c1"># layer_clf.fit(X_train, y_train)</span>
</span><span id="LazyDeepClassifier-355"><a href="#LazyDeepClassifier-355"><span class="linenos">355</span></a>
</span><span id="LazyDeepClassifier-356"><a href="#LazyDeepClassifier-356"><span class="linenos">356</span></a>                <span class="n">layer_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-357"><a href="#LazyDeepClassifier-357"><span class="linenos">357</span></a>
</span><span id="LazyDeepClassifier-358"><a href="#LazyDeepClassifier-358"><span class="linenos">358</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_clf</span>
</span><span id="LazyDeepClassifier-359"><a href="#LazyDeepClassifier-359"><span class="linenos">359</span></a>                <span class="n">y_pred</span> <span class="o">=</span> <span class="n">layer_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-360"><a href="#LazyDeepClassifier-360"><span class="linenos">360</span></a>                <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-361"><a href="#LazyDeepClassifier-361"><span class="linenos">361</span></a>                <span class="n">b_accuracy</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-362"><a href="#LazyDeepClassifier-362"><span class="linenos">362</span></a>                <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-363"><a href="#LazyDeepClassifier-363"><span class="linenos">363</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-364"><a href="#LazyDeepClassifier-364"><span class="linenos">364</span></a>                    <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-365"><a href="#LazyDeepClassifier-365"><span class="linenos">365</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-366"><a href="#LazyDeepClassifier-366"><span class="linenos">366</span></a>                    <span class="n">roc_auc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LazyDeepClassifier-367"><a href="#LazyDeepClassifier-367"><span class="linenos">367</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-368"><a href="#LazyDeepClassifier-368"><span class="linenos">368</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROC AUC couldn&#39;t be calculated for &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-369"><a href="#LazyDeepClassifier-369"><span class="linenos">369</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-370"><a href="#LazyDeepClassifier-370"><span class="linenos">370</span></a>                <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-371"><a href="#LazyDeepClassifier-371"><span class="linenos">371</span></a>                <span class="n">Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-372"><a href="#LazyDeepClassifier-372"><span class="linenos">372</span></a>                <span class="n">B_Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_accuracy</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-373"><a href="#LazyDeepClassifier-373"><span class="linenos">373</span></a>                <span class="n">ROC_AUC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-374"><a href="#LazyDeepClassifier-374"><span class="linenos">374</span></a>                <span class="n">F1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-375"><a href="#LazyDeepClassifier-375"><span class="linenos">375</span></a>                <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-376"><a href="#LazyDeepClassifier-376"><span class="linenos">376</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-377"><a href="#LazyDeepClassifier-377"><span class="linenos">377</span></a>                    <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-378"><a href="#LazyDeepClassifier-378"><span class="linenos">378</span></a>                    <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-379"><a href="#LazyDeepClassifier-379"><span class="linenos">379</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-380"><a href="#LazyDeepClassifier-380"><span class="linenos">380</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-381"><a href="#LazyDeepClassifier-381"><span class="linenos">381</span></a>                        <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-382"><a href="#LazyDeepClassifier-382"><span class="linenos">382</span></a>                            <span class="p">{</span>
</span><span id="LazyDeepClassifier-383"><a href="#LazyDeepClassifier-383"><span class="linenos">383</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-384"><a href="#LazyDeepClassifier-384"><span class="linenos">384</span></a>                                <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-385"><a href="#LazyDeepClassifier-385"><span class="linenos">385</span></a>                                <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-386"><a href="#LazyDeepClassifier-386"><span class="linenos">386</span></a>                                <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-387"><a href="#LazyDeepClassifier-387"><span class="linenos">387</span></a>                                <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-388"><a href="#LazyDeepClassifier-388"><span class="linenos">388</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">custom_metric</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-389"><a href="#LazyDeepClassifier-389"><span class="linenos">389</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-390"><a href="#LazyDeepClassifier-390"><span class="linenos">390</span></a>                            <span class="p">}</span>
</span><span id="LazyDeepClassifier-391"><a href="#LazyDeepClassifier-391"><span class="linenos">391</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier-392"><a href="#LazyDeepClassifier-392"><span class="linenos">392</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-393"><a href="#LazyDeepClassifier-393"><span class="linenos">393</span></a>                        <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-394"><a href="#LazyDeepClassifier-394"><span class="linenos">394</span></a>                            <span class="p">{</span>
</span><span id="LazyDeepClassifier-395"><a href="#LazyDeepClassifier-395"><span class="linenos">395</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-396"><a href="#LazyDeepClassifier-396"><span class="linenos">396</span></a>                                <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-397"><a href="#LazyDeepClassifier-397"><span class="linenos">397</span></a>                                <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-398"><a href="#LazyDeepClassifier-398"><span class="linenos">398</span></a>                                <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-399"><a href="#LazyDeepClassifier-399"><span class="linenos">399</span></a>                                <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-400"><a href="#LazyDeepClassifier-400"><span class="linenos">400</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-401"><a href="#LazyDeepClassifier-401"><span class="linenos">401</span></a>                            <span class="p">}</span>
</span><span id="LazyDeepClassifier-402"><a href="#LazyDeepClassifier-402"><span class="linenos">402</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier-403"><a href="#LazyDeepClassifier-403"><span class="linenos">403</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-404"><a href="#LazyDeepClassifier-404"><span class="linenos">404</span></a>                    <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyDeepClassifier-405"><a href="#LazyDeepClassifier-405"><span class="linenos">405</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-406"><a href="#LazyDeepClassifier-406"><span class="linenos">406</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-407"><a href="#LazyDeepClassifier-407"><span class="linenos">407</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-408"><a href="#LazyDeepClassifier-408"><span class="linenos">408</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-409"><a href="#LazyDeepClassifier-409"><span class="linenos">409</span></a>
</span><span id="LazyDeepClassifier-410"><a href="#LazyDeepClassifier-410"><span class="linenos">410</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-411"><a href="#LazyDeepClassifier-411"><span class="linenos">411</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-412"><a href="#LazyDeepClassifier-412"><span class="linenos">412</span></a>                <span class="p">{</span>
</span><span id="LazyDeepClassifier-413"><a href="#LazyDeepClassifier-413"><span class="linenos">413</span></a>                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-414"><a href="#LazyDeepClassifier-414"><span class="linenos">414</span></a>                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-415"><a href="#LazyDeepClassifier-415"><span class="linenos">415</span></a>                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">B_Accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-416"><a href="#LazyDeepClassifier-416"><span class="linenos">416</span></a>                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">ROC_AUC</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-417"><a href="#LazyDeepClassifier-417"><span class="linenos">417</span></a>                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-418"><a href="#LazyDeepClassifier-418"><span class="linenos">418</span></a>                    <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-419"><a href="#LazyDeepClassifier-419"><span class="linenos">419</span></a>                <span class="p">}</span>
</span><span id="LazyDeepClassifier-420"><a href="#LazyDeepClassifier-420"><span class="linenos">420</span></a>            <span class="p">)</span>
</span><span id="LazyDeepClassifier-421"><a href="#LazyDeepClassifier-421"><span class="linenos">421</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-422"><a href="#LazyDeepClassifier-422"><span class="linenos">422</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-423"><a href="#LazyDeepClassifier-423"><span class="linenos">423</span></a>                <span class="p">{</span>
</span><span id="LazyDeepClassifier-424"><a href="#LazyDeepClassifier-424"><span class="linenos">424</span></a>                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-425"><a href="#LazyDeepClassifier-425"><span class="linenos">425</span></a>                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-426"><a href="#LazyDeepClassifier-426"><span class="linenos">426</span></a>                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">B_Accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-427"><a href="#LazyDeepClassifier-427"><span class="linenos">427</span></a>                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">ROC_AUC</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-428"><a href="#LazyDeepClassifier-428"><span class="linenos">428</span></a>                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-429"><a href="#LazyDeepClassifier-429"><span class="linenos">429</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">CUSTOM_METRIC</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-430"><a href="#LazyDeepClassifier-430"><span class="linenos">430</span></a>                    <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepClassifier-431"><a href="#LazyDeepClassifier-431"><span class="linenos">431</span></a>                <span class="p">}</span>
</span><span id="LazyDeepClassifier-432"><a href="#LazyDeepClassifier-432"><span class="linenos">432</span></a>            <span class="p">)</span>
</span><span id="LazyDeepClassifier-433"><a href="#LazyDeepClassifier-433"><span class="linenos">433</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_by</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyDeepClassifier-434"><a href="#LazyDeepClassifier-434"><span class="linenos">434</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyDeepClassifier-435"><a href="#LazyDeepClassifier-435"><span class="linenos">435</span></a>        <span class="p">)</span>
</span><span id="LazyDeepClassifier-436"><a href="#LazyDeepClassifier-436"><span class="linenos">436</span></a>
</span><span id="LazyDeepClassifier-437"><a href="#LazyDeepClassifier-437"><span class="linenos">437</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-438"><a href="#LazyDeepClassifier-438"><span class="linenos">438</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-439"><a href="#LazyDeepClassifier-439"><span class="linenos">439</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span><span id="LazyDeepClassifier-440"><a href="#LazyDeepClassifier-440"><span class="linenos">440</span></a>
</span><span id="LazyDeepClassifier-441"><a href="#LazyDeepClassifier-441"><span class="linenos">441</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyDeepClassifier-442"><a href="#LazyDeepClassifier-442"><span class="linenos">442</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all the model objects trained. If fit hasn&#39;t been called yet,</span>
</span><span id="LazyDeepClassifier-443"><a href="#LazyDeepClassifier-443"><span class="linenos">443</span></a><span class="sd">        then it&#39;s called to return the models.</span>
</span><span id="LazyDeepClassifier-444"><a href="#LazyDeepClassifier-444"><span class="linenos">444</span></a>
</span><span id="LazyDeepClassifier-445"><a href="#LazyDeepClassifier-445"><span class="linenos">445</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepClassifier-446"><a href="#LazyDeepClassifier-446"><span class="linenos">446</span></a>
</span><span id="LazyDeepClassifier-447"><a href="#LazyDeepClassifier-447"><span class="linenos">447</span></a><span class="sd">        X_train: array-like,</span>
</span><span id="LazyDeepClassifier-448"><a href="#LazyDeepClassifier-448"><span class="linenos">448</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier-449"><a href="#LazyDeepClassifier-449"><span class="linenos">449</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyDeepClassifier-450"><a href="#LazyDeepClassifier-450"><span class="linenos">450</span></a>
</span><span id="LazyDeepClassifier-451"><a href="#LazyDeepClassifier-451"><span class="linenos">451</span></a><span class="sd">        X_test: array-like,</span>
</span><span id="LazyDeepClassifier-452"><a href="#LazyDeepClassifier-452"><span class="linenos">452</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier-453"><a href="#LazyDeepClassifier-453"><span class="linenos">453</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyDeepClassifier-454"><a href="#LazyDeepClassifier-454"><span class="linenos">454</span></a>
</span><span id="LazyDeepClassifier-455"><a href="#LazyDeepClassifier-455"><span class="linenos">455</span></a><span class="sd">        y_train: array-like,</span>
</span><span id="LazyDeepClassifier-456"><a href="#LazyDeepClassifier-456"><span class="linenos">456</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier-457"><a href="#LazyDeepClassifier-457"><span class="linenos">457</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyDeepClassifier-458"><a href="#LazyDeepClassifier-458"><span class="linenos">458</span></a>
</span><span id="LazyDeepClassifier-459"><a href="#LazyDeepClassifier-459"><span class="linenos">459</span></a><span class="sd">        y_test: array-like,</span>
</span><span id="LazyDeepClassifier-460"><a href="#LazyDeepClassifier-460"><span class="linenos">460</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier-461"><a href="#LazyDeepClassifier-461"><span class="linenos">461</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyDeepClassifier-462"><a href="#LazyDeepClassifier-462"><span class="linenos">462</span></a>
</span><span id="LazyDeepClassifier-463"><a href="#LazyDeepClassifier-463"><span class="linenos">463</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepClassifier-464"><a href="#LazyDeepClassifier-464"><span class="linenos">464</span></a>
</span><span id="LazyDeepClassifier-465"><a href="#LazyDeepClassifier-465"><span class="linenos">465</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyDeepClassifier-466"><a href="#LazyDeepClassifier-466"><span class="linenos">466</span></a><span class="sd">                Returns a dictionary with each model&#39;s pipeline as value</span>
</span><span id="LazyDeepClassifier-467"><a href="#LazyDeepClassifier-467"><span class="linenos">467</span></a><span class="sd">                and key = name of the model.</span>
</span><span id="LazyDeepClassifier-468"><a href="#LazyDeepClassifier-468"><span class="linenos">468</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepClassifier-469"><a href="#LazyDeepClassifier-469"><span class="linenos">469</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepClassifier-470"><a href="#LazyDeepClassifier-470"><span class="linenos">470</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span><span id="LazyDeepClassifier-471"><a href="#LazyDeepClassifier-471"><span class="linenos">471</span></a>
</span><span id="LazyDeepClassifier-472"><a href="#LazyDeepClassifier-472"><span class="linenos">472</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>Fitting -- almost -- all the classification algorithms with layers of
nnetsauce's CustomClassifier and returning their scores.</p>

<p>Parameters:</p>

<pre><code>verbose: int, optional (default=0)
    Any positive number for verbosity.

ignore_warnings: bool, optional (default=True)
    When set to True, the warning related to algorigms that are not
    able to run are ignored.

custom_metric: function, optional (default=None)
    When function is provided, models are evaluated based on the custom
      evaluation metric provided.

predictions: bool, optional (default=False)
    When set to True, the predictions of all the models models are
    returned as data frame.

sort_by: string, optional (default='Accuracy')
    Sort models by a metric. Available options are 'Accuracy',
    'Balanced Accuracy', 'ROC AUC', 'F1 Score' or a custom metric
    identified by its name and provided by custom_metric.

random_state: int, optional (default=42)
    Reproducibiility seed.

estimators: list, optional (default='all')
    list of Estimators names or just 'all' for &gt; 90 classifiers
    (default='all')

preprocess: bool, preprocessing is done when set to True

n_jobs: int, when possible, run in parallel
    For now, only used by individual models that support it.

n_layers: int, optional (default=3)
    Number of layers of CustomClassifiers to be used.

All the other parameters are the same as CustomClassifier's.
</code></pre>

<p>Examples
    <div class="pdoc-code codehilite">
    <pre><span></span><code><span class="kn">import</span> <span class="nn">nnetsauce</span> <span class="k">as</span> <span class="nn">ns</span>
    <span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_breast_cancer</span>
    <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_breast_cancer</span><span class="p">()</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>
    <span class="n">y</span><span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">target</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">LazyDeepClassifier</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">custom_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">models</span><span class="p">,</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="n">model_dictionary</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">provide_models</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">models</span><span class="p">)</span>
    </code></pre>
    </div></p>
</div>


                                <div id="LazyDeepClassifier.fit" class="classattr">
                                            <input id="LazyDeepClassifier.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">y_train</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyDeepClassifier.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepClassifier.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepClassifier.fit-191"><a href="#LazyDeepClassifier.fit-191"><span class="linenos">191</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyDeepClassifier.fit-192"><a href="#LazyDeepClassifier.fit-192"><span class="linenos">192</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit classifiers to X_train and y_train, predict and score on X_test,</span>
</span><span id="LazyDeepClassifier.fit-193"><a href="#LazyDeepClassifier.fit-193"><span class="linenos">193</span></a><span class="sd">        y_test.</span>
</span><span id="LazyDeepClassifier.fit-194"><a href="#LazyDeepClassifier.fit-194"><span class="linenos">194</span></a>
</span><span id="LazyDeepClassifier.fit-195"><a href="#LazyDeepClassifier.fit-195"><span class="linenos">195</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepClassifier.fit-196"><a href="#LazyDeepClassifier.fit-196"><span class="linenos">196</span></a>
</span><span id="LazyDeepClassifier.fit-197"><a href="#LazyDeepClassifier.fit-197"><span class="linenos">197</span></a><span class="sd">            X_train: array-like,</span>
</span><span id="LazyDeepClassifier.fit-198"><a href="#LazyDeepClassifier.fit-198"><span class="linenos">198</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier.fit-199"><a href="#LazyDeepClassifier.fit-199"><span class="linenos">199</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepClassifier.fit-200"><a href="#LazyDeepClassifier.fit-200"><span class="linenos">200</span></a>
</span><span id="LazyDeepClassifier.fit-201"><a href="#LazyDeepClassifier.fit-201"><span class="linenos">201</span></a><span class="sd">            X_test: array-like,</span>
</span><span id="LazyDeepClassifier.fit-202"><a href="#LazyDeepClassifier.fit-202"><span class="linenos">202</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier.fit-203"><a href="#LazyDeepClassifier.fit-203"><span class="linenos">203</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepClassifier.fit-204"><a href="#LazyDeepClassifier.fit-204"><span class="linenos">204</span></a>
</span><span id="LazyDeepClassifier.fit-205"><a href="#LazyDeepClassifier.fit-205"><span class="linenos">205</span></a><span class="sd">            y_train: array-like,</span>
</span><span id="LazyDeepClassifier.fit-206"><a href="#LazyDeepClassifier.fit-206"><span class="linenos">206</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier.fit-207"><a href="#LazyDeepClassifier.fit-207"><span class="linenos">207</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepClassifier.fit-208"><a href="#LazyDeepClassifier.fit-208"><span class="linenos">208</span></a>
</span><span id="LazyDeepClassifier.fit-209"><a href="#LazyDeepClassifier.fit-209"><span class="linenos">209</span></a><span class="sd">            y_test: array-like,</span>
</span><span id="LazyDeepClassifier.fit-210"><a href="#LazyDeepClassifier.fit-210"><span class="linenos">210</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier.fit-211"><a href="#LazyDeepClassifier.fit-211"><span class="linenos">211</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepClassifier.fit-212"><a href="#LazyDeepClassifier.fit-212"><span class="linenos">212</span></a>
</span><span id="LazyDeepClassifier.fit-213"><a href="#LazyDeepClassifier.fit-213"><span class="linenos">213</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepClassifier.fit-214"><a href="#LazyDeepClassifier.fit-214"><span class="linenos">214</span></a>
</span><span id="LazyDeepClassifier.fit-215"><a href="#LazyDeepClassifier.fit-215"><span class="linenos">215</span></a><span class="sd">            scores: Pandas DataFrame</span>
</span><span id="LazyDeepClassifier.fit-216"><a href="#LazyDeepClassifier.fit-216"><span class="linenos">216</span></a><span class="sd">                Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepClassifier.fit-217"><a href="#LazyDeepClassifier.fit-217"><span class="linenos">217</span></a>
</span><span id="LazyDeepClassifier.fit-218"><a href="#LazyDeepClassifier.fit-218"><span class="linenos">218</span></a><span class="sd">            predictions: Pandas DataFrame</span>
</span><span id="LazyDeepClassifier.fit-219"><a href="#LazyDeepClassifier.fit-219"><span class="linenos">219</span></a><span class="sd">                Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepClassifier.fit-220"><a href="#LazyDeepClassifier.fit-220"><span class="linenos">220</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepClassifier.fit-221"><a href="#LazyDeepClassifier.fit-221"><span class="linenos">221</span></a>        <span class="n">Accuracy</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier.fit-222"><a href="#LazyDeepClassifier.fit-222"><span class="linenos">222</span></a>        <span class="n">B_Accuracy</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier.fit-223"><a href="#LazyDeepClassifier.fit-223"><span class="linenos">223</span></a>        <span class="n">ROC_AUC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier.fit-224"><a href="#LazyDeepClassifier.fit-224"><span class="linenos">224</span></a>        <span class="n">F1</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier.fit-225"><a href="#LazyDeepClassifier.fit-225"><span class="linenos">225</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier.fit-226"><a href="#LazyDeepClassifier.fit-226"><span class="linenos">226</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier.fit-227"><a href="#LazyDeepClassifier.fit-227"><span class="linenos">227</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepClassifier.fit-228"><a href="#LazyDeepClassifier.fit-228"><span class="linenos">228</span></a>
</span><span id="LazyDeepClassifier.fit-229"><a href="#LazyDeepClassifier.fit-229"><span class="linenos">229</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-230"><a href="#LazyDeepClassifier.fit-230"><span class="linenos">230</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepClassifier.fit-231"><a href="#LazyDeepClassifier.fit-231"><span class="linenos">231</span></a>
</span><span id="LazyDeepClassifier.fit-232"><a href="#LazyDeepClassifier.fit-232"><span class="linenos">232</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyDeepClassifier.fit-233"><a href="#LazyDeepClassifier.fit-233"><span class="linenos">233</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-234"><a href="#LazyDeepClassifier.fit-234"><span class="linenos">234</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-235"><a href="#LazyDeepClassifier.fit-235"><span class="linenos">235</span></a>
</span><span id="LazyDeepClassifier.fit-236"><a href="#LazyDeepClassifier.fit-236"><span class="linenos">236</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepClassifier.fit-237"><a href="#LazyDeepClassifier.fit-237"><span class="linenos">237</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepClassifier.fit-238"><a href="#LazyDeepClassifier.fit-238"><span class="linenos">238</span></a>
</span><span id="LazyDeepClassifier.fit-239"><a href="#LazyDeepClassifier.fit-239"><span class="linenos">239</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-240"><a href="#LazyDeepClassifier.fit-240"><span class="linenos">240</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyDeepClassifier.fit-241"><a href="#LazyDeepClassifier.fit-241"><span class="linenos">241</span></a>        <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-242"><a href="#LazyDeepClassifier.fit-242"><span class="linenos">242</span></a>
</span><span id="LazyDeepClassifier.fit-243"><a href="#LazyDeepClassifier.fit-243"><span class="linenos">243</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-244"><a href="#LazyDeepClassifier.fit-244"><span class="linenos">244</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyDeepClassifier.fit-245"><a href="#LazyDeepClassifier.fit-245"><span class="linenos">245</span></a>                <span class="n">item</span>
</span><span id="LazyDeepClassifier.fit-246"><a href="#LazyDeepClassifier.fit-246"><span class="linenos">246</span></a>                <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="p">[</span>
</span><span id="LazyDeepClassifier.fit-247"><a href="#LazyDeepClassifier.fit-247"><span class="linenos">247</span></a>                    <span class="n">DEEPCLASSIFIERS</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-248"><a href="#LazyDeepClassifier.fit-248"><span class="linenos">248</span></a>                    <span class="n">DEEPMULTITASKCLASSIFIERS</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-249"><a href="#LazyDeepClassifier.fit-249"><span class="linenos">249</span></a>                    <span class="n">DEEPSIMPLEMULTITASKCLASSIFIERS</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-250"><a href="#LazyDeepClassifier.fit-250"><span class="linenos">250</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier.fit-251"><a href="#LazyDeepClassifier.fit-251"><span class="linenos">251</span></a>                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span>
</span><span id="LazyDeepClassifier.fit-252"><a href="#LazyDeepClassifier.fit-252"><span class="linenos">252</span></a>            <span class="p">]</span>
</span><span id="LazyDeepClassifier.fit-253"><a href="#LazyDeepClassifier.fit-253"><span class="linenos">253</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-254"><a href="#LazyDeepClassifier.fit-254"><span class="linenos">254</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-255"><a href="#LazyDeepClassifier.fit-255"><span class="linenos">255</span></a>                <span class="p">[</span>
</span><span id="LazyDeepClassifier.fit-256"><a href="#LazyDeepClassifier.fit-256"><span class="linenos">256</span></a>                    <span class="p">(</span><span class="s2">&quot;DeepCustomClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyDeepClassifier.fit-257"><a href="#LazyDeepClassifier.fit-257"><span class="linenos">257</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepClassifier.fit-258"><a href="#LazyDeepClassifier.fit-258"><span class="linenos">258</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-259"><a href="#LazyDeepClassifier.fit-259"><span class="linenos">259</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ClassifierMixin</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-260"><a href="#LazyDeepClassifier.fit-260"><span class="linenos">260</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-261"><a href="#LazyDeepClassifier.fit-261"><span class="linenos">261</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-262"><a href="#LazyDeepClassifier.fit-262"><span class="linenos">262</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier.fit-263"><a href="#LazyDeepClassifier.fit-263"><span class="linenos">263</span></a>                <span class="o">+</span> <span class="p">[</span>
</span><span id="LazyDeepClassifier.fit-264"><a href="#LazyDeepClassifier.fit-264"><span class="linenos">264</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-265"><a href="#LazyDeepClassifier.fit-265"><span class="linenos">265</span></a>                        <span class="s2">&quot;DeepMultitaskClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-266"><a href="#LazyDeepClassifier.fit-266"><span class="linenos">266</span></a>                        <span class="n">partial</span><span class="p">(</span><span class="n">MultitaskClassifier</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">]()),</span>
</span><span id="LazyDeepClassifier.fit-267"><a href="#LazyDeepClassifier.fit-267"><span class="linenos">267</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-268"><a href="#LazyDeepClassifier.fit-268"><span class="linenos">268</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepClassifier.fit-269"><a href="#LazyDeepClassifier.fit-269"><span class="linenos">269</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-270"><a href="#LazyDeepClassifier.fit-270"><span class="linenos">270</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-271"><a href="#LazyDeepClassifier.fit-271"><span class="linenos">271</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-272"><a href="#LazyDeepClassifier.fit-272"><span class="linenos">272</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-273"><a href="#LazyDeepClassifier.fit-273"><span class="linenos">273</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier.fit-274"><a href="#LazyDeepClassifier.fit-274"><span class="linenos">274</span></a>                <span class="o">+</span> <span class="p">[</span>
</span><span id="LazyDeepClassifier.fit-275"><a href="#LazyDeepClassifier.fit-275"><span class="linenos">275</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-276"><a href="#LazyDeepClassifier.fit-276"><span class="linenos">276</span></a>                        <span class="s2">&quot;DeepSimpleMultitaskClassifier(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-277"><a href="#LazyDeepClassifier.fit-277"><span class="linenos">277</span></a>                        <span class="n">partial</span><span class="p">(</span><span class="n">SimpleMultitaskClassifier</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">]()),</span>
</span><span id="LazyDeepClassifier.fit-278"><a href="#LazyDeepClassifier.fit-278"><span class="linenos">278</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-279"><a href="#LazyDeepClassifier.fit-279"><span class="linenos">279</span></a>                    <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepClassifier.fit-280"><a href="#LazyDeepClassifier.fit-280"><span class="linenos">280</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-281"><a href="#LazyDeepClassifier.fit-281"><span class="linenos">281</span></a>                        <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-282"><a href="#LazyDeepClassifier.fit-282"><span class="linenos">282</span></a>                        <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-283"><a href="#LazyDeepClassifier.fit-283"><span class="linenos">283</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-284"><a href="#LazyDeepClassifier.fit-284"><span class="linenos">284</span></a>                <span class="p">]</span>
</span><span id="LazyDeepClassifier.fit-285"><a href="#LazyDeepClassifier.fit-285"><span class="linenos">285</span></a>            <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-286"><a href="#LazyDeepClassifier.fit-286"><span class="linenos">286</span></a>
</span><span id="LazyDeepClassifier.fit-287"><a href="#LazyDeepClassifier.fit-287"><span class="linenos">287</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classifiers</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepClassifier.fit-288"><a href="#LazyDeepClassifier.fit-288"><span class="linenos">288</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepClassifier.fit-289"><a href="#LazyDeepClassifier.fit-289"><span class="linenos">289</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-290"><a href="#LazyDeepClassifier.fit-290"><span class="linenos">290</span></a>                <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepClassifier.fit-291"><a href="#LazyDeepClassifier.fit-291"><span class="linenos">291</span></a>                    <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-292"><a href="#LazyDeepClassifier.fit-292"><span class="linenos">292</span></a>                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">),</span>
</span><span id="LazyDeepClassifier.fit-293"><a href="#LazyDeepClassifier.fit-293"><span class="linenos">293</span></a>                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-294"><a href="#LazyDeepClassifier.fit-294"><span class="linenos">294</span></a>                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-295"><a href="#LazyDeepClassifier.fit-295"><span class="linenos">295</span></a>                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-296"><a href="#LazyDeepClassifier.fit-296"><span class="linenos">296</span></a>                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-297"><a href="#LazyDeepClassifier.fit-297"><span class="linenos">297</span></a>                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-298"><a href="#LazyDeepClassifier.fit-298"><span class="linenos">298</span></a>                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-299"><a href="#LazyDeepClassifier.fit-299"><span class="linenos">299</span></a>                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-300"><a href="#LazyDeepClassifier.fit-300"><span class="linenos">300</span></a>                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-301"><a href="#LazyDeepClassifier.fit-301"><span class="linenos">301</span></a>                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-302"><a href="#LazyDeepClassifier.fit-302"><span class="linenos">302</span></a>                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-303"><a href="#LazyDeepClassifier.fit-303"><span class="linenos">303</span></a>                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-304"><a href="#LazyDeepClassifier.fit-304"><span class="linenos">304</span></a>                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-305"><a href="#LazyDeepClassifier.fit-305"><span class="linenos">305</span></a>                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-306"><a href="#LazyDeepClassifier.fit-306"><span class="linenos">306</span></a>                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-307"><a href="#LazyDeepClassifier.fit-307"><span class="linenos">307</span></a>                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-308"><a href="#LazyDeepClassifier.fit-308"><span class="linenos">308</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-309"><a href="#LazyDeepClassifier.fit-309"><span class="linenos">309</span></a>
</span><span id="LazyDeepClassifier.fit-310"><a href="#LazyDeepClassifier.fit-310"><span class="linenos">310</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-311"><a href="#LazyDeepClassifier.fit-311"><span class="linenos">311</span></a>                    <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-312"><a href="#LazyDeepClassifier.fit-312"><span class="linenos">312</span></a>                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyDeepClassifier.fit-313"><a href="#LazyDeepClassifier.fit-313"><span class="linenos">313</span></a>                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-314"><a href="#LazyDeepClassifier.fit-314"><span class="linenos">314</span></a>                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-315"><a href="#LazyDeepClassifier.fit-315"><span class="linenos">315</span></a>                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-316"><a href="#LazyDeepClassifier.fit-316"><span class="linenos">316</span></a>                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-317"><a href="#LazyDeepClassifier.fit-317"><span class="linenos">317</span></a>                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-318"><a href="#LazyDeepClassifier.fit-318"><span class="linenos">318</span></a>                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-319"><a href="#LazyDeepClassifier.fit-319"><span class="linenos">319</span></a>                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-320"><a href="#LazyDeepClassifier.fit-320"><span class="linenos">320</span></a>                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-321"><a href="#LazyDeepClassifier.fit-321"><span class="linenos">321</span></a>                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-322"><a href="#LazyDeepClassifier.fit-322"><span class="linenos">322</span></a>                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-323"><a href="#LazyDeepClassifier.fit-323"><span class="linenos">323</span></a>                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-324"><a href="#LazyDeepClassifier.fit-324"><span class="linenos">324</span></a>                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-325"><a href="#LazyDeepClassifier.fit-325"><span class="linenos">325</span></a>                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-326"><a href="#LazyDeepClassifier.fit-326"><span class="linenos">326</span></a>                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-327"><a href="#LazyDeepClassifier.fit-327"><span class="linenos">327</span></a>                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-328"><a href="#LazyDeepClassifier.fit-328"><span class="linenos">328</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-329"><a href="#LazyDeepClassifier.fit-329"><span class="linenos">329</span></a>
</span><span id="LazyDeepClassifier.fit-330"><a href="#LazyDeepClassifier.fit-330"><span class="linenos">330</span></a>                <span class="n">layer_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-331"><a href="#LazyDeepClassifier.fit-331"><span class="linenos">331</span></a>
</span><span id="LazyDeepClassifier.fit-332"><a href="#LazyDeepClassifier.fit-332"><span class="linenos">332</span></a>                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">):</span>
</span><span id="LazyDeepClassifier.fit-333"><a href="#LazyDeepClassifier.fit-333"><span class="linenos">333</span></a>                    <span class="n">layer_clf</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-334"><a href="#LazyDeepClassifier.fit-334"><span class="linenos">334</span></a>                        <span class="n">CustomClassifier</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-335"><a href="#LazyDeepClassifier.fit-335"><span class="linenos">335</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">layer_clf</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-336"><a href="#LazyDeepClassifier.fit-336"><span class="linenos">336</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-337"><a href="#LazyDeepClassifier.fit-337"><span class="linenos">337</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-338"><a href="#LazyDeepClassifier.fit-338"><span class="linenos">338</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-339"><a href="#LazyDeepClassifier.fit-339"><span class="linenos">339</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-340"><a href="#LazyDeepClassifier.fit-340"><span class="linenos">340</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-341"><a href="#LazyDeepClassifier.fit-341"><span class="linenos">341</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-342"><a href="#LazyDeepClassifier.fit-342"><span class="linenos">342</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-343"><a href="#LazyDeepClassifier.fit-343"><span class="linenos">343</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-344"><a href="#LazyDeepClassifier.fit-344"><span class="linenos">344</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-345"><a href="#LazyDeepClassifier.fit-345"><span class="linenos">345</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-346"><a href="#LazyDeepClassifier.fit-346"><span class="linenos">346</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-347"><a href="#LazyDeepClassifier.fit-347"><span class="linenos">347</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-348"><a href="#LazyDeepClassifier.fit-348"><span class="linenos">348</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-349"><a href="#LazyDeepClassifier.fit-349"><span class="linenos">349</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-350"><a href="#LazyDeepClassifier.fit-350"><span class="linenos">350</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-351"><a href="#LazyDeepClassifier.fit-351"><span class="linenos">351</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-352"><a href="#LazyDeepClassifier.fit-352"><span class="linenos">352</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-353"><a href="#LazyDeepClassifier.fit-353"><span class="linenos">353</span></a>
</span><span id="LazyDeepClassifier.fit-354"><a href="#LazyDeepClassifier.fit-354"><span class="linenos">354</span></a>                    <span class="c1"># layer_clf.fit(X_train, y_train)</span>
</span><span id="LazyDeepClassifier.fit-355"><a href="#LazyDeepClassifier.fit-355"><span class="linenos">355</span></a>
</span><span id="LazyDeepClassifier.fit-356"><a href="#LazyDeepClassifier.fit-356"><span class="linenos">356</span></a>                <span class="n">layer_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-357"><a href="#LazyDeepClassifier.fit-357"><span class="linenos">357</span></a>
</span><span id="LazyDeepClassifier.fit-358"><a href="#LazyDeepClassifier.fit-358"><span class="linenos">358</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_clf</span>
</span><span id="LazyDeepClassifier.fit-359"><a href="#LazyDeepClassifier.fit-359"><span class="linenos">359</span></a>                <span class="n">y_pred</span> <span class="o">=</span> <span class="n">layer_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-360"><a href="#LazyDeepClassifier.fit-360"><span class="linenos">360</span></a>                <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-361"><a href="#LazyDeepClassifier.fit-361"><span class="linenos">361</span></a>                <span class="n">b_accuracy</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-362"><a href="#LazyDeepClassifier.fit-362"><span class="linenos">362</span></a>                <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-363"><a href="#LazyDeepClassifier.fit-363"><span class="linenos">363</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-364"><a href="#LazyDeepClassifier.fit-364"><span class="linenos">364</span></a>                    <span class="n">roc_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-365"><a href="#LazyDeepClassifier.fit-365"><span class="linenos">365</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-366"><a href="#LazyDeepClassifier.fit-366"><span class="linenos">366</span></a>                    <span class="n">roc_auc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="LazyDeepClassifier.fit-367"><a href="#LazyDeepClassifier.fit-367"><span class="linenos">367</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-368"><a href="#LazyDeepClassifier.fit-368"><span class="linenos">368</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROC AUC couldn&#39;t be calculated for &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-369"><a href="#LazyDeepClassifier.fit-369"><span class="linenos">369</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-370"><a href="#LazyDeepClassifier.fit-370"><span class="linenos">370</span></a>                <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-371"><a href="#LazyDeepClassifier.fit-371"><span class="linenos">371</span></a>                <span class="n">Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-372"><a href="#LazyDeepClassifier.fit-372"><span class="linenos">372</span></a>                <span class="n">B_Accuracy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_accuracy</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-373"><a href="#LazyDeepClassifier.fit-373"><span class="linenos">373</span></a>                <span class="n">ROC_AUC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">roc_auc</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-374"><a href="#LazyDeepClassifier.fit-374"><span class="linenos">374</span></a>                <span class="n">F1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-375"><a href="#LazyDeepClassifier.fit-375"><span class="linenos">375</span></a>                <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-376"><a href="#LazyDeepClassifier.fit-376"><span class="linenos">376</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-377"><a href="#LazyDeepClassifier.fit-377"><span class="linenos">377</span></a>                    <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-378"><a href="#LazyDeepClassifier.fit-378"><span class="linenos">378</span></a>                    <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-379"><a href="#LazyDeepClassifier.fit-379"><span class="linenos">379</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-380"><a href="#LazyDeepClassifier.fit-380"><span class="linenos">380</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-381"><a href="#LazyDeepClassifier.fit-381"><span class="linenos">381</span></a>                        <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-382"><a href="#LazyDeepClassifier.fit-382"><span class="linenos">382</span></a>                            <span class="p">{</span>
</span><span id="LazyDeepClassifier.fit-383"><a href="#LazyDeepClassifier.fit-383"><span class="linenos">383</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-384"><a href="#LazyDeepClassifier.fit-384"><span class="linenos">384</span></a>                                <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-385"><a href="#LazyDeepClassifier.fit-385"><span class="linenos">385</span></a>                                <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-386"><a href="#LazyDeepClassifier.fit-386"><span class="linenos">386</span></a>                                <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-387"><a href="#LazyDeepClassifier.fit-387"><span class="linenos">387</span></a>                                <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-388"><a href="#LazyDeepClassifier.fit-388"><span class="linenos">388</span></a>                                <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">custom_metric</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-389"><a href="#LazyDeepClassifier.fit-389"><span class="linenos">389</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-390"><a href="#LazyDeepClassifier.fit-390"><span class="linenos">390</span></a>                            <span class="p">}</span>
</span><span id="LazyDeepClassifier.fit-391"><a href="#LazyDeepClassifier.fit-391"><span class="linenos">391</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-392"><a href="#LazyDeepClassifier.fit-392"><span class="linenos">392</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-393"><a href="#LazyDeepClassifier.fit-393"><span class="linenos">393</span></a>                        <span class="nb">print</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-394"><a href="#LazyDeepClassifier.fit-394"><span class="linenos">394</span></a>                            <span class="p">{</span>
</span><span id="LazyDeepClassifier.fit-395"><a href="#LazyDeepClassifier.fit-395"><span class="linenos">395</span></a>                                <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-396"><a href="#LazyDeepClassifier.fit-396"><span class="linenos">396</span></a>                                <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-397"><a href="#LazyDeepClassifier.fit-397"><span class="linenos">397</span></a>                                <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">b_accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-398"><a href="#LazyDeepClassifier.fit-398"><span class="linenos">398</span></a>                                <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">roc_auc</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-399"><a href="#LazyDeepClassifier.fit-399"><span class="linenos">399</span></a>                                <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">f1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-400"><a href="#LazyDeepClassifier.fit-400"><span class="linenos">400</span></a>                                <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-401"><a href="#LazyDeepClassifier.fit-401"><span class="linenos">401</span></a>                            <span class="p">}</span>
</span><span id="LazyDeepClassifier.fit-402"><a href="#LazyDeepClassifier.fit-402"><span class="linenos">402</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-403"><a href="#LazyDeepClassifier.fit-403"><span class="linenos">403</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-404"><a href="#LazyDeepClassifier.fit-404"><span class="linenos">404</span></a>                    <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyDeepClassifier.fit-405"><a href="#LazyDeepClassifier.fit-405"><span class="linenos">405</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-406"><a href="#LazyDeepClassifier.fit-406"><span class="linenos">406</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-407"><a href="#LazyDeepClassifier.fit-407"><span class="linenos">407</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-408"><a href="#LazyDeepClassifier.fit-408"><span class="linenos">408</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-409"><a href="#LazyDeepClassifier.fit-409"><span class="linenos">409</span></a>
</span><span id="LazyDeepClassifier.fit-410"><a href="#LazyDeepClassifier.fit-410"><span class="linenos">410</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-411"><a href="#LazyDeepClassifier.fit-411"><span class="linenos">411</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-412"><a href="#LazyDeepClassifier.fit-412"><span class="linenos">412</span></a>                <span class="p">{</span>
</span><span id="LazyDeepClassifier.fit-413"><a href="#LazyDeepClassifier.fit-413"><span class="linenos">413</span></a>                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-414"><a href="#LazyDeepClassifier.fit-414"><span class="linenos">414</span></a>                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-415"><a href="#LazyDeepClassifier.fit-415"><span class="linenos">415</span></a>                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">B_Accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-416"><a href="#LazyDeepClassifier.fit-416"><span class="linenos">416</span></a>                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">ROC_AUC</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-417"><a href="#LazyDeepClassifier.fit-417"><span class="linenos">417</span></a>                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-418"><a href="#LazyDeepClassifier.fit-418"><span class="linenos">418</span></a>                    <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-419"><a href="#LazyDeepClassifier.fit-419"><span class="linenos">419</span></a>                <span class="p">}</span>
</span><span id="LazyDeepClassifier.fit-420"><a href="#LazyDeepClassifier.fit-420"><span class="linenos">420</span></a>            <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-421"><a href="#LazyDeepClassifier.fit-421"><span class="linenos">421</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-422"><a href="#LazyDeepClassifier.fit-422"><span class="linenos">422</span></a>            <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-423"><a href="#LazyDeepClassifier.fit-423"><span class="linenos">423</span></a>                <span class="p">{</span>
</span><span id="LazyDeepClassifier.fit-424"><a href="#LazyDeepClassifier.fit-424"><span class="linenos">424</span></a>                    <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-425"><a href="#LazyDeepClassifier.fit-425"><span class="linenos">425</span></a>                    <span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-426"><a href="#LazyDeepClassifier.fit-426"><span class="linenos">426</span></a>                    <span class="s2">&quot;Balanced Accuracy&quot;</span><span class="p">:</span> <span class="n">B_Accuracy</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-427"><a href="#LazyDeepClassifier.fit-427"><span class="linenos">427</span></a>                    <span class="s2">&quot;ROC AUC&quot;</span><span class="p">:</span> <span class="n">ROC_AUC</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-428"><a href="#LazyDeepClassifier.fit-428"><span class="linenos">428</span></a>                    <span class="s2">&quot;F1 Score&quot;</span><span class="p">:</span> <span class="n">F1</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-429"><a href="#LazyDeepClassifier.fit-429"><span class="linenos">429</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="n">CUSTOM_METRIC</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-430"><a href="#LazyDeepClassifier.fit-430"><span class="linenos">430</span></a>                    <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepClassifier.fit-431"><a href="#LazyDeepClassifier.fit-431"><span class="linenos">431</span></a>                <span class="p">}</span>
</span><span id="LazyDeepClassifier.fit-432"><a href="#LazyDeepClassifier.fit-432"><span class="linenos">432</span></a>            <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-433"><a href="#LazyDeepClassifier.fit-433"><span class="linenos">433</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_by</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyDeepClassifier.fit-434"><a href="#LazyDeepClassifier.fit-434"><span class="linenos">434</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyDeepClassifier.fit-435"><a href="#LazyDeepClassifier.fit-435"><span class="linenos">435</span></a>        <span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-436"><a href="#LazyDeepClassifier.fit-436"><span class="linenos">436</span></a>
</span><span id="LazyDeepClassifier.fit-437"><a href="#LazyDeepClassifier.fit-437"><span class="linenos">437</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.fit-438"><a href="#LazyDeepClassifier.fit-438"><span class="linenos">438</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.fit-439"><a href="#LazyDeepClassifier.fit-439"><span class="linenos">439</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span></pre></div>


            <div class="docstring"><p>Fit classifiers to X_train and y_train, predict and score on X_test,
y_test.</p>

<p>Parameters:</p>

<pre><code>X_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.

y_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

y_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.
</code></pre>

<p>Returns:</p>

<pre><code>scores: Pandas DataFrame
    Returns metrics of all the models in a Pandas DataFrame.

predictions: Pandas DataFrame
    Returns predictions of all the models in a Pandas DataFrame.
</code></pre>
</div>


                                </div>
                                <div id="LazyDeepClassifier.provide_models" class="classattr">
                                            <input id="LazyDeepClassifier.provide_models-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">provide_models</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">y_train</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyDeepClassifier.provide_models-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepClassifier.provide_models"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepClassifier.provide_models-441"><a href="#LazyDeepClassifier.provide_models-441"><span class="linenos">441</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyDeepClassifier.provide_models-442"><a href="#LazyDeepClassifier.provide_models-442"><span class="linenos">442</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all the model objects trained. If fit hasn&#39;t been called yet,</span>
</span><span id="LazyDeepClassifier.provide_models-443"><a href="#LazyDeepClassifier.provide_models-443"><span class="linenos">443</span></a><span class="sd">        then it&#39;s called to return the models.</span>
</span><span id="LazyDeepClassifier.provide_models-444"><a href="#LazyDeepClassifier.provide_models-444"><span class="linenos">444</span></a>
</span><span id="LazyDeepClassifier.provide_models-445"><a href="#LazyDeepClassifier.provide_models-445"><span class="linenos">445</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepClassifier.provide_models-446"><a href="#LazyDeepClassifier.provide_models-446"><span class="linenos">446</span></a>
</span><span id="LazyDeepClassifier.provide_models-447"><a href="#LazyDeepClassifier.provide_models-447"><span class="linenos">447</span></a><span class="sd">        X_train: array-like,</span>
</span><span id="LazyDeepClassifier.provide_models-448"><a href="#LazyDeepClassifier.provide_models-448"><span class="linenos">448</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier.provide_models-449"><a href="#LazyDeepClassifier.provide_models-449"><span class="linenos">449</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyDeepClassifier.provide_models-450"><a href="#LazyDeepClassifier.provide_models-450"><span class="linenos">450</span></a>
</span><span id="LazyDeepClassifier.provide_models-451"><a href="#LazyDeepClassifier.provide_models-451"><span class="linenos">451</span></a><span class="sd">        X_test: array-like,</span>
</span><span id="LazyDeepClassifier.provide_models-452"><a href="#LazyDeepClassifier.provide_models-452"><span class="linenos">452</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier.provide_models-453"><a href="#LazyDeepClassifier.provide_models-453"><span class="linenos">453</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyDeepClassifier.provide_models-454"><a href="#LazyDeepClassifier.provide_models-454"><span class="linenos">454</span></a>
</span><span id="LazyDeepClassifier.provide_models-455"><a href="#LazyDeepClassifier.provide_models-455"><span class="linenos">455</span></a><span class="sd">        y_train: array-like,</span>
</span><span id="LazyDeepClassifier.provide_models-456"><a href="#LazyDeepClassifier.provide_models-456"><span class="linenos">456</span></a><span class="sd">            Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier.provide_models-457"><a href="#LazyDeepClassifier.provide_models-457"><span class="linenos">457</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyDeepClassifier.provide_models-458"><a href="#LazyDeepClassifier.provide_models-458"><span class="linenos">458</span></a>
</span><span id="LazyDeepClassifier.provide_models-459"><a href="#LazyDeepClassifier.provide_models-459"><span class="linenos">459</span></a><span class="sd">        y_test: array-like,</span>
</span><span id="LazyDeepClassifier.provide_models-460"><a href="#LazyDeepClassifier.provide_models-460"><span class="linenos">460</span></a><span class="sd">            Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepClassifier.provide_models-461"><a href="#LazyDeepClassifier.provide_models-461"><span class="linenos">461</span></a><span class="sd">            and columns is the number of features.</span>
</span><span id="LazyDeepClassifier.provide_models-462"><a href="#LazyDeepClassifier.provide_models-462"><span class="linenos">462</span></a>
</span><span id="LazyDeepClassifier.provide_models-463"><a href="#LazyDeepClassifier.provide_models-463"><span class="linenos">463</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepClassifier.provide_models-464"><a href="#LazyDeepClassifier.provide_models-464"><span class="linenos">464</span></a>
</span><span id="LazyDeepClassifier.provide_models-465"><a href="#LazyDeepClassifier.provide_models-465"><span class="linenos">465</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyDeepClassifier.provide_models-466"><a href="#LazyDeepClassifier.provide_models-466"><span class="linenos">466</span></a><span class="sd">                Returns a dictionary with each model&#39;s pipeline as value</span>
</span><span id="LazyDeepClassifier.provide_models-467"><a href="#LazyDeepClassifier.provide_models-467"><span class="linenos">467</span></a><span class="sd">                and key = name of the model.</span>
</span><span id="LazyDeepClassifier.provide_models-468"><a href="#LazyDeepClassifier.provide_models-468"><span class="linenos">468</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepClassifier.provide_models-469"><a href="#LazyDeepClassifier.provide_models-469"><span class="linenos">469</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepClassifier.provide_models-470"><a href="#LazyDeepClassifier.provide_models-470"><span class="linenos">470</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span><span id="LazyDeepClassifier.provide_models-471"><a href="#LazyDeepClassifier.provide_models-471"><span class="linenos">471</span></a>
</span><span id="LazyDeepClassifier.provide_models-472"><a href="#LazyDeepClassifier.provide_models-472"><span class="linenos">472</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>Returns all the model objects trained. If fit hasn't been called yet,
then it's called to return the models.</p>

<p>Parameters:</p>

<p>X_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.</p>

<p>X_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.</p>

<p>y_train: array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.</p>

<p>y_test: array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.</p>

<p>Returns:</p>

<pre><code>models: dict-object,
    Returns a dictionary with each model's pipeline as value
    and key = name of the model.
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="LazyDeepRegressor">
                            <input id="LazyDeepRegressor-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LazyDeepRegressor</span><wbr>(<span class="base">nnetsauce.custom.custom.Custom</span>, <span class="base">sklearn.base.RegressorMixin</span>):

                <label class="view-source-button" for="LazyDeepRegressor-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepRegressor"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepRegressor-69"><a href="#LazyDeepRegressor-69"><span class="linenos"> 69</span></a><span class="k">class</span> <span class="nc">LazyDeepRegressor</span><span class="p">(</span><span class="n">Custom</span><span class="p">,</span> <span class="n">RegressorMixin</span><span class="p">):</span>
</span><span id="LazyDeepRegressor-70"><a href="#LazyDeepRegressor-70"><span class="linenos"> 70</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyDeepRegressor-71"><a href="#LazyDeepRegressor-71"><span class="linenos"> 71</span></a><span class="sd">        Fitting -- almost -- all the regression algorithms with layers of</span>
</span><span id="LazyDeepRegressor-72"><a href="#LazyDeepRegressor-72"><span class="linenos"> 72</span></a><span class="sd">        nnetsauce&#39;s CustomRegressor and returning their scores.</span>
</span><span id="LazyDeepRegressor-73"><a href="#LazyDeepRegressor-73"><span class="linenos"> 73</span></a>
</span><span id="LazyDeepRegressor-74"><a href="#LazyDeepRegressor-74"><span class="linenos"> 74</span></a><span class="sd">    Parameters:</span>
</span><span id="LazyDeepRegressor-75"><a href="#LazyDeepRegressor-75"><span class="linenos"> 75</span></a>
</span><span id="LazyDeepRegressor-76"><a href="#LazyDeepRegressor-76"><span class="linenos"> 76</span></a><span class="sd">        verbose: int, optional (default=0)</span>
</span><span id="LazyDeepRegressor-77"><a href="#LazyDeepRegressor-77"><span class="linenos"> 77</span></a><span class="sd">            Any positive number for verbosity.</span>
</span><span id="LazyDeepRegressor-78"><a href="#LazyDeepRegressor-78"><span class="linenos"> 78</span></a><span class="sd">        ignore_warnings: bool, optional (default=True)</span>
</span><span id="LazyDeepRegressor-79"><a href="#LazyDeepRegressor-79"><span class="linenos"> 79</span></a><span class="sd">            When set to True, the warning related to algorigms that are not able to run are ignored.</span>
</span><span id="LazyDeepRegressor-80"><a href="#LazyDeepRegressor-80"><span class="linenos"> 80</span></a><span class="sd">        custom_metric: function, optional (default=None)</span>
</span><span id="LazyDeepRegressor-81"><a href="#LazyDeepRegressor-81"><span class="linenos"> 81</span></a><span class="sd">            When function is provided, models are evaluated based on the custom evaluation metric provided.</span>
</span><span id="LazyDeepRegressor-82"><a href="#LazyDeepRegressor-82"><span class="linenos"> 82</span></a><span class="sd">        predictions: bool, optional (default=False)</span>
</span><span id="LazyDeepRegressor-83"><a href="#LazyDeepRegressor-83"><span class="linenos"> 83</span></a><span class="sd">            When set to True, the predictions of all the models models are returned as dataframe.</span>
</span><span id="LazyDeepRegressor-84"><a href="#LazyDeepRegressor-84"><span class="linenos"> 84</span></a><span class="sd">        sort_by: string, optional (default=&#39;Accuracy&#39;)</span>
</span><span id="LazyDeepRegressor-85"><a href="#LazyDeepRegressor-85"><span class="linenos"> 85</span></a><span class="sd">            Sort models by a metric. Available options are &#39;Accuracy&#39;, &#39;Balanced Accuracy&#39;, &#39;ROC AUC&#39;, &#39;F1 Score&#39;</span>
</span><span id="LazyDeepRegressor-86"><a href="#LazyDeepRegressor-86"><span class="linenos"> 86</span></a><span class="sd">            or a custom metric identified by its name and provided by custom_metric.</span>
</span><span id="LazyDeepRegressor-87"><a href="#LazyDeepRegressor-87"><span class="linenos"> 87</span></a><span class="sd">        random_state: int, optional (default=42)</span>
</span><span id="LazyDeepRegressor-88"><a href="#LazyDeepRegressor-88"><span class="linenos"> 88</span></a><span class="sd">            Reproducibiility seed.</span>
</span><span id="LazyDeepRegressor-89"><a href="#LazyDeepRegressor-89"><span class="linenos"> 89</span></a><span class="sd">        estimators: list, optional (default=&#39;all&#39;)</span>
</span><span id="LazyDeepRegressor-90"><a href="#LazyDeepRegressor-90"><span class="linenos"> 90</span></a><span class="sd">            list of Estimators names or just &#39;all&#39; (default=&#39;all&#39;)</span>
</span><span id="LazyDeepRegressor-91"><a href="#LazyDeepRegressor-91"><span class="linenos"> 91</span></a><span class="sd">        preprocess: bool, preprocessing is done when set to True</span>
</span><span id="LazyDeepRegressor-92"><a href="#LazyDeepRegressor-92"><span class="linenos"> 92</span></a><span class="sd">        n_jobs : int, when possible, run in parallel</span>
</span><span id="LazyDeepRegressor-93"><a href="#LazyDeepRegressor-93"><span class="linenos"> 93</span></a><span class="sd">            For now, only used by individual models that support it.</span>
</span><span id="LazyDeepRegressor-94"><a href="#LazyDeepRegressor-94"><span class="linenos"> 94</span></a><span class="sd">        n_layers: int, optional (default=3)</span>
</span><span id="LazyDeepRegressor-95"><a href="#LazyDeepRegressor-95"><span class="linenos"> 95</span></a><span class="sd">            Number of layers of CustomRegressors to be used.</span>
</span><span id="LazyDeepRegressor-96"><a href="#LazyDeepRegressor-96"><span class="linenos"> 96</span></a>
</span><span id="LazyDeepRegressor-97"><a href="#LazyDeepRegressor-97"><span class="linenos"> 97</span></a><span class="sd">        All the other parameters are the same as CustomRegressor&#39;s.</span>
</span><span id="LazyDeepRegressor-98"><a href="#LazyDeepRegressor-98"><span class="linenos"> 98</span></a>
</span><span id="LazyDeepRegressor-99"><a href="#LazyDeepRegressor-99"><span class="linenos"> 99</span></a>
</span><span id="LazyDeepRegressor-100"><a href="#LazyDeepRegressor-100"><span class="linenos">100</span></a><span class="sd">    Examples:</span>
</span><span id="LazyDeepRegressor-101"><a href="#LazyDeepRegressor-101"><span class="linenos">101</span></a>
</span><span id="LazyDeepRegressor-102"><a href="#LazyDeepRegressor-102"><span class="linenos">102</span></a><span class="sd">        import nnetsauce as ns</span>
</span><span id="LazyDeepRegressor-103"><a href="#LazyDeepRegressor-103"><span class="linenos">103</span></a><span class="sd">        import numpy as np</span>
</span><span id="LazyDeepRegressor-104"><a href="#LazyDeepRegressor-104"><span class="linenos">104</span></a><span class="sd">        from sklearn import datasets</span>
</span><span id="LazyDeepRegressor-105"><a href="#LazyDeepRegressor-105"><span class="linenos">105</span></a><span class="sd">        from sklearn.utils import shuffle</span>
</span><span id="LazyDeepRegressor-106"><a href="#LazyDeepRegressor-106"><span class="linenos">106</span></a>
</span><span id="LazyDeepRegressor-107"><a href="#LazyDeepRegressor-107"><span class="linenos">107</span></a><span class="sd">        diabetes = datasets.load_diabetes()</span>
</span><span id="LazyDeepRegressor-108"><a href="#LazyDeepRegressor-108"><span class="linenos">108</span></a><span class="sd">        X, y = shuffle(diabetes.data, diabetes.target, random_state=13)</span>
</span><span id="LazyDeepRegressor-109"><a href="#LazyDeepRegressor-109"><span class="linenos">109</span></a><span class="sd">        X = X.astype(np.float32)</span>
</span><span id="LazyDeepRegressor-110"><a href="#LazyDeepRegressor-110"><span class="linenos">110</span></a>
</span><span id="LazyDeepRegressor-111"><a href="#LazyDeepRegressor-111"><span class="linenos">111</span></a><span class="sd">        offset = int(X.shape[0] * 0.9)</span>
</span><span id="LazyDeepRegressor-112"><a href="#LazyDeepRegressor-112"><span class="linenos">112</span></a><span class="sd">        X_train, y_train = X[:offset], y[:offset]</span>
</span><span id="LazyDeepRegressor-113"><a href="#LazyDeepRegressor-113"><span class="linenos">113</span></a><span class="sd">        X_test, y_test = X[offset:], y[offset:]</span>
</span><span id="LazyDeepRegressor-114"><a href="#LazyDeepRegressor-114"><span class="linenos">114</span></a>
</span><span id="LazyDeepRegressor-115"><a href="#LazyDeepRegressor-115"><span class="linenos">115</span></a><span class="sd">        reg = ns.LazyDeepRegressor(verbose=0, ignore_warnings=False, custom_metric=None)</span>
</span><span id="LazyDeepRegressor-116"><a href="#LazyDeepRegressor-116"><span class="linenos">116</span></a><span class="sd">        models, predictions = reg.fit(X_train, X_test, y_train, y_test)</span>
</span><span id="LazyDeepRegressor-117"><a href="#LazyDeepRegressor-117"><span class="linenos">117</span></a><span class="sd">        print(models)</span>
</span><span id="LazyDeepRegressor-118"><a href="#LazyDeepRegressor-118"><span class="linenos">118</span></a>
</span><span id="LazyDeepRegressor-119"><a href="#LazyDeepRegressor-119"><span class="linenos">119</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LazyDeepRegressor-120"><a href="#LazyDeepRegressor-120"><span class="linenos">120</span></a>
</span><span id="LazyDeepRegressor-121"><a href="#LazyDeepRegressor-121"><span class="linenos">121</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-122"><a href="#LazyDeepRegressor-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-123"><a href="#LazyDeepRegressor-123"><span class="linenos">123</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-124"><a href="#LazyDeepRegressor-124"><span class="linenos">124</span></a>        <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-125"><a href="#LazyDeepRegressor-125"><span class="linenos">125</span></a>        <span class="n">custom_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-126"><a href="#LazyDeepRegressor-126"><span class="linenos">126</span></a>        <span class="n">predictions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-127"><a href="#LazyDeepRegressor-127"><span class="linenos">127</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-128"><a href="#LazyDeepRegressor-128"><span class="linenos">128</span></a>        <span class="n">estimators</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-129"><a href="#LazyDeepRegressor-129"><span class="linenos">129</span></a>        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-130"><a href="#LazyDeepRegressor-130"><span class="linenos">130</span></a>        <span class="c1"># Defining depth</span>
</span><span id="LazyDeepRegressor-131"><a href="#LazyDeepRegressor-131"><span class="linenos">131</span></a>        <span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-132"><a href="#LazyDeepRegressor-132"><span class="linenos">132</span></a>        <span class="c1"># CustomRegressor attributes</span>
</span><span id="LazyDeepRegressor-133"><a href="#LazyDeepRegressor-133"><span class="linenos">133</span></a>        <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-134"><a href="#LazyDeepRegressor-134"><span class="linenos">134</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-135"><a href="#LazyDeepRegressor-135"><span class="linenos">135</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-136"><a href="#LazyDeepRegressor-136"><span class="linenos">136</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-137"><a href="#LazyDeepRegressor-137"><span class="linenos">137</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-138"><a href="#LazyDeepRegressor-138"><span class="linenos">138</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-139"><a href="#LazyDeepRegressor-139"><span class="linenos">139</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-140"><a href="#LazyDeepRegressor-140"><span class="linenos">140</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-141"><a href="#LazyDeepRegressor-141"><span class="linenos">141</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-142"><a href="#LazyDeepRegressor-142"><span class="linenos">142</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-143"><a href="#LazyDeepRegressor-143"><span class="linenos">143</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-144"><a href="#LazyDeepRegressor-144"><span class="linenos">144</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="LazyDeepRegressor-145"><a href="#LazyDeepRegressor-145"><span class="linenos">145</span></a>        <span class="n">col_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-146"><a href="#LazyDeepRegressor-146"><span class="linenos">146</span></a>        <span class="n">row_sample</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-147"><a href="#LazyDeepRegressor-147"><span class="linenos">147</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-148"><a href="#LazyDeepRegressor-148"><span class="linenos">148</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-149"><a href="#LazyDeepRegressor-149"><span class="linenos">149</span></a>    <span class="p">):</span>
</span><span id="LazyDeepRegressor-150"><a href="#LazyDeepRegressor-150"><span class="linenos">150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="LazyDeepRegressor-151"><a href="#LazyDeepRegressor-151"><span class="linenos">151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="o">=</span> <span class="n">ignore_warnings</span>
</span><span id="LazyDeepRegressor-152"><a href="#LazyDeepRegressor-152"><span class="linenos">152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="o">=</span> <span class="n">custom_metric</span>
</span><span id="LazyDeepRegressor-153"><a href="#LazyDeepRegressor-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span>
</span><span id="LazyDeepRegressor-154"><a href="#LazyDeepRegressor-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepRegressor-155"><a href="#LazyDeepRegressor-155"><span class="linenos">155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="LazyDeepRegressor-156"><a href="#LazyDeepRegressor-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">=</span> <span class="n">estimators</span>
</span><span id="LazyDeepRegressor-157"><a href="#LazyDeepRegressor-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">=</span> <span class="n">n_layers</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="LazyDeepRegressor-158"><a href="#LazyDeepRegressor-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
</span><span id="LazyDeepRegressor-159"><a href="#LazyDeepRegressor-159"><span class="linenos">159</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-160"><a href="#LazyDeepRegressor-160"><span class="linenos">160</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-161"><a href="#LazyDeepRegressor-161"><span class="linenos">161</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-162"><a href="#LazyDeepRegressor-162"><span class="linenos">162</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-163"><a href="#LazyDeepRegressor-163"><span class="linenos">163</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-164"><a href="#LazyDeepRegressor-164"><span class="linenos">164</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-165"><a href="#LazyDeepRegressor-165"><span class="linenos">165</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-166"><a href="#LazyDeepRegressor-166"><span class="linenos">166</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-167"><a href="#LazyDeepRegressor-167"><span class="linenos">167</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-168"><a href="#LazyDeepRegressor-168"><span class="linenos">168</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-169"><a href="#LazyDeepRegressor-169"><span class="linenos">169</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-170"><a href="#LazyDeepRegressor-170"><span class="linenos">170</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-171"><a href="#LazyDeepRegressor-171"><span class="linenos">171</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-172"><a href="#LazyDeepRegressor-172"><span class="linenos">172</span></a>            <span class="n">col_sample</span><span class="o">=</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-173"><a href="#LazyDeepRegressor-173"><span class="linenos">173</span></a>            <span class="n">row_sample</span><span class="o">=</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-174"><a href="#LazyDeepRegressor-174"><span class="linenos">174</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-175"><a href="#LazyDeepRegressor-175"><span class="linenos">175</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-176"><a href="#LazyDeepRegressor-176"><span class="linenos">176</span></a>        <span class="p">)</span>
</span><span id="LazyDeepRegressor-177"><a href="#LazyDeepRegressor-177"><span class="linenos">177</span></a>
</span><span id="LazyDeepRegressor-178"><a href="#LazyDeepRegressor-178"><span class="linenos">178</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyDeepRegressor-179"><a href="#LazyDeepRegressor-179"><span class="linenos">179</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X_train and y_train, predict and score on X_test, y_test.</span>
</span><span id="LazyDeepRegressor-180"><a href="#LazyDeepRegressor-180"><span class="linenos">180</span></a>
</span><span id="LazyDeepRegressor-181"><a href="#LazyDeepRegressor-181"><span class="linenos">181</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepRegressor-182"><a href="#LazyDeepRegressor-182"><span class="linenos">182</span></a>
</span><span id="LazyDeepRegressor-183"><a href="#LazyDeepRegressor-183"><span class="linenos">183</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyDeepRegressor-184"><a href="#LazyDeepRegressor-184"><span class="linenos">184</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor-185"><a href="#LazyDeepRegressor-185"><span class="linenos">185</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor-186"><a href="#LazyDeepRegressor-186"><span class="linenos">186</span></a>
</span><span id="LazyDeepRegressor-187"><a href="#LazyDeepRegressor-187"><span class="linenos">187</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyDeepRegressor-188"><a href="#LazyDeepRegressor-188"><span class="linenos">188</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor-189"><a href="#LazyDeepRegressor-189"><span class="linenos">189</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor-190"><a href="#LazyDeepRegressor-190"><span class="linenos">190</span></a>
</span><span id="LazyDeepRegressor-191"><a href="#LazyDeepRegressor-191"><span class="linenos">191</span></a><span class="sd">            y_train : array-like,</span>
</span><span id="LazyDeepRegressor-192"><a href="#LazyDeepRegressor-192"><span class="linenos">192</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor-193"><a href="#LazyDeepRegressor-193"><span class="linenos">193</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor-194"><a href="#LazyDeepRegressor-194"><span class="linenos">194</span></a>
</span><span id="LazyDeepRegressor-195"><a href="#LazyDeepRegressor-195"><span class="linenos">195</span></a><span class="sd">            y_test : array-like,</span>
</span><span id="LazyDeepRegressor-196"><a href="#LazyDeepRegressor-196"><span class="linenos">196</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor-197"><a href="#LazyDeepRegressor-197"><span class="linenos">197</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor-198"><a href="#LazyDeepRegressor-198"><span class="linenos">198</span></a>
</span><span id="LazyDeepRegressor-199"><a href="#LazyDeepRegressor-199"><span class="linenos">199</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepRegressor-200"><a href="#LazyDeepRegressor-200"><span class="linenos">200</span></a><span class="sd">        -------</span>
</span><span id="LazyDeepRegressor-201"><a href="#LazyDeepRegressor-201"><span class="linenos">201</span></a><span class="sd">        scores:  Pandas DataFrame</span>
</span><span id="LazyDeepRegressor-202"><a href="#LazyDeepRegressor-202"><span class="linenos">202</span></a><span class="sd">            Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepRegressor-203"><a href="#LazyDeepRegressor-203"><span class="linenos">203</span></a>
</span><span id="LazyDeepRegressor-204"><a href="#LazyDeepRegressor-204"><span class="linenos">204</span></a><span class="sd">        predictions : Pandas DataFrame</span>
</span><span id="LazyDeepRegressor-205"><a href="#LazyDeepRegressor-205"><span class="linenos">205</span></a><span class="sd">            Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepRegressor-206"><a href="#LazyDeepRegressor-206"><span class="linenos">206</span></a>
</span><span id="LazyDeepRegressor-207"><a href="#LazyDeepRegressor-207"><span class="linenos">207</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepRegressor-208"><a href="#LazyDeepRegressor-208"><span class="linenos">208</span></a>        <span class="n">R2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor-209"><a href="#LazyDeepRegressor-209"><span class="linenos">209</span></a>        <span class="n">ADJR2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor-210"><a href="#LazyDeepRegressor-210"><span class="linenos">210</span></a>        <span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor-211"><a href="#LazyDeepRegressor-211"><span class="linenos">211</span></a>        <span class="c1"># WIN = []</span>
</span><span id="LazyDeepRegressor-212"><a href="#LazyDeepRegressor-212"><span class="linenos">212</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor-213"><a href="#LazyDeepRegressor-213"><span class="linenos">213</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor-214"><a href="#LazyDeepRegressor-214"><span class="linenos">214</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepRegressor-215"><a href="#LazyDeepRegressor-215"><span class="linenos">215</span></a>
</span><span id="LazyDeepRegressor-216"><a href="#LazyDeepRegressor-216"><span class="linenos">216</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-217"><a href="#LazyDeepRegressor-217"><span class="linenos">217</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor-218"><a href="#LazyDeepRegressor-218"><span class="linenos">218</span></a>
</span><span id="LazyDeepRegressor-219"><a href="#LazyDeepRegressor-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyDeepRegressor-220"><a href="#LazyDeepRegressor-220"><span class="linenos">220</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-221"><a href="#LazyDeepRegressor-221"><span class="linenos">221</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-222"><a href="#LazyDeepRegressor-222"><span class="linenos">222</span></a>
</span><span id="LazyDeepRegressor-223"><a href="#LazyDeepRegressor-223"><span class="linenos">223</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepRegressor-224"><a href="#LazyDeepRegressor-224"><span class="linenos">224</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepRegressor-225"><a href="#LazyDeepRegressor-225"><span class="linenos">225</span></a>
</span><span id="LazyDeepRegressor-226"><a href="#LazyDeepRegressor-226"><span class="linenos">226</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-227"><a href="#LazyDeepRegressor-227"><span class="linenos">227</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyDeepRegressor-228"><a href="#LazyDeepRegressor-228"><span class="linenos">228</span></a>        <span class="p">)</span>
</span><span id="LazyDeepRegressor-229"><a href="#LazyDeepRegressor-229"><span class="linenos">229</span></a>
</span><span id="LazyDeepRegressor-230"><a href="#LazyDeepRegressor-230"><span class="linenos">230</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-231"><a href="#LazyDeepRegressor-231"><span class="linenos">231</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="n">DEEPREGRESSORS</span>
</span><span id="LazyDeepRegressor-232"><a href="#LazyDeepRegressor-232"><span class="linenos">232</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-233"><a href="#LazyDeepRegressor-233"><span class="linenos">233</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyDeepRegressor-234"><a href="#LazyDeepRegressor-234"><span class="linenos">234</span></a>                <span class="p">(</span><span class="s2">&quot;DeepCustomRegressor(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyDeepRegressor-235"><a href="#LazyDeepRegressor-235"><span class="linenos">235</span></a>                <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepRegressor-236"><a href="#LazyDeepRegressor-236"><span class="linenos">236</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepRegressor-237"><a href="#LazyDeepRegressor-237"><span class="linenos">237</span></a>                    <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-238"><a href="#LazyDeepRegressor-238"><span class="linenos">238</span></a>                    <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-239"><a href="#LazyDeepRegressor-239"><span class="linenos">239</span></a>                <span class="p">)</span>
</span><span id="LazyDeepRegressor-240"><a href="#LazyDeepRegressor-240"><span class="linenos">240</span></a>            <span class="p">]</span>
</span><span id="LazyDeepRegressor-241"><a href="#LazyDeepRegressor-241"><span class="linenos">241</span></a>
</span><span id="LazyDeepRegressor-242"><a href="#LazyDeepRegressor-242"><span class="linenos">242</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepRegressor-243"><a href="#LazyDeepRegressor-243"><span class="linenos">243</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepRegressor-244"><a href="#LazyDeepRegressor-244"><span class="linenos">244</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-245"><a href="#LazyDeepRegressor-245"><span class="linenos">245</span></a>                <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepRegressor-246"><a href="#LazyDeepRegressor-246"><span class="linenos">246</span></a>                    <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-247"><a href="#LazyDeepRegressor-247"><span class="linenos">247</span></a>                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">),</span>
</span><span id="LazyDeepRegressor-248"><a href="#LazyDeepRegressor-248"><span class="linenos">248</span></a>                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-249"><a href="#LazyDeepRegressor-249"><span class="linenos">249</span></a>                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-250"><a href="#LazyDeepRegressor-250"><span class="linenos">250</span></a>                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-251"><a href="#LazyDeepRegressor-251"><span class="linenos">251</span></a>                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-252"><a href="#LazyDeepRegressor-252"><span class="linenos">252</span></a>                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-253"><a href="#LazyDeepRegressor-253"><span class="linenos">253</span></a>                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-254"><a href="#LazyDeepRegressor-254"><span class="linenos">254</span></a>                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-255"><a href="#LazyDeepRegressor-255"><span class="linenos">255</span></a>                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-256"><a href="#LazyDeepRegressor-256"><span class="linenos">256</span></a>                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-257"><a href="#LazyDeepRegressor-257"><span class="linenos">257</span></a>                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-258"><a href="#LazyDeepRegressor-258"><span class="linenos">258</span></a>                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-259"><a href="#LazyDeepRegressor-259"><span class="linenos">259</span></a>                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-260"><a href="#LazyDeepRegressor-260"><span class="linenos">260</span></a>                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-261"><a href="#LazyDeepRegressor-261"><span class="linenos">261</span></a>                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-262"><a href="#LazyDeepRegressor-262"><span class="linenos">262</span></a>                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-263"><a href="#LazyDeepRegressor-263"><span class="linenos">263</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepRegressor-264"><a href="#LazyDeepRegressor-264"><span class="linenos">264</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-265"><a href="#LazyDeepRegressor-265"><span class="linenos">265</span></a>                    <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-266"><a href="#LazyDeepRegressor-266"><span class="linenos">266</span></a>                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyDeepRegressor-267"><a href="#LazyDeepRegressor-267"><span class="linenos">267</span></a>                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-268"><a href="#LazyDeepRegressor-268"><span class="linenos">268</span></a>                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-269"><a href="#LazyDeepRegressor-269"><span class="linenos">269</span></a>                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-270"><a href="#LazyDeepRegressor-270"><span class="linenos">270</span></a>                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-271"><a href="#LazyDeepRegressor-271"><span class="linenos">271</span></a>                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-272"><a href="#LazyDeepRegressor-272"><span class="linenos">272</span></a>                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-273"><a href="#LazyDeepRegressor-273"><span class="linenos">273</span></a>                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-274"><a href="#LazyDeepRegressor-274"><span class="linenos">274</span></a>                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-275"><a href="#LazyDeepRegressor-275"><span class="linenos">275</span></a>                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-276"><a href="#LazyDeepRegressor-276"><span class="linenos">276</span></a>                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-277"><a href="#LazyDeepRegressor-277"><span class="linenos">277</span></a>                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-278"><a href="#LazyDeepRegressor-278"><span class="linenos">278</span></a>                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-279"><a href="#LazyDeepRegressor-279"><span class="linenos">279</span></a>                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-280"><a href="#LazyDeepRegressor-280"><span class="linenos">280</span></a>                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-281"><a href="#LazyDeepRegressor-281"><span class="linenos">281</span></a>                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-282"><a href="#LazyDeepRegressor-282"><span class="linenos">282</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepRegressor-283"><a href="#LazyDeepRegressor-283"><span class="linenos">283</span></a>
</span><span id="LazyDeepRegressor-284"><a href="#LazyDeepRegressor-284"><span class="linenos">284</span></a>                <span class="n">layer_regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-285"><a href="#LazyDeepRegressor-285"><span class="linenos">285</span></a>
</span><span id="LazyDeepRegressor-286"><a href="#LazyDeepRegressor-286"><span class="linenos">286</span></a>                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">):</span>
</span><span id="LazyDeepRegressor-287"><a href="#LazyDeepRegressor-287"><span class="linenos">287</span></a>                    <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-288"><a href="#LazyDeepRegressor-288"><span class="linenos">288</span></a>                        <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-289"><a href="#LazyDeepRegressor-289"><span class="linenos">289</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">layer_regr</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-290"><a href="#LazyDeepRegressor-290"><span class="linenos">290</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-291"><a href="#LazyDeepRegressor-291"><span class="linenos">291</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-292"><a href="#LazyDeepRegressor-292"><span class="linenos">292</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-293"><a href="#LazyDeepRegressor-293"><span class="linenos">293</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-294"><a href="#LazyDeepRegressor-294"><span class="linenos">294</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-295"><a href="#LazyDeepRegressor-295"><span class="linenos">295</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-296"><a href="#LazyDeepRegressor-296"><span class="linenos">296</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-297"><a href="#LazyDeepRegressor-297"><span class="linenos">297</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-298"><a href="#LazyDeepRegressor-298"><span class="linenos">298</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-299"><a href="#LazyDeepRegressor-299"><span class="linenos">299</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-300"><a href="#LazyDeepRegressor-300"><span class="linenos">300</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-301"><a href="#LazyDeepRegressor-301"><span class="linenos">301</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-302"><a href="#LazyDeepRegressor-302"><span class="linenos">302</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-303"><a href="#LazyDeepRegressor-303"><span class="linenos">303</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-304"><a href="#LazyDeepRegressor-304"><span class="linenos">304</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-305"><a href="#LazyDeepRegressor-305"><span class="linenos">305</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepRegressor-306"><a href="#LazyDeepRegressor-306"><span class="linenos">306</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepRegressor-307"><a href="#LazyDeepRegressor-307"><span class="linenos">307</span></a>
</span><span id="LazyDeepRegressor-308"><a href="#LazyDeepRegressor-308"><span class="linenos">308</span></a>                    <span class="c1"># layer_regr.fit(X_train, y_train)</span>
</span><span id="LazyDeepRegressor-309"><a href="#LazyDeepRegressor-309"><span class="linenos">309</span></a>
</span><span id="LazyDeepRegressor-310"><a href="#LazyDeepRegressor-310"><span class="linenos">310</span></a>                <span class="n">layer_regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-311"><a href="#LazyDeepRegressor-311"><span class="linenos">311</span></a>
</span><span id="LazyDeepRegressor-312"><a href="#LazyDeepRegressor-312"><span class="linenos">312</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_regr</span>
</span><span id="LazyDeepRegressor-313"><a href="#LazyDeepRegressor-313"><span class="linenos">313</span></a>                <span class="n">y_pred</span> <span class="o">=</span> <span class="n">layer_regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-314"><a href="#LazyDeepRegressor-314"><span class="linenos">314</span></a>
</span><span id="LazyDeepRegressor-315"><a href="#LazyDeepRegressor-315"><span class="linenos">315</span></a>                <span class="n">r_squared</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-316"><a href="#LazyDeepRegressor-316"><span class="linenos">316</span></a>                <span class="n">adj_rsquared</span> <span class="o">=</span> <span class="n">adjusted_rsquared</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-317"><a href="#LazyDeepRegressor-317"><span class="linenos">317</span></a>                    <span class="n">r_squared</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LazyDeepRegressor-318"><a href="#LazyDeepRegressor-318"><span class="linenos">318</span></a>                <span class="p">)</span>
</span><span id="LazyDeepRegressor-319"><a href="#LazyDeepRegressor-319"><span class="linenos">319</span></a>                <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-320"><a href="#LazyDeepRegressor-320"><span class="linenos">320</span></a>
</span><span id="LazyDeepRegressor-321"><a href="#LazyDeepRegressor-321"><span class="linenos">321</span></a>                <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-322"><a href="#LazyDeepRegressor-322"><span class="linenos">322</span></a>                <span class="n">R2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_squared</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-323"><a href="#LazyDeepRegressor-323"><span class="linenos">323</span></a>                <span class="n">ADJR2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_rsquared</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-324"><a href="#LazyDeepRegressor-324"><span class="linenos">324</span></a>                <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-325"><a href="#LazyDeepRegressor-325"><span class="linenos">325</span></a>                <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-326"><a href="#LazyDeepRegressor-326"><span class="linenos">326</span></a>
</span><span id="LazyDeepRegressor-327"><a href="#LazyDeepRegressor-327"><span class="linenos">327</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-328"><a href="#LazyDeepRegressor-328"><span class="linenos">328</span></a>                    <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-329"><a href="#LazyDeepRegressor-329"><span class="linenos">329</span></a>                    <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-330"><a href="#LazyDeepRegressor-330"><span class="linenos">330</span></a>
</span><span id="LazyDeepRegressor-331"><a href="#LazyDeepRegressor-331"><span class="linenos">331</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-332"><a href="#LazyDeepRegressor-332"><span class="linenos">332</span></a>                    <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepRegressor-333"><a href="#LazyDeepRegressor-333"><span class="linenos">333</span></a>                        <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-334"><a href="#LazyDeepRegressor-334"><span class="linenos">334</span></a>                        <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">r_squared</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-335"><a href="#LazyDeepRegressor-335"><span class="linenos">335</span></a>                        <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">adj_rsquared</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-336"><a href="#LazyDeepRegressor-336"><span class="linenos">336</span></a>                        <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-337"><a href="#LazyDeepRegressor-337"><span class="linenos">337</span></a>                        <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-338"><a href="#LazyDeepRegressor-338"><span class="linenos">338</span></a>                    <span class="p">}</span>
</span><span id="LazyDeepRegressor-339"><a href="#LazyDeepRegressor-339"><span class="linenos">339</span></a>
</span><span id="LazyDeepRegressor-340"><a href="#LazyDeepRegressor-340"><span class="linenos">340</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-341"><a href="#LazyDeepRegressor-341"><span class="linenos">341</span></a>                        <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepRegressor-342"><a href="#LazyDeepRegressor-342"><span class="linenos">342</span></a>                            <span class="n">custom_metric</span>
</span><span id="LazyDeepRegressor-343"><a href="#LazyDeepRegressor-343"><span class="linenos">343</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepRegressor-344"><a href="#LazyDeepRegressor-344"><span class="linenos">344</span></a>
</span><span id="LazyDeepRegressor-345"><a href="#LazyDeepRegressor-345"><span class="linenos">345</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-346"><a href="#LazyDeepRegressor-346"><span class="linenos">346</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-347"><a href="#LazyDeepRegressor-347"><span class="linenos">347</span></a>                    <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyDeepRegressor-348"><a href="#LazyDeepRegressor-348"><span class="linenos">348</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-349"><a href="#LazyDeepRegressor-349"><span class="linenos">349</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-350"><a href="#LazyDeepRegressor-350"><span class="linenos">350</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-351"><a href="#LazyDeepRegressor-351"><span class="linenos">351</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-352"><a href="#LazyDeepRegressor-352"><span class="linenos">352</span></a>
</span><span id="LazyDeepRegressor-353"><a href="#LazyDeepRegressor-353"><span class="linenos">353</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepRegressor-354"><a href="#LazyDeepRegressor-354"><span class="linenos">354</span></a>            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-355"><a href="#LazyDeepRegressor-355"><span class="linenos">355</span></a>            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">ADJR2</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-356"><a href="#LazyDeepRegressor-356"><span class="linenos">356</span></a>            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">R2</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-357"><a href="#LazyDeepRegressor-357"><span class="linenos">357</span></a>            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-358"><a href="#LazyDeepRegressor-358"><span class="linenos">358</span></a>            <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepRegressor-359"><a href="#LazyDeepRegressor-359"><span class="linenos">359</span></a>        <span class="p">}</span>
</span><span id="LazyDeepRegressor-360"><a href="#LazyDeepRegressor-360"><span class="linenos">360</span></a>
</span><span id="LazyDeepRegressor-361"><a href="#LazyDeepRegressor-361"><span class="linenos">361</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-362"><a href="#LazyDeepRegressor-362"><span class="linenos">362</span></a>            <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">CUSTOM_METRIC</span>
</span><span id="LazyDeepRegressor-363"><a href="#LazyDeepRegressor-363"><span class="linenos">363</span></a>
</span><span id="LazyDeepRegressor-364"><a href="#LazyDeepRegressor-364"><span class="linenos">364</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-365"><a href="#LazyDeepRegressor-365"><span class="linenos">365</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyDeepRegressor-366"><a href="#LazyDeepRegressor-366"><span class="linenos">366</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyDeepRegressor-367"><a href="#LazyDeepRegressor-367"><span class="linenos">367</span></a>        <span class="p">)</span>
</span><span id="LazyDeepRegressor-368"><a href="#LazyDeepRegressor-368"><span class="linenos">368</span></a>
</span><span id="LazyDeepRegressor-369"><a href="#LazyDeepRegressor-369"><span class="linenos">369</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-370"><a href="#LazyDeepRegressor-370"><span class="linenos">370</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-371"><a href="#LazyDeepRegressor-371"><span class="linenos">371</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span><span id="LazyDeepRegressor-372"><a href="#LazyDeepRegressor-372"><span class="linenos">372</span></a>
</span><span id="LazyDeepRegressor-373"><a href="#LazyDeepRegressor-373"><span class="linenos">373</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyDeepRegressor-374"><a href="#LazyDeepRegressor-374"><span class="linenos">374</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyDeepRegressor-375"><a href="#LazyDeepRegressor-375"><span class="linenos">375</span></a><span class="sd">        This function returns all the model objects trained in fit function.</span>
</span><span id="LazyDeepRegressor-376"><a href="#LazyDeepRegressor-376"><span class="linenos">376</span></a><span class="sd">        If fit is not called already, then we call fit and then return the models.</span>
</span><span id="LazyDeepRegressor-377"><a href="#LazyDeepRegressor-377"><span class="linenos">377</span></a>
</span><span id="LazyDeepRegressor-378"><a href="#LazyDeepRegressor-378"><span class="linenos">378</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepRegressor-379"><a href="#LazyDeepRegressor-379"><span class="linenos">379</span></a>
</span><span id="LazyDeepRegressor-380"><a href="#LazyDeepRegressor-380"><span class="linenos">380</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyDeepRegressor-381"><a href="#LazyDeepRegressor-381"><span class="linenos">381</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor-382"><a href="#LazyDeepRegressor-382"><span class="linenos">382</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor-383"><a href="#LazyDeepRegressor-383"><span class="linenos">383</span></a>
</span><span id="LazyDeepRegressor-384"><a href="#LazyDeepRegressor-384"><span class="linenos">384</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyDeepRegressor-385"><a href="#LazyDeepRegressor-385"><span class="linenos">385</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor-386"><a href="#LazyDeepRegressor-386"><span class="linenos">386</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor-387"><a href="#LazyDeepRegressor-387"><span class="linenos">387</span></a>
</span><span id="LazyDeepRegressor-388"><a href="#LazyDeepRegressor-388"><span class="linenos">388</span></a><span class="sd">            y_train : array-like,</span>
</span><span id="LazyDeepRegressor-389"><a href="#LazyDeepRegressor-389"><span class="linenos">389</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor-390"><a href="#LazyDeepRegressor-390"><span class="linenos">390</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor-391"><a href="#LazyDeepRegressor-391"><span class="linenos">391</span></a>
</span><span id="LazyDeepRegressor-392"><a href="#LazyDeepRegressor-392"><span class="linenos">392</span></a><span class="sd">            y_test : array-like,</span>
</span><span id="LazyDeepRegressor-393"><a href="#LazyDeepRegressor-393"><span class="linenos">393</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor-394"><a href="#LazyDeepRegressor-394"><span class="linenos">394</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor-395"><a href="#LazyDeepRegressor-395"><span class="linenos">395</span></a>
</span><span id="LazyDeepRegressor-396"><a href="#LazyDeepRegressor-396"><span class="linenos">396</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepRegressor-397"><a href="#LazyDeepRegressor-397"><span class="linenos">397</span></a>
</span><span id="LazyDeepRegressor-398"><a href="#LazyDeepRegressor-398"><span class="linenos">398</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyDeepRegressor-399"><a href="#LazyDeepRegressor-399"><span class="linenos">399</span></a><span class="sd">                Returns a dictionary with each model pipeline as value</span>
</span><span id="LazyDeepRegressor-400"><a href="#LazyDeepRegressor-400"><span class="linenos">400</span></a><span class="sd">                with key as name of models.</span>
</span><span id="LazyDeepRegressor-401"><a href="#LazyDeepRegressor-401"><span class="linenos">401</span></a>
</span><span id="LazyDeepRegressor-402"><a href="#LazyDeepRegressor-402"><span class="linenos">402</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepRegressor-403"><a href="#LazyDeepRegressor-403"><span class="linenos">403</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepRegressor-404"><a href="#LazyDeepRegressor-404"><span class="linenos">404</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span><span id="LazyDeepRegressor-405"><a href="#LazyDeepRegressor-405"><span class="linenos">405</span></a>
</span><span id="LazyDeepRegressor-406"><a href="#LazyDeepRegressor-406"><span class="linenos">406</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>Fitting -- almost -- all the regression algorithms with layers of
    nnetsauce's CustomRegressor and returning their scores.</p>

<p>Parameters:</p>

<pre><code>verbose: int, optional (default=0)
    Any positive number for verbosity.
ignore_warnings: bool, optional (default=True)
    When set to True, the warning related to algorigms that are not able to run are ignored.
custom_metric: function, optional (default=None)
    When function is provided, models are evaluated based on the custom evaluation metric provided.
predictions: bool, optional (default=False)
    When set to True, the predictions of all the models models are returned as dataframe.
sort_by: string, optional (default='Accuracy')
    Sort models by a metric. Available options are 'Accuracy', 'Balanced Accuracy', 'ROC AUC', 'F1 Score'
    or a custom metric identified by its name and provided by custom_metric.
random_state: int, optional (default=42)
    Reproducibiility seed.
estimators: list, optional (default='all')
    list of Estimators names or just 'all' (default='all')
preprocess: bool, preprocessing is done when set to True
n_jobs : int, when possible, run in parallel
    For now, only used by individual models that support it.
n_layers: int, optional (default=3)
    Number of layers of CustomRegressors to be used.

All the other parameters are the same as CustomRegressor's.
</code></pre>

<p>Examples:</p>

<pre><code>import nnetsauce as ns
import numpy as np
from sklearn import datasets
from sklearn.utils import shuffle

diabetes = datasets.load_diabetes()
X, y = shuffle(diabetes.data, diabetes.target, random_state=13)
X = X.astype(np.float32)

offset = int(X.shape[0] * 0.9)
X_train, y_train = X[:offset], y[:offset]
X_test, y_test = X[offset:], y[offset:]

reg = ns.LazyDeepRegressor(verbose=0, ignore_warnings=False, custom_metric=None)
models, predictions = reg.fit(X_train, X_test, y_train, y_test)
print(models)
</code></pre>
</div>


                                <div id="LazyDeepRegressor.fit" class="classattr">
                                            <input id="LazyDeepRegressor.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">y_train</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyDeepRegressor.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepRegressor.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepRegressor.fit-178"><a href="#LazyDeepRegressor.fit-178"><span class="linenos">178</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyDeepRegressor.fit-179"><a href="#LazyDeepRegressor.fit-179"><span class="linenos">179</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X_train and y_train, predict and score on X_test, y_test.</span>
</span><span id="LazyDeepRegressor.fit-180"><a href="#LazyDeepRegressor.fit-180"><span class="linenos">180</span></a>
</span><span id="LazyDeepRegressor.fit-181"><a href="#LazyDeepRegressor.fit-181"><span class="linenos">181</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepRegressor.fit-182"><a href="#LazyDeepRegressor.fit-182"><span class="linenos">182</span></a>
</span><span id="LazyDeepRegressor.fit-183"><a href="#LazyDeepRegressor.fit-183"><span class="linenos">183</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyDeepRegressor.fit-184"><a href="#LazyDeepRegressor.fit-184"><span class="linenos">184</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor.fit-185"><a href="#LazyDeepRegressor.fit-185"><span class="linenos">185</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor.fit-186"><a href="#LazyDeepRegressor.fit-186"><span class="linenos">186</span></a>
</span><span id="LazyDeepRegressor.fit-187"><a href="#LazyDeepRegressor.fit-187"><span class="linenos">187</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyDeepRegressor.fit-188"><a href="#LazyDeepRegressor.fit-188"><span class="linenos">188</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor.fit-189"><a href="#LazyDeepRegressor.fit-189"><span class="linenos">189</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor.fit-190"><a href="#LazyDeepRegressor.fit-190"><span class="linenos">190</span></a>
</span><span id="LazyDeepRegressor.fit-191"><a href="#LazyDeepRegressor.fit-191"><span class="linenos">191</span></a><span class="sd">            y_train : array-like,</span>
</span><span id="LazyDeepRegressor.fit-192"><a href="#LazyDeepRegressor.fit-192"><span class="linenos">192</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor.fit-193"><a href="#LazyDeepRegressor.fit-193"><span class="linenos">193</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor.fit-194"><a href="#LazyDeepRegressor.fit-194"><span class="linenos">194</span></a>
</span><span id="LazyDeepRegressor.fit-195"><a href="#LazyDeepRegressor.fit-195"><span class="linenos">195</span></a><span class="sd">            y_test : array-like,</span>
</span><span id="LazyDeepRegressor.fit-196"><a href="#LazyDeepRegressor.fit-196"><span class="linenos">196</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor.fit-197"><a href="#LazyDeepRegressor.fit-197"><span class="linenos">197</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor.fit-198"><a href="#LazyDeepRegressor.fit-198"><span class="linenos">198</span></a>
</span><span id="LazyDeepRegressor.fit-199"><a href="#LazyDeepRegressor.fit-199"><span class="linenos">199</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepRegressor.fit-200"><a href="#LazyDeepRegressor.fit-200"><span class="linenos">200</span></a><span class="sd">        -------</span>
</span><span id="LazyDeepRegressor.fit-201"><a href="#LazyDeepRegressor.fit-201"><span class="linenos">201</span></a><span class="sd">        scores:  Pandas DataFrame</span>
</span><span id="LazyDeepRegressor.fit-202"><a href="#LazyDeepRegressor.fit-202"><span class="linenos">202</span></a><span class="sd">            Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepRegressor.fit-203"><a href="#LazyDeepRegressor.fit-203"><span class="linenos">203</span></a>
</span><span id="LazyDeepRegressor.fit-204"><a href="#LazyDeepRegressor.fit-204"><span class="linenos">204</span></a><span class="sd">        predictions : Pandas DataFrame</span>
</span><span id="LazyDeepRegressor.fit-205"><a href="#LazyDeepRegressor.fit-205"><span class="linenos">205</span></a><span class="sd">            Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepRegressor.fit-206"><a href="#LazyDeepRegressor.fit-206"><span class="linenos">206</span></a>
</span><span id="LazyDeepRegressor.fit-207"><a href="#LazyDeepRegressor.fit-207"><span class="linenos">207</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepRegressor.fit-208"><a href="#LazyDeepRegressor.fit-208"><span class="linenos">208</span></a>        <span class="n">R2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor.fit-209"><a href="#LazyDeepRegressor.fit-209"><span class="linenos">209</span></a>        <span class="n">ADJR2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor.fit-210"><a href="#LazyDeepRegressor.fit-210"><span class="linenos">210</span></a>        <span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor.fit-211"><a href="#LazyDeepRegressor.fit-211"><span class="linenos">211</span></a>        <span class="c1"># WIN = []</span>
</span><span id="LazyDeepRegressor.fit-212"><a href="#LazyDeepRegressor.fit-212"><span class="linenos">212</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor.fit-213"><a href="#LazyDeepRegressor.fit-213"><span class="linenos">213</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor.fit-214"><a href="#LazyDeepRegressor.fit-214"><span class="linenos">214</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepRegressor.fit-215"><a href="#LazyDeepRegressor.fit-215"><span class="linenos">215</span></a>
</span><span id="LazyDeepRegressor.fit-216"><a href="#LazyDeepRegressor.fit-216"><span class="linenos">216</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-217"><a href="#LazyDeepRegressor.fit-217"><span class="linenos">217</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepRegressor.fit-218"><a href="#LazyDeepRegressor.fit-218"><span class="linenos">218</span></a>
</span><span id="LazyDeepRegressor.fit-219"><a href="#LazyDeepRegressor.fit-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyDeepRegressor.fit-220"><a href="#LazyDeepRegressor.fit-220"><span class="linenos">220</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-221"><a href="#LazyDeepRegressor.fit-221"><span class="linenos">221</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-222"><a href="#LazyDeepRegressor.fit-222"><span class="linenos">222</span></a>
</span><span id="LazyDeepRegressor.fit-223"><a href="#LazyDeepRegressor.fit-223"><span class="linenos">223</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepRegressor.fit-224"><a href="#LazyDeepRegressor.fit-224"><span class="linenos">224</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepRegressor.fit-225"><a href="#LazyDeepRegressor.fit-225"><span class="linenos">225</span></a>
</span><span id="LazyDeepRegressor.fit-226"><a href="#LazyDeepRegressor.fit-226"><span class="linenos">226</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-227"><a href="#LazyDeepRegressor.fit-227"><span class="linenos">227</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyDeepRegressor.fit-228"><a href="#LazyDeepRegressor.fit-228"><span class="linenos">228</span></a>        <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-229"><a href="#LazyDeepRegressor.fit-229"><span class="linenos">229</span></a>
</span><span id="LazyDeepRegressor.fit-230"><a href="#LazyDeepRegressor.fit-230"><span class="linenos">230</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-231"><a href="#LazyDeepRegressor.fit-231"><span class="linenos">231</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="n">DEEPREGRESSORS</span>
</span><span id="LazyDeepRegressor.fit-232"><a href="#LazyDeepRegressor.fit-232"><span class="linenos">232</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-233"><a href="#LazyDeepRegressor.fit-233"><span class="linenos">233</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyDeepRegressor.fit-234"><a href="#LazyDeepRegressor.fit-234"><span class="linenos">234</span></a>                <span class="p">(</span><span class="s2">&quot;DeepCustomRegressor(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyDeepRegressor.fit-235"><a href="#LazyDeepRegressor.fit-235"><span class="linenos">235</span></a>                <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepRegressor.fit-236"><a href="#LazyDeepRegressor.fit-236"><span class="linenos">236</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-237"><a href="#LazyDeepRegressor.fit-237"><span class="linenos">237</span></a>                    <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-238"><a href="#LazyDeepRegressor.fit-238"><span class="linenos">238</span></a>                    <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-239"><a href="#LazyDeepRegressor.fit-239"><span class="linenos">239</span></a>                <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-240"><a href="#LazyDeepRegressor.fit-240"><span class="linenos">240</span></a>            <span class="p">]</span>
</span><span id="LazyDeepRegressor.fit-241"><a href="#LazyDeepRegressor.fit-241"><span class="linenos">241</span></a>
</span><span id="LazyDeepRegressor.fit-242"><a href="#LazyDeepRegressor.fit-242"><span class="linenos">242</span></a>        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepRegressor.fit-243"><a href="#LazyDeepRegressor.fit-243"><span class="linenos">243</span></a>            <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepRegressor.fit-244"><a href="#LazyDeepRegressor.fit-244"><span class="linenos">244</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-245"><a href="#LazyDeepRegressor.fit-245"><span class="linenos">245</span></a>                <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepRegressor.fit-246"><a href="#LazyDeepRegressor.fit-246"><span class="linenos">246</span></a>                    <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-247"><a href="#LazyDeepRegressor.fit-247"><span class="linenos">247</span></a>                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">),</span>
</span><span id="LazyDeepRegressor.fit-248"><a href="#LazyDeepRegressor.fit-248"><span class="linenos">248</span></a>                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-249"><a href="#LazyDeepRegressor.fit-249"><span class="linenos">249</span></a>                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-250"><a href="#LazyDeepRegressor.fit-250"><span class="linenos">250</span></a>                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-251"><a href="#LazyDeepRegressor.fit-251"><span class="linenos">251</span></a>                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-252"><a href="#LazyDeepRegressor.fit-252"><span class="linenos">252</span></a>                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-253"><a href="#LazyDeepRegressor.fit-253"><span class="linenos">253</span></a>                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-254"><a href="#LazyDeepRegressor.fit-254"><span class="linenos">254</span></a>                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-255"><a href="#LazyDeepRegressor.fit-255"><span class="linenos">255</span></a>                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-256"><a href="#LazyDeepRegressor.fit-256"><span class="linenos">256</span></a>                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-257"><a href="#LazyDeepRegressor.fit-257"><span class="linenos">257</span></a>                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-258"><a href="#LazyDeepRegressor.fit-258"><span class="linenos">258</span></a>                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-259"><a href="#LazyDeepRegressor.fit-259"><span class="linenos">259</span></a>                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-260"><a href="#LazyDeepRegressor.fit-260"><span class="linenos">260</span></a>                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-261"><a href="#LazyDeepRegressor.fit-261"><span class="linenos">261</span></a>                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-262"><a href="#LazyDeepRegressor.fit-262"><span class="linenos">262</span></a>                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-263"><a href="#LazyDeepRegressor.fit-263"><span class="linenos">263</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-264"><a href="#LazyDeepRegressor.fit-264"><span class="linenos">264</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-265"><a href="#LazyDeepRegressor.fit-265"><span class="linenos">265</span></a>                    <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-266"><a href="#LazyDeepRegressor.fit-266"><span class="linenos">266</span></a>                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(),</span>
</span><span id="LazyDeepRegressor.fit-267"><a href="#LazyDeepRegressor.fit-267"><span class="linenos">267</span></a>                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-268"><a href="#LazyDeepRegressor.fit-268"><span class="linenos">268</span></a>                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-269"><a href="#LazyDeepRegressor.fit-269"><span class="linenos">269</span></a>                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-270"><a href="#LazyDeepRegressor.fit-270"><span class="linenos">270</span></a>                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-271"><a href="#LazyDeepRegressor.fit-271"><span class="linenos">271</span></a>                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-272"><a href="#LazyDeepRegressor.fit-272"><span class="linenos">272</span></a>                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-273"><a href="#LazyDeepRegressor.fit-273"><span class="linenos">273</span></a>                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-274"><a href="#LazyDeepRegressor.fit-274"><span class="linenos">274</span></a>                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-275"><a href="#LazyDeepRegressor.fit-275"><span class="linenos">275</span></a>                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-276"><a href="#LazyDeepRegressor.fit-276"><span class="linenos">276</span></a>                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-277"><a href="#LazyDeepRegressor.fit-277"><span class="linenos">277</span></a>                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-278"><a href="#LazyDeepRegressor.fit-278"><span class="linenos">278</span></a>                        <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-279"><a href="#LazyDeepRegressor.fit-279"><span class="linenos">279</span></a>                        <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-280"><a href="#LazyDeepRegressor.fit-280"><span class="linenos">280</span></a>                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-281"><a href="#LazyDeepRegressor.fit-281"><span class="linenos">281</span></a>                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-282"><a href="#LazyDeepRegressor.fit-282"><span class="linenos">282</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-283"><a href="#LazyDeepRegressor.fit-283"><span class="linenos">283</span></a>
</span><span id="LazyDeepRegressor.fit-284"><a href="#LazyDeepRegressor.fit-284"><span class="linenos">284</span></a>                <span class="n">layer_regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-285"><a href="#LazyDeepRegressor.fit-285"><span class="linenos">285</span></a>
</span><span id="LazyDeepRegressor.fit-286"><a href="#LazyDeepRegressor.fit-286"><span class="linenos">286</span></a>                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">):</span>
</span><span id="LazyDeepRegressor.fit-287"><a href="#LazyDeepRegressor.fit-287"><span class="linenos">287</span></a>                    <span class="n">layer_regr</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-288"><a href="#LazyDeepRegressor.fit-288"><span class="linenos">288</span></a>                        <span class="n">CustomRegressor</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-289"><a href="#LazyDeepRegressor.fit-289"><span class="linenos">289</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">layer_regr</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-290"><a href="#LazyDeepRegressor.fit-290"><span class="linenos">290</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-291"><a href="#LazyDeepRegressor.fit-291"><span class="linenos">291</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-292"><a href="#LazyDeepRegressor.fit-292"><span class="linenos">292</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-293"><a href="#LazyDeepRegressor.fit-293"><span class="linenos">293</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-294"><a href="#LazyDeepRegressor.fit-294"><span class="linenos">294</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-295"><a href="#LazyDeepRegressor.fit-295"><span class="linenos">295</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-296"><a href="#LazyDeepRegressor.fit-296"><span class="linenos">296</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-297"><a href="#LazyDeepRegressor.fit-297"><span class="linenos">297</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-298"><a href="#LazyDeepRegressor.fit-298"><span class="linenos">298</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-299"><a href="#LazyDeepRegressor.fit-299"><span class="linenos">299</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-300"><a href="#LazyDeepRegressor.fit-300"><span class="linenos">300</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-301"><a href="#LazyDeepRegressor.fit-301"><span class="linenos">301</span></a>                            <span class="n">col_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">col_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-302"><a href="#LazyDeepRegressor.fit-302"><span class="linenos">302</span></a>                            <span class="n">row_sample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">row_sample</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-303"><a href="#LazyDeepRegressor.fit-303"><span class="linenos">303</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-304"><a href="#LazyDeepRegressor.fit-304"><span class="linenos">304</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-305"><a href="#LazyDeepRegressor.fit-305"><span class="linenos">305</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-306"><a href="#LazyDeepRegressor.fit-306"><span class="linenos">306</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-307"><a href="#LazyDeepRegressor.fit-307"><span class="linenos">307</span></a>
</span><span id="LazyDeepRegressor.fit-308"><a href="#LazyDeepRegressor.fit-308"><span class="linenos">308</span></a>                    <span class="c1"># layer_regr.fit(X_train, y_train)</span>
</span><span id="LazyDeepRegressor.fit-309"><a href="#LazyDeepRegressor.fit-309"><span class="linenos">309</span></a>
</span><span id="LazyDeepRegressor.fit-310"><a href="#LazyDeepRegressor.fit-310"><span class="linenos">310</span></a>                <span class="n">layer_regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-311"><a href="#LazyDeepRegressor.fit-311"><span class="linenos">311</span></a>
</span><span id="LazyDeepRegressor.fit-312"><a href="#LazyDeepRegressor.fit-312"><span class="linenos">312</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer_regr</span>
</span><span id="LazyDeepRegressor.fit-313"><a href="#LazyDeepRegressor.fit-313"><span class="linenos">313</span></a>                <span class="n">y_pred</span> <span class="o">=</span> <span class="n">layer_regr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-314"><a href="#LazyDeepRegressor.fit-314"><span class="linenos">314</span></a>
</span><span id="LazyDeepRegressor.fit-315"><a href="#LazyDeepRegressor.fit-315"><span class="linenos">315</span></a>                <span class="n">r_squared</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-316"><a href="#LazyDeepRegressor.fit-316"><span class="linenos">316</span></a>                <span class="n">adj_rsquared</span> <span class="o">=</span> <span class="n">adjusted_rsquared</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-317"><a href="#LazyDeepRegressor.fit-317"><span class="linenos">317</span></a>                    <span class="n">r_squared</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LazyDeepRegressor.fit-318"><a href="#LazyDeepRegressor.fit-318"><span class="linenos">318</span></a>                <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-319"><a href="#LazyDeepRegressor.fit-319"><span class="linenos">319</span></a>                <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-320"><a href="#LazyDeepRegressor.fit-320"><span class="linenos">320</span></a>
</span><span id="LazyDeepRegressor.fit-321"><a href="#LazyDeepRegressor.fit-321"><span class="linenos">321</span></a>                <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-322"><a href="#LazyDeepRegressor.fit-322"><span class="linenos">322</span></a>                <span class="n">R2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r_squared</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-323"><a href="#LazyDeepRegressor.fit-323"><span class="linenos">323</span></a>                <span class="n">ADJR2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adj_rsquared</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-324"><a href="#LazyDeepRegressor.fit-324"><span class="linenos">324</span></a>                <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-325"><a href="#LazyDeepRegressor.fit-325"><span class="linenos">325</span></a>                <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-326"><a href="#LazyDeepRegressor.fit-326"><span class="linenos">326</span></a>
</span><span id="LazyDeepRegressor.fit-327"><a href="#LazyDeepRegressor.fit-327"><span class="linenos">327</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-328"><a href="#LazyDeepRegressor.fit-328"><span class="linenos">328</span></a>                    <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-329"><a href="#LazyDeepRegressor.fit-329"><span class="linenos">329</span></a>                    <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-330"><a href="#LazyDeepRegressor.fit-330"><span class="linenos">330</span></a>
</span><span id="LazyDeepRegressor.fit-331"><a href="#LazyDeepRegressor.fit-331"><span class="linenos">331</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-332"><a href="#LazyDeepRegressor.fit-332"><span class="linenos">332</span></a>                    <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepRegressor.fit-333"><a href="#LazyDeepRegressor.fit-333"><span class="linenos">333</span></a>                        <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-334"><a href="#LazyDeepRegressor.fit-334"><span class="linenos">334</span></a>                        <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">r_squared</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-335"><a href="#LazyDeepRegressor.fit-335"><span class="linenos">335</span></a>                        <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">adj_rsquared</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-336"><a href="#LazyDeepRegressor.fit-336"><span class="linenos">336</span></a>                        <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-337"><a href="#LazyDeepRegressor.fit-337"><span class="linenos">337</span></a>                        <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-338"><a href="#LazyDeepRegressor.fit-338"><span class="linenos">338</span></a>                    <span class="p">}</span>
</span><span id="LazyDeepRegressor.fit-339"><a href="#LazyDeepRegressor.fit-339"><span class="linenos">339</span></a>
</span><span id="LazyDeepRegressor.fit-340"><a href="#LazyDeepRegressor.fit-340"><span class="linenos">340</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-341"><a href="#LazyDeepRegressor.fit-341"><span class="linenos">341</span></a>                        <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-342"><a href="#LazyDeepRegressor.fit-342"><span class="linenos">342</span></a>                            <span class="n">custom_metric</span>
</span><span id="LazyDeepRegressor.fit-343"><a href="#LazyDeepRegressor.fit-343"><span class="linenos">343</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-344"><a href="#LazyDeepRegressor.fit-344"><span class="linenos">344</span></a>
</span><span id="LazyDeepRegressor.fit-345"><a href="#LazyDeepRegressor.fit-345"><span class="linenos">345</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-346"><a href="#LazyDeepRegressor.fit-346"><span class="linenos">346</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-347"><a href="#LazyDeepRegressor.fit-347"><span class="linenos">347</span></a>                    <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</span><span id="LazyDeepRegressor.fit-348"><a href="#LazyDeepRegressor.fit-348"><span class="linenos">348</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-349"><a href="#LazyDeepRegressor.fit-349"><span class="linenos">349</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-350"><a href="#LazyDeepRegressor.fit-350"><span class="linenos">350</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-351"><a href="#LazyDeepRegressor.fit-351"><span class="linenos">351</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-352"><a href="#LazyDeepRegressor.fit-352"><span class="linenos">352</span></a>
</span><span id="LazyDeepRegressor.fit-353"><a href="#LazyDeepRegressor.fit-353"><span class="linenos">353</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepRegressor.fit-354"><a href="#LazyDeepRegressor.fit-354"><span class="linenos">354</span></a>            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-355"><a href="#LazyDeepRegressor.fit-355"><span class="linenos">355</span></a>            <span class="s2">&quot;Adjusted R-Squared&quot;</span><span class="p">:</span> <span class="n">ADJR2</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-356"><a href="#LazyDeepRegressor.fit-356"><span class="linenos">356</span></a>            <span class="s2">&quot;R-Squared&quot;</span><span class="p">:</span> <span class="n">R2</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-357"><a href="#LazyDeepRegressor.fit-357"><span class="linenos">357</span></a>            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-358"><a href="#LazyDeepRegressor.fit-358"><span class="linenos">358</span></a>            <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepRegressor.fit-359"><a href="#LazyDeepRegressor.fit-359"><span class="linenos">359</span></a>        <span class="p">}</span>
</span><span id="LazyDeepRegressor.fit-360"><a href="#LazyDeepRegressor.fit-360"><span class="linenos">360</span></a>
</span><span id="LazyDeepRegressor.fit-361"><a href="#LazyDeepRegressor.fit-361"><span class="linenos">361</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-362"><a href="#LazyDeepRegressor.fit-362"><span class="linenos">362</span></a>            <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">CUSTOM_METRIC</span>
</span><span id="LazyDeepRegressor.fit-363"><a href="#LazyDeepRegressor.fit-363"><span class="linenos">363</span></a>
</span><span id="LazyDeepRegressor.fit-364"><a href="#LazyDeepRegressor.fit-364"><span class="linenos">364</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-365"><a href="#LazyDeepRegressor.fit-365"><span class="linenos">365</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyDeepRegressor.fit-366"><a href="#LazyDeepRegressor.fit-366"><span class="linenos">366</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyDeepRegressor.fit-367"><a href="#LazyDeepRegressor.fit-367"><span class="linenos">367</span></a>        <span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-368"><a href="#LazyDeepRegressor.fit-368"><span class="linenos">368</span></a>
</span><span id="LazyDeepRegressor.fit-369"><a href="#LazyDeepRegressor.fit-369"><span class="linenos">369</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.fit-370"><a href="#LazyDeepRegressor.fit-370"><span class="linenos">370</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.fit-371"><a href="#LazyDeepRegressor.fit-371"><span class="linenos">371</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span></pre></div>


            <div class="docstring"><p>Fit Regression algorithms to X_train and y_train, predict and score on X_test, y_test.</p>

<p>Parameters:</p>

<pre><code>X_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.

y_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

y_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.
</code></pre>

<h2 id="returns">Returns:</h2>

<p>scores:  Pandas DataFrame
    Returns metrics of all the models in a Pandas DataFrame.</p>

<p>predictions : Pandas DataFrame
    Returns predictions of all the models in a Pandas DataFrame.</p>
</div>


                                </div>
                                <div id="LazyDeepRegressor.provide_models" class="classattr">
                                            <input id="LazyDeepRegressor.provide_models-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">provide_models</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">y_train</span>, </span><span class="param"><span class="n">y_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyDeepRegressor.provide_models-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepRegressor.provide_models"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepRegressor.provide_models-373"><a href="#LazyDeepRegressor.provide_models-373"><span class="linenos">373</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span>
</span><span id="LazyDeepRegressor.provide_models-374"><a href="#LazyDeepRegressor.provide_models-374"><span class="linenos">374</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyDeepRegressor.provide_models-375"><a href="#LazyDeepRegressor.provide_models-375"><span class="linenos">375</span></a><span class="sd">        This function returns all the model objects trained in fit function.</span>
</span><span id="LazyDeepRegressor.provide_models-376"><a href="#LazyDeepRegressor.provide_models-376"><span class="linenos">376</span></a><span class="sd">        If fit is not called already, then we call fit and then return the models.</span>
</span><span id="LazyDeepRegressor.provide_models-377"><a href="#LazyDeepRegressor.provide_models-377"><span class="linenos">377</span></a>
</span><span id="LazyDeepRegressor.provide_models-378"><a href="#LazyDeepRegressor.provide_models-378"><span class="linenos">378</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepRegressor.provide_models-379"><a href="#LazyDeepRegressor.provide_models-379"><span class="linenos">379</span></a>
</span><span id="LazyDeepRegressor.provide_models-380"><a href="#LazyDeepRegressor.provide_models-380"><span class="linenos">380</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyDeepRegressor.provide_models-381"><a href="#LazyDeepRegressor.provide_models-381"><span class="linenos">381</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor.provide_models-382"><a href="#LazyDeepRegressor.provide_models-382"><span class="linenos">382</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor.provide_models-383"><a href="#LazyDeepRegressor.provide_models-383"><span class="linenos">383</span></a>
</span><span id="LazyDeepRegressor.provide_models-384"><a href="#LazyDeepRegressor.provide_models-384"><span class="linenos">384</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyDeepRegressor.provide_models-385"><a href="#LazyDeepRegressor.provide_models-385"><span class="linenos">385</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor.provide_models-386"><a href="#LazyDeepRegressor.provide_models-386"><span class="linenos">386</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor.provide_models-387"><a href="#LazyDeepRegressor.provide_models-387"><span class="linenos">387</span></a>
</span><span id="LazyDeepRegressor.provide_models-388"><a href="#LazyDeepRegressor.provide_models-388"><span class="linenos">388</span></a><span class="sd">            y_train : array-like,</span>
</span><span id="LazyDeepRegressor.provide_models-389"><a href="#LazyDeepRegressor.provide_models-389"><span class="linenos">389</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor.provide_models-390"><a href="#LazyDeepRegressor.provide_models-390"><span class="linenos">390</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor.provide_models-391"><a href="#LazyDeepRegressor.provide_models-391"><span class="linenos">391</span></a>
</span><span id="LazyDeepRegressor.provide_models-392"><a href="#LazyDeepRegressor.provide_models-392"><span class="linenos">392</span></a><span class="sd">            y_test : array-like,</span>
</span><span id="LazyDeepRegressor.provide_models-393"><a href="#LazyDeepRegressor.provide_models-393"><span class="linenos">393</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepRegressor.provide_models-394"><a href="#LazyDeepRegressor.provide_models-394"><span class="linenos">394</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepRegressor.provide_models-395"><a href="#LazyDeepRegressor.provide_models-395"><span class="linenos">395</span></a>
</span><span id="LazyDeepRegressor.provide_models-396"><a href="#LazyDeepRegressor.provide_models-396"><span class="linenos">396</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepRegressor.provide_models-397"><a href="#LazyDeepRegressor.provide_models-397"><span class="linenos">397</span></a>
</span><span id="LazyDeepRegressor.provide_models-398"><a href="#LazyDeepRegressor.provide_models-398"><span class="linenos">398</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyDeepRegressor.provide_models-399"><a href="#LazyDeepRegressor.provide_models-399"><span class="linenos">399</span></a><span class="sd">                Returns a dictionary with each model pipeline as value</span>
</span><span id="LazyDeepRegressor.provide_models-400"><a href="#LazyDeepRegressor.provide_models-400"><span class="linenos">400</span></a><span class="sd">                with key as name of models.</span>
</span><span id="LazyDeepRegressor.provide_models-401"><a href="#LazyDeepRegressor.provide_models-401"><span class="linenos">401</span></a>
</span><span id="LazyDeepRegressor.provide_models-402"><a href="#LazyDeepRegressor.provide_models-402"><span class="linenos">402</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepRegressor.provide_models-403"><a href="#LazyDeepRegressor.provide_models-403"><span class="linenos">403</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepRegressor.provide_models-404"><a href="#LazyDeepRegressor.provide_models-404"><span class="linenos">404</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span><span id="LazyDeepRegressor.provide_models-405"><a href="#LazyDeepRegressor.provide_models-405"><span class="linenos">405</span></a>
</span><span id="LazyDeepRegressor.provide_models-406"><a href="#LazyDeepRegressor.provide_models-406"><span class="linenos">406</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>This function returns all the model objects trained in fit function.
If fit is not called already, then we call fit and then return the models.</p>

<p>Parameters:</p>

<pre><code>X_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.

y_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

y_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.
</code></pre>

<p>Returns:</p>

<pre><code>models: dict-object,
    Returns a dictionary with each model pipeline as value
    with key as name of models.
</code></pre>
</div>


                                </div>
                        
                </section>
                <section id="LazyDeepMTS">
                            <input id="LazyDeepMTS-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LazyDeepMTS</span><wbr>(<span class="base">nnetsauce.mts.mts.MTS</span>):

                <label class="view-source-button" for="LazyDeepMTS-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepMTS"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepMTS-74"><a href="#LazyDeepMTS-74"><span class="linenos"> 74</span></a><span class="k">class</span> <span class="nc">LazyDeepMTS</span><span class="p">(</span><span class="n">MTS</span><span class="p">):</span>
</span><span id="LazyDeepMTS-75"><a href="#LazyDeepMTS-75"><span class="linenos"> 75</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyDeepMTS-76"><a href="#LazyDeepMTS-76"><span class="linenos"> 76</span></a>
</span><span id="LazyDeepMTS-77"><a href="#LazyDeepMTS-77"><span class="linenos"> 77</span></a><span class="sd">        Fitting -- almost -- all the regression algorithms with layers of</span>
</span><span id="LazyDeepMTS-78"><a href="#LazyDeepMTS-78"><span class="linenos"> 78</span></a><span class="sd">        nnetsauce&#39;s CustomRegressor to multivariate time series</span>
</span><span id="LazyDeepMTS-79"><a href="#LazyDeepMTS-79"><span class="linenos"> 79</span></a><span class="sd">        and returning their scores.</span>
</span><span id="LazyDeepMTS-80"><a href="#LazyDeepMTS-80"><span class="linenos"> 80</span></a>
</span><span id="LazyDeepMTS-81"><a href="#LazyDeepMTS-81"><span class="linenos"> 81</span></a><span class="sd">    Parameters:</span>
</span><span id="LazyDeepMTS-82"><a href="#LazyDeepMTS-82"><span class="linenos"> 82</span></a>
</span><span id="LazyDeepMTS-83"><a href="#LazyDeepMTS-83"><span class="linenos"> 83</span></a><span class="sd">        verbose: int, optional (default=0)</span>
</span><span id="LazyDeepMTS-84"><a href="#LazyDeepMTS-84"><span class="linenos"> 84</span></a><span class="sd">            Any positive number for verbosity.</span>
</span><span id="LazyDeepMTS-85"><a href="#LazyDeepMTS-85"><span class="linenos"> 85</span></a>
</span><span id="LazyDeepMTS-86"><a href="#LazyDeepMTS-86"><span class="linenos"> 86</span></a><span class="sd">        ignore_warnings: bool, optional (default=True)</span>
</span><span id="LazyDeepMTS-87"><a href="#LazyDeepMTS-87"><span class="linenos"> 87</span></a><span class="sd">            When set to True, the warning related to algorigms that are not</span>
</span><span id="LazyDeepMTS-88"><a href="#LazyDeepMTS-88"><span class="linenos"> 88</span></a><span class="sd">            able to run are ignored.</span>
</span><span id="LazyDeepMTS-89"><a href="#LazyDeepMTS-89"><span class="linenos"> 89</span></a>
</span><span id="LazyDeepMTS-90"><a href="#LazyDeepMTS-90"><span class="linenos"> 90</span></a><span class="sd">        custom_metric: function, optional (default=None)</span>
</span><span id="LazyDeepMTS-91"><a href="#LazyDeepMTS-91"><span class="linenos"> 91</span></a><span class="sd">            When function is provided, models are evaluated based on the</span>
</span><span id="LazyDeepMTS-92"><a href="#LazyDeepMTS-92"><span class="linenos"> 92</span></a><span class="sd">            custom evaluation metric provided.</span>
</span><span id="LazyDeepMTS-93"><a href="#LazyDeepMTS-93"><span class="linenos"> 93</span></a>
</span><span id="LazyDeepMTS-94"><a href="#LazyDeepMTS-94"><span class="linenos"> 94</span></a><span class="sd">        predictions: bool, optional (default=False)</span>
</span><span id="LazyDeepMTS-95"><a href="#LazyDeepMTS-95"><span class="linenos"> 95</span></a><span class="sd">            When set to True, the predictions of all the models models are</span>
</span><span id="LazyDeepMTS-96"><a href="#LazyDeepMTS-96"><span class="linenos"> 96</span></a><span class="sd">            returned as dataframe.</span>
</span><span id="LazyDeepMTS-97"><a href="#LazyDeepMTS-97"><span class="linenos"> 97</span></a>
</span><span id="LazyDeepMTS-98"><a href="#LazyDeepMTS-98"><span class="linenos"> 98</span></a><span class="sd">        sort_by: string, optional (default=&#39;RMSE&#39;)</span>
</span><span id="LazyDeepMTS-99"><a href="#LazyDeepMTS-99"><span class="linenos"> 99</span></a><span class="sd">            Sort models by a metric. Available options are &#39;RMSE&#39;, &#39;MAE&#39;,</span>
</span><span id="LazyDeepMTS-100"><a href="#LazyDeepMTS-100"><span class="linenos">100</span></a><span class="sd">            &#39;MPL&#39;, &#39;MPE&#39;, &#39;MAPE&#39;, &#39;R-Squared&#39;, &#39;Adjusted R-Squared&#39; or</span>
</span><span id="LazyDeepMTS-101"><a href="#LazyDeepMTS-101"><span class="linenos">101</span></a><span class="sd">            a custom metric identified by its name and</span>
</span><span id="LazyDeepMTS-102"><a href="#LazyDeepMTS-102"><span class="linenos">102</span></a><span class="sd">            provided by custom_metric.</span>
</span><span id="LazyDeepMTS-103"><a href="#LazyDeepMTS-103"><span class="linenos">103</span></a>
</span><span id="LazyDeepMTS-104"><a href="#LazyDeepMTS-104"><span class="linenos">104</span></a><span class="sd">        random_state: int, optional (default=42)</span>
</span><span id="LazyDeepMTS-105"><a href="#LazyDeepMTS-105"><span class="linenos">105</span></a><span class="sd">            Reproducibiility seed.</span>
</span><span id="LazyDeepMTS-106"><a href="#LazyDeepMTS-106"><span class="linenos">106</span></a>
</span><span id="LazyDeepMTS-107"><a href="#LazyDeepMTS-107"><span class="linenos">107</span></a><span class="sd">        estimators: list, optional (default=&#39;all&#39;)</span>
</span><span id="LazyDeepMTS-108"><a href="#LazyDeepMTS-108"><span class="linenos">108</span></a><span class="sd">            list of Estimators (regression algorithms) names or just</span>
</span><span id="LazyDeepMTS-109"><a href="#LazyDeepMTS-109"><span class="linenos">109</span></a><span class="sd">            &#39;all&#39; (default=&#39;all&#39;)</span>
</span><span id="LazyDeepMTS-110"><a href="#LazyDeepMTS-110"><span class="linenos">110</span></a>
</span><span id="LazyDeepMTS-111"><a href="#LazyDeepMTS-111"><span class="linenos">111</span></a><span class="sd">        preprocess: bool, preprocessing is done when set to True</span>
</span><span id="LazyDeepMTS-112"><a href="#LazyDeepMTS-112"><span class="linenos">112</span></a>
</span><span id="LazyDeepMTS-113"><a href="#LazyDeepMTS-113"><span class="linenos">113</span></a><span class="sd">        n_jobs : int, when possible, run in parallel</span>
</span><span id="LazyDeepMTS-114"><a href="#LazyDeepMTS-114"><span class="linenos">114</span></a><span class="sd">            For now, only used by individual models that support it.</span>
</span><span id="LazyDeepMTS-115"><a href="#LazyDeepMTS-115"><span class="linenos">115</span></a>
</span><span id="LazyDeepMTS-116"><a href="#LazyDeepMTS-116"><span class="linenos">116</span></a><span class="sd">        n_layers: int, optional (default=3)</span>
</span><span id="LazyDeepMTS-117"><a href="#LazyDeepMTS-117"><span class="linenos">117</span></a><span class="sd">            Number of layers of CustomRegressors to be used.</span>
</span><span id="LazyDeepMTS-118"><a href="#LazyDeepMTS-118"><span class="linenos">118</span></a>
</span><span id="LazyDeepMTS-119"><a href="#LazyDeepMTS-119"><span class="linenos">119</span></a><span class="sd">        All the other parameters are the same as MTS&#39;s.</span>
</span><span id="LazyDeepMTS-120"><a href="#LazyDeepMTS-120"><span class="linenos">120</span></a>
</span><span id="LazyDeepMTS-121"><a href="#LazyDeepMTS-121"><span class="linenos">121</span></a><span class="sd">    Examples</span>
</span><span id="LazyDeepMTS-122"><a href="#LazyDeepMTS-122"><span class="linenos">122</span></a>
</span><span id="LazyDeepMTS-123"><a href="#LazyDeepMTS-123"><span class="linenos">123</span></a><span class="sd">        See https://github.com/Techtonique/nnetsauce/blob/master/nnetsauce/demo/thierrymoudiki_20240106_LazyDeepMTS.ipynb</span>
</span><span id="LazyDeepMTS-124"><a href="#LazyDeepMTS-124"><span class="linenos">124</span></a>
</span><span id="LazyDeepMTS-125"><a href="#LazyDeepMTS-125"><span class="linenos">125</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LazyDeepMTS-126"><a href="#LazyDeepMTS-126"><span class="linenos">126</span></a>
</span><span id="LazyDeepMTS-127"><a href="#LazyDeepMTS-127"><span class="linenos">127</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyDeepMTS-128"><a href="#LazyDeepMTS-128"><span class="linenos">128</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="LazyDeepMTS-129"><a href="#LazyDeepMTS-129"><span class="linenos">129</span></a>        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyDeepMTS-130"><a href="#LazyDeepMTS-130"><span class="linenos">130</span></a>        <span class="n">ignore_warnings</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepMTS-131"><a href="#LazyDeepMTS-131"><span class="linenos">131</span></a>        <span class="n">custom_metric</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepMTS-132"><a href="#LazyDeepMTS-132"><span class="linenos">132</span></a>        <span class="n">predictions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyDeepMTS-133"><a href="#LazyDeepMTS-133"><span class="linenos">133</span></a>        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
</span><span id="LazyDeepMTS-134"><a href="#LazyDeepMTS-134"><span class="linenos">134</span></a>        <span class="n">estimators</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-135"><a href="#LazyDeepMTS-135"><span class="linenos">135</span></a>        <span class="n">preprocess</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyDeepMTS-136"><a href="#LazyDeepMTS-136"><span class="linenos">136</span></a>        <span class="c1"># Defining depth</span>
</span><span id="LazyDeepMTS-137"><a href="#LazyDeepMTS-137"><span class="linenos">137</span></a>        <span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="LazyDeepMTS-138"><a href="#LazyDeepMTS-138"><span class="linenos">138</span></a>        <span class="c1"># MTS attributes</span>
</span><span id="LazyDeepMTS-139"><a href="#LazyDeepMTS-139"><span class="linenos">139</span></a>        <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepMTS-140"><a href="#LazyDeepMTS-140"><span class="linenos">140</span></a>        <span class="n">n_hidden_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span id="LazyDeepMTS-141"><a href="#LazyDeepMTS-141"><span class="linenos">141</span></a>        <span class="n">activation_name</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-142"><a href="#LazyDeepMTS-142"><span class="linenos">142</span></a>        <span class="n">a</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
</span><span id="LazyDeepMTS-143"><a href="#LazyDeepMTS-143"><span class="linenos">143</span></a>        <span class="n">nodes_sim</span><span class="o">=</span><span class="s2">&quot;sobol&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-144"><a href="#LazyDeepMTS-144"><span class="linenos">144</span></a>        <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepMTS-145"><a href="#LazyDeepMTS-145"><span class="linenos">145</span></a>        <span class="n">dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="LazyDeepMTS-146"><a href="#LazyDeepMTS-146"><span class="linenos">146</span></a>        <span class="n">direct_link</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepMTS-147"><a href="#LazyDeepMTS-147"><span class="linenos">147</span></a>        <span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="LazyDeepMTS-148"><a href="#LazyDeepMTS-148"><span class="linenos">148</span></a>        <span class="n">cluster_encode</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LazyDeepMTS-149"><a href="#LazyDeepMTS-149"><span class="linenos">149</span></a>        <span class="n">type_clust</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-150"><a href="#LazyDeepMTS-150"><span class="linenos">150</span></a>        <span class="n">type_scaling</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">),</span>
</span><span id="LazyDeepMTS-151"><a href="#LazyDeepMTS-151"><span class="linenos">151</span></a>        <span class="n">lags</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LazyDeepMTS-152"><a href="#LazyDeepMTS-152"><span class="linenos">152</span></a>        <span class="n">replications</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepMTS-153"><a href="#LazyDeepMTS-153"><span class="linenos">153</span></a>        <span class="n">kernel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LazyDeepMTS-154"><a href="#LazyDeepMTS-154"><span class="linenos">154</span></a>        <span class="n">agg</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-155"><a href="#LazyDeepMTS-155"><span class="linenos">155</span></a>        <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
</span><span id="LazyDeepMTS-156"><a href="#LazyDeepMTS-156"><span class="linenos">156</span></a>        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-157"><a href="#LazyDeepMTS-157"><span class="linenos">157</span></a>        <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="LazyDeepMTS-158"><a href="#LazyDeepMTS-158"><span class="linenos">158</span></a>    <span class="p">):</span>
</span><span id="LazyDeepMTS-159"><a href="#LazyDeepMTS-159"><span class="linenos">159</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
</span><span id="LazyDeepMTS-160"><a href="#LazyDeepMTS-160"><span class="linenos">160</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="o">=</span> <span class="n">ignore_warnings</span>
</span><span id="LazyDeepMTS-161"><a href="#LazyDeepMTS-161"><span class="linenos">161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span> <span class="o">=</span> <span class="n">custom_metric</span>
</span><span id="LazyDeepMTS-162"><a href="#LazyDeepMTS-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="o">=</span> <span class="n">predictions</span>
</span><span id="LazyDeepMTS-163"><a href="#LazyDeepMTS-163"><span class="linenos">163</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepMTS-164"><a href="#LazyDeepMTS-164"><span class="linenos">164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
</span><span id="LazyDeepMTS-165"><a href="#LazyDeepMTS-165"><span class="linenos">165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">=</span> <span class="n">estimators</span>
</span><span id="LazyDeepMTS-166"><a href="#LazyDeepMTS-166"><span class="linenos">166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="o">=</span> <span class="n">preprocess</span>
</span><span id="LazyDeepMTS-167"><a href="#LazyDeepMTS-167"><span class="linenos">167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span> <span class="o">=</span> <span class="n">n_layers</span>
</span><span id="LazyDeepMTS-168"><a href="#LazyDeepMTS-168"><span class="linenos">168</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="LazyDeepMTS-169"><a href="#LazyDeepMTS-169"><span class="linenos">169</span></a>            <span class="n">obj</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span>
</span><span id="LazyDeepMTS-170"><a href="#LazyDeepMTS-170"><span class="linenos">170</span></a>            <span class="n">n_hidden_features</span><span class="o">=</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS-171"><a href="#LazyDeepMTS-171"><span class="linenos">171</span></a>            <span class="n">activation_name</span><span class="o">=</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS-172"><a href="#LazyDeepMTS-172"><span class="linenos">172</span></a>            <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS-173"><a href="#LazyDeepMTS-173"><span class="linenos">173</span></a>            <span class="n">nodes_sim</span><span class="o">=</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS-174"><a href="#LazyDeepMTS-174"><span class="linenos">174</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS-175"><a href="#LazyDeepMTS-175"><span class="linenos">175</span></a>            <span class="n">dropout</span><span class="o">=</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS-176"><a href="#LazyDeepMTS-176"><span class="linenos">176</span></a>            <span class="n">direct_link</span><span class="o">=</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS-177"><a href="#LazyDeepMTS-177"><span class="linenos">177</span></a>            <span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS-178"><a href="#LazyDeepMTS-178"><span class="linenos">178</span></a>            <span class="n">cluster_encode</span><span class="o">=</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS-179"><a href="#LazyDeepMTS-179"><span class="linenos">179</span></a>            <span class="n">type_clust</span><span class="o">=</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS-180"><a href="#LazyDeepMTS-180"><span class="linenos">180</span></a>            <span class="n">type_scaling</span><span class="o">=</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS-181"><a href="#LazyDeepMTS-181"><span class="linenos">181</span></a>            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS-182"><a href="#LazyDeepMTS-182"><span class="linenos">182</span></a>            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS-183"><a href="#LazyDeepMTS-183"><span class="linenos">183</span></a>            <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS-184"><a href="#LazyDeepMTS-184"><span class="linenos">184</span></a>            <span class="n">replications</span><span class="o">=</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS-185"><a href="#LazyDeepMTS-185"><span class="linenos">185</span></a>            <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS-186"><a href="#LazyDeepMTS-186"><span class="linenos">186</span></a>            <span class="n">agg</span><span class="o">=</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS-187"><a href="#LazyDeepMTS-187"><span class="linenos">187</span></a>            <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS-188"><a href="#LazyDeepMTS-188"><span class="linenos">188</span></a>        <span class="p">)</span>
</span><span id="LazyDeepMTS-189"><a href="#LazyDeepMTS-189"><span class="linenos">189</span></a>
</span><span id="LazyDeepMTS-190"><a href="#LazyDeepMTS-190"><span class="linenos">190</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">xreg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="LazyDeepMTS-191"><a href="#LazyDeepMTS-191"><span class="linenos">191</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X_train, predict and score on X_test.</span>
</span><span id="LazyDeepMTS-192"><a href="#LazyDeepMTS-192"><span class="linenos">192</span></a>
</span><span id="LazyDeepMTS-193"><a href="#LazyDeepMTS-193"><span class="linenos">193</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepMTS-194"><a href="#LazyDeepMTS-194"><span class="linenos">194</span></a>
</span><span id="LazyDeepMTS-195"><a href="#LazyDeepMTS-195"><span class="linenos">195</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyDeepMTS-196"><a href="#LazyDeepMTS-196"><span class="linenos">196</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepMTS-197"><a href="#LazyDeepMTS-197"><span class="linenos">197</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepMTS-198"><a href="#LazyDeepMTS-198"><span class="linenos">198</span></a>
</span><span id="LazyDeepMTS-199"><a href="#LazyDeepMTS-199"><span class="linenos">199</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyDeepMTS-200"><a href="#LazyDeepMTS-200"><span class="linenos">200</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepMTS-201"><a href="#LazyDeepMTS-201"><span class="linenos">201</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepMTS-202"><a href="#LazyDeepMTS-202"><span class="linenos">202</span></a>
</span><span id="LazyDeepMTS-203"><a href="#LazyDeepMTS-203"><span class="linenos">203</span></a><span class="sd">            xreg: {array-like}, shape = [n_samples, n_features_xreg]</span>
</span><span id="LazyDeepMTS-204"><a href="#LazyDeepMTS-204"><span class="linenos">204</span></a><span class="sd">                Additional (external) regressors to be passed to self.obj</span>
</span><span id="LazyDeepMTS-205"><a href="#LazyDeepMTS-205"><span class="linenos">205</span></a><span class="sd">                xreg must be in &#39;increasing&#39; order (most recent observations last)</span>
</span><span id="LazyDeepMTS-206"><a href="#LazyDeepMTS-206"><span class="linenos">206</span></a>
</span><span id="LazyDeepMTS-207"><a href="#LazyDeepMTS-207"><span class="linenos">207</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepMTS-208"><a href="#LazyDeepMTS-208"><span class="linenos">208</span></a>
</span><span id="LazyDeepMTS-209"><a href="#LazyDeepMTS-209"><span class="linenos">209</span></a><span class="sd">            scores : Pandas DataFrame</span>
</span><span id="LazyDeepMTS-210"><a href="#LazyDeepMTS-210"><span class="linenos">210</span></a><span class="sd">                Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepMTS-211"><a href="#LazyDeepMTS-211"><span class="linenos">211</span></a>
</span><span id="LazyDeepMTS-212"><a href="#LazyDeepMTS-212"><span class="linenos">212</span></a><span class="sd">            predictions : Pandas DataFrame</span>
</span><span id="LazyDeepMTS-213"><a href="#LazyDeepMTS-213"><span class="linenos">213</span></a><span class="sd">                Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepMTS-214"><a href="#LazyDeepMTS-214"><span class="linenos">214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepMTS-215"><a href="#LazyDeepMTS-215"><span class="linenos">215</span></a>        <span class="n">R2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-216"><a href="#LazyDeepMTS-216"><span class="linenos">216</span></a>        <span class="n">ADJR2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-217"><a href="#LazyDeepMTS-217"><span class="linenos">217</span></a>        <span class="n">ME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-218"><a href="#LazyDeepMTS-218"><span class="linenos">218</span></a>        <span class="n">MPL</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-219"><a href="#LazyDeepMTS-219"><span class="linenos">219</span></a>        <span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-220"><a href="#LazyDeepMTS-220"><span class="linenos">220</span></a>        <span class="n">MAE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-221"><a href="#LazyDeepMTS-221"><span class="linenos">221</span></a>        <span class="n">MPE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-222"><a href="#LazyDeepMTS-222"><span class="linenos">222</span></a>        <span class="n">MAPE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-223"><a href="#LazyDeepMTS-223"><span class="linenos">223</span></a>
</span><span id="LazyDeepMTS-224"><a href="#LazyDeepMTS-224"><span class="linenos">224</span></a>        <span class="c1"># WIN = []</span>
</span><span id="LazyDeepMTS-225"><a href="#LazyDeepMTS-225"><span class="linenos">225</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-226"><a href="#LazyDeepMTS-226"><span class="linenos">226</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-227"><a href="#LazyDeepMTS-227"><span class="linenos">227</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepMTS-228"><a href="#LazyDeepMTS-228"><span class="linenos">228</span></a>
</span><span id="LazyDeepMTS-229"><a href="#LazyDeepMTS-229"><span class="linenos">229</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS-230"><a href="#LazyDeepMTS-230"><span class="linenos">230</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS-231"><a href="#LazyDeepMTS-231"><span class="linenos">231</span></a>
</span><span id="LazyDeepMTS-232"><a href="#LazyDeepMTS-232"><span class="linenos">232</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyDeepMTS-233"><a href="#LazyDeepMTS-233"><span class="linenos">233</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyDeepMTS-234"><a href="#LazyDeepMTS-234"><span class="linenos">234</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepMTS-235"><a href="#LazyDeepMTS-235"><span class="linenos">235</span></a>
</span><span id="LazyDeepMTS-236"><a href="#LazyDeepMTS-236"><span class="linenos">236</span></a>        <span class="n">X_train</span> <span class="o">=</span> <span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyDeepMTS-237"><a href="#LazyDeepMTS-237"><span class="linenos">237</span></a>        <span class="n">X_test</span> <span class="o">=</span> <span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepMTS-238"><a href="#LazyDeepMTS-238"><span class="linenos">238</span></a>
</span><span id="LazyDeepMTS-239"><a href="#LazyDeepMTS-239"><span class="linenos">239</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepMTS-240"><a href="#LazyDeepMTS-240"><span class="linenos">240</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepMTS-241"><a href="#LazyDeepMTS-241"><span class="linenos">241</span></a>
</span><span id="LazyDeepMTS-242"><a href="#LazyDeepMTS-242"><span class="linenos">242</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyDeepMTS-243"><a href="#LazyDeepMTS-243"><span class="linenos">243</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyDeepMTS-244"><a href="#LazyDeepMTS-244"><span class="linenos">244</span></a>        <span class="p">)</span>
</span><span id="LazyDeepMTS-245"><a href="#LazyDeepMTS-245"><span class="linenos">245</span></a>
</span><span id="LazyDeepMTS-246"><a href="#LazyDeepMTS-246"><span class="linenos">246</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span><span class="p">:</span>
</span><span id="LazyDeepMTS-247"><a href="#LazyDeepMTS-247"><span class="linenos">247</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyDeepMTS-248"><a href="#LazyDeepMTS-248"><span class="linenos">248</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepMTS-249"><a href="#LazyDeepMTS-249"><span class="linenos">249</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyDeepMTS-250"><a href="#LazyDeepMTS-250"><span class="linenos">250</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepMTS-251"><a href="#LazyDeepMTS-251"><span class="linenos">251</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-252"><a href="#LazyDeepMTS-252"><span class="linenos">252</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyDeepMTS-253"><a href="#LazyDeepMTS-253"><span class="linenos">253</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyDeepMTS-254"><a href="#LazyDeepMTS-254"><span class="linenos">254</span></a>                    <span class="p">),</span>
</span><span id="LazyDeepMTS-255"><a href="#LazyDeepMTS-255"><span class="linenos">255</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepMTS-256"><a href="#LazyDeepMTS-256"><span class="linenos">256</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-257"><a href="#LazyDeepMTS-257"><span class="linenos">257</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyDeepMTS-258"><a href="#LazyDeepMTS-258"><span class="linenos">258</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyDeepMTS-259"><a href="#LazyDeepMTS-259"><span class="linenos">259</span></a>                    <span class="p">),</span>
</span><span id="LazyDeepMTS-260"><a href="#LazyDeepMTS-260"><span class="linenos">260</span></a>                <span class="p">]</span>
</span><span id="LazyDeepMTS-261"><a href="#LazyDeepMTS-261"><span class="linenos">261</span></a>            <span class="p">)</span>
</span><span id="LazyDeepMTS-262"><a href="#LazyDeepMTS-262"><span class="linenos">262</span></a>
</span><span id="LazyDeepMTS-263"><a href="#LazyDeepMTS-263"><span class="linenos">263</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyDeepMTS-264"><a href="#LazyDeepMTS-264"><span class="linenos">264</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="n">DEEPREGRESSORSMTS</span>
</span><span id="LazyDeepMTS-265"><a href="#LazyDeepMTS-265"><span class="linenos">265</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS-266"><a href="#LazyDeepMTS-266"><span class="linenos">266</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyDeepMTS-267"><a href="#LazyDeepMTS-267"><span class="linenos">267</span></a>                <span class="p">(</span><span class="s2">&quot;DeepMTS(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyDeepMTS-268"><a href="#LazyDeepMTS-268"><span class="linenos">268</span></a>                <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepMTS-269"><a href="#LazyDeepMTS-269"><span class="linenos">269</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepMTS-270"><a href="#LazyDeepMTS-270"><span class="linenos">270</span></a>                    <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyDeepMTS-271"><a href="#LazyDeepMTS-271"><span class="linenos">271</span></a>                    <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepMTS-272"><a href="#LazyDeepMTS-272"><span class="linenos">272</span></a>                <span class="p">)</span>
</span><span id="LazyDeepMTS-273"><a href="#LazyDeepMTS-273"><span class="linenos">273</span></a>            <span class="p">]</span>
</span><span id="LazyDeepMTS-274"><a href="#LazyDeepMTS-274"><span class="linenos">274</span></a>
</span><span id="LazyDeepMTS-275"><a href="#LazyDeepMTS-275"><span class="linenos">275</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyDeepMTS-276"><a href="#LazyDeepMTS-276"><span class="linenos">276</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepMTS-277"><a href="#LazyDeepMTS-277"><span class="linenos">277</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepMTS-278"><a href="#LazyDeepMTS-278"><span class="linenos">278</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepMTS-279"><a href="#LazyDeepMTS-279"><span class="linenos">279</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepMTS-280"><a href="#LazyDeepMTS-280"><span class="linenos">280</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyDeepMTS-281"><a href="#LazyDeepMTS-281"><span class="linenos">281</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepMTS-282"><a href="#LazyDeepMTS-282"><span class="linenos">282</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyDeepMTS-283"><a href="#LazyDeepMTS-283"><span class="linenos">283</span></a>                                <span class="p">(</span>
</span><span id="LazyDeepMTS-284"><a href="#LazyDeepMTS-284"><span class="linenos">284</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-285"><a href="#LazyDeepMTS-285"><span class="linenos">285</span></a>                                    <span class="n">DeepMTS</span><span class="p">(</span>
</span><span id="LazyDeepMTS-286"><a href="#LazyDeepMTS-286"><span class="linenos">286</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyDeepMTS-287"><a href="#LazyDeepMTS-287"><span class="linenos">287</span></a>                                            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="LazyDeepMTS-288"><a href="#LazyDeepMTS-288"><span class="linenos">288</span></a>                                            <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyDeepMTS-289"><a href="#LazyDeepMTS-289"><span class="linenos">289</span></a>                                        <span class="p">),</span>
</span><span id="LazyDeepMTS-290"><a href="#LazyDeepMTS-290"><span class="linenos">290</span></a>                                        <span class="n">n_layers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">,</span>
</span><span id="LazyDeepMTS-291"><a href="#LazyDeepMTS-291"><span class="linenos">291</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS-292"><a href="#LazyDeepMTS-292"><span class="linenos">292</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS-293"><a href="#LazyDeepMTS-293"><span class="linenos">293</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS-294"><a href="#LazyDeepMTS-294"><span class="linenos">294</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS-295"><a href="#LazyDeepMTS-295"><span class="linenos">295</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS-296"><a href="#LazyDeepMTS-296"><span class="linenos">296</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS-297"><a href="#LazyDeepMTS-297"><span class="linenos">297</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS-298"><a href="#LazyDeepMTS-298"><span class="linenos">298</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS-299"><a href="#LazyDeepMTS-299"><span class="linenos">299</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS-300"><a href="#LazyDeepMTS-300"><span class="linenos">300</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS-301"><a href="#LazyDeepMTS-301"><span class="linenos">301</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS-302"><a href="#LazyDeepMTS-302"><span class="linenos">302</span></a>                                        <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS-303"><a href="#LazyDeepMTS-303"><span class="linenos">303</span></a>                                        <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS-304"><a href="#LazyDeepMTS-304"><span class="linenos">304</span></a>                                        <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS-305"><a href="#LazyDeepMTS-305"><span class="linenos">305</span></a>                                        <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS-306"><a href="#LazyDeepMTS-306"><span class="linenos">306</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS-307"><a href="#LazyDeepMTS-307"><span class="linenos">307</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS-308"><a href="#LazyDeepMTS-308"><span class="linenos">308</span></a>                                        <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS-309"><a href="#LazyDeepMTS-309"><span class="linenos">309</span></a>                                    <span class="p">),</span>
</span><span id="LazyDeepMTS-310"><a href="#LazyDeepMTS-310"><span class="linenos">310</span></a>                                <span class="p">),</span>
</span><span id="LazyDeepMTS-311"><a href="#LazyDeepMTS-311"><span class="linenos">311</span></a>                            <span class="p">]</span>
</span><span id="LazyDeepMTS-312"><a href="#LazyDeepMTS-312"><span class="linenos">312</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS-313"><a href="#LazyDeepMTS-313"><span class="linenos">313</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS-314"><a href="#LazyDeepMTS-314"><span class="linenos">314</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyDeepMTS-315"><a href="#LazyDeepMTS-315"><span class="linenos">315</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepMTS-316"><a href="#LazyDeepMTS-316"><span class="linenos">316</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyDeepMTS-317"><a href="#LazyDeepMTS-317"><span class="linenos">317</span></a>                                <span class="p">(</span>
</span><span id="LazyDeepMTS-318"><a href="#LazyDeepMTS-318"><span class="linenos">318</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS-319"><a href="#LazyDeepMTS-319"><span class="linenos">319</span></a>                                    <span class="n">DeepMTS</span><span class="p">(</span>
</span><span id="LazyDeepMTS-320"><a href="#LazyDeepMTS-320"><span class="linenos">320</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyDeepMTS-321"><a href="#LazyDeepMTS-321"><span class="linenos">321</span></a>                                        <span class="n">n_layers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">,</span>
</span><span id="LazyDeepMTS-322"><a href="#LazyDeepMTS-322"><span class="linenos">322</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS-323"><a href="#LazyDeepMTS-323"><span class="linenos">323</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS-324"><a href="#LazyDeepMTS-324"><span class="linenos">324</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS-325"><a href="#LazyDeepMTS-325"><span class="linenos">325</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS-326"><a href="#LazyDeepMTS-326"><span class="linenos">326</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS-327"><a href="#LazyDeepMTS-327"><span class="linenos">327</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS-328"><a href="#LazyDeepMTS-328"><span class="linenos">328</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS-329"><a href="#LazyDeepMTS-329"><span class="linenos">329</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS-330"><a href="#LazyDeepMTS-330"><span class="linenos">330</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS-331"><a href="#LazyDeepMTS-331"><span class="linenos">331</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS-332"><a href="#LazyDeepMTS-332"><span class="linenos">332</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS-333"><a href="#LazyDeepMTS-333"><span class="linenos">333</span></a>                                        <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS-334"><a href="#LazyDeepMTS-334"><span class="linenos">334</span></a>                                        <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS-335"><a href="#LazyDeepMTS-335"><span class="linenos">335</span></a>                                        <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS-336"><a href="#LazyDeepMTS-336"><span class="linenos">336</span></a>                                        <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS-337"><a href="#LazyDeepMTS-337"><span class="linenos">337</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS-338"><a href="#LazyDeepMTS-338"><span class="linenos">338</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS-339"><a href="#LazyDeepMTS-339"><span class="linenos">339</span></a>                                        <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS-340"><a href="#LazyDeepMTS-340"><span class="linenos">340</span></a>                                    <span class="p">),</span>
</span><span id="LazyDeepMTS-341"><a href="#LazyDeepMTS-341"><span class="linenos">341</span></a>                                <span class="p">),</span>
</span><span id="LazyDeepMTS-342"><a href="#LazyDeepMTS-342"><span class="linenos">342</span></a>                            <span class="p">]</span>
</span><span id="LazyDeepMTS-343"><a href="#LazyDeepMTS-343"><span class="linenos">343</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS-344"><a href="#LazyDeepMTS-344"><span class="linenos">344</span></a>
</span><span id="LazyDeepMTS-345"><a href="#LazyDeepMTS-345"><span class="linenos">345</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="LazyDeepMTS-346"><a href="#LazyDeepMTS-346"><span class="linenos">346</span></a>                    <span class="c1"># pipe.fit(X_train, xreg=xreg)</span>
</span><span id="LazyDeepMTS-347"><a href="#LazyDeepMTS-347"><span class="linenos">347</span></a>
</span><span id="LazyDeepMTS-348"><a href="#LazyDeepMTS-348"><span class="linenos">348</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyDeepMTS-349"><a href="#LazyDeepMTS-349"><span class="linenos">349</span></a>                    <span class="k">if</span> <span class="n">xreg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS-350"><a href="#LazyDeepMTS-350"><span class="linenos">350</span></a>                        <span class="k">assert</span> <span class="p">(</span>
</span><span id="LazyDeepMTS-351"><a href="#LazyDeepMTS-351"><span class="linenos">351</span></a>                            <span class="n">new_xreg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="LazyDeepMTS-352"><a href="#LazyDeepMTS-352"><span class="linenos">352</span></a>                        <span class="p">),</span> <span class="s2">&quot;xreg and new_xreg must be provided&quot;</span>
</span><span id="LazyDeepMTS-353"><a href="#LazyDeepMTS-353"><span class="linenos">353</span></a>                    <span class="c1"># X_pred = pipe.predict(h=X_test.shape[0], new_xreg=new_xreg)</span>
</span><span id="LazyDeepMTS-354"><a href="#LazyDeepMTS-354"><span class="linenos">354</span></a>                    <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">[</span><span class="s2">&quot;regressor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyDeepMTS-355"><a href="#LazyDeepMTS-355"><span class="linenos">355</span></a>                        <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyDeepMTS-356"><a href="#LazyDeepMTS-356"><span class="linenos">356</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepMTS-357"><a href="#LazyDeepMTS-357"><span class="linenos">357</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyDeepMTS-358"><a href="#LazyDeepMTS-358"><span class="linenos">358</span></a>                    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS-359"><a href="#LazyDeepMTS-359"><span class="linenos">359</span></a>                    <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS-360"><a href="#LazyDeepMTS-360"><span class="linenos">360</span></a>
</span><span id="LazyDeepMTS-361"><a href="#LazyDeepMTS-361"><span class="linenos">361</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepMTS-362"><a href="#LazyDeepMTS-362"><span class="linenos">362</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyDeepMTS-363"><a href="#LazyDeepMTS-363"><span class="linenos">363</span></a>                    <span class="n">MAE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</span><span id="LazyDeepMTS-364"><a href="#LazyDeepMTS-364"><span class="linenos">364</span></a>                    <span class="n">MPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpl</span><span class="p">)</span>
</span><span id="LazyDeepMTS-365"><a href="#LazyDeepMTS-365"><span class="linenos">365</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepMTS-366"><a href="#LazyDeepMTS-366"><span class="linenos">366</span></a>
</span><span id="LazyDeepMTS-367"><a href="#LazyDeepMTS-367"><span class="linenos">367</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS-368"><a href="#LazyDeepMTS-368"><span class="linenos">368</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS-369"><a href="#LazyDeepMTS-369"><span class="linenos">369</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepMTS-370"><a href="#LazyDeepMTS-370"><span class="linenos">370</span></a>
</span><span id="LazyDeepMTS-371"><a href="#LazyDeepMTS-371"><span class="linenos">371</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepMTS-372"><a href="#LazyDeepMTS-372"><span class="linenos">372</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS-373"><a href="#LazyDeepMTS-373"><span class="linenos">373</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepMTS-374"><a href="#LazyDeepMTS-374"><span class="linenos">374</span></a>                            <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyDeepMTS-375"><a href="#LazyDeepMTS-375"><span class="linenos">375</span></a>                            <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyDeepMTS-376"><a href="#LazyDeepMTS-376"><span class="linenos">376</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepMTS-377"><a href="#LazyDeepMTS-377"><span class="linenos">377</span></a>                            <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyDeepMTS-378"><a href="#LazyDeepMTS-378"><span class="linenos">378</span></a>                            <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyDeepMTS-379"><a href="#LazyDeepMTS-379"><span class="linenos">379</span></a>                            <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyDeepMTS-380"><a href="#LazyDeepMTS-380"><span class="linenos">380</span></a>                            <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyDeepMTS-381"><a href="#LazyDeepMTS-381"><span class="linenos">381</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepMTS-382"><a href="#LazyDeepMTS-382"><span class="linenos">382</span></a>                        <span class="p">}</span>
</span><span id="LazyDeepMTS-383"><a href="#LazyDeepMTS-383"><span class="linenos">383</span></a>
</span><span id="LazyDeepMTS-384"><a href="#LazyDeepMTS-384"><span class="linenos">384</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS-385"><a href="#LazyDeepMTS-385"><span class="linenos">385</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepMTS-386"><a href="#LazyDeepMTS-386"><span class="linenos">386</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyDeepMTS-387"><a href="#LazyDeepMTS-387"><span class="linenos">387</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepMTS-388"><a href="#LazyDeepMTS-388"><span class="linenos">388</span></a>
</span><span id="LazyDeepMTS-389"><a href="#LazyDeepMTS-389"><span class="linenos">389</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyDeepMTS-390"><a href="#LazyDeepMTS-390"><span class="linenos">390</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepMTS-391"><a href="#LazyDeepMTS-391"><span class="linenos">391</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_pred</span>
</span><span id="LazyDeepMTS-392"><a href="#LazyDeepMTS-392"><span class="linenos">392</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepMTS-393"><a href="#LazyDeepMTS-393"><span class="linenos">393</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepMTS-394"><a href="#LazyDeepMTS-394"><span class="linenos">394</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepMTS-395"><a href="#LazyDeepMTS-395"><span class="linenos">395</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepMTS-396"><a href="#LazyDeepMTS-396"><span class="linenos">396</span></a>
</span><span id="LazyDeepMTS-397"><a href="#LazyDeepMTS-397"><span class="linenos">397</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># no preprocessing</span>
</span><span id="LazyDeepMTS-398"><a href="#LazyDeepMTS-398"><span class="linenos">398</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepMTS-399"><a href="#LazyDeepMTS-399"><span class="linenos">399</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepMTS-400"><a href="#LazyDeepMTS-400"><span class="linenos">400</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepMTS-401"><a href="#LazyDeepMTS-401"><span class="linenos">401</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepMTS-402"><a href="#LazyDeepMTS-402"><span class="linenos">402</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">DeepMTS</span><span class="p">(</span>
</span><span id="LazyDeepMTS-403"><a href="#LazyDeepMTS-403"><span class="linenos">403</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyDeepMTS-404"><a href="#LazyDeepMTS-404"><span class="linenos">404</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS-405"><a href="#LazyDeepMTS-405"><span class="linenos">405</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS-406"><a href="#LazyDeepMTS-406"><span class="linenos">406</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS-407"><a href="#LazyDeepMTS-407"><span class="linenos">407</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS-408"><a href="#LazyDeepMTS-408"><span class="linenos">408</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS-409"><a href="#LazyDeepMTS-409"><span class="linenos">409</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS-410"><a href="#LazyDeepMTS-410"><span class="linenos">410</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS-411"><a href="#LazyDeepMTS-411"><span class="linenos">411</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS-412"><a href="#LazyDeepMTS-412"><span class="linenos">412</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS-413"><a href="#LazyDeepMTS-413"><span class="linenos">413</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS-414"><a href="#LazyDeepMTS-414"><span class="linenos">414</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS-415"><a href="#LazyDeepMTS-415"><span class="linenos">415</span></a>                            <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS-416"><a href="#LazyDeepMTS-416"><span class="linenos">416</span></a>                            <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS-417"><a href="#LazyDeepMTS-417"><span class="linenos">417</span></a>                            <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS-418"><a href="#LazyDeepMTS-418"><span class="linenos">418</span></a>                            <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS-419"><a href="#LazyDeepMTS-419"><span class="linenos">419</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS-420"><a href="#LazyDeepMTS-420"><span class="linenos">420</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS-421"><a href="#LazyDeepMTS-421"><span class="linenos">421</span></a>                            <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS-422"><a href="#LazyDeepMTS-422"><span class="linenos">422</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS-423"><a href="#LazyDeepMTS-423"><span class="linenos">423</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS-424"><a href="#LazyDeepMTS-424"><span class="linenos">424</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">DeepMTS</span><span class="p">(</span>
</span><span id="LazyDeepMTS-425"><a href="#LazyDeepMTS-425"><span class="linenos">425</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyDeepMTS-426"><a href="#LazyDeepMTS-426"><span class="linenos">426</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS-427"><a href="#LazyDeepMTS-427"><span class="linenos">427</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS-428"><a href="#LazyDeepMTS-428"><span class="linenos">428</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS-429"><a href="#LazyDeepMTS-429"><span class="linenos">429</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS-430"><a href="#LazyDeepMTS-430"><span class="linenos">430</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS-431"><a href="#LazyDeepMTS-431"><span class="linenos">431</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS-432"><a href="#LazyDeepMTS-432"><span class="linenos">432</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS-433"><a href="#LazyDeepMTS-433"><span class="linenos">433</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS-434"><a href="#LazyDeepMTS-434"><span class="linenos">434</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS-435"><a href="#LazyDeepMTS-435"><span class="linenos">435</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS-436"><a href="#LazyDeepMTS-436"><span class="linenos">436</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS-437"><a href="#LazyDeepMTS-437"><span class="linenos">437</span></a>                            <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS-438"><a href="#LazyDeepMTS-438"><span class="linenos">438</span></a>                            <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS-439"><a href="#LazyDeepMTS-439"><span class="linenos">439</span></a>                            <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS-440"><a href="#LazyDeepMTS-440"><span class="linenos">440</span></a>                            <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS-441"><a href="#LazyDeepMTS-441"><span class="linenos">441</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS-442"><a href="#LazyDeepMTS-442"><span class="linenos">442</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS-443"><a href="#LazyDeepMTS-443"><span class="linenos">443</span></a>                            <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS-444"><a href="#LazyDeepMTS-444"><span class="linenos">444</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS-445"><a href="#LazyDeepMTS-445"><span class="linenos">445</span></a>
</span><span id="LazyDeepMTS-446"><a href="#LazyDeepMTS-446"><span class="linenos">446</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="LazyDeepMTS-447"><a href="#LazyDeepMTS-447"><span class="linenos">447</span></a>                    <span class="c1"># pipe.fit(X_train, xreg=xreg) # DO xreg like in `ahead`</span>
</span><span id="LazyDeepMTS-448"><a href="#LazyDeepMTS-448"><span class="linenos">448</span></a>
</span><span id="LazyDeepMTS-449"><a href="#LazyDeepMTS-449"><span class="linenos">449</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyDeepMTS-450"><a href="#LazyDeepMTS-450"><span class="linenos">450</span></a>                    <span class="k">if</span> <span class="n">xreg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS-451"><a href="#LazyDeepMTS-451"><span class="linenos">451</span></a>                        <span class="k">assert</span> <span class="p">(</span>
</span><span id="LazyDeepMTS-452"><a href="#LazyDeepMTS-452"><span class="linenos">452</span></a>                            <span class="n">new_xreg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="LazyDeepMTS-453"><a href="#LazyDeepMTS-453"><span class="linenos">453</span></a>                        <span class="p">),</span> <span class="s2">&quot;xreg and new_xreg must be provided&quot;</span>
</span><span id="LazyDeepMTS-454"><a href="#LazyDeepMTS-454"><span class="linenos">454</span></a>
</span><span id="LazyDeepMTS-455"><a href="#LazyDeepMTS-455"><span class="linenos">455</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyDeepMTS-456"><a href="#LazyDeepMTS-456"><span class="linenos">456</span></a>                        <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">[</span><span class="s2">&quot;regressor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyDeepMTS-457"><a href="#LazyDeepMTS-457"><span class="linenos">457</span></a>                            <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyDeepMTS-458"><a href="#LazyDeepMTS-458"><span class="linenos">458</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS-459"><a href="#LazyDeepMTS-459"><span class="linenos">459</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS-460"><a href="#LazyDeepMTS-460"><span class="linenos">460</span></a>                        <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyDeepMTS-461"><a href="#LazyDeepMTS-461"><span class="linenos">461</span></a>                            <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyDeepMTS-462"><a href="#LazyDeepMTS-462"><span class="linenos">462</span></a>                        <span class="p">)</span>  <span class="c1"># X_pred = pipe.predict(h=X_test.shape[0], new_xreg=new_xreg) ## DO xreg like in `ahead`</span>
</span><span id="LazyDeepMTS-463"><a href="#LazyDeepMTS-463"><span class="linenos">463</span></a>
</span><span id="LazyDeepMTS-464"><a href="#LazyDeepMTS-464"><span class="linenos">464</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyDeepMTS-465"><a href="#LazyDeepMTS-465"><span class="linenos">465</span></a>                    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS-466"><a href="#LazyDeepMTS-466"><span class="linenos">466</span></a>                    <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS-467"><a href="#LazyDeepMTS-467"><span class="linenos">467</span></a>
</span><span id="LazyDeepMTS-468"><a href="#LazyDeepMTS-468"><span class="linenos">468</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepMTS-469"><a href="#LazyDeepMTS-469"><span class="linenos">469</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyDeepMTS-470"><a href="#LazyDeepMTS-470"><span class="linenos">470</span></a>                    <span class="n">MAE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</span><span id="LazyDeepMTS-471"><a href="#LazyDeepMTS-471"><span class="linenos">471</span></a>                    <span class="n">MPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpl</span><span class="p">)</span>
</span><span id="LazyDeepMTS-472"><a href="#LazyDeepMTS-472"><span class="linenos">472</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepMTS-473"><a href="#LazyDeepMTS-473"><span class="linenos">473</span></a>
</span><span id="LazyDeepMTS-474"><a href="#LazyDeepMTS-474"><span class="linenos">474</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS-475"><a href="#LazyDeepMTS-475"><span class="linenos">475</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS-476"><a href="#LazyDeepMTS-476"><span class="linenos">476</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepMTS-477"><a href="#LazyDeepMTS-477"><span class="linenos">477</span></a>
</span><span id="LazyDeepMTS-478"><a href="#LazyDeepMTS-478"><span class="linenos">478</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepMTS-479"><a href="#LazyDeepMTS-479"><span class="linenos">479</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS-480"><a href="#LazyDeepMTS-480"><span class="linenos">480</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepMTS-481"><a href="#LazyDeepMTS-481"><span class="linenos">481</span></a>                            <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyDeepMTS-482"><a href="#LazyDeepMTS-482"><span class="linenos">482</span></a>                            <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyDeepMTS-483"><a href="#LazyDeepMTS-483"><span class="linenos">483</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepMTS-484"><a href="#LazyDeepMTS-484"><span class="linenos">484</span></a>                            <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyDeepMTS-485"><a href="#LazyDeepMTS-485"><span class="linenos">485</span></a>                            <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyDeepMTS-486"><a href="#LazyDeepMTS-486"><span class="linenos">486</span></a>                            <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyDeepMTS-487"><a href="#LazyDeepMTS-487"><span class="linenos">487</span></a>                            <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyDeepMTS-488"><a href="#LazyDeepMTS-488"><span class="linenos">488</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepMTS-489"><a href="#LazyDeepMTS-489"><span class="linenos">489</span></a>                        <span class="p">}</span>
</span><span id="LazyDeepMTS-490"><a href="#LazyDeepMTS-490"><span class="linenos">490</span></a>
</span><span id="LazyDeepMTS-491"><a href="#LazyDeepMTS-491"><span class="linenos">491</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS-492"><a href="#LazyDeepMTS-492"><span class="linenos">492</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepMTS-493"><a href="#LazyDeepMTS-493"><span class="linenos">493</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyDeepMTS-494"><a href="#LazyDeepMTS-494"><span class="linenos">494</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepMTS-495"><a href="#LazyDeepMTS-495"><span class="linenos">495</span></a>
</span><span id="LazyDeepMTS-496"><a href="#LazyDeepMTS-496"><span class="linenos">496</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyDeepMTS-497"><a href="#LazyDeepMTS-497"><span class="linenos">497</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepMTS-498"><a href="#LazyDeepMTS-498"><span class="linenos">498</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_pred</span>
</span><span id="LazyDeepMTS-499"><a href="#LazyDeepMTS-499"><span class="linenos">499</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepMTS-500"><a href="#LazyDeepMTS-500"><span class="linenos">500</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepMTS-501"><a href="#LazyDeepMTS-501"><span class="linenos">501</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepMTS-502"><a href="#LazyDeepMTS-502"><span class="linenos">502</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepMTS-503"><a href="#LazyDeepMTS-503"><span class="linenos">503</span></a>
</span><span id="LazyDeepMTS-504"><a href="#LazyDeepMTS-504"><span class="linenos">504</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS-505"><a href="#LazyDeepMTS-505"><span class="linenos">505</span></a>            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepMTS-506"><a href="#LazyDeepMTS-506"><span class="linenos">506</span></a>            <span class="c1"># &quot;Adjusted R-Squared&quot;: ADJR2,</span>
</span><span id="LazyDeepMTS-507"><a href="#LazyDeepMTS-507"><span class="linenos">507</span></a>            <span class="c1"># &quot;R-Squared&quot;: R2,</span>
</span><span id="LazyDeepMTS-508"><a href="#LazyDeepMTS-508"><span class="linenos">508</span></a>            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyDeepMTS-509"><a href="#LazyDeepMTS-509"><span class="linenos">509</span></a>            <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">MAE</span><span class="p">,</span>
</span><span id="LazyDeepMTS-510"><a href="#LazyDeepMTS-510"><span class="linenos">510</span></a>            <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">MPL</span><span class="p">,</span>
</span><span id="LazyDeepMTS-511"><a href="#LazyDeepMTS-511"><span class="linenos">511</span></a>            <span class="c1"># &quot;MPE&quot;: MPE,</span>
</span><span id="LazyDeepMTS-512"><a href="#LazyDeepMTS-512"><span class="linenos">512</span></a>            <span class="c1"># &quot;MAPE&quot;: MAPE,</span>
</span><span id="LazyDeepMTS-513"><a href="#LazyDeepMTS-513"><span class="linenos">513</span></a>            <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepMTS-514"><a href="#LazyDeepMTS-514"><span class="linenos">514</span></a>        <span class="p">}</span>
</span><span id="LazyDeepMTS-515"><a href="#LazyDeepMTS-515"><span class="linenos">515</span></a>
</span><span id="LazyDeepMTS-516"><a href="#LazyDeepMTS-516"><span class="linenos">516</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS-517"><a href="#LazyDeepMTS-517"><span class="linenos">517</span></a>            <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">CUSTOM_METRIC</span>
</span><span id="LazyDeepMTS-518"><a href="#LazyDeepMTS-518"><span class="linenos">518</span></a>
</span><span id="LazyDeepMTS-519"><a href="#LazyDeepMTS-519"><span class="linenos">519</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LazyDeepMTS-520"><a href="#LazyDeepMTS-520"><span class="linenos">520</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyDeepMTS-521"><a href="#LazyDeepMTS-521"><span class="linenos">521</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyDeepMTS-522"><a href="#LazyDeepMTS-522"><span class="linenos">522</span></a>        <span class="p">)</span>
</span><span id="LazyDeepMTS-523"><a href="#LazyDeepMTS-523"><span class="linenos">523</span></a>
</span><span id="LazyDeepMTS-524"><a href="#LazyDeepMTS-524"><span class="linenos">524</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepMTS-525"><a href="#LazyDeepMTS-525"><span class="linenos">525</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyDeepMTS-526"><a href="#LazyDeepMTS-526"><span class="linenos">526</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span><span id="LazyDeepMTS-527"><a href="#LazyDeepMTS-527"><span class="linenos">527</span></a>
</span><span id="LazyDeepMTS-528"><a href="#LazyDeepMTS-528"><span class="linenos">528</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">):</span>
</span><span id="LazyDeepMTS-529"><a href="#LazyDeepMTS-529"><span class="linenos">529</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyDeepMTS-530"><a href="#LazyDeepMTS-530"><span class="linenos">530</span></a><span class="sd">        This function returns all the model objects trained in fit function.</span>
</span><span id="LazyDeepMTS-531"><a href="#LazyDeepMTS-531"><span class="linenos">531</span></a><span class="sd">        If fit is not called already, then we call fit and then return the models.</span>
</span><span id="LazyDeepMTS-532"><a href="#LazyDeepMTS-532"><span class="linenos">532</span></a>
</span><span id="LazyDeepMTS-533"><a href="#LazyDeepMTS-533"><span class="linenos">533</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepMTS-534"><a href="#LazyDeepMTS-534"><span class="linenos">534</span></a>
</span><span id="LazyDeepMTS-535"><a href="#LazyDeepMTS-535"><span class="linenos">535</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyDeepMTS-536"><a href="#LazyDeepMTS-536"><span class="linenos">536</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepMTS-537"><a href="#LazyDeepMTS-537"><span class="linenos">537</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepMTS-538"><a href="#LazyDeepMTS-538"><span class="linenos">538</span></a>
</span><span id="LazyDeepMTS-539"><a href="#LazyDeepMTS-539"><span class="linenos">539</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyDeepMTS-540"><a href="#LazyDeepMTS-540"><span class="linenos">540</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepMTS-541"><a href="#LazyDeepMTS-541"><span class="linenos">541</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepMTS-542"><a href="#LazyDeepMTS-542"><span class="linenos">542</span></a>
</span><span id="LazyDeepMTS-543"><a href="#LazyDeepMTS-543"><span class="linenos">543</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepMTS-544"><a href="#LazyDeepMTS-544"><span class="linenos">544</span></a>
</span><span id="LazyDeepMTS-545"><a href="#LazyDeepMTS-545"><span class="linenos">545</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyDeepMTS-546"><a href="#LazyDeepMTS-546"><span class="linenos">546</span></a><span class="sd">                Returns a dictionary with each model pipeline as value</span>
</span><span id="LazyDeepMTS-547"><a href="#LazyDeepMTS-547"><span class="linenos">547</span></a><span class="sd">                with key as name of models.</span>
</span><span id="LazyDeepMTS-548"><a href="#LazyDeepMTS-548"><span class="linenos">548</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepMTS-549"><a href="#LazyDeepMTS-549"><span class="linenos">549</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepMTS-550"><a href="#LazyDeepMTS-550"><span class="linenos">550</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepMTS-551"><a href="#LazyDeepMTS-551"><span class="linenos">551</span></a>
</span><span id="LazyDeepMTS-552"><a href="#LazyDeepMTS-552"><span class="linenos">552</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>Fitting -- almost -- all the regression algorithms with layers of
    nnetsauce's CustomRegressor to multivariate time series
    and returning their scores.</p>

<p>Parameters:</p>

<pre><code>verbose: int, optional (default=0)
    Any positive number for verbosity.

ignore_warnings: bool, optional (default=True)
    When set to True, the warning related to algorigms that are not
    able to run are ignored.

custom_metric: function, optional (default=None)
    When function is provided, models are evaluated based on the
    custom evaluation metric provided.

predictions: bool, optional (default=False)
    When set to True, the predictions of all the models models are
    returned as dataframe.

sort_by: string, optional (default='RMSE')
    Sort models by a metric. Available options are 'RMSE', 'MAE',
    'MPL', 'MPE', 'MAPE', 'R-Squared', 'Adjusted R-Squared' or
    a custom metric identified by its name and
    provided by custom_metric.

random_state: int, optional (default=42)
    Reproducibiility seed.

estimators: list, optional (default='all')
    list of Estimators (regression algorithms) names or just
    'all' (default='all')

preprocess: bool, preprocessing is done when set to True

n_jobs : int, when possible, run in parallel
    For now, only used by individual models that support it.

n_layers: int, optional (default=3)
    Number of layers of CustomRegressors to be used.

All the other parameters are the same as MTS's.
</code></pre>

<p>Examples</p>

<pre><code>See https://github.com/Techtonique/nnetsauce/blob/master/nnetsauce/demo/thierrymoudiki_20240106_LazyDeepMTS.ipynb
</code></pre>
</div>


                                <div id="LazyDeepMTS.fit" class="classattr">
                                            <input id="LazyDeepMTS.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span>, </span><span class="param"><span class="n">xreg</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyDeepMTS.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepMTS.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepMTS.fit-190"><a href="#LazyDeepMTS.fit-190"><span class="linenos">190</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">xreg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="LazyDeepMTS.fit-191"><a href="#LazyDeepMTS.fit-191"><span class="linenos">191</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit Regression algorithms to X_train, predict and score on X_test.</span>
</span><span id="LazyDeepMTS.fit-192"><a href="#LazyDeepMTS.fit-192"><span class="linenos">192</span></a>
</span><span id="LazyDeepMTS.fit-193"><a href="#LazyDeepMTS.fit-193"><span class="linenos">193</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepMTS.fit-194"><a href="#LazyDeepMTS.fit-194"><span class="linenos">194</span></a>
</span><span id="LazyDeepMTS.fit-195"><a href="#LazyDeepMTS.fit-195"><span class="linenos">195</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyDeepMTS.fit-196"><a href="#LazyDeepMTS.fit-196"><span class="linenos">196</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepMTS.fit-197"><a href="#LazyDeepMTS.fit-197"><span class="linenos">197</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepMTS.fit-198"><a href="#LazyDeepMTS.fit-198"><span class="linenos">198</span></a>
</span><span id="LazyDeepMTS.fit-199"><a href="#LazyDeepMTS.fit-199"><span class="linenos">199</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyDeepMTS.fit-200"><a href="#LazyDeepMTS.fit-200"><span class="linenos">200</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepMTS.fit-201"><a href="#LazyDeepMTS.fit-201"><span class="linenos">201</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepMTS.fit-202"><a href="#LazyDeepMTS.fit-202"><span class="linenos">202</span></a>
</span><span id="LazyDeepMTS.fit-203"><a href="#LazyDeepMTS.fit-203"><span class="linenos">203</span></a><span class="sd">            xreg: {array-like}, shape = [n_samples, n_features_xreg]</span>
</span><span id="LazyDeepMTS.fit-204"><a href="#LazyDeepMTS.fit-204"><span class="linenos">204</span></a><span class="sd">                Additional (external) regressors to be passed to self.obj</span>
</span><span id="LazyDeepMTS.fit-205"><a href="#LazyDeepMTS.fit-205"><span class="linenos">205</span></a><span class="sd">                xreg must be in &#39;increasing&#39; order (most recent observations last)</span>
</span><span id="LazyDeepMTS.fit-206"><a href="#LazyDeepMTS.fit-206"><span class="linenos">206</span></a>
</span><span id="LazyDeepMTS.fit-207"><a href="#LazyDeepMTS.fit-207"><span class="linenos">207</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepMTS.fit-208"><a href="#LazyDeepMTS.fit-208"><span class="linenos">208</span></a>
</span><span id="LazyDeepMTS.fit-209"><a href="#LazyDeepMTS.fit-209"><span class="linenos">209</span></a><span class="sd">            scores : Pandas DataFrame</span>
</span><span id="LazyDeepMTS.fit-210"><a href="#LazyDeepMTS.fit-210"><span class="linenos">210</span></a><span class="sd">                Returns metrics of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepMTS.fit-211"><a href="#LazyDeepMTS.fit-211"><span class="linenos">211</span></a>
</span><span id="LazyDeepMTS.fit-212"><a href="#LazyDeepMTS.fit-212"><span class="linenos">212</span></a><span class="sd">            predictions : Pandas DataFrame</span>
</span><span id="LazyDeepMTS.fit-213"><a href="#LazyDeepMTS.fit-213"><span class="linenos">213</span></a><span class="sd">                Returns predictions of all the models in a Pandas DataFrame.</span>
</span><span id="LazyDeepMTS.fit-214"><a href="#LazyDeepMTS.fit-214"><span class="linenos">214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepMTS.fit-215"><a href="#LazyDeepMTS.fit-215"><span class="linenos">215</span></a>        <span class="n">R2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-216"><a href="#LazyDeepMTS.fit-216"><span class="linenos">216</span></a>        <span class="n">ADJR2</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-217"><a href="#LazyDeepMTS.fit-217"><span class="linenos">217</span></a>        <span class="n">ME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-218"><a href="#LazyDeepMTS.fit-218"><span class="linenos">218</span></a>        <span class="n">MPL</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-219"><a href="#LazyDeepMTS.fit-219"><span class="linenos">219</span></a>        <span class="n">RMSE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-220"><a href="#LazyDeepMTS.fit-220"><span class="linenos">220</span></a>        <span class="n">MAE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-221"><a href="#LazyDeepMTS.fit-221"><span class="linenos">221</span></a>        <span class="n">MPE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-222"><a href="#LazyDeepMTS.fit-222"><span class="linenos">222</span></a>        <span class="n">MAPE</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-223"><a href="#LazyDeepMTS.fit-223"><span class="linenos">223</span></a>
</span><span id="LazyDeepMTS.fit-224"><a href="#LazyDeepMTS.fit-224"><span class="linenos">224</span></a>        <span class="c1"># WIN = []</span>
</span><span id="LazyDeepMTS.fit-225"><a href="#LazyDeepMTS.fit-225"><span class="linenos">225</span></a>        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-226"><a href="#LazyDeepMTS.fit-226"><span class="linenos">226</span></a>        <span class="n">TIME</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-227"><a href="#LazyDeepMTS.fit-227"><span class="linenos">227</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LazyDeepMTS.fit-228"><a href="#LazyDeepMTS.fit-228"><span class="linenos">228</span></a>
</span><span id="LazyDeepMTS.fit-229"><a href="#LazyDeepMTS.fit-229"><span class="linenos">229</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-230"><a href="#LazyDeepMTS.fit-230"><span class="linenos">230</span></a>            <span class="n">CUSTOM_METRIC</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LazyDeepMTS.fit-231"><a href="#LazyDeepMTS.fit-231"><span class="linenos">231</span></a>
</span><span id="LazyDeepMTS.fit-232"><a href="#LazyDeepMTS.fit-232"><span class="linenos">232</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="LazyDeepMTS.fit-233"><a href="#LazyDeepMTS.fit-233"><span class="linenos">233</span></a>            <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-234"><a href="#LazyDeepMTS.fit-234"><span class="linenos">234</span></a>            <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-235"><a href="#LazyDeepMTS.fit-235"><span class="linenos">235</span></a>
</span><span id="LazyDeepMTS.fit-236"><a href="#LazyDeepMTS.fit-236"><span class="linenos">236</span></a>        <span class="n">X_train</span> <span class="o">=</span> <span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-237"><a href="#LazyDeepMTS.fit-237"><span class="linenos">237</span></a>        <span class="n">X_test</span> <span class="o">=</span> <span class="n">convert_df_to_numeric</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-238"><a href="#LazyDeepMTS.fit-238"><span class="linenos">238</span></a>
</span><span id="LazyDeepMTS.fit-239"><a href="#LazyDeepMTS.fit-239"><span class="linenos">239</span></a>        <span class="n">numeric_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepMTS.fit-240"><a href="#LazyDeepMTS.fit-240"><span class="linenos">240</span></a>        <span class="n">categorical_features</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;object&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
</span><span id="LazyDeepMTS.fit-241"><a href="#LazyDeepMTS.fit-241"><span class="linenos">241</span></a>
</span><span id="LazyDeepMTS.fit-242"><a href="#LazyDeepMTS.fit-242"><span class="linenos">242</span></a>        <span class="n">categorical_low</span><span class="p">,</span> <span class="n">categorical_high</span> <span class="o">=</span> <span class="n">get_card_split</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-243"><a href="#LazyDeepMTS.fit-243"><span class="linenos">243</span></a>            <span class="n">X_train</span><span class="p">,</span> <span class="n">categorical_features</span>
</span><span id="LazyDeepMTS.fit-244"><a href="#LazyDeepMTS.fit-244"><span class="linenos">244</span></a>        <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-245"><a href="#LazyDeepMTS.fit-245"><span class="linenos">245</span></a>
</span><span id="LazyDeepMTS.fit-246"><a href="#LazyDeepMTS.fit-246"><span class="linenos">246</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-247"><a href="#LazyDeepMTS.fit-247"><span class="linenos">247</span></a>            <span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-248"><a href="#LazyDeepMTS.fit-248"><span class="linenos">248</span></a>                <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepMTS.fit-249"><a href="#LazyDeepMTS.fit-249"><span class="linenos">249</span></a>                    <span class="p">(</span><span class="s2">&quot;numeric&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">),</span>
</span><span id="LazyDeepMTS.fit-250"><a href="#LazyDeepMTS.fit-250"><span class="linenos">250</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepMTS.fit-251"><a href="#LazyDeepMTS.fit-251"><span class="linenos">251</span></a>                        <span class="s2">&quot;categorical_low&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-252"><a href="#LazyDeepMTS.fit-252"><span class="linenos">252</span></a>                        <span class="n">categorical_transformer_low</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-253"><a href="#LazyDeepMTS.fit-253"><span class="linenos">253</span></a>                        <span class="n">categorical_low</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-254"><a href="#LazyDeepMTS.fit-254"><span class="linenos">254</span></a>                    <span class="p">),</span>
</span><span id="LazyDeepMTS.fit-255"><a href="#LazyDeepMTS.fit-255"><span class="linenos">255</span></a>                    <span class="p">(</span>
</span><span id="LazyDeepMTS.fit-256"><a href="#LazyDeepMTS.fit-256"><span class="linenos">256</span></a>                        <span class="s2">&quot;categorical_high&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-257"><a href="#LazyDeepMTS.fit-257"><span class="linenos">257</span></a>                        <span class="n">categorical_transformer_high</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-258"><a href="#LazyDeepMTS.fit-258"><span class="linenos">258</span></a>                        <span class="n">categorical_high</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-259"><a href="#LazyDeepMTS.fit-259"><span class="linenos">259</span></a>                    <span class="p">),</span>
</span><span id="LazyDeepMTS.fit-260"><a href="#LazyDeepMTS.fit-260"><span class="linenos">260</span></a>                <span class="p">]</span>
</span><span id="LazyDeepMTS.fit-261"><a href="#LazyDeepMTS.fit-261"><span class="linenos">261</span></a>            <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-262"><a href="#LazyDeepMTS.fit-262"><span class="linenos">262</span></a>
</span><span id="LazyDeepMTS.fit-263"><a href="#LazyDeepMTS.fit-263"><span class="linenos">263</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-264"><a href="#LazyDeepMTS.fit-264"><span class="linenos">264</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="n">DEEPREGRESSORSMTS</span>
</span><span id="LazyDeepMTS.fit-265"><a href="#LazyDeepMTS.fit-265"><span class="linenos">265</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-266"><a href="#LazyDeepMTS.fit-266"><span class="linenos">266</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="LazyDeepMTS.fit-267"><a href="#LazyDeepMTS.fit-267"><span class="linenos">267</span></a>                <span class="p">(</span><span class="s2">&quot;DeepMTS(&quot;</span> <span class="o">+</span> <span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="LazyDeepMTS.fit-268"><a href="#LazyDeepMTS.fit-268"><span class="linenos">268</span></a>                <span class="k">for</span> <span class="n">est</span> <span class="ow">in</span> <span class="n">all_estimators</span><span class="p">()</span>
</span><span id="LazyDeepMTS.fit-269"><a href="#LazyDeepMTS.fit-269"><span class="linenos">269</span></a>                <span class="k">if</span> <span class="p">(</span>
</span><span id="LazyDeepMTS.fit-270"><a href="#LazyDeepMTS.fit-270"><span class="linenos">270</span></a>                    <span class="nb">issubclass</span><span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">RegressorMixin</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-271"><a href="#LazyDeepMTS.fit-271"><span class="linenos">271</span></a>                    <span class="ow">and</span> <span class="p">(</span><span class="n">est</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimators</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-272"><a href="#LazyDeepMTS.fit-272"><span class="linenos">272</span></a>                <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-273"><a href="#LazyDeepMTS.fit-273"><span class="linenos">273</span></a>            <span class="p">]</span>
</span><span id="LazyDeepMTS.fit-274"><a href="#LazyDeepMTS.fit-274"><span class="linenos">274</span></a>
</span><span id="LazyDeepMTS.fit-275"><a href="#LazyDeepMTS.fit-275"><span class="linenos">275</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-276"><a href="#LazyDeepMTS.fit-276"><span class="linenos">276</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepMTS.fit-277"><a href="#LazyDeepMTS.fit-277"><span class="linenos">277</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepMTS.fit-278"><a href="#LazyDeepMTS.fit-278"><span class="linenos">278</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-279"><a href="#LazyDeepMTS.fit-279"><span class="linenos">279</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepMTS.fit-280"><a href="#LazyDeepMTS.fit-280"><span class="linenos">280</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-281"><a href="#LazyDeepMTS.fit-281"><span class="linenos">281</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepMTS.fit-282"><a href="#LazyDeepMTS.fit-282"><span class="linenos">282</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyDeepMTS.fit-283"><a href="#LazyDeepMTS.fit-283"><span class="linenos">283</span></a>                                <span class="p">(</span>
</span><span id="LazyDeepMTS.fit-284"><a href="#LazyDeepMTS.fit-284"><span class="linenos">284</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-285"><a href="#LazyDeepMTS.fit-285"><span class="linenos">285</span></a>                                    <span class="n">DeepMTS</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-286"><a href="#LazyDeepMTS.fit-286"><span class="linenos">286</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-287"><a href="#LazyDeepMTS.fit-287"><span class="linenos">287</span></a>                                            <span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-288"><a href="#LazyDeepMTS.fit-288"><span class="linenos">288</span></a>                                            <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyDeepMTS.fit-289"><a href="#LazyDeepMTS.fit-289"><span class="linenos">289</span></a>                                        <span class="p">),</span>
</span><span id="LazyDeepMTS.fit-290"><a href="#LazyDeepMTS.fit-290"><span class="linenos">290</span></a>                                        <span class="n">n_layers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-291"><a href="#LazyDeepMTS.fit-291"><span class="linenos">291</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-292"><a href="#LazyDeepMTS.fit-292"><span class="linenos">292</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-293"><a href="#LazyDeepMTS.fit-293"><span class="linenos">293</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-294"><a href="#LazyDeepMTS.fit-294"><span class="linenos">294</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-295"><a href="#LazyDeepMTS.fit-295"><span class="linenos">295</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-296"><a href="#LazyDeepMTS.fit-296"><span class="linenos">296</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-297"><a href="#LazyDeepMTS.fit-297"><span class="linenos">297</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-298"><a href="#LazyDeepMTS.fit-298"><span class="linenos">298</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-299"><a href="#LazyDeepMTS.fit-299"><span class="linenos">299</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-300"><a href="#LazyDeepMTS.fit-300"><span class="linenos">300</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-301"><a href="#LazyDeepMTS.fit-301"><span class="linenos">301</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-302"><a href="#LazyDeepMTS.fit-302"><span class="linenos">302</span></a>                                        <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-303"><a href="#LazyDeepMTS.fit-303"><span class="linenos">303</span></a>                                        <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-304"><a href="#LazyDeepMTS.fit-304"><span class="linenos">304</span></a>                                        <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-305"><a href="#LazyDeepMTS.fit-305"><span class="linenos">305</span></a>                                        <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-306"><a href="#LazyDeepMTS.fit-306"><span class="linenos">306</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-307"><a href="#LazyDeepMTS.fit-307"><span class="linenos">307</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-308"><a href="#LazyDeepMTS.fit-308"><span class="linenos">308</span></a>                                        <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-309"><a href="#LazyDeepMTS.fit-309"><span class="linenos">309</span></a>                                    <span class="p">),</span>
</span><span id="LazyDeepMTS.fit-310"><a href="#LazyDeepMTS.fit-310"><span class="linenos">310</span></a>                                <span class="p">),</span>
</span><span id="LazyDeepMTS.fit-311"><a href="#LazyDeepMTS.fit-311"><span class="linenos">311</span></a>                            <span class="p">]</span>
</span><span id="LazyDeepMTS.fit-312"><a href="#LazyDeepMTS.fit-312"><span class="linenos">312</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-313"><a href="#LazyDeepMTS.fit-313"><span class="linenos">313</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-314"><a href="#LazyDeepMTS.fit-314"><span class="linenos">314</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-315"><a href="#LazyDeepMTS.fit-315"><span class="linenos">315</span></a>                            <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
</span><span id="LazyDeepMTS.fit-316"><a href="#LazyDeepMTS.fit-316"><span class="linenos">316</span></a>                                <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
</span><span id="LazyDeepMTS.fit-317"><a href="#LazyDeepMTS.fit-317"><span class="linenos">317</span></a>                                <span class="p">(</span>
</span><span id="LazyDeepMTS.fit-318"><a href="#LazyDeepMTS.fit-318"><span class="linenos">318</span></a>                                    <span class="s2">&quot;regressor&quot;</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-319"><a href="#LazyDeepMTS.fit-319"><span class="linenos">319</span></a>                                    <span class="n">DeepMTS</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-320"><a href="#LazyDeepMTS.fit-320"><span class="linenos">320</span></a>                                        <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyDeepMTS.fit-321"><a href="#LazyDeepMTS.fit-321"><span class="linenos">321</span></a>                                        <span class="n">n_layers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_layers</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-322"><a href="#LazyDeepMTS.fit-322"><span class="linenos">322</span></a>                                        <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-323"><a href="#LazyDeepMTS.fit-323"><span class="linenos">323</span></a>                                        <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-324"><a href="#LazyDeepMTS.fit-324"><span class="linenos">324</span></a>                                        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-325"><a href="#LazyDeepMTS.fit-325"><span class="linenos">325</span></a>                                        <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-326"><a href="#LazyDeepMTS.fit-326"><span class="linenos">326</span></a>                                        <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-327"><a href="#LazyDeepMTS.fit-327"><span class="linenos">327</span></a>                                        <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-328"><a href="#LazyDeepMTS.fit-328"><span class="linenos">328</span></a>                                        <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-329"><a href="#LazyDeepMTS.fit-329"><span class="linenos">329</span></a>                                        <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-330"><a href="#LazyDeepMTS.fit-330"><span class="linenos">330</span></a>                                        <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-331"><a href="#LazyDeepMTS.fit-331"><span class="linenos">331</span></a>                                        <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-332"><a href="#LazyDeepMTS.fit-332"><span class="linenos">332</span></a>                                        <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-333"><a href="#LazyDeepMTS.fit-333"><span class="linenos">333</span></a>                                        <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-334"><a href="#LazyDeepMTS.fit-334"><span class="linenos">334</span></a>                                        <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-335"><a href="#LazyDeepMTS.fit-335"><span class="linenos">335</span></a>                                        <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-336"><a href="#LazyDeepMTS.fit-336"><span class="linenos">336</span></a>                                        <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-337"><a href="#LazyDeepMTS.fit-337"><span class="linenos">337</span></a>                                        <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-338"><a href="#LazyDeepMTS.fit-338"><span class="linenos">338</span></a>                                        <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-339"><a href="#LazyDeepMTS.fit-339"><span class="linenos">339</span></a>                                        <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-340"><a href="#LazyDeepMTS.fit-340"><span class="linenos">340</span></a>                                    <span class="p">),</span>
</span><span id="LazyDeepMTS.fit-341"><a href="#LazyDeepMTS.fit-341"><span class="linenos">341</span></a>                                <span class="p">),</span>
</span><span id="LazyDeepMTS.fit-342"><a href="#LazyDeepMTS.fit-342"><span class="linenos">342</span></a>                            <span class="p">]</span>
</span><span id="LazyDeepMTS.fit-343"><a href="#LazyDeepMTS.fit-343"><span class="linenos">343</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-344"><a href="#LazyDeepMTS.fit-344"><span class="linenos">344</span></a>
</span><span id="LazyDeepMTS.fit-345"><a href="#LazyDeepMTS.fit-345"><span class="linenos">345</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-346"><a href="#LazyDeepMTS.fit-346"><span class="linenos">346</span></a>                    <span class="c1"># pipe.fit(X_train, xreg=xreg)</span>
</span><span id="LazyDeepMTS.fit-347"><a href="#LazyDeepMTS.fit-347"><span class="linenos">347</span></a>
</span><span id="LazyDeepMTS.fit-348"><a href="#LazyDeepMTS.fit-348"><span class="linenos">348</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyDeepMTS.fit-349"><a href="#LazyDeepMTS.fit-349"><span class="linenos">349</span></a>                    <span class="k">if</span> <span class="n">xreg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-350"><a href="#LazyDeepMTS.fit-350"><span class="linenos">350</span></a>                        <span class="k">assert</span> <span class="p">(</span>
</span><span id="LazyDeepMTS.fit-351"><a href="#LazyDeepMTS.fit-351"><span class="linenos">351</span></a>                            <span class="n">new_xreg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="LazyDeepMTS.fit-352"><a href="#LazyDeepMTS.fit-352"><span class="linenos">352</span></a>                        <span class="p">),</span> <span class="s2">&quot;xreg and new_xreg must be provided&quot;</span>
</span><span id="LazyDeepMTS.fit-353"><a href="#LazyDeepMTS.fit-353"><span class="linenos">353</span></a>                    <span class="c1"># X_pred = pipe.predict(h=X_test.shape[0], new_xreg=new_xreg)</span>
</span><span id="LazyDeepMTS.fit-354"><a href="#LazyDeepMTS.fit-354"><span class="linenos">354</span></a>                    <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">[</span><span class="s2">&quot;regressor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-355"><a href="#LazyDeepMTS.fit-355"><span class="linenos">355</span></a>                        <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyDeepMTS.fit-356"><a href="#LazyDeepMTS.fit-356"><span class="linenos">356</span></a>                    <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-357"><a href="#LazyDeepMTS.fit-357"><span class="linenos">357</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-358"><a href="#LazyDeepMTS.fit-358"><span class="linenos">358</span></a>                    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-359"><a href="#LazyDeepMTS.fit-359"><span class="linenos">359</span></a>                    <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-360"><a href="#LazyDeepMTS.fit-360"><span class="linenos">360</span></a>
</span><span id="LazyDeepMTS.fit-361"><a href="#LazyDeepMTS.fit-361"><span class="linenos">361</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-362"><a href="#LazyDeepMTS.fit-362"><span class="linenos">362</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-363"><a href="#LazyDeepMTS.fit-363"><span class="linenos">363</span></a>                    <span class="n">MAE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-364"><a href="#LazyDeepMTS.fit-364"><span class="linenos">364</span></a>                    <span class="n">MPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpl</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-365"><a href="#LazyDeepMTS.fit-365"><span class="linenos">365</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-366"><a href="#LazyDeepMTS.fit-366"><span class="linenos">366</span></a>
</span><span id="LazyDeepMTS.fit-367"><a href="#LazyDeepMTS.fit-367"><span class="linenos">367</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-368"><a href="#LazyDeepMTS.fit-368"><span class="linenos">368</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-369"><a href="#LazyDeepMTS.fit-369"><span class="linenos">369</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-370"><a href="#LazyDeepMTS.fit-370"><span class="linenos">370</span></a>
</span><span id="LazyDeepMTS.fit-371"><a href="#LazyDeepMTS.fit-371"><span class="linenos">371</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-372"><a href="#LazyDeepMTS.fit-372"><span class="linenos">372</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS.fit-373"><a href="#LazyDeepMTS.fit-373"><span class="linenos">373</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-374"><a href="#LazyDeepMTS.fit-374"><span class="linenos">374</span></a>                            <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyDeepMTS.fit-375"><a href="#LazyDeepMTS.fit-375"><span class="linenos">375</span></a>                            <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyDeepMTS.fit-376"><a href="#LazyDeepMTS.fit-376"><span class="linenos">376</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-377"><a href="#LazyDeepMTS.fit-377"><span class="linenos">377</span></a>                            <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-378"><a href="#LazyDeepMTS.fit-378"><span class="linenos">378</span></a>                            <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-379"><a href="#LazyDeepMTS.fit-379"><span class="linenos">379</span></a>                            <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyDeepMTS.fit-380"><a href="#LazyDeepMTS.fit-380"><span class="linenos">380</span></a>                            <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyDeepMTS.fit-381"><a href="#LazyDeepMTS.fit-381"><span class="linenos">381</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-382"><a href="#LazyDeepMTS.fit-382"><span class="linenos">382</span></a>                        <span class="p">}</span>
</span><span id="LazyDeepMTS.fit-383"><a href="#LazyDeepMTS.fit-383"><span class="linenos">383</span></a>
</span><span id="LazyDeepMTS.fit-384"><a href="#LazyDeepMTS.fit-384"><span class="linenos">384</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-385"><a href="#LazyDeepMTS.fit-385"><span class="linenos">385</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepMTS.fit-386"><a href="#LazyDeepMTS.fit-386"><span class="linenos">386</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyDeepMTS.fit-387"><a href="#LazyDeepMTS.fit-387"><span class="linenos">387</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-388"><a href="#LazyDeepMTS.fit-388"><span class="linenos">388</span></a>
</span><span id="LazyDeepMTS.fit-389"><a href="#LazyDeepMTS.fit-389"><span class="linenos">389</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-390"><a href="#LazyDeepMTS.fit-390"><span class="linenos">390</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-391"><a href="#LazyDeepMTS.fit-391"><span class="linenos">391</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_pred</span>
</span><span id="LazyDeepMTS.fit-392"><a href="#LazyDeepMTS.fit-392"><span class="linenos">392</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-393"><a href="#LazyDeepMTS.fit-393"><span class="linenos">393</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-394"><a href="#LazyDeepMTS.fit-394"><span class="linenos">394</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-395"><a href="#LazyDeepMTS.fit-395"><span class="linenos">395</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-396"><a href="#LazyDeepMTS.fit-396"><span class="linenos">396</span></a>
</span><span id="LazyDeepMTS.fit-397"><a href="#LazyDeepMTS.fit-397"><span class="linenos">397</span></a>        <span class="k">else</span><span class="p">:</span>  <span class="c1"># no preprocessing</span>
</span><span id="LazyDeepMTS.fit-398"><a href="#LazyDeepMTS.fit-398"><span class="linenos">398</span></a>            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressors</span><span class="p">):</span>  <span class="c1"># do parallel exec</span>
</span><span id="LazyDeepMTS.fit-399"><a href="#LazyDeepMTS.fit-399"><span class="linenos">399</span></a>                <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="LazyDeepMTS.fit-400"><a href="#LazyDeepMTS.fit-400"><span class="linenos">400</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-401"><a href="#LazyDeepMTS.fit-401"><span class="linenos">401</span></a>                    <span class="k">if</span> <span class="s2">&quot;random_state&quot;</span> <span class="ow">in</span> <span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LazyDeepMTS.fit-402"><a href="#LazyDeepMTS.fit-402"><span class="linenos">402</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">DeepMTS</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-403"><a href="#LazyDeepMTS.fit-403"><span class="linenos">403</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyDeepMTS.fit-404"><a href="#LazyDeepMTS.fit-404"><span class="linenos">404</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-405"><a href="#LazyDeepMTS.fit-405"><span class="linenos">405</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-406"><a href="#LazyDeepMTS.fit-406"><span class="linenos">406</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-407"><a href="#LazyDeepMTS.fit-407"><span class="linenos">407</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-408"><a href="#LazyDeepMTS.fit-408"><span class="linenos">408</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-409"><a href="#LazyDeepMTS.fit-409"><span class="linenos">409</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-410"><a href="#LazyDeepMTS.fit-410"><span class="linenos">410</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-411"><a href="#LazyDeepMTS.fit-411"><span class="linenos">411</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-412"><a href="#LazyDeepMTS.fit-412"><span class="linenos">412</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-413"><a href="#LazyDeepMTS.fit-413"><span class="linenos">413</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-414"><a href="#LazyDeepMTS.fit-414"><span class="linenos">414</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-415"><a href="#LazyDeepMTS.fit-415"><span class="linenos">415</span></a>                            <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-416"><a href="#LazyDeepMTS.fit-416"><span class="linenos">416</span></a>                            <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-417"><a href="#LazyDeepMTS.fit-417"><span class="linenos">417</span></a>                            <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-418"><a href="#LazyDeepMTS.fit-418"><span class="linenos">418</span></a>                            <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-419"><a href="#LazyDeepMTS.fit-419"><span class="linenos">419</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-420"><a href="#LazyDeepMTS.fit-420"><span class="linenos">420</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-421"><a href="#LazyDeepMTS.fit-421"><span class="linenos">421</span></a>                            <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-422"><a href="#LazyDeepMTS.fit-422"><span class="linenos">422</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-423"><a href="#LazyDeepMTS.fit-423"><span class="linenos">423</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-424"><a href="#LazyDeepMTS.fit-424"><span class="linenos">424</span></a>                        <span class="n">pipe</span> <span class="o">=</span> <span class="n">DeepMTS</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-425"><a href="#LazyDeepMTS.fit-425"><span class="linenos">425</span></a>                            <span class="n">obj</span><span class="o">=</span><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="LazyDeepMTS.fit-426"><a href="#LazyDeepMTS.fit-426"><span class="linenos">426</span></a>                            <span class="n">n_hidden_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_hidden_features</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-427"><a href="#LazyDeepMTS.fit-427"><span class="linenos">427</span></a>                            <span class="n">activation_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">activation_name</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-428"><a href="#LazyDeepMTS.fit-428"><span class="linenos">428</span></a>                            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-429"><a href="#LazyDeepMTS.fit-429"><span class="linenos">429</span></a>                            <span class="n">nodes_sim</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes_sim</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-430"><a href="#LazyDeepMTS.fit-430"><span class="linenos">430</span></a>                            <span class="n">bias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-431"><a href="#LazyDeepMTS.fit-431"><span class="linenos">431</span></a>                            <span class="n">dropout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-432"><a href="#LazyDeepMTS.fit-432"><span class="linenos">432</span></a>                            <span class="n">direct_link</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">direct_link</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-433"><a href="#LazyDeepMTS.fit-433"><span class="linenos">433</span></a>                            <span class="n">n_clusters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_clusters</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-434"><a href="#LazyDeepMTS.fit-434"><span class="linenos">434</span></a>                            <span class="n">cluster_encode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cluster_encode</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-435"><a href="#LazyDeepMTS.fit-435"><span class="linenos">435</span></a>                            <span class="n">type_clust</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_clust</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-436"><a href="#LazyDeepMTS.fit-436"><span class="linenos">436</span></a>                            <span class="n">type_scaling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">type_scaling</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-437"><a href="#LazyDeepMTS.fit-437"><span class="linenos">437</span></a>                            <span class="n">lags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-438"><a href="#LazyDeepMTS.fit-438"><span class="linenos">438</span></a>                            <span class="n">replications</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">replications</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-439"><a href="#LazyDeepMTS.fit-439"><span class="linenos">439</span></a>                            <span class="n">kernel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-440"><a href="#LazyDeepMTS.fit-440"><span class="linenos">440</span></a>                            <span class="n">agg</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">agg</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-441"><a href="#LazyDeepMTS.fit-441"><span class="linenos">441</span></a>                            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-442"><a href="#LazyDeepMTS.fit-442"><span class="linenos">442</span></a>                            <span class="n">backend</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-443"><a href="#LazyDeepMTS.fit-443"><span class="linenos">443</span></a>                            <span class="n">show_progress</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-444"><a href="#LazyDeepMTS.fit-444"><span class="linenos">444</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-445"><a href="#LazyDeepMTS.fit-445"><span class="linenos">445</span></a>
</span><span id="LazyDeepMTS.fit-446"><a href="#LazyDeepMTS.fit-446"><span class="linenos">446</span></a>                    <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-447"><a href="#LazyDeepMTS.fit-447"><span class="linenos">447</span></a>                    <span class="c1"># pipe.fit(X_train, xreg=xreg) # DO xreg like in `ahead`</span>
</span><span id="LazyDeepMTS.fit-448"><a href="#LazyDeepMTS.fit-448"><span class="linenos">448</span></a>
</span><span id="LazyDeepMTS.fit-449"><a href="#LazyDeepMTS.fit-449"><span class="linenos">449</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pipe</span>
</span><span id="LazyDeepMTS.fit-450"><a href="#LazyDeepMTS.fit-450"><span class="linenos">450</span></a>                    <span class="k">if</span> <span class="n">xreg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-451"><a href="#LazyDeepMTS.fit-451"><span class="linenos">451</span></a>                        <span class="k">assert</span> <span class="p">(</span>
</span><span id="LazyDeepMTS.fit-452"><a href="#LazyDeepMTS.fit-452"><span class="linenos">452</span></a>                            <span class="n">new_xreg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="LazyDeepMTS.fit-453"><a href="#LazyDeepMTS.fit-453"><span class="linenos">453</span></a>                        <span class="p">),</span> <span class="s2">&quot;xreg and new_xreg must be provided&quot;</span>
</span><span id="LazyDeepMTS.fit-454"><a href="#LazyDeepMTS.fit-454"><span class="linenos">454</span></a>
</span><span id="LazyDeepMTS.fit-455"><a href="#LazyDeepMTS.fit-455"><span class="linenos">455</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">preprocess</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-456"><a href="#LazyDeepMTS.fit-456"><span class="linenos">456</span></a>                        <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">[</span><span class="s2">&quot;regressor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-457"><a href="#LazyDeepMTS.fit-457"><span class="linenos">457</span></a>                            <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyDeepMTS.fit-458"><a href="#LazyDeepMTS.fit-458"><span class="linenos">458</span></a>                        <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-459"><a href="#LazyDeepMTS.fit-459"><span class="linenos">459</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-460"><a href="#LazyDeepMTS.fit-460"><span class="linenos">460</span></a>                        <span class="n">X_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-461"><a href="#LazyDeepMTS.fit-461"><span class="linenos">461</span></a>                            <span class="n">h</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LazyDeepMTS.fit-462"><a href="#LazyDeepMTS.fit-462"><span class="linenos">462</span></a>                        <span class="p">)</span>  <span class="c1"># X_pred = pipe.predict(h=X_test.shape[0], new_xreg=new_xreg) ## DO xreg like in `ahead`</span>
</span><span id="LazyDeepMTS.fit-463"><a href="#LazyDeepMTS.fit-463"><span class="linenos">463</span></a>
</span><span id="LazyDeepMTS.fit-464"><a href="#LazyDeepMTS.fit-464"><span class="linenos">464</span></a>                    <span class="n">rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-465"><a href="#LazyDeepMTS.fit-465"><span class="linenos">465</span></a>                    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-466"><a href="#LazyDeepMTS.fit-466"><span class="linenos">466</span></a>                    <span class="n">mpl</span> <span class="o">=</span> <span class="n">mean_pinball_loss</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-467"><a href="#LazyDeepMTS.fit-467"><span class="linenos">467</span></a>
</span><span id="LazyDeepMTS.fit-468"><a href="#LazyDeepMTS.fit-468"><span class="linenos">468</span></a>                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-469"><a href="#LazyDeepMTS.fit-469"><span class="linenos">469</span></a>                    <span class="n">RMSE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-470"><a href="#LazyDeepMTS.fit-470"><span class="linenos">470</span></a>                    <span class="n">MAE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-471"><a href="#LazyDeepMTS.fit-471"><span class="linenos">471</span></a>                    <span class="n">MPL</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpl</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-472"><a href="#LazyDeepMTS.fit-472"><span class="linenos">472</span></a>                    <span class="n">TIME</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-473"><a href="#LazyDeepMTS.fit-473"><span class="linenos">473</span></a>
</span><span id="LazyDeepMTS.fit-474"><a href="#LazyDeepMTS.fit-474"><span class="linenos">474</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-475"><a href="#LazyDeepMTS.fit-475"><span class="linenos">475</span></a>                        <span class="n">custom_metric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_pred</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-476"><a href="#LazyDeepMTS.fit-476"><span class="linenos">476</span></a>                        <span class="n">CUSTOM_METRIC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">custom_metric</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-477"><a href="#LazyDeepMTS.fit-477"><span class="linenos">477</span></a>
</span><span id="LazyDeepMTS.fit-478"><a href="#LazyDeepMTS.fit-478"><span class="linenos">478</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-479"><a href="#LazyDeepMTS.fit-479"><span class="linenos">479</span></a>                        <span class="n">scores_verbose</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS.fit-480"><a href="#LazyDeepMTS.fit-480"><span class="linenos">480</span></a>                            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-481"><a href="#LazyDeepMTS.fit-481"><span class="linenos">481</span></a>                            <span class="c1"># &quot;R-Squared&quot;: r_squared,</span>
</span><span id="LazyDeepMTS.fit-482"><a href="#LazyDeepMTS.fit-482"><span class="linenos">482</span></a>                            <span class="c1"># &quot;Adjusted R-Squared&quot;: adj_rsquared,</span>
</span><span id="LazyDeepMTS.fit-483"><a href="#LazyDeepMTS.fit-483"><span class="linenos">483</span></a>                            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-484"><a href="#LazyDeepMTS.fit-484"><span class="linenos">484</span></a>                            <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-485"><a href="#LazyDeepMTS.fit-485"><span class="linenos">485</span></a>                            <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">mpl</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-486"><a href="#LazyDeepMTS.fit-486"><span class="linenos">486</span></a>                            <span class="c1"># &quot;MPE&quot;: mpe,</span>
</span><span id="LazyDeepMTS.fit-487"><a href="#LazyDeepMTS.fit-487"><span class="linenos">487</span></a>                            <span class="c1"># &quot;MAPE&quot;: mape,</span>
</span><span id="LazyDeepMTS.fit-488"><a href="#LazyDeepMTS.fit-488"><span class="linenos">488</span></a>                            <span class="s2">&quot;Time taken&quot;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-489"><a href="#LazyDeepMTS.fit-489"><span class="linenos">489</span></a>                        <span class="p">}</span>
</span><span id="LazyDeepMTS.fit-490"><a href="#LazyDeepMTS.fit-490"><span class="linenos">490</span></a>
</span><span id="LazyDeepMTS.fit-491"><a href="#LazyDeepMTS.fit-491"><span class="linenos">491</span></a>                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-492"><a href="#LazyDeepMTS.fit-492"><span class="linenos">492</span></a>                            <span class="n">scores_verbose</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="LazyDeepMTS.fit-493"><a href="#LazyDeepMTS.fit-493"><span class="linenos">493</span></a>                                <span class="n">custom_metric</span>
</span><span id="LazyDeepMTS.fit-494"><a href="#LazyDeepMTS.fit-494"><span class="linenos">494</span></a>                            <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-495"><a href="#LazyDeepMTS.fit-495"><span class="linenos">495</span></a>
</span><span id="LazyDeepMTS.fit-496"><a href="#LazyDeepMTS.fit-496"><span class="linenos">496</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">scores_verbose</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-497"><a href="#LazyDeepMTS.fit-497"><span class="linenos">497</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-498"><a href="#LazyDeepMTS.fit-498"><span class="linenos">498</span></a>                        <span class="n">predictions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">X_pred</span>
</span><span id="LazyDeepMTS.fit-499"><a href="#LazyDeepMTS.fit-499"><span class="linenos">499</span></a>                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-500"><a href="#LazyDeepMTS.fit-500"><span class="linenos">500</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignore_warnings</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-501"><a href="#LazyDeepMTS.fit-501"><span class="linenos">501</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; model failed to execute&quot;</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-502"><a href="#LazyDeepMTS.fit-502"><span class="linenos">502</span></a>                        <span class="nb">print</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-503"><a href="#LazyDeepMTS.fit-503"><span class="linenos">503</span></a>
</span><span id="LazyDeepMTS.fit-504"><a href="#LazyDeepMTS.fit-504"><span class="linenos">504</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LazyDeepMTS.fit-505"><a href="#LazyDeepMTS.fit-505"><span class="linenos">505</span></a>            <span class="s2">&quot;Model&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-506"><a href="#LazyDeepMTS.fit-506"><span class="linenos">506</span></a>            <span class="c1"># &quot;Adjusted R-Squared&quot;: ADJR2,</span>
</span><span id="LazyDeepMTS.fit-507"><a href="#LazyDeepMTS.fit-507"><span class="linenos">507</span></a>            <span class="c1"># &quot;R-Squared&quot;: R2,</span>
</span><span id="LazyDeepMTS.fit-508"><a href="#LazyDeepMTS.fit-508"><span class="linenos">508</span></a>            <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="n">RMSE</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-509"><a href="#LazyDeepMTS.fit-509"><span class="linenos">509</span></a>            <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="n">MAE</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-510"><a href="#LazyDeepMTS.fit-510"><span class="linenos">510</span></a>            <span class="s2">&quot;MPL&quot;</span><span class="p">:</span> <span class="n">MPL</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-511"><a href="#LazyDeepMTS.fit-511"><span class="linenos">511</span></a>            <span class="c1"># &quot;MPE&quot;: MPE,</span>
</span><span id="LazyDeepMTS.fit-512"><a href="#LazyDeepMTS.fit-512"><span class="linenos">512</span></a>            <span class="c1"># &quot;MAPE&quot;: MAPE,</span>
</span><span id="LazyDeepMTS.fit-513"><a href="#LazyDeepMTS.fit-513"><span class="linenos">513</span></a>            <span class="s2">&quot;Time Taken&quot;</span><span class="p">:</span> <span class="n">TIME</span><span class="p">,</span>
</span><span id="LazyDeepMTS.fit-514"><a href="#LazyDeepMTS.fit-514"><span class="linenos">514</span></a>        <span class="p">}</span>
</span><span id="LazyDeepMTS.fit-515"><a href="#LazyDeepMTS.fit-515"><span class="linenos">515</span></a>
</span><span id="LazyDeepMTS.fit-516"><a href="#LazyDeepMTS.fit-516"><span class="linenos">516</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-517"><a href="#LazyDeepMTS.fit-517"><span class="linenos">517</span></a>            <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_metric</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">CUSTOM_METRIC</span>
</span><span id="LazyDeepMTS.fit-518"><a href="#LazyDeepMTS.fit-518"><span class="linenos">518</span></a>
</span><span id="LazyDeepMTS.fit-519"><a href="#LazyDeepMTS.fit-519"><span class="linenos">519</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-520"><a href="#LazyDeepMTS.fit-520"><span class="linenos">520</span></a>        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span>
</span><span id="LazyDeepMTS.fit-521"><a href="#LazyDeepMTS.fit-521"><span class="linenos">521</span></a>            <span class="s2">&quot;Model&quot;</span>
</span><span id="LazyDeepMTS.fit-522"><a href="#LazyDeepMTS.fit-522"><span class="linenos">522</span></a>        <span class="p">)</span>
</span><span id="LazyDeepMTS.fit-523"><a href="#LazyDeepMTS.fit-523"><span class="linenos">523</span></a>
</span><span id="LazyDeepMTS.fit-524"><a href="#LazyDeepMTS.fit-524"><span class="linenos">524</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span><span class="p">:</span>
</span><span id="LazyDeepMTS.fit-525"><a href="#LazyDeepMTS.fit-525"><span class="linenos">525</span></a>            <span class="n">predictions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</span><span id="LazyDeepMTS.fit-526"><a href="#LazyDeepMTS.fit-526"><span class="linenos">526</span></a>        <span class="k">return</span> <span class="n">scores</span><span class="p">,</span> <span class="n">predictions_df</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">predictions</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">scores</span>
</span></pre></div>


            <div class="docstring"><p>Fit Regression algorithms to X_train, predict and score on X_test.</p>

<p>Parameters:</p>

<pre><code>X_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.

xreg: {array-like}, shape = [n_samples, n_features_xreg]
    Additional (external) regressors to be passed to self.obj
    xreg must be in 'increasing' order (most recent observations last)
</code></pre>

<p>Returns:</p>

<pre><code>scores : Pandas DataFrame
    Returns metrics of all the models in a Pandas DataFrame.

predictions : Pandas DataFrame
    Returns predictions of all the models in a Pandas DataFrame.
</code></pre>
</div>


                                </div>
                                <div id="LazyDeepMTS.provide_models" class="classattr">
                                            <input id="LazyDeepMTS.provide_models-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">provide_models</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X_train</span>, </span><span class="param"><span class="n">X_test</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LazyDeepMTS.provide_models-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LazyDeepMTS.provide_models"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LazyDeepMTS.provide_models-528"><a href="#LazyDeepMTS.provide_models-528"><span class="linenos">528</span></a>    <span class="k">def</span> <span class="nf">provide_models</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">):</span>
</span><span id="LazyDeepMTS.provide_models-529"><a href="#LazyDeepMTS.provide_models-529"><span class="linenos">529</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LazyDeepMTS.provide_models-530"><a href="#LazyDeepMTS.provide_models-530"><span class="linenos">530</span></a><span class="sd">        This function returns all the model objects trained in fit function.</span>
</span><span id="LazyDeepMTS.provide_models-531"><a href="#LazyDeepMTS.provide_models-531"><span class="linenos">531</span></a><span class="sd">        If fit is not called already, then we call fit and then return the models.</span>
</span><span id="LazyDeepMTS.provide_models-532"><a href="#LazyDeepMTS.provide_models-532"><span class="linenos">532</span></a>
</span><span id="LazyDeepMTS.provide_models-533"><a href="#LazyDeepMTS.provide_models-533"><span class="linenos">533</span></a><span class="sd">        Parameters:</span>
</span><span id="LazyDeepMTS.provide_models-534"><a href="#LazyDeepMTS.provide_models-534"><span class="linenos">534</span></a>
</span><span id="LazyDeepMTS.provide_models-535"><a href="#LazyDeepMTS.provide_models-535"><span class="linenos">535</span></a><span class="sd">            X_train : array-like,</span>
</span><span id="LazyDeepMTS.provide_models-536"><a href="#LazyDeepMTS.provide_models-536"><span class="linenos">536</span></a><span class="sd">                Training vectors, where rows is the number of samples</span>
</span><span id="LazyDeepMTS.provide_models-537"><a href="#LazyDeepMTS.provide_models-537"><span class="linenos">537</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepMTS.provide_models-538"><a href="#LazyDeepMTS.provide_models-538"><span class="linenos">538</span></a>
</span><span id="LazyDeepMTS.provide_models-539"><a href="#LazyDeepMTS.provide_models-539"><span class="linenos">539</span></a><span class="sd">            X_test : array-like,</span>
</span><span id="LazyDeepMTS.provide_models-540"><a href="#LazyDeepMTS.provide_models-540"><span class="linenos">540</span></a><span class="sd">                Testing vectors, where rows is the number of samples</span>
</span><span id="LazyDeepMTS.provide_models-541"><a href="#LazyDeepMTS.provide_models-541"><span class="linenos">541</span></a><span class="sd">                and columns is the number of features.</span>
</span><span id="LazyDeepMTS.provide_models-542"><a href="#LazyDeepMTS.provide_models-542"><span class="linenos">542</span></a>
</span><span id="LazyDeepMTS.provide_models-543"><a href="#LazyDeepMTS.provide_models-543"><span class="linenos">543</span></a><span class="sd">        Returns:</span>
</span><span id="LazyDeepMTS.provide_models-544"><a href="#LazyDeepMTS.provide_models-544"><span class="linenos">544</span></a>
</span><span id="LazyDeepMTS.provide_models-545"><a href="#LazyDeepMTS.provide_models-545"><span class="linenos">545</span></a><span class="sd">            models: dict-object,</span>
</span><span id="LazyDeepMTS.provide_models-546"><a href="#LazyDeepMTS.provide_models-546"><span class="linenos">546</span></a><span class="sd">                Returns a dictionary with each model pipeline as value</span>
</span><span id="LazyDeepMTS.provide_models-547"><a href="#LazyDeepMTS.provide_models-547"><span class="linenos">547</span></a><span class="sd">                with key as name of models.</span>
</span><span id="LazyDeepMTS.provide_models-548"><a href="#LazyDeepMTS.provide_models-548"><span class="linenos">548</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LazyDeepMTS.provide_models-549"><a href="#LazyDeepMTS.provide_models-549"><span class="linenos">549</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LazyDeepMTS.provide_models-550"><a href="#LazyDeepMTS.provide_models-550"><span class="linenos">550</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">)</span>
</span><span id="LazyDeepMTS.provide_models-551"><a href="#LazyDeepMTS.provide_models-551"><span class="linenos">551</span></a>
</span><span id="LazyDeepMTS.provide_models-552"><a href="#LazyDeepMTS.provide_models-552"><span class="linenos">552</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span>
</span></pre></div>


            <div class="docstring"><p>This function returns all the model objects trained in fit function.
If fit is not called already, then we call fit and then return the models.</p>

<p>Parameters:</p>

<pre><code>X_train : array-like,
    Training vectors, where rows is the number of samples
    and columns is the number of features.

X_test : array-like,
    Testing vectors, where rows is the number of samples
    and columns is the number of features.
</code></pre>

<p>Returns:</p>

<pre><code>models: dict-object,
    Returns a dictionary with each model pipeline as value
    with key as name of models.
</code></pre>
</div>


                                </div>
                        
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>