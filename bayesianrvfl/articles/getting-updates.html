<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting updates â€¢ bayesianrvfl</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting updates">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bayesianrvfl</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting-updates.html">Getting updates</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting updates</h1>
            
      

      <div class="hidden name"><code>getting-updates.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="with-matrix-inversion">1 - With matrix inversion<a class="anchor" aria-label="anchor" href="#with-matrix-inversion"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"bayesianrvfl"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: cclust</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: memoise</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 0 - dataset -----</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span></span>
<span><span class="op">(</span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>; <span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 32</span></span></code></pre>
<pre><code><span><span class="co">## [1] 10</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1 - Split data set into 3 parts -----</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">idx_train</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/createDataPartition.html" class="external-link">createDataPartition</a></span><span class="op">(</span><span class="va">y</span>, p <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span><span class="op">$</span><span class="va">Resample1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1]  1  2  6  7  8  9 10 12 13 14 16 18 19 21 22 23 25 26 27 30 31</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">idx_comp</span> <span class="op">&lt;-</span> <span class="fu">generics</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="va">idx_train</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1]  3  4  5 11 15 17 20 24 28 29 32</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">idx_validation</span> <span class="op">&lt;-</span> <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">idx_comp</span>,</span>
<span>                               size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idx_comp</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                               replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 15 28 29 17 32</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">idx_test</span> <span class="op">&lt;-</span> <span class="fu">generics</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">idx_comp</span>, <span class="va">idx_validation</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  3  4  5 11 20 24</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">generics</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">idx_train</span>, <span class="va">idx_validation</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## integer(0)</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">generics</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">idx_train</span>, <span class="va">idx_validation</span><span class="op">)</span>, <span class="va">idx_test</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## integer(0)</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X_train</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">idx_train</span>,<span class="op">]</span></span>
<span><span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">idx_train</span><span class="op">]</span></span>
<span><span class="va">X_validation</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">idx_validation</span>,<span class="op">]</span></span>
<span><span class="va">y_validation</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">idx_validation</span><span class="op">]</span></span>
<span><span class="va">X_test</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">idx_test</span>,<span class="op">]</span></span>
<span><span class="va">y_test</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">idx_test</span><span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="co"># 2 - Fit the model -----</span></span>
<span><span class="co"># choose the 'best' regularization parameter</span></span>
<span><span class="co"># (there are many other ways, and there are also</span></span>
<span><span class="co"># other parameters, type 'head(bayesianrvfl::fit_rvfl)')</span></span>
<span><span class="va">obj_GCV</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/fit_rvfl.html">fit_rvfl</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X_train</span>, y <span class="op">=</span> <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">best_lambda</span> <span class="op">&lt;-</span> <span class="va">obj_GCV</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">obj_GCV</span><span class="op">$</span><span class="va">GCV</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 12.9155</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_obj</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/fit_rvfl.html">fit_rvfl</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X_train</span>,</span>
<span>                                   y <span class="op">=</span> <span class="va">y_train</span>,</span>
<span>                                   method <span class="op">=</span> <span class="st">"solve"</span>,</span>
<span>                                   lambda <span class="op">=</span> <span class="va">best_lambda</span>,       </span>
<span>                                   compute_Sigma <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_obj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $coef</span></span>
<span><span class="co">##             [,1]</span></span>
<span><span class="co">## cyl  -0.36321389</span></span>
<span><span class="co">## disp -0.41963495</span></span>
<span><span class="co">## hp   -0.47508218</span></span>
<span><span class="co">## drat  0.55766798</span></span>
<span><span class="co">## wt   -0.54482177</span></span>
<span><span class="co">## qsec  0.09679212</span></span>
<span><span class="co">## vs    0.32281808</span></span>
<span><span class="co">## am    0.48049052</span></span>
<span><span class="co">## gear  0.25888698</span></span>
<span><span class="co">## carb -0.47461167</span></span>
<span><span class="co">## h1   -0.32480888</span></span>
<span><span class="co">## h2    0.75205757</span></span>
<span><span class="co">## h3   -0.35831420</span></span>
<span><span class="co">## h4    0.04812892</span></span>
<span><span class="co">## h5    0.72081638</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Dn</span></span>
<span><span class="co">##                cyl          disp            hp         drat            wt</span></span>
<span><span class="co">## cyl   0.0641456316 -0.0052760715 -0.0062410222  0.005822304 -0.0024686403</span></span>
<span><span class="co">## disp -0.0052760715  0.0622811372 -0.0074713027  0.004016479 -0.0091846066</span></span>
<span><span class="co">## hp   -0.0062410222 -0.0074713027  0.0568135298  0.003192815 -0.0026470260</span></span>
<span><span class="co">## drat  0.0058223040  0.0040164788  0.0031928154  0.055097079  0.0055691773</span></span>
<span><span class="co">## wt   -0.0024686403 -0.0091846066 -0.0026470260  0.005569177  0.0589471342</span></span>
<span><span class="co">## qsec  0.0075639422  0.0025913924  0.0063259120  0.001488753 -0.0064484723</span></span>
<span><span class="co">## vs    0.0079914361  0.0050643235  0.0028618316 -0.002787456 -0.0001204504</span></span>
<span><span class="co">## am   -0.0007384843  0.0028702003 -0.0004960659 -0.004987713  0.0066912080</span></span>
<span><span class="co">## gear  0.0061324795  0.0041541267 -0.0044793662 -0.006225893  0.0002478994</span></span>
<span><span class="co">## carb -0.0038594492 -0.0006591156 -0.0125736275 -0.004410981 -0.0047021678</span></span>
<span><span class="co">## h1   -0.0078853168 -0.0071920042 -0.0117347358  0.002126297 -0.0056497049</span></span>
<span><span class="co">## h2    0.0064432462  0.0008427470  0.0054354367 -0.012518603  0.0057446864</span></span>
<span><span class="co">## h3   -0.0048297412 -0.0080197306 -0.0029111978  0.003526704 -0.0123647411</span></span>
<span><span class="co">## h4   -0.0074352793 -0.0102001681  0.0032640334  0.004292136 -0.0019657223</span></span>
<span><span class="co">## h5    0.0052613190  0.0025032477  0.0009585112 -0.002262603  0.0075715755</span></span>
<span><span class="co">##               qsec            vs            am          gear          carb</span></span>
<span><span class="co">## cyl   0.0075639422  0.0079914361 -0.0007384843  0.0061324795 -0.0038594492</span></span>
<span><span class="co">## disp  0.0025913924  0.0050643235  0.0028702003  0.0041541267 -0.0006591156</span></span>
<span><span class="co">## hp    0.0063259120  0.0028618316 -0.0004960659 -0.0044793662 -0.0125736275</span></span>
<span><span class="co">## drat  0.0014887532 -0.0027874565 -0.0049877134 -0.0062258929 -0.0044109811</span></span>
<span><span class="co">## wt   -0.0064484723 -0.0001204504  0.0066912080  0.0002478994 -0.0047021678</span></span>
<span><span class="co">## qsec  0.0503112593 -0.0133213299  0.0114424676  0.0037203340  0.0079741656</span></span>
<span><span class="co">## vs   -0.0133213299  0.0509981024  0.0064243419 -0.0002187248  0.0012511732</span></span>
<span><span class="co">## am    0.0114424676  0.0064243419  0.0532933538 -0.0095830826 -0.0064386072</span></span>
<span><span class="co">## gear  0.0037203340 -0.0002187248 -0.0095830826  0.0511369322 -0.0127870791</span></span>
<span><span class="co">## carb  0.0079741656  0.0012511732 -0.0064386072 -0.0127870791  0.0526739148</span></span>
<span><span class="co">## h1    0.0041239477 -0.0003297649  0.0046260028  0.0046215565 -0.0032832747</span></span>
<span><span class="co">## h2   -0.0007966727  0.0035853205 -0.0083514300 -0.0056704719  0.0087822325</span></span>
<span><span class="co">## h3   -0.0013043556  0.0049873217  0.0012642085  0.0067785183  0.0010486529</span></span>
<span><span class="co">## h4    0.0044846921  0.0012511349  0.0071472958  0.0051691971  0.0091636185</span></span>
<span><span class="co">## h5   -0.0039500626 -0.0125143313 -0.0078167247  0.0043730045  0.0088466249</span></span>
<span><span class="co">##                 h1            h2           h3            h4            h5</span></span>
<span><span class="co">## cyl  -7.885317e-03  6.443246e-03 -0.004829741 -7.435279e-03  0.0052613190</span></span>
<span><span class="co">## disp -7.192004e-03  8.427470e-04 -0.008019731 -1.020017e-02  0.0025032477</span></span>
<span><span class="co">## hp   -1.173474e-02  5.435437e-03 -0.002911198  3.264033e-03  0.0009585112</span></span>
<span><span class="co">## drat  2.126297e-03 -1.251860e-02  0.003526704  4.292136e-03 -0.0022626032</span></span>
<span><span class="co">## wt   -5.649705e-03  5.744686e-03 -0.012364741 -1.965722e-03  0.0075715755</span></span>
<span><span class="co">## qsec  4.123948e-03 -7.966727e-04 -0.001304356  4.484692e-03 -0.0039500626</span></span>
<span><span class="co">## vs   -3.297649e-04  3.585321e-03  0.004987322  1.251135e-03 -0.0125143313</span></span>
<span><span class="co">## am    4.626003e-03 -8.351430e-03  0.001264209  7.147296e-03 -0.0078167247</span></span>
<span><span class="co">## gear  4.621557e-03 -5.670472e-03  0.006778518  5.169197e-03  0.0043730045</span></span>
<span><span class="co">## carb -3.283275e-03  8.782232e-03  0.001048653  9.163618e-03  0.0088466249</span></span>
<span><span class="co">## h1    5.830277e-02  8.513149e-05 -0.012269418 -9.946594e-05 -0.0014691719</span></span>
<span><span class="co">## h2    8.513149e-05  5.490943e-02 -0.002961700  2.567923e-03 -0.0080429381</span></span>
<span><span class="co">## h3   -1.226942e-02 -2.961700e-03  0.053107715  3.521041e-03 -0.0026247200</span></span>
<span><span class="co">## h4   -9.946594e-05  2.567923e-03  0.003521041  4.677769e-02  0.0036453588</span></span>
<span><span class="co">## h5   -1.469172e-03 -8.042938e-03 -0.002624720  3.645359e-03  0.0532094367</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Sigma</span></span>
<span><span class="co">##               cyl         disp           hp        drat           wt</span></span>
<span><span class="co">## cyl   0.828472689 -0.068143084 -0.080605901  0.07519795 -0.031883715</span></span>
<span><span class="co">## disp -0.068143084  0.804391819 -0.096495585  0.05187482 -0.118623756</span></span>
<span><span class="co">## hp   -0.080605901 -0.096495585  0.733774954  0.04123680 -0.034187655</span></span>
<span><span class="co">## drat  0.075197948  0.051874818  0.041236797  0.71160615  0.071928691</span></span>
<span><span class="co">## wt   -0.031883715 -0.118623756 -0.034187655  0.07192869  0.761331514</span></span>
<span><span class="co">## qsec  0.097692070  0.033469120  0.081702295  0.01922799 -0.083285222</span></span>
<span><span class="co">## vs    0.103213366  0.065408254  0.036961976 -0.03600138 -0.001555677</span></span>
<span><span class="co">## am   -0.009537891  0.037070063 -0.006406938 -0.06441880  0.086420275</span></span>
<span><span class="co">## gear  0.079204018  0.053652609 -0.057853240 -0.08041050  0.003201744</span></span>
<span><span class="co">## carb -0.049846703 -0.008512805 -0.162394644 -0.05697001 -0.060730832</span></span>
<span><span class="co">## h1   -0.101842782 -0.092888307 -0.151559941  0.02746218 -0.072968745</span></span>
<span><span class="co">## h2    0.083217724  0.010884496  0.070201364 -0.16168398  0.074195478</span></span>
<span><span class="co">## h3   -0.062378506 -0.103578804 -0.037599565  0.04554913 -0.159696772</span></span>
<span><span class="co">## h4   -0.096030324 -0.131740236  0.042156613  0.05543506 -0.025388280</span></span>
<span><span class="co">## h5    0.067952548  0.032330688  0.012379648 -0.02922264  0.097790658</span></span>
<span><span class="co">##             qsec           vs           am         gear         carb</span></span>
<span><span class="co">## cyl   0.09769207  0.103213366 -0.009537891  0.079204018 -0.049846703</span></span>
<span><span class="co">## disp  0.03346912  0.065408254  0.037070063  0.053652609 -0.008512805</span></span>
<span><span class="co">## hp    0.08170229  0.036961976 -0.006406938 -0.057853240 -0.162394644</span></span>
<span><span class="co">## drat  0.01922799 -0.036001385 -0.064418796 -0.080410499 -0.056970012</span></span>
<span><span class="co">## wt   -0.08328522 -0.001555677  0.086420275  0.003201744 -0.060730832</span></span>
<span><span class="co">## qsec  0.64979490 -0.172051591  0.147785152  0.048049961  0.102990309</span></span>
<span><span class="co">## vs   -0.17205159  0.658665821  0.082973567 -0.002824940  0.016159523</span></span>
<span><span class="co">## am    0.14778515  0.082973567  0.688310132 -0.123770271 -0.083157809</span></span>
<span><span class="co">## gear  0.04804996 -0.002824940 -0.123770271  0.660458876 -0.165151477</span></span>
<span><span class="co">## carb  0.10299031  0.016159523 -0.083157809 -0.165151477  0.680309770</span></span>
<span><span class="co">## h1    0.05326283 -0.004259078  0.059747124  0.059689698 -0.042405124</span></span>
<span><span class="co">## h2   -0.01028942  0.046306195 -0.107862866 -0.073236961  0.113426894</span></span>
<span><span class="co">## h3   -0.01684640  0.064413736  0.016327881  0.087547931  0.013543873</span></span>
<span><span class="co">## h4    0.05792203  0.016159029  0.092310874  0.066762747  0.118352683</span></span>
<span><span class="co">## h5   -0.05101702 -0.161628804 -0.100956881  0.056479525  0.114258554</span></span>
<span><span class="co">##                h1           h2          h3           h4          h5</span></span>
<span><span class="co">## cyl  -0.101842782  0.083217724 -0.06237851 -0.096030324  0.06795255</span></span>
<span><span class="co">## disp -0.092888307  0.010884496 -0.10357880 -0.131740236  0.03233069</span></span>
<span><span class="co">## hp   -0.151559941  0.070201364 -0.03759957  0.042156613  0.01237965</span></span>
<span><span class="co">## drat  0.027462183 -0.161683977  0.04554913  0.055435063 -0.02922264</span></span>
<span><span class="co">## wt   -0.072968745  0.074195478 -0.15969677 -0.025388280  0.09779066</span></span>
<span><span class="co">## qsec  0.053262832 -0.010289424 -0.01684640  0.057922025 -0.05101702</span></span>
<span><span class="co">## vs   -0.004259078  0.046306195  0.06441374  0.016159029 -0.16162880</span></span>
<span><span class="co">## am    0.059747124 -0.107862866  0.01632788  0.092310874 -0.10095688</span></span>
<span><span class="co">## gear  0.059689698 -0.073236961  0.08754793  0.066762747  0.05647952</span></span>
<span><span class="co">## carb -0.042405124  0.113426894  0.01354387  0.118352683  0.11425855</span></span>
<span><span class="co">## h1    0.753009224  0.001099515 -0.15846563 -0.001284652 -0.01897509</span></span>
<span><span class="co">## h2    0.001099515  0.709182620 -0.03825183  0.033166004 -0.10387854</span></span>
<span><span class="co">## h3   -0.158465631 -0.038251826  0.68591252  0.045475988 -0.03389956</span></span>
<span><span class="co">## h4   -0.001284652  0.033166004  0.04547599  0.604157095  0.04708162</span></span>
<span><span class="co">## h5   -0.018975085 -0.103878541 -0.03389956  0.047081619  0.68722630</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $scales</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   1.7353207 109.0975120  67.7779822   0.5580457   0.8364141   1.8376898 </span></span>
<span><span class="co">##          vs          am        gear        carb          h1          h2 </span></span>
<span><span class="co">##   0.4856209   0.4856209   0.7126966   1.7156080   0.9667548   1.2506310 </span></span>
<span><span class="co">##          h3          h4          h5 </span></span>
<span><span class="co">##   1.0024913   0.5009253   1.5452324 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $lambda</span></span>
<span><span class="co">## [1] 12.9155</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ym</span></span>
<span><span class="co">## [1] 20.10952</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $xm</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   6.1904762 218.5380952 141.0476190   3.5657143   3.1811429  17.9276190 </span></span>
<span><span class="co">##          vs          am        gear        carb          h1          h2 </span></span>
<span><span class="co">##   0.3809524   0.3809524   3.6666667   2.9047619   0.9011436   0.9011436 </span></span>
<span><span class="co">##          h3          h4          h5 </span></span>
<span><span class="co">##   0.7713531   0.4177551   1.0757344 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $n_clusters</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $clusters_scales</span></span>
<span><span class="co">## $clusters_scales$means</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   6.1904762 218.5380952 141.0476190   3.5657143   3.1811429  17.9276190 </span></span>
<span><span class="co">##          vs          am        gear        carb </span></span>
<span><span class="co">##   0.3809524   0.3809524   3.6666667   2.9047619 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $clusters_scales$sds</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   1.7353207 109.0975120  67.7779822   0.5580457   0.8364141   1.8376898 </span></span>
<span><span class="co">##          vs          am        gear        carb </span></span>
<span><span class="co">##   0.4856209   0.4856209   0.7126966   1.7156080 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $clust_obj</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nb_hidden</span></span>
<span><span class="co">## [1] 5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nodes_sim</span></span>
<span><span class="co">## [1] "sobol"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $activ</span></span>
<span><span class="co">## [1] "relu"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nn_xm</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   6.1904762 218.5380952 141.0476190   3.5657143   3.1811429  17.9276190 </span></span>
<span><span class="co">##          vs          am        gear        carb </span></span>
<span><span class="co">##   0.3809524   0.3809524   3.6666667   2.9047619 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nn_scales</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   1.7353207 109.0975120  67.7779822   0.5580457   0.8364141   1.8376898 </span></span>
<span><span class="co">##          vs          am        gear        carb </span></span>
<span><span class="co">##   0.4856209   0.4856209   0.7126966   1.7156080 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $fitted_values</span></span>
<span><span class="co">##           Mazda RX4       Mazda RX4 Wag             Valiant          Duster 360 </span></span>
<span><span class="co">##            21.79908            21.59131            19.67633            14.78088 </span></span>
<span><span class="co">##           Merc 240D            Merc 230            Merc 280          Merc 450SE </span></span>
<span><span class="co">##            22.79888            23.52919            19.78664            15.28762 </span></span>
<span><span class="co">##          Merc 450SL         Merc 450SLC Lincoln Continental            Fiat 128 </span></span>
<span><span class="co">##            15.69314            15.62712            12.41438            27.77353 </span></span>
<span><span class="co">##         Honda Civic       Toyota Corona    Dodge Challenger         AMC Javelin </span></span>
<span><span class="co">##            29.01498            23.50423            16.25692            17.07550 </span></span>
<span><span class="co">##    Pontiac Firebird           Fiat X1-9       Porsche 914-2        Ferrari Dino </span></span>
<span><span class="co">##            16.08283            27.99151            26.24130            19.96917 </span></span>
<span><span class="co">##       Maserati Bora </span></span>
<span><span class="co">##            15.40547 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $compute_Sigma</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $x</span></span>
<span><span class="co">##                     cyl  disp  hp drat    wt  qsec vs am gear carb</span></span>
<span><span class="co">## Mazda RX4             6 160.0 110 3.90 2.620 16.46  0  1    4    4</span></span>
<span><span class="co">## Mazda RX4 Wag         6 160.0 110 3.90 2.875 17.02  0  1    4    4</span></span>
<span><span class="co">## Valiant               6 225.0 105 2.76 3.460 20.22  1  0    3    1</span></span>
<span><span class="co">## Duster 360            8 360.0 245 3.21 3.570 15.84  0  0    3    4</span></span>
<span><span class="co">## Merc 240D             4 146.7  62 3.69 3.190 20.00  1  0    4    2</span></span>
<span><span class="co">## Merc 230              4 140.8  95 3.92 3.150 22.90  1  0    4    2</span></span>
<span><span class="co">## Merc 280              6 167.6 123 3.92 3.440 18.30  1  0    4    4</span></span>
<span><span class="co">## Merc 450SE            8 275.8 180 3.07 4.070 17.40  0  0    3    3</span></span>
<span><span class="co">## Merc 450SL            8 275.8 180 3.07 3.730 17.60  0  0    3    3</span></span>
<span><span class="co">## Merc 450SLC           8 275.8 180 3.07 3.780 18.00  0  0    3    3</span></span>
<span><span class="co">## Lincoln Continental   8 460.0 215 3.00 5.424 17.82  0  0    3    4</span></span>
<span><span class="co">## Fiat 128              4  78.7  66 4.08 2.200 19.47  1  1    4    1</span></span>
<span><span class="co">## Honda Civic           4  75.7  52 4.93 1.615 18.52  1  1    4    2</span></span>
<span><span class="co">## Toyota Corona         4 120.1  97 3.70 2.465 20.01  1  0    3    1</span></span>
<span><span class="co">## Dodge Challenger      8 318.0 150 2.76 3.520 16.87  0  0    3    2</span></span>
<span><span class="co">## AMC Javelin           8 304.0 150 3.15 3.435 17.30  0  0    3    2</span></span>
<span><span class="co">## Pontiac Firebird      8 400.0 175 3.08 3.845 17.05  0  0    3    2</span></span>
<span><span class="co">## Fiat X1-9             4  79.0  66 4.08 1.935 18.90  1  1    4    1</span></span>
<span><span class="co">## Porsche 914-2         4 120.3  91 4.43 2.140 16.70  0  1    5    2</span></span>
<span><span class="co">## Ferrari Dino          6 145.0 175 3.62 2.770 15.50  0  1    5    6</span></span>
<span><span class="co">## Maserati Bora         8 301.0 335 3.54 3.570 14.60  0  1    5    8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $y</span></span>
<span><span class="co">##  [1] 21.0 21.0 18.1 14.3 24.4 22.8 19.2 16.4 17.3 15.2 10.4 32.4 30.4 21.5 15.5</span></span>
<span><span class="co">## [16] 15.2 19.2 27.3 26.0 19.7 15.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $n_updates</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $avg_coefs</span></span>
<span><span class="co">##             [,1]</span></span>
<span><span class="co">## cyl  -0.36321389</span></span>
<span><span class="co">## disp -0.41963495</span></span>
<span><span class="co">## hp   -0.47508218</span></span>
<span><span class="co">## drat  0.55766798</span></span>
<span><span class="co">## wt   -0.54482177</span></span>
<span><span class="co">## qsec  0.09679212</span></span>
<span><span class="co">## vs    0.32281808</span></span>
<span><span class="co">## am    0.48049052</span></span>
<span><span class="co">## gear  0.25888698</span></span>
<span><span class="co">## carb -0.47461167</span></span>
<span><span class="co">## h1   -0.32480888</span></span>
<span><span class="co">## h2    0.75205757</span></span>
<span><span class="co">## h3   -0.35831420</span></span>
<span><span class="co">## h4    0.04812892</span></span>
<span><span class="co">## h5    0.72081638</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "rvfl"</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3 - Predict on validation set -----</span></span>
<span></span>
<span><span class="va">preds_validation</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/predict_rvfl.html">predict_rvfl</a></span><span class="op">(</span><span class="va">fit_obj</span>,</span>
<span>                                               newx <span class="op">=</span> <span class="va">X_validation</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">preds_validation</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $mean</span></span>
<span><span class="co">## Cadillac Fleetwood       Lotus Europa     Ford Pantera L  Chrysler Imperial </span></span>
<span><span class="co">##           12.60216           26.90076           19.19089           12.77321 </span></span>
<span><span class="co">##         Volvo 142E </span></span>
<span><span class="co">##           25.33738 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $sd</span></span>
<span><span class="co">## Cadillac Fleetwood       Lotus Europa     Ford Pantera L  Chrysler Imperial </span></span>
<span><span class="co">##           4.224966           4.228792           4.532150           4.180162 </span></span>
<span><span class="co">##         Volvo 142E </span></span>
<span><span class="co">##           4.041346 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $simulate</span></span>
<span><span class="co">## function (n) </span></span>
<span><span class="co">## MASS::mvrnorm(n = n, mu = res, Sigma = Sigma_newx)</span></span>
<span><span class="co">## &lt;bytecode: 0x7fb55fca7640&gt;</span></span>
<span><span class="co">## &lt;environment: 0x7fb55fca6ae0&gt;</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">level</span> <span class="op">&lt;-</span> <span class="fl">95</span></span>
<span><span class="va">multiplier</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">100</span> <span class="op">-</span> <span class="va">level</span><span class="op">)</span><span class="op">/</span><span class="fl">200</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="va">y_validation</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">## -3.4992 -1.9268  2.2022  0.8209  3.3909  3.9374</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">preds_upper</span> <span class="op">&lt;-</span> <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span> <span class="op">+</span> <span class="va">multiplier</span><span class="op">*</span><span class="va">preds_validation</span><span class="op">$</span><span class="va">sd</span></span>
<span><span class="va">preds_lower</span> <span class="op">&lt;-</span> <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="va">multiplier</span><span class="op">*</span><span class="va">preds_validation</span><span class="op">$</span><span class="va">sd</span></span>
<span></span>
<span><span class="co"># coverage rate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">preds_upper</span> <span class="op">&gt;=</span> <span class="va">y_validation</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">preds_lower</span> <span class="op">&lt;=</span> <span class="va">y_validation</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 4 - Update -----</span></span>
<span><span class="co"># add new points in an online fashion</span></span>
<span><span class="va">fit_obj2</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/update_params.html">update_params</a></span><span class="op">(</span><span class="va">fit_obj</span>, newx <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>                                        newy <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                                        method <span class="op">=</span> <span class="st">"polyak"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit_obj2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $coef</span></span>
<span><span class="co">##              [,1]</span></span>
<span><span class="co">## cyl   0.156616913</span></span>
<span><span class="co">## disp -0.002381108</span></span>
<span><span class="co">## hp   -0.183146989</span></span>
<span><span class="co">## drat  0.347876182</span></span>
<span><span class="co">## wt   -0.120830328</span></span>
<span><span class="co">## qsec -0.056125629</span></span>
<span><span class="co">## vs   -0.202146379</span></span>
<span><span class="co">## am   -0.044473938</span></span>
<span><span class="co">## gear  0.066277686</span></span>
<span><span class="co">## carb -0.017390995</span></span>
<span><span class="co">## h1    0.059058223</span></span>
<span><span class="co">## h2    0.316744350</span></span>
<span><span class="co">## h3   -0.041448067</span></span>
<span><span class="co">## h4    0.391569783</span></span>
<span><span class="co">## h5   -0.055084236</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Dn</span></span>
<span><span class="co">##                cyl          disp            hp         drat            wt</span></span>
<span><span class="co">## cyl   0.0641456316 -0.0052760715 -0.0062410222  0.005822304 -0.0024686403</span></span>
<span><span class="co">## disp -0.0052760715  0.0622811372 -0.0074713027  0.004016479 -0.0091846066</span></span>
<span><span class="co">## hp   -0.0062410222 -0.0074713027  0.0568135298  0.003192815 -0.0026470260</span></span>
<span><span class="co">## drat  0.0058223040  0.0040164788  0.0031928154  0.055097079  0.0055691773</span></span>
<span><span class="co">## wt   -0.0024686403 -0.0091846066 -0.0026470260  0.005569177  0.0589471342</span></span>
<span><span class="co">## qsec  0.0075639422  0.0025913924  0.0063259120  0.001488753 -0.0064484723</span></span>
<span><span class="co">## vs    0.0079914361  0.0050643235  0.0028618316 -0.002787456 -0.0001204504</span></span>
<span><span class="co">## am   -0.0007384843  0.0028702003 -0.0004960659 -0.004987713  0.0066912080</span></span>
<span><span class="co">## gear  0.0061324795  0.0041541267 -0.0044793662 -0.006225893  0.0002478994</span></span>
<span><span class="co">## carb -0.0038594492 -0.0006591156 -0.0125736275 -0.004410981 -0.0047021678</span></span>
<span><span class="co">## h1   -0.0078853168 -0.0071920042 -0.0117347358  0.002126297 -0.0056497049</span></span>
<span><span class="co">## h2    0.0064432462  0.0008427470  0.0054354367 -0.012518603  0.0057446864</span></span>
<span><span class="co">## h3   -0.0048297412 -0.0080197306 -0.0029111978  0.003526704 -0.0123647411</span></span>
<span><span class="co">## h4   -0.0074352793 -0.0102001681  0.0032640334  0.004292136 -0.0019657223</span></span>
<span><span class="co">## h5    0.0052613190  0.0025032477  0.0009585112 -0.002262603  0.0075715755</span></span>
<span><span class="co">##               qsec            vs            am          gear          carb</span></span>
<span><span class="co">## cyl   0.0075639422  0.0079914361 -0.0007384843  0.0061324795 -0.0038594492</span></span>
<span><span class="co">## disp  0.0025913924  0.0050643235  0.0028702003  0.0041541267 -0.0006591156</span></span>
<span><span class="co">## hp    0.0063259120  0.0028618316 -0.0004960659 -0.0044793662 -0.0125736275</span></span>
<span><span class="co">## drat  0.0014887532 -0.0027874565 -0.0049877134 -0.0062258929 -0.0044109811</span></span>
<span><span class="co">## wt   -0.0064484723 -0.0001204504  0.0066912080  0.0002478994 -0.0047021678</span></span>
<span><span class="co">## qsec  0.0503112593 -0.0133213299  0.0114424676  0.0037203340  0.0079741656</span></span>
<span><span class="co">## vs   -0.0133213299  0.0509981024  0.0064243419 -0.0002187248  0.0012511732</span></span>
<span><span class="co">## am    0.0114424676  0.0064243419  0.0532933538 -0.0095830826 -0.0064386072</span></span>
<span><span class="co">## gear  0.0037203340 -0.0002187248 -0.0095830826  0.0511369322 -0.0127870791</span></span>
<span><span class="co">## carb  0.0079741656  0.0012511732 -0.0064386072 -0.0127870791  0.0526739148</span></span>
<span><span class="co">## h1    0.0041239477 -0.0003297649  0.0046260028  0.0046215565 -0.0032832747</span></span>
<span><span class="co">## h2   -0.0007966727  0.0035853205 -0.0083514300 -0.0056704719  0.0087822325</span></span>
<span><span class="co">## h3   -0.0013043556  0.0049873217  0.0012642085  0.0067785183  0.0010486529</span></span>
<span><span class="co">## h4    0.0044846921  0.0012511349  0.0071472958  0.0051691971  0.0091636185</span></span>
<span><span class="co">## h5   -0.0039500626 -0.0125143313 -0.0078167247  0.0043730045  0.0088466249</span></span>
<span><span class="co">##                 h1            h2           h3            h4            h5</span></span>
<span><span class="co">## cyl  -7.885317e-03  6.443246e-03 -0.004829741 -7.435279e-03  0.0052613190</span></span>
<span><span class="co">## disp -7.192004e-03  8.427470e-04 -0.008019731 -1.020017e-02  0.0025032477</span></span>
<span><span class="co">## hp   -1.173474e-02  5.435437e-03 -0.002911198  3.264033e-03  0.0009585112</span></span>
<span><span class="co">## drat  2.126297e-03 -1.251860e-02  0.003526704  4.292136e-03 -0.0022626032</span></span>
<span><span class="co">## wt   -5.649705e-03  5.744686e-03 -0.012364741 -1.965722e-03  0.0075715755</span></span>
<span><span class="co">## qsec  4.123948e-03 -7.966727e-04 -0.001304356  4.484692e-03 -0.0039500626</span></span>
<span><span class="co">## vs   -3.297649e-04  3.585321e-03  0.004987322  1.251135e-03 -0.0125143313</span></span>
<span><span class="co">## am    4.626003e-03 -8.351430e-03  0.001264209  7.147296e-03 -0.0078167247</span></span>
<span><span class="co">## gear  4.621557e-03 -5.670472e-03  0.006778518  5.169197e-03  0.0043730045</span></span>
<span><span class="co">## carb -3.283275e-03  8.782232e-03  0.001048653  9.163618e-03  0.0088466249</span></span>
<span><span class="co">## h1    5.830277e-02  8.513149e-05 -0.012269418 -9.946594e-05 -0.0014691719</span></span>
<span><span class="co">## h2    8.513149e-05  5.490943e-02 -0.002961700  2.567923e-03 -0.0080429381</span></span>
<span><span class="co">## h3   -1.226942e-02 -2.961700e-03  0.053107715  3.521041e-03 -0.0026247200</span></span>
<span><span class="co">## h4   -9.946594e-05  2.567923e-03  0.003521041  4.677769e-02  0.0036453588</span></span>
<span><span class="co">## h5   -1.469172e-03 -8.042938e-03 -0.002624720  3.645359e-03  0.0532094367</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Sigma</span></span>
<span><span class="co">##             cyl         disp           hp          drat           wt</span></span>
<span><span class="co">## x1   0.78402288 -0.064247705 -0.028087737 -0.0119358174 -0.015798304</span></span>
<span><span class="co">## x2  -0.10382172  0.807518533 -0.054340704 -0.0180650516 -0.105712440</span></span>
<span><span class="co">## x3  -0.10556876 -0.094307953  0.763268974 -0.0076972266 -0.025154143</span></span>
<span><span class="co">## x4   0.09313687  0.050302732  0.020041669  0.7467713366  0.065436987</span></span>
<span><span class="co">## x5  -0.06813847 -0.115446553  0.008647921  0.0008594692  0.774451315</span></span>
<span><span class="co">## x6   0.11076780  0.032323223  0.066253115  0.0448599798 -0.088017041</span></span>
<span><span class="co">## x7   0.14810215  0.061474405 -0.016074837  0.0519928805 -0.017799942</span></span>
<span><span class="co">## x8   0.03535089  0.033136214 -0.059443751  0.0235754698  0.070176010</span></span>
<span><span class="co">## x9   0.09567370  0.052209281 -0.077312430 -0.0481254296 -0.002758272</span></span>
<span><span class="co">## x10 -0.08894283 -0.005086598 -0.116201940 -0.1336091004 -0.046582800</span></span>
<span><span class="co">## h1  -0.13466658 -0.090011778 -0.112778100 -0.0368814186 -0.061090533</span></span>
<span><span class="co">## h2   0.12044059  0.007622454  0.026221957 -0.0887170054  0.060725341</span></span>
<span><span class="co">## h3  -0.08947317 -0.101204351 -0.005586788 -0.0075638042 -0.149891808</span></span>
<span><span class="co">## h4  -0.12539734 -0.129166644  0.076854217 -0.0021323131 -0.014761000</span></span>
<span><span class="co">## h5   0.13429844  0.026516436 -0.066009081  0.1008334081  0.073781537</span></span>
<span><span class="co">##             qsec           vs          am        gear        carb           h1</span></span>
<span><span class="co">## x1   0.044498822  0.188085424  0.12275509  0.09062335 -0.15836877 -0.109763941</span></span>
<span><span class="co">## x2  -0.009227633  0.133532713  0.14325799  0.06281859 -0.09562047 -0.099246402</span></span>
<span><span class="co">## x3   0.051829150  0.084625833  0.06788835 -0.05144018 -0.22334026 -0.156008436</span></span>
<span><span class="co">## x4   0.040695563 -0.070253803 -0.11780921 -0.08501908 -0.01317299  0.030658981</span></span>
<span><span class="co">## x5  -0.126671420  0.067668820  0.19432287  0.01251574 -0.14924507 -0.079429508</span></span>
<span><span class="co">## x6   0.665442669 -0.197018262  0.10886875  0.04469075  0.13491406  0.055592986</span></span>
<span><span class="co">## x7  -0.118333027  0.572955599 -0.05062589 -0.01435705  0.12575331  0.003740308</span></span>
<span><span class="co">## x8   0.201503716 -0.002736656  0.55471067 -0.13530238  0.02643598  0.067746509</span></span>
<span><span class="co">## x9   0.067759286 -0.034271994 -0.17278787  0.65622775 -0.12494155  0.062624670</span></span>
<span><span class="co">## x10  0.056203830  0.090809312  0.03320137 -0.15510752  0.58485846 -0.049372232</span></span>
<span><span class="co">## h1   0.013982478  0.058414375  0.15743838  0.06812226 -0.12254284  0.747159874</span></span>
<span><span class="co">## h2   0.034255308 -0.024766793 -0.21864677 -0.08279966  0.20430471  0.007732799</span></span>
<span><span class="co">## h3  -0.049270680  0.116148033  0.09696790  0.09450866 -0.05260644 -0.163294023</span></span>
<span><span class="co">## h4   0.022778408  0.072232144  0.17971396  0.07430725  0.04665452 -0.006517989</span></span>
<span><span class="co">## h5   0.028379340 -0.288309027 -0.29841769  0.03943500  0.27623883 -0.007151946</span></span>
<span><span class="co">##               h2          h3          h4           h5</span></span>
<span><span class="co">## x1   0.079803966 -0.06285836 -0.11671117  0.203615337</span></span>
<span><span class="co">## x2   0.008144366 -0.10396397 -0.14834018  0.141223465</span></span>
<span><span class="co">## x3   0.068284209 -0.03786905  0.03054232  0.088567404</span></span>
<span><span class="co">## x4  -0.160306263  0.04574279  0.06378138 -0.083973038</span></span>
<span><span class="co">## x5   0.071411102 -0.16008816 -0.04225627  0.208441779</span></span>
<span><span class="co">## x6  -0.009285204 -0.01670524  0.06400567 -0.090924715</span></span>
<span><span class="co">## x7   0.049753667  0.06489833  0.03704411 -0.298631347</span></span>
<span><span class="co">## x8  -0.104415394  0.01681248  0.11319596 -0.237959424</span></span>
<span><span class="co">## x9  -0.071972084  0.08772573  0.07442548  0.006213334</span></span>
<span><span class="co">## x10  0.110424300  0.01312181  0.10016271  0.233581671</span></span>
<span><span class="co">## h1  -0.001421362 -0.15881998 -0.01655635  0.081204591</span></span>
<span><span class="co">## h2   0.712041347 -0.03784999  0.05048442 -0.217484361</span></span>
<span><span class="co">## h3  -0.040332704  0.68562002  0.03286985  0.048794544</span></span>
<span><span class="co">## h4   0.030910608  0.04515896  0.59049371  0.136711061</span></span>
<span><span class="co">## h5  -0.098783157 -0.03318333  0.07794990  0.484735720</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $scales</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   1.7557462 109.0477139  66.9717006   0.5484217   0.8366388   1.8010560 </span></span>
<span><span class="co">##          vs          am        gear        carb          h1          h2 </span></span>
<span><span class="co">##   0.4916661   0.4916661   0.6997638   1.7224814   1.0168174   1.2212131 </span></span>
<span><span class="co">##          h3          h4          h5 </span></span>
<span><span class="co">##   1.0386470   0.5080586   1.5540760 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $lambda</span></span>
<span><span class="co">## [1] 12.9155</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ym</span></span>
<span><span class="co">## [1] 20.23182</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $xm</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   6.0909091 213.5136364 138.8636364   3.5786364   3.1420000  17.9586364 </span></span>
<span><span class="co">##          vs          am        gear        carb          h1          h2 </span></span>
<span><span class="co">##   0.4090909   0.4090909   3.6818182   2.8181818   0.9168722   0.9168722 </span></span>
<span><span class="co">##          h3          h4          h5 </span></span>
<span><span class="co">##   0.7979139   0.4134997   1.1133050 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $n_clusters</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $clusters_scales</span></span>
<span><span class="co">## $clusters_scales$means</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   6.1904762 218.5380952 141.0476190   3.5657143   3.1811429  17.9276190 </span></span>
<span><span class="co">##          vs          am        gear        carb </span></span>
<span><span class="co">##   0.3809524   0.3809524   3.6666667   2.9047619 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $clusters_scales$sds</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   1.7353207 109.0975120  67.7779822   0.5580457   0.8364141   1.8376898 </span></span>
<span><span class="co">##          vs          am        gear        carb </span></span>
<span><span class="co">##   0.4856209   0.4856209   0.7126966   1.7156080 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $clust_obj</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nb_hidden</span></span>
<span><span class="co">## [1] 5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nodes_sim</span></span>
<span><span class="co">## [1] "sobol"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $activ</span></span>
<span><span class="co">## [1] "relu"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nn_xm</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   6.0909091 213.5136364 138.8636364   3.5786364   3.1420000  17.9586364 </span></span>
<span><span class="co">##          vs          am        gear        carb </span></span>
<span><span class="co">##   0.4090909   0.4090909   3.6818182   2.8181818 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nn_scales</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   1.7557462 109.0477139  66.9717006   0.5484217   0.8366388   1.8010560 </span></span>
<span><span class="co">##          vs          am        gear        carb </span></span>
<span><span class="co">##   0.4916661   0.4916661   0.6997638   1.7224814 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $fitted_values</span></span>
<span><span class="co">##           Mazda RX4       Mazda RX4 Wag             Valiant          Duster 360 </span></span>
<span><span class="co">##            20.49798            20.44760            19.29045            20.05476 </span></span>
<span><span class="co">##           Merc 240D            Merc 230            Merc 280          Merc 450SE </span></span>
<span><span class="co">##            20.07872            19.91361            20.30749            19.87505 </span></span>
<span><span class="co">##          Merc 450SL         Merc 450SLC Lincoln Continental            Fiat 128 </span></span>
<span><span class="co">##            19.96864            19.88149            19.65522            20.42344 </span></span>
<span><span class="co">##         Honda Civic       Toyota Corona    Dodge Challenger         AMC Javelin </span></span>
<span><span class="co">##            21.28915            19.54064            20.53654            20.80859 </span></span>
<span><span class="co">##    Pontiac Firebird           Fiat X1-9       Porsche 914-2        Ferrari Dino </span></span>
<span><span class="co">##            20.84109            20.47431            21.54739            19.96616 </span></span>
<span><span class="co">##       Maserati Bora                newx </span></span>
<span><span class="co">##            19.62646            20.07523 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $compute_Sigma</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $x</span></span>
<span><span class="co">##                     cyl  disp  hp drat    wt  qsec vs am gear carb</span></span>
<span><span class="co">## Mazda RX4             6 160.0 110 3.90 2.620 16.46  0  1    4    4</span></span>
<span><span class="co">## Mazda RX4 Wag         6 160.0 110 3.90 2.875 17.02  0  1    4    4</span></span>
<span><span class="co">## Valiant               6 225.0 105 2.76 3.460 20.22  1  0    3    1</span></span>
<span><span class="co">## Duster 360            8 360.0 245 3.21 3.570 15.84  0  0    3    4</span></span>
<span><span class="co">## Merc 240D             4 146.7  62 3.69 3.190 20.00  1  0    4    2</span></span>
<span><span class="co">## Merc 230              4 140.8  95 3.92 3.150 22.90  1  0    4    2</span></span>
<span><span class="co">## Merc 280              6 167.6 123 3.92 3.440 18.30  1  0    4    4</span></span>
<span><span class="co">## Merc 450SE            8 275.8 180 3.07 4.070 17.40  0  0    3    3</span></span>
<span><span class="co">## Merc 450SL            8 275.8 180 3.07 3.730 17.60  0  0    3    3</span></span>
<span><span class="co">## Merc 450SLC           8 275.8 180 3.07 3.780 18.00  0  0    3    3</span></span>
<span><span class="co">## Lincoln Continental   8 460.0 215 3.00 5.424 17.82  0  0    3    4</span></span>
<span><span class="co">## Fiat 128              4  78.7  66 4.08 2.200 19.47  1  1    4    1</span></span>
<span><span class="co">## Honda Civic           4  75.7  52 4.93 1.615 18.52  1  1    4    2</span></span>
<span><span class="co">## Toyota Corona         4 120.1  97 3.70 2.465 20.01  1  0    3    1</span></span>
<span><span class="co">## Dodge Challenger      8 318.0 150 2.76 3.520 16.87  0  0    3    2</span></span>
<span><span class="co">## AMC Javelin           8 304.0 150 3.15 3.435 17.30  0  0    3    2</span></span>
<span><span class="co">## Pontiac Firebird      8 400.0 175 3.08 3.845 17.05  0  0    3    2</span></span>
<span><span class="co">## Fiat X1-9             4  79.0  66 4.08 1.935 18.90  1  1    4    1</span></span>
<span><span class="co">## Porsche 914-2         4 120.3  91 4.43 2.140 16.70  0  1    5    2</span></span>
<span><span class="co">## Ferrari Dino          6 145.0 175 3.62 2.770 15.50  0  1    5    6</span></span>
<span><span class="co">## Maserati Bora         8 301.0 335 3.54 3.570 14.60  0  1    5    8</span></span>
<span><span class="co">## newx                  4 108.0  93 3.85 2.320 18.61  1  1    4    1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $y</span></span>
<span><span class="co">##  [1] 21.0 21.0 18.1 14.3 24.4 22.8 19.2 16.4 17.3 15.2 10.4 32.4 30.4 21.5 15.5</span></span>
<span><span class="co">## [16] 15.2 19.2 27.3 26.0 19.7 15.0 22.8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $n_updates</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $avg_coefs</span></span>
<span><span class="co">##              [,1]</span></span>
<span><span class="co">## cyl   0.156616913</span></span>
<span><span class="co">## disp -0.002381108</span></span>
<span><span class="co">## hp   -0.183146989</span></span>
<span><span class="co">## drat  0.347876182</span></span>
<span><span class="co">## wt   -0.120830328</span></span>
<span><span class="co">## qsec -0.056125629</span></span>
<span><span class="co">## vs   -0.202146379</span></span>
<span><span class="co">## am   -0.044473938</span></span>
<span><span class="co">## gear  0.066277686</span></span>
<span><span class="co">## carb -0.017390995</span></span>
<span><span class="co">## h1    0.059058223</span></span>
<span><span class="co">## h2    0.316744350</span></span>
<span><span class="co">## h3   -0.041448067</span></span>
<span><span class="co">## h4    0.391569783</span></span>
<span><span class="co">## h5   -0.055084236</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "rvfl"</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 4 - Update -----</span></span>
<span><span class="va">fit_obj3</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/update_params.html">update_params</a></span><span class="op">(</span><span class="va">fit_obj2</span>, newx <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>                                        newy <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fit_obj4</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/update_params.html">update_params</a></span><span class="op">(</span><span class="va">fit_obj3</span>, newx <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>                                        newy <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fit_obj5</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/update_params.html">update_params</a></span><span class="op">(</span><span class="va">fit_obj4</span>, newx <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>                                        newy <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fit_obj6</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/update_params.html">update_params</a></span><span class="op">(</span><span class="va">fit_obj5</span>, newx <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>                                        newy <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fit_obj7</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/update_params.html">update_params</a></span><span class="op">(</span><span class="va">fit_obj6</span>, newx <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>                                        newy <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">mat_coefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">fit_obj</span><span class="op">$</span><span class="va">coef</span>, <span class="va">fit_obj2</span><span class="op">$</span><span class="va">coef</span>,</span>
<span>                    <span class="va">fit_obj3</span><span class="op">$</span><span class="va">coef</span>, <span class="va">fit_obj4</span><span class="op">$</span><span class="va">coef</span>,</span>
<span>                    <span class="va">fit_obj5</span><span class="op">$</span><span class="va">coef</span>, <span class="va">fit_obj6</span><span class="op">$</span><span class="va">coef</span>,</span>
<span>                   <span class="va">fit_obj7</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             [,1]         [,2]        [,3]         [,4]         [,5]        [,6]</span></span>
<span><span class="co">## cyl  -0.36321389  0.156616913  0.15526284  0.129827202  0.108708432  0.25553641</span></span>
<span><span class="co">## disp -0.41963495 -0.002381108  0.02392163 -0.028084515  0.010614134 -0.05287947</span></span>
<span><span class="co">## hp   -0.47508218 -0.183146989 -0.18017625 -0.209942490 -0.185639455 -0.14172577</span></span>
<span><span class="co">## drat  0.55766798  0.347876182  0.31677310  0.296955079  0.218041531  0.23138318</span></span>
<span><span class="co">## wt   -0.54482177 -0.120830328 -0.12408786 -0.094487284 -0.130846130 -0.33058489</span></span>
<span><span class="co">## qsec  0.09679212 -0.056125629 -0.04983535 -0.038472349 -0.052940428  0.18643092</span></span>
<span><span class="co">## vs    0.32281808 -0.202146379 -0.15477060 -0.121186864 -0.215509601 -0.20256839</span></span>
<span><span class="co">## am    0.48049052 -0.044473938 -0.03601185 -0.027533562  0.027790516  0.23768575</span></span>
<span><span class="co">## gear  0.25888698  0.066277686  0.05286751  0.066572603  0.032719777  0.03144328</span></span>
<span><span class="co">## carb -0.47461167 -0.017390995 -0.03329515 -0.000839621 -0.059773632 -0.07664043</span></span>
<span><span class="co">## h1   -0.32480888  0.059058223  0.04693134  0.083068120  0.070315911  0.21418578</span></span>
<span><span class="co">## h2    0.75205757  0.316744350  0.29130604  0.288692930  0.339631245  0.60881874</span></span>
<span><span class="co">## h3   -0.35831420 -0.041448067 -0.09083627 -0.040985378 -0.003155133  0.08415602</span></span>
<span><span class="co">## h4    0.04812892  0.391569783  0.43137202  0.325474945  0.293790804  0.38395787</span></span>
<span><span class="co">## h5    0.72081638 -0.055084236 -0.05131442 -0.050581055  0.009582396  0.47876079</span></span>
<span><span class="co">##             [,7]</span></span>
<span><span class="co">## cyl   0.26362315</span></span>
<span><span class="co">## disp -0.13067584</span></span>
<span><span class="co">## hp   -0.32368770</span></span>
<span><span class="co">## drat -0.06532282</span></span>
<span><span class="co">## wt   -0.39288401</span></span>
<span><span class="co">## qsec  0.37268019</span></span>
<span><span class="co">## vs   -0.19005954</span></span>
<span><span class="co">## am    0.37007213</span></span>
<span><span class="co">## gear  0.24037714</span></span>
<span><span class="co">## carb -0.05610335</span></span>
<span><span class="co">## h1    0.01489951</span></span>
<span><span class="co">## h2    0.59106285</span></span>
<span><span class="co">## h3    0.31512079</span></span>
<span><span class="co">## h4    0.44075787</span></span>
<span><span class="co">## h5    0.42961755</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">preds_validation2</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/predict_rvfl.html">predict_rvfl</a></span><span class="op">(</span><span class="va">fit_obj2</span>,</span>
<span>                                                newx <span class="op">=</span> <span class="va">X_validation</span><span class="op">)</span></span>
<span></span>
<span><span class="va">preds_validation3</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/predict_rvfl.html">predict_rvfl</a></span><span class="op">(</span><span class="va">fit_obj7</span>,</span>
<span>                                                newx <span class="op">=</span> <span class="va">X_validation</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 5 - Plots -----</span></span>
<span></span>
<span><span class="co">#par(mfrow=c(3, 2))</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">obj_GCV</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">obj_GCV</span><span class="op">$</span><span class="va">GCV</span>, type<span class="op">=</span><span class="st">'l'</span>,</span>
<span>     main <span class="op">=</span> <span class="st">'Generalized Cross-validation error'</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"log(lambda)"</span>, ylab <span class="op">=</span> <span class="st">"GCV"</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-updates_files/figure-html/unnamed-chunk-5-1.png" width="691.2"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y_validation</span>, type<span class="op">=</span><span class="st">'l'</span>, col<span class="op">=</span><span class="st">"red"</span>,</span>
<span>     lwd<span class="op">=</span><span class="fl">2</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_validation</span>, <span class="va">preds_lower</span>, <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_validation</span>, <span class="va">preds_upper</span>, <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">'Out-of-sample credible intervals'</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"obs#"</span>, ylab <span class="op">=</span> <span class="st">"prediction"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span>, col<span class="op">=</span><span class="st">"blue"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">preds_upper</span>, col<span class="op">=</span><span class="st">"gray"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">preds_lower</span>, col<span class="op">=</span><span class="st">"gray"</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-updates_files/figure-html/unnamed-chunk-5-2.png" width="691.2"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y_validation</span>,</span>
<span>     y <span class="op">=</span> <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_validation</span>, <span class="va">preds_lower</span>, <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_validation</span>, <span class="va">preds_upper</span>, <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">'observed vs predicted \n (before updates)'</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"observed"</span>, ylab <span class="op">=</span> <span class="st">"predicted"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">1</span>, col<span class="op">=</span><span class="st">"green"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-updates_files/figure-html/unnamed-chunk-5-3.png" width="691.2"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mat_coefs</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'l'</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        main <span class="op">=</span> <span class="st">'model coefficients \n after each update'</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"update#"</span>, ylab <span class="op">=</span> <span class="st">"model coefficient"</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-updates_files/figure-html/unnamed-chunk-5-4.png" width="691.2"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y_validation</span>,</span>
<span>     y <span class="op">=</span> <span class="va">preds_validation2</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_validation</span>, <span class="va">preds_lower</span>, <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_validation</span>, <span class="va">preds_upper</span>, <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">'observed vs predicted \n (after 6 point-updates)'</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"observed"</span>, ylab <span class="op">=</span> <span class="st">"predicted"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">1</span>, col<span class="op">=</span><span class="st">"green"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-updates_files/figure-html/unnamed-chunk-5-5.png" width="691.2"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">preds_validation3</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="fl">250</span><span class="op">)</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span>,</span>
<span>        lwd <span class="op">=</span> <span class="fl">2</span>, main <span class="op">=</span> <span class="st">'predictive posterior simulation \n (after 6 point-updates)'</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"obs#"</span>, ylab <span class="op">=</span> <span class="st">"prediction"</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-updates_files/figure-html/unnamed-chunk-5-6.png" width="691.2"></p>
</div>
<div class="section level2">
<h2 id="with-polyak-averaging">2 - With Polyak averaging<a class="anchor" aria-label="anchor" href="#with-polyak-averaging"></a>
</h2>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"bayesianrvfl"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">fit_obj</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/fit_rvfl.html">fit_rvfl</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X_train</span>,</span>
<span>                                   y <span class="op">=</span> <span class="va">y_train</span>,</span>
<span>                                   method <span class="op">=</span> <span class="st">"solve"</span>,</span>
<span>                                   lambda <span class="op">=</span> <span class="va">best_lambda</span>,                                   </span>
<span>                                   compute_Sigma <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $coef</span></span>
<span><span class="co">##             [,1]</span></span>
<span><span class="co">## cyl  -0.36321389</span></span>
<span><span class="co">## disp -0.41963495</span></span>
<span><span class="co">## hp   -0.47508218</span></span>
<span><span class="co">## drat  0.55766798</span></span>
<span><span class="co">## wt   -0.54482177</span></span>
<span><span class="co">## qsec  0.09679212</span></span>
<span><span class="co">## vs    0.32281808</span></span>
<span><span class="co">## am    0.48049052</span></span>
<span><span class="co">## gear  0.25888698</span></span>
<span><span class="co">## carb -0.47461167</span></span>
<span><span class="co">## h1   -0.32480888</span></span>
<span><span class="co">## h2    0.75205757</span></span>
<span><span class="co">## h3   -0.35831420</span></span>
<span><span class="co">## h4    0.04812892</span></span>
<span><span class="co">## h5    0.72081638</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Dn</span></span>
<span><span class="co">##                cyl          disp            hp         drat            wt</span></span>
<span><span class="co">## cyl   0.0641456316 -0.0052760715 -0.0062410222  0.005822304 -0.0024686403</span></span>
<span><span class="co">## disp -0.0052760715  0.0622811372 -0.0074713027  0.004016479 -0.0091846066</span></span>
<span><span class="co">## hp   -0.0062410222 -0.0074713027  0.0568135298  0.003192815 -0.0026470260</span></span>
<span><span class="co">## drat  0.0058223040  0.0040164788  0.0031928154  0.055097079  0.0055691773</span></span>
<span><span class="co">## wt   -0.0024686403 -0.0091846066 -0.0026470260  0.005569177  0.0589471342</span></span>
<span><span class="co">## qsec  0.0075639422  0.0025913924  0.0063259120  0.001488753 -0.0064484723</span></span>
<span><span class="co">## vs    0.0079914361  0.0050643235  0.0028618316 -0.002787456 -0.0001204504</span></span>
<span><span class="co">## am   -0.0007384843  0.0028702003 -0.0004960659 -0.004987713  0.0066912080</span></span>
<span><span class="co">## gear  0.0061324795  0.0041541267 -0.0044793662 -0.006225893  0.0002478994</span></span>
<span><span class="co">## carb -0.0038594492 -0.0006591156 -0.0125736275 -0.004410981 -0.0047021678</span></span>
<span><span class="co">## h1   -0.0078853168 -0.0071920042 -0.0117347358  0.002126297 -0.0056497049</span></span>
<span><span class="co">## h2    0.0064432462  0.0008427470  0.0054354367 -0.012518603  0.0057446864</span></span>
<span><span class="co">## h3   -0.0048297412 -0.0080197306 -0.0029111978  0.003526704 -0.0123647411</span></span>
<span><span class="co">## h4   -0.0074352793 -0.0102001681  0.0032640334  0.004292136 -0.0019657223</span></span>
<span><span class="co">## h5    0.0052613190  0.0025032477  0.0009585112 -0.002262603  0.0075715755</span></span>
<span><span class="co">##               qsec            vs            am          gear          carb</span></span>
<span><span class="co">## cyl   0.0075639422  0.0079914361 -0.0007384843  0.0061324795 -0.0038594492</span></span>
<span><span class="co">## disp  0.0025913924  0.0050643235  0.0028702003  0.0041541267 -0.0006591156</span></span>
<span><span class="co">## hp    0.0063259120  0.0028618316 -0.0004960659 -0.0044793662 -0.0125736275</span></span>
<span><span class="co">## drat  0.0014887532 -0.0027874565 -0.0049877134 -0.0062258929 -0.0044109811</span></span>
<span><span class="co">## wt   -0.0064484723 -0.0001204504  0.0066912080  0.0002478994 -0.0047021678</span></span>
<span><span class="co">## qsec  0.0503112593 -0.0133213299  0.0114424676  0.0037203340  0.0079741656</span></span>
<span><span class="co">## vs   -0.0133213299  0.0509981024  0.0064243419 -0.0002187248  0.0012511732</span></span>
<span><span class="co">## am    0.0114424676  0.0064243419  0.0532933538 -0.0095830826 -0.0064386072</span></span>
<span><span class="co">## gear  0.0037203340 -0.0002187248 -0.0095830826  0.0511369322 -0.0127870791</span></span>
<span><span class="co">## carb  0.0079741656  0.0012511732 -0.0064386072 -0.0127870791  0.0526739148</span></span>
<span><span class="co">## h1    0.0041239477 -0.0003297649  0.0046260028  0.0046215565 -0.0032832747</span></span>
<span><span class="co">## h2   -0.0007966727  0.0035853205 -0.0083514300 -0.0056704719  0.0087822325</span></span>
<span><span class="co">## h3   -0.0013043556  0.0049873217  0.0012642085  0.0067785183  0.0010486529</span></span>
<span><span class="co">## h4    0.0044846921  0.0012511349  0.0071472958  0.0051691971  0.0091636185</span></span>
<span><span class="co">## h5   -0.0039500626 -0.0125143313 -0.0078167247  0.0043730045  0.0088466249</span></span>
<span><span class="co">##                 h1            h2           h3            h4            h5</span></span>
<span><span class="co">## cyl  -7.885317e-03  6.443246e-03 -0.004829741 -7.435279e-03  0.0052613190</span></span>
<span><span class="co">## disp -7.192004e-03  8.427470e-04 -0.008019731 -1.020017e-02  0.0025032477</span></span>
<span><span class="co">## hp   -1.173474e-02  5.435437e-03 -0.002911198  3.264033e-03  0.0009585112</span></span>
<span><span class="co">## drat  2.126297e-03 -1.251860e-02  0.003526704  4.292136e-03 -0.0022626032</span></span>
<span><span class="co">## wt   -5.649705e-03  5.744686e-03 -0.012364741 -1.965722e-03  0.0075715755</span></span>
<span><span class="co">## qsec  4.123948e-03 -7.966727e-04 -0.001304356  4.484692e-03 -0.0039500626</span></span>
<span><span class="co">## vs   -3.297649e-04  3.585321e-03  0.004987322  1.251135e-03 -0.0125143313</span></span>
<span><span class="co">## am    4.626003e-03 -8.351430e-03  0.001264209  7.147296e-03 -0.0078167247</span></span>
<span><span class="co">## gear  4.621557e-03 -5.670472e-03  0.006778518  5.169197e-03  0.0043730045</span></span>
<span><span class="co">## carb -3.283275e-03  8.782232e-03  0.001048653  9.163618e-03  0.0088466249</span></span>
<span><span class="co">## h1    5.830277e-02  8.513149e-05 -0.012269418 -9.946594e-05 -0.0014691719</span></span>
<span><span class="co">## h2    8.513149e-05  5.490943e-02 -0.002961700  2.567923e-03 -0.0080429381</span></span>
<span><span class="co">## h3   -1.226942e-02 -2.961700e-03  0.053107715  3.521041e-03 -0.0026247200</span></span>
<span><span class="co">## h4   -9.946594e-05  2.567923e-03  0.003521041  4.677769e-02  0.0036453588</span></span>
<span><span class="co">## h5   -1.469172e-03 -8.042938e-03 -0.002624720  3.645359e-03  0.0532094367</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Sigma</span></span>
<span><span class="co">##               cyl         disp           hp        drat           wt</span></span>
<span><span class="co">## cyl   0.828472689 -0.068143084 -0.080605901  0.07519795 -0.031883715</span></span>
<span><span class="co">## disp -0.068143084  0.804391819 -0.096495585  0.05187482 -0.118623756</span></span>
<span><span class="co">## hp   -0.080605901 -0.096495585  0.733774954  0.04123680 -0.034187655</span></span>
<span><span class="co">## drat  0.075197948  0.051874818  0.041236797  0.71160615  0.071928691</span></span>
<span><span class="co">## wt   -0.031883715 -0.118623756 -0.034187655  0.07192869  0.761331514</span></span>
<span><span class="co">## qsec  0.097692070  0.033469120  0.081702295  0.01922799 -0.083285222</span></span>
<span><span class="co">## vs    0.103213366  0.065408254  0.036961976 -0.03600138 -0.001555677</span></span>
<span><span class="co">## am   -0.009537891  0.037070063 -0.006406938 -0.06441880  0.086420275</span></span>
<span><span class="co">## gear  0.079204018  0.053652609 -0.057853240 -0.08041050  0.003201744</span></span>
<span><span class="co">## carb -0.049846703 -0.008512805 -0.162394644 -0.05697001 -0.060730832</span></span>
<span><span class="co">## h1   -0.101842782 -0.092888307 -0.151559941  0.02746218 -0.072968745</span></span>
<span><span class="co">## h2    0.083217724  0.010884496  0.070201364 -0.16168398  0.074195478</span></span>
<span><span class="co">## h3   -0.062378506 -0.103578804 -0.037599565  0.04554913 -0.159696772</span></span>
<span><span class="co">## h4   -0.096030324 -0.131740236  0.042156613  0.05543506 -0.025388280</span></span>
<span><span class="co">## h5    0.067952548  0.032330688  0.012379648 -0.02922264  0.097790658</span></span>
<span><span class="co">##             qsec           vs           am         gear         carb</span></span>
<span><span class="co">## cyl   0.09769207  0.103213366 -0.009537891  0.079204018 -0.049846703</span></span>
<span><span class="co">## disp  0.03346912  0.065408254  0.037070063  0.053652609 -0.008512805</span></span>
<span><span class="co">## hp    0.08170229  0.036961976 -0.006406938 -0.057853240 -0.162394644</span></span>
<span><span class="co">## drat  0.01922799 -0.036001385 -0.064418796 -0.080410499 -0.056970012</span></span>
<span><span class="co">## wt   -0.08328522 -0.001555677  0.086420275  0.003201744 -0.060730832</span></span>
<span><span class="co">## qsec  0.64979490 -0.172051591  0.147785152  0.048049961  0.102990309</span></span>
<span><span class="co">## vs   -0.17205159  0.658665821  0.082973567 -0.002824940  0.016159523</span></span>
<span><span class="co">## am    0.14778515  0.082973567  0.688310132 -0.123770271 -0.083157809</span></span>
<span><span class="co">## gear  0.04804996 -0.002824940 -0.123770271  0.660458876 -0.165151477</span></span>
<span><span class="co">## carb  0.10299031  0.016159523 -0.083157809 -0.165151477  0.680309770</span></span>
<span><span class="co">## h1    0.05326283 -0.004259078  0.059747124  0.059689698 -0.042405124</span></span>
<span><span class="co">## h2   -0.01028942  0.046306195 -0.107862866 -0.073236961  0.113426894</span></span>
<span><span class="co">## h3   -0.01684640  0.064413736  0.016327881  0.087547931  0.013543873</span></span>
<span><span class="co">## h4    0.05792203  0.016159029  0.092310874  0.066762747  0.118352683</span></span>
<span><span class="co">## h5   -0.05101702 -0.161628804 -0.100956881  0.056479525  0.114258554</span></span>
<span><span class="co">##                h1           h2          h3           h4          h5</span></span>
<span><span class="co">## cyl  -0.101842782  0.083217724 -0.06237851 -0.096030324  0.06795255</span></span>
<span><span class="co">## disp -0.092888307  0.010884496 -0.10357880 -0.131740236  0.03233069</span></span>
<span><span class="co">## hp   -0.151559941  0.070201364 -0.03759957  0.042156613  0.01237965</span></span>
<span><span class="co">## drat  0.027462183 -0.161683977  0.04554913  0.055435063 -0.02922264</span></span>
<span><span class="co">## wt   -0.072968745  0.074195478 -0.15969677 -0.025388280  0.09779066</span></span>
<span><span class="co">## qsec  0.053262832 -0.010289424 -0.01684640  0.057922025 -0.05101702</span></span>
<span><span class="co">## vs   -0.004259078  0.046306195  0.06441374  0.016159029 -0.16162880</span></span>
<span><span class="co">## am    0.059747124 -0.107862866  0.01632788  0.092310874 -0.10095688</span></span>
<span><span class="co">## gear  0.059689698 -0.073236961  0.08754793  0.066762747  0.05647952</span></span>
<span><span class="co">## carb -0.042405124  0.113426894  0.01354387  0.118352683  0.11425855</span></span>
<span><span class="co">## h1    0.753009224  0.001099515 -0.15846563 -0.001284652 -0.01897509</span></span>
<span><span class="co">## h2    0.001099515  0.709182620 -0.03825183  0.033166004 -0.10387854</span></span>
<span><span class="co">## h3   -0.158465631 -0.038251826  0.68591252  0.045475988 -0.03389956</span></span>
<span><span class="co">## h4   -0.001284652  0.033166004  0.04547599  0.604157095  0.04708162</span></span>
<span><span class="co">## h5   -0.018975085 -0.103878541 -0.03389956  0.047081619  0.68722630</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $scales</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   1.7353207 109.0975120  67.7779822   0.5580457   0.8364141   1.8376898 </span></span>
<span><span class="co">##          vs          am        gear        carb          h1          h2 </span></span>
<span><span class="co">##   0.4856209   0.4856209   0.7126966   1.7156080   0.9667548   1.2506310 </span></span>
<span><span class="co">##          h3          h4          h5 </span></span>
<span><span class="co">##   1.0024913   0.5009253   1.5452324 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $lambda</span></span>
<span><span class="co">## [1] 12.9155</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ym</span></span>
<span><span class="co">## [1] 20.10952</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $xm</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   6.1904762 218.5380952 141.0476190   3.5657143   3.1811429  17.9276190 </span></span>
<span><span class="co">##          vs          am        gear        carb          h1          h2 </span></span>
<span><span class="co">##   0.3809524   0.3809524   3.6666667   2.9047619   0.9011436   0.9011436 </span></span>
<span><span class="co">##          h3          h4          h5 </span></span>
<span><span class="co">##   0.7713531   0.4177551   1.0757344 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $n_clusters</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $clusters_scales</span></span>
<span><span class="co">## $clusters_scales$means</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   6.1904762 218.5380952 141.0476190   3.5657143   3.1811429  17.9276190 </span></span>
<span><span class="co">##          vs          am        gear        carb </span></span>
<span><span class="co">##   0.3809524   0.3809524   3.6666667   2.9047619 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $clusters_scales$sds</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   1.7353207 109.0975120  67.7779822   0.5580457   0.8364141   1.8376898 </span></span>
<span><span class="co">##          vs          am        gear        carb </span></span>
<span><span class="co">##   0.4856209   0.4856209   0.7126966   1.7156080 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $clust_obj</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nb_hidden</span></span>
<span><span class="co">## [1] 5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nodes_sim</span></span>
<span><span class="co">## [1] "sobol"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $activ</span></span>
<span><span class="co">## [1] "relu"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nn_xm</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   6.1904762 218.5380952 141.0476190   3.5657143   3.1811429  17.9276190 </span></span>
<span><span class="co">##          vs          am        gear        carb </span></span>
<span><span class="co">##   0.3809524   0.3809524   3.6666667   2.9047619 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nn_scales</span></span>
<span><span class="co">##         cyl        disp          hp        drat          wt        qsec </span></span>
<span><span class="co">##   1.7353207 109.0975120  67.7779822   0.5580457   0.8364141   1.8376898 </span></span>
<span><span class="co">##          vs          am        gear        carb </span></span>
<span><span class="co">##   0.4856209   0.4856209   0.7126966   1.7156080 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $fitted_values</span></span>
<span><span class="co">##           Mazda RX4       Mazda RX4 Wag             Valiant          Duster 360 </span></span>
<span><span class="co">##            21.79908            21.59131            19.67633            14.78088 </span></span>
<span><span class="co">##           Merc 240D            Merc 230            Merc 280          Merc 450SE </span></span>
<span><span class="co">##            22.79888            23.52919            19.78664            15.28762 </span></span>
<span><span class="co">##          Merc 450SL         Merc 450SLC Lincoln Continental            Fiat 128 </span></span>
<span><span class="co">##            15.69314            15.62712            12.41438            27.77353 </span></span>
<span><span class="co">##         Honda Civic       Toyota Corona    Dodge Challenger         AMC Javelin </span></span>
<span><span class="co">##            29.01498            23.50423            16.25692            17.07550 </span></span>
<span><span class="co">##    Pontiac Firebird           Fiat X1-9       Porsche 914-2        Ferrari Dino </span></span>
<span><span class="co">##            16.08283            27.99151            26.24130            19.96917 </span></span>
<span><span class="co">##       Maserati Bora </span></span>
<span><span class="co">##            15.40547 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $compute_Sigma</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $x</span></span>
<span><span class="co">##                     cyl  disp  hp drat    wt  qsec vs am gear carb</span></span>
<span><span class="co">## Mazda RX4             6 160.0 110 3.90 2.620 16.46  0  1    4    4</span></span>
<span><span class="co">## Mazda RX4 Wag         6 160.0 110 3.90 2.875 17.02  0  1    4    4</span></span>
<span><span class="co">## Valiant               6 225.0 105 2.76 3.460 20.22  1  0    3    1</span></span>
<span><span class="co">## Duster 360            8 360.0 245 3.21 3.570 15.84  0  0    3    4</span></span>
<span><span class="co">## Merc 240D             4 146.7  62 3.69 3.190 20.00  1  0    4    2</span></span>
<span><span class="co">## Merc 230              4 140.8  95 3.92 3.150 22.90  1  0    4    2</span></span>
<span><span class="co">## Merc 280              6 167.6 123 3.92 3.440 18.30  1  0    4    4</span></span>
<span><span class="co">## Merc 450SE            8 275.8 180 3.07 4.070 17.40  0  0    3    3</span></span>
<span><span class="co">## Merc 450SL            8 275.8 180 3.07 3.730 17.60  0  0    3    3</span></span>
<span><span class="co">## Merc 450SLC           8 275.8 180 3.07 3.780 18.00  0  0    3    3</span></span>
<span><span class="co">## Lincoln Continental   8 460.0 215 3.00 5.424 17.82  0  0    3    4</span></span>
<span><span class="co">## Fiat 128              4  78.7  66 4.08 2.200 19.47  1  1    4    1</span></span>
<span><span class="co">## Honda Civic           4  75.7  52 4.93 1.615 18.52  1  1    4    2</span></span>
<span><span class="co">## Toyota Corona         4 120.1  97 3.70 2.465 20.01  1  0    3    1</span></span>
<span><span class="co">## Dodge Challenger      8 318.0 150 2.76 3.520 16.87  0  0    3    2</span></span>
<span><span class="co">## AMC Javelin           8 304.0 150 3.15 3.435 17.30  0  0    3    2</span></span>
<span><span class="co">## Pontiac Firebird      8 400.0 175 3.08 3.845 17.05  0  0    3    2</span></span>
<span><span class="co">## Fiat X1-9             4  79.0  66 4.08 1.935 18.90  1  1    4    1</span></span>
<span><span class="co">## Porsche 914-2         4 120.3  91 4.43 2.140 16.70  0  1    5    2</span></span>
<span><span class="co">## Ferrari Dino          6 145.0 175 3.62 2.770 15.50  0  1    5    6</span></span>
<span><span class="co">## Maserati Bora         8 301.0 335 3.54 3.570 14.60  0  1    5    8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $y</span></span>
<span><span class="co">##  [1] 21.0 21.0 18.1 14.3 24.4 22.8 19.2 16.4 17.3 15.2 10.4 32.4 30.4 21.5 15.5</span></span>
<span><span class="co">## [16] 15.2 19.2 27.3 26.0 19.7 15.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $n_updates</span></span>
<span><span class="co">## [1] 0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $avg_coefs</span></span>
<span><span class="co">##             [,1]</span></span>
<span><span class="co">## cyl  -0.36321389</span></span>
<span><span class="co">## disp -0.41963495</span></span>
<span><span class="co">## hp   -0.47508218</span></span>
<span><span class="co">## drat  0.55766798</span></span>
<span><span class="co">## wt   -0.54482177</span></span>
<span><span class="co">## qsec  0.09679212</span></span>
<span><span class="co">## vs    0.32281808</span></span>
<span><span class="co">## am    0.48049052</span></span>
<span><span class="co">## gear  0.25888698</span></span>
<span><span class="co">## carb -0.47461167</span></span>
<span><span class="co">## h1   -0.32480888</span></span>
<span><span class="co">## h2    0.75205757</span></span>
<span><span class="co">## h3   -0.35831420</span></span>
<span><span class="co">## h4    0.04812892</span></span>
<span><span class="co">## h5    0.72081638</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "rvfl"</span></span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3 - Predict on validation set -----</span></span>
<span><span class="va">preds_validation</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/predict_rvfl.html">predict_rvfl</a></span><span class="op">(</span><span class="va">fit_obj</span>,</span>
<span>                                               newx <span class="op">=</span> <span class="va">X_validation</span><span class="op">)</span></span>
<span><span class="va">level</span> <span class="op">&lt;-</span> <span class="fl">95</span></span>
<span><span class="va">multiplier</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">100</span> <span class="op">-</span> <span class="va">level</span><span class="op">)</span><span class="op">/</span><span class="fl">200</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="va">y_validation</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">## -3.4992 -1.9268  2.2022  0.8209  3.3909  3.9374</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">preds_upper</span> <span class="op">&lt;-</span> <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span> <span class="op">+</span> <span class="va">multiplier</span><span class="op">*</span><span class="va">preds_validation</span><span class="op">$</span><span class="va">sd</span></span>
<span><span class="va">preds_lower</span> <span class="op">&lt;-</span> <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="va">multiplier</span><span class="op">*</span><span class="va">preds_validation</span><span class="op">$</span><span class="va">sd</span></span>
<span><span class="co"># coverage rate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">preds_upper</span> <span class="op">&gt;=</span> <span class="va">y_validation</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">preds_lower</span> <span class="op">&lt;=</span> <span class="va">y_validation</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 4 - Update -----</span></span>
<span><span class="co"># add new points in an online fashion</span></span>
<span><span class="va">fit_obj2</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/update_params.html">update_params</a></span><span class="op">(</span><span class="va">fit_obj</span>, newx <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>                                        newy <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, method<span class="op">=</span><span class="st">"polyak"</span><span class="op">)</span></span>
<span><span class="va">fit_obj3</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/update_params.html">update_params</a></span><span class="op">(</span><span class="va">fit_obj2</span>, newx <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>                                        newy <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, method<span class="op">=</span><span class="st">"polyak"</span><span class="op">)</span></span>
<span><span class="va">fit_obj4</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/update_params.html">update_params</a></span><span class="op">(</span><span class="va">fit_obj3</span>, newx <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>                                        newy <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, method<span class="op">=</span><span class="st">"polyak"</span><span class="op">)</span></span>
<span><span class="va">fit_obj5</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/update_params.html">update_params</a></span><span class="op">(</span><span class="va">fit_obj4</span>, newx <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>                                        newy <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, method<span class="op">=</span><span class="st">"polyak"</span><span class="op">)</span></span>
<span><span class="va">fit_obj6</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/update_params.html">update_params</a></span><span class="op">(</span><span class="va">fit_obj5</span>, newx <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>                                        newy <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>, method<span class="op">=</span><span class="st">"polyak"</span><span class="op">)</span></span>
<span><span class="va">fit_obj7</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/update_params.html">update_params</a></span><span class="op">(</span><span class="va">fit_obj6</span>, newx <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>, <span class="op">]</span>,</span>
<span>                                        newy <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">idx_test</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span>, method<span class="op">=</span><span class="st">"polyak"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">mat_coefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">fit_obj</span><span class="op">$</span><span class="va">coef</span>, <span class="va">fit_obj2</span><span class="op">$</span><span class="va">coef</span>,</span>
<span>                    <span class="va">fit_obj3</span><span class="op">$</span><span class="va">coef</span>, <span class="va">fit_obj4</span><span class="op">$</span><span class="va">coef</span>,</span>
<span>                    <span class="va">fit_obj5</span><span class="op">$</span><span class="va">coef</span>, <span class="va">fit_obj6</span><span class="op">$</span><span class="va">coef</span>,</span>
<span>                   <span class="va">fit_obj7</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             [,1]         [,2]        [,3]         [,4]         [,5]       [,6]</span></span>
<span><span class="co">## cyl  -0.36321389  0.156616913  0.15129821 -0.005704671  0.005046952 -0.4791379</span></span>
<span><span class="co">## disp -0.41963495 -0.002381108  0.03952438 -0.150807825 -0.095685593 -0.6202010</span></span>
<span><span class="co">## hp   -0.47508218 -0.183146989 -0.22741808 -0.307549435 -0.279807464 -0.7177286</span></span>
<span><span class="co">## drat  0.55766798  0.347876182  0.25447984  0.359539343  0.281360219  0.7520789</span></span>
<span><span class="co">## wt   -0.54482177 -0.120830328 -0.11186749 -0.162639679 -0.201756336 -0.8419310</span></span>
<span><span class="co">## qsec  0.09679212 -0.056125629  0.02836236  0.107460728  0.049437217  0.4602919</span></span>
<span><span class="co">## vs    0.32281808 -0.202146379 -0.07869073  0.044916974 -0.086675154  0.3405753</span></span>
<span><span class="co">## am    0.48049052 -0.044473938 -0.12994323 -0.016944264  0.069203005  0.5741591</span></span>
<span><span class="co">## gear  0.25888698  0.066277686 -0.03380930  0.097803653  0.037878894  0.2366640</span></span>
<span><span class="co">## carb -0.47461167 -0.017390995 -0.12581946 -0.065429630 -0.150177460 -0.5469287</span></span>
<span><span class="co">## h1   -0.32480888  0.059058223  0.02886339 -0.015250897  0.004325417 -0.3459104</span></span>
<span><span class="co">## h2    0.75205757  0.316744350  0.23962242  0.342580340  0.422119790  1.1714129</span></span>
<span><span class="co">## h3   -0.35831420 -0.041448067 -0.12036108 -0.121029370 -0.037882410 -0.3151740</span></span>
<span><span class="co">## h4    0.04812892  0.391569783  0.52641175  0.216096557  0.196435684 -0.1269167</span></span>
<span><span class="co">## h5    0.72081638 -0.055084236 -0.03157788  0.071551387  0.151658598  1.0546296</span></span>
<span><span class="co">##            [,7]</span></span>
<span><span class="co">## cyl  -0.4739488</span></span>
<span><span class="co">## disp -0.6144207</span></span>
<span><span class="co">## hp   -0.7098485</span></span>
<span><span class="co">## drat  0.7533529</span></span>
<span><span class="co">## wt   -0.8378457</span></span>
<span><span class="co">## qsec  0.4531890</span></span>
<span><span class="co">## vs    0.3363085</span></span>
<span><span class="co">## am    0.5705156</span></span>
<span><span class="co">## gear  0.2322069</span></span>
<span><span class="co">## carb -0.5433451</span></span>
<span><span class="co">## h1   -0.3379071</span></span>
<span><span class="co">## h2    1.1681003</span></span>
<span><span class="co">## h3   -0.3144344</span></span>
<span><span class="co">## h4   -0.1247607</span></span>
<span><span class="co">## h5    1.0513688</span></span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">preds_validation2</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/predict_rvfl.html">predict_rvfl</a></span><span class="op">(</span><span class="va">fit_obj2</span>,</span>
<span>                                                newx <span class="op">=</span> <span class="va">X_validation</span><span class="op">)</span></span>
<span></span>
<span><span class="va">preds_validation3</span> <span class="op">&lt;-</span> <span class="fu">bayesianrvfl</span><span class="fu">::</span><span class="fu"><a href="../reference/predict_rvfl.html">predict_rvfl</a></span><span class="op">(</span><span class="va">fit_obj7</span>,</span>
<span>                                                newx <span class="op">=</span> <span class="va">X_validation</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 5 - Plots -----</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">obj_GCV</span><span class="op">$</span><span class="va">lambda</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">obj_GCV</span><span class="op">$</span><span class="va">GCV</span>, type<span class="op">=</span><span class="st">'l'</span>,</span>
<span>     main <span class="op">=</span> <span class="st">'Generalized Cross-validation error'</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"log(lambda)"</span>, ylab <span class="op">=</span> <span class="st">"GCV"</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-updates_files/figure-html/unnamed-chunk-7-1.png" width="691.2"></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y_validation</span>, type<span class="op">=</span><span class="st">'l'</span>, col<span class="op">=</span><span class="st">"red"</span>,</span>
<span>     lwd<span class="op">=</span><span class="fl">2</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_validation</span>, <span class="va">preds_lower</span>, <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_validation</span>, <span class="va">preds_upper</span>, <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">'Out-of-sample credible intervals'</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"obs#"</span>, ylab <span class="op">=</span> <span class="st">"prediction"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span>, col<span class="op">=</span><span class="st">"blue"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">preds_upper</span>, col<span class="op">=</span><span class="st">"gray"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">preds_lower</span>, col<span class="op">=</span><span class="st">"gray"</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-updates_files/figure-html/unnamed-chunk-7-2.png" width="691.2"></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y_validation</span>,</span>
<span>     y <span class="op">=</span> <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_validation</span>, <span class="va">preds_lower</span>, <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_validation</span>, <span class="va">preds_upper</span>, <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">'observed vs predicted \n (before updates)'</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"observed"</span>, ylab <span class="op">=</span> <span class="st">"predicted"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">1</span>, col<span class="op">=</span><span class="st">"green"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-updates_files/figure-html/unnamed-chunk-7-3.png" width="691.2"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mat_coefs</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'l'</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>        main <span class="op">=</span> <span class="st">'model coefficients \n after each update'</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"update#"</span>, ylab <span class="op">=</span> <span class="st">"model coefficient"</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-updates_files/figure-html/unnamed-chunk-7-4.png" width="691.2"></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y_validation</span>,</span>
<span>     y <span class="op">=</span> <span class="va">preds_validation2</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_validation</span>, <span class="va">preds_lower</span>, <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">y_validation</span>, <span class="va">preds_upper</span>, <span class="va">preds_validation</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">'observed vs predicted \n (after 6 point-updates)'</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"observed"</span>, ylab <span class="op">=</span> <span class="st">"predicted"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">1</span>, col<span class="op">=</span><span class="st">"green"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-updates_files/figure-html/unnamed-chunk-7-5.png" width="691.2"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">preds_validation3</span><span class="op">$</span><span class="fu">simulate</span><span class="op">(</span><span class="fl">250</span><span class="op">)</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'l'</span>,</span>
<span>        lwd <span class="op">=</span> <span class="fl">2</span>, main <span class="op">=</span> <span class="st">'predictive posterior simulation \n (after 6 point-updates)'</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"obs#"</span>, ylab <span class="op">=</span> <span class="st">"prediction"</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-updates_files/figure-html/unnamed-chunk-7-6.png" width="691.2"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by T. Moudiki.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
